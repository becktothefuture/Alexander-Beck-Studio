function e(){function e(e){return!(!e||!e.closest||!(e.closest("#panelDock")||e.closest("#masterPanel")||e.closest("#dockToggle")||e.closest(".panel-dock")||e.closest(".panel")||e.closest("#expertise-legend")||e.closest(".legend__item")))}function M(e,o){const n=k.getBoundingClientRect();return{x:k.width/(n.width||1)*(e-n.left),y:k.height/(n.height||1)*(o-n.top),inBounds:!(n.left>e||e>n.right||n.top>o||o>n.bottom)}}function h(o,s,r,{isMouseLike:c}={isMouseLike:!0}){const v=M(o,s),h=performance.now(),k=h-p;if(k>0&&p>0){const e=v.x-f,o=v.y-m;l=Math.sqrt(e*e+o*o)/k}if(c?i(o,s):t(),e(r))return;if(n())return;g.mouseX=v.x,g.mouseY=v.y,g.mouseInCanvas=v.inBounds,"undefined"!=typeof window&&(window.mouseInCanvas=v.inBounds);const y=Math.hypot(v.x-(g.lastPointerMoveX??v.x),v.y-(g.lastPointerMoveY??v.y));y>.5&&(g.lastPointerMoveMs=h,g.lastPointerMoveX=v.x,g.lastPointerMoveY=v.y),c&&y>.5&&a(v.x,v.y,h,v.inBounds),g.currentMode===u.WATER&&v.inBounds&&l>.3&&h-w>80&&(d(v.x,v.y,Math.min(2*l,3)),w=h),f=v.x,m=v.y,p=h}const g=o(),k=g.canvas;void 0===g.clickCycleEnabled&&(g.clickCycleEnabled=!1),k?(document.addEventListener("mousemove",e=>{window.PointerEvent||h(e.clientX,e.clientY,e.target,{isMouseLike:!0})},{passive:!0}),document.addEventListener("pointermove",e=>{h(e.clientX,e.clientY,e.target,{isMouseLike:"mouse"===e.pointerType||"pen"===e.pointerType})},{passive:!0}),document.addEventListener("click",t=>{if(!g.clickCycleEnabled)return;if(e(t.target))return;if((s=t.target)&&s.closest&&(s.closest("a")||s.closest("button")||s.closest("input")||s.closest("select")||s.closest("textarea")||s.closest('[role="button"]')||s.closest(".legend__item--interactive")))return;var s;if(n())return;if(!M(t.clientX,t.clientY).inBounds)return;const i=performance.now();150>i-v||(v=i,0===(void 0!==t.button?t.button:3===t.which?2:2===t.which?1:0)&&(()=>{const e=o(),n=r,t=n.indexOf(e.currentMode),s=n[((0>t?0:t)+1)%n.length];import("./shared.js").then(e=>e.aM).then(({setMode:e})=>{e(s)}),import("./controls.js").then(e=>e.h).then(({updateModeButtonsUI:e})=>{e(s)})})())},{passive:!0}),document.addEventListener("touchmove",e=>{if(!n()&&e.touches&&e.touches[0]){const o=M(e.touches[0].clientX,e.touches[0].clientY);g.mouseX=o.x,g.mouseY=o.y,g.mouseInCanvas=o.inBounds;const n=performance.now();Math.hypot(o.x-(g.lastPointerMoveX??o.x),o.y-(g.lastPointerMoveY??o.y))>.5&&(g.lastPointerMoveMs=n,g.lastPointerMoveX=o.x,g.lastPointerMoveY=o.y),g.currentMode===u.WATER&&o.inBounds&&n-w>80&&(d(o.x,o.y,2),w=n)}},{passive:!0}),document.addEventListener("touchstart",o=>{window.PointerEvent||e(o.target)||n()||t()},{passive:!0}),document.addEventListener("mouseleave",()=>{g.mouseX=s.OFFSCREEN_MOUSE,g.mouseY=s.OFFSCREEN_MOUSE,g.mouseInCanvas=!1,l=0,"undefined"!=typeof window&&(window.mouseInCanvas=!1),t()}),document.addEventListener("mouseenter",()=>{c()}),document.addEventListener("touchend",()=>{g.mouseX=s.OFFSCREEN_MOUSE,g.mouseY=s.OFFSCREEN_MOUSE,g.mouseInCanvas=!1},{passive:!0}),console.log("âœ“ Unified pointer system configured (document-level)"),g.o=!0,"undefined"!=typeof window&&(window.o=!0)):console.error("Canvas not available for pointer setup")}import{g as o,ad as n,ae as t,af as s,ag as i,ah as a,N as r,M as u,ai as d,aj as c}from"./shared.js";let f=0,m=0,p=0,l=0,v=0,w=0;export{e as s};