function e(e,n,l){if(V=e,w=l,C&&C.remove(),C=document.createElement("div"),C.id="splat-config-panel",C.className="panel",C.style.position="fixed",C.style.top="var(--gap-lg, 20px)",C.style.right="var(--gap-lg, 20px)",C.style.width="320px",C.style.maxHeight="85vh",C.style.overflowY="auto",C.style.zIndex="10001",C.style.display="none",C.style.background="var(--panel-background, #18181b)",C.style.color="var(--panel-foreground, #fafafa)",C.style.border="1px solid var(--panel-border, rgba(255,255,255,0.1))",C.style.borderTop="4px solid hsl(32 95% 44%)",C.style.borderRadius="var(--panel-radius-lg, 12px)",C.style.boxShadow="var(--panel-shadow, 0 10px 15px -3px rgba(0,0,0,0.3))",!document.querySelector("#splat-panel-range-css")){const e=document.createElement("style");e.id="splat-panel-range-css",e.textContent='\n      #splat-config-panel input[type="range"]::-webkit-slider-thumb {\n        -webkit-appearance: none;\n        appearance: none;\n        width: 14px;\n        height: 14px;\n        background: var(--panel-brand, hsl(32 95% 44%));\n        border-radius: 50%;\n        cursor: pointer;\n        border: 2px solid var(--panel-background, #18181b);\n      }\n      #splat-config-panel input[type="range"]::-moz-range-thumb {\n        width: 14px;\n        height: 14px;\n        background: var(--panel-brand, hsl(32 95% 44%));\n        border-radius: 50%;\n        cursor: pointer;\n        border: 2px solid var(--panel-background, #18181b);\n      }\n      #splat-config-panel input[type="range"]:hover::-webkit-slider-thumb {\n        transform: scale(1.1);\n      }\n    ',document.head.appendChild(e)}if(!document.querySelector("#splat-panel-css")){const e=document.createElement("link");e.id="splat-panel-css",e.rel="stylesheet",e.href="css/panel.css",document.head.appendChild(e)}const o=e.id.includes("cube")?"cube":e.id.includes("ducky")?"ducky":"room",i=P[o];C.innerHTML=`\n    <div class="panel-content">\n      <div style="position: relative; margin-bottom: var(--panel-gap, 8px); padding-bottom: var(--panel-gap, 8px); border-bottom: 1px solid var(--panel-border, rgba(255,255,255,0.1));">\n        <div style="font-size: 13px; font-weight: 600; color: var(--panel-foreground, #fff);">\n          ${e.label}\n        </div>\n        <button id="splat-panel-toggle" style="\n          position: absolute;\n          top: 0;\n          right: 0;\n          background: transparent;\n          border: 1px solid var(--panel-border, rgba(255,255,255,0.2));\n          color: var(--panel-foreground, #fff);\n          padding: 4px 8px;\n          border-radius: 4px;\n          cursor: pointer;\n          font-size: 11px;\n          opacity: 0.7;\n          transition: opacity 0.2s;\n        " onmouseover="this.style.opacity='1'" onmouseout="this.style.opacity='0.7'">✕</button>\n      </div>\n      \n      ${t("Main Parameters",i.main,n)}\n      ${t("Secondary Parameters",i.secondary,n)}\n      ${t("Extra Parameters",i.extra,n)}\n      \n      <div style="margin-top: var(--panel-gap, 8px); padding-top: var(--panel-gap, 8px); border-top: 1px solid var(--panel-border, rgba(255,255,255,0.1)); font-size: 11px; color: var(--panel-muted-foreground, #888);">\n        <kbd>/</kbd> toggle panel · Changes apply instantly\n      </div>\n    </div>\n  `,document.body.appendChild(C),((e,t,n)=>{[...t.main,...t.secondary,...t.extra].forEach(t=>{const l=e.querySelector("#splat-param-"+t.id);if(!l)return;const o=l.previousElementSibling?.querySelector("span");l.addEventListener("input",e=>{const l=parseFloat(e.target.value);o&&(o.textContent=a(l,t));const i={...n,[t.id]:l};w&&w(V,i)})})})(C,i,n);const s=C.querySelector("#splat-panel-toggle");return s&&s.addEventListener("click",()=>{C.style.display="none"}),C}function t(e,t,n){return t&&0!==t.length?`\n    <details open style="margin-bottom: var(--panel-gap, 8px);">\n      <summary style="\n        font-size: 12px;\n        font-weight: 600;\n        color: var(--panel-foreground, #fff);\n        cursor: pointer;\n        padding: var(--panel-pad-7, 7px);\n        background: var(--panel-muted, rgba(255,255,255,0.05));\n        border-radius: var(--panel-radius-sm, 6px);\n        user-select: none;\n        list-style: none;\n      ">\n        ${e}\n      </summary>\n      <div style="padding: var(--panel-pad-7, 7px); display: flex; flex-direction: column; gap: var(--panel-control-gap, 6px);">\n        ${t.map(e=>((e,t)=>{const n=void 0!==t[e.id]?t[e.id]:e.default;return`\n    <div style="display: flex; flex-direction: column; gap: 2px;">\n      <div style="display: flex; justify-content: space-between; align-items: center;">\n        <label style="font-size: 11px; color: var(--panel-foreground, #fff);">${e.label}</label>\n        <span style="font-size: 11px; font-variant-numeric: tabular-nums; color: var(--panel-muted-foreground, #888); min-width: 60px; text-align: right;">\n          ${a(n,e)}\n        </span>\n      </div>\n        <input \n        type="range" \n        id="splat-param-${e.id}"\n        min="${e.min}" \n        max="${e.max}" \n        step="${e.step}" \n        value="${n}"\n        style="\n          width: 100%;\n          height: 6px;\n          background: var(--panel-muted, rgba(255,255,255,0.1));\n          border-radius: 3px;\n          outline: none;\n          -webkit-appearance: none;\n          cursor: pointer;\n        "\n        oninput="this.style.setProperty('--thumb-pos', ((this.value - this.min) / (this.max - this.min) * 100) + '%')"\n      />\n    </div>\n  `})(e,n)).join("")}\n      </div>\n    </details>\n  `:""}function a(e,t){const a=parseFloat(e);return isNaN(a)?"0":1>t.step?a.toFixed(.01>t.step?3:.1>t.step?2:1):""+Math.round(a)}function n(t,a){C&&w&&(e(t,a,w),C.style.display="block")}function l(e){const t=document.getElementById("splat-variant-label");t&&(t.textContent="NEW SIMULATIONS · "+(e?.label||""))}function o(e){let t=e;return()=>(t=(9301*t+49297)%233280,t/233280)}function i(e,t,a,n=null){const l={x:e.x*t.modelScalePx,y:e.y*t.modelScalePx,z:e.z*t.modelScalePx};let o=t.rotX,i=t.rotY,s=t.rotZ,r=0,d=0,p=0;if(null!==n&&-1===n&&t.hasDualCubes){o=t.rotXOuter||0,i=t.rotYOuter||0,s=t.rotZOuter||0;const e=t.modelScalePx*(O?.config?.orbitRadius||.08),a=t.orbitTime||0;r=Math.sin(a)*e,d=Math.cos(.7*a)*e*.6,p=Math.sin(.9*a)*e*.3,l.x+=r,l.y+=d,l.z+=p}const u=((e,t,a,n)=>{let{x:l,y:o,z:i}=e;const s=Math.cos(a),r=Math.sin(a),d=l*s-i*r,p=l*r+i*s,u=Math.cos(t),c=Math.sin(t),m=o*u-p*c,f=o*c+p*u,b=Math.cos(n),x=Math.sin(n);return{x:d*b-m*x,y:d*x+m*b,z:f}})(l,o,i,s),c=Math.max(120,t.focalLength),m=c/(c+(u.z+t.depth));return{x:t.centerX+u.x*m,y:t.centerY+u.y*m,scale:m}}function s(e){const t=g(),a=t.canvas;if(!a)return;v(),O=e;const n=e.pointSource(e.config.pointCount,e.config),l=M(t,(t.R_MED||18)*(e.config.baseRadiusScale||.22)*(t.DPR||1)),o=e.config.modelScale,i=e.config.cameraPanSpeed?.45:.32,s=Math.min(a.width,a.height)*i*o,r=n.some(e=>void 0!==e.t),d=n.some(e=>e.l);t.splatTestState={centerX:.5*a.width,centerY:a.height*(.5+(e.config.centerOffsetY||0)),depth:e.config.cameraPanSpeed?120*Math.max(.6,o):220*Math.max(.6,o),modelScaleFactor:o,modelScalePx:s,baseRadius:l,lastCanvasWidth:a.width,lastCanvasHeight:a.height,rotX:0,rotY:0,rotZ:0,rotXOuter:0,rotYOuter:0,rotZOuter:0,tumbleX:0,tumbleY:0,tumbleXOuter:0,tumbleYOuter:0,prevMouseX:null,prevMouseY:null,focalLength:e.config.focalLength,idleSpeed:e.config.idleSpeed,tumbleSpeed:e.config.tumbleSpeed||0,tumbleDamping:e.config.tumbleDamping||1,tumbleDampingOuter:e.config.tumbleDamping?.992*e.config.tumbleDamping:.979104,cameraPanSpeed:e.config.cameraPanSpeed||0,cameraPanX:0,cameraPanY:0,orbitTime:0,hasDualCubes:r,floatTime:0,floatAmplitude:e.config.floatAmplitude||12,floatSpeed:e.config.floatSpeed||.8,isDucky:d,points:n};for(let p=0;n.length>p;p++){const e=z(0,0);e&&(e.vx=0,e.vy=0,e.omega=0,e.r=l,e.o=n[p],e.i=l,void 0!==n[p].t&&(e.t=n[p].t),e.isSleeping=!1)}t.currentMode=S.SPHERE_3D}function r(e,t){const a={x:e.x*t.modelScalePx,y:e.y*t.modelScalePx,z:e.z*t.modelScalePx},n=a.x-(t.cameraPanX||0),l=a.y-(t.cameraPanY||0),o=a.z,i=Math.max(120,t.focalLength),s=i/(i+(o+t.depth));return{x:t.centerX+n*s,y:t.centerY+l*s,scale:s}}function d(e,t){e.config={...e.config,...t};const a=g(),l=a.splatTestState;l&&(void 0!==t.floatAmplitude&&(l.floatAmplitude=t.floatAmplitude),void 0!==t.floatSpeed&&(l.floatSpeed=t.floatSpeed),void 0!==t.centerOffsetY&&(l.centerY=a.canvas.height*(.5+t.centerOffsetY)),void 0!==t.focalLength&&(l.focalLength=t.focalLength),void 0!==t.idleSpeed&&(l.idleSpeed=t.idleSpeed),void 0!==t.tumbleSpeed&&(l.tumbleSpeed=t.tumbleSpeed),void 0!==t.tumbleDamping&&(l.tumbleDamping=t.tumbleDamping,l.tumbleDampingOuter=.992*t.tumbleDamping),void 0!==t.cameraPanSpeed&&(l.cameraPanSpeed=t.cameraPanSpeed),void 0!==t.baseRadiusScale&&(l.baseRadius=M(a,(a.R_MED||18)*t.baseRadiusScale*(a.DPR||1)),a.balls.forEach(e=>{void 0!==e.i&&(e.i=l.baseRadius)}))),s(e),n(e,e.config)}import{d as p,e as u,f as c,j as m,n as f,Q as b,k as x,o as h,g,a9 as y,aa as v,ab as M,ac as z,M as S,T as k}from"./shared.js";import{s as D}from"./pointer.js";const P={cube:{main:[{id:"pointCount",label:"Point Count",min:200,max:2e3,step:50,default:800},{id:"modelScale",label:"Model Scale",min:.5,max:2.5,step:.1,default:1.2},{id:"focalLength",label:"Focal Length",min:400,max:1500,step:50,default:850},{id:"cubeSize",label:"Cube Size",min:.3,max:1.5,step:.05,default:.8}],secondary:[{id:"idleSpeed",label:"Idle Speed",min:0,max:.1,step:.005,default:.025},{id:"tumbleSpeed",label:"Tumble Speed",min:0,max:10,step:.2,default:4.2},{id:"tumbleDamping",label:"Tumble Damping",min:.9,max:.999,step:.001,default:.987},{id:"baseRadiusScale",label:"Dot Size",min:.1,max:.5,step:.01,default:.22}],extra:[{id:"centerOffsetY",label:"Center Y Offset",min:-.1,max:.1,step:.01,default:0},{id:"orbitRadius",label:"Orbit Radius",min:0,max:.2,step:.01,default:.08},{id:"orbitSpeed",label:"Orbit Speed",min:0,max:2,step:.1,default:.5}]},ducky:{main:[{id:"pointCount",label:"Point Count",min:500,max:3e3,step:100,default:1400},{id:"modelScale",label:"Model Scale",min:.5,max:2,step:.1,default:1},{id:"focalLength",label:"Focal Length",min:600,max:1500,step:50,default:920},{id:"baseRadiusScale",label:"Dot Size",min:.1,max:.5,step:.01,default:.22}],secondary:[{id:"idleSpeed",label:"Idle Speed",min:0,max:.1,step:.005,default:.02},{id:"tumbleSpeed",label:"Tumble Speed",min:0,max:10,step:.2,default:2},{id:"tumbleDamping",label:"Tumble Damping",min:.9,max:.999,step:.001,default:.95},{id:"floatAmplitude",label:"Float Amplitude",min:0,max:30,step:1,default:12}],extra:[{id:"floatSpeed",label:"Float Speed",min:.1,max:3,step:.1,default:.8},{id:"bodyDensity",label:"Body Density",min:.3,max:.6,step:.05,default:.45},{id:"headDensity",label:"Head Density",min:.15,max:.35,step:.05,default:.25}]},room:{main:[{id:"pointCount",label:"Point Count",min:1e3,max:5e3,step:200,default:2e3},{id:"modelScale",label:"Model Scale",min:1,max:4,step:.1,default:2.8},{id:"focalLength",label:"Focal Length",min:400,max:1200,step:50,default:600},{id:"cameraPanSpeed",label:"Pan Speed",min:0,max:1,step:.05,default:.3}],secondary:[{id:"boxWidth",label:"Room Width",min:1.5,max:4,step:.1,default:2.4},{id:"boxHeight",label:"Room Height",min:.8,max:2.5,step:.1,default:1.4},{id:"boxDepth",label:"Room Depth",min:2,max:6,step:.2,default:4.2},{id:"baseRadiusScale",label:"Dot Size",min:.1,max:.5,step:.01,default:.22}],extra:[{id:"idleSpeed",label:"Idle Speed",min:0,max:.05,step:.005,default:.015},{id:"furnitureDensity",label:"Furniture Density",min:.05,max:.3,step:.05,default:.17},{id:"wallDensity",label:"Wall Density",min:.1,max:.3,step:.05,default:.15}]}};let C=null,V=null,w=null;const $={sizeVariationGlobalMul:0,sizeVariationPit:0,sizeVariationFlies:0,sizeVariationWeightless:0,sizeVariationWater:0,sizeVariationVortex:0,sizeVariationPingPong:0,sizeVariationMagnetic:0,sizeVariationBubbles:0,sizeVariationKaleidoscope:0,sizeVariationCritters:0,sizeVariationNeural:0,sizeVariationParallaxLinear:0,sphere3dDotSizeMul:1.2},F=[{id:"splat-variant-a",label:"Variant A · Perfect Cube",pointSource(e,t={}){const a=t.cubeSize||.8,n=1.6*a,l=[],o=Math.floor(.5*e),i=e-o,s=(e,t,a={x:0,y:0,z:0})=>{const n=.5*e,l=[],o=Math.max(4,Math.floor(t/12)),i=(t,n,l)=>{const o=.015/e,i=o+l*(1-2*o);return{x:t.x+(n.x-t.x)*i+a.x,y:t.y+(n.y-t.y)*i+a.y,z:t.z+(n.z-t.z)*i+a.z}},s=[{x:-n,y:-n,z:-n},{x:n,y:-n,z:-n},{x:-n,y:n,z:-n},{x:n,y:n,z:-n},{x:-n,y:-n,z:n},{x:n,y:-n,z:n},{x:-n,y:n,z:n},{x:n,y:n,z:n}],r=[[0,1],[2,3],[4,5],[6,7],[0,2],[1,3],[4,6],[5,7],[0,4],[1,5],[2,6],[3,7]];for(const[d,p]of r){const e=s[d],t=s[p];for(let a=0;o>a;a++)l.push(i(e,t,a/(o-1)))}return l},r=s(a,o);l.push(...r);const d=s(n,i);return l.push(...d),l.forEach((e,t)=>{e.t=r.length>t?1:-1}),l},config:{pointCount:800,modelScale:1.2,focalLength:850,idleSpeed:.025,tumbleSpeed:4.2,tumbleDamping:.987,cubeSize:.8}},{id:"splat-variant-b",label:"Variant B · Rubber Ducky",pointSource(e,t={}){const a=o(t.seed||42),n=[],l=Math.floor(e*(t.bodyDensity||.45));for(let o=0;l>o;o++){const e=a()*L,t=Math.acos(2*a()-1),l=.35+.12*a();n.push({x:l*Math.sin(t)*Math.cos(e)*1.15,y:-(l*Math.cos(t)*.85-.08),z:l*Math.sin(t)*Math.sin(e)*.88})}const i=Math.floor(e*(t.headDensity||.25)),s=.24;for(let o=0;i>o;o++){const e=a()*L,t=Math.acos(2*a()-1);n.push({x:s*Math.sin(t)*Math.cos(e)+.35,y:s*Math.cos(t)-.18,z:s*Math.sin(t)*Math.sin(e)*.95})}const r=Math.floor(.12*e);for(let o=0;r>o;o++)n.push({x:.5+.14*a(),y:.1*a()-.05-.14,z:.18*a()-.09});const d=Math.floor(.06*e);for(let o=0;d>o;o++){const e=a()*L,t=.1*a();n.push({x:t*Math.cos(e)-.4,y:.04+t*Math.sin(e)*.6,z:.22*a()-.11})}const p=Math.floor(.12*e);for(let o=0;p>o;o++){const e=o%2==0?1:-1,t=a()*L*.6,l=a()*Math.PI*.5,i=.14+.08*a();n.push({x:(.35*a()-.1)*e,y:.03+i*Math.cos(l),z:.3*e+i*Math.sin(l)*Math.sin(t)})}return n.forEach(e=>{e.l=!0}),n},config:{pointCount:1400,modelScale:1,focalLength:920,idleSpeed:.02,tumbleSpeed:2,tumbleDamping:.95}},{id:"splat-variant-c",label:"Variant C · Shoebox Room",pointSource(e,t={}){const a=o(t.seed||13),n=[],l=t.boxWidth||2.4,i=t.boxHeight||1.4,s=t.boxDepth||4.2,r=t.wallDensity||.15,d=t.furnitureDensity||.17,p=Math.floor(e*r);for(let o=0;p>o;o++)n.push({x:a()*l-.5*l,y:.5*-i,z:a()*s-.5*s});const u=Math.floor(.8*e*r);for(let o=0;u>o;o++)n.push({x:a()*l-.5*l,y:.5*i,z:a()*s-.5*s});const c=Math.floor(.93*e*r);for(let o=0;c>o;o++)n.push({x:a()*l-.5*l,y:a()*i-.5*i,z:.5*-s});const m=Math.floor(.8*e*r);for(let o=0;m>o;o++)n.push({x:.5*-l,y:a()*i-.5*i,z:a()*s-.5*s});const f=Math.floor(.8*e*r);for(let o=0;f>o;o++)n.push({x:.5*l,y:a()*i-.5*i,z:a()*s-.5*s});const b=Math.floor(.08*e),x=.35*-s,h=.25*-l,g=.15;for(let o=0;b>o;o++).7>a()?n.push({x:h+(.6*a()-.3),y:.5*-i+g,z:x+(.18*a()-.09)}):n.push({x:h+(.6*a()-.3),y:.5*-i+g+a()*g*1.2,z:x-.09});const y=Math.floor(.05*e),v=.45*-s,M=.25*l;for(let o=0;y>o;o++)n.push({x:M+(.5*a()-.25),y:.5*-i+.25+.35*a(),z:v});const z=Math.floor(.04*e),S=.15*-l,k=.25*-s;for(let o=0;z>o;o++)if(.6>a())n.push({x:S+(.06*a()-.03),y:.5*-i+.5*a()*i,z:k+(.06*a()-.03)});else{const e=.1*i,t=a()*L,l=.08+.05*a();n.push({x:S+l*Math.cos(t),y:e+.08*a(),z:k+l*Math.sin(t)})}const D=Math.floor(e*d);for(let o=0;D>o;o++){const e=a();if(.3>e)n.push({x:1.4*a()-.7,y:.5*-i+.08+.12*a(),z:a()*s*.8-.4*s});else if(.5>e){const e=Math.floor(3*a());n.push(0===e?{x:1.6*a()-.8,y:.8*a()-.4,z:.48*-s}:1===e?{x:.48*-l,y:.8*a()-.4,z:a()*s*.9-.45*s}:{x:.48*l,y:.8*a()-.4,z:a()*s*.9-.45*s})}else n.push({x:1.6*a()-.8,y:.6*a()-.3,z:a()*s*.7-.35*s})}return n},config:{pointCount:2e3,modelScale:2.8,focalLength:600,idleSpeed:.015,tumbleSpeed:0,tumbleDamping:1,cameraPanSpeed:.3}}],L=2*Math.PI;let O=null;(async()=>{const t=await p();u({...t,...$}),c(),m();const a=x(),o=b(),v=document.getElementById("bravia-balls");if(!a||!o||!v)return void console.error("Splat test: missing canvas/container");f(a,o,v),h();const z=g();z.clickCycleEnabled=!1,z.mouseInCanvas=!1,D(),y("industrialTeal"),(t=>{const a=x();if(!a||0===t.length)return;let o=0;const i=t[o];s(i),l(i),e(i,i.config,d),a.addEventListener("click",e=>{const i=a.getBoundingClientRect(),r=e.clientX,d=e.clientY;!(i.left>r||r>i.right||i.top>d||d>i.bottom)&&(()=>{o=(o+1)%t.length;const e=t[o];s(e),l(e),n(e,e.config)})()}),document.addEventListener("keydown",e=>{"/"!==e.key||e.shiftKey||e.ctrlKey||e.metaKey||(e.preventDefault(),C&&(C.style.display="none"!==C.style.display&&C.style.display?"none":"block"))})})(F),(()=>{let e=performance.now();const t=a=>{const n=Math.min(.033,(a-e)/1e3);e=a,(e=>{const t=g(),a=t.splatTestState,n=t.canvas;if(!a||!n)return;n.width===a.lastCanvasWidth&&n.height===a.lastCanvasHeight||(a.lastCanvasWidth=n.width,a.lastCanvasHeight=n.height,((e,t,a)=>{const n=e.cameraPanSpeed?.45:.32,l=Math.min(a.width,a.height)*n*e.modelScaleFactor,o=M(t,(t.R_MED||18)*(O?.config?.baseRadiusScale||.22)*(t.DPR||1));if(.001>=Math.abs(l-e.modelScalePx)&&.001>=Math.abs(o-e.baseRadius))return;e.modelScalePx=l,e.baseRadius=o;const i=t.balls;for(let s=0;i.length>s;s++){const e=i[s];e&&e.o&&(e.i=o)}})(a,t,n)),a.centerX=.5*n.width,a.centerY=.52*n.height;const l=void 0!==a.cameraPanSpeed&&a.cameraPanSpeed>0;if(l){if(t.mouseInCanvas){const e=200*a.cameraPanSpeed,l=(t.mouseY-a.centerY)/(.5*n.height);a.cameraPanX=(t.mouseX-a.centerX)/(.5*n.width)*e,a.cameraPanY=l*e}else a.cameraPanX=.95*(a.cameraPanX||0),a.cameraPanY=.95*(a.cameraPanY||0);a.rotY+=a.idleSpeed*e*.1,a.rotX=0,a.rotZ=0}else{if(t.mouseInCanvas){const e=t.mouseX-(a.prevMouseX??t.mouseX),n=t.mouseY-(a.prevMouseY??t.mouseY);a.prevMouseX=t.mouseX,a.prevMouseY=t.mouseY;const l=.0028*a.tumbleSpeed;a.hasDualCubes?(a.tumbleY+=-e*l,a.tumbleX+=n*l,a.tumbleYOuter+=e*l*.85,a.tumbleXOuter+=-n*l*.85):(a.tumbleY+=e*l,a.tumbleX+=-n*l)}else a.prevMouseX=null,a.prevMouseY=null;if(a.hasDualCubes){a.tumbleX*=a.tumbleDamping,a.tumbleY*=a.tumbleDamping,a.rotY+=(a.idleSpeed+a.tumbleY)*e,a.rotX+=(.7*a.idleSpeed+a.tumbleX)*e,a.rotZ+=.2*a.idleSpeed*e;const t=a.tumbleDampingOuter||.992*a.tumbleDamping;a.tumbleXOuter*=t,a.tumbleYOuter*=t,a.rotYOuter+=(a.idleSpeed+a.tumbleYOuter)*e,a.rotXOuter+=(.7*a.idleSpeed+a.tumbleXOuter)*e,a.rotZOuter+=.2*a.idleSpeed*e}else a.tumbleX*=a.tumbleDamping,a.tumbleY*=a.tumbleDamping,a.rotY+=(a.idleSpeed+a.tumbleY)*e,a.rotX+=(.7*a.idleSpeed+a.tumbleX)*e,a.rotZ+=.2*a.idleSpeed*e}void 0!==a.orbitTime&&(a.orbitTime+=e*(O?.config?.orbitSpeed||.5)),a.isDucky&&void 0!==a.floatTime&&(a.floatTime+=e*a.floatSpeed);const o=t.balls;for(let s=0;o.length>s;s++){const e=o[s],n=e.o;if(!n)continue;const d=void 0!==e.t?e.t:null;let p=l?r(n,a):i(n,a,0,d);if(a.isDucky&&n.l){const e=Math.sin(a.floatTime)*a.floatAmplitude;p={...p,y:p.y+e}}e.x=p.x,e.y=p.y,e.r=M(t,e.i*p.scale),e.vx=0,e.vy=0,e.omega=0,e.isSleeping=!1}})(n),k(),requestAnimationFrame(t)};requestAnimationFrame(t)})()})();