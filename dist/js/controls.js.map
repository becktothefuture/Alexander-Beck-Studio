{"version":3,"file":"controls.js","sources":["../../source/modules/ui/controls.js"],"sourcesContent":["// ╔══════════════════════════════════════════════════════════════════════════════╗\n// ║                            UI CONTROLS WIRING                                ║\n// ║              Thin orchestrator for panel controls                            ║\n// ║    All slider bindings are handled by control-registry.js                    ║\n// ╚══════════════════════════════════════════════════════════════════════════════╝\n\nimport { getGlobals } from '../core/state.js';\nimport { applyColorTemplate, populateColorSelect } from '../visual/colors.js';\nimport { autoSaveSettings } from '../utils/storage.js';\nimport { bindRegisteredControls } from './control-registry.js';\n\n/**\n * Master controls (shared across pages)\n * - Registry handles all slider/picker bindings via bindRegisteredControls()\n * - This file handles only: theme buttons and color template select\n */\nexport function setupMasterControls() {\n  // ═══════════════════════════════════════════════════════════════════════════\n  // BIND ALL REGISTERED CONTROLS FROM REGISTRY (single source of truth)\n  // ═══════════════════════════════════════════════════════════════════════════\n  bindRegisteredControls();\n\n  // ═══════════════════════════════════════════════════════════════════════════\n  // COLOR TEMPLATE SELECT — Special handling (not in registry)\n  // ═══════════════════════════════════════════════════════════════════════════\n  populateColorSelect();\n  const colorSelect = document.getElementById('colorSelect');\n  if (colorSelect) {\n    colorSelect.addEventListener('change', () => {\n      applyColorTemplate(colorSelect.value);\n      autoSaveSettings();\n    });\n  }\n\n  // ═══════════════════════════════════════════════════════════════════════════\n  // THEME BUTTONS — Manual binding (not in registry)\n  // ═══════════════════════════════════════════════════════════════════════════\n  const themeAuto = document.getElementById('themeAuto');\n  const themeLight = document.getElementById('themeLight');\n  const themeDark = document.getElementById('themeDark');\n  \n  // Theme buttons are handled by dark-mode-v2.js, just add visual feedback here\n  [themeAuto, themeLight, themeDark].forEach(btn => {\n    if (btn) {\n      btn.addEventListener('click', () => {\n        // Remove active from all, add to clicked\n        [themeAuto, themeLight, themeDark].forEach(b => b?.classList.remove('active'));\n        btn.classList.add('active');\n      });\n    }\n  });\n}\n\n/**\n * Index-only controls (home page)\n * - Adds mode switching UI and related updates\n */\nexport function setupIndexControls() {\n  setupMasterControls();\n\n  // ═══════════════════════════════════════════════════════════════════════════\n  // MODE BUTTONS — Critical for panel mode switching\n  // ═══════════════════════════════════════════════════════════════════════════\n  const modeButtons = document.querySelectorAll('.mode-button');\n  modeButtons.forEach(btn => {\n    btn.addEventListener('click', (e) => {\n      e.stopPropagation();\n      const mode = btn.getAttribute('data-mode');\n      console.log('Mode button clicked:', mode);\n      import('../modes/mode-controller.js')\n        .then(({ setMode }) => {\n          setMode(mode);\n          updateModeButtonsUI(mode);\n        })\n        .catch(() => {});\n    });\n  });\n}\n\n// Backwards compatibility: the index page historically called `setupControls()`.\nexport function setupControls() {\n  setupIndexControls();\n}\n\n/**\n * Update mode button UI to reflect active mode\n */\nexport function updateModeButtonsUI(activeMode) {\n  const buttons = document.querySelectorAll('.mode-button');\n  buttons.forEach(btn => {\n    const isActive = btn.getAttribute('data-mode') === activeMode;\n    btn.classList.toggle('active', isActive);\n  });\n  \n  // Show/hide mode-specific controls\n  document.querySelectorAll('.mode-controls').forEach(el => el.classList.remove('active'));\n  const controlId = activeMode + 'Controls';\n  const activeControls = document.getElementById(controlId);\n  if (activeControls) activeControls.classList.add('active');\n  \n  // Update announcer for accessibility\n  const announcer = document.getElementById('announcer');\n  if (announcer) {\n    const modeNames = {\n      'critters': 'Critters',\n      'pit': 'Ball Pit',\n      'flies': 'Flies to Light', \n      'weightless': 'Zero-G',\n      'water': 'Water Swimming',\n      'vortex': 'Electrons',\n\n      'magnetic': 'Magnetic',\n      'bubbles': 'Carbonated Bubbles',\n      'kaleidoscope-3': 'Kaleidoscope',\n      'neural': 'Neural Network'\n    };\n    announcer.textContent = `Switched to ${modeNames[activeMode] || activeMode} mode`;\n  }\n\n  \n}\n"],"names":[],"mappings":"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"}