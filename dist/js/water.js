function t(){const t=i();c(),u.length=0;const o=t.canvas;if(!o)return;const n=o.width,s=o.height,a=e(t.waterBallCount||100);if(0>=a)return;const l=(t.waterInitialVelocity||120)*(t.DPR||1);for(let c=0;8>c&&a>c;c++){const o=Math.random()*n,a=Math.random()*s,c=f(t,h.WATER),{color:i,distributionIndex:e}=r(),u=new M(o,a,c,i);u.distributionIndex=e,u.vx=(Math.random()-.5)*l,u.vy=(Math.random()-.5)*l,t.balls.push(u)}for(let c=8;a>c;c++){const o=Math.random()*n,a=Math.random()*s,c=f(t,h.WATER),{color:i,distributionIndex:e}=r(),u=new M(o,a,c,i);u.distributionIndex=e,u.vx=(Math.random()-.5)*l,u.vy=(Math.random()-.5)*l,t.balls.push(u)}}function o(t,o){const n=i(),s=n.waterDrag||.015;t.vx*=1-s,t.vy*=1-s,t.omega*=1-.5*s;const a=n.DPR||1;for(let r=0;u.length>r;r++){const n=u[r],s=t.x-n.x,c=t.y-n.y,i=Math.sqrt(s*s+c*c),e=40*a;if(i>n.radius-e&&n.radius+e>i){const a=n.strength*(1-Math.abs(i-n.radius)/e);if(i>.1){const n=c/i;t.vx+=s/i*a*o,t.vy+=n*a*o}}}const c=n.waterDriftStrength||25;t.vx+=Math.sin(.5*t.t+.01*t.x)*c*o,t.vy+=Math.cos(.7*t.t+.01*t.y)*c*o}function n(t){const o=i().waterRippleSpeed||300;for(let n=u.length-1;n>=0;n--){const s=u[n];s.radius+=o*t,s.age+=t,s.strength*=.96,(s.age>3||10>s.strength)&&u.splice(n,1)}}function s(t,o,n=1){const s=i();u.push({x:t,y:o,radius:0,strength:(s.waterRippleStrength||15e3)*Math.min(n,5),age:0})}function a(){return u}import{am as c,aO as r,g as i,aP as e,aQ as f,ao as h}from"./shared.js";import{B as M}from"./Ball.js";const u=[];export{o as applyWaterForces,s as createWaterRipple,a as getWaterRipples,t as initializeWater,n as updateWaterRipples};