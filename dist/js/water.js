function t(){const t=i();c(),u.length=0;const n=t.canvas;if(!n)return;const o=n.width,s=n.height,a=e(t.waterBallCount||100);if(0>=a)return;const l=(t.waterInitialVelocity||120)*(t.DPR||1);for(let c=0;8>c&&a>c;c++){const n=Math.random()*o,a=Math.random()*s,c=f(t,h.WATER),{color:i,distributionIndex:e}=r(),u=new M(n,a,c,i);u.distributionIndex=e,u.vx=(Math.random()-.5)*l,u.vy=(Math.random()-.5)*l,t.balls.push(u)}for(let c=8;a>c;c++){const n=Math.random()*o,a=Math.random()*s,c=f(t,h.WATER),{color:i,distributionIndex:e}=r(),u=new M(n,a,c,i);u.distributionIndex=e,u.vx=(Math.random()-.5)*l,u.vy=(Math.random()-.5)*l,t.balls.push(u)}}function n(t,n){const o=i(),s=o.waterDrag||.015;t.vx*=1-s,t.vy*=1-s,t.omega*=1-.5*s;const a=o.DPR||1;for(let r=0;u.length>r;r++){const o=u[r],s=t.x-o.x,c=t.y-o.y,i=Math.sqrt(s*s+c*c),e=40*a;if(i>o.radius-e&&o.radius+e>i){const a=o.strength*(1-Math.abs(i-o.radius)/e);if(i>.1){const o=c/i;t.vx+=s/i*a*n,t.vy+=o*a*n}}}const c=o.waterDriftStrength||25;t.vx+=Math.sin(.5*t.t+.01*t.x)*c*n,t.vy+=Math.cos(.7*t.t+.01*t.y)*c*n}function o(t){const n=i().waterRippleSpeed||300;for(let o=u.length-1;o>=0;o--){const s=u[o];s.radius+=n*t,s.age+=t,s.strength*=.96,(s.age>3||10>s.strength)&&u.splice(o,1)}}function s(t,n,o=1){const s=i();u.push({x:t,y:n,radius:0,strength:(s.waterRippleStrength||15e3)*Math.min(o,5),age:0})}function a(){return u}import{al as c,aN as r,g as i,aO as e,aP as f,an as h}from"./shared.js";import{B as M}from"./Ball.js";const u=[];export{n as applyWaterForces,s as createWaterRipple,a as getWaterRipples,t as initializeWater,o as updateWaterRipples};