function t(t,e=""){const n=(t+"").startsWith("--")?t:"--"+t,o=(()=>{try{if("undefined"==typeof window)return null;const t=window.__TOKENS__;return t&&"object"==typeof t?t:null}catch(t){return null}})(),a=(t=>{try{return"undefined"==typeof document?"":getComputedStyle(document.documentElement).getPropertyValue(t).trim()}catch(e){return""}})(n);if(a&&!a.includes("var("))return a;if(o){const t=((t,e)=>{const n=(t||"")+"";if(!n.includes("var("))return n.trim();if(!e)return n.trim();const o=/var\((--[a-z0-9-_]+)(?:\s*,\s*([^)]+))?\)/gi;let a=n,i=0;for(;a.includes("var(")&&8>i;)a=a.replace(o,(t,n,o)=>{const a=e.resolved?.[n]??e.cssVars?.[n];return null!=a?(a+"").trim():o?(o+"").trim():""}),i+=1;return a.trim()})(o.resolved?.[n]??o.cssVars?.[n]??a,o);if(t&&!t.includes("var("))return t}return a&&!a.includes("var(")?a:e}function e(e,n){const o=t(e,""),a=parseFloat(o);return Number.isFinite(a)?a:n}function n(e,n){const o=t(e,"");if(!o)return n;const a=parseFloat((o+"").replace(/px$/i,""));return Number.isFinite(a)?a:n}function o(e,n){const o=t(e,"");if(!o)return n;const a=(o+"").trim().toLowerCase(),i=parseFloat(a);return Number.isFinite(i)?a.endsWith("ms")?i:a.endsWith("s")?1e3*i:i:n}function a(t){ma=t}function i(t,e,n,o){const a=+t;return Number.isFinite(a)?Math.min(n,Math.max(e,a)):o}function r(t,e,n,o){const a=i(t,e,n,o);return Math.round(a)}function s(){const t=+pa.layoutViewportWidthPx;return Number.isFinite(t)&&t>0?t:Math.max(1,window.innerWidth||1)}function c(){try{const t=window.visualViewport;if(t&&"number"==typeof t.height&&t.height>0)return Math.max(1,t.height)}catch(t){}return Math.max(1,window.innerHeight||1)}function l(){return s()*c()}function u(t=64e4){const e=l();return e>0&&t>0?e/t:1}function d(t,e){const n=Math.max(1,e||s()),o=+t;return Number.isFinite(o)?o/n*100:0}function h(t,e){const n=Math.max(1,e||s()),o=+t;return Number.isFinite(o)?o/100*n:0}function f(){const t=s(),e=c(),n=Number.isFinite(pa.wallThicknessVw)&&pa.wallThicknessVw>0?pa.wallThicknessVw:0,o=n>0?n:Number.isFinite(pa.containerBorderVw)?pa.containerBorderVw:0;pa.containerBorderVw=o;const a=h(o,t),i=h(pa.simulationPaddingVw,t),r=h(pa.wallRadiusVw,t),l=Math.max(0,Math.round(pa.layoutMinWallRadiusPx||0)),d=h(n>0?n:o,t)*(1+(u()-1)*(Number.isFinite(pa.wallThicknessAreaMultiplier)&&pa.wallThicknessAreaMultiplier>=0?pa.wallThicknessAreaMultiplier:0)),f=pa.isMobile||pa.isMobileViewport,m=f?Math.max(.5,pa.mobileWallThicknessXFactor||1):1,p=f?1:Math.max(.5,pa.desktopWallThicknessFactor||1);pa.containerBorder=Math.round(a*p),pa.containerBorderX=Math.round(a*m),pa.simulationPadding=Math.round(i),pa.wallThickness=Math.round(d*(f?m:p));const M=Math.max(1,Math.sqrt(t*e)),b=Number.isFinite(pa.contentPaddingRatio)?pa.contentPaddingRatio:0;pa.contentPadding=Math.round(pa.wallThickness+M*(Math.abs(b)>1?b/M:b));const v=Math.max(.1,pa.contentPaddingHorizontalRatio||1);pa.contentPaddingY=pa.contentPadding,pa.contentPaddingX=Math.round(pa.contentPadding*v),pa.wallRadius=Math.max(l,Math.round(r)),pa.cornerRadius=pa.wallRadius;const g=Math.max(0,h(pa.cursorInfluenceRadiusVw||0,t));pa.cursorInfluenceRadiusPx=Math.round(g),pa.repelRadius=Math.round(g),pa.weightlessRepelRadius=Math.round(g),pa.pingPongCursorRadius=Math.round(g),pa.bubblesDeflectRadius=Math.round(g);const w=Math.max(0,h(pa.particleFountainMouseRepelRadiusVw??5,t));pa.particleFountainMouseRepelRadius=Math.round(w)}function m(){const t=document.documentElement,e=pa.isMobile||pa.isMobileViewport,n=e?Math.max(.5,pa.mobileWallThicknessXFactor||1):1,o=e?1:Math.max(.5,pa.desktopWallThicknessFactor||1);t.style.setProperty("--container-border",pa.containerBorder+"px"),t.style.setProperty("--container-border-x",pa.containerBorderX+"px"),t.style.setProperty("--container-border-y",pa.containerBorder+"px"),t.style.setProperty("--simulation-padding",pa.simulationPadding+"px"),t.style.setProperty("--content-padding",pa.contentPadding+"px"),t.style.setProperty("--content-padding-x",pa.contentPaddingX+"px"),t.style.setProperty("--content-padding-y",pa.contentPaddingY+"px"),t.style.setProperty("--wall-radius",pa.wallRadius+"px"),t.style.setProperty("--wall-thickness",pa.wallThickness+"px");try{const e=s(),n=c(),o=Math.max(0,e*n),a=Math.sqrt(o);t.style.setProperty("--layout-viewport-area-px",Math.round(o)+""),t.style.setProperty("--layout-viewport-size-px",Math.round(a)+"px")}catch(u){}const a=pa.containerBorderVw||1.3;t.style.setProperty("--container-border-vw",""+a*o),t.style.setProperty("--container-border-x-vw",""+a*n),t.style.setProperty("--wall-thickness-vw",""+(Number.isFinite(pa.wallThicknessVw)&&pa.wallThicknessVw>0?pa.wallThicknessVw:pa.containerBorderVw)*(e?n:o)),t.style.setProperty("--edge-label-inset-adjust",(pa.edgeLabelInsetAdjustPx||0)+"px");const i=Number.isFinite(pa.edgeCaptionDistanceMinPx)?pa.edgeCaptionDistanceMinPx:8,r=Number.isFinite(pa.edgeCaptionDistanceMaxPx)?pa.edgeCaptionDistanceMaxPx:48;t.style.setProperty("--edge-caption-distance-min",Math.max(0,i)+"px"),t.style.setProperty("--edge-caption-distance-max",Math.max(i,r)+"px"),t.style.setProperty("--simulation-overlay-intensity",(Number.isFinite(pa.simulationOverlayIntensity)?Math.max(0,Math.min(1,pa.simulationOverlayIntensity)):1)+"");const l=pa.wallThickness+pa.contentPadding;t.style.setProperty("--edge-inset",l+"px"),t.style.setProperty("--edge-inset-lg",l+"px"),e?t.style.setProperty("--edge-label-mobile-display",pa.mobileEdgeLabelsVisible?"flex":"none"):t.style.removeProperty("--edge-label-mobile-display"),t.style.setProperty("--ui-hit-area-mul",(pa.uiHitAreaMul??1)+""),t.style.setProperty("--ui-icon-corner-radius-mul",(pa.uiIconCornerRadiusMul??.5)+""),Number.isFinite(pa.uiIconFramePx)&&pa.uiIconFramePx>0?t.style.setProperty("--ui-icon-frame-size",Math.round(pa.uiIconFramePx)+"px"):t.style.removeProperty("--ui-icon-frame-size"),Number.isFinite(pa.uiIconGlyphPx)&&pa.uiIconGlyphPx>0?t.style.setProperty("--ui-icon-glyph-size",Math.round(pa.uiIconGlyphPx)+"px"):t.style.removeProperty("--ui-icon-glyph-size"),Number.isFinite(pa.uiIconGroupMarginPx)&&0!==pa.uiIconGroupMarginPx?t.style.setProperty("--ui-icon-group-margin",Math.round(pa.uiIconGroupMarginPx)+"px"):t.style.removeProperty("--ui-icon-group-margin")}function p(o){if(pa.config={...o},void 0!==o.layoutViewportWidthPx&&(pa.layoutViewportWidthPx=i(o.layoutViewportWidthPx,0,4096,0)),o.ballMass&&(pa.ballMassKg=o.ballMass),void 0!==o.gravityMultiplier&&(pa.gravityMultiplier=o.gravityMultiplier,pa.gravityMultiplierPit=o.gravityMultiplier),o.restitution&&(pa.REST=o.restitution),o.friction&&(pa.FRICTION=o.friction),void 0!==o.ballScale&&(pa.sizeScale=o.ballScale),void 0!==o.sizeScale&&(pa.sizeScale=o.sizeScale),void 0!==o.sizeVariationGlobalMul&&(pa.sizeVariationGlobalMul=i(o.sizeVariationGlobalMul,0,2,pa.sizeVariationGlobalMul)),void 0!==o.sizeVariationCap&&(pa.sizeVariationCap=i(o.sizeVariationCap,0,.2,pa.sizeVariationCap)),void 0!==o.sizeVariationPit&&(pa.sizeVariationPit=i(o.sizeVariationPit,0,1,pa.sizeVariationPit)),void 0!==o.sizeVariationFlies&&(pa.sizeVariationFlies=i(o.sizeVariationFlies,0,1,pa.sizeVariationFlies)),void 0!==o.sizeVariationWeightless&&(pa.sizeVariationWeightless=i(o.sizeVariationWeightless,0,1,pa.sizeVariationWeightless)),void 0!==o.sizeVariationWater&&(pa.sizeVariationWater=i(o.sizeVariationWater,0,1,pa.sizeVariationWater)),void 0!==o.sizeVariationVortex&&(pa.sizeVariationVortex=i(o.sizeVariationVortex,0,1,pa.sizeVariationVortex)),void 0!==o.sizeVariationPingPong&&(pa.sizeVariationPingPong=i(o.sizeVariationPingPong,0,1,pa.sizeVariationPingPong)),void 0!==o.sizeVariationMagnetic&&(pa.sizeVariationMagnetic=i(o.sizeVariationMagnetic,0,1,pa.sizeVariationMagnetic)),void 0!==o.sizeVariationBubbles&&(pa.sizeVariationBubbles=i(o.sizeVariationBubbles,0,1,pa.sizeVariationBubbles)),void 0!==o.sizeVariationKaleidoscope&&(pa.sizeVariationKaleidoscope=i(o.sizeVariationKaleidoscope,0,1,pa.sizeVariationKaleidoscope)),void 0!==o.sizeVariationCritters&&(pa.sizeVariationCritters=i(o.sizeVariationCritters,0,1,pa.sizeVariationCritters)),void 0!==o.sizeVariationNeural&&(pa.sizeVariationNeural=i(o.sizeVariationNeural,0,1,pa.sizeVariationNeural)),void 0!==o.sizeVariationParallaxLinear&&(pa.sizeVariationParallaxLinear=i(o.sizeVariationParallaxLinear,0,1,pa.sizeVariationParallaxLinear)),void 0!==o.sizeVariation&&(pa.sizeVariation=o.sizeVariation),Array.isArray(o.colorDistribution)){const t=o.colorDistribution,e=Array.isArray(pa.colorDistribution)?pa.colorDistribution:[],n=[];for(let o=0;7>o;o++){const a=e[o]||{},i=t[o]||{};let s="string"==typeof i.label&&i.label.trim()?i.label.trim():"string"==typeof a.label?a.label:"Discipline "+(o+1);"frontend craft"===(s+"").trim().toLowerCase()&&(s="Art & Visual Direction");const c=r(i.colorIndex,0,7,r(a.colorIndex,0,7,0)),l=r(i.weight,0,100,r(a.weight,0,100,0));n.push({label:s,colorIndex:c,weight:l})}pa.colorDistribution=n}if(void 0!==o.pitWarmupFrames&&(pa.pitWarmupFrames=r(o.pitWarmupFrames,0,240,pa.pitWarmupFrames)),void 0!==o.fliesWarmupFrames&&(pa.fliesWarmupFrames=r(o.fliesWarmupFrames,0,240,pa.fliesWarmupFrames)),void 0!==o.weightlessWarmupFrames&&(pa.weightlessWarmupFrames=r(o.weightlessWarmupFrames,0,240,pa.weightlessWarmupFrames)),void 0!==o.waterWarmupFrames&&(pa.waterWarmupFrames=r(o.waterWarmupFrames,0,240,pa.waterWarmupFrames)),void 0!==o.vortexWarmupFrames&&(pa.vortexWarmupFrames=r(o.vortexWarmupFrames,0,240,pa.vortexWarmupFrames)),void 0!==o.pingPongWarmupFrames&&(pa.pingPongWarmupFrames=r(o.pingPongWarmupFrames,0,240,pa.pingPongWarmupFrames)),void 0!==o.magneticWarmupFrames&&(pa.magneticWarmupFrames=r(o.magneticWarmupFrames,0,240,pa.magneticWarmupFrames)),void 0!==o.bubblesWarmupFrames&&(pa.bubblesWarmupFrames=r(o.bubblesWarmupFrames,0,240,pa.bubblesWarmupFrames)),void 0!==o.kaleidoscope3WarmupFrames&&(pa.kaleidoscope3WarmupFrames=r(o.kaleidoscope3WarmupFrames,0,240,pa.kaleidoscope3WarmupFrames)),void 0!==o.crittersWarmupFrames&&(pa.crittersWarmupFrames=r(o.crittersWarmupFrames,0,240,pa.crittersWarmupFrames)),void 0!==o.neuralWarmupFrames&&(pa.neuralWarmupFrames=r(o.neuralWarmupFrames,0,240,pa.neuralWarmupFrames)),void 0!==o.parallaxLinearWarmupFrames&&(pa.parallaxLinearWarmupFrames=r(o.parallaxLinearWarmupFrames,0,240,pa.parallaxLinearWarmupFrames)),void 0!==o.elasticCenterWarmupFrames&&(pa.elasticCenterWarmupFrames=r(o.elasticCenterWarmupFrames,0,240,pa.elasticCenterWarmupFrames)),void 0!==o.maxBalls&&(pa.maxBalls=o.maxBalls),void 0!==o.repelRadius&&(pa.repelRadius=o.repelRadius),void 0!==o.repelPower&&(pa.repelPower=o.repelPower),void 0!==o.repelSoft&&(pa.repelSoft=o.repelSoft),void 0!==o.repelSoftness&&(pa.repelSoft=o.repelSoftness),void 0!==o.cursorInfluenceRadiusVw?pa.cursorInfluenceRadiusVw=i(o.cursorInfluenceRadiusVw,0,80,pa.cursorInfluenceRadiusVw):void 0!==o.repelRadius&&(pa.cursorInfluenceRadiusVw=i(o.repelRadius/10,0,80,pa.cursorInfluenceRadiusVw)),void 0!==o.ballSizeDesktop&&(pa.ballSizeDesktop=o.ballSizeDesktop),void 0!==o.ballSizeMobile&&(pa.ballSizeMobile=o.ballSizeMobile),void 0!==o.liteModeEnabled&&(pa.liteModeEnabled=!!o.liteModeEnabled),void 0!==o.liteModeObjectReductionFactor&&(pa.liteModeObjectReductionFactor=i(o.liteModeObjectReductionFactor,0,1,pa.liteModeObjectReductionFactor)),void 0!==o.mobileObjectReductionFactor&&(pa.mobileObjectReductionFactor=i(o.mobileObjectReductionFactor,0,1,pa.mobileObjectReductionFactor)),void 0!==o.mobileObjectReductionThreshold&&(pa.mobileObjectReductionThreshold=r(o.mobileObjectReductionThreshold,0,1e4,pa.mobileObjectReductionThreshold)),y(),x(),void 0!==o.kaleidoscopeBallCount&&(pa.kaleidoscopeBallCount=i(o.kaleidoscopeBallCount,10,300,pa.kaleidoscopeBallCount)),void 0!==o.kaleidoscopeDotSizeVh&&(pa.kaleidoscopeDotSizeVh=i(o.kaleidoscopeDotSizeVh,.1,6,pa.kaleidoscopeDotSizeVh)),void 0!==o.kaleidoscopeDotAreaMul&&(pa.kaleidoscopeDotAreaMul=i(o.kaleidoscopeDotAreaMul,.1,2,pa.kaleidoscopeDotAreaMul)),void 0!==o.kaleidoscopeSpawnAreaMul&&(pa.kaleidoscopeSpawnAreaMul=i(o.kaleidoscopeSpawnAreaMul,.2,2,pa.kaleidoscopeSpawnAreaMul)),void 0!==o.kaleidoscopeSizeVariance&&(pa.kaleidoscopeSizeVariance=i(o.kaleidoscopeSizeVariance,0,1,pa.kaleidoscopeSizeVariance)),void 0!==o.kaleidoscope3BallCount&&(pa.kaleidoscope3BallCount=i(o.kaleidoscope3BallCount,3,300,pa.kaleidoscope3BallCount)),void 0!==o.kaleidoscope3Wedges&&(pa.kaleidoscope3Wedges=i(o.kaleidoscope3Wedges,3,24,pa.kaleidoscope3Wedges)),void 0!==o.kaleidoscope3Speed&&(pa.kaleidoscope3Speed=i(o.kaleidoscope3Speed,.2,2,pa.kaleidoscope3Speed)),void 0!==o.kaleidoscope3DotSizeVh&&(pa.kaleidoscope3DotSizeVh=i(o.kaleidoscope3DotSizeVh,.1,6,pa.kaleidoscope3DotSizeVh)),void 0!==o.kaleidoscope3DotAreaMul&&(pa.kaleidoscope3DotAreaMul=i(o.kaleidoscope3DotAreaMul,.1,2,pa.kaleidoscope3DotAreaMul)),void 0!==o.kaleidoscope3SpawnAreaMul&&(pa.kaleidoscope3SpawnAreaMul=i(o.kaleidoscope3SpawnAreaMul,.2,2,pa.kaleidoscope3SpawnAreaMul)),void 0!==o.kaleidoscope3SizeVariance&&(pa.kaleidoscope3SizeVariance=i(o.kaleidoscope3SizeVariance,0,1,pa.kaleidoscope3SizeVariance)),void 0!==o.kaleidoscopeWedges?pa.kaleidoscopeWedges=i(o.kaleidoscopeWedges,3,24,pa.kaleidoscopeWedges):void 0!==o.kaleidoscopeSegments&&(pa.kaleidoscopeWedges=i(o.kaleidoscopeSegments,3,24,pa.kaleidoscopeWedges)),void 0!==o.kaleidoscopeMirror&&(pa.kaleidoscopeMirror=i(o.kaleidoscopeMirror,0,1,pa.kaleidoscopeMirror)),void 0!==o.kaleidoscopeSpeed)pa.kaleidoscopeSpeed=i(o.kaleidoscopeSpeed,.2,2,pa.kaleidoscopeSpeed);else if(void 0!==o.kaleidoscopeSwirlStrength){const t=i(o.kaleidoscopeSwirlStrength,0,800,52);pa.kaleidoscopeSpeed=i(.2+t/800*1.8,.2,2,pa.kaleidoscopeSpeed)}void 0!==o.critterCount&&(pa.critterCount=o.critterCount),void 0!==o.critterSpeed&&(pa.critterSpeed=o.critterSpeed),void 0!==o.critterMaxSpeed&&(pa.critterMaxSpeed=o.critterMaxSpeed),void 0!==o.critterStepHz&&(pa.critterStepHz=o.critterStepHz),void 0!==o.critterStepSharpness&&(pa.critterStepSharpness=o.critterStepSharpness),void 0!==o.critterTurnNoise&&(pa.critterTurnNoise=o.critterTurnNoise),void 0!==o.critterTurnDamp&&(pa.critterTurnDamp=o.critterTurnDamp),void 0!==o.critterTurnSeek&&(pa.critterTurnSeek=o.critterTurnSeek),void 0!==o.critterAvoidRadius&&(pa.critterAvoidRadius=o.critterAvoidRadius),void 0!==o.critterAvoidForce&&(pa.critterAvoidForce=o.critterAvoidForce),void 0!==o.critterEdgeAvoid&&(pa.critterEdgeAvoid=o.critterEdgeAvoid),void 0!==o.critterMousePull&&(pa.critterMousePull=o.critterMousePull),pa.layoutMinWallRadiusPx=void 0!==o.layoutMinWallRadiusPx?i(o.layoutMinWallRadiusPx,0,400,pa.layoutMinWallRadiusPx):n("--layout-min-wall-radius",pa.layoutMinWallRadiusPx),void 0!==o.critterMouseRadiusVw&&(pa.critterMouseRadiusVw=o.critterMouseRadiusVw),void 0!==o.critterRestitution&&(pa.critterRestitution=o.critterRestitution),void 0!==o.critterFriction&&(pa.critterFriction=o.critterFriction),void 0!==o.neuralBallCount&&(pa.neuralBallCount=i(o.neuralBallCount,8,400,pa.neuralBallCount)),void 0!==o.neuralLinkDistanceVw&&(pa.neuralLinkDistanceVw=i(o.neuralLinkDistanceVw,1,50,pa.neuralLinkDistanceVw)),void 0!==o.neuralLineOpacity&&(pa.neuralLineOpacity=i(o.neuralLineOpacity,0,1,pa.neuralLineOpacity)),void 0!==o.neuralConnectorDensity&&(pa.neuralConnectorDensity=i(o.neuralConnectorDensity,0,10,pa.neuralConnectorDensity)),void 0!==o.neuralWanderStrength&&(pa.neuralWanderStrength=i(o.neuralWanderStrength,0,4e3,pa.neuralWanderStrength)),void 0!==o.neuralMouseStrength&&(pa.neuralMouseStrength=i(o.neuralMouseStrength,0,3e5,pa.neuralMouseStrength)),void 0!==o.neuralSeparationRadius&&(pa.neuralSeparationRadius=i(o.neuralSeparationRadius,50,300,pa.neuralSeparationRadius)),void 0!==o.neuralSeparationStrength&&(pa.neuralSeparationStrength=i(o.neuralSeparationStrength,0,3e4,pa.neuralSeparationStrength)),void 0!==o.neuralMaxLinksPerBall&&(pa.neuralMaxLinksPerBall=i(o.neuralMaxLinksPerBall,0,16,pa.neuralMaxLinksPerBall)),void 0!==o.neuralDamping&&(pa.neuralDamping=i(o.neuralDamping,.8,1,pa.neuralDamping)),void 0!==o.parallaxLinearDotCount&&(pa.parallaxLinearDotCount=i(o.parallaxLinearDotCount,20,220,pa.parallaxLinearDotCount)),void 0!==o.parallaxLinearGridJitter&&(pa.parallaxLinearGridJitter=i(o.parallaxLinearGridJitter,0,1,pa.parallaxLinearGridJitter)),void 0!==o.parallaxLinearFarSpeed&&(pa.parallaxLinearFarSpeed=i(o.parallaxLinearFarSpeed,0,1.5,pa.parallaxLinearFarSpeed)),void 0!==o.parallaxLinearMidSpeed&&(pa.parallaxLinearMidSpeed=i(o.parallaxLinearMidSpeed,0,1.5,pa.parallaxLinearMidSpeed)),void 0!==o.parallaxLinearNearSpeed&&(pa.parallaxLinearNearSpeed=i(o.parallaxLinearNearSpeed,0,1.5,pa.parallaxLinearNearSpeed)),void 0!==o.parallaxLinearGridX&&(pa.parallaxLinearGridX=r(o.parallaxLinearGridX,3,40,pa.parallaxLinearGridX)),void 0!==o.parallaxLinearGridY&&(pa.parallaxLinearGridY=r(o.parallaxLinearGridY,3,40,pa.parallaxLinearGridY)),void 0!==o.parallaxLinearGridZ&&(pa.parallaxLinearGridZ=r(o.parallaxLinearGridZ,2,20,pa.parallaxLinearGridZ)),void 0!==o.parallaxLinearSpanX&&(pa.parallaxLinearSpanX=i(o.parallaxLinearSpanX,.2,3,pa.parallaxLinearSpanX)),void 0!==o.parallaxLinearSpanY&&(pa.parallaxLinearSpanY=i(o.parallaxLinearSpanY,.2,3,pa.parallaxLinearSpanY)),void 0!==o.parallaxLinearZNear&&(pa.parallaxLinearZNear=i(o.parallaxLinearZNear,10,1200,pa.parallaxLinearZNear)),void 0!==o.parallaxLinearZFar&&(pa.parallaxLinearZFar=i(o.parallaxLinearZFar,50,3e3,pa.parallaxLinearZFar)),void 0!==o.parallaxLinearFocalLength&&(pa.parallaxLinearFocalLength=i(o.parallaxLinearFocalLength,80,2e3,pa.parallaxLinearFocalLength)),void 0!==o.parallaxLinearParallaxStrength&&(pa.parallaxLinearParallaxStrength=i(o.parallaxLinearParallaxStrength,0,2e3,pa.parallaxLinearParallaxStrength)),void 0!==o.parallaxLinearDotSizeMul&&(pa.parallaxLinearDotSizeMul=i(o.parallaxLinearDotSizeMul,.1,6,pa.parallaxLinearDotSizeMul)),void 0!==o.parallaxLinearFollowStrength&&(pa.parallaxLinearFollowStrength=i(o.parallaxLinearFollowStrength,1,80,pa.parallaxLinearFollowStrength)),void 0!==o.parallaxLinearDamping&&(pa.parallaxLinearDamping=i(o.parallaxLinearDamping,1,80,pa.parallaxLinearDamping)),void 0!==o.cursorExplosionImpactMinFactor&&(pa.cursorExplosionImpactMinFactor=i(o.cursorExplosionImpactMinFactor,.1,2,pa.cursorExplosionImpactMinFactor)),void 0!==o.cursorExplosionImpactMaxFactor&&(pa.cursorExplosionImpactMaxFactor=i(o.cursorExplosionImpactMaxFactor,1,8,pa.cursorExplosionImpactMaxFactor)),void 0!==o.cursorExplosionImpactSensitivity&&(pa.cursorExplosionImpactSensitivity=i(o.cursorExplosionImpactSensitivity,100,1e3,pa.cursorExplosionImpactSensitivity)),void 0!==o.cursorExplosionLifetimeImpactMin&&(pa.cursorExplosionLifetimeImpactMin=i(o.cursorExplosionLifetimeImpactMin,.3,1.5,pa.cursorExplosionLifetimeImpactMin)),void 0!==o.cursorExplosionLifetimeImpactMax&&(pa.cursorExplosionLifetimeImpactMax=i(o.cursorExplosionLifetimeImpactMax,1,3,pa.cursorExplosionLifetimeImpactMax)),void 0!==o.cursorExplosionLifetimeImpactSensitivity&&(pa.cursorExplosionLifetimeImpactSensitivity=i(o.cursorExplosionLifetimeImpactSensitivity,200,1500,pa.cursorExplosionLifetimeImpactSensitivity));for(const[t,e]of Object.entries(o||{}))t in pa&&"config"!==t&&"soundConfig"!==t&&"soundPreset"!==t&&"function"!=typeof pa[t]&&(Array.isArray(e)||null===e||["string","number","boolean"].includes(typeof e))&&void 0!==e&&(pa[t]=e);if(void 0!==o.sphere3dRadiusVw&&(pa.sphere3dRadiusVw=i(o.sphere3dRadiusVw,5,40,pa.sphere3dRadiusVw)),void 0!==o.sphere3dDensity&&(pa.sphere3dDensity=r(o.sphere3dDensity,30,600,pa.sphere3dDensity)),void 0!==o.sphere3dFocalLength&&(pa.sphere3dFocalLength=r(o.sphere3dFocalLength,80,2e3,pa.sphere3dFocalLength)),void 0!==o.sphere3dDotSizeMul&&(pa.sphere3dDotSizeMul=i(o.sphere3dDotSizeMul,.2,4,pa.sphere3dDotSizeMul)),void 0!==o.sphere3dIdleSpeed&&(pa.sphere3dIdleSpeed=i(o.sphere3dIdleSpeed,0,1,pa.sphere3dIdleSpeed)),void 0!==o.sphere3dCursorInfluence&&(pa.sphere3dCursorInfluence=i(o.sphere3dCursorInfluence,0,4,pa.sphere3dCursorInfluence)),void 0!==o.sphere3dTumbleSpeed&&(pa.sphere3dTumbleSpeed=i(o.sphere3dTumbleSpeed,0,10,pa.sphere3dTumbleSpeed)),void 0!==o.sphere3dTumbleDamping&&(pa.sphere3dTumbleDamping=i(o.sphere3dTumbleDamping,.8,.99,pa.sphere3dTumbleDamping)),void 0!==o.sphere3dWarmupFrames&&(pa.sphere3dWarmupFrames=r(o.sphere3dWarmupFrames,0,240,pa.sphere3dWarmupFrames)),void 0!==o.cube3dSizeVw&&(pa.cube3dSizeVw=i(o.cube3dSizeVw,10,50,pa.cube3dSizeVw)),void 0!==o.cube3dEdgeDensity&&(pa.cube3dEdgeDensity=r(o.cube3dEdgeDensity,2,30,pa.cube3dEdgeDensity)),void 0!==o.cube3dFaceGrid&&(pa.cube3dFaceGrid=r(o.cube3dFaceGrid,0,10,pa.cube3dFaceGrid)),void 0!==o.cube3dIdleSpeed&&(pa.cube3dIdleSpeed=i(o.cube3dIdleSpeed,0,1,pa.cube3dIdleSpeed)),void 0!==o.cube3dCursorInfluence&&(pa.cube3dCursorInfluence=i(o.cube3dCursorInfluence,0,4,pa.cube3dCursorInfluence)),void 0!==o.cube3dTumbleSpeed&&(pa.cube3dTumbleSpeed=i(o.cube3dTumbleSpeed,0,10,pa.cube3dTumbleSpeed)),void 0!==o.cube3dTumbleDamping&&(pa.cube3dTumbleDamping=i(o.cube3dTumbleDamping,.8,.99,pa.cube3dTumbleDamping)),void 0!==o.cube3dFocalLength&&(pa.cube3dFocalLength=r(o.cube3dFocalLength,80,2e3,pa.cube3dFocalLength)),void 0!==o.cube3dDotSizeMul&&(pa.cube3dDotSizeMul=i(o.cube3dDotSizeMul,.2,4,pa.cube3dDotSizeMul)),void 0!==o.cube3dWarmupFrames&&(pa.cube3dWarmupFrames=r(o.cube3dWarmupFrames,0,240,pa.cube3dWarmupFrames)),void 0!==o.starfieldCount&&(pa.starfieldCount=r(o.starfieldCount,20,500,pa.starfieldCount)),void 0!==o.starfieldSpanX&&(pa.starfieldSpanX=i(o.starfieldSpanX,.4,4,pa.starfieldSpanX)),void 0!==o.starfieldSpanY&&(pa.starfieldSpanY=i(o.starfieldSpanY,.4,4,pa.starfieldSpanY)),void 0!==o.starfieldZNear&&(pa.starfieldZNear=r(o.starfieldZNear,20,800,pa.starfieldZNear)),void 0!==o.starfieldZFar&&(pa.starfieldZFar=r(o.starfieldZFar,400,4e3,pa.starfieldZFar)),void 0!==o.starfieldFocalLength&&(pa.starfieldFocalLength=r(o.starfieldFocalLength,100,2e3,pa.starfieldFocalLength)),void 0!==o.starfieldParallaxStrength&&(pa.starfieldParallaxStrength=r(o.starfieldParallaxStrength,0,1200,pa.starfieldParallaxStrength)),void 0!==o.starfieldSpeed&&(pa.starfieldSpeed=r(o.starfieldSpeed,10,1600,pa.starfieldSpeed)),void 0!==o.starfieldDotSizeMul&&(pa.starfieldDotSizeMul=i(o.starfieldDotSizeMul,.2,4,pa.starfieldDotSizeMul)),void 0!==o.starfieldIdleJitter&&(pa.starfieldIdleJitter=i(o.starfieldIdleJitter,0,20,pa.starfieldIdleJitter)),void 0!==o.starfieldFadeDuration&&(pa.starfieldFadeDuration=i(o.starfieldFadeDuration,0,3,pa.starfieldFadeDuration)),void 0!==o.starfield3dWarmupFrames&&(pa.starfield3dWarmupFrames=r(o.starfield3dWarmupFrames,0,240,pa.starfield3dWarmupFrames)),void 0!==o.dvdLogoSpeed&&(pa.dvdLogoSpeed=r(o.dvdLogoSpeed,200,800,pa.dvdLogoSpeed)),void 0!==o.dvdLogoSize&&(pa.dvdLogoSize=i(o.dvdLogoSize,.5,2,pa.dvdLogoSize)),void 0!==o.dvdLogoBallCount&&(pa.dvdLogoBallCount=r(o.dvdLogoBallCount,30,120,pa.dvdLogoBallCount)),void 0!==o.dvdLogoBallSpacing&&(pa.dvdLogoBallSpacing=i(o.dvdLogoBallSpacing,1,2,pa.dvdLogoBallSpacing)),void 0!==o.dvdLogoLetterSpacing&&(pa.dvdLogoLetterSpacing=i(o.dvdLogoLetterSpacing,.5,2,pa.dvdLogoLetterSpacing)),void 0!==o.dvdLogoMassMultiplier&&(pa.dvdLogoMassMultiplier=i(o.dvdLogoMassMultiplier,1,5,pa.dvdLogoMassMultiplier)),void 0!==o.dvdLogoWarmupFrames&&(pa.dvdLogoWarmupFrames=r(o.dvdLogoWarmupFrames,0,240,pa.dvdLogoWarmupFrames)),void 0!==o.elasticCenterBallCount&&(pa.elasticCenterBallCount=r(o.elasticCenterBallCount,20,120,pa.elasticCenterBallCount)),void 0!==o.elasticCenterMassMultiplier&&(pa.elasticCenterMassMultiplier=i(o.elasticCenterMassMultiplier,.5,5,pa.elasticCenterMassMultiplier)),void 0!==o.elasticCenterSpacingMultiplier&&(pa.elasticCenterSpacingMultiplier=i(o.elasticCenterSpacingMultiplier,2,4,pa.elasticCenterSpacingMultiplier)),void 0!==o.elasticCenterElasticStrength&&(pa.elasticCenterElasticStrength=r(o.elasticCenterElasticStrength,0,15e3,pa.elasticCenterElasticStrength)),void 0!==o.elasticCenterMouseRepelStrength&&(pa.elasticCenterMouseRepelStrength=r(o.elasticCenterMouseRepelStrength,3e3,25e3,pa.elasticCenterMouseRepelStrength)),void 0!==o.elasticCenterMouseRadius&&(pa.elasticCenterMouseRadius=r(o.elasticCenterMouseRadius,50,400,pa.elasticCenterMouseRadius)),void 0!==o.elasticCenterDamping&&(pa.elasticCenterDamping=i(o.elasticCenterDamping,.85,.99,pa.elasticCenterDamping)),void 0!==o.elasticCenterWarmupFrames&&(pa.elasticCenterWarmupFrames=r(o.elasticCenterWarmupFrames,0,240,pa.elasticCenterWarmupFrames)),void 0!==o.snakeBallCount&&(pa.snakeBallCount=r(o.snakeBallCount,20,100,pa.snakeBallCount)),void 0!==o.snakeRestLength&&(pa.snakeRestLength=i(o.snakeRestLength,15,80,pa.snakeRestLength)),void 0!==o.snakeSpringStrength&&(pa.snakeSpringStrength=r(o.snakeSpringStrength,1,1e3,pa.snakeSpringStrength)),void 0!==o.snakeDamping&&(pa.snakeDamping=i(o.snakeDamping,.9,.995,pa.snakeDamping)),void 0!==o.snakeGroundFriction&&(pa.snakeGroundFriction=i(o.snakeGroundFriction,0,2,pa.snakeGroundFriction)),void 0!==o.snakeSpeed&&(pa.snakeSpeed=r(o.snakeSpeed,100,800,pa.snakeSpeed)),void 0!==o.snakeWarmupFrames&&(pa.snakeWarmupFrames=r(o.snakeWarmupFrames,0,240,pa.snakeWarmupFrames)),void 0!==o.particleFountainEmissionRate&&(pa.particleFountainEmissionRate=r(o.particleFountainEmissionRate,5,100,pa.particleFountainEmissionRate)),void 0!==o.particleFountainInitialVelocity&&(pa.particleFountainInitialVelocity=r(o.particleFountainInitialVelocity,200,1e4,pa.particleFountainInitialVelocity)),void 0!==o.particleFountainSpreadAngle&&(pa.particleFountainSpreadAngle=r(o.particleFountainSpreadAngle,10,120,pa.particleFountainSpreadAngle)),void 0!==o.particleFountainWaterDrag&&(pa.particleFountainWaterDrag=i(o.particleFountainWaterDrag,.01,.2,pa.particleFountainWaterDrag)),void 0!==o.particleFountainGravityMultiplier&&(pa.particleFountainGravityMultiplier=i(o.particleFountainGravityMultiplier,0,2,pa.particleFountainGravityMultiplier)),void 0!==o.particleFountainUpwardForce&&(pa.particleFountainUpwardForce=r(o.particleFountainUpwardForce,0,800,pa.particleFountainUpwardForce)),void 0!==o.particleFountainMaxParticles&&(pa.particleFountainMaxParticles=r(o.particleFountainMaxParticles,20,300,pa.particleFountainMaxParticles)),void 0!==o.particleFountainLifetime&&(pa.particleFountainLifetime=i(o.particleFountainLifetime,1,30,pa.particleFountainLifetime)),void 0!==o.particleFountainMouseRepelStrength&&(pa.particleFountainMouseRepelStrength=r(o.particleFountainMouseRepelStrength,1e4,1e5,pa.particleFountainMouseRepelStrength)),void 0!==o.particleFountainMouseRepelRadiusVw&&(pa.particleFountainMouseRepelRadiusVw=i(o.particleFountainMouseRepelRadiusVw,1,20,pa.particleFountainMouseRepelRadiusVw)),void 0!==o.particleFountainWarmupFrames&&(pa.particleFountainWarmupFrames=r(o.particleFountainWarmupFrames,0,240,pa.particleFountainWarmupFrames)),void 0!==o.sceneImpactEnabled&&(pa.sceneImpactEnabled=!!o.sceneImpactEnabled),void 0!==o.sceneImpactMul?pa.sceneImpactMul=i(o.sceneImpactMul,0,.05,pa.sceneImpactMul):void 0!==o.brandLogoImpactMul&&(pa.sceneImpactMul=i(o.brandLogoImpactMul,0,.05,pa.sceneImpactMul)),void 0!==o.sceneImpactMobileMulFactor&&(pa.sceneImpactMobileMulFactor=i(o.sceneImpactMobileMulFactor,.25,3,pa.sceneImpactMobileMulFactor)),void 0!==o.sceneImpactLogoCompMul&&(pa.sceneImpactLogoCompMul=i(o.sceneImpactLogoCompMul,.25,6,pa.sceneImpactLogoCompMul)),void 0!==o.sceneImpactOvershoot?pa.sceneImpactOvershoot=i(o.sceneImpactOvershoot,0,.8,pa.sceneImpactOvershoot):void 0!==o.brandLogoOvershoot&&(pa.sceneImpactOvershoot=i(o.brandLogoOvershoot,0,.8,pa.sceneImpactOvershoot)),void 0!==o.sceneImpactAnticipation?pa.sceneImpactAnticipation=i(o.sceneImpactAnticipation,0,.6,pa.sceneImpactAnticipation):void 0!==o.brandLogoAnticipation&&(pa.sceneImpactAnticipation=i(o.brandLogoAnticipation,0,.6,pa.sceneImpactAnticipation)),void 0!==o.sceneImpactPressMs?pa.sceneImpactPressMs=i(o.sceneImpactPressMs,20,300,pa.sceneImpactPressMs):void 0!==o.brandLogoPressMs&&(pa.sceneImpactPressMs=i(o.brandLogoPressMs,20,300,pa.sceneImpactPressMs)),void 0!==o.sceneImpactReleaseMs?pa.sceneImpactReleaseMs=i(o.sceneImpactReleaseMs,40,1200,pa.sceneImpactReleaseMs):void 0!==o.brandLogoReleaseMs&&(pa.sceneImpactReleaseMs=i(o.brandLogoReleaseMs,40,1200,pa.sceneImpactReleaseMs)),void 0!==o.sceneChangeSoundEnabled&&(pa.sceneChangeSoundEnabled=!!o.sceneChangeSoundEnabled),void 0!==o.sceneChangeSoundIntensity&&(pa.sceneChangeSoundIntensity=i(o.sceneChangeSoundIntensity,0,1,pa.sceneChangeSoundIntensity)),void 0!==o.sceneChangeSoundRadius&&(pa.sceneChangeSoundRadius=i(o.sceneChangeSoundRadius,6,60,pa.sceneChangeSoundRadius)),void 0!==o.containerBorder&&(pa.containerBorder=o.containerBorder),void 0!==o.simulationPadding&&(pa.simulationPadding=o.simulationPadding),void 0!==o.contentPadding&&(pa.contentPadding=o.contentPadding),pa.bgLight=void 0!==o.bgLight?o.bgLight:t("--bg-light",pa.bgLight),pa.bgDark=void 0!==o.bgDark?o.bgDark:t("--bg-dark",pa.bgDark),pa.frameColorLight=void 0!==o.frameColorLight?o.frameColorLight:t("--frame-color-light",pa.frameColorLight),pa.frameColorDark=void 0!==o.frameColorDark?o.frameColorDark:t("--frame-color-dark",pa.frameColorDark),void 0!==o.frameColor)pa.frameColor=o.frameColor,pa.frameColorLight=o.frameColor,pa.frameColorDark=o.frameColor;else{const t=pa.frameColorLight||pa.frameColorDark||"#242529";pa.frameColor=t,pa.frameColorLight=t,pa.frameColorDark=t}pa.frameColorLight=pa.frameColor,pa.frameColorDark=pa.frameColor,pa.textColorLight=void 0!==o.textColorLight?o.textColorLight:t("--text-color-light",pa.textColorLight),pa.textColorLightMuted=void 0!==o.textColorLightMuted?o.textColorLightMuted:t("--text-color-light-muted",pa.textColorLightMuted),pa.textColorDark=void 0!==o.textColorDark?o.textColorDark:t("--text-color-dark",pa.textColorDark),pa.textColorDarkMuted=void 0!==o.textColorDarkMuted?o.textColorDarkMuted:t("--text-color-dark-muted",pa.textColorDarkMuted),void 0!==o.edgeLabelInsetAdjustPx&&(pa.edgeLabelInsetAdjustPx=i(o.edgeLabelInsetAdjustPx,-500,500,pa.edgeLabelInsetAdjustPx)),void 0!==o.edgeCaptionDistanceMinPx&&(pa.edgeCaptionDistanceMinPx=r(o.edgeCaptionDistanceMinPx,0,200,pa.edgeCaptionDistanceMinPx)),void 0!==o.edgeCaptionDistanceMaxPx&&(pa.edgeCaptionDistanceMaxPx=r(o.edgeCaptionDistanceMaxPx,0,400,pa.edgeCaptionDistanceMaxPx)),void 0!==o.simulationOverlayIntensity&&(pa.simulationOverlayIntensity=i(o.simulationOverlayIntensity,0,1,pa.simulationOverlayIntensity)),void 0!==o.depthWashOpacity&&(pa.depthWashOpacity=i(o.depthWashOpacity,0,1,pa.depthWashOpacity));const a=["source-over","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion"];if(void 0!==o.depthWashBlendModeLight){const t=o.depthWashBlendModeLight+"";pa.depthWashBlendModeLight=a.includes(t)?t:pa.depthWashBlendModeLight}if(void 0!==o.depthWashBlendModeDark){const t=o.depthWashBlendModeDark+"";pa.depthWashBlendModeDark=a.includes(t)?t:pa.depthWashBlendModeDark}if(void 0!==o.depthWashCenterY&&(pa.depthWashCenterY=i(o.depthWashCenterY,0,1,pa.depthWashCenterY)),void 0!==o.depthWashRadiusScale&&(pa.depthWashRadiusScale=i(o.depthWashRadiusScale,.2,3,pa.depthWashRadiusScale)),void 0!==o.depthWashCenterColorLight&&(pa.depthWashCenterColorLight=o.depthWashCenterColorLight+""),void 0!==o.depthWashEdgeColorLight&&(pa.depthWashEdgeColorLight=o.depthWashEdgeColorLight+""),void 0!==o.depthWashCenterAlphaLight&&(pa.depthWashCenterAlphaLight=i(o.depthWashCenterAlphaLight,0,1,pa.depthWashCenterAlphaLight)),void 0!==o.depthWashEdgeAlphaLight&&(pa.depthWashEdgeAlphaLight=i(o.depthWashEdgeAlphaLight,0,1,pa.depthWashEdgeAlphaLight)),void 0!==o.depthWashCenterColorDark&&(pa.depthWashCenterColorDark=o.depthWashCenterColorDark+""),void 0!==o.depthWashEdgeColorDark&&(pa.depthWashEdgeColorDark=o.depthWashEdgeColorDark+""),void 0!==o.depthWashCenterAlphaDark&&(pa.depthWashCenterAlphaDark=i(o.depthWashCenterAlphaDark,0,1,pa.depthWashCenterAlphaDark)),void 0!==o.depthWashEdgeAlphaDark&&(pa.depthWashEdgeAlphaDark=i(o.depthWashEdgeAlphaDark,0,1,pa.depthWashEdgeAlphaDark)),void 0!==o.topLogoWidthVw&&(pa.topLogoWidthVw=i(o.topLogoWidthVw,0,120,pa.topLogoWidthVw)),void 0!==o.homeMainLinksBelowLogoPx&&(pa.homeMainLinksBelowLogoPx=i(o.homeMainLinksBelowLogoPx,-500,500,pa.homeMainLinksBelowLogoPx)),void 0!==o.footerNavBarTopVh&&(pa.footerNavBarTopVh=i(o.footerNavBarTopVh,0,100,pa.footerNavBarTopVh)),void 0!==o.footerNavBarGapVw&&(pa.footerNavBarGapVw=i(o.footerNavBarGapVw,0,30,pa.footerNavBarGapVw)),pa.linkHoverColor=void 0!==o.linkHoverColor?o.linkHoverColor:t("--link-hover-color",pa.linkHoverColor),void 0!==o.uiHitAreaMul&&(pa.uiHitAreaMul=i(o.uiHitAreaMul,.5,3,pa.uiHitAreaMul)),void 0!==o.uiIconCornerRadiusMul&&(pa.uiIconCornerRadiusMul=i(o.uiIconCornerRadiusMul,0,1,pa.uiIconCornerRadiusMul)),pa.uiIconFramePx=r(void 0!==o.uiIconFramePx?o.uiIconFramePx:n("--ui-icon-frame-size",pa.uiIconFramePx),0,240,pa.uiIconFramePx),pa.uiIconGlyphPx=r(void 0!==o.uiIconGlyphPx?o.uiIconGlyphPx:n("--ui-icon-glyph-size",pa.uiIconGlyphPx),0,120,pa.uiIconGlyphPx),pa.uiIconGroupMarginPx=r(void 0!==o.uiIconGroupMarginPx?o.uiIconGroupMarginPx:n("--ui-icon-group-margin",pa.uiIconGroupMarginPx),-200,200,pa.uiIconGroupMarginPx),void 0!==o.linkTextPadding&&(pa.linkTextPadding=i(o.linkTextPadding,0,200,pa.linkTextPadding)),void 0!==o.linkIconPadding&&(pa.linkIconPadding=i(o.linkIconPadding,0,200,pa.linkIconPadding)),void 0!==o.linkColorInfluence&&(pa.linkColorInfluence=i(o.linkColorInfluence,0,1,pa.linkColorInfluence)),void 0!==o.linkImpactScale&&(pa.linkImpactScale=i(o.linkImpactScale,.5,1,pa.linkImpactScale)),void 0!==o.linkImpactBlur&&(pa.linkImpactBlur=i(o.linkImpactBlur,0,40,pa.linkImpactBlur)),void 0!==o.linkImpactDuration&&(pa.linkImpactDuration=r(o.linkImpactDuration,0,3e3,pa.linkImpactDuration)),void 0!==o.hoverSnapEnabled&&(pa.hoverSnapEnabled=!!o.hoverSnapEnabled),void 0!==o.hoverSnapDuration&&(pa.hoverSnapDuration=r(o.hoverSnapDuration,0,2e3,pa.hoverSnapDuration)),void 0!==o.hoverSnapOvershoot&&(pa.hoverSnapOvershoot=i(o.hoverSnapOvershoot,1,1.35,pa.hoverSnapOvershoot)),void 0!==o.hoverSnapUndershoot&&(pa.hoverSnapUndershoot=i(o.hoverSnapUndershoot,.7,1,pa.hoverSnapUndershoot)),void 0!==o.noiseEnabled&&(pa.noiseEnabled=!!o.noiseEnabled),void 0!==o.noiseSeed&&(pa.noiseSeed=r(o.noiseSeed,0,999999,pa.noiseSeed)),void 0!==o.noiseTextureSize&&(pa.noiseTextureSize=r(o.noiseTextureSize,64,512,pa.noiseTextureSize)),void 0!==o.noiseDistribution){const t=o.noiseDistribution+"";pa.noiseDistribution="uniform"===t||"gaussian"===t?t:pa.noiseDistribution}if(void 0!==o.noiseMonochrome&&(pa.noiseMonochrome=!!o.noiseMonochrome),void 0!==o.noiseChroma&&(pa.noiseChroma=i(o.noiseChroma,0,1,pa.noiseChroma)),void 0!==o.noiseMotion){const t=o.noiseMotion+"";pa.noiseMotion="jitter"===t||"drift"===t||"static"===t?t:pa.noiseMotion}if(void 0!==o.noiseMotionAmount&&(pa.noiseMotionAmount=i(o.noiseMotionAmount,0,2.5,pa.noiseMotionAmount)),void 0!==o.noiseSpeedMs&&(pa.noiseSpeedMs=r(o.noiseSpeedMs,0,1e4,pa.noiseSpeedMs)),void 0!==o.noiseSpeedVariance&&(pa.noiseSpeedVariance=i(o.noiseSpeedVariance,0,1,pa.noiseSpeedVariance)),void 0!==o.noiseFlicker&&(pa.noiseFlicker=i(o.noiseFlicker,0,1,pa.noiseFlicker)),void 0!==o.noiseFlickerSpeedMs&&(pa.noiseFlickerSpeedMs=r(o.noiseFlickerSpeedMs,0,5e3,pa.noiseFlickerSpeedMs)),void 0!==o.noiseBlurPx&&(pa.noiseBlurPx=i(o.noiseBlurPx,0,6,pa.noiseBlurPx)),void 0!==o.noiseContrast&&(pa.noiseContrast=i(o.noiseContrast,.25,5,pa.noiseContrast)),void 0!==o.noiseBrightness&&(pa.noiseBrightness=i(o.noiseBrightness,.25,3,pa.noiseBrightness)),void 0!==o.noiseSaturation&&(pa.noiseSaturation=i(o.noiseSaturation,0,3,pa.noiseSaturation)),void 0!==o.noiseHue&&(pa.noiseHue=i(o.noiseHue,0,360,pa.noiseHue)),void 0!==o.noiseSize&&(pa.noiseSize=i(o.noiseSize,20,600,pa.noiseSize)),void 0!==o.noiseOpacity&&(pa.noiseOpacity=i(o.noiseOpacity,0,1,pa.noiseOpacity)),void 0!==o.noiseOpacityLight&&(pa.noiseOpacityLight=i(o.noiseOpacityLight,0,1,pa.noiseOpacityLight)),void 0!==o.noiseOpacityDark&&(pa.noiseOpacityDark=i(o.noiseOpacityDark,0,1,pa.noiseOpacityDark)),void 0!==o.noiseBlendMode){const t=o.noiseBlendMode+"";pa.noiseBlendMode=["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion"].includes(t)?t:pa.noiseBlendMode}void 0!==o.noiseColorLight&&(pa.noiseColorLight=o.noiseColorLight+""),void 0!==o.noiseColorDark&&(pa.noiseColorDark=o.noiseColorDark+""),void 0!==o.detailNoiseOpacity&&(pa.detailNoiseOpacity=i(o.detailNoiseOpacity,0,1,pa.detailNoiseOpacity)),void 0!==o.wallThickness&&(pa.wallThickness=o.wallThickness),void 0!==o.wallRadius&&(pa.wallRadius=o.wallRadius,pa.cornerRadius=o.wallRadius),void 0!==o.wallInset&&(pa.wallInset=o.wallInset),void 0!==o.wallInset&&(pa.wallInset=o.wallInset),void 0!==o.ballSpacing&&(pa.ballSpacing=o.ballSpacing),void 0!==o.wallPreset&&(pa.wallPreset=o.wallPreset),void 0!==o.wallSoftness&&(pa.wallSoftness=o.wallSoftness),void 0!==o.wallBounciness&&(pa.wallBounciness=o.wallBounciness),void 0!==o.wallWobbleMaxDeform&&(pa.wallWobbleMaxDeform=o.wallWobbleMaxDeform),void 0!==o.wallWobbleStiffness&&(pa.wallWobbleStiffness=o.wallWobbleStiffness),void 0!==o.wallWobbleDamping&&(pa.wallWobbleDamping=o.wallWobbleDamping),void 0!==o.wallWobbleSigma&&(pa.wallWobbleSigma=o.wallWobbleSigma),void 0!==o.wallWobbleCornerClamp&&(pa.wallWobbleCornerClamp=o.wallWobbleCornerClamp),void 0!==o.wallWobbleMaxVel&&(pa.wallWobbleMaxVel=o.wallWobbleMaxVel),void 0!==o.wallWobbleMaxImpulse&&(pa.wallWobbleMaxImpulse=o.wallWobbleMaxImpulse),void 0!==o.wallWobbleMaxEnergyPerStep&&(pa.wallWobbleMaxEnergyPerStep=o.wallWobbleMaxEnergyPerStep),void 0!==o.wallWobbleImpactThreshold&&(pa.wallWobbleImpactThreshold=o.wallWobbleImpactThreshold),void 0!==o.wallWobbleSettlingSpeed&&(pa.wallWobbleSettlingSpeed=o.wallWobbleSettlingSpeed),void 0!==o.wallPhysicsSamples&&(pa.wallPhysicsSamples=o.wallPhysicsSamples),void 0!==o.wallPhysicsSkipInactive&&(pa.wallPhysicsSkipInactive=o.wallPhysicsSkipInactive),void 0!==o.wallPhysicsUpdateHz&&(pa.wallPhysicsUpdateHz=o.wallPhysicsUpdateHz),void 0!==o.wallPhysicsMaxSubstepHz&&(pa.wallPhysicsMaxSubstepHz=o.wallPhysicsMaxSubstepHz),void 0!==o.wallPhysicsInterpolation&&(pa.wallPhysicsInterpolation=o.wallPhysicsInterpolation),void 0!==o.wallPhysicsAdaptiveSamples&&(pa.wallPhysicsAdaptiveSamples=o.wallPhysicsAdaptiveSamples),void 0!==o.wallPhysicsMinSamples&&(pa.wallPhysicsMinSamples=o.wallPhysicsMinSamples),void 0!==o.wallVisualDeformMul&&(pa.wallVisualDeformMul=o.wallVisualDeformMul),void 0!==o.wallRenderDecimation&&(pa.wallRenderDecimation=o.wallRenderDecimation),void 0!==o.wallColorLight&&(pa.frameColorLight=o.wallColorLight,pa.frameColor=o.wallColorLight),void 0!==o.wallColorDark&&(pa.frameColorDark=o.wallColorDark,o.wallColorLight||(pa.frameColor=o.wallColorDark)),void 0!==o.modalOverlayEnabled&&(pa.modalOverlayEnabled=o.modalOverlayEnabled),void 0!==o.modalOverlayOpacity&&(pa.modalOverlayOpacity=o.modalOverlayOpacity),void 0!==o.modalOverlayBlurPx&&(pa.modalOverlayBlurPx=o.modalOverlayBlurPx),void 0!==o.modalOverlayTransitionMs&&(pa.modalOverlayTransitionMs=o.modalOverlayTransitionMs),void 0!==o.modalOverlayTransitionOutMs&&(pa.modalOverlayTransitionOutMs=o.modalOverlayTransitionOutMs);const c=s();if(void 0!==o.containerBorderVw&&(pa.containerBorderVw=i(o.containerBorderVw,0,20,pa.containerBorderVw)),void 0!==o.simulationPaddingVw&&(pa.simulationPaddingVw=i(o.simulationPaddingVw,0,20,pa.simulationPaddingVw)),void 0!==o.contentPaddingRatio){const t=+o.contentPaddingRatio;Number.isFinite(t)&&(pa.contentPaddingRatio=Math.abs(t)>1?i(t,-500,500,pa.contentPaddingRatio):i(t,-.2,.2,pa.contentPaddingRatio))}if(void 0!==o.contentPaddingHorizontalRatio&&(pa.contentPaddingHorizontalRatio=i(o.contentPaddingHorizontalRatio,.1,3,pa.contentPaddingHorizontalRatio)),void 0!==o.contentPaddingBottomRatio&&(pa.contentPaddingBottomRatio=i(o.contentPaddingBottomRatio,.5,2.5,1.3),document.documentElement.style.setProperty("--abs-content-pad-mul-bottom",pa.contentPaddingBottomRatio+"")),void 0!==o.mobileWallThicknessXFactor&&(pa.mobileWallThicknessXFactor=i(o.mobileWallThicknessXFactor,.5,3,pa.mobileWallThicknessXFactor)),void 0!==o.desktopWallThicknessFactor&&(pa.desktopWallThicknessFactor=i(o.desktopWallThicknessFactor,.5,3,pa.desktopWallThicknessFactor)),void 0!==o.mobileEdgeLabelsVisible&&(pa.mobileEdgeLabelsVisible=!!o.mobileEdgeLabelsVisible),void 0!==o.wallRadiusVw&&(pa.wallRadiusVw=i(o.wallRadiusVw,0,40,pa.wallRadiusVw)),void 0!==o.wallThicknessVw&&(pa.wallThicknessVw=i(o.wallThicknessVw,0,20,pa.wallThicknessVw)),void 0!==o.wallThicknessAreaMultiplier&&(pa.wallThicknessAreaMultiplier=i(o.wallThicknessAreaMultiplier,0,10,pa.wallThicknessAreaMultiplier)),!Number.isFinite(pa.containerBorderVw)||0>=pa.containerBorderVw){const t=e("--container-border-vw",null);Number.isFinite(t)&&t>0&&(pa.containerBorderVw=t)}if(!Number.isFinite(pa.wallRadiusVw)||0>=pa.wallRadiusVw){const t=e("--wall-radius-vw",null);Number.isFinite(t)&&t>0&&(pa.wallRadiusVw=t)}if(!Number.isFinite(pa.wallThicknessVw)||0>=pa.wallThicknessVw){const t=e("--wall-thickness-vw",null);Number.isFinite(t)&&t>0&&(pa.wallThicknessVw=t)}Number.isFinite(pa.containerBorderVw)&&pa.containerBorderVw>0||(pa.containerBorderVw=d(pa.containerBorder,c)),Number.isFinite(pa.simulationPaddingVw)&&pa.simulationPaddingVw>=0||(pa.simulationPaddingVw=d(pa.simulationPadding,c)),Number.isFinite(pa.wallRadiusVw)&&pa.wallRadiusVw>0||(pa.wallRadiusVw=d(pa.wallRadius,c)),Number.isFinite(pa.wallThicknessVw)&&pa.wallThicknessVw>0||(pa.wallThicknessVw=d(pa.wallThickness,c)),f()}function M(){return pa}function b(t){const e=M(),n=Math.round(+t||0);let o=1;if(e.isMobile){const t=Math.max(0,Math.min(1,+(e.mobileObjectReductionFactor??.7))),a=Math.max(0,+(e.mobileObjectReductionThreshold??0));(0>=a||n>=a)&&(o*=t)}return e.liteModeEnabled&&(o*=Math.max(0,Math.min(1,+(e.liteModeObjectReductionFactor??.6)))),Math.max(0,Math.round(n*o))}function v(t,e,n){pa.canvas=t,pa.ctx=e,pa.container=n}function g(t){pa.currentMode=t}function w(){pa.balls.length=0}function y(){const t=navigator.userAgent||"",e=/iPad/.test(t)||/Mac/.test(t)&&navigator.maxTouchPoints>1,n=/iPhone/.test(t);let o=!1;try{const t=!(!window.matchMedia||!window.matchMedia("(max-width: 600px)").matches),e=[window.visualViewport?.width,window.innerWidth,document.documentElement?.clientWidth].filter(t=>Number.isFinite(t)),n=e.length?Math.min(...e):null;o=t||!!Number.isFinite(n)&&600>=n}catch(r){}const a=!(!e&&!n),i=o;if(pa.isMobile!==a||pa.isMobileViewport!==i){pa.isMobile=a,pa.isMobileViewport=i,pa.wallDeformationEnabled=!(pa.isMobile||pa.isMobileViewport),(pa.isMobile||pa.isMobileViewport)&&(pa.physicsCollisionIterations=4,pa.mouseTrailEnabled=!1),x();try{const t=pa.R_MED;if(Number.isFinite(t)&&t>0&&Array.isArray(pa.balls)&&pa.balls.length)for(let e=0;pa.balls.length>e;e++){const n=pa.balls[e];n&&(n.r=t,n.rBase=t)}}catch(r){}}}function x(){const t=pa.isMobile||pa.isMobileViewport?pa.ballSizeMobile:pa.ballSizeDesktop;pa.R_MED=t,pa.R_MIN=t,pa.R_MAX=t}function S(t){const e=+t;return Number.isFinite(e)?0>e?0:e>1?1:e:0}function k(t){const e=((t||"")+"").trim();if(!e)return null;const n="#"===e[0]?e.slice(1):e;if(3!==n.length&&6!==n.length)return null;const o=parseInt(3===n.length?n[0]+n[0]+n[1]+n[1]+n[2]+n[2]:n,16);return Number.isFinite(o)?{r:o>>16&255,g:o>>8&255,b:255&o}:null}function C({r:t,g:e,b:n}){return"#"+((255&t)<<16|(255&e)<<8|255&n).toString(16).padStart(6,"0")}function T({r:t,g:e,b:n}){const o=S(t),a=S(e),i=S(n),r=Math.max(o,a,i),s=r-Math.min(o,a,i);let c=0;return s>0&&(c=r===o?(a-i)/s%6:r===a?(i-o)/s+2:(o-a)/s+4,c*=60,0>c&&(c+=360)),{h:c,s:r>0?s/r:0,v:r}}function A({h:t,s:e,v:n}){const o=(+t%360+360)%360,a=S(e),i=S(n),r=i*a,s=r*(1-Math.abs(o/60%2-1)),c=i-r;let l=0,u=0,d=0;return 60>o?(l=r,u=s,d=0):120>o?(l=s,u=r,d=0):180>o?(l=0,u=r,d=s):240>o?(l=0,u=s,d=r):300>o?(l=s,u=0,d=r):(l=r,u=0,d=s),{r:l+c,g:u+c,b:d+c}}function L(t,{satMul:e=0,valMul:n=0}={}){const o=k(t);if(!o)return((t||"")+"").trim()||"#ffffff";const a=T({r:o.r/255,g:o.g/255,b:o.b/255}),i=(t=>Math.max(0,Math.min(.88,+t||0)))(a.s*(1+(+e||0))),r=S(a.v*(1+(+n||0))),s=A({h:a.h,s:i,v:r});return C({r:Math.round(255*s.r),g:Math.round(255*s.g),b:Math.round(255*s.b)})}function F(t,e,n){return Math.round(t+(e-t)*n)}function P(t,e,n){const o=S(n),a=k(t),i=k(e);return a||i?a?i?C({r:F(a.r,i.r,o),g:F(a.g,i.g,o),b:F(a.b,i.b,o)}):t+"":e+"":"#ffffff"}function I(t){const e=+t;return Number.isFinite(e)?0>e?0:e>255?255:e:0}function D(t,e,n=1){const o=Math.max(1,+n||1),a=k(t),i=k(e);return a||i?a&&i?C({r:I(a.r+(i.r-a.r)*o),g:I(a.g+(i.g-a.g)*o),b:I(a.b+(i.b-a.b)*o)}):e+"":"#ffffff"}function _(t,e,n=.5){const o=S(n),a=[,,,,,,,,];for(let i=0;8>i;i++)a[i]=P(t?.[i],e?.[i],o);return a}function E(t,e,n=1.25){const o=[,,,,,,,,];for(let i=0;8>i;i++)o[i]=e?.[i];const a=[3,5,6,7];for(let i=0;a.length>i;i++){const r=a[i];o[r]=D(t?.[r],e?.[r],n)}return o}function W(t,e){const n=[,,,,,,,,];for(let a=0;8>a;a++)n[a]=t?.[a];const o=[3,5,6,7];for(let a=0;o.length>a;a++){const t=o[a];n[t]=L(n[t],e)}return n}function R(t,e=.2){const n=[,,,,,,,,];for(let i=0;8>i;i++)n[i]=t?.[i];let o=-1,a=-1;for(let i=0;8>i;i++){const t=n[i];if(!t)continue;const e=$(t);e>a&&(a=e,o=i)}return 0>o||(n[o]=L(n[o],{satMul:e,valMul:0})),n}function N(t,e,n,o=e){const a=+t;if(!Number.isFinite(a))return o;const i=Math.floor(a);return e>i?e:i>n?n:i}function z(t,e,n){const o=+t;if(!Number.isFinite(o))return e;const a=Math.floor(o);return e>a?e:a>n?n:a}function O(t){return Array.isArray(t)&&t.every(t=>Number.isFinite(+t))}function B(t){const e=((t||"")+"").trim();if(!e)return null;const n="#"===e[0]?e.slice(1):e;if(3!==n.length&&6!==n.length)return null;const o=parseInt(3===n.length?n[0]+n[0]+n[1]+n[1]+n[2]+n[2]:n,16);return Number.isFinite(o)?{r:(o>>16&255)/255,g:(o>>8&255)/255,b:(255&o)/255}:null}function V(t){return t>.04045?Math.pow((t+.055)/1.055,2.4):t/12.92}function G(t){const e=B(t);return e?.2126*V(e.r)+.7152*V(e.g)+.0722*V(e.b):1}function $(t){const e=B(t);if(!e)return 0;const n=Math.max(e.r,e.g,e.b);return n>0?(n-Math.min(e.r,e.g,e.b))/n:0}function H(t,e){const n=j(t),o=j(e);return(Math.max(n,o)+.05)/(Math.min(n,o)+.05)}function j({r:t,g:e,b:n}){const o=t=>{const e=t/255;return e>.04045?Math.pow((e+.055)/1.055,2.4):e/12.92};return.2126*o(t)+.7152*o(e)+.0722*o(n)}function q(t,e){const n=e||M(),o=t&&t.length?t:[],a=Math.min(7,o.length-1);if(0>a)return[];const i=Number.isFinite(+n.cursorColorLumaMax)?+n.cursorColorLumaMax:.62,r=O(n.cursorColorAllowIndices)?n.cursorColorAllowIndices.map(t=>z(t,0,7)):[],s=O(n.cursorColorDenyIndices)?n.cursorColorDenyIndices.map(t=>z(t,0,7)):[],c=new Set(s),l=r.length?new Set(r):null,u=[];for(let h=0;a>=h;h++){if(c.has(h))continue;if(l&&!l.has(h))continue;const t=o[h];t&&(G(t)>i||.18>$(t)||u.push(h))}if(u.length)return u;const d=[];for(const h of Aa)h>a||c.has(h)||l&&!l.has(h)||d.push(h);if(d.length)return d;for(let h=0;a>=h;h++)c.has(h)||l&&!l.has(h)||d.push(h);return d}function U(t,{forceMode:e}={}){const n=M(),o=n.currentColors,a=q(o,n),i=z(t,0,7),r=a.includes(i)?i:a[0]??i,s=((t,e)=>{const n=t&&t.length?t:[];return n[z(e,0,Math.max(0,Math.min(7,n.length-1)))]||"#000000"})(o,r);return e&&(n.cursorColorMode=e),n.cursorColorIndex=r,n.cursorColorHex=s,(t=>{try{document.documentElement.style.setProperty("--cursor-color",(t+"").trim()||"#000000");const e=(t=>{const e=M(),n=e?.isDarkMode||!1,o=k(t);if(!o)return null;const a=k(n?e.bgDark||"#0a0a0a":e.bgLight||"#f5f5f5");if(!a)return null;const i=.12,r={r:Math.round(a.r+(o.r-a.r)*i),g:Math.round(a.g+(o.g-a.g)*i),b:Math.round(a.b+(o.b-a.b)*i)},s=((t,e,n=null)=>{const o={r:255,g:255,b:255},a={r:0,g:0,b:0},i=n=>{for(let o=0;20>=o;o++){const a=o/20,i={r:Math.round(t.r+(n.r-t.r)*a),g:Math.round(t.g+(n.g-t.g)*a),b:Math.round(t.b+(n.b-t.b)*a)},r=H(i,e);if(r>=4.5)return{rgb:i,t:a,cr:r}}return null},r=i(o),s=i(a);if(r&&s)return"black"===n?s.rgb:"white"===n?r.rgb:r.t>s.t?s.rgb:r.rgb;if(r)return r.rgb;if(s)return s.rgb;const c=H(o,e);return H(a,e)>c?a:o})(o,r,G(C(r))>.45?"black":"white");return`rgb(${s.r} ${s.g} ${s.b})`})(t);e&&document.documentElement.style.setProperty("--cursor-hover-fg",e)}catch(e){}})(s),{index:r,hex:s}}function Y(){const t=M();if("auto"!==t.cursorColorMode)return U(t.cursorColorIndex,{forceMode:t.cursorColorMode}),!1;const e=q(t.currentColors,t);if(!e.length)return!1;const n=Number.isFinite(+t.o)?+t.o:-1;let o=e[Math.random()*e.length|0];return e.length>1&&o===n&&(o=e[Math.random()*e.length|0],o===n&&(o=e[(e.indexOf(n)+1)%e.length])),t.o=o,U(o,{forceMode:"auto"}),!0}function X(t){const e=M(),n=Sa[t];if(!n)return Sa.industrialTeal.light;const o=e.isDarkMode||!1;return((t,e,n=!1)=>{if(!t||!Array.isArray(t))return t;const o=[...t],a=B(e);if(!a)return o;const i=T(a),r=.05>i.s?0:i.h,s=[0,1];for(const c of s){const t=o[c];if(!t)continue;const e=B(t);if(!e)continue;const a=T(e),i=Math.max(0,Math.min(.15,.1*a.s));let s=a.v;n&&(s=Math.max(.15,.55*a.v));const l=A({h:r,s:i,v:s});o[c]=C({r:Math.round(255*l.r),g:Math.round(255*l.g),b:Math.round(255*l.b)})}return o})(e.isDarkMode?n.dark:n.light,o?e.bgDark||"#0a0a0a":e.bgLight||"#f5f5f5",o)}function Z(){const t=M(),e=t.currentColors;if(!e||0===e.length)return console.warn("No colors available, using fallback"),{color:"#ffffff",distributionIndex:0};const n=(t=>{const e=t?.colorDistribution;return Array.isArray(e)?e:null})(t);if(n&&n.length){let t=0;for(let e=0;n.length>e;e++){const o=+n[e]?.weight;Number.isFinite(o)&&o>0&&(t+=o)}if(t>0){let o=Math.random()*t;for(let t=0;n.length>t;t++){const a=n[t],i=+a?.weight;if(Number.isFinite(i)&&i>0&&(o-=i,0>=o))return{color:e[N(a?.colorIndex,0,7,0)]||e[0]||"#ffffff",distributionIndex:t}}const a=n[n.length-1];return{color:e[N(a?.colorIndex,0,7,0)]||e[0]||"#ffffff",distributionIndex:n.length-1}}}const o=Math.random();let a=0;const i=Math.min(e.length,8,8);for(let r=0;i>r;r++)if(a+=Ta[r],a>=o)return{color:e[r],distributionIndex:r};return{color:e[Math.min(e.length-1,7)]||"#ffffff",distributionIndex:0}}function K(){return Z().color}function Q(t){const e=M();e.currentTemplate=t,e.currentColors=X(t);try{localStorage.setItem(Ca,(t||"")+"")}catch(n){}try{const e=document.getElementById("colorSelect");e&&(e.value=t)}catch(n){}"auto"!==e.cursorColorMode&&"manual"!==e.cursorColorMode&&(e.cursorColorMode="auto"),U(e.cursorColorIndex,{forceMode:e.cursorColorMode}),(()=>{const t=M().balls;for(let e=0;t.length>e;e++)t[e].color=K()})(),(t=>{try{const e=document.documentElement,n=(t&&t.length?t:[]).slice(0,8);for(let t=0;8>t;t++)e.style.setProperty("--ball-"+(t+1),n[t]||"#ffffff")}catch(n){}})(e.currentColors),(()=>{const t=M().currentColors;for(let e=1;8>=e;e++){const n=document.getElementById("color"+e),o=document.getElementById(`color${e}Val`);n&&t[e-1]&&(n.value=t[e-1],o&&(o.textContent=t[e-1].toUpperCase()))}})();try{window.dispatchEvent(new CustomEvent("bb:paletteChanged",{detail:{template:t}}))}catch(n){}}function J(){const t=document.getElementById("colorSelect");if(!t)return;t.innerHTML="";for(const n of ka){const e=Sa[n];if(!e)continue;const o=document.createElement("option");o.value=n,o.textContent=e.label,t.appendChild(o)}const e=M();t.value=e.currentTemplate}function tt(){const t=M(),e=ka.length?ka:Object.keys(Sa);if(!e.length)return null;let n=null;try{n=localStorage.getItem(Ca)}catch(i){}const o="string"==typeof n?e.indexOf(n):-1,a=e[0>o?Math.random()*e.length|0:(o+1)%e.length];t.currentTemplate=a;try{localStorage.setItem(Ca,a)}catch(i){}return a}function et(t,e=.15){return t*(1+2*(Math.random()-.5)*e)}function nt(t){for(const[e,n]of Object.entries(t))e in Pa&&(Pa[e]=n)}function ot(){try{"undefined"!=typeof window&&window.dispatchEvent&&window.dispatchEvent(new CustomEvent(ja,{detail:xt()}))}catch(t){}}function at(){if(!si&&(si=!0,"undefined"!=typeof window&&window.matchMedia)){const t=window.matchMedia("(prefers-reduced-motion: reduce)");Za=t.matches,t.addEventListener("change",t=>{Za=t.matches})}}function it(t){const e=t&&"object"==typeof t?t:null;if(!e)return;if("string"==typeof e.soundPreset&&Ct(e.soundPreset),e.soundConfig&&"object"==typeof e.soundConfig)return void kt(e.soundConfig);const n={};let o=!1;for(const[a,i]of Object.entries(e))a in Ia&&(n[a]=i,o=!0);o&&kt(n)}async function rt(){if(Ha)return!0;try{const t=window.AudioContext||window.webkitAudioContext;return t?(Ea=new t({latencyHint:"interactive",sampleRate:44100}),"suspended"===Ea.state&&await Ea.resume(),(()=>{Wa=Ea.createGain(),Wa.gain.value=Ia.masterGain,Oa=Ea.createDynamicsCompressor(),Oa.threshold.value=-12,Oa.knee.value=3,Oa.ratio.value=20,Oa.attack.value=.001,Oa.release.value=.05,Va=Ea.createBiquadFilter(),Va.type="highshelf",Va.frequency.value=Ia.highShelfFreq,Va.gain.value=Ia.highShelfGain,Va.Q.value=.7,Ba=Ea.createWaveShaper(),Ba.curve=((t=.55)=>{const e=1024,n=new Float32Array(e),o=1+8*t;for(let a=0;e>a;a++)n[a]=Math.tanh(o*(2*a/(e-1)-1))/Math.tanh(o);return n})(.55),Ba.oversample="2x",Na=Ea.createGain(),Na.gain.value=1-Ia.reverbWetMix,za=Ea.createGain(),za.gain.value=Ia.reverbWetMix,Ra=(()=>{const t=Ea.createGain(),e=Ea.createGain(),n=[.029,.037,.053,.067].map(t=>{const e=Ea.createDelay(.1);return e.delayTime.value=t*Ia.reverbDecay,e}),o=n.map(()=>{const t=Ea.createGain();return t.gain.value=.4,t}),a=Ea.createBiquadFilter();return a.type="lowpass",a.frequency.value=2e3*(1-Ia.reverbHighDamp),a.Q.value=.5,n.forEach((e,i)=>{t.connect(e),e.connect(o[i]),o[i].connect(a),o[i].connect(n[(i+1)%n.length])}),a.connect(e),t.connect(e),t.l=e,t})();const t=Ra.l;Na.connect(Ba),za.connect(Ra),t.connect(Ba),Ba.connect(Va),Va.connect(Oa),Oa.connect(Wa),Wa.connect(Ea.destination),st(),(()=>{Ua=[];for(let t=0;qa>t;t++){const e={id:t,inUse:!1,startTime:0,filter:Ea.createBiquadFilter(),envelope:Ea.createGain(),panner:Ea.createStereoPanner(),reverbSend:Ea.createGain(),noiseFilter:Ea.createBiquadFilter(),noiseEnvelope:Ea.createGain(),osc:null,harmonicOsc:null,sparkleOsc:null,noiseSource:null};e.filter.type="lowpass",e.noiseFilter.type="bandpass",e.noiseFilter.Q.value=1.2,e.filter.connect(e.envelope),e.envelope.connect(e.panner),e.panner.connect(Na),e.panner.connect(e.reverbSend),e.reverbSend.connect(za),e.noiseFilter.connect(e.noiseEnvelope),e.noiseEnvelope.connect(e.panner),Ua.push(e)}})()})(),Ha=!0,$a=!0,ot(),console.log(` Audio unlocked (${(1e3*(Ea.baseLatency||0)).toFixed(1)}ms base latency)`),!0):(console.warn("Web Audio API not supported"),!1)}catch(t){return console.error("Failed to unlock audio:",t),!1}}function st(){if(Ea){if(Ga)try{Ga.disconnect()}catch(t){}else Ga=Ea.createGain(),Ga.gain.value=1;Ga.connect(Oa||Ea.destination)}}function ct(){if(Qa||!Ea)return;const t=Ea.sampleRate;Qa=Ea.createBuffer(1,Math.floor(.045*t),t);const e=Qa.getChannelData(0),n=Math.floor(.003*t),o=Math.floor(.01*t);for(let a=0;n>a;a++){const t=Math.exp(-a/n*6);e[a]=(2*Math.random()-1)*t}for(let a=n;o>a;a++){const i=.65*(1-(a-n)/(o-n));e[a]=Math.sin(1760*Math.PI*(a/t))*i}}function lt(){if(ri&&(clearTimeout(ri),ri=null),Ja){try{Ja.stop()}catch(t){}Ja.disconnect(),ti.disconnect(),ei.disconnect(),Ja=ti=ei=null}if(oi){try{oi.stop()}catch(t){}oi.disconnect(),ai.disconnect(),ii.disconnect(),oi=ai=ii=null}}function ut(t,e){if(!$a||!Ha||!Ea||Za)return;st(),ct();const n=Ea.createBufferSource();n.buffer=Qa;const o=Ea.createGain();o.gain.value=t;const a=Ea.createBiquadFilter();a.type="lowpass",a.frequency.value=e,n.connect(a).connect(o).connect(Ga),n.start()}function dt(t=0){if(!$a||!Ha||!Ea||Za)return void lt();if(!Pa.continuousEnabled)return void lt();const e=Math.abs(t);if(!Number.isFinite(e))return;if(Pa.tickMinVelocity>e)return ti&&ti.gain.setTargetAtTime(0,Ea.currentTime,.05),ai&&ai.gain.setTargetAtTime(0,Ea.currentTime,.08),void(ri||(ri=setTimeout(lt,Pa.stopDelayMs)));ri&&(clearTimeout(ri),ri=null),Ea&&(Ja&&oi||(st(),ct(),Ja=Ea.createBufferSource(),Ja.buffer=Qa,Ja.loop=!0,ti=Ea.createGain(),ti.gain.value=0,ei=Ea.createBiquadFilter(),ei.type="highpass",ei.frequency.value=700,Ja.connect(ei).connect(ti).connect(Ga),Ja.start(),(()=>{if(ni||!Ea)return;const t=Ea.sampleRate,e=Math.floor(.28*t);ni=Ea.createBuffer(1,e,t);const n=ni.getChannelData(0);for(let o=0;e>o;o++){const t=o/e,a=.08>t?t/.08:t>.92?(1-t)/.08:1;n[o]=(2*Math.random()-1)*a*.6}})(),oi=Ea.createBufferSource(),oi.buffer=ni,oi.loop=!0,ai=Ea.createGain(),ai.gain.value=0,ii=Ea.createBiquadFilter(),ii.type="bandpass",ii.frequency.value=Pa.swishMinHz,ii.Q.value=.8,oi.connect(ii).connect(ai).connect(Ga),oi.start()));const n=Ea.currentTime,o=wt((e-Pa.tickMinVelocity)/(Pa.tickMaxVelocity-Pa.tickMinVelocity),0,1);Ja&&Ja.playbackRate.setTargetAtTime(Pa.tickMinRate+(Pa.tickMaxRate-Pa.tickMinRate)*o,n,.04),ti&&ti.gain.setTargetAtTime(Pa.tickBaseGain*(.35+.75*o)*Math.max(0,Number.isFinite(Pa.tickGainMul)?Pa.tickGainMul:1),n,.05);const a=wt((e-Pa.swishMinVelocity)/(Pa.swishMaxVelocity-Pa.swishMinVelocity),0,1);if(ai){const t=Number.isFinite(Pa.swishGainMul)?Pa.swishGainMul:1;ai.gain.setTargetAtTime(Pa.swishBaseGain*Math.pow(a,1.4)*Math.max(0,t),n,.08)}ii&&ii.frequency.setTargetAtTime(Pa.swishMinHz+(Pa.swishMaxHz-Pa.swishMinHz)*a,n,.08)}function ht(){ut(Pa.snapGain,1600)}function ft(){ut(Pa.centerGain,Pa.centerFilterHz||1600)}function mt(){ut(Pa.openGain,Pa.openFilterHz||1800)}function pt(){ut(Pa.closeGain,Pa.closeFilterHz||1600)}function Mt(){$a&&Ha&&Ea&&!Za&&ut(.099,2200)}function bt(t,e,n=.5,o=null){if(!$a||!Ha||!Ea||Za)return;if(Ia.collisionMinImpact>e)return;const a=Ea.currentTime;if(.005>a-Ya)return;if(null!==o){const t=Xa.get(o)||0;if(Ia.minTimeBetweenSounds>a-t)return;Xa.set(o,a)}if(Ya=a,Xa.size>200){const t=a-.5;for(const[e,n]of Xa)t>n&&Xa.delete(e)}const i=(()=>{for(let e=0;qa>e;e++)if(!Ua[e].inUse)return Ua[e];let t=Ua[0];for(let e=1;qa>e;e++)t.startTime>Ua[e].startTime&&(t=Ua[e]);return gt(t),t})();i&&((t,e,n,o,a)=>{t.inUse=!0,t.startTime=a;const i=Math.pow(Math.max(0,Math.min(1,n)),Ia.intensityExponent),r=et(e,Ia.variancePitch),s=et(Ia.decayTime,Ia.varianceDecay)*(1-i*(1-Ia.velocityDecayScale)),c=s+.02;let l=Ia.minGain+(Ia.maxGain-Ia.minGain)*i;l*=et(1,Ia.varianceGain);const u=1+(Ia.velocityBrightnessScale-1)*i;let d=Ia.filterBaseFreq+Ia.filterVelocityRange*Math.pow(i,1.3);d*=et(1,Ia.varianceFilter)*u;const h=2*(o-.5)*Ia.maxPan,f=.12+.5*(1-i);({gain:l,filterFreq:d}=((t,e,n)=>{const o=wt((t-Ia.toneSafetyMinHz)/(Ia.toneSafetyMaxHz-Ia.toneSafetyMinHz),0,1),a=Ia.toneSafetyExponent,i=Math.pow(o,a),r=wt(1-Ia.toneSafetyHighGainAtten*i-Ia.toneSafetyLowGainAtten*Math.pow(1-o,a),.6,1);let s=Math.min(e*r,Ia.voiceGainMax);const c=wt(1-Ia.toneSafetyHighBrightAtten*i,.55,1);return{gain:s,filterFreq:wt(n*c,Ia.filterMinHz,Ia.filterMaxHz)}})(r,l,d)),t.filter.frequency.value=d,t.filter.Q.value=Ia.filterQ,t.panner.pan.value=h,t.reverbSend.gain.value=f,t.noiseFilter.Q.value=wt(Ia.noiseTransientQ||1.2,.5,8),t.envelope.gain.cancelScheduledValues(a),t.envelope.gain.setValueAtTime(l,a),t.envelope.gain.exponentialRampToValueAtTime(.001,a+s);const m=Ea.createOscillator();if(m.type="sine",m.frequency.value=r,t.osc=m,m.connect(t.filter),(Ia.harmonicGain||0)>.001){const e=Ea.createOscillator();e.type="sine",e.frequency.value=2*r;const n=Ea.createGain();n.gain.cancelScheduledValues(a),n.gain.setValueAtTime(l*Ia.harmonicGain,a),n.gain.exponentialRampToValueAtTime(.001,a+s),t.harmonicOsc=e,e.connect(n),n.connect(t.filter),e.onended=()=>{try{n.disconnect()}catch(t){}},e.start(a),e.stop(a+c)}else t.harmonicOsc=null;if((Ia.sparkleGain||0)>.001){const e=Ea.createOscillator();e.type="sine";const n=Ia.sparkleRatioMin||2.3,o=Ia.sparkleRatioMax||4.1,i=wt(n+Math.random()*(o-n),1.2,10);e.frequency.value=r*et(i,.02);const u=Ea.createGain(),d=Math.max(.012,s*wt(Ia.sparkleDecayMul||.65,.25,.95));u.gain.cancelScheduledValues(a),u.gain.setValueAtTime(l*Ia.sparkleGain,a),u.gain.exponentialRampToValueAtTime(.001,a+d),t.sparkleOsc=e,e.connect(u),u.connect(t.filter),e.onended=()=>{try{u.disconnect()}catch(t){}},e.start(a),e.stop(a+c)}else t.sparkleOsc=null;if(Ia.noiseTransientEnabled&&i>.25){const e=(()=>{if(!Ka){const t=2*Ea.sampleRate;Ka=Ea.createBuffer(1,t,Ea.sampleRate);const e=Ka.getChannelData(0);let n=0,o=0,a=0;for(let i=0;t>i;i++){const t=2*Math.random()-1;n=.99765*n+.099046*t,o=.963*o+.2965164*t,a=.57*a+1.0526913*t,e[i]=.25*(n+o+a+.1848*t)}}const t=Ea.createBufferSource();return t.buffer=Ka,t.loopStart=1.5*Math.random(),t.loopEnd=t.loopStart+.1,t.loop=!1,t})();t.noiseSource=e;const n=Math.pow(i,1.4);t.noiseFilter.frequency.value=et(Ia.noiseTransientFilterMin+(Ia.noiseTransientFilterMax-Ia.noiseTransientFilterMin)*n,Ia.varianceNoise);const o=Ia.noiseTransientGain*Ia.velocityNoiseScale*n*l,r=et(Ia.noiseTransientDecay,Ia.varianceNoise);t.noiseEnvelope.gain.cancelScheduledValues(a),t.noiseEnvelope.gain.setValueAtTime(o,a),t.noiseEnvelope.gain.exponentialRampToValueAtTime(.001,a+r),e.connect(t.noiseFilter),e.start(a),e.stop(a+r+.01)}else t.noiseSource=null;m.start(a),m.stop(a+c),m.onended=()=>gt(t)})(i,(t=>{const e=1-wt((t-8)/47,0,1),n=wt(Ia.pitchMinHz||145,40,6e3),o=wt(Ia.pitchMaxHz||280,n+10,12e3),a=wt(Ia.pitchCurve||1,.5,2.5);return(n+Math.pow(e,a)*(o-n))*et(1,1.5*(Ia.variancePitch||.06))})(t),Math.max(0,Math.min(1,e)),n,a)}function vt({intensity:t=.82,radius:e=18,xPosition:n=.72}={}){bt(e,t,n,null)}function gt(t){if(t.osc){try{t.osc.stop(),t.osc.disconnect()}catch(e){}t.osc=null}if(t.harmonicOsc){try{t.harmonicOsc.stop(),t.harmonicOsc.disconnect()}catch(e){}t.harmonicOsc=null}if(t.sparkleOsc){try{t.sparkleOsc.stop(),t.sparkleOsc.disconnect()}catch(e){}t.sparkleOsc=null}if(t.noiseSource){try{t.noiseSource.stop(),t.noiseSource.disconnect()}catch(e){}t.noiseSource=null}t.inUse=!1}function wt(t,e,n){return e>t?e:t>n?n:t}function yt(){return!!Ha&&($a=!$a,$a||lt(),ot(),$a)}function xt(){return{isUnlocked:Ha,isEnabled:$a,activeSounds:Ua.filter(t=>t.inUse).length,poolSize:qa}}function St(){return{...Ia}}function kt(t){for(const[e,n]of Object.entries(t))e in Ia&&(Ia[e]=n);za&&Na&&"reverbWetMix"in t&&(za.gain.value=Ia.reverbWetMix,Na.gain.value=1-Ia.reverbWetMix),Va&&("highShelfFreq"in t||"highShelfGain"in t)&&(Va.frequency.value=Ia.highShelfFreq,Va.gain.value=Ia.highShelfGain),Wa&&"masterGain"in t&&(Wa.gain.value=Ia.masterGain)}function Ct(t){const e=Da[t];if(!e)return!1;_a=t;const{label:n,description:o,...a}=e;return kt(a),!0}function Tt(){return _a}function At(){const t=M(),e=t.balls,n=t.canvas,o=t.R_MAX,a=t.ballSpacing||0,i=e.length;if(li.length=0,2>i)return li;const r=!1!==t.physicsSpatialGridOptimization;if(r){let t=!1;for(let n=0;i>n;n++){const o=e[n];if(o&&!o.isSleeping){t=!0;break}}if(!t)return li}const s=Math.max(1,2*o*(1+a)),c=Math.ceil(n.width/s)+1;if(r)for(const l of ci.values())l.length=0;else ci.clear();for(let l=0;i>l;l++){const t=e[l],n=(t.y/s|0)*c+(t.x/s|0);let o=ci.get(n);o||(o=[],ci.set(n,o)),o.push(l)}for(const[l,u]of ci){if(0===u.length)continue;const t=l/c|0,n=l%c;for(let o=-1;1>=o;o++)for(let i=-1;1>=i;i++){const r=ci.get((t+o)*c+(n+i));if(r&&0!==r.length)for(let t=0;u.length>t;t++){const n=u[t];for(let t=0;r.length>t;t++){const o=r[t];if(n>=o)continue;const i=e[n],s=e[o],c=s.x-i.x,l=s.y-i.y,u=i.r+s.r+(i.r+s.r)/2*a,d=c*c+l*l;if(u*u>d){const t=u-Math.sqrt(Math.max(d,da.MIN_DISTANCE_EPSILON)),e=li.length;let a=ui[e];a||(a={i:0,j:0,overlap:0},ui[e]=a),a.i=n,a.j=o,a.overlap=t,li.push(a)}}}}}return li}function Lt(t=10){const e=M(),n=e.balls,o=At(),a=e.REST,i=.5*e.DPR,r=e.ballSpacing||0,s=!!e.physicsSkipSleepingCollisions;for(let c=0;t>c;c++)for(let t=0;o.length>t;t++){const{i:l,j:u}=o[t],d=n[l],h=n[u],f=h.x-d.x,m=h.y-d.y,p=d.r+h.r+(d.r+h.r)/2*r,M=f*f+m*m;if(0===M||M>p*p)continue;const b=Math.sqrt(M),v=f/b,g=m/b,w=p-b,y=1/Math.max(d.m,.001),x=1/Math.max(h.m,.001),S=d.isSleeping&&h.isSleeping,k=.8*Math.max(w-i,0)/(y+x),C=k*v,T=k*g;d.x-=C*y,d.y-=T*y,h.x+=C*x,h.y+=T*x;const A="pit"===e.currentMode;if(A&&-.3>g?h.hasSupport=!0:A&&g>.3&&(d.hasSupport=!0),s&&S)continue;if(S)continue;const L=h.vx-d.vx,F=h.vy-d.vy,P=L*v+F*g,I=-15*(e.DPR||1)>P;if((!d.isSleeping||I)&&(!h.isSleeping||I)&&(d.isSleeping&&d.wake(),h.isSleeping&&h.wake(),0>P)){const t=-(1+(30>Math.abs(P)?0:a))*P/(y+x),n=t*v,o=t*g;d.vx-=n*y,d.vy-=o*y,h.vx+=n*x,h.vy+=o*x;const i=L-P*v,r=F-P*g,s=Math.hypot(i,r);if(s>.001){const t=0>i*-g+r*v?-1:1,e=da.SPIN_GAIN_TANGENT;d.omega-=t*e*s/Math.max(d.r,1),h.omega+=t*e*s/Math.max(h.r,1)}const u=Math.min(1,Math.abs(P)/(50*(d.r+h.r))),f=Math.min(e.getSquashMax(),.8*u);d.squashAmount=Math.max(d.squashAmount,.8*f),d.squashNormalAngle=Math.atan2(-g,-v),h.squashAmount=Math.max(h.squashAmount,.8*f),h.squashNormalAngle=Math.atan2(g,v),0===c&&bt((d.r+h.r)/2,u,(d.x+h.x)/2/(e.canvas?.width||1),`${l}-${t}`)}}}function Ft({iterations:t=4,positionalCorrectionPercent:e=.25,positionalCorrectionSlopPx:n=null,maxCorrectionPx:o=null,enableSound:a=!0}={}){const i=M(),r=i.balls,s=At(),c=i.REST,l=e,u=n??.5*i.DPR,d=i.ballSpacing||0,h=o??2*(i.DPR||1);for(let f=0;t>f;f++)for(let t=0;s.length>t;t++){const{i:e,j:n}=s[t],o=r[e],m=r[n];if(o.isSleeping&&m.isSleeping)continue;o.isSleeping&&o.wake(),m.isSleeping&&m.wake();const p=m.x-o.x,M=m.y-o.y,b=o.r+m.r+(o.r+m.r)/2*d,v=p*p+M*M;if(0===v||v>b*b)continue;const g=Math.sqrt(v),w=p/g,y=M/g,x=b-g,S=1/Math.max(o.m,.001),k=1/Math.max(m.m,.001);let C=l*Math.max(x-u,0)/(S+k);C>h&&(C=h);const T=C*w,A=C*y;o.x-=T*S,o.y-=A*S,m.x+=T*k,m.y+=A*k;const L=(m.vx-o.vx)*w+(m.vy-o.vy)*y;if(0>L){const t=-(1+(30>Math.abs(L)?0:c))*L/(S+k),r=t*w,s=t*y;if(o.vx-=r*S,o.vy-=s*S,m.vx+=r*k,m.vy+=s*k,a&&0===f){const t=(o.r+m.r)/2,a=(o.x+m.x)/2/(i.canvas?.width||1);bt(t,Math.min(1,Math.abs(L)/(50*(o.r+m.r))),a,`${e}-${n}`)}}}}function Pt(t,e){ha[t]&&(e.wallPreset=t)}function It(t,e,n){const o=M();if(!t)return;const a=pi||Dt(),i=o.DPR||1,r="function"==typeof o.getCanvasCornerRadius?o.getCanvasCornerRadius():o.cornerRadius??o.wallRadius??0,s=Math.max(0,(+r||0)*i),c=Math.max(0,(+o.wallThickness||0)*i),l=Math.max(1,e-2*c),u=Math.max(1,n-2*c),d=Math.max(0,Math.min(s,.5*l,.5*u)),h=Math.max(2,2*i);if(t.save(),t.fillStyle=a,t.beginPath(),t.moveTo(-h,-h),t.lineTo(e+h,-h),t.lineTo(e+h,n+h),t.lineTo(-h,n+h),t.closePath(),!1===o.wallDeformationEnabled){const e=c,n=c,o=d;t.moveTo(e+o,n+u),t.lineTo(e+l-o,n+u),t.arcTo(e+l,n+u,e+l,n+u-o,o),t.lineTo(e+l,n+o),t.arcTo(e+l,n,e+l-o,n,o),t.lineTo(e+o,n),t.arcTo(e,n,e,n+o,o),t.lineTo(e,n+u-o),t.arcTo(e,n+u,e+o,n+u,o),t.closePath();try{t.fill("evenodd")}catch(g){t.fill()}return void t.restore()}const f=Math.max(0,Math.min(10,+(o.wallVisualDeformMul??1)||1));bi.ringPhysics.ensureGeometry(l,u,d),bi.ringRender.ensureGeometry(l,u,d);const m=bi.ringPhysics,p=bi.ringRender,b=m.n,v=p.n;if(v>0&&b>0){const a=!1!==o.wallPhysicsInterpolation?Math.max(0,Math.min(1,bi.u||0)):1,r=p.renderDeformations,s=bi.p,l=bi.M;if(s&&l&&s.length===v&&l.length===v)for(let t=0;v>t;t++){const e=s[t];r[t]=e+(l[t]-e)*a}else{const t=m.deformations,e=p.deformations;for(let n=0;v>n;n++){const o=n/v*b,a=Math.floor(o)%b,i=o-a;e[n]=(1-i)*t[a]+i*t[(a+1)%b]}for(let n=0;v>n;n++)r[n]=(e[(n-2+v)%v]+4*e[(n-1+v)%v]+6*e[n]+4*e[(n+1)%v]+e[(n+2)%v])*(1/16);for(let n=0;v>n;n++)e[n]=(r[(n-2+v)%v]+4*r[(n-1+v)%v]+6*r[n]+4*r[(n+1)%v]+r[(n+2)%v])*(1/16);for(let n=0;v>n;n++)r[n]=e[n]}const u=p.baseX,d=p.baseY,h=p.normX,M=p.normY,g=Math.min(Math.max(0,.18*Math.max(1,Math.min(e,n))),Math.max(0,+(o.wallWobbleMaxDeform??hi)||hi)*i*1*f),w=t=>{const e=r[t]*i*1*f;return e>0?e>g?g:e:0},y=t=>u[t]+h[t]*w(t)+c,x=t=>d[t]+M[t]*w(t)+c;bi.S&&bi.k===v||(bi.S=(t=>{const e=t.n;if(0===e)return[];const n=[];for(let o=0;e>o;o++)n.push(o);return n})(p),bi.k=v);const S=bi.S;if(S&&S.length>0){const e=S[S.length-1];t.moveTo(y(e),x(e));for(let n=S.length-2;n>=0;n--){const e=S[n];t.lineTo(y(e),x(e))}t.closePath()}}try{t.fill("evenodd")}catch(g){t.fill()}t.restore()}function Dt(){try{const t=document.documentElement,e=document.body,n=document.getElementById("bravia-balls"),o=(t,e)=>{if(!t)return"";try{return getComputedStyle(t).getPropertyValue(e).trim()||getComputedStyle(t).getPropertyValue(e).trim()}catch(n){return""}};let a=o(t,"--wall-color");return a||(a=t.classList.contains("dark-mode")||e.classList.contains("dark-mode")?o(t,"--wall-color-dark")||o(t,"--frame-color-dark"):o(t,"--wall-color-light")||o(t,"--frame-color-light")),a||(a=o(e,"--wall-color")||o(n,"--wall-color")),a||"#0a0a0a"}catch{return"#0a0a0a"}}function _t(t,e,n){return e>t?e:t>n?n:t}function Et(t,e,n){return t+(e-t)*n}function Wt(t,e){switch(e){case ca.PIT:return t.sizeVariationPit??0;case ca.FLIES:return t.sizeVariationFlies??0;case ca.WEIGHTLESS:return t.sizeVariationWeightless??0;case ca.WATER:return t.sizeVariationWater??0;case ca.VORTEX:return t.sizeVariationVortex??0;case ca.PING_PONG:return t.sizeVariationPingPong??0;case ca.MAGNETIC:return t.sizeVariationMagnetic??0;case ca.BUBBLES:return t.sizeVariationBubbles??0;case ca.KALEIDOSCOPE:return t.sizeVariationKaleidoscope??0;case ca.CRITTERS:return t.sizeVariationCritters??0;case ca.NEURAL:return t.sizeVariationNeural??0;case ca.PARALLAX_LINEAR:return t.sizeVariationParallaxLinear??0;default:return 0}}function Rt(t,e){const n=Number.isFinite(t?.R_MIN)?Math.max(1,t.R_MIN):0,o=Number.isFinite(t?.R_MAX)?Math.max(n||1,t.R_MAX):0;if(n>0&&o>0)return _t(e,n,o);const a=Math.max(1,t?.R_MED||e||1);return _t(e,.8*a,1.2*a)}function Nt(t,e){const{minR:n,maxR:o,medR:a}=((t,e)=>{const n=Math.max(1,t.R_MED||.5*(t.R_MIN+t.R_MAX)||10),o=_t(+(t.sizeVariationCap??.12),0,wi),a=_t(+(t.sizeVariationGlobalMul??1),0,2),i=_t(+(Wt(t,e)??0),0,1),r=_t(o*a*i,0,wi);return{minR:Math.max(1,n*(1-r)),maxR:Math.max(1,n*(1+r)),medR:n}})(t,e);return 1e-6>o-n?a:Et(n,o,Math.random())}function zt(t,e){const n=M(),o=n.waterDrag||.015;t.vx*=1-o,t.vy*=1-o,t.omega*=1-.5*o;const a=n.DPR||1;for(let r=0;yi.length>r;r++){const n=yi[r],o=t.x-n.x,i=t.y-n.y,s=Math.sqrt(o*o+i*i),c=40*a;if(s>n.radius-c&&n.radius+c>s){const a=n.strength*(1-Math.abs(s-n.radius)/c);if(s>.1){const n=i/s;t.vx+=o/s*a*e,t.vy+=n*a*e}}}const i=n.waterDriftStrength||25;t.vx+=Math.sin(.5*t.t+.01*t.x)*i*e,t.vy+=Math.cos(.7*t.t+.01*t.y)*i*e}function Ot(t){const e=M().waterRippleSpeed||300;for(let n=yi.length-1;n>=0;n--){const o=yi[n];o.radius+=e*t,o.age+=t,o.strength*=.96,(o.age>3||10>o.strength)&&yi.splice(n,1)}}function Bt(t,e,n=1){const o=M();yi.push({x:t,y:e,radius:0,strength:(o.waterRippleStrength||15e3)*Math.min(n,5),age:0})}function Vt(t){const e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return e?{r:parseInt(e[1],16),g:parseInt(e[2],16),b:parseInt(e[3],16)}:{r:0,g:0,b:0}}function Gt(t,e,n,o){const a=M();if(!n){const t=Z();n=t.color,o=t.distributionIndex}const i=Nt(a,a.currentMode||ca.PIT),r=new gi(t,e,i,n);r.distributionIndex=void 0!==o?o:-1;const s=.5*a.canvas.width>t?1:-1,c=Math.max(.6,Math.min(1.4,i/(.5*(a.R_MIN+a.R_MAX)))),l=180*c;return r.vx=s*(140*c+Math.random()*l),r.vy=120*-Math.random(),r.driftAx=s*(360+420*Math.random())*c,r.driftTime=.22+.28*Math.random(),a.balls.push(r),r}function $t(t,e){const n=M(),o=(-1e9===n.mouseX?.5*n.canvas.width:n.mouseX)-t.x,a=(-1e9===n.mouseY?.5*n.canvas.height:n.mouseY)-t.y,i=Math.sqrt(o*o+a*a+1),r=a/i;t.vx+=o/i*4e3*e,t.vy+=4e3*r*e;const s=120*n.DPR;let c=0,l=0,u=0;for(let d=0;n.balls.length>d;d++){const e=n.balls[d];if(e===t)continue;const o=t.x-e.x,a=t.y-e.y,i=o*o+a*a;if(s*s>i&&i>0){const t=Math.sqrt(i),e=1-t/s;c+=o/t*e,l+=a/t*e,u++}}if(u>0){const n=15e3;t.vx+=c/u*n*e,t.vy+=l/u*n*e}t.vx+=1e3*(Math.random()-.5)*e,t.vy+=1e3*(Math.random()-.5)*e}function Ht(t,e){const n=M(),o=n.repelPower,a=n.repelRadius;if(!n.repellerEnabled||0>=o||0>=a)return;const i=a*n.DPR,r=t.x-n.mouseX,s=t.y-n.mouseY,c=r*r+s*s;if(c>i*i)return;const l=Math.max(Math.sqrt(c),1e-4),u=r/l,d=s/l,h=20*o*Math.pow(Math.max(0,1-l/i),n.repelSoft||3.4),f=Math.max(.25,t.m/n.MASS_BASELINE_KG);t.vx+=u*h*e/f,t.vy+=d*h*e/f}function jt(t,e){const n=M();if(!n.mouseInCanvas)return;const o=n.weightlessRepelRadius??0,a=n.weightlessRepelPower??0;if(0>=o||0>=a)return;const i=o*(n.DPR||1),r=t.x-n.mouseX,s=t.y-n.mouseY,c=r*r+s*s;if(c>i*i)return;const l=Math.max(Math.sqrt(c),1e-4),u=r/l,d=s/l,h=20*a*Math.pow(Math.max(0,1-l/i),n.weightlessRepelSoft??2.2),f=Math.max(.25,t.m/n.MASS_BASELINE_KG);t.vx+=u*h*e/f,t.vy+=d*h*e/f}function qt(t){Pi=t}function Ut(){if(xi=document.getElementById("c"),!xi)return void console.error("Canvas not found");Si=xi.getContext("2d",{alpha:!0,desynchronized:!0,willReadFrequently:!1}),Si||(Si=xi.getContext("2d"),console.warn(" Desynchronized mode unavailable, using standard context")),(()=>{const t=window.devicePixelRatio||1;navigator.connection?.saveData||4>=navigator.hardwareConcurrency||/Android|iPhone|iPad|iPod/i.test(navigator.userAgent)?(Ti=Math.min(t,1.25),console.log(` Adaptive DPR: Reduced to ${Ti}x for performance`)):Ti=Math.min(t,2),a(Ti)})(),Si.imageSmoothingEnabled=!1;const t=()=>{Fi&&cancelAnimationFrame(Fi),Fi=requestAnimationFrame(()=>{Yt(),Fi=null})};if(window.addEventListener("resize",t),window.addEventListener("orientationchange",()=>{setTimeout(Yt,100),setTimeout(Yt,300)}),window.visualViewport&&(window.visualViewport.addEventListener("resize",t),window.visualViewport.addEventListener("scroll",t)),"undefined"!=typeof ResizeObserver){const e=document.getElementById("bravia-balls");e&&new ResizeObserver(()=>{t()}).observe(e)}console.log(` Renderer optimized (DPR: ${Ti.toFixed(2)}, desync: ${Si.getContextAttributes?.()?.desynchronized??"unknown"})`)}function Yt(){if(!xi)return;const t=M();try{const t=window.visualViewport,e=t&&"number"==typeof t.height?t.height:window.innerHeight,n=t&&"number"==typeof t.width?t.width:window.innerWidth,o=e>0?e:window.innerHeight,a=n>0?n:window.innerWidth,i=t&&"number"==typeof t.offsetTop?t.offsetTop:0,r=t&&"number"==typeof t.offsetLeft?t.offsetLeft:0,s=Number.isFinite(i)?i:0,c=Number.isFinite(r)?r:0;let l=s+o/2,u=c+a/2;u>0||(u=window.innerWidth/2),l>0||(l=window.innerHeight/2);const d=document.documentElement?.style;d?.setProperty("--abs-viewport-h",o+"px"),d?.setProperty("--abs-vv-offset-top",s+"px"),d?.setProperty("--abs-vv-offset-left",c+"px"),d?.setProperty("--abs-vv-h",o+"px"),d?.setProperty("--abs-vv-w",a+"px"),d?.setProperty("--abs-vv-center-x",u+"px"),d?.setProperty("--abs-vv-center-y",l+"px")}catch(u){}try{f(),m()}catch(u){}try{y()}catch(u){}const e=t.container||document.getElementById("bravia-balls"),n=e?e.clientWidth:window.innerWidth,o=e?e.clientHeight:window.innerHeight;if(0>=n||0>=o)return;const a=n+2,i=o+2,r=Ti,s=Math.ceil(a*r),c=Math.ceil(i*r);if(0>=s||0>=c)return;if(s===Ai&&c===Li)return;if(Ai>0&&Li>0&&t.balls&&t.balls.length>0){const e=s/Ai,n=c/Li;if(e>.1&&10>e&&n>.1&&10>n){const o=t.balls;for(let t=0;o.length>t;t++){const a=o[t];if(!a)continue;a.x*=e,a.y*=n;const i=a.r||10;a.x=Math.max(i,Math.min(s-i,a.x)),a.y=Math.max(i,Math.min(c-i,a.y)),a.isSleeping&&(a.isSleeping=!1,a.sleepTimer=0)}}}Ai=s,Li=c;const l=xi.width!==s||xi.height!==c;if(l&&(xi.width=s,xi.height=c,Si&&(Si.imageSmoothingEnabled=!1)),xi.style.width=a+"px",xi.style.height=i+"px",l&&((t=>{t.style.filter=""})(xi),Pi))try{Pi()}catch(u){}try{const e=0;(xi.width!==Ii||xi.height!==Di||Math.abs(e-_i)>.001)&&(Ii=xi.width,Di=xi.height,_i=e,t.canvasClipPath=((t,e,n)=>{const o=Math.max(0,Math.min(n,.5*Math.min(t,e)));if("undefined"==typeof Path2D)return null;const a=new Path2D;return o>0?(a.moveTo(o,0),a.lineTo(t-o,0),a.arcTo(t,0,t,o,o),a.lineTo(t,e-o),a.arcTo(t,e,t-o,e,o),a.lineTo(o,e),a.arcTo(0,e,0,e-o,o),a.lineTo(0,o),a.arcTo(0,0,o,0,o),a.closePath(),a):(a.rect(0,0,t,e),a)})(xi.width,xi.height,e))}catch(u){}}function Xt(){return xi}function Zt(){return Si}function Kt(t,e,n,o,a){t.C=t.r,Ri.set(t,e*(.6+a/3*.8)),Wi.set(t,Math.random()*Math.PI*2),Ni.set(t,Math.random()*Math.PI*2),Oi.set(t,.8*n*(.8+a/3*.4)),zi.set(t,.4*n*(.7+.6*Math.random()))}function Qt(t,e){const n=M();if(n.currentMode!==ca.VORTEX)return;const o=n.mouseInCanvas?n.mouseX:n.canvas?.5*n.canvas.width:0,a=n.mouseInCanvas?n.mouseY:n.canvas?.5*n.canvas.height:0;let i=Wi.get(t);const r=Ri.get(t);let s=Ni.get(t);const c=zi.get(t),l=Oi.get(t);void 0!==i&&void 0!==r||(Kt(t,void 0!==n.vortexRadius?n.vortexRadius:300,n.vortexSpeedMultiplier??1,0,0),i=Wi.get(t),s=Ni.get(t));const u=n.vortexRotationDirection??1,d=n.vortexDepthVariation??.6,h=n.vortexSpiralTightness??.5;i+=l*u*e,i>2*Math.PI&&(i-=2*Math.PI),0>i&&(i+=2*Math.PI),Wi.set(t,i),s+=c*u*e,s>2*Math.PI&&(s-=2*Math.PI),0>s&&(s+=2*Math.PI),Ni.set(t,s);const f=(Math.sin(s)+1)/2,m=r*(1+(1-f)*h*.4),p=o+Math.cos(i)*m,b=a+Math.sin(i)*m,v=t.x-o,g=t.y-a,w=Math.max(30,Math.sqrt(v*v+g*g)),y=m*l*u,x=-Math.sin(i)*u*y,S=Math.cos(i)*u*y,k=n.vortexSwirlStrength||450,C=-(w-m)*k*.2,T=g/w;t.vx+=v/w*C*e,t.vy+=T*C*e;const A=S-t.vy,L=.25*k;t.vx+=(x-t.vx)*L*e,t.vy+=A*L*e;const F=.15*k,P=p-t.x,I=b-t.y,D=Math.max(1,Math.sqrt(P*P+I*I));if(D>.2*m){const n=I/D*F;t.vx+=P/D*F*e,t.vy+=n*e}void 0===t.C&&(t.C=t.rBase||t.r),t.r=t.C*(.4+.6*(1-f*d));const _=Math.max(0,Math.min(1,n.vortexDrag??.01));t.vx*=1-_,t.vy*=1-_}function Jt(t){const e=M();if(e.currentMode!==ca.PING_PONG)return;if(!t.isPingPong)return;if(e.mouseInCanvas){const n=Math.max(0,e.pingPongCursorRadius||0)*e.DPR,o=t.x-e.mouseX,a=t.y-e.mouseY,i=Math.sqrt(o*o+a*a),r=n+t.r;if(r>i&&i>.1){const e=r-i,n=o/i,s=a/i;t.x+=n*e*1.1,t.y+=s*e*1.1;const c=t.vx*n+t.vy*s;0>c&&(t.vx-=2*c*n,t.vy-=2*c*s,t.omega+=.02*c)}}const n=e.pingPongSpeed||400;.9*n>Math.abs(t.vx)&&(t.vx=(0>t.vx?-1:1)*n),t.vy*=Math.max(0,Math.min(1,e.pingPongVerticalDamp??.995))}function te(t,e){const n=M();if(n.currentMode!==ca.MAGNETIC)return;if(!n.mouseInCanvas)return;const o=n.DPR||1,a=n.magneticStrength||65e3,i=n.magneticRadius||0,r=n.mouseX-t.x,s=n.mouseY-t.y,c=r*r+s*s,l=Math.max(30*o,Math.sqrt(c));if(i>0&&l>i*o)return;const u=a/c*1e3,d=s/l;t.vx+=r/l*u*e,t.vy+=d*u*e,t.omega=0;const h=(n.magneticMaxVelocity||2800)*o,f=Math.sqrt(t.vx*t.vx+t.vy*t.vy);f>h&&(t.vx=t.vx/f*h,t.vy=t.vy/f*h);const m=n.magneticDamping??.998;t.vx*=m,t.vy*=m}function ee(){const t=M();if(t.currentMode===ca.MAGNETIC)for(let e=0;t.balls.length>e;e++)t.balls[e].alpha=1}function ne(t,e,n,o,a=!1,i){const r=M(),s=r.DPR||1,c=.9+.2*Math.random(),l=Nt(r,ca.BUBBLES)*c,u=Number.isFinite(i)?Math.max(0,Math.min(1,i)):a?1:0,d=new gi(t,e,l*(1-Math.pow(1-u,3)),n);return d.distributionIndex=o,d.isBubble=!0,d.baseRadius=l,d.targetRadius=l,d.wobblePhase=Math.random()*Math.PI*2,d.wobbleFreq=2+3*Math.random(),d.vx=28*(Math.random()-.5)*s,d.vy=(-160-140*Math.random())*s,d.spawning=1>u&&!a,d.spawnProgress=u,d.dissipating=!1,d.dissipateProgress=0,d.alpha=1,d.microBurst=!1,d.microTime=0,d.microLife=0,d.microStartRadius=0,d.wobbleMul=.6+.8*Math.random(),r.balls.push(d),d}function oe(t){const e=M(),n=e.canvas;if(!n)return;const o=e.DPR||1,a=n.width,i=n.height;t.x=Math.random()*a,t.y=i+(60+30*Math.random())*o,t.vx=20*(Math.random()-.5)*o,t.vy=(-50-50*Math.random())*o,t.wobblePhase=Math.random()*Math.PI*2,t.wobbleFreq=2+3*Math.random(),t.color=K();const r=.9+.2*Math.random();t.targetRadius=Nt(e,ca.BUBBLES)*r,t.baseRadius=t.targetRadius,t.r=0,t.rBase=0,t.spawning=!0,t.spawnProgress=0,t.dissipating=!1,t.dissipateProgress=0,t.alpha=1,t.microBurst=!1,t.microTime=0,t.microLife=0,t.microStartRadius=0,t.wobbleMul=.6+.8*Math.random()}function ae(t,e){const n=M();if(n.currentMode!==ca.BUBBLES)return;if(!t.isBubble)return;const o=n.canvas;if(!o)return;if(t.microBurst){t.microTime+=e;const n=t.microLife||.18,o=Math.min(1,n>0?t.microTime/n:1),a=Math.max(0,1-o);return t.vx*=.94,t.vy*=.9,t.r=t.microStartRadius*a,t.rBase=t.r,t.alpha=Math.max(0,1-o),void(1>o||(t.microBurst=!1,oe(t)))}t.spawning&&(t.spawnProgress+=3*e,t.r=t.targetRadius*(1-Math.pow(1-Math.min(1,t.spawnProgress),3)),t.rBase=t.r,1>t.spawnProgress||(t.spawning=!1,t.r=t.targetRadius,t.rBase=t.targetRadius));const a=.01*(n.bubblesWobble||40)*(t.wobbleMul||1);if(t.vy-=(n.bubblesRiseSpeed||150)*n.DPR*e,t.wobblePhase+=t.wobbleFreq*e,t.vx+=Math.sin(t.wobblePhase)*a*100*e,t.vx*=.92,t.vy*=.96,n.mouseInCanvas){const o=t.x-n.mouseX,a=t.y-n.mouseY,i=Math.sqrt(o*o+a*a),r=Math.max(0,n.bubblesDeflectRadius||0)*n.DPR;if(r>i&&i>1){const n=3e3*Math.pow(1-i/r,3),s=o/i,c=a/i;if(t.vx+=s*n*e,t.vy+=c*n*e,.3*r>i){const n=500*(1-i/(.3*r));t.vx+=s*n*e,t.vy+=c*n*e}}}if(2*t.targetRadius>t.y&&!t.spawning&&!t.microBurst)return t.microBurst=!0,t.microTime=0,t.microLife=.18,t.microStartRadius=Math.max(.2,.5*t.targetRadius),t.r=t.microStartRadius,t.rBase=t.r,t.alpha=1,t.vx=40*(Math.random()-.5)*n.DPR,void(t.vy=-(260+140*Math.random())*n.DPR);(4*-t.r>t.x||t.x>o.width+4*t.r)&&oe(t)}function ie(){}function re(t,e,n){return Math.max(e,Math.min(n,t))}function se(t){const e=t.canvas;return e?re(Math.min(e.width,e.height)/1e3,.35,3):1}function ce(t,e,n,o){for(let a=0;t.length>a;a++){const i=t[a],r=e-i.x,s=n-i.y,c=o+i.r;if(c*c>r*r+s*s)return!0}return!1}function le(t,e,n,o=10){const a=2*o;return t.v+=o*o*(e-t.x)*n,t.v*=Math.max(0,1-a*n),t.x+=t.v*n,t.x}function ue(t,e,n,o){const a=M(),i=Math.max(2,a.wallInset||3)*(a.DPR||1),r=i+t.r,s=e-i-t.r,c=i+t.r,l=n-i-t.r,u=.92,d=Math.max(0,1-.15*o);r>t.x?(t.x=r,t.vx=Math.abs(t.vx)*u*d):t.x>s&&(t.x=s,t.vx=-Math.abs(t.vx)*u*d),c>t.y?(t.y=c,t.vy=Math.abs(t.vy)*u*d):t.y>l&&(t.y=l,t.vy=-Math.abs(t.vy)*u*d)}function de(t){return{count:t.kaleidoscope3BallCount??t.kaleidoscopeBallCount??150,wedges:t.kaleidoscope3Wedges??t.kaleidoscopeWedges??10,speed:t.kaleidoscope3Speed??t.kaleidoscopeSpeed??1.2,complexity:1.35,spawnAreaMul:t.kaleidoscope3SpawnAreaMul??t.kaleidoscopeSpawnAreaMul??1.05,sizeVariance:t.kaleidoscope3SizeVariance??t.kaleidoscopeSizeVariance??.5}}function he(t){return t===ca.KALEIDOSCOPE}function fe(t){return de(t).complexity}function me(t,e){const n=M();if(!he(n.currentMode))return;const o=n.canvas;if(!o)return;const a=.5*o.width,i=.5*o.height,r=se(n),s=re(de(n).speed??1,.2,2),c=performance.now(),l=120>c-(n.lastPointerMoveMs||0);void 0===n.T&&(n.T=0);const u=l?1:0;n.T+=(u-n.T)*(1-Math.exp(-e/Math.max(1e-4,u>n.T?.45:.65)));const d=n.T,h=fe(n),f=n.prefersReducedMotion?0:Math.max(0,n.kaleidoscopeIdleDrift??.012)*h*(1-Math.min(1,.7*d));if(f>0){const n=(t.A??0)+.02*t.age+35e-5*c,o=Math.cos(n)*f*9,a=Math.sin(1.1*n)*f*9;t.vx+=o*e,t.vy+=a*e}const m=t.x-a,p=t.y-i,b=Math.max(Vi,Math.sqrt(m*m+p*p)),v=m/b,g=p/b,w=v,y=30*r*s*d,x=-2.5*(b-(void 0!==t.L?t.L:b))*s*d;t.vx+=(-g*y+v*x)*e,t.vy+=(w*y+g*x)*e,t.vx*=.992,t.vy*=.992}function pe(t,e,n){return e>t?e:t>n?n:t}function Me(t){return t>Math.PI?t-=2*Math.PI:-Math.PI>t&&(t+=2*Math.PI),t}function be(t,e){const n=M(),o=n.canvas;if(!o)return;const a=n.DPR||1,i=Math.max(0,n.critterSpeed||0),r=Math.max(50,n.critterMaxSpeed||0)*a,s=Math.max(0,n.critterStepHz||0),c=n.critterStepSharpness??2.4,l=Math.max(0,n.critterTurnNoise||0),u=Math.max(.1,n.critterTurnDamp||0),d=Math.max(0,n.critterTurnSeek||0),h=Math.max(0,(n.critterAvoidRadius||0)*(n.DPR||1)),f=Math.max(0,n.critterAvoidForce||0),m=Math.max(0,n.critterEdgeAvoid||0),p=Math.max(0,n.critterMousePull||0),b=Math.max(0,n.critterMouseRadiusVw||0);let v=t.F||0,g=t.P||0,w=t.I||0,y=t.D??w,x=t._||0;const S=t.W||0;x>0?x=Math.max(0,x-e):.25*e>Math.random()&&(x=.03+.09*Math.random());let k=0,C=0;if(m>0){const e=o.width,a=o.height,i=Math.max(24*(n.DPR||1),.08*Math.min(e,a)),r=t.x,s=t.y;i>r?k+=1-r/i:r>e-i&&(k-=1-(e-r)/i),i>s?C+=1-s/i:s>a-i&&(C-=1-(a-s)/i);const c=1.35*m;k*=c,C*=c}let T=0;if(p>0&&-1e9!==n.mouseX){const e=(window.innerWidth||o.width)/100,a=Math.max(1,b*e)*(n.DPR||1),i=t.x-n.mouseX,r=t.y-n.mouseY,s=i*i+r*r;if(a*a>s){const t=Math.sqrt(s)+1e-6,e=1-t/a;T=e;const n=p*(.85+.65*e);k+=i/t*n,C+=r/t*n;const o=.25*e*n;k+=-r/t*o,C+=i/t*o,x=0}}if(h>0&&f>0){const o=n.balls,a=h*h;let i=0,r=0,s=0;for(let e=0;o.length>e;e++){const n=o[e];if(n===t)continue;const c=t.x-n.x,l=t.y-n.y,u=c*c+l*l;if(u>0&&a>u){const t=Math.sqrt(u),e=1-t/h,n=e*e,o=1/(t+1e-6);i+=c*o*n,r+=l*o*n,s++}}if(s>0){const n=1/s;k+=i*n*1.15,C+=r*n*1.15,t.vx+=i*n*.65*f*e,t.vy+=r*n*.65*f*e}}g+=(l*(1+1.35*T*p)*(2*Math.random()-1)+.35*S*l)*e,k*k+C*C>1e-6&&(g+=Me(Math.atan2(C,k)-v)*d*e),g*=Math.exp(-u*e),v=Me(v+g*e),s>0&&(y=w,w+=s*e,w-=0|w);const A=x>0?0:((t,e)=>{const n=(o=pe(o=.5>t?2*t:2-2*t,0,1))*o*(3-2*o);var o;const a=pe(e,.5,6);return Math.pow(n,a)})(w,c),L=1+.95*T*p;if(0>=x&&w>.82){const e=(w-.82)/.18*.1*(.65+.35*L);e>t.squashAmount&&(t.squashAmount=e,t.squashNormalAngle=-Math.PI/2)}if(0>=x&&s>0&&y>w){const e=Math.max(.25,t.m/(n.MASS_BASELINE_KG||129)),o=i*(.55+.55*A)*L*(.85+.3*Math.random()),a=Math.cos(v),r=Math.sin(v),s=-r,c=a,l=.18*(2*Math.random()-1)*(.35+.65*T)*o;t.vx+=(a*o+s*l)/e,t.vy+=(r*o+c*l)/e,t.squashAmount=Math.max(t.squashAmount,.2+.15*T),t.squashNormalAngle=Math.PI/2}const F=i*(.08+.25*A)*L;t.vx+=Math.cos(v)*F*e,t.vy+=Math.sin(v)*F*e;const P=t.vx,I=t.vy,D=P*P+I*I;if(D>r*r){const e=r/(Math.sqrt(D)+1e-6);t.vx=P*e,t.vy=I*e}t.F=v,t.P=g,t.I=w,t.D=y,t._=x,t.theta=v}function ve(t,e){if(t.R)return;const n=M(),o=Math.max(.25,t.m/n.MASS_BASELINE_KG),a=n.DPR||1,i=Math.max(0,n.neuralWanderStrength??350),r=t.N??0;t.N=r+e*(t.O??.2);const s=Math.cos(r)*i,c=Math.sin(r)*i;t.vx+=s*e/o,t.vy+=c*e/o;const l=(n.neuralSeparationRadius??100)*a,u=n.neuralSeparationStrength??8e3;let d=0,h=0,f=0;const m=n.balls;for(let M=0;m.length>M;M++){const e=m[M];if(e===t||e.R)continue;const n=t.x-e.x,o=t.y-e.y,a=Math.sqrt(n*n+o*o);if(l>a&&a>.1){const t=1-a/l;d+=n/a*t,h+=o/a*t,f++}}if(f>0&&(t.vx+=d/f*u*e/o,t.vy+=h/f*u*e/o),n.mouseInCanvas){const i=n.mouseX-t.x,r=n.mouseY-t.y,s=Math.max(20*a,Math.sqrt(i*i+r*r)),c=300*a,l=(n.neuralMouseStrength??4e4)*(s>c?0:1-s/c)/(s+50*a),u=r/s;t.vx+=i/s*l*e/o,t.vy+=u*l*e/o}const p=Math.pow(Math.max(0,Math.min(1,n.neuralDamping??.985)),60*e);t.vx*=p,t.vy*=p}function ge(){const t=M();if(t.currentMode!==ca.NEURAL)return;const e=t.neuralMaxLinksPerBall??6,n=t.neuralConnectorDensity??3,o=t.DPR||1,a=(t.neuralLinkDistanceVw??18)*(t.canvas.width/100||10)*o,i=a*a,r=t.balls.filter(t=>t.B);if(2>r.length)return;const s=[];for(let h=0;r.length>h;h++){const t=r[h];let n=0;for(let o=h+1;r.length>o&&e>n;o++){const e=r[o],a=t.x-e.x,c=t.y-e.y,l=a*a+c*c;i>l&&l>.1&&(s.push({nodeA:t,nodeB:e,dist:Math.sqrt(l)}),n++)}}const c=s.length*n;let l=t.balls.filter(t=>!t.B);for(;l.length>c;){const e=l.pop(),n=t.balls.indexOf(e);if(n>-1){t.balls.splice(n,1);const o=$i.indexOf(e);o>-1&&$i.splice(o,1)}}for(;c>l.length;){const e=new gi(0,0,.4*(t.ballSizeDesktop||9)*o,"#888");e.B=!1,e.R=!0,e.vx=0,e.vy=0,e.m=e.r*e.r*.05,e.alpha=.6,t.balls.push(e),$i.push(e),l.push(e)}const u=t.balls.filter(t=>!t.B);let d=0;for(const h of s){const{nodeA:t,nodeB:e}=h;for(let o=0;n>o&&u.length>d;o++){const a=(o+1)/(n+1),i=u[d];i.x=t.x+(e.x-t.x)*a,i.y=t.y+(e.y-t.y)*a,d++}}}function we(){ge()}function ye(){}function xe(t){if(!t.V)return;const e=M(),n=e.canvas;if(!n)return;const o=.5*n.width,a=.5*n.height;let i=0,r=0;e.mouseInCanvas&&(i=Math.max(-1,Math.min(1,(e.mouseX-o)/(.5*n.width))),r=Math.max(-1,Math.min(1,(e.mouseY-a)/(.5*n.height))));const s=Math.max(100,e.parallaxLinearFocalLength??400),c=Math.max(0,e.parallaxLinearParallaxStrength??120),{x:l,y:u,z:d}=t.V,h=s/(s+d),f=o+(l+i*c)*h,m=a+(u+r*c)*h;t.r=Rt(e,.768*(e.R_MED||20)*(e.DPR||1)*Math.max(.1,Math.min(6,e.parallaxLinearDotSizeMul??1.8))*(Number.isFinite(t.$)?t.$:1)*h),t.x=f,t.y=m,t.vx=0,t.vy=0}function Se(t,e){const n=M(),o=n.canvas,a=n.sphere3dState;if(!(o&&a&&t&&t.H))return;const i=n.sphere3dIdleSpeed??.15,r=n.sphere3dTumbleSpeed??2.5,s=Math.max(0,Math.min(.999,n.sphere3dTumbleDamping??.94)),c=Math.max(.1,n.sphere3dDotSizeMul??1.5);if(t===n.balls[0]){const t=.5*o.width,c=.5*o.height;if(n.mouseInCanvas){const e=n.mouseY-(a.prevMouseY??n.mouseY),o=100*(n.DPR||1),i=Math.max(-o,Math.min(o,n.mouseX-(a.prevMouseX??n.mouseX))),s=Math.max(-o,Math.min(o,e));a.prevMouseX=n.mouseX,a.prevMouseY=n.mouseY;const l=n.mouseX-t,u=n.mouseY-c;if(a.radiusPx*a.dotSizeMul*1.5>Math.sqrt(l*l+u*u)){const t=.02*r;a.tumbleY+=i*t,a.tumbleX+=-s*t}}else a.prevMouseX=void 0,a.prevMouseY=void 0;a.tumbleX*=s,a.tumbleY*=s,a.rotY+=(i+a.tumbleY)*e,a.rotX+=(.6*i+a.tumbleX)*e,a.rotZ+=.2*i*e}const{theta:l,phi:u}=t.H,d=a.radiusPx,h=((t,e,n,o,a,i)=>{const r=Math.cos(a),s=Math.sin(a),c=t*r-n*s,l=t*s+n*r,u=Math.cos(o),d=Math.sin(o),h=e*u-l*d,f=e*d+l*u,m=Math.cos(i),p=Math.sin(i);return{x:c*m-h*p,y:c*p+h*m,z:f}})(d*Math.sin(u)*Math.cos(l),d*Math.cos(u),d*Math.sin(u)*Math.sin(l),a.rotX,a.rotY,a.rotZ),f=Math.max(80,n.sphere3dFocalLength??600),m=f/(f+(h.z+d)),p=a.cx+h.x*m,b=a.cy+h.y*m;t.r=Rt(n,t.q*c*m),t.x=p,t.y=b,t.vx=0,t.vy=0,t.omega=0,t.isSleeping=!1}function ke(t){return Math.max(-1,Math.min(1,t))}function Ce(t,e,n){return t+(e-t)*n}function Te(t,e){const n=M(),o=n.canvas,a=n.cube3dState;if(!(o&&a&&t&&t.U))return;const i=n.cube3dIdleSpeed??.2,r=n.cube3dCursorInfluence??1.5,s=n.cube3dTumbleSpeed??3,c=Math.max(0,Math.min(.999,n.cube3dTumbleDamping??.95)),l=Math.max(.1,n.cube3dDotSizeMul??1.5);if(t===n.balls[0]){const t=.5*o.height,l=n.mouseInCanvas?ke((n.mouseX-.5*o.width)/(.5*o.width)):0,u=n.mouseInCanvas?ke((n.mouseY-t)/(.5*o.height)):0,d=l-(a.prevNx??0),h=u-(a.prevNy??0);a.prevNx=l,a.prevNy=u,a.tumbleX+=-h*s,a.tumbleY+=d*s,a.tumbleX*=c,a.tumbleY*=c,a.rotY+=(i+l*r+a.tumbleY)*e,a.rotX+=(.6*i+u*r+a.tumbleX)*e,a.rotZ+=.2*i*e}const{x:u,y:d,z:h}=t.U,f=((t,e,n,o,a,i)=>{const r=Math.cos(a),s=Math.sin(a),c=t*r-n*s,l=t*s+n*r,u=Math.cos(o),d=Math.sin(o),h=e*u-l*d,f=e*d+l*u,m=Math.cos(i),p=Math.sin(i);return{x:c*m-h*p,y:c*p+h*m,z:f}})(u,d,h,a.rotX,a.rotY,a.rotZ),m=Math.max(80,n.cube3dFocalLength??500),p=m/(m+(f.z+(a.sizePx||1))),b=a.cx+f.x*p,v=a.cy+f.y*p;t.r=Rt(n,t.q*l*p),t.x=b,t.y=v,t.vx=0,t.vy=0,t.omega=0,t.isSleeping=!1}function Ae(t,e,n,o,a,i){return{x:(2*Math.random()-1)*t*a*.5,y:(2*Math.random()-1)*e*i*.5,z:n+Math.random()*(o-n),color:K(),alpha:0,fadeState:"fadingIn"}}function Le(t){const e=M(),n=e.canvas;if(!n||0===ji.length)return;const o=performance.now(),a=Math.min(.1,(o-qi)/1e3);qi=o;const i=n.width,r=n.height,s=.5*i,c=.5*r,l=4*Math.max(.5,Math.min(4,e.starfieldSpanX??1.5)),u=4*Math.max(.5,Math.min(4,e.starfieldSpanY??1.2)),d=Math.max(20,e.starfieldZNear??100),h=Math.max(d+200,e.starfieldZFar??2e3),f=Math.max(100,e.starfieldFocalLength??500),m=Math.max(10,e.starfieldSpeed??400),p=(e.R_MED||20)*Math.max(.2,Math.min(4,e.starfieldDotSizeMul??1))*2,b=s,v=c,g=Math.max(0,e.starfieldFadeDuration??.5);for(let M=0;ji.length>M;M++){const e=ji[M];e.z-=m*a,d>e.z&&(e.z=h+Math.random()*(h-d)*.3,e.x=(2*Math.random()-1)*i*l*.5,e.y=(2*Math.random()-1)*r*u*.5,e.color=K(),e.alpha=0,e.fadeState="fadingIn",e.fadeTimer=0),g>0?(e.fadeState||(e.fadeState="fadingIn",e.fadeTimer=0),void 0===e.fadeTimer&&(e.fadeTimer=0),"fadingIn"===e.fadeState?(e.fadeTimer+=a,g>e.fadeTimer?e.alpha=e.fadeTimer/g:(e.alpha=1,e.fadeState="visible",e.fadeTimer=0)):"visible"===e.fadeState?d+.1*(h-d)>e.z?(e.fadeState="fadingOut",e.fadeTimer=0):e.alpha=1:"fadingOut"===e.fadeState&&(e.fadeTimer+=a,g>e.fadeTimer?e.alpha=1-e.fadeTimer/g:(e.alpha=0,e.fadeTimer=0))):e.alpha=1;const n=f/(f+e.z),o=b+e.x*n,s=v+e.y*n,c=p;e.alpha>0&&(t.globalAlpha=e.alpha,t.beginPath(),t.arc(o,s,c,0,2*Math.PI),t.fillStyle=e.color,t.fill(),t.globalAlpha=1)}}function Fe(){}function Pe(){}function Ie(t,e){const n=M();if(n.currentMode!==ca.ELASTIC_CENTER)return;if(!t.isElasticCenter)return;const o=(n.elasticCenterElasticStrength??2e3)*n.DPR,a=Ui+t.Y-t.x,i=Yi+t.X-t.y,r=Math.max(.1,Math.sqrt(a*a+i*i)),s=o*r*e,c=i/r;if(t.vx+=a/r*s,t.vy+=c*s,n.mouseInCanvas){const o=(n.elasticCenterMouseRepelStrength??12e3)*n.DPR,a=(n.elasticCenterMouseRadius??200)*n.DPR,i=t.x-n.mouseX,r=t.y-n.mouseY,s=Math.sqrt(i*i+r*r);if(a>s&&s>.1){const n=1-s/a,c=o*n*n*e,l=r/s;t.vx+=i/s*c,t.vy+=l*c}}const l=n.elasticCenterDamping??.94;t.vx*=l,t.vy*=l}function De(){const t=M();if(t.currentMode!==ca.ELASTIC_CENTER)return;const e=t.canvas;e&&(Ui=.5*e.width,Yi=.5*e.height)}function _e(){}function Ee(t){const e=M();if(e.currentMode!==ca.DVD_LOGO)return;const n=e.canvas;if(!n)return;const o=n.width,a=n.height,i=e.DPR||1,r=e.balls;if(0===r.length)return;const s=Math.max(0,(e.wallThickness??0)*i)+Math.max(0,(e.wallInset??3)*i);let c=1/0,l=-1/0,u=1/0,d=-1/0;for(let M=0;r.length>M;M++){const t=r[M];if(!t.isDvdLogo)continue;const e=t.x-t.r,n=t.x+t.r,o=t.y-t.r,a=t.y+t.r;c>e&&(c=e),n>l&&(l=n),u>o&&(u=o),a>d&&(d=a)}let h=!1,f=null;const m=.5773502691896257;if(c>s||0>Ki&&(Ki=Math.abs(Ki),Xi+=s-c,h=!0,Math.abs(Qi)*m>Math.abs(Ki)&&(Ki=Math.abs(Qi)*m*Math.sign(Ki||1))),o-s>l||Ki>0&&(Ki=-Math.abs(Ki),Xi-=l-(o-s),h=!0,Math.abs(Qi)*m>Math.abs(Ki)&&(Ki=-Math.abs(Qi)*m)),u>s||0>Qi&&(Qi=Math.abs(Qi),Zi+=s-u,h=!0,Math.abs(Ki)*m>Math.abs(Qi)&&(Qi=Math.abs(Ki)*m*Math.sign(Qi||1))),a-s>d||Qi>0&&(Qi=-Math.abs(Qi),Zi-=d-(a-s),h=!0,Math.abs(Ki)*m>Math.abs(Qi)&&(Qi=-Math.abs(Ki)*m)),h){const t=["#ff4013","#0d5cb6","#ffa000","#00695c","#ffffff","#b5b7b6","#000000"];Ji=(Ji+1)%t.length,f=t[Ji]}const p=(e.dvdLogoSpeed||200)*i,b=Math.sqrt(Ki*Ki+Qi*Qi);if(b>.1){const t=p/b;Ki*=t,Qi*=t}Xi+=Ki*t,Zi+=Qi*t;for(let M=0;r.length>M;M++){const t=r[M];t.isDvdLogo&&(t.x=Xi+t.Z,t.y=Zi+t.K,t.vx=Ki,t.vy=Qi,t.omega=0,t.squashAmount=0,f&&(t.color=f))}}function We(t,e){const n=M();if(n.currentMode!==ca.SNAKE)return;if(!t.isSnake)return;const o=n.DPR||1,a=(n.snakeSpringStrength??50)*o,i=n.snakeDamping??.97,r=n.snakeGroundFriction??1,s=(n.snakeSpeed??400)*o,c=nr.get(t),l=er.get(t);if(0===c){const e=performance.now(),o=e-(n.lastPointerMoveMs||0)>150;if(t.J&&n.mouseInCanvas&&!o&&(t.J=!1),t.J)return t.vx=0,void(t.vy=0);const a={x:t.x,y:t.y,time:e};if((0===ar.length||Math.hypot(t.x-ar[ar.length-1].x,t.y-ar[ar.length-1].y)>.5)&&(ar.push(a),ar.length>2e3&&ar.shift()),n.mouseInCanvas&&!o){const e=n.mouseX-t.x,o=n.mouseY-t.y,a=Math.sqrt(e*e+o*o);if(a>.1){const n=o/a;t.vx=e/a*s,t.vy=n*s}else 10>Math.sqrt(t.vx*t.vx+t.vy*t.vy)&&(t.vx=0,t.vy=0)}else t.vx=0,t.vy=0}if(l&&c>0){const i=.5*(n.R_MIN+n.R_MAX),r=(n.snakeRestLength??25)*o,u=(t=>{if(2>ar.length)return ar.length>0?ar[0]:null;let e=0;for(let n=ar.length-1;n>0;n--){const o=ar[n],a=ar[n-1],i=a.x-o.x,r=a.y-o.y,s=Math.sqrt(i*i+r*r);if(e+s>=t){const n=(t-e)/s;return{x:o.x+i*n,y:o.y+r*n,time:o.time+(a.time-o.time)*n}}e+=s}return ar[0]})(c*(or.get(l)??2*i+.3*(r-2*i)));if(u){const n=u.x-t.x,o=u.y-t.y,i=Math.max(.1,Math.sqrt(n*n+o*o)),r=a*i*e*.5,c=o/i;t.vx+=n/i*r,t.vy+=c*r;const l=Math.sqrt(t.vx*t.vx+t.vy*t.vy),d=1.5*s;l>d&&(t.vx=t.vx/l*d,t.vy=t.vy/l*d)}}t.vx*=i,t.vy*=i;const u=Math.sqrt(t.vx*t.vx+t.vy*t.vy);if(u>0){const n=r*u*e,o=-t.vy/u*n;t.vx+=-t.vx/u*n,t.vy+=o}t.omega&&(t.omega*=.95*i)}function Re(){if(M().currentMode!==ca.SNAKE)return;const t=performance.now();for(;ar.length>0&&t-ar[0].time>1e4;)ar.shift()}function Ne(){const t=M(),e=t.canvas;if(!e)return null;const n=t.DPR||1,o=e.width,a=e.height,i=Nt(t,ca.PARTICLE_FOUNTAIN),r=o/2,s=a-(Math.max(0,(t.wallThickness??0)*n)+Math.max(0,(t.wallInset??3)*n))-.5*i,{color:c,distributionIndex:l}=Z(),u=new gi(r,s,i,c);u.distributionIndex=l,u.isParticleFountain=!0,u.alpha=1,u.age=0,u.fading=!1,u.fadeProgress=0,u.originalRadius=i;const d=Oe(t,e,s)*(.9+.2*Math.random()),h=(t.particleFountainSpreadAngle??50)*Math.PI/180,f=(Math.random()-.5)*h;return u.vy=-d*Math.cos(f),u.vx=d*Math.sin(f),t.balls.push(u),u}function ze(t){const e=M(),n=e.canvas;if(!n)return;const o=e.DPR||1,a=n.width,i=n.height,r=Nt(e,ca.PARTICLE_FOUNTAIN),s=i-(Math.max(0,(e.wallThickness??0)*o)+Math.max(0,(e.wallInset??3)*o))-.5*r;t.x=a/2,t.y=s,t.alpha=1,t.r=r,t.rBase=r,t.age=0,t.fading=!1,t.fadeProgress=0,t.originalRadius=r;const c=Oe(e,n,s)*(.9+.2*Math.random()),l=(e.particleFountainSpreadAngle??50)*Math.PI/180,u=(Math.random()-.5)*l;if(t.vy=-c*Math.cos(u),t.vx=c*Math.sin(u),.3>Math.random()){const{color:e,distributionIndex:n}=Z();t.color=e,t.distributionIndex=n}}function Oe(t,e,n){const o=(t.particleFountainInitialVelocity||600)*(t.DPR||1);if(!t.isMobile&&!t.isMobileViewport)return o;const a=Math.max(0,n-.6*e.height);return Math.min(o,Math.sqrt(2*Math.max(.01,Math.abs(t.G||t.GE*(t.gravityMultiplier||1)))*a))}function Be(t,e){const n=M();if(n.currentMode!==ca.PARTICLE_FOUNTAIN)return;if(!t.isParticleFountain)return;const o=n.particleFountainLifetime??8;if(t.fading||(t.age+=e,o>t.age||(t.fading=!0,t.fadeProgress=0,t.originalRadius||(t.originalRadius=t.rBase||t.r))),t.fading){t.fadeProgress+=e;const n=Math.min(1,t.fadeProgress/2);return t.alpha=Math.max(0,1-(1-Math.sqrt(1-n*n))),void(1>n||(t.alpha=0))}if(n.mouseInCanvas){const o=(n.particleFountainMouseRepelStrength??15e3)*n.DPR,a=(n.particleFountainMouseRepelRadius??0)*n.DPR,i=t.x-n.mouseX,r=t.y-n.mouseY,s=Math.sqrt(i*i+r*r);if(a>s&&s>.1){const n=o*(1-s/a)*e,c=r/s;t.vx+=i/s*n,t.vy+=c*n}}const a=n.particleFountainWaterDrag??.02;t.vx*=1-a,t.vy*=1-a,t.omega*=1-.5*a;const i=n.particleFountainUpwardForce||0;i>0&&(t.vy-=i*n.DPR*e)}function Ve(t){const e=M();if(e.currentMode!==ca.PARTICLE_FOUNTAIN)return;const n=e.canvas;if(!n)return;const o=e.DPR||1,a=n.height-Math.max(0,(e.wallThickness??0)*o)-Math.max(0,(e.wallInset??3)*o),i=20*o;for(let m=e.balls.length-1;m>=0;m--){const t=e.balls[m];t.isParticleFountain&&(!t.fading||t.alpha>0?t.fading||a>t.y||-i>t.vy||ze(t):e.balls.splice(m,1))}const r=e.particleFountainEmissionRate||30,s=Math.max(1,Math.round(r*((e.particleFountainLifetime??8)+2))),c=b(e.isMobile||e.isMobileViewport?s:e.particleFountainMaxParticles||s);ir+=t;const l=1/r;let u=0,d=null,h=null,f=-1/0;for(let m=0;e.balls.length>m;m++){const t=e.balls[m];if(t.isParticleFountain){u+=1,d||(t.fading||t.y>=a&&t.vy>=-i)&&(d=t);const e=t.age??0;e>f&&(f=e,h=t)}}for(;ir>=l;){if(c>u)Ne(),u+=1;else{const t=d||h;t&&ze(t)}ir-=l}ir>2*l&&(ir=0)}function Ge(t){function e(n){if(!dr)return void(hr=null);const o=n-ur;if(fr>o)return void(hr=requestAnimationFrame(e));ur=n-o%fr,(t=>{if(mr.push(t),mr.length>30&&mr.shift(),30===mr.length){const t=1e3/(mr.reduce((t,e)=>t+e,0)/30);30>t&&2>pr?(pr++,console.log(` Adaptive throttle increased to level ${pr} (avg FPS: ${t.toFixed(1)})`)):t>55&&pr>0&&(pr--,console.log(` Adaptive throttle decreased to level ${pr} (avg FPS: ${t.toFixed(1)})`))}})(o);const a=n/1e3;let i=Math.min(.033,a-lr);lr=a,(2>pr||Math.random()>.5)&&Pn(i,t),In(),(t=>{if(sr++,t-rr>1e3){cr=sr,sr=0,rr=t;const e=document.getElementById("render-fps");e&&(e.textContent=cr+"")}})(performance.now()),hr=requestAnimationFrame(e)}document.addEventListener("visibilitychange",()=>{dr=!document.hidden,dr?(lr=performance.now()/1e3,ur=performance.now(),console.log(" Animation resumed"),hr||(hr=requestAnimationFrame(e))):(console.log(" Animation paused (tab hidden)"),hr&&(cancelAnimationFrame(hr),hr=null))}),hr=requestAnimationFrame(e),console.log(" Render loop started (60fps throttle, visibility-aware)")}function $e(t){const e=M(),n=e.currentMode;if(Tn(),mr=[],pr=0,bi?.ringPhysics?.reset&&bi.ringPhysics.reset(),bi?.ringRender?.reset&&bi.ringRender.reset(),bi.p=null,bi.M=null,bi.tt=0,bi.et=0,e.currentMode===ca.CRITTERS&&t!==ca.CRITTERS&&(void 0!==e.nt&&(e.REST=e.nt,delete e.nt),void 0!==e.ot&&(e.FRICTION=e.ot,delete e.ot),void 0!==e.it&&(e.ballSpacing=e.it,delete e.it)),g(t),t!==n)try{Y?.()}catch(a){}if(console.log("Switching to mode: "+t),(t=>{const e=document.getElementById("announcer");e&&(e.textContent="",setTimeout(()=>{e.textContent=t},10))})(`Switched to ${{pit:"Ball Pit",flies:"Flies to Light",weightless:"Zero Gravity",water:"Water Swimming",vortex:"Vortex Sheets","ping-pong":"Ping Pong",magnetic:"Magnetic",bubbles:"Carbonated Bubbles","kaleidoscope-3":"Kaleidoscope",critters:"Critters",neural:"Neural Network","parallax-linear":"Parallax (Linear)","3d-sphere":"3D Sphere","3d-cube":"3D Cube","starfield-3d":"3D Starfield","elastic-center":"Elastic Center","dvd-logo":"DVD Logo",snake:"Snake","particle-fountain":"Particle Fountain"}[t]||t} mode`),e.container){const n=e.container.classList.contains("dark-mode");e.container.className="",t===ca.PIT&&e.container.classList.add("mode-pit"),(n||e.isDarkMode)&&e.container.classList.add("dark-mode")}if(Yt(),t===ca.PIT?(e.gravityMultiplier=e.gravityMultiplierPit,e.G=e.GE*e.gravityMultiplier,e.repellerEnabled=!0,(()=>{const t=M();w(),((t,e)=>{const n=t.DPR,o=-.65*t.canvas.height,a=(t.wallThickness||20)*n,i=a,r=t.canvas.width-a,s=r-i,c=Math.max(1,.22*s),l=i+s*(2/3),u=Math.max(i,l-.5*c),d=Math.min(r,l+.5*c),h=Math.max(0,0|e),f=100*n,m=50*n;for(let p=0;h>p;p++){const t=Gt(u+Math.random()*(d-u),o+Math.random()*(0-o));t.vx=(Math.random()-.5)*f,t.vy=Math.random()*m+m,t.driftAx=0,t.driftTime=0}})(t,b(t.maxBalls??300))})()):t===ca.FLIES?(e.gravityMultiplier=0,e.G=0,e.repellerEnabled=!1,(()=>{const t=M();w();const e=b(t.fliesBallCount??60);if(0>=e)return;const n=.5*t.canvas.width,o=.5*t.canvas.height,a=150*t.DPR,i=300*t.DPR;for(let r=0;8>r;r++){const t=Math.random()*Math.PI*2,e=Math.random()*a,r=Gt(n+Math.cos(t)*e,o+Math.sin(t)*e,K()),s=.5+.5*Math.random(),c=Math.random()*Math.PI*2,l=i*s;r.vx=Math.cos(c)*l,r.vy=Math.sin(c)*l,r.driftAx=0,r.driftTime=0}for(let r=8;e>r;r++){const t=Math.random()*Math.PI*2,e=Math.random()*a,r=Gt(n+Math.cos(t)*e,o+Math.sin(t)*e),s=.5+.5*Math.random(),c=Math.random()*Math.PI*2,l=i*s;r.vx=Math.cos(c)*l,r.vy=Math.sin(c)*l,r.driftAx=0,r.driftTime=0}})()):t===ca.WEIGHTLESS?(e.gravityMultiplier=0,e.G=0,e.repellerEnabled=!1,(()=>{const t=M();w();const e=b(t.weightlessCount);e>0&&((t,e)=>{const n=t.canvas;if(!n)return;const o=n.width,a=n.height,i=t.DPR||1,r=(t=>{let e=1;for(;t>e*(e+1)/2;)e++;return e})(e),s=Math.min(e,r*(r+1)/2),c=.5*((t.R_MIN||15)+(t.R_MAX||25))*i*2.1,l=(r-1)*c,u=.5*o-.5*l,d=.5*a-(r-1)*c*Math.sqrt(3)/2*.5;let h=0;for(let f=0;r>f&&s>h;f++){const t=f+1,e=u+.5*(l-(t-1)*c),n=d+f*c*Math.sqrt(3)/2;for(let o=0;t>o&&s>h;o++){const t=Gt(e+o*c,n);t.vx=0,t.vy=0,t.omega=0,t.driftAx=0,t.driftTime=0,h++}}})(t,e)})()):t===ca.WATER?(e.gravityMultiplier=0,e.G=0,e.repellerEnabled=!1,(()=>{const t=M();w(),yi.length=0;const e=t.canvas;if(!e)return;const n=e.width,o=e.height,a=b(t.waterBallCount||100);if(0>=a)return;const i=(t.waterInitialVelocity||120)*(t.DPR||1);for(let r=0;8>r&&a>r;r++){const e=Math.random()*n,a=Math.random()*o,r=Nt(t,ca.WATER),{color:s,distributionIndex:c}=Z(),l=new gi(e,a,r,s);l.distributionIndex=c,l.vx=(Math.random()-.5)*i,l.vy=(Math.random()-.5)*i,t.balls.push(l)}for(let r=8;a>r;r++){const e=Math.random()*n,a=Math.random()*o,r=Nt(t,ca.WATER),{color:s,distributionIndex:c}=Z(),l=new gi(e,a,r,s);l.distributionIndex=c,l.vx=(Math.random()-.5)*i,l.vy=(Math.random()-.5)*i,t.balls.push(l)}})()):t===ca.VORTEX?(e.gravityMultiplier=0,e.G=0,e.repellerEnabled=!1,(()=>{const t=M();w();const e=t.canvas;if(!e)return;const n=e.width,o=e.height,a=b(Math.min(t.vortexBallCount||180,t.maxBalls||500));if(0>=a)return;const i=t.vortexSpeedMultiplier??1,r=void 0!==t.vortexRadius?t.vortexRadius:300;let s=0;for(let c=0;8>c&&a>c;c++){const e=Math.random()*n,a=Math.random()*o,c=Nt(t,ca.VORTEX),{color:l,distributionIndex:u}=Z(),d=new gi(e,a,c,l);d.distributionIndex=u,Kt(d,r,i,0,s%3),t.balls.push(d),s++}for(let c=s;a>c;c++){const e=Math.random()*n,a=Math.random()*o,s=Nt(t,ca.VORTEX),{color:l,distributionIndex:u}=Z(),d=new gi(e,a,s,l);d.distributionIndex=u,Kt(d,r,i,0,c%3),t.balls.push(d)}})()):t===ca.PING_PONG?(e.gravityMultiplier=0,e.G=0,e.repellerEnabled=!1,(()=>{const t=M();w();const e=t.canvas;if(!e)return;const n=e.width,o=e.height,a=b(Math.min(t.pingPongBallCount||80,t.maxBalls||300));if(0>=a)return;const i=t.pingPongSpeed||400;for(let r=0;8>r&&a>r;r++){const e=Math.random()*n,a=.15*o+Math.random()*o*.7,r=Nt(t,ca.PING_PONG),{color:s,distributionIndex:c}=Z(),l=new gi(e,a,r,s);l.distributionIndex=c,l.vx=(Math.random()>.5?1:-1)*(.8*i+Math.random()*i*.4),l.vy=0,l.isPingPong=!0,t.balls.push(l)}for(let r=8;a>r;r++){const e=Math.random()*n,a=.15*o+Math.random()*o*.7,r=Nt(t,ca.PING_PONG),{color:s,distributionIndex:c}=Z(),l=new gi(e,a,r,s);l.distributionIndex=c,l.vx=(Math.random()>.5?1:-1)*(.8*i+Math.random()*i*.4),l.vy=0,l.isPingPong=!0,t.balls.push(l)}})()):t===ca.MAGNETIC?(e.gravityMultiplier=0,e.G=0,e.repellerEnabled=!1,(()=>{const t=M();w();const e=t.canvas;if(!e)return;const n=e.width,o=e.height,a=b(Math.min(t.magneticBallCount||180,t.maxBalls||300));if(0>=a)return;const i=100*(t.DPR||1);for(let r=0;8>r&&a>r;r++){const e=Math.random()*n,a=Math.random()*o,r=Nt(t,ca.MAGNETIC),{color:s,distributionIndex:c}=Z(),l=new gi(e,a,r,s);l.distributionIndex=c,l.vx=(Math.random()-.5)*i,l.vy=(Math.random()-.5)*i,l.baseAlpha=1,t.balls.push(l)}for(let r=8;a>r;r++){const e=Math.random()*n,a=Math.random()*o,r=Nt(t,ca.MAGNETIC),{color:s,distributionIndex:c}=Z(),l=new gi(e,a,r,s);l.distributionIndex=c,l.vx=(Math.random()-.5)*i,l.vy=(Math.random()-.5)*i,l.baseAlpha=1,t.balls.push(l)}})()):t===ca.BUBBLES?(e.gravityMultiplier=0,e.G=0,e.repellerEnabled=!1,(()=>{const t=M();t.balls.length=0;const e=t.canvas;if(!e)return;const n=e.width,o=e.height,a=b(t.bubblesMaxCount||200);if(a>0){for(let t=0;8>t&&a>t;t++){const t=Math.random()*n,e=Math.random()*o,{color:a,distributionIndex:i}=Z();ne(t,e,a,i,!1,Math.random())}for(let t=8;a>t;t++){const t=Math.random()*n,e=Math.random()*o,{color:a,distributionIndex:i}=Z();ne(t,e,a,i,!1,Math.random())}}})()):t===ca.KALEIDOSCOPE?(e.gravityMultiplier=0,e.G=0,e.repellerEnabled=!1,(()=>{const t=M();((t,e)=>{function n(t){const e=Math.max(0,Math.min(1,t/Math.max(b,1))),n=.55>=e||.75>e&&.65>Math.random()?x:S,o=n[Math.floor(Math.random()*n.length)]??0;return{color:g[o]||g[0]||"#ffffff",distributionIndex:(t=>{const e=Math.max(0,Math.min(7,0|t));for(let n=0;y.length>n;n++){const t=y[n];if((0|t?.colorIndex)===e)return n}return 0})(o)}}function o(){const t=((t,e)=>{const n=t?.canvas,o=n?.height||0;if(!o)return Nt(t,e);const a=_t(+(t.kaleidoscope3DotSizeVh??t.kaleidoscopeDotSizeVh??1.05),.1,6),i=_t(+(t.kaleidoscope3DotAreaMul??t.kaleidoscopeDotAreaMul??.75),.1,2),r=Math.max(1,.01*a*o*Math.sqrt(i)),s=_t(.5*+(t.kaleidoscope3SizeVariance??t.kaleidoscopeSizeVariance??.5),0,wi),c=Math.max(1,r*(1-s)),l=Math.max(1,r*(1+s));return Rt(t,1e-6>l-c?r:Et(c,l,Math.random()))})(a,e),o=1.2*b,i=c-o,r=c+o,s=l-o,d=l+o;for(let e=0;90>e;e++){const e=Math.random()*Bi,o=p+Math.random()*(b-p),h=re(c+Math.cos(e)*o,i,r),f=re(l+Math.sin(e)*o,s,d),m=t*(1+(a.ballSpacing||0));if(!ce(v,h,f,m)){v.push({x:h,y:f,r:m});const{color:i,distributionIndex:r}=n(o),s=new gi(h,f,t,i);s.distributionIndex=r,s.A=Math.random()*Bi;const d=h-c,p=f-l;s.L=Math.sqrt(d*d+p*p);const M=(12+12*Math.random())*u;return s.vx=-Math.sin(e)*M,s.vy=Math.cos(e)*M,s.driftAx=0,s.driftTime=0,void a.balls.push(s)}}const h=Math.random()*Bi,f=p+Math.random()*(b-p),m=c+Math.cos(h)*f,M=l+Math.sin(h)*f,{color:g,distributionIndex:w}=n(f),y=new gi(m,M,t,g);y.distributionIndex=w,y.A=Math.random()*Bi;const x=m-c,S=M-l;y.L=Math.sqrt(x*x+S*S);const k=(12+12*Math.random())*u;y.vx=-Math.sin(h)*k,y.vy=Math.cos(h)*k,y.driftAx=0,y.driftTime=0,a.balls.push(y)}const a=M();w();const i=a.canvas;if(!i)return;const r=i.width,s=i.height,c=.5*r,l=.5*s,u=se(a),d=a.maxBalls||300,h=re(Math.max(0,0|t),0,d);if(0>=h)return;const f=re(de(a).spawnAreaMul??1,.2,2),m=Math.min(r,s),p=.05*m,b=2.8*m*f,v=[],g=Array.isArray(a.currentColors)?a.currentColors:[],y=Array.isArray(a.colorDistribution)?a.colorDistribution:[],x=[5,6,7,3,0],S=[0,1,2,4];for(let M=0;h>M;M++)o()})(b(t.kaleidoscope3BallCount??t.kaleidoscopeBallCount??150),ca.KALEIDOSCOPE)})()):t===ca.SPHERE_3D?(e.gravityMultiplier=0,e.G=0,e.repellerEnabled=!1,(()=>{const t=M(),e=t.canvas;if(!e)return;w();const n=b(Math.max(10,Math.round(t.sphere3dDensity??140)));if(0>=n)return;const o=Math.max(10,(t.sphere3dRadiusVw??18)/100*e.width),a=Math.max(.1,t.sphere3dDotSizeMul??1.5),i=.6*(t.R_MED||20)*(t.DPR||1);t.sphere3dState={cx:.5*e.width,cy:.5*e.height,radiusPx:o,rotX:0,rotY:0,rotZ:0,tumbleX:0,tumbleY:0,dotSizeMul:a};const r=(t=>{const e=[];for(let n=0;t>n;n++)e.push({theta:2*Math.PI*n/1.618033988749895,phi:Math.acos(1-2*(n+.5)/t)});return e})(n);for(let s=0;r.length>s;s++){const e=Gt(0,0);e&&(e.vx=0,e.vy=0,e.omega=0,e.r=Rt(t,i*a),e.q=i,e.H={theta:r[s].theta,phi:r[s].phi},e.rt="sphere",e.isSleeping=!1)}})()):t===ca.CUBE_3D?(e.gravityMultiplier=0,e.G=0,e.repellerEnabled=!1,(()=>{const t=M(),e=t.canvas;if(!e)return;w();const n=b(Math.max(2,Math.round(t.cube3dEdgeDensity??8))),o=Math.max(0,Math.round(t.cube3dFaceGrid??0)),a=o>0?b(o):0,i=Math.max(10,(t.cube3dSizeVw??25)/100*e.width),r=.6*(t.R_MED||20)*(t.DPR||1),s=Math.max(.1,t.cube3dDotSizeMul??1.5),c=((t,e,n)=>{const o=[],a=.5*t,i=Math.max(2,0|e),r=Math.max(0,0|n),s=[[-a,-a,-a],[a,-a,-a],[-a,a,-a],[a,a,-a],[-a,-a,a],[a,-a,a],[-a,a,a],[a,a,a]],c=[[0,1],[2,3],[4,5],[6,7],[0,2],[1,3],[4,6],[5,7],[0,4],[1,5],[2,6],[3,7]];for(const[l,u]of c)for(let t=0;i>=t;t++){const e=t/i;o.push({x:Ce(s[l][0],s[u][0],e),y:Ce(s[l][1],s[u][1],e),z:Ce(s[l][2],s[u][2],e)})}if(r>0){const e=r+1,n=t/e,i=[];for(let t=0;e>=t;t++)i.push(t*n-a);const s=[{axis:"z",value:-a},{axis:"z",value:a},{axis:"x",value:-a},{axis:"x",value:a},{axis:"y",value:-a},{axis:"y",value:a}];for(const t of s)for(let e=0;i.length>e;e++)for(let n=0;i.length>n;n++){let a=0,r=0,s=0;"z"===t.axis?(a=i[e],r=i[n],s=t.value):"x"===t.axis?(a=t.value,r=i[e],s=i[n]):(a=i[e],r=t.value,s=i[n]),o.push({x:a,y:r,z:s})}}return o})(i,n,a);t.cube3dState={cx:.5*e.width,cy:.5*e.height,sizePx:i,rotX:0,rotY:0,rotZ:0,idleSpeed:t.cube3dIdleSpeed??.2,cursorInfluence:t.cube3dCursorInfluence??1.5,tumbleX:0,tumbleY:0,tumbleDamping:Math.max(0,Math.min(.999,t.cube3dTumbleDamping??.95)),tumbleSpeed:t.cube3dTumbleSpeed??3,dotSizeMul:s};for(let l=0;c.length>l;l++){const e=Gt(0,0);e&&(e.vx=0,e.vy=0,e.omega=0,e.r=Rt(t,r*s),e.q=r,e.U={x:c[l].x,y:c[l].y,z:c[l].z},e.rt="cube",e.isSleeping=!1)}})()):t===ca.CRITTERS?(e.gravityMultiplier=0,e.G=0,e.repellerEnabled=!1,void 0===e.nt&&(e.nt=e.REST),void 0===e.ot&&(e.ot=e.FRICTION),e.REST=e.critterRestitution??e.REST,e.FRICTION=e.critterFriction??e.FRICTION,void 0===e.it&&(e.it=e.ballSpacing),e.ballSpacing=Math.min(e.ballSpacing||0,1),(()=>{const t=M();w();const e=t.canvas.width,n=t.canvas.height,o=b(Math.max(10,Math.min(260,0|t.critterCount)));if(o>0){for(let a=0;8>a&&o>a;a++){const o=Gt(Math.random()*e|0,Math.random()*n|0,K()),a=Nt(t,ca.CRITTERS);o.r=a,o.rBase=a,o.m=Math.max(1,a*a*.12),o.vx=0,o.vy=0,o.F=Math.random()*Math.PI*2,o.P=0,o.I=Math.random(),o.D=o.I,o.W=2*Math.random()-1,o._=0}for(let a=8;o>a;a++){const o=Gt(Math.random()*e|0,Math.random()*n|0,K()),a=Nt(t,ca.CRITTERS);o.r=a,o.rBase=a,o.m=Math.max(1,a*a*.12),o.vx=0,o.vy=0,o.F=Math.random()*Math.PI*2,o.P=0,o.I=Math.random(),o.D=o.I,o.W=2*Math.random()-1,o._=0}}})()):t===ca.NEURAL?(e.gravityMultiplier=0,e.G=0,e.repellerEnabled=!0,(()=>{const t=M(),e=t.canvas;if(!e)return;w(),$i=[],Hi=[];const n=b(Math.max(8,Math.min(t.neuralBallCount??180,400)));if(0>=n)return;const o=e.width,a=e.height,i=40*(t.DPR||1),r=Math.min(8,n);for(let s=0;r>s;s++){const e=Gt(i+Math.random()*(o-2*i),i+Math.random()*(a-2*i),K()),n=Nt(t,ca.NEURAL);e.r=n,e.rBase=n,e.m=Math.max(1,n*n*.12),e.vx=0,e.vy=0,e.driftAx=0,e.driftTime=0,e.N=Math.random()*Math.PI*2,e.O=.15+.15*Math.random(),e.B=!0,Hi.push(e)}for(let s=r;n>s;s++){const e=Gt(i+Math.random()*(o-2*i),i+Math.random()*(a-2*i),K()),n=Nt(t,ca.NEURAL);e.r=n,e.rBase=n,e.m=Math.max(1,n*n*.12),e.vx=0,e.vy=0,e.driftAx=0,e.driftTime=0,e.N=Math.random()*Math.PI*2,e.O=.15+.15*Math.random(),e.B=!0,Hi.push(e)}ge()})()):t===ca.PARALLAX_LINEAR?(e.gravityMultiplier=0,e.G=0,e.repellerEnabled=!1,(()=>{const t=M(),e=t.canvas;if(!e)return;w();const n=e.width,o=e.height,a=b(Math.max(0,Math.min(40,Math.round(t.parallaxLinearGridX??14)))),i=b(Math.max(0,Math.min(40,Math.round(t.parallaxLinearGridY??10)))),r=b(Math.max(0,Math.min(20,Math.round(t.parallaxLinearGridZ??7))));if(0>=a||0>=i||0>=r)return;const s=Math.max(.2,Math.min(8,t.parallaxLinearSpanX??1.35)),c=Math.max(.2,Math.min(8,t.parallaxLinearSpanY??1.35)),l=-.5*n*s,u=-.5*o*c,d=n*s/Math.max(1,a-1),h=o*c/Math.max(1,i-1),f=Math.max(10,t.parallaxLinearZNear??50),m=(Math.max(f+100,t.parallaxLinearZFar??800)-f)/Math.max(1,r-1),p=Math.max(80,t.parallaxLinearFocalLength??420),v=.768*(t.R_MED||20)*(t.DPR||1)*Math.max(.1,Math.min(6,t.parallaxLinearDotSizeMul??1.8)),g=((t,e)=>{const n=_t(+(t.sizeVariationCap??.12),0,wi),o=_t(+(t.sizeVariationGlobalMul??1),0,2),a=_t(+(Wt(t,e)??0),0,1);return _t(n*o*a,0,wi)})(t,ca.PARALLAX_LINEAR),y=.5*n,x=.5*o;for(let M=r-1;M>=0;M--){const e=f+M*m;for(let n=0;i>n;n++)for(let o=0;a>o;o++){const a=l+o*d,i=u+n*h,r=e,s=p/(p+r),c=v*s,f=1,m=Gt(y+a*s,x+i*s,K());m.r=Rt(t,c),m.vx=0,m.vy=0,m.alpha=f,m.V={x:a,y:i,z:r,baseScale:s},m.$=g>1e-6?1+(2*Math.random()-1)*g:1,m.st=!0}}})()):t===ca.STARFIELD_3D?(e.gravityMultiplier=0,e.G=0,e.repellerEnabled=!1,(()=>{const t=M(),e=t.canvas;if(!e)return;w();const n=e.width,o=e.height,a=Math.max(50,Math.min(500,Math.round(t.starfieldCount??200))),i=4*Math.max(.5,Math.min(4,t.starfieldSpanX??1.5)),r=4*Math.max(.5,Math.min(4,t.starfieldSpanY??1.2)),s=Math.max(20,t.starfieldZNear??100),c=Math.max(s+200,t.starfieldZFar??2e3);ji=[];for(let l=0;a>l;l++){const t=Ae(n,o,s,c,i,r);t.fadeTimer=0,ji.push(t)}qi=performance.now()})()):t===ca.ELASTIC_CENTER?(e.gravityMultiplier=0,e.G=0,e.repellerEnabled=!1,(()=>{const t=M();w();const e=t.canvas;if(!e)return;Ui=.5*e.width,Yi=.5*e.height;const n=b(t.elasticCenterBallCount??60);n>0&&((t,e)=>{if(!t.canvas)return;const n=.5*(t.R_MIN+t.R_MAX)*(t.elasticCenterSpacingMultiplier||2.8);let o=0,a=0;const i=[];for(e>0&&(i.push({x:0,y:0,layer:0,index:0}),o++),a=1;e>o;){const t=a*n,r=Math.max(6,Math.floor(2*t*Math.PI/n));for(let n=0;r>n&&e>o;n++){const e=n/r*Math.PI*2;i.push({x:Math.cos(e)*t,y:Math.sin(e)*t,layer:a,index:o}),o++}a++}for(let r=0;Math.min(8,i.length)>r;r++){const e=i[r],n=Nt(t,ca.ELASTIC_CENTER),{color:o,distributionIndex:a}=Z(),s=new gi(Ui+e.x,Yi+e.y,n,o);s.distributionIndex=a,s.isElasticCenter=!0,s.Y=e.x,s.X=e.y,s.ct=Math.sqrt(e.x*e.x+e.y*e.y),s.m=t.MASS_BASELINE_KG*(t.elasticCenterMassMultiplier||2),s.vx=0,s.vy=0,s.omega=0,t.balls.push(s)}for(let r=8;i.length>r;r++){const e=i[r],n=Nt(t,ca.ELASTIC_CENTER),{color:o,distributionIndex:a}=Z(),s=new gi(Ui+e.x,Yi+e.y,n,o);s.distributionIndex=a,s.isElasticCenter=!0,s.Y=e.x,s.X=e.y,s.ct=Math.sqrt(e.x*e.x+e.y*e.y),s.m=t.MASS_BASELINE_KG*(t.elasticCenterMassMultiplier||2),s.vx=0,s.vy=0,s.omega=0,t.balls.push(s)}})(t,n)})()):t===ca.DVD_LOGO?(e.gravityMultiplier=0,e.G=0,e.repellerEnabled=!1,(()=>{const t=M();w();const e=t.canvas;if(!e)return;const n=e.width,o=e.height,a=t.DPR||1,i=t.dvdLogoBallCount||60,r=t.dvdLogoSize||1,s=(t.dvdLogoSpeed||200)*a,c=t.dvdLogoBallSpacing||1.3,l=t.dvdLogoLetterSpacing||1,u=Nt(t,ca.DVD_LOGO)*r,d=((t,e,n,o)=>{const a=[],i=(()=>{const t=[];for(let e=0;5>e;e++)t.push({x:-1,y:-2+e});return t.push({x:0,y:-2}),t.push({x:.8,y:-2}),t.push({x:1.3,y:-1.5}),t.push({x:1.3,y:-1}),t.push({x:.8,y:0}),t.push({x:0,y:0}),t.push({x:1.3,y:.5}),t.push({x:1.3,y:1}),t.push({x:.8,y:2}),t.push({x:0,y:2}),t})(),r=(()=>{const t=[];for(let e=0;5>e;e++)t.push({x:-1,y:-2+e});return t.push({x:0,y:-2}),t.push({x:.8,y:-2}),t.push({x:1.5,y:-2}),t.push({x:0,y:0}),t.push({x:.8,y:0}),t.push({x:0,y:2}),t.push({x:.8,y:2}),t.push({x:1.5,y:2}),t})(),s=(()=>{const t=[];return t.push({x:0,y:-2}),t.push({x:1,y:-2}),t.push({x:-.8,y:-1.5}),t.push({x:-1.2,y:-.8}),t.push({x:-1.2,y:0}),t.push({x:-1.2,y:.8}),t.push({x:-.8,y:1.5}),t.push({x:0,y:2}),t.push({x:1,y:2}),t})(),c=(()=>{const t=[];for(let e=0;5>e;e++)t.push({x:-1,y:-2+e});return t.push({x:0,y:0}),t.push({x:.6,y:-1}),t.push({x:1.2,y:-2}),t.push({x:.3,y:.5}),t.push({x:.8,y:1.2}),t.push({x:1.3,y:2}),t})(),l=2*e*n,u=3*l*o,d=Math.floor(t/4),h=t%4;return[{shape:i,offset:-1.5*u,count:d+(h>0?1:0)},{shape:r,offset:-.5*u,count:d+(h>1?1:0)},{shape:s,offset:.5*u,count:d+(h>2?1:0)},{shape:c,offset:1.5*u,count:d}].forEach(t=>{const e=t.shape,n=e.length;for(let o=0;t.count>o;o++){const i=e[Math.floor(o/t.count*n)%n];a.push({x:i.x*l+t.offset,y:i.y*l})}}),a})(i,u,c,l),h=Math.max(0,(t.wallThickness??0)*a)+Math.max(0,(t.wallInset??3)*a)+10*u;Xi=h+Math.random()*(n-2*h),Zi=h+Math.random()*(o-2*h);const f=Math.floor(4*Math.random())*(Math.PI/2)+.5235987755982988+.5235987755982989*Math.random();Ki=Math.cos(f)*s,Qi=Math.sin(f)*s,Ji=0;const m=["#ff4013","#0d5cb6","#ffa000","#00695c","#ffffff","#b5b7b6","#000000"][Ji];d.forEach(e=>{const n=new gi(Xi+e.x,Zi+e.y,u,m);n.isDvdLogo=!0,n.Z=e.x,n.K=e.y,n.m=t.MASS_BASELINE_KG,n.vx=Ki,n.vy=Qi,n.omega=0,n.lt=!0,n.squashAmount=0,n.ut=!0,t.balls.push(n)})})()):t===ca.SNAKE?(e.gravityMultiplier=0,e.G=0,e.repellerEnabled=!1,(()=>{const t=M();w();const e=t.canvas;if(!e)return;const n=e.width,o=e.height,a=b(t.snakeBallCount??50);if(0>=a)return;const i=.5*(t.R_MIN+t.R_MAX),r=2*i+.3*((t.snakeRestLength??25)*(t.DPR||1)-2*i),s=2*r,c=.5*n,l=.5*o,u=r*a*.12,d=1.8+.7*Math.random(),h=Math.random()*Math.PI*2;ar=[];const f=performance.now(),m=[];for(let p=0;a>p;p++){const e=p/Math.max(1,a-1),i=h+e*Math.PI*2*d,M=u*(.3+.7*e),b=Math.sin(e*Math.PI*4)*r*.3,v=c+Math.cos(i)*(M+b),g=l+Math.sin(i)*(M+b),w=Math.max(s,Math.min(n-s,v)),y=Math.max(s,Math.min(o-s,g));ar.push({x:w,y,time:f});const x=Nt(t,ca.SNAKE),{color:S,distributionIndex:k}=Z(),C=new gi(w,y,x,S);if(C.distributionIndex=k,C.isSnake=!0,C.vx=0,C.vy=0,C.omega=0,0===p&&(C.J=!0),nr.set(C,p),p>0){const t=m[p-1];er.set(C,t),tr.set(t,C),or.set(t,r)}else er.set(C,null);p===a-1&&tr.set(C,null),m.push(C),t.balls.push(C)}t.dt=m[0]})()):t===ca.PARTICLE_FOUNTAIN&&(e.gravityMultiplier=e.particleFountainGravityMultiplier||1,e.G=e.GE*e.gravityMultiplier,e.repellerEnabled=!0,(()=>{const t=M(),e=t.canvas;if(t.balls.length=0,!e)return void(ir=-.1);const n=b(t.particleFountainMaxParticles||100),o=Math.min(5,n);for(let a=0;o>a;a++)Ne();ir=0})()),console.log(`Mode ${t} initialized with ${e.balls.length} balls`),"undefined"!=typeof window&&window.legendFilter&&window.legendFilter.syncAllBalls)try{window.legendFilter.syncAllBalls()}catch(a){console.warn("Legend filter sync failed:",a)}const o=Math.max(0,Math.round(((t,e)=>{switch(t){case ca.PIT:return e.pitWarmupFrames??10;case ca.FLIES:return e.fliesWarmupFrames??10;case ca.WEIGHTLESS:return e.weightlessWarmupFrames??10;case ca.WATER:return e.waterWarmupFrames??10;case ca.VORTEX:return e.vortexWarmupFrames??10;case ca.PING_PONG:return e.pingPongWarmupFrames??10;case ca.MAGNETIC:return e.magneticWarmupFrames??10;case ca.BUBBLES:return e.bubblesWarmupFrames??10;case ca.KALEIDOSCOPE:return e.kaleidoscope3WarmupFrames??e.kaleidoscopeWarmupFrames??10;case ca.CRITTERS:return e.crittersWarmupFrames??10;case ca.NEURAL:return e.neuralWarmupFrames??10;case ca.SPHERE_3D:return e.sphere3dWarmupFrames??10;case ca.CUBE_3D:return e.cube3dWarmupFrames??10;case ca.PARALLAX_LINEAR:return e.parallaxLinearWarmupFrames??10;case ca.STARFIELD_3D:return e.starfield3dWarmupFrames??10;case ca.ELASTIC_CENTER:return e.elasticCenterWarmupFrames??10;case ca.DVD_LOGO:return e.dvdLogoWarmupFrames??10;case ca.SNAKE:return e.snakeWarmupFrames??10;case ca.PARTICLE_FOUNTAIN:return e.particleFountainWarmupFrames??0;default:return 10}})(t,e)||0));if(e.warmupFramesRemaining=o,"undefined"!=typeof window&&t!==n)try{window.dispatchEvent(new CustomEvent("bb:modeChanged",{detail:{prevMode:n,mode:t}}))}catch(a){}}function He(){const t=M();try{Y?.()}catch(e){}$e(t.currentMode)}function je(){const t=M();return t.currentMode===ca.FLIES?$t:t.currentMode===ca.PIT?Ht:t.currentMode===ca.WEIGHTLESS?jt:t.currentMode===ca.WATER?zt:t.currentMode===ca.VORTEX?Qt:t.currentMode===ca.PING_PONG?Jt:t.currentMode===ca.MAGNETIC?te:t.currentMode===ca.BUBBLES?ae:t.currentMode===ca.KALEIDOSCOPE?me:t.currentMode===ca.SPHERE_3D?Se:t.currentMode===ca.CUBE_3D?Te:t.currentMode===ca.CRITTERS?be:t.currentMode===ca.NEURAL?ve:t.currentMode===ca.PARALLAX_LINEAR?xe:t.currentMode===ca.STARFIELD_3D?Fe:t.currentMode===ca.ELASTIC_CENTER?Ie:t.currentMode===ca.DVD_LOGO?_e:t.currentMode===ca.SNAKE?We:t.currentMode===ca.PARTICLE_FOUNTAIN?Be:null}function qe(){const t=M();return t.currentMode===ca.WATER?Ot:t.currentMode===ca.MAGNETIC?ee:t.currentMode===ca.BUBBLES?ie:t.currentMode===ca.STARFIELD_3D?Pe:t.currentMode===ca.ELASTIC_CENTER?De:t.currentMode===ca.DVD_LOGO?Ee:t.currentMode===ca.NEURAL?we:t.currentMode===ca.SNAKE?Re:t.currentMode===ca.PARTICLE_FOUNTAIN?Ve:null}function Ue(){const t=M();return t.currentMode===ca.NEURAL?{preRender:ye}:t.currentMode===ca.STARFIELD_3D?{preRender:Le}:null}function Ye(){if(!vr)return null;if(gr&&gr.isConnected)return gr;let t=document.getElementById("modal-modal-host");return t||(t=document.createElement("div"),t.id="modal-modal-host",t.className="modal-modal-host",vr.appendChild(t)),gr=t,gr}function Xe(t){if(!vr||!t)return;const e=Ye();e&&(xr.has(t)||xr.set(t,{parent:t.parentNode,nextSibling:t.nextSibling}),e.appendChild(t))}function Ze(t){if(!t)return;const e=xr.get(t);if(e&&e.parent)try{e.nextSibling&&e.nextSibling.parentNode===e.parent?e.parent.insertBefore(t,e.nextSibling):e.parent.appendChild(t)}catch(n){}}function Ke(){const e=t("--wall-thickness","");if(e&&!/calc\(|vw|vh|vmin|vmax|%/i.test(e)){const t=parseFloat(e);if(Number.isFinite(t)&&t>0)return t}const n=M();return n?.wallThickness||12}function Qe(){if(br&&!Sr){const t=Ke();br.style.setProperty("--modal-overlay-blur",t/4+"px")}}function Je(t){if(br=document.getElementById("modal-blur-layer"),vr=document.getElementById("modal-content-layer"),!br||!vr)return void console.warn("Modal Overlay: #modal-blur-layer or #modal-content-layer not found");if(wr=!1!==t.modalOverlayEnabled,!wr)return console.log("Modal Overlay: Disabled by config"),br.style.display="none",void(vr.style.display="none");br.style.display="",vr.style.display="",Ye();const a=t.modalOverlayOpacity??e("--modal-overlay-opacity",.01),i=t.modalOverlayTransitionMs??o("--modal-overlay-transition-duration",800),r=t.modalOverlayTransitionOutMs??o("--modal-overlay-transition-out-duration",600),s=t.modalOverlayContentDelayMs??o("--modal-content-delay",200),c=t.modalDepthScale??e("--modal-depth-scale",.96),l=t.modalDepthTranslateY??n("--modal-depth-translate-y",8),u=t.logoBlurInactive??n("--logo-blur-inactive",0),d=t.logoBlurActive??n("--logo-blur-active-target",12),h=document.documentElement;if(h.style.setProperty("--modal-depth-scale",c),h.style.setProperty("--modal-depth-translate-y",l+"px"),h.style.setProperty("--modal-depth-duration",i+"ms"),h.style.setProperty("--modal-depth-out-duration",r+"ms"),h.style.setProperty("--modal-content-delay",s+"ms"),h.style.setProperty("--logo-blur-inactive",u+"px"),h.style.setProperty("--logo-blur-active-target",d+"px"),h.style.setProperty("--logo-blur-active",u+"px"),void 0!==t.modalOverlayBlurPx?(Sr=!0,br.style.setProperty("--modal-overlay-blur",t.modalOverlayBlurPx+"px")):(Sr=!1,Qe()),yr)return;yr=!0,h.style.setProperty("--modal-overlay-opacity",a),h.style.setProperty("--modal-overlay-transition-duration",i+"ms"),h.style.setProperty("--modal-overlay-transition-out-duration",r+"ms"),br.classList.remove("active"),vr.classList.remove("active"),br.setAttribute("aria-hidden","true"),vr.setAttribute("aria-hidden","true"),en(!1),vr.addEventListener("click",tn,{capture:!0}),window.addEventListener("resize",()=>Qe()),document.addEventListener("layout-updated",()=>Qe());const f=Ke()/2;console.log(`Modal Overlay: Initialized (two-layer architecture, blur: ${f}px, transition: ${i}ms)`)}function tn(t){if(!wr||!vr.classList.contains("active"))return;if(t.target.closest("button"))return;if(t.target.closest("input"))return;if(t.target.closest("a"))return;if(t.target.closest("select"))return;if(t.target.closest("textarea"))return;const e="cv-modal"===t.target.id||"portfolio-modal"===t.target.id||"contact-modal"===t.target.id||t.target.classList.contains("modal-label")||t.target.classList.contains("modal-description");(t.target===vr||"modal-modal-host"===t.target?.id||e)&&document.dispatchEvent(new CustomEvent("modal-overlay-dismiss",{detail:{instant:!1}}))}function en(t){const e=document.documentElement,n=document.getElementById("abs-scene");if(t){const t=getComputedStyle(e).getPropertyValue("--modal-depth-scale").trim()||"0.96",o=getComputedStyle(e).getPropertyValue("--modal-depth-translate-y").trim()||"8px",a=getComputedStyle(e).getPropertyValue("--logo-blur-active-target").trim()||e.style.getPropertyValue("--logo-blur-active-target")||"12px";e.style.setProperty("--modal-depth-scale-active",t),e.style.setProperty("--modal-depth-ty-active",o),e.style.setProperty("--logo-blur-active",a),n&&n.classList.add("gate-depth-active")}else{const t=getComputedStyle(e).getPropertyValue("--logo-blur-inactive").trim()||"0px";e.style.setProperty("--modal-depth-scale-active","1"),e.style.setProperty("--modal-depth-ty-active","0px"),e.style.setProperty("--logo-blur-active",t),n&&n.classList.remove("gate-depth-active")}}function nn(){if(!br||!vr||!wr)return;Qe(),document.documentElement.classList.add("modal-active"),br.setAttribute("aria-hidden","false"),vr.setAttribute("aria-hidden","false"),br.classList.add("active"),vr.classList.add("active");const t=document.getElementById("custom-cursor");if(t){let n=!1;try{n=!(!window.matchMedia||!window.matchMedia("(max-width: 600px)").matches)}catch(e){}n?(t.classList.remove("modal-active"),t.style.display="none"):(t.classList.add("modal-active"),t.style.display="block")}en(!0)}function on(){if(!br||!vr||!wr)return;br.classList.remove("active"),vr.classList.remove("active"),document.documentElement.classList.remove("modal-active"),br.setAttribute("aria-hidden","true"),vr.setAttribute("aria-hidden","true");const t=document.getElementById("custom-cursor");t&&t.classList.remove("modal-active"),en(!1)}function an(){return!!vr&&vr.classList.contains("active")}function rn(){try{return!!window.matchMedia?.("(prefers-reduced-motion: reduce)")?.matches}catch(t){return!1}}function sn(t,e,n){return e>t?e:t>n?n:t}function cn(t,e=.15){try{const n=parseInt(t.slice(1,3),16),o=parseInt(t.slice(3,5),16),a=parseInt(t.slice(5,7),16),i=Math.round(sn(n+(Math.random()-.5)*e*255,0,255)),r=Math.round(sn(o+(Math.random()-.5)*e*255,0,255)),s=Math.round(sn(a+(Math.random()-.5)*e*255,0,255));return`#${i.toString(16).padStart(2,"0")}${r.toString(16).padStart(2,"0")}${s.toString(16).padStart(2,"0")}`}catch(n){return t}}function ln(t){const e=+t?.sceneImpactMul,n=Number.isFinite(e)?e:0,o=+t?.sceneImpactMobileMulFactor,a=Number.isFinite(o)&&o>0?o:1;return n*((t=>{if(t?.isMobile||t?.isMobileViewport)return!0;try{return!(!window.matchMedia||!window.matchMedia("(max-width: 600px)").matches)}catch(e){return!1}})(t)?a:1)}function un(){if(!Vr)return;let t=null;try{t=M()}catch(o){}if(!t)return;const e=ln(t);Vr.style.setProperty("--abs-scene-impact-mul",e+"");const n=+t.sceneImpactLogoCompMul;Number.isFinite(n)&&n>0&&Vr.style.setProperty("--abs-scene-impact-logo-comp-mul",n+"")}function dn(){Hr&&(window.clearTimeout(Hr),Hr=0),jr&&(window.clearTimeout(jr),jr=0)}function hn(){if("undefined"!=typeof window&&"undefined"!=typeof document&&(Vr=document.querySelector("#abs-scene")||null,Vr&&(Vr.style.setProperty(zr,"0"),Vr.style.setProperty(Or,"100ms"),Vr.style.setProperty(Br,"1"),un(),!(()=>{try{return!(!window.matchMedia||!window.matchMedia("(prefers-reduced-motion: reduce)").matches)}catch(t){return!1}})()))){Gr=!0,Vr.classList.add("abs-scene--impact");try{window.addEventListener("resize",un,{passive:!0})}catch(t){}window.addEventListener("bb:modeChanged",t=>{const e=M();if(!1===e?.sceneImpactEnabled)return;if(qr)return void(qr=!1);const n=t?.detail||{};((t=1,e={})=>{if(!Gr||!Vr)return;const n=M();if(!1===n?.sceneImpactEnabled)return;const o=Math.max(0,Math.min(1,+t||0)),a=++$r;dn(),Vr.classList.add("abs-scene--animating"),e?.armManual&&(qr=!0);const i=n?.sceneImpactPressMs??75,r=n?.sceneImpactReleaseMs??220,s=Math.max(1,Math.round(.8*(+i||0))),c=Math.max(1,Math.round(1.2*(+r||0))),l=Math.round(Math.min(80,Math.max(0,.4*(+s||0))));Vr.style.setProperty(Or,Math.round(s)+"ms"),window.requestAnimationFrame(()=>{Gr&&Vr&&a===$r&&(Vr.style.setProperty(zr,o+""),Vr.style.setProperty(Br,((t,e)=>{const n=ln(e),o=Math.max(0,+t||0)*n,a=1/Math.max(.001,1-o),i=+e?.sceneImpactLogoCompMul;return Math.max(.5,Math.min(4,a*(1+((Number.isFinite(i)&&i>0?i:1)-1)*o)))})(o,n)+""))}),Hr=window.setTimeout(()=>{(({token:t,releaseMs:e})=>{dn(),Gr&&Vr&&t===$r&&(Vr.style.setProperty(Or,Math.round(e)+"ms"),window.requestAnimationFrame(()=>{Gr&&Vr&&t===$r&&(Vr.style.setProperty(zr,"0"),Vr.style.setProperty(Br,"1"))}),jr=window.setTimeout(()=>{jr=0,Vr&&Vr.classList.remove("abs-scene--animating")},Math.max(0,Math.round(e)+80)))})({token:a,releaseMs:c})},Math.max(0,Math.round(s)+l)),jr=window.setTimeout(()=>{jr=0,Vr&&Vr.classList.remove("abs-scene--animating")},Math.max(0,Math.round(s)+l+Math.round(c)+80))})(n.prevMode&&n.mode&&n.prevMode!==n.mode?1:.75,{armManual:!1})},{passive:!0})}}function fn(){function t(t){return!(!t||!t.closest||!(t.closest("#panelDock")||t.closest("#masterPanel")||t.closest("#dockToggle")||t.closest(".panel-dock")||t.closest(".panel")||t.closest("#expertise-legend")||t.closest(".legend__item")))}function e(t,e){const n=a.getBoundingClientRect();return{x:a.width/(n.width||1)*(t-n.left),y:a.height/(n.height||1)*(e-n.top),inBounds:!(n.left>t||t>n.right||n.top>e||e>n.bottom)}}function n(n,a,i,{isMouseLike:r}={isMouseLike:!0}){const s=e(n,a),c=performance.now(),l=c-Xr;if(l>0&&Xr>0){const t=s.x-Ur,e=s.y-Yr,n=Math.sqrt(t*t+e*e);Zr=n/l,n>.1&&(Kr=t/n,Qr=e/n)}if(r?bn(n,a):vn(),t(i))return;if(an())return;o.mouseX=s.x,o.mouseY=s.y,o.mouseInCanvas=s.inBounds,"undefined"!=typeof window&&(window.mouseInCanvas=s.inBounds);const u=Math.hypot(s.x-(o.lastPointerMoveX??s.x),s.y-(o.lastPointerMoveY??s.y));u>.5&&(o.lastPointerMoveMs=c,o.lastPointerMoveX=s.x,o.lastPointerMoveY=s.y),r&&u>.5&&((t,e,n,o)=>{if(wn())return;const a=M();if(!a?.mouseTrailEnabled)return;if(!o)return;if(yn())return;if((t=>{const e=Math.max(0,0|t);e>0&&(ms===e&&ps&&Ms&&bs||(ms=e,ps=new Float32Array(ms),Ms=new Float32Array(ms),bs=new Float64Array(ms),vs=0,gs=0))})(xn(0|(a.mouseTrailLength??18),4,96)),!ms)return;const i=a.DPR||1,r=xn(+(a.mouseTrailSize??1.3),.5,10)*i,s=Math.max(.35,.55*r),c=s*s;if(gs>0){const o=(vs-1+ms)%ms;if(((t,e,n,o)=>{const a=t-n,i=e-o;return a*a+i*i})(t,e,ps[o],Ms[o])<c)return void(bs[o]=n)}ps[vs]=t,Ms[vs]=e,bs[vs]=n,vs=(vs+1)%ms,ms>gs&&gs++})(s.x,s.y,c,s.inBounds),o.currentMode===ca.WATER&&s.inBounds&&Zr>.3&&c-ts>80&&(Bt(s.x,s.y,Math.min(2*Zr,3)),ts=c),Ur=s.x,Yr=s.y,Xr=c}const o=M(),a=o.canvas;void 0===o.clickCycleEnabled&&(o.clickCycleEnabled=!1),a?(document.addEventListener("mousemove",t=>{window.PointerEvent||n(t.clientX,t.clientY,t.target,{isMouseLike:!0})},{passive:!0}),document.addEventListener("pointermove",t=>{n(t.clientX,t.clientY,t.target,{isMouseLike:"mouse"===t.pointerType||"pen"===t.pointerType})},{passive:!0}),document.addEventListener("click",n=>{if(!o.clickCycleEnabled)return;if(t(n.target))return;if((t=>!(!t||!t.closest||!(t.closest("a")||t.closest("button")||t.closest("input")||t.closest("select")||t.closest("textarea")||t.closest('[role="button"]')||t.closest(".legend__item--interactive"))))(n.target))return;if(an())return;if(!e(n.clientX,n.clientY).inBounds)return;const a=performance.now();150>a-Jr||(Jr=a,0===(void 0!==n.button?n.button:3===n.which?2:2===n.which?1:0)&&(()=>{const t=M(),e=la,n=e.indexOf(t.currentMode),o=e[((0>n?0:n)+1)%e.length];Promise.resolve().then(()=>Mr).then(({setMode:t})=>{t(o)}),import("./controls.js").then(t=>t.h).then(({updateModeButtonsUI:t})=>{t(o)})})())},{passive:!0}),document.addEventListener("touchmove",t=>{if(!an()&&t.touches&&t.touches[0]){const n=e(t.touches[0].clientX,t.touches[0].clientY);o.mouseX=n.x,o.mouseY=n.y,o.mouseInCanvas=n.inBounds;const a=performance.now();Math.hypot(n.x-(o.lastPointerMoveX??n.x),n.y-(o.lastPointerMoveY??n.y))>.5&&(o.lastPointerMoveMs=a,o.lastPointerMoveX=n.x,o.lastPointerMoveY=n.y),o.currentMode===ca.WATER&&n.inBounds&&a-ts>80&&(Bt(n.x,n.y,2),ts=a)}},{passive:!0}),document.addEventListener("touchstart",e=>{window.PointerEvent||t(e.target)||an()||vn()},{passive:!0}),document.addEventListener("mouseleave",()=>{o.mouseX=da.OFFSCREEN_MOUSE,o.mouseY=da.OFFSCREEN_MOUSE,o.mouseInCanvas=!1,Zr=0,Kr=0,Qr=0,"undefined"!=typeof window&&(window.mouseInCanvas=!1),vn()}),document.addEventListener("mouseenter",()=>{gn()}),document.addEventListener("touchend",()=>{o.mouseX=da.OFFSCREEN_MOUSE,o.mouseY=da.OFFSCREEN_MOUSE,o.mouseInCanvas=!1},{passive:!0}),console.log(" Unified pointer system configured (document-level)"),o.ht=!0,"undefined"!=typeof window&&(window.ht=!0)):console.error("Canvas not available for pointer setup")}function mn(){const t=M();return t?.cursorColorHex&&"string"==typeof t.cursorColorHex?t.cursorColorHex:"#000000"}function pn(){if(ns)return;es=document.createElement("div"),es.id="custom-cursor",es.setAttribute("aria-hidden","true");const t=document.getElementById("bravia-balls");t?t.appendChild(es):document.body.appendChild(es),es.style.display="none",es.style.opacity="0",ns=!0,Mn(),(()=>{if(ss||!es)return;ss=!0;const t=M(),e=(t.entranceWallTransitionDelay??300)+.3*(t.entranceWallTransitionDuration??800)+(t.entranceElementDuration??500)+600,n="cubic-bezier(0.16, 1, 0.3, 1)";window.matchMedia?.("(prefers-reduced-motion: reduce)")?.matches?setTimeout(()=>{es&&(es.style.opacity="1")},e):setTimeout(()=>{es&&requestAnimationFrame(()=>{requestAnimationFrame(()=>{if(es){if("function"!=typeof es.animate)return es.style.opacity="1",void(es.style.transition="opacity 800ms "+n);os&&(es.style.display="block"),cs=es.animate([{opacity:0},{opacity:1}],{duration:800,easing:n,fill:"forwards"}),cs?.addEventListener?.("finish",()=>{es&&(es.style.opacity="1")}),cs?.addEventListener?.("cancel",()=>{es&&(es.style.opacity="1")})}})})},e)})()}function Mn(){if(!es)return;const t=M(),e=.5*(t.R_MIN+t.R_MAX)*t.cursorSize*2;es.style.width=e+"px",es.style.height=e+"px",es.style.borderRadius="50%",es.style.marginLeft="0",es.style.marginTop="0",os||(es.style.transform=us)}function bn(t,e){if(!es)return;const n=(()=>{try{return!!document?.body?.classList?.contains?.("abs-link-hovering")}catch(t){return!1}})();if(n&&!ls){const n=((t,e)=>{const n=M(),o=n?.canvas;if(!o)return null;const a=o.getBoundingClientRect();return{x:o.width/(a.width||1)*(t-a.left),y:o.height/(a.height||1)*(e-a.top),inBounds:!(a.left>t||t>a.right||a.top>e||e>a.bottom)}})(t,e);if(n){const t=M(),e=t?.canvas;let o=n.x,a=n.y;if(!n.inBounds&&e&&(o=Math.max(0,Math.min(e.width,o)),a=Math.max(0,Math.min(e.height,a))),e&&o>=0&&a>=0&&e.width>=o&&e.height>=a){const t=mn(),e=Zr||0,n={x:Kr||0,y:Qr||0};((t,e,n,o=0)=>{const a=M();if(!a?.cursorExplosionEnabled)return;if(rn())return;if(!a.canvas||!a.ctx)return;const i=a.DPR||1,r=(a.cursorExplosionSpeed??400)*i,s=Math.floor(a.cursorExplosionParticleCount??16),c=a.cursorExplosionSpreadDeg??360,l=a.cursorExplosionLifetime??.8,u=a.cursorExplosionImpactMinFactor??.5,d=sn(u+o/(a.cursorExplosionImpactSensitivity??400),u,a.cursorExplosionImpactMaxFactor??4),h=Math.floor(s*d),f=r*d,m=Math.min(c*(.6+.4*d),360),p=a.cursorExplosionLifetimeImpactMin??.7,b=l*sn(p+o/(a.cursorExplosionLifetimeImpactSensitivity??600),p,a.cursorExplosionLifetimeImpactMax??1.8);let v=Math.random()*Math.PI*2;if(0!==Rr||0!==Nr){const t=Math.atan2(Nr,Rr),e=sn(o/500,.3,.8);v=t+(Math.random()-.5)*(1-e)*Math.PI*2}const g=m*Math.PI/180,w=Math.min(h,Cr-Tr);for(let M=0;w>M;M++){const o=Tr+M;if(o>=Cr)break;const r=v+(Math.random()-.5)*g,s=f*(.8+.4*Math.random()),c=(a.cursorSize??1.15)*(a.R_MIN??5)*.3*i,l=Math.random()*Math.PI*2;Ar[o]=t+Math.cos(l)*c*Math.random(),Lr[o]=e+Math.sin(l)*c*Math.random(),Fr[o]=Math.cos(r)*s,Pr[o]=Math.sin(r)*s,Dr[o]=b*(.9+.2*Math.random()),Ir[o]=0,_r[o]=1;const u=sn(3*(a.cursorSize??1.15)*i,2*i,6*i);Er[o]=u*(.8+.4*Math.random()),Wr[o]=.7>Math.random()?n:cn(n,.12)}Tr+=w})(o,a,t,e),!n||0===n.x&&0===n.y||((t,e,n)=>{if(t>0){const t=Math.sqrt(e*e+n*n);t>.01&&(Rr=e/t,Nr=n/t)}})(e,n.x,n.y)}}}if(ls=n,n)return void(es.style.display="none");const o=os;os=((t,e)=>{const n=document.getElementById("bravia-balls");if(!n)return!1;const o=performance.now();return as&&rs>=o-is||(as=n.getBoundingClientRect(),is=o),!(as.left>t||t>as.right||as.top>e||e>as.bottom)})(t,e);const a=an(),i=document.getElementById("bravia-balls");if(a)i&&i.contains(es)&&(document.body.appendChild(es),es.style.position="fixed",es.style.zIndex="20000"),es.style.left=t+"px",es.style.top=e+"px";else if(i&&!i.contains(es)&&(i.appendChild(es),es.style.position="absolute",es.style.zIndex="3"),i){const n=i.getBoundingClientRect();es.style.left=t-n.left+"px",es.style.top=e-n.top+"px"}else es.style.left=t+"px",es.style.top=e+"px";if(document.body.style.cursor="none",a)return es.style.display="block",void(es.style.transform=hs);os?(es.style.display="block",o?es.style.transform!==ds&&(es.style.transform=ds):(es.style.transform=us,requestAnimationFrame(()=>{es.style.transform=ds}))):(es.style.display="none",o&&(es.style.transform=us,es.style.backgroundColor="",es.style.filter=""))}function vn(){es&&(es.style.display="none",document.body.style.cursor="none",os=!1)}function gn(){es&&(os=!1)}function wn(){const t=(()=>{try{return!!document?.body?.classList?.contains?.("abs-link-hovering")}catch(t){return!1}})();return t&&!ws&&(vs=0,gs=0),ws=t,t}function yn(){try{return!!window.matchMedia?.("(prefers-reduced-motion: reduce)")?.matches}catch(t){return!1}}function xn(t,e,n){return e>t?e:t>n?n:t}function Sn(){return ys}function kn(t){ys=t}function Cn(t){ys-=t}function Tn(){ys=0}function An(){if(As.arrays.length>As.arrayIndex){const t=As.arrays[As.arrayIndex++];return t.length=0,t}const t=[];return As.arrays.push(t),As.arrayIndex++,t}function Ln(t,e,n,o=!1){const a=[{x:ks,y:ks},{x:e.width-ks,y:ks},{x:ks,y:e.height-ks},{x:e.width-ks,y:e.height-ks}],i=o?2:a.length;for(let r=0;i>r;r++){const e=t.x-a[r].x,o=t.y-a[r].y,i=Math.max(1,Math.hypot(e,o));if(ks+t.r>i){const a=(ks+t.r-i)/(ks+t.r)*Cs,r=o/i;t.vx+=e/i*a*n,t.vy+=r*a*n}}}function Fn(t,e){const n=M(),o=n.balls,a=n.canvas;if(!a)return;if(0===o.length)return;const i=n.isMobile||n.isMobileViewport?Ss:xs;if(n.currentMode===ca.KALEIDOSCOPE){const i=Math.min(.033,Math.max(0,t)),r=o.length;for(let t=0;r>t;t++)o[t].step(i,e);Ft({iterations:3,positionalCorrectionPercent:.22,maxCorrectionPx:1.25*(n.DPR||1),enableSound:!1});for(let t=0;r>t;t++)ue(o[t],a.width,a.height,i);return void kn(0)}ys+=t;let r=0;const s=!1!==n.wallDeformationEnabled;for(s&&bi.clearPressureFrame();Sn()>=i&&da.MAX_PHYSICS_STEPS>r;){const t=o.length;for(let n=0;t>n;n++)o[n].step(i,e);const c=Math.max(1,Math.min(20,Math.round(+(n.physicsCollisionIterations??10)||10)));if(n.currentMode===ca.KALEIDOSCOPE?Lt(6):n.currentMode!==ca.FLIES&&n.currentMode!==ca.SPHERE_3D&&n.currentMode!==ca.CUBE_3D&&n.currentMode!==ca.PARALLAX_LINEAR&&n.currentMode!==ca.PARALLAX_FLOAT&&n.currentMode!==ca.STARFIELD_3D&&n.currentMode!==ca.DVD_LOGO&&n.currentMode!==ca.SNAKE?Lt(c):n.currentMode===ca.SNAKE&&Ft({iterations:3,positionalCorrectionPercent:.3,maxCorrectionPx:1*(n.DPR||1),enableSound:!1}),s&&bi.resetStepBudgets(),n.currentMode!==ca.SPHERE_3D&&n.currentMode!==ca.CUBE_3D&&n.currentMode!==ca.PARALLAX_LINEAR&&n.currentMode!==ca.PARALLAX_FLOAT&&n.currentMode!==ca.STARFIELD_3D){const t=n.currentMode===ca.WEIGHTLESS?n.weightlessBounce:n.REST,e=n.currentMode===ca.PIT,r=o.length,c=s?{}:{registerEffects:!1},l=n.isMobile||n.isMobileViewport;for(let n=0;r>n;n++){const r=o[n];r.isDvdLogo||(e||Ln(r,a,i,l),r.walls(a.width,a.height,i,t,c))}}if(n.currentMode===ca.PIT){Lt(3);const t=n.REST,e=o.length;for(let n=0;e>n;n++)o[n].walls(a.width,a.height,i,t,{registerEffects:!1});const r=n.DPR||1,s=(Number.isFinite(n.sleepVelocityThreshold)?n.sleepVelocityThreshold:12)*r,c=Number.isFinite(n.sleepAngularThreshold)?n.sleepAngularThreshold:.18,l=n.timeToSleep??.25;for(let n=0;e>n;n++){const t=o[n];if(!t||t.isSleeping)continue;const e=Math.sqrt(t.vx*t.vx+t.vy*t.vy),a=Math.abs(t.omega);(t.isGrounded||t.hasSupport)&&s>e&&c>a?(t.vx*=.5,t.vy*=.5,t.omega*=.5,2*r>e&&(t.vx=0,t.vy=0),.02>a&&(t.omega=0),t.sleepTimer+=i,l>t.sleepTimer||(t.vx=0,t.vy=0,t.omega=0,t.isSleeping=!0)):t.sleepTimer=0}}if(!1!==n.physicsSkipSleepingSteps){const t=n.currentMode;if(t!==ca.FLIES&&t!==ca.SPHERE_3D&&t!==ca.CUBE_3D&&t!==ca.PARALLAX_LINEAR&&t!==ca.KALEIDOSCOPE&&t!==ca.PIT){const t=n.DPR||1,e=Math.max(0,+(n.physicsSleepThreshold??12)||0)*t,a=Math.max(0,+(n.physicsSleepTime??.25)||0),r=Number.isFinite(n.sleepAngularThreshold)?n.sleepAngularThreshold:.18;if(e>0&&a>0){const t=o.length;for(let n=0;t>n;n++){const t=o[n];t&&!t.isSleeping&&(!0!==t.isMeteor&&e>Math.sqrt(t.vx*t.vx+t.vy*t.vy)&&r>Math.abs(t.omega)?(t.sleepTimer+=i,a>t.sleepTimer||(t.vx=0,t.vy=0,t.omega=0,t.isSleeping=!0)):t.sleepTimer=0)}}}}Cn(i),r++}const c=qe();c&&c(t),s&&bi.step(t),Sn()>i*da.ACCUMULATOR_RESET_THRESHOLD&&kn(0)}async function Pn(t,e){const n=M(),o=n.balls;if(!n.canvas)return;if(!o||0===o.length)return;const a=Math.max(0,Math.round(n.warmupFramesRemaining||0));if(a>0){n.warmupFramesRemaining=0,kn(0);for(let t=0;a>t;t++)Fn(Ts,e)}else Fn(t,e),(t=>{const e=M();if(!e?.cursorExplosionEnabled)return;if(!Tr)return;const n=e.cursorExplosionDrag??.95,o=e.cursorExplosionFadeStartRatio??.6;let a=0;for(let i=0;Tr>i;i++){const r=Ir[i]+t,s=Dr[i];if(r>=s)continue;Ir[i]=r,Fr[i]*=n,Pr[i]*=n,Ar[i]+=Fr[i]*t,Lr[i]+=Pr[i]*t;const c=r/s;let l=1;if(c>=o){const t=(c-o)/(1-o);l=1-t*t*t}_r[i]=Math.max(0,l),!1!==e.cursorExplosionShrinkEnabled&&(Er[i]=Er[i]*(1-.3*c)),i!==a&&(Ar[a]=Ar[i],Lr[a]=Lr[i],Fr[a]=Fr[i],Pr[a]=Pr[i],Ir[a]=Ir[i],Dr[a]=Dr[i],_r[a]=_r[i],Er[a]=Er[i],Wr[a]=Wr[i]),a++}Tr=a})(t)}function In(){const t=M(),e=t.ctx,n=t.balls,o=t.canvas;if(!e||!o)return;e.clearRect(0,0,o.width,o.height);const a=t.canvasClipPath,i=a&&(t.cornerRadius??t.wallRadius??0)>0;if(i){e.save();try{e.clip(a)}catch(s){}}const r=Ue();if(r&&r.preRender&&r.preRender(e),t.currentMode===ca.KALEIDOSCOPE)(t=>{const e=M();if(!he(e.currentMode))return;const n=e.canvas;if(!n)return;const o=(()=>{const t=performance.now(),e=Gi||t;return Gi=t,re((t-e)/1e3,0,.05)})(),a=e.balls,i=n.width,r=n.height,s=se(e),c=e.isMobile||e.isMobileViewport?e.kaleidoscope3WedgesMobile??6:de(e).wedges??12,l=re(Math.round(c),3,24),u=!!(e.kaleidoscopeMirror??1),d=(t=>.5*t.width)(n),h=(t=>.5*t.height)(n),f=Bi/l,m=Math.max(1e-5,1e-4*f),p=e.mouseInCanvas?e.mouseX:d,b=e.mouseInCanvas?e.mouseY:h,v=p-d,g=b-h,w=Math.atan2(g,v),y=re(Math.hypot(v,g)/Math.max(1,.5*Math.min(i,r)),0,1);e.ft||(e.ft={phase:{x:0,v:0},panX:{x:0,v:0},panY:{x:0,v:0},lastMouseX:p,lastMouseY:b,lastInCanvas:!!e.mouseInCanvas});const x=e.ft,S=!!e.mouseInCanvas,k=Math.hypot(p-x.lastMouseX,b-x.lastMouseY)>.5||S!==x.lastInCanvas,C=re(de(e).speed??1,.2,2),T=fe(e),A=.65*C*T,L=v*A*(e.mouseInCanvas?1:0),F=g*A*(e.mouseInCanvas?1:0),P=.7*w*T*(e.mouseInCanvas?1:0),I=(e.kaleidoscopeIdleSpeed??.08)*T*(e.prefersReducedMotion?0:1);if(k)x.lastMouseX=p,x.lastMouseY=b,x.lastInCanvas=S,le(x.phase,P,o,4.5),le(x.panX,L,o,5),le(x.panY,F,o,5);else{if(I>0){x.phase.x+=I*o;const t=2*Math.PI;x.phase.x>t&&(x.phase.x-=t),-t>x.phase.x&&(x.phase.x+=t)}x.phase.v=0,x.panX.v=0,x.panY.v=0}const D=x.phase.x,_=x.panX.x,E=x.panY.x,W=.22+.18*re((C-.2)/1.8,0,1),R=1-W+2*W*(1-y),N=new Float32Array(l),z=new Float32Array(l);for(let M=0;l>M;M++){const t=M*f;N[M]=Math.cos(t),z[M]=Math.sin(t)}for(let M=0;a.length>M;M++){const e=a[M],n=e.x-d+_,o=e.y-h+E,i=3.5*s,r=Math.hypot(n,o)*i*R;if(Vi>r)continue;const c=u?2*f:f;let p=Math.atan2(o,n)+D;p=(p%c+c)%c,u&&p>f&&(p=c-p),p=re(p,m,f-m);const b=Math.cos(p),v=Math.sin(p);for(let a=0;l>a;a++){const n=N[a],o=z[a],i=d+(n*b-o*v)*r,s=h+(o*b+n*v)*r;1>e.alpha&&(t.globalAlpha=e.alpha),t.fillStyle=e.color,t.beginPath(),t.arc(i,s,e.r,0,Bi),t.fill(),1>e.alpha&&(t.globalAlpha=1)}}})(e);else{As.map.clear(),As.arrayIndex=0;const t=As.map;for(let e=0;n.length>e;e++){const o=n[e],a=o.color;t.has(a)||t.set(a,An()),t.get(a).push(o)}for(const[n,o]of t){e.fillStyle=n;for(let t=0;o.length>t;t++){const n=o[t];n.squashAmount>.01||1>n.alpha*(n.filterOpacity??1)?n.draw(e):(e.beginPath(),e.arc(n.x,n.y,n.getDisplayRadius(),0,2*Math.PI),e.fill())}}}r&&r.postRender&&r.postRender(e),i&&e.restore(),(t=>{if(wn())return;const e=M();if(!e?.mouseTrailEnabled)return;if(yn())return;if(!t||!gs||!ms)return;const n=performance.now(),o=xn(+(e.mouseTrailFadeMs??220),40,2e3),a=xn(+(e.mouseTrailOpacity??.35),0,1);if(0>=a)return;const i=e.DPR||1,r=xn(+(e.mouseTrailSize??1.3),.5,10)*i;for(;gs>0&&n-bs[(vs-gs+ms)%ms]>o;)gs--;if(!gs)return;if(2>gs)return;const s=mn(),c=t.globalAlpha,l=t.globalCompositeOperation,u=t.lineCap,d=t.lineJoin,h=t.strokeStyle,f=t.lineWidth;t.globalCompositeOperation="source-over",t.lineCap="round",t.lineJoin="round",t.strokeStyle=s,t.lineWidth=r,t.globalAlpha=a;const m=gs,p=(vs-m+ms)%ms;if(t.beginPath(),t.moveTo(ps[p],Ms[p]),2===m)t.lineTo(ps[(p+1)%ms],Ms[(p+1)%ms]);else{for(let n=1;m-1>n;n++){const e=(p+n)%ms,o=(p+n+1)%ms,a=ps[e],i=Ms[e];t.quadraticCurveTo(a,i,.5*(a+ps[o]),.5*(i+Ms[o]))}const e=(p+m-1)%ms;t.lineTo(ps[e],Ms[e])}t.stroke(),t.globalAlpha=c,t.globalCompositeOperation=l,t.lineCap=u,t.lineJoin=d,t.strokeStyle=h,t.lineWidth=f})(e),(t=>{const e=M();if(!e?.cursorExplosionEnabled)return;if(rn())return;if(!Tr||!t)return;const n=new Map;for(let i=0;Tr>i;i++){const t=Wr[i];n.has(t)||n.set(t,[]),n.get(t).push(i)}const o=t.globalAlpha,a=t.globalCompositeOperation;t.globalCompositeOperation="source-over";for(const[i,r]of n){t.fillStyle=i;for(const e of r){const n=_r[e];if(0>=n)continue;const o=Math.max(.5,Er[e]);t.globalAlpha=n,t.beginPath(),t.arc(Ar[e],Lr[e],o,0,2*Math.PI),t.fill()}}t.globalAlpha=o,t.globalCompositeOperation=a})(e),((t,e,n)=>{const o=M(),a=o.isDarkMode||!1,i="number"==typeof o.depthWashOpacity?o.depthWashOpacity:.65;if(0>=i)return;const r=((t,e,n,o)=>`${t}|${e}|${o}|${n.depthWashCenterY}|${n.depthWashRadiusScale}|${n.depthWashCenterColorLight}|${n.depthWashEdgeColorLight}|${n.depthWashCenterAlphaLight}|${n.depthWashEdgeAlphaLight}|${n.depthWashCenterColorDark}|${n.depthWashEdgeColorDark}|${n.depthWashCenterAlphaDark}|${n.depthWashEdgeAlphaDark}`)(e,n,o,a);null!==ki&&Ci===r||(ki=((t,e,n,o,a)=>{const i="number"==typeof o.depthWashRadiusScale?o.depthWashRadiusScale:1,r=e/2,s=n*("number"==typeof o.depthWashCenterY?o.depthWashCenterY:.3),c=t.createRadialGradient(r,s,0,r,s,Math.max(e,n)*i),l=a?o.depthWashEdgeColorDark||"#05020f":o.depthWashEdgeColorLight||"#142b48",u=a?"number"==typeof o.depthWashCenterAlphaDark?o.depthWashCenterAlphaDark:0:"number"==typeof o.depthWashCenterAlphaLight?o.depthWashCenterAlphaLight:.3,d=a?"number"==typeof o.depthWashEdgeAlphaDark?o.depthWashEdgeAlphaDark:.8:"number"==typeof o.depthWashEdgeAlphaLight?o.depthWashEdgeAlphaLight:.4,h=Vt(a?o.depthWashCenterColorDark||"#1a1e23":o.depthWashCenterColorLight||"#ffffff"),f=Vt(l);return c.addColorStop(0,`rgba(${h.r}, ${h.g}, ${h.b}, ${u})`),c.addColorStop(1,`rgba(${f.r}, ${f.g}, ${f.b}, ${d})`),c})(t,e,n,o,a),Ci=r),t.save(),t.globalCompositeOperation=a?o.depthWashBlendModeDark||"multiply":o.depthWashBlendModeLight||"color-dodge",t.globalAlpha=i,t.fillStyle=ki,t.fillRect(0,0,e,n),t.restore()})(e,o.width,o.height),It(e,o.width,o.height)}function Dn(){pi=Dt()}function _n(){return null===Ps&&(Ps=(()=>{try{return!1}catch(t){}try{if("8001"==(globalThis?.location?.port??"")+"")return!0}catch(t){}try{if(Array.from(document.scripts||[]).some(t=>{if("module"!==(t.getAttribute("type")||"").toLowerCase())return!1;const e=t.getAttribute("src")||"";return/(^|\/)main\.js(\?|#|$)/.test(e)}))return!0}catch(t){}return!1})()),Ps}function En(t){const e=Math.random();let n=0;for(let o=0;8>o;o++)if(n+=Ws[o],n>=e)return t[o];return t[0]}function Wn({sentence:t="Curious mind detected. Design meets engineering at 60fps.",ascii:e=["        ","                   ","             ","                   ","        "],silence:n=!1}={}){if(!_s){_s=!0;try{Fs.log("%c"+t,"color: #888; font-style: italic;"),Fs.log("");try{const t=((t,e=3)=>{const{colorAssignments:n}=((t,e=3)=>{let n;try{n=(()=>{try{const t=M(),e=t?.currentColors;if(Array.isArray(e)&&e.length>=8)return e.slice(0,8)}catch(t){}return Es})(),Array.isArray(n)&&n.length>=8||(n=Es)}catch(s){n=Es}const o=[];for(let c=0;t.length>c;c++){const n=t[c];for(let t=0;n.length>t;t+=e){const a=n.slice(t,t+e);o.push({row:c,col:t,visible:a.trim().length>0})}}const a=o.map((t,e)=>t.visible?e:-1).filter(t=>t>=0),i=Array(o.length).fill(null),r=(t=>{for(let e=t.length-1;e>0;e--){const n=Math.floor(Math.random()*(e+1));[t[e],t[n]]=[t[n],t[e]]}return t})([...a]);for(let c=0;Math.min(8,r.length)>c;c++){const t=Math.min(c,n.length-1);i[r[c]]=n[t]||Es[t]}for(const c of a)null===i[c]&&(i[c]=En(n));for(let c=0;o.length>c;c++)null===i[c]&&(i[c]="transparent");return{clusters:o,colorAssignments:i}})(t,e),o=[];let a=0;for(const i of t){let t="";const r=[];for(let o=0;i.length>o;o+=e)t+="%c"+i.slice(o,o+e),r.push(`color: ${n[a]}; font-family: monospace; font-weight: bold; font-size: 12px; letter-spacing: 0;`),a++;o.push([t,...r])}return o})(e,3);for(const e of t)Fs.log(...e)}catch(o){for(const t of e)Fs.log(t)}Fs.log("");const n=(new Date).getFullYear();Fs.log("%c "+n+" Alexander Beck Studio. All rights reserved. Unauthorized reproduction prohibited.","color: #555; font-size: 10px;")}catch(a){}if(n)try{console.log=()=>{},console.info=()=>{},console.warn=()=>{},console.debug=()=>{},console.table=()=>{},console.group=()=>{},console.groupCollapsed=()=>{},console.groupEnd=()=>{}}catch(a){}}}function Rn({sentence:t="Curious mind detected. Design meets engineering at 60fps.",ascii:e=["        ","                   ","             ","                   ","        "]}={}){_n()||Wn({sentence:t,ascii:e,silence:!0})}function Nn(t){_n()&&Fs.groupCollapsed(t)}function zn(){_n()&&Fs.groupEnd()}function On(t){if(!_n())return;const e=("undefined"!=typeof performance&&performance.now?performance.now():Date.now())-Ds;Is+=1,Fs.log(`[${(Is+"").padStart(2,"0")}] +${e.toFixed(1)}ms ${t}`)}function Bn(t){if(_n())try{performance.mark(t)}catch(e){}}function Vn(t,e,n){if(!_n())return null;try{performance.measure(t,e,n);const o=performance.getEntriesByName(t),a=o&&o.length?o[o.length-1]:null;return a?a.duration:null}catch(o){return null}}function Gn(t){if(_n())try{Fs.table(t)}catch(e){}}function $n(){const t=navigator.userAgent||"",e=/Android/.test(t),n=/iPhone|iPad|iPod/.test(t)||/Mac/.test(t)&&navigator.maxTouchPoints>1,o=e||n,a=window.matchMedia&&window.matchMedia("(display-mode: standalone)").matches||window.matchMedia&&window.matchMedia("(display-mode: minimal-ui)").matches||!0===navigator.standalone;return o||a}function Hn(){if(Rs&&Ns){const t=document.documentElement;return t.style.setProperty("--frame-color-light",Rs),void t.style.setProperty("--frame-color-dark",Ns)}const e=M(),n=document.documentElement,o=e?.frameColorLight||e?.frameColor||t("--frame-color-light","#0a0a0a"),a=e?.frameColorDark||e?.frameColor||t("--frame-color-dark","#0a0a0a");n.style.setProperty("--frame-color-light",o),n.style.setProperty("--frame-color-dark",a)}function jn(e){(()=>{if(Rs&&Ns)return;const e=M();Rs=e?.frameColorLight||e?.frameColor||t("--frame-color-light","#0a0a0a"),Ns=e?.frameColorDark||e?.frameColor||t("--frame-color-dark","#0a0a0a")})(),(t=>{const e=document.documentElement;e.style.setProperty("--frame-color-light",t),e.style.setProperty("--frame-color-dark",t)})(t(e?"--wall-color-browser-dark":"--wall-color-browser-light",e?"#202124":"#f1f3f4"))}function qn(e){Bs=e;let n=!1;n="auto"===e?"dark"===Vs||(()=>{const t=M();if(!t.autoDarkModeEnabled)return!1;const e=Number.isFinite(t.autoDarkNightStartHour)?t.autoDarkNightStartHour:18,n=Number.isFinite(t.autoDarkNightEndHour)?t.autoDarkNightEndHour:6,o=(new Date).getHours();return e!==n&&(n>e?o>=e&&n>o:o>=e||n>o)})():"dark"===e,(e=>{const n=M();n.isDarkMode=e,document.documentElement.style.colorScheme=e?"dark":"light",e?(n.container?.classList.add("dark-mode"),document.body.classList.add("dark-mode"),document.documentElement.classList.add("dark-mode")):(n.container?.classList.remove("dark-mode"),document.body.classList.remove("dark-mode"),document.documentElement.classList.remove("dark-mode")),(t=>{const e=(M().chromeHarmonyMode||"auto")+"",n=(()=>{const t=navigator.userAgent||"",e=navigator.vendor||"";return{isFirefox:/Firefox\//.test(t),isSafari:/Safari\//.test(t)&&/Apple/.test(e)&&!/Chrome\//.test(t)&&!/Chromium\//.test(t),isChromium:/Chrome\//.test(t)||/Chromium\//.test(t)||/Edg\//.test(t),ua:t}})();if("site"===e)return Hn(),{mode:e,family:n,themeColorLikelyApplied:$n()};if("browser"===e)return jn(t),{mode:e,family:n,themeColorLikelyApplied:$n()};const o=$n();n.isSafari?Hn():n.isChromium&&!o?jn(t):Hn()})(e),(()=>{const e=M(),n=e?.frameColor||e?.frameColorLight||e?.frameColorDark||t("--wall-color","#242529");let o=document.querySelector('meta[name="theme-color"]:not([media])');o||(o=document.createElement("meta"),o.name="theme-color",document.head.appendChild(o)),o.content=n;let a=document.querySelector('meta[name="theme-color"][media="(prefers-color-scheme: light)"]');a||(a=document.createElement("meta"),a.name="theme-color",a.media="(prefers-color-scheme: light)",document.head.appendChild(a)),a.content=n;let i=document.querySelector('meta[name="theme-color"][media="(prefers-color-scheme: dark)"]');i||(i=document.createElement("meta"),i.name="theme-color",i.media="(prefers-color-scheme: dark)",document.head.appendChild(i)),i.content=n;let r=document.querySelector('meta[name="apple-mobile-web-app-status-bar-style"]');r||(r=document.createElement("meta"),r.name="apple-mobile-web-app-status-bar-style",document.head.appendChild(r)),r.content="black-translucent"})(),Dn(),ki=null,Ci="",Q(n.currentTemplate),(()=>{const t=document.getElementById("themeAuto"),e=document.getElementById("themeLight"),n=document.getElementById("themeDark");if(!t||!e||!n)return;[t,e,n].forEach(t=>t.classList.remove("active")),"auto"===Bs?t.classList.add("active"):"light"===Bs?e.classList.add("active"):n.classList.add("active");const o=document.getElementById("themeStatus");if(o){const t=M();o.textContent="auto"===Bs?t.isDarkMode?" Auto (Dark)":" Auto (Light)":"light"===Bs?" Light Mode":" Dark Mode"}})()})(n),(t=>{try{localStorage.setItem(zs,t),localStorage.removeItem(Os)}catch(e){}})(e),On(` Theme set to: ${e} (rendering: ${n?"dark":"light"})`)}function Un(){if(Gs)return;Gs=!0,(()=>{try{localStorage.removeItem(zs),localStorage.removeItem(Os),localStorage.removeItem("abs_palette_chapter"),On(" Cleared color-related localStorage cache")}catch(t){}})(),(()=>{const t=M(),e=document.documentElement;t?.bgLight&&e.style.setProperty("--bg-light",t.bgLight),t?.bgDark&&e.style.setProperty("--bg-dark",t.bgDark);const n=t?.frameColor||t?.frameColorLight||t?.frameColorDark||"#242529";e.style.setProperty("--frame-color",n),e.style.setProperty("--wall-color",n),e.style.setProperty("--chrome-bg",n),e.style.setProperty("--frame-color-light",n),e.style.setProperty("--frame-color-dark",n),e.style.setProperty("--wall-color-light",n),e.style.setProperty("--wall-color-dark",n),e.style.setProperty("--chrome-bg-light",n),e.style.setProperty("--chrome-bg-dark",n);const o=document.querySelector('meta[name="theme-color"]');o&&(o.content=n),t?.textColorLight&&e.style.setProperty("--text-color-light",t.textColorLight),t?.textColorLightMuted&&e.style.setProperty("--text-color-light-muted",t.textColorLightMuted),t?.textColorDark&&e.style.setProperty("--text-color-dark",t.textColorDark),t?.textColorDarkMuted&&e.style.setProperty("--text-color-dark-muted",t.textColorDarkMuted),Number.isFinite(t?.edgeLabelInsetAdjustPx)&&e.style.setProperty("--edge-label-inset-adjust",t.edgeLabelInsetAdjustPx+"px"),t?.linkHoverColor&&e.style.setProperty("--link-hover-color",t.linkHoverColor)})(),Vs=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light",On(" System prefers: "+Vs),qn((()=>{try{const t=localStorage.getItem(zs);if("auto"===t||"light"===t||"dark"===t)return t;const e=localStorage.getItem(Os);"auto"!==e&&"light"!==e&&"dark"!==e||(localStorage.removeItem(Os),localStorage.setItem(zs,"auto"))}catch(t){}return"auto"})());const t=document.getElementById("themeAuto"),e=document.getElementById("themeLight"),n=document.getElementById("themeDark");t&&t.addEventListener("click",()=>qn("auto")),e&&e.addEventListener("click",()=>qn("light")),n&&n.addEventListener("click",()=>qn("dark")),window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",t=>{Vs=t.matches?"dark":"light",On(" System preference changed to: "+Vs),"auto"===Bs&&qn("auto")}),window.setInterval(()=>{"auto"===Bs&&qn("auto")},6e4),On(" Modern dark mode initialized")}function Yn(){qn("light"===Bs?"dark":"light")}function Xn(t){const e={};if(!t||"object"!=typeof t)return e;for(const n of ec)({}).hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}function Zn(t,e,n,o){const a="number"==typeof t?t:+t;return Number.isFinite(a)?Math.min(n,Math.max(e,a)):o}function Kn(t,e,n,o){const a="number"==typeof t?t:+t;return Number.isFinite(a)?Math.min(n,Math.max(e,Math.round(a))):o}function Qn(t,e=0){return Zn(t,0,1,e)}function Jn(t,e,n){return e.includes(t)?t:n}function to(t,e){try{const n=getComputedStyle(document.documentElement).getPropertyValue(t).trim(),o=Number.parseFloat(n);return Number.isFinite(o)?o:e}catch{return e}}function eo(t){let e=t>>>0;return()=>{e+=1831565813;let t=e;return t=Math.imul(t^t>>>15,1|t),t^=t+Math.imul(t^t>>>7,61|t),((t^t>>>14)>>>0)/4294967296}}function no(t){const e=(t()+t()+t())/3;return Math.max(0,Math.min(1,.5+1.15*(e-.5)))}function oo(t){const e=document.documentElement;e.style.setProperty("--abs-noise-enabled",t.noiseEnabled?"1":"0");const n=t.noiseMotion,o="drift"===n?"linear":"steps(1, end)";e.style.setProperty("--abs-noise-keyframes","static"===n?"none":"drift"===n?"abs-noise-drift":"abs-noise-jitter"),e.style.setProperty("--abs-noise-timing",o);const a=Zn(t.noiseSpeedMs??1100,0,1e4,1100),i=Zn(t.noiseSpeedVariance??0,0,1,0),r=eo((2134518556^t.noiseSeed)>>>0),s=i>0?(2*r()-1)*i:0;e.style.setProperty("--abs-noise-speed",Math.max(0,Math.round(a*(1+s)))+"ms"),e.style.setProperty("--abs-noise-speed-variance",i+""),e.style.setProperty("--abs-noise-motion-amount",t.noiseMotionAmount+""),e.style.setProperty("--abs-noise-flicker",t.noiseFlicker+""),e.style.setProperty("--abs-noise-flicker-speed",Math.max(0,Math.round(t.noiseFlickerSpeedMs))+"ms");const c=Zn(t.noiseBlurPx,0,6,0);e.style.setProperty("--abs-noise-blur",c.toFixed(2)+"px"),e.style.setProperty("--abs-noise-filter",c>0?`blur(${c.toFixed(2)}px)`:"none");const l=Zn(t.noiseMotionAmount,0,2.5,1),u="static"!==t.noiseMotion&&l>0,d=Zn(t.noiseSize??85,20,600,85),h=Zn(.55*d,24,120,82),f=u?h*l:0;e.style.setProperty("--abs-noise-overscan",`-${Math.ceil(f+(c>0?6*c:0)+32)}px`);const m=eo((2772082231^t.noiseSeed)>>>0);for(let g=1;40>=g;g++){const t=.9*(2*m()-1)*f,n=.9*(2*m()-1)*f;e.style.setProperty(`--abs-noise-j${g}-x`,Math.round(t)+"px"),e.style.setProperty(`--abs-noise-j${g}-y`,Math.round(n)+"px")}const p=m()*Math.PI*2;e.style.setProperty("--abs-noise-drift-x",Math.round(Math.cos(p)*f)+"px"),e.style.setProperty("--abs-noise-drift-y",Math.round(Math.sin(p)*f)+"px"),e.style.setProperty("--noise-size",Math.round(d)+"px");const M=Zn(t.noiseOpacityLight??t.noiseOpacity??.08,0,1,.08),b=Zn(t.noiseOpacityDark??t.noiseOpacity??.12,0,1,.12);e.style.setProperty("--noise-opacity-light",M+""),e.style.setProperty("--noise-opacity-dark",b+""),e.style.setProperty("--noise-blend-mode",t.noiseBlendMode??"normal");const v=t.noiseColorDark??"#ffffff";e.style.setProperty("--noise-color-light",t.noiseColorLight??"#ffffff"),e.style.setProperty("--noise-color-dark",v),e.style.setProperty("--detail-noise-opacity",(t.detailNoiseOpacity??1)+"")}function ao(t={}){const e=to("--noise-size",85),n=to("--noise-opacity-light",.08),o=to("--noise-opacity-dark",.12),a={noiseSeed:Kn(t.noiseSeed,0,999999,1337),noiseTextureSize:Kn(t.noiseTextureSize,64,512,256),noiseDistribution:Jn(t.noiseDistribution,["uniform","gaussian"],"gaussian"),noiseMonochrome:void 0!==t.noiseMonochrome&&!!t.noiseMonochrome,noiseChroma:Qn(t.noiseChroma,.9),noiseEnabled:void 0===t.noiseEnabled||!!t.noiseEnabled,noiseMotion:Jn(t.noiseMotion,["jitter","drift","static"],"jitter"),noiseMotionAmount:Zn(t.noiseMotionAmount,0,2.5,1),noiseSpeedMs:Kn(t.noiseSpeedMs,0,1e4,1100),noiseSpeedVariance:Zn(t.noiseSpeedVariance,0,1,0),noiseFlicker:Zn(t.noiseFlicker,0,1,.12),noiseFlickerSpeedMs:Kn(t.noiseFlickerSpeedMs,0,5e3,220),noiseBlurPx:Zn(t.noiseBlurPx,0,6,0),noiseContrast:Zn(t.noiseContrast,.25,5,1.35),noiseBrightness:Zn(t.noiseBrightness,.25,3,1),noiseSaturation:Zn(t.noiseSaturation,0,3,1),noiseHue:Zn(t.noiseHue,0,360,0),noiseSize:Zn(t.noiseSize,20,600,e),noiseOpacity:Zn(t.noiseOpacity,0,1,.08),noiseOpacityLight:Zn(t.noiseOpacityLight,0,1,n),noiseOpacityDark:Zn(t.noiseOpacityDark,0,1,o),noiseBlendModeLight:Jn(t.noiseBlendModeLight,["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion"],"overlay"),noiseBlendModeDark:Jn(t.noiseBlendModeDark,["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion"],"soft-light"),noiseColorLight:"string"==typeof t.noiseColorLight?t.noiseColorLight:"#ffffff",noiseColorDark:"string"==typeof t.noiseColorDark?t.noiseColorDark:"#ffffff",detailNoiseOpacity:Zn(t.detailNoiseOpacity,0,1,1)};return a.noiseMonochrome&&(a.noiseChroma=Qn(a.noiseChroma,.9)),a}function io(t,{force:e=!1}={}){const n=JSON.stringify({seed:t.noiseSeed,size:t.noiseTextureSize,distribution:t.noiseDistribution,monochrome:t.noiseMonochrome,chroma:t.noiseChroma,contrast:(+t.noiseContrast).toFixed(3),brightness:(+t.noiseBrightness).toFixed(3),saturation:(+t.noiseSaturation).toFixed(3),hue:(+t.noiseHue).toFixed(1)});if(t.noiseEnabled)e||n!==tc?(tc=n,Js&&window.clearTimeout(Js),Js=window.setTimeout(async()=>{Js=null;const e=++Qs,n=await(async({size:t,seed:e,distribution:n,monochrome:o,chroma:a,contrast:i,brightness:r,saturation:s,hue:c})=>{const l=(t=>(qs||(qs=document.createElement("canvas"),Us=qs.getContext("2d",{willReadFrequently:!0})),Us?(qs.width!==t&&(qs.width=t),qs.height!==t&&(qs.height=t),Zs!==t&&(Zs=t,Ys=null,Xs=null),Us):null))(t);if(!l)return null;Ys||(Ys=l.createImageData(t,t),Xs=new Uint32Array(Ys.data.buffer));const u=Xs,d=eo(e),h="gaussian"===n,f=Qn(a,0),m=1-f,p=Zn(i,.25,5,1),M=Zn(r,.25,3,1),b=Zn(s,0,3,1),v=Zn(c,0,360,0),g=1!==p||1!==M,w=1!==b,y=0!==v,x=.213,S=.715,k=.072;let C=1,T=0,A=0,L=0,F=1,P=0,I=0,D=0,_=1;if(y){const t=v*Math.PI/180,e=Math.cos(t),n=Math.sin(t);C=x+.787*e-n*x,T=S-e*S-n*S,A=k-e*k+.928*n,L=x-e*x+.143*n,F=S+e*(1-S)+.14*n,P=k-e*k-.283*n,I=x-e*x-.787*n,D=S-e*S+n*S,_=k+.928*e+n*k}for(let W=0;u.length>W;W++){const t=h?no(d):d();let e=t,n=t,a=t;if(o||(e=t*m+(h?no(d):d())*f,n=t*m+(h?no(d):d())*f,a=t*m+(h?no(d):d())*f),g&&(e=(e-.5)*p+.5,n=(n-.5)*p+.5,a=(a-.5)*p+.5,e*=M,n*=M,a*=M),w){const t=e*x+n*S+a*k;e=t*(1-b)+e*b,n=t*(1-b)+n*b,a=t*(1-b)+a*b}if(y){const t=e*L+n*F+a*P,o=e*I+n*D+a*_;e=e*C+n*T+a*A,n=t,a=o}const i=Math.max(0,Math.min(255,Math.round(255*e))),r=Math.max(0,Math.min(255,Math.round(255*n)));u[W]=255<<24|Math.max(0,Math.min(255,Math.round(255*a)))<<16|r<<8|i}l.putImageData(Ys,0,0);const E=await(async t=>await new Promise(e=>{try{t.toBlob(t=>e(t),"image/png")}catch(n){e(null)}}))(qs);return E?URL.createObjectURL(E):null})({size:t.noiseTextureSize,seed:t.noiseSeed,distribution:t.noiseDistribution,monochrome:t.noiseMonochrome,chroma:t.noiseChroma,contrast:t.noiseContrast,brightness:t.noiseBrightness,saturation:t.noiseSaturation,hue:t.noiseHue});if(e===Qs){if(n)try{document.documentElement.style.setProperty("--abs-noise-texture",`url("${n}")`),Ks&&URL.revokeObjectURL(Ks),Ks=n,document.body?.classList.add("noise-ready")}catch(o){URL.revokeObjectURL(n)}}else n&&URL.revokeObjectURL(n)},140)):Ks&&t.noiseEnabled&&document.body?.classList.add("noise-ready");else{Js&&window.clearTimeout(Js),Js=null,Qs++,tc="";try{document.documentElement.style.setProperty("--abs-noise-texture","none"),document.body?.classList.remove("noise-ready")}catch(o){}if(Ks)try{URL.revokeObjectURL(Ks)}catch(o){}Ks=null}}function ro(t={}){const e=js||ao({});return ao({...e,...Xn(t)})}function so(t={}){js=ro(t),Hs=!0,oo(js),io(js,{force:!0}),js.noiseEnabled&&Ks&&document.body?.classList.add("noise-ready")}function co(t={}){Hs||so(t),js=ro(t),oo(js),io(js)}function lo(){console.log(" localStorage is disabled")}function uo(){return console.log(" localStorage is disabled - using defaults"),!1}function ho(){clearTimeout(window.settingsSaveTimeout),window.settingsSaveTimeout=setTimeout(lo,500)}async function fo(t,e,n){if(!_n())return;if(!t||!e)return void console.warn("[config-sync] Invalid sync request:",{configType:t,path:e});if("default"!==t&&"portfolio"!==t)return void console.warn("[config-sync] Invalid configType:",t);const o=((t,e)=>`${t}:${e}`)(t,e);nc.set(o,{configType:t,path:e,value:n}),oc.has(o)&&clearTimeout(oc.get(o));const a=setTimeout(async()=>{oc.delete(o);const t=nc.get(o);if(t){nc.delete(o);try{const e=await fetch("http://localhost:8002/api/config-sync",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({configType:t.configType,path:t.path,value:t.value})});if(!e.ok){const t=await e.json().catch(()=>({error:"Unknown error"}));return void console.warn("[config-sync] Sync failed:",t.error||"HTTP "+e.status)}await e.json().catch(()=>null)}catch(e){}}},300);oc.set(o,a)}async function mo(t,e){if(!_n())return!1;try{const n=await fetch("http://localhost:8002/api/config-sync-bulk",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({configType:t,config:e})});if(!n.ok){const t=await n.json().catch(()=>({error:"Unknown error"}));return console.warn("[config-sync] Bulk save failed:",t.error||"HTTP "+n.status),!1}return(await n.json()).success}catch(n){return!1}}function po(t){return!!t&&"object"==typeof t&&!Array.isArray(t)}function Mo(){try{const t="undefined"!=typeof window?window.__TEXT__:null;return po(t)?t:null}catch(t){return null}}async function bo(){if(ic)return ic;const t=Mo();if(t)return ic=t,ic;const e=await(async()=>{const t=["config/contents-home.json","js/contents-home.json","../dist/js/contents-home.json"];for(const n of t)try{const t=await fetch(n,{cache:"no-cache"});if(!t.ok)continue;const e=await t.json();if(po(e))return e}catch(e){}throw Error("No contents-home.json found")})();ic=e;try{"undefined"!=typeof window&&(window.__TEXT__=e)}catch(n){}return ic}function vo(t,e=""){const n=ic||Mo();if(!n)return e;if(!t)return e;const o=(t+"").split(".").filter(Boolean);let a=n;for(const i of o){if(!po(a)&&!Array.isArray(a))return e;if(a=a?.[i],null==a)return e}return a}function go(){return"function"==typeof document.startViewTransition}function wo(){document.querySelectorAll(".modal.active, [data-modal].active").forEach(t=>{t.classList.remove("active"),t.setAttribute("aria-hidden","true")});const t=document.getElementById("modal-overlay");t?.classList.contains("active")&&t.classList.remove("active");const e=document.getElementById("master-panel");e?.classList.contains("open")&&e.classList.remove("open"),document.documentElement.classList.remove("modal-active")}function yo(t=cc.INTERNAL){try{sessionStorage.setItem(rc,t),sessionStorage.setItem(sc,Date.now()+"")}catch(e){}}function xo(){try{const t=sessionStorage.getItem(rc),e=parseInt(sessionStorage.getItem(sc)||"0",10),n=5e3>Date.now()-e;if(sessionStorage.removeItem(rc),sessionStorage.removeItem(sc),sessionStorage.removeItem("abs_open_cv_modal"),sessionStorage.removeItem("abs_open_cv_gate"),sessionStorage.removeItem("abs_open_portfolio_modal"),sessionStorage.removeItem("abs_open_contact_modal"),sessionStorage.removeItem("abs_internal_nav"),t&&n)return t}catch(t){}return null}function So(){try{const t=performance.getEntriesByType("navigation");if(t.length>0)return"back_forward"===t[0].type}catch(t){}return!1}async function ko(t,e=cc.INTERNAL){if(uc)return;uc=!0,yo(e);const n=!!window.matchMedia?.("(prefers-reduced-motion: reduce)")?.matches;if(go())window.location.href=t;else{document.body.classList.add("page-transitioning");try{const{animateDeparture:t}=await Promise.resolve().then(()=>Sc);await t({duration:n?150:300})}catch(o){await new Promise(t=>setTimeout(t,n?150:300))}window.location.href=t}}function Co(){uc=!1,document.body.classList.remove("page-transitioning")}function To(t){if(document.querySelector(`link[rel="prefetch"][href="${t}"]`))return;const e=document.createElement("link");e.rel="prefetch",e.href=t,document.head.appendChild(e)}function Ao(t,e){t&&t.addEventListener("mouseenter",()=>To(e),{once:!0})}function Lo(t,e){t.classList.remove("page-flash--success","page-flash--error"),t.classList.add("page-flash--"+e),setTimeout(()=>{t.classList.remove("page-flash--"+e)},"success"===e?600:300)}function Fo(){const t=document.getElementById("cv-modal-trigger"),e=document.getElementById("brand-logo"),n=document.getElementById("cv-modal"),o=document.getElementById("portfolio-modal"),a=document.getElementById("contact-modal"),i=Array.from(document.querySelectorAll(".cv-digit")),r=document.getElementById("page-flash"),s=document.getElementById("cv-modal-label");if(!t||!n||0===i.length)return void console.warn("CV Gate: Missing required elements");if("true"===n.dataset.modalInitialized)return;n.dataset.modalInitialized="true";const c=vo("gates.common.backText","BACK"),l=vo("gates.common.backAriaLabel","Back"),u=vo("gates.cv.title","Bio/CV"),d=vo("gates.cv.description","Because spam bots don't deserve nice things. This keeps my inbox a little more civilised. Need access? Get in touch for the code.");s&&(s.innerHTML=`\n            <div class="modal-nav">\n                <button type="button" class="gate-back abs-icon-btn" data-modal-back aria-label="${l}">\n                    <i class="ti ti-arrow-left" aria-hidden="true"></i>\n                    <span>${c}</span>\n                </button>\n            </div>\n            <h2 class="modal-title">${u}</h2>\n            <p class="modal-description">${d}</p>\n        `);const h=r||(()=>{const t=document.createElement("div");return t.id="page-flash",t.className="page-flash",t.setAttribute("aria-hidden","true"),document.body.appendChild(t),t})();let f=!1;const m=()=>n&&n.classList.contains("active")||o&&o.classList.contains("active")||a&&a.classList.contains("active"),p=t=>{t?.preventDefault?.();const r=m();o&&o.classList.contains("active")&&(o.classList.remove("active"),o.setAttribute("aria-hidden","true"),setTimeout(()=>{o.classList.add("hidden"),Ze(o)},400)),a&&a.classList.contains("active")&&(a.classList.remove("active"),a.setAttribute("aria-hidden","true"),setTimeout(()=>{a.classList.add("hidden"),Ze(a)},400)),f=!0,r||nn(),e&&e.classList.add("fade-out-up");const s=document.querySelector(".cv-scroll-container");s&&s.classList.add("fade-out-up"),requestAnimationFrame(()=>{Xe(n),n.classList.remove("hidden"),n.setAttribute("aria-hidden","false"),n.classList.add("active"),i[0].focus()})},M=(t=!1)=>{if(f=!1,i.forEach(t=>t.value=""),t){n.style.transition="none",e&&(e.style.transition="none"),n.classList.remove("active"),n.setAttribute("aria-hidden","true"),n.classList.add("hidden"),Ze(n),e&&e.classList.remove("fade-out-up");const t=document.querySelector(".cv-scroll-container");t&&t.classList.remove("fade-out-up"),m()||on(),requestAnimationFrame(()=>{n.style.removeProperty("transition"),e&&e.style.removeProperty("transition")})}else{n.classList.remove("active"),n.setAttribute("aria-hidden","true"),e&&e.classList.remove("fade-out-up");const t=document.querySelector(".cv-scroll-container");t&&t.classList.remove("fade-out-up"),m()||on(),setTimeout(()=>{f||(n.classList.add("hidden"),Ze(n))},1700)}};try{const t=s?.querySelector?.("[data-modal-back]");t&&t.addEventListener("click",()=>M(!1))}catch(v){}n.addEventListener("click",t=>{(t.target===n||t.target.classList.contains("modal-label")||t.target.classList.contains("modal-description")||"H2"===t.target.tagName||"P"===t.target.tagName)&&M(!1)});const b=()=>{const t=i.map(t=>t.value).join("");if(4===t.length)if("1111"===t){const t=document.querySelector(".cv-modal-inputs");t&&(t.classList.remove("pulse-energy"),t.classList.add("pulse-energy")),setTimeout(()=>{Lo(h,"success")},100),setTimeout(()=>{"function"==typeof n.animate?n.animate([{transform:"scale(1)",opacity:1,filter:"blur(0)"},{transform:"scale(1.03)",opacity:0,filter:"blur(4px)"}],{duration:250,easing:"cubic-bezier(0.16, 1, 0.3, 1)",fill:"forwards"}):(n.style.transition="transform 250ms ease-out, opacity 250ms ease-out, filter 250ms ease-out",n.style.transform="scale(1.03)",n.style.opacity="0",n.style.filter="blur(4px)")},200),setTimeout(()=>{ko("cv.html",cc.INTERNAL)},450)}else Lo(h,"error"),setTimeout(()=>{i.forEach(t=>t.value=""),i[0].focus()},350)};t.addEventListener("click",p);try{sessionStorage.getItem("abs_open_cv_modal")&&(sessionStorage.removeItem("abs_open_cv_modal"),setTimeout(()=>p(),300))}catch(v){}document.addEventListener("keydown",t=>{"Escape"===t.key&&f&&M()}),document.addEventListener("modal-overlay-dismiss",t=>{f&&M(t.detail?.instant||!1)}),i.forEach((t,e)=>{t.addEventListener("keydown",n=>{"Backspace"===n.key&&""===t.value&&(e>0?i[e-1].focus():M())}),t.addEventListener("input",t=>{const n=t.target.value;if(/^\d*$/.test(n)){if(1===n.length)i.length-1>e?i[e+1].focus():b();else if(n.length>1){const o=n.split("");t.target.value=o[0];let a=e+1;for(let t=1;o.length>t&&i.length>a;t++)i[a].value=o[t],a++;i.length>a?i[a].focus():b()}}else t.target.value=n.replace(/\D/g,"")}),t.addEventListener("focus",()=>{t.select()})})}function Po(t,e){t.classList.remove("page-flash--success","page-flash--error"),t.classList.add("page-flash--"+e),setTimeout(()=>{t.classList.remove("page-flash--"+e)},"success"===e?600:300)}function Io(){const t=document.getElementById("portfolio-modal-trigger"),e=document.getElementById("portfolio-modal"),n=document.getElementById("brand-logo"),o=document.getElementById("cv-modal"),a=document.getElementById("contact-modal"),i=Array.from(document.querySelectorAll(".portfolio-digit")),r=document.getElementById("page-flash"),s=document.getElementById("portfolio-modal-label");if(!t||!e||0===i.length)return void console.warn("Portfolio Gate: Missing required elements");if("true"===e.dataset.modalInitialized)return;e.dataset.modalInitialized="true";const c=vo("gates.common.backText","BACK"),l=vo("gates.common.backAriaLabel","Back"),u=vo("gates.portfolio.title","View Portfolio"),d=vo("gates.portfolio.description","Good work deserves good context. Many of my projects across finance, automotive, and digital innovation startups are NDA-protected, so access is code-gated.");s&&(s.innerHTML=`\n            <div class="modal-nav">\n                <button type="button" class="gate-back abs-icon-btn" data-modal-back aria-label="${l}">\n                    <i class="ti ti-arrow-left" aria-hidden="true"></i>\n                    <span>${c}</span>\n                </button>\n            </div>\n            <h2 class="modal-title">${u}</h2>\n            <p class="modal-description">${d}</p>\n        `);const h=r||(()=>{const t=document.createElement("div");return t.id="page-flash",t.className="page-flash",t.setAttribute("aria-hidden","true"),document.body.appendChild(t),t})();let f=!1;const m=()=>e&&e.classList.contains("active")||o&&o.classList.contains("active")||a&&a.classList.contains("active"),p=t=>{t&&t.preventDefault();const r=m(),s=(()=>{try{const t=window.PORTFOLIO_BASE||"";return t&&!t.endsWith("/")?t+"/":t}catch(t){return""}})(),c=_n()?"modules/portfolio/app.js":"js/portfolio-bundle.js",l=document.createElement("link");l.rel="prefetch",l.href=`${s}${c}`,document.head.appendChild(l);const u=document.createElement("link");u.rel="prefetch",u.href=s+"images/portfolio/pages/chapter-1-1.webp",document.head.appendChild(u),o&&o.classList.contains("active")&&(o.classList.remove("active"),o.setAttribute("aria-hidden","true"),setTimeout(()=>{o.classList.add("hidden"),Ze(o)},400)),a&&a.classList.contains("active")&&(a.classList.remove("active"),a.setAttribute("aria-hidden","true"),setTimeout(()=>{a.classList.add("hidden"),Ze(a)},400)),f=!0,r||nn(),n&&n.classList.add("fade-out-up");const d=document.querySelector(".cv-scroll-container");d&&d.classList.add("fade-out-up"),requestAnimationFrame(()=>{Xe(e),e.classList.remove("hidden"),e.setAttribute("aria-hidden","false"),e.classList.add("active"),i[0].focus()})},M=(t=!1)=>{if(f=!1,i.forEach(t=>t.value=""),t){e.style.transition="none",n&&(n.style.transition="none"),e.classList.remove("active"),e.setAttribute("aria-hidden","true"),e.classList.add("hidden"),Ze(e),n&&n.classList.remove("fade-out-up");const t=document.querySelector(".cv-scroll-container");t&&t.classList.remove("fade-out-up"),m()||on(),requestAnimationFrame(()=>{e.style.removeProperty("transition"),n&&n.style.removeProperty("transition")})}else{e.classList.remove("active"),e.setAttribute("aria-hidden","true"),n&&n.classList.remove("fade-out-up");const t=document.querySelector(".cv-scroll-container");t&&t.classList.remove("fade-out-up"),m()||on(),setTimeout(()=>{f||(e.classList.add("hidden"),Ze(e))},1700)}};try{const t=s?.querySelector?.("[data-modal-back]");t&&t.addEventListener("click",()=>M(!1))}catch(v){}e.addEventListener("click",t=>{(t.target===e||t.target.classList.contains("modal-label")||t.target.classList.contains("modal-description")||"H2"===t.target.tagName||"P"===t.target.tagName)&&M(!1)});const b=()=>{const t=i.map(t=>t.value).join("");if(4===t.length)if("1234"===t){const t=document.querySelector(".portfolio-modal-inputs");t&&(t.classList.remove("pulse-energy"),t.classList.add("pulse-energy")),sessionStorage.setItem("abs_portfolio_ok",Date.now()),setTimeout(()=>{Po(h,"success")},100),setTimeout(()=>{"function"==typeof e.animate?e.animate([{transform:"scale(1)",opacity:1,filter:"blur(0)"},{transform:"scale(1.03)",opacity:0,filter:"blur(4px)"}],{duration:250,easing:"cubic-bezier(0.16, 1, 0.3, 1)",fill:"forwards"}):(e.style.transition="transform 250ms ease-out, opacity 250ms ease-out, filter 250ms ease-out",e.style.transform="scale(1.03)",e.style.opacity="0",e.style.filter="blur(4px)")},200),setTimeout(()=>{ko("portfolio.html",cc.INTERNAL)},450)}else Po(h,"error"),setTimeout(()=>{i.forEach(t=>t.value=""),i[0].focus()},350)};sessionStorage.getItem("abs_open_portfolio_modal")&&(sessionStorage.removeItem("abs_open_portfolio_modal"),setTimeout(()=>p(),300)),t.addEventListener("click",p),document.addEventListener("keydown",t=>{"Escape"===t.key&&f&&M()}),document.addEventListener("modal-overlay-dismiss",t=>{f&&M(t.detail?.instant||!1)}),i.forEach((t,e)=>{t.addEventListener("keydown",n=>{"Backspace"===n.key&&""===t.value&&(e>0?i[e-1].focus():M())}),t.addEventListener("input",t=>{const n=t.target.value;if(/^\d*$/.test(n)){if(1===n.length)i.length-1>e?i[e+1].focus():b();else if(n.length>1){const o=n.split("");t.target.value=o[0];let a=e+1;for(let t=1;o.length>t&&i.length>a;t++)i[a].value=o[t],a++;i.length>a?i[a].focus():b()}}else t.target.value=n.replace(/\D/g,"")}),t.addEventListener("focus",()=>{t.select()})})}function Do(){const t=vo("contact.email","alexander@beck.fyi"),e=vo("gates.common.backText","BACK"),n=vo("gates.common.backAriaLabel","Back"),o=vo("gates.contact.title","Contact"),a=vo("gates.contact.description","For collaborations, product design work, AI prototyping, or anything that needs a crisp creative + technical brain. For job opportunities, drop me a note."),i=vo("contact.copy.buttonAriaLabel","Copy email address"),r=vo("contact.copy.statusCopied","Copied"),s=vo("contact.copy.statusError","Copy failed"),c=[document.getElementById("contact-email"),document.getElementById("contact-email-inline"),document.querySelector(".decorative-script")].filter(Boolean),l=document.getElementById("brand-logo"),u=document.getElementById("contact-modal"),d=document.getElementById("contact-modal-label"),h=document.getElementById("contact-modal-inputs"),f=document.getElementById("cv-modal"),m=document.getElementById("portfolio-modal");if(!(c.length&&u&&d&&h))return void console.warn("Contact Gate: Missing required elements");if("true"===u.dataset.modalInitialized)return;u.dataset.modalInitialized="true",d.innerHTML=`\n    <div class="modal-nav">\n      <button type="button" class="gate-back abs-icon-btn" data-modal-back aria-label="${n}">\n        <i class="ti ti-arrow-left" aria-hidden="true"></i>\n        <span>${e}</span>\n      </button>\n    </div>\n    <h2 class="modal-title">${o}</h2>\n    <p class="modal-description">\n      ${a}\n    </p>\n  `,h.innerHTML=`\n    <button type="button" class="contact-email-row" data-copy-email aria-label="${i}">\n      <span class="contact-email-text">${t}</span>\n      <span class="contact-email-copy" data-copy-icon-container>\n        <i class="ti ti-copy" aria-hidden="true"></i>\n      </span>\n    </button>\n    <div class="contact-copy-status" data-copy-status aria-live="polite"></div>\n  `;const p=d.querySelector("[data-modal-back]"),M=h.querySelector("[data-copy-email]");h.querySelector("[data-copy-icon-container]");const b=h.querySelector("[data-copy-status]"),v=h.querySelector(".contact-email-copy i");let g=!1,w=null;const y=()=>u&&u.classList.contains("active")||f&&f.classList.contains("active")||m&&m.classList.contains("active"),x=t=>{if(M&&b){if(w&&window.clearTimeout(w),"copied"===t)return M.classList.add("is-copied"),M.classList.remove("is-error"),b.textContent=r,v&&(v.className="ti ti-check",v.parentElement.classList.add("is-active")),void(w=window.setTimeout(()=>x("idle"),3e3));if("error"===t)return M.classList.add("is-error"),M.classList.remove("is-copied"),b.textContent=s,v&&(v.className="ti ti-alert-triangle",v.parentElement.classList.add("is-active")),void(w=window.setTimeout(()=>x("idle"),3e3));M.classList.remove("is-copied","is-error"),b.textContent="",v&&(v.className="ti ti-copy",v.parentElement.classList.remove("is-active"))}},S=t=>{t?.preventDefault?.();const e=y();f&&f.classList.contains("active")&&(f.classList.remove("active"),f.setAttribute("aria-hidden","true"),setTimeout(()=>{f.classList.add("hidden"),Ze(f)},hc)),m&&m.classList.contains("active")&&(m.classList.remove("active"),m.setAttribute("aria-hidden","true"),setTimeout(()=>{m.classList.add("hidden"),Ze(m)},hc)),g=!0,e||nn(),x("idle"),l&&l.classList.add("fade-out-up");const n=document.querySelector(".cv-scroll-container");n&&n.classList.add("fade-out-up"),requestAnimationFrame(()=>{Xe(u),u.classList.remove("hidden"),u.setAttribute("aria-hidden","false"),u.classList.add("active"),M?.focus?.()})},k=(t=!1)=>{if(g=!1,x("idle"),t){u.style.transition="none",l&&(l.style.transition="none"),u.classList.remove("active"),u.setAttribute("aria-hidden","true"),u.classList.add("hidden"),Ze(u),l&&l.classList.remove("fade-out-up");const t=document.querySelector(".cv-scroll-container");t&&t.classList.remove("fade-out-up"),y()||on(),requestAnimationFrame(()=>{u.style.removeProperty("transition"),l&&l.style.removeProperty("transition")})}else{u.classList.remove("active"),u.setAttribute("aria-hidden","true"),l&&l.classList.remove("fade-out-up");const t=document.querySelector(".cv-scroll-container");t&&t.classList.remove("fade-out-up"),y()||on(),setTimeout(()=>{g||(u.classList.add("hidden"),Ze(u))},hc)}};c.forEach(t=>t.addEventListener("click",S,{capture:!0})),p?.addEventListener("click",()=>k(!1)),u.addEventListener("click",t=>{(t.target===u||t.target.classList.contains("modal-label")||t.target.classList.contains("modal-description")||"H2"===t.target.tagName||"P"===t.target.tagName)&&k(!1)}),M?.addEventListener("click",async()=>{const e=await(async t=>{try{if(navigator?.clipboard?.writeText)return await navigator.clipboard.writeText(t),!0}catch(e){}try{const e=document.createElement("textarea");e.value=t,e.setAttribute("readonly","true"),e.style.position="fixed",e.style.left="-9999px",e.style.top="0",document.body.appendChild(e),e.select();const n=!0===document.execCommand?.("copy");return document.body.removeChild(e),n}catch(e){return!1}})(t);e&&(M.classList.remove("pulse-energy"),M.classList.add("pulse-energy"),setTimeout(()=>{M.classList.remove("pulse-energy")},800)),x(e?"copied":"error")}),document.addEventListener("keydown",t=>{"Escape"===t.key&&g&&k()}),document.addEventListener("modal-overlay-dismiss",t=>{g&&k(t.detail?.instant||!1)});try{sessionStorage.getItem("abs_open_contact_modal")&&(sessionStorage.removeItem("abs_open_contact_modal"),requestAnimationFrame(()=>S()))}catch(C){}}function _o(){if(at(),"undefined"!=typeof window&&window.matchMedia&&window.matchMedia("(prefers-reduced-motion: reduce)").matches)return console.log(" Sound toggle hidden (prefers-reduced-motion)"),null;mc=document.createElement("button"),mc.className="sound-toggle abs-icon-btn",mc.id="sound-toggle",mc.type="button",mc.setAttribute("aria-label","Toggle collision sounds"),mc.setAttribute("aria-pressed","false"),mc.setAttribute("data-enabled","false"),mc.innerHTML=fc,mc.addEventListener("click",Eo);const t=document.getElementById("app-frame"),e=document.getElementById("sound-toggle-slot"),n=document.getElementById("top-elements-soundRow"),o=document.getElementById("social-links"),a=document.querySelector(".ui-meta-right"),i=!!e,r=o&&(!t||t.contains(o)),s="undefined"!=typeof window&&"function"==typeof window.matchMedia&&window.matchMedia("(max-width: 600px)").matches,c=t=>{if(!t)return!1;try{mc.parentElement&&mc.parentElement!==t&&mc.parentElement.removeChild(mc)}catch(e){}if(t.classList.contains("ui-meta-right")){const e=t.querySelector("time");if(e)return t.insertBefore(mc,e),!0}return t.appendChild(mc),!0};if(s&&n)mc.classList.add("sound-toggle--top"),mc.classList.add("sound-toggle--topwide"),c(n);else if(i)mc.classList.add("sound-toggle--top"),c(e);else if(a)c(a);else if(r){const t=document.createElement("li");t.className="margin-bottom_none sound-toggle-item",mc.classList.add("sound-toggle--social"),t.appendChild(mc),o.appendChild(t)}else t?t.appendChild(mc):document.body.appendChild(mc);try{if("undefined"!=typeof window&&"function"==typeof window.matchMedia){const t=window.matchMedia("(max-width: 600px)"),e=()=>{const e=document.getElementById("top-elements-soundRow"),n=document.getElementById("sound-toggle-slot"),o=t.matches&&!!e;mc.classList.toggle("sound-toggle--topwide",o),o?c(e):n&&c(n)};"function"==typeof t.addEventListener?t.addEventListener("change",e):"function"==typeof t.addListener&&t.addListener(e)}}catch(l){}console.log(" Sound toggle created");try{const t=xt();Wo(!(!t.isUnlocked||!t.isEnabled))}catch(l){}return"undefined"!=typeof window&&window.addEventListener&&window.addEventListener(ja,t=>{const e=t&&t.detail?t.detail:null;e&&(Wo(!(!e.isUnlocked||!e.isEnabled)),e.isUnlocked&&e.isEnabled&&No())}),(()=>{if(!mc)return;const t=xt();t.isUnlocked&&t.isEnabled||(pc=document.createElement("div"),pc.className="sound-tooltip",pc.setAttribute("role","tooltip"),pc.setAttribute("aria-hidden","true"),pc.innerHTML='<span class="sound-tooltip-text">Try sound on?</span>',(mc.parentElement||document.body).appendChild(pc),Ro(),Mc=setTimeout(()=>{if(pc){const t=xt();t.isUnlocked&&t.isEnabled||(Ro(),pc.classList.add("sound-tooltip--visible"),pc.setAttribute("aria-hidden","false"))}},2e4),mc.addEventListener("mouseenter",No),mc.addEventListener("focus",No),mc.addEventListener("click",No),"undefined"!=typeof window&&window.addEventListener&&window.addEventListener("resize",Ro))})(),mc}async function Eo(){if(xt().isUnlocked){const t=yt();Wo(t),t&&No()}else await rt()?(Wo(!0),No()):(mc&&(mc.innerHTML=fc,mc.setAttribute("aria-label","Audio unavailable")),setTimeout(()=>{Wo(!1)},2e3))}function Wo(t){mc&&(mc.setAttribute("data-enabled",t?"true":"false"),mc.setAttribute("aria-pressed",t?"true":"false"),mc.setAttribute("aria-label",t?"Sound on":"Sound off"),mc.innerHTML=t?'<i class="ti ti-volume-2" aria-hidden="true"></i>':fc)}function Ro(){if(!pc||!mc)return;const t=mc.getBoundingClientRect(),e=t.left+t.width/2,n=t.bottom;if(!t.width||!t.height)return void console.warn("Sound tooltip: Button rect not available, skipping position update");pc.style.position="fixed",pc.style.left="-9999px",pc.style.top="-9999px",pc.style.visibility="visible",pc.style.opacity="0";const o=pc.offsetWidth||120;let a;a="undefined"!=typeof window&&"function"==typeof window.matchMedia&&window.matchMedia("(max-width: 600px)").matches?e:e-.82*o;const i=n+12;pc.style.opacity="",pc.style.left=a+"px",pc.style.top=i+"px"}function No(){Mc&&(clearTimeout(Mc),Mc=null),pc&&(pc.classList.remove("sound-tooltip--visible"),pc.setAttribute("aria-hidden","true"),setTimeout(()=>{pc&&pc.parentElement&&pc.parentElement.removeChild(pc),pc=null},300))}function zo(){const t=document.getElementById("social-links");if(!t)return;if(t.querySelector("i.ti"))return;const e=Array.from(t.querySelectorAll("a.footer_icon-link[aria-label]"));for(const n of e){const t=(n.getAttribute("aria-label")||"").trim().toLowerCase(),e=bc.get(t);if(!e)continue;const o=n.querySelector("svg");o?(n.insertAdjacentHTML("afterbegin",e),o.remove()):n.insertAdjacentHTML("afterbegin",e)}}function Oo(){function t(){e.textContent=o.format(new Date).toUpperCase()}const e=document.getElementById("time-display"),n=document.getElementById("site-year");if(!e)return;const o=new Intl.DateTimeFormat("en-GB",{timeZone:"Europe/London",hour:"numeric",minute:"2-digit",second:"2-digit",hour12:!0});t(),setInterval(t,1e3),n&&n.addEventListener("click",Yn)}function Bo(t){if(!t||!t.closest)return null;const e=t.closest('a, button, [role="button"]');if(!e)return null;try{if(e.classList?.contains?.("slide"))return null;if(e.closest?.(".slide"))return null}catch(n){}return e}function Vo(t){const e=Bo(t.target);var n;if(e&&!((n=e)&&n.closest&&(n.closest("#panelDock")||n.closest("#masterPanel")||n.closest("#dockToggle")||n.closest(".panel-dock")||n.closest(".panel"))))try{document.body.classList.add(gc),Mt()}catch(t){}}function Go(t){const e=Bo(t.target);if(!e)return;const n=t.relatedTarget;if(!n||!e.contains(n))try{document.body.classList.remove(gc)}catch(t){}}function $o(){if(!vc){vc=!0;try{document.body.classList.remove(gc)}catch(t){}document.addEventListener("pointerover",Vo,!0),document.addEventListener("pointerout",Go,!0),window.PointerEvent||(document.addEventListener("mouseover",Vo,!0),document.addEventListener("mouseout",Go,!0)),window.addEventListener("blur",()=>{try{document.body.classList.remove(gc)}catch(t){}},{passive:!0}),window.addEventListener("mouseout",e=>{if(!e.relatedTarget&&!e.toElement)try{document.body.classList.remove(gc)}catch(t){}},{passive:!0})}}function Ho(t,e,n){if(t&&null!=n)try{t.setAttribute(e,n+"")}catch(o){}}function jo(){try{(()=>{const t=vo("meta.title","");t&&(document.title=t);const e=vo("meta.description","");if(e){const t=document.querySelector('meta[name="description"]');t&&t.setAttribute("content",e)}})(),((t,e)=>{t&&(t.textContent=(e??"")+"")})(document.getElementById("edge-caption-tagline"),vo("edge.tagline",vo("edge.copyright",""))),(()=>{const t=document.getElementById("expertise-legend");Ho(t,"aria-label",vo("legend.ariaLabel",""));const e=vo("legend.items",null);if(!Array.isArray(e)||!t)return;const n=t.querySelectorAll(".legend__item");for(let o=0;n.length>o&&e.length>o;o++){const t=n[o],a=e?.[o]?.label,i=e?.[o]?.tooltip,r=e?.[o]?.colorClass,s=t.querySelector("span");if(a&&s&&(s.textContent=a),i&&t.setAttribute("data-tooltip",i),r){const e=t.querySelector(".circle");if(e){const t=[];for(const n of((e.className||"")+"").split(/\s+/).filter(Boolean))n.startsWith("bg-ball-")||t.push(n);t.push(r),e.className=t.join(" ")}}}})(),(()=>{const t=document.querySelector(".decorative-script p");if(!t)return;const e=vo("philosophy.textBeforeLink",""),n=vo("philosophy.link.id","contact-email-inline")||"contact-email-inline",o=vo("philosophy.link.href","#")||"#",a=vo("philosophy.link.text","")||"";let i=document.getElementById(n);if(i||(i=t.querySelector("a")),!i)return;i.id=n,i.setAttribute("href",o),i.textContent=a;const r=i.previousSibling;r&&r.nodeType===Node.TEXT_NODE?r.nodeValue=e:t.insertBefore(document.createTextNode(e),i);const s=i.nextSibling;s&&s.nodeType===Node.TEXT_NODE&&(s.nodeValue="")})(),(()=>{Ho(document.getElementById("main-links"),"aria-label",vo("footer.navAriaLabel",""));const t=vo("footer.links",null);if(t&&"object"==typeof t)for(const e of["contact","portfolio","cv"]){const n=t?.[e];if(!n)continue;const o=document.getElementById(n.id||"");o&&(n.href&&o.setAttribute("href",n.href),n.text&&(o.textContent=n.text))}})(),(()=>{const t=document.getElementById("social-links");Ho(t,"aria-label",vo("socials.ariaLabel",""));const e=vo("socials.items",null);if(!t||!e||"object"!=typeof e)return;const n=["appleMusic","x","linkedin"],o=t.querySelectorAll("a.footer_icon-link");for(let a=0;o.length>a&&3>a;a++){const t=o[a],i=e?.[n[a]];if(!i)continue;i.url&&t.setAttribute("href",i.url),i.ariaLabel&&t.setAttribute("aria-label",i.ariaLabel);const r=t.querySelector(".screen-reader");r&&i.screenReaderText&&(r.textContent=i.screenReaderText)}})(),(()=>{const t=document.getElementById("header-cv-link");if(!t)return;const e=vo("footer.links.cv",null);e&&"object"==typeof e&&(e.href&&t.setAttribute("href",e.href),e.text&&(t.textContent=e.text))})(),(()=>{const t=document.querySelector("[data-portfolio-ui] .decorative-script p");if(!t)return;const e=vo("portfolio.blurb","");e&&(t.textContent=e)})()}catch(t){}}async function qo(){try{try{if("undefined"!=typeof window&&window.__RUNTIME_CONFIG__&&"object"==typeof window.__RUNTIME_CONFIG__)return window.__RUNTIME_CONFIG__}catch(t){}const e=["config/default-config.json","../config/default-config.json","js/config.json","../js/config.json","../dist/js/config.json"];for(const n of e)try{const t=await fetch(n,{cache:"no-cache"});if(t.ok)return await t.json()}catch(t){}throw Error("No config found")}catch(t){return console.warn("Config load failed, using defaults"),{gravityMultiplier:1.05,ballMass:91,maxBalls:300}}}async function Uo({timeoutMs:t=4e3,fontFaces:e=wc}={}){const n=document.documentElement;if(n&&n.classList.add("fonts-loading"),!document.fonts||!document.fonts.ready)return n&&n.classList.remove("fonts-loading"),!1;let o;const a=new Promise(e=>{o=window.setTimeout(()=>e(!1),t)}),i=Promise.all(e.map(t=>document.fonts.load(t).catch(()=>null))).then(()=>document.fonts.ready).then(()=>!0).catch(()=>!1),r=await Promise.race([i,a]);return o&&window.clearTimeout(o),n&&n.classList.remove("fonts-loading"),r}function Yo(t){const e=document.documentElement;void 0!==t.topLogoWidthVw&&e.style.setProperty("--top-logo-width-vw",t.topLogoWidthVw+""),t.bgLight&&(e.style.setProperty("--bg-light",t.bgLight),e.style.setProperty("--chrome-bg-light",t.bgLight)),t.bgDark&&(e.style.setProperty("--bg-dark",t.bgDark),e.style.setProperty("--chrome-bg-dark",t.bgDark));const n=t.frameColorLight||t.frameColor,o=t.frameColorDark||t.frameColor;n&&e.style.setProperty("--frame-color-light",n),o&&e.style.setProperty("--frame-color-dark",o)}function Xo(t){t&&(p(t),Yo(t),Zo())}function Zo(){try{y()}catch(t){}try{f()}catch(t){}try{m()}catch(t){}}function Ko(t={}){const{contactModal:e=!1,cvModal:n=!1,portfolioModal:o=!1,cursorHiding:a=!0,modalOverlayConfig:i={}}=t;if(e||n||o)try{Je(i)}catch(r){console.warn("Failed to initialize modal overlay:",r)}if(e)try{Do()}catch(r){console.warn("Failed to initialize contact modal:",r)}if(n)try{Fo()}catch(r){console.warn("Failed to initialize CV modal:",r)}if(o)try{Io()}catch(r){console.warn("Failed to initialize portfolio modal:",r)}if(a)try{$o()}catch(r){console.warn("Failed to initialize cursor hiding:",r)}}function Qo(){const t=window.innerWidth/window.innerHeight;return t>1.1?"landscape":.9>t?"portrait":"square"}function Jo(){const t=Qo();let e;document.documentElement.classList.remove("aspect-landscape","aspect-square","aspect-portrait"),document.documentElement.classList.add("aspect-"+t),window.addEventListener("resize",()=>{clearTimeout(e),e=setTimeout(()=>{const e=Qo();e!==t&&(document.documentElement.classList.remove("aspect-landscape","aspect-square","aspect-portrait"),document.documentElement.classList.add("aspect-"+e))},150)})}function ta(){const t=(()=>{const t=M();switch(Qo()){case"landscape":return t.entrancePerspectiveLandscape||1200;case"portrait":return t.entrancePerspectivePortrait||800;default:return t.entrancePerspectiveSquare||1e3}})();document.documentElement.style.setProperty("--entrance-perspective",t+"px")}function ea(){document.documentElement.classList.add("entrance-pre-transition")}function na(){const t=M(),e=document.documentElement,n=t.entranceWallTransitionDelay||300,o=t.entranceWallTransitionDuration||800,a=document.getElementById("bravia-balls");if(!a)return console.warn(" #bravia-balls not found, falling back to simple transition"),void setTimeout(()=>{e.classList.remove("entrance-pre-transition"),e.classList.add("entrance-transitioning"),setTimeout(()=>{e.classList.remove("entrance-transitioning"),e.classList.add("entrance-complete")},o)},n);const i=document.body.classList.contains("portfolio-page")?t.wallRadius&&"number"==typeof t.wallRadius&&t.wallRadius>0?t.wallRadius+"px":"42px":"0px",r=t.entranceWallInitialScale||1.1,s=t.entranceWallEasing||"cubic-bezier(0.16, 1, 0.3, 1)",c=a.style.transition;setTimeout(()=>{if(e.classList.remove("entrance-pre-transition"),e.classList.add("entrance-transitioning"),a.style.transition="none",a.style.transform=`scale(${r})`,a.style.transformOrigin="center center",a.style.borderRadius="0px",a.style.opacity="1",a.style.visibility="visible","function"==typeof a.animate){const t=a.animate([{transform:`scale(${r})`},{transform:"scale(1)"}],{duration:o,easing:s,fill:"forwards"}),n=a.animate([{borderRadius:"0px"},{borderRadius:i}],{duration:o,easing:s,fill:"forwards"});let l=!1,u=!1;const d=()=>{l&&u&&(a.style.transform="scale(1)",a.style.borderRadius=i,a.style.opacity="1",setTimeout(()=>{a.style.transition=c||"",e.classList.remove("entrance-transitioning"),e.classList.add("entrance-complete")},50))};t.addEventListener("finish",()=>{l=!0,d()}),t.addEventListener("cancel",()=>{l=!0,d()}),n.addEventListener("finish",()=>{u=!0,d()}),n.addEventListener("cancel",()=>{u=!0,d()})}else requestAnimationFrame(()=>{a.style.transition=`transform ${o}ms ${s}, border-radius ${o}ms ${s}`,requestAnimationFrame(()=>{a.style.transform="scale(1)",a.style.borderRadius=i})}),setTimeout(()=>{a.style.transition=c||"",e.classList.remove("entrance-transitioning"),e.classList.add("entrance-complete")},o+50)},n)}function oa(t,e={}){return new Promise(n=>{if(!t)return void n();const o=M(),a=2*(e.duration??o.entranceLateElementDuration??600),i=e.easing??"cubic-bezier(0.16, 1, 0.3, 1)";setTimeout(()=>{t.style.transition="none",t.style.visibility="visible",t.animate([{opacity:0},{opacity:1}],{duration:a,easing:i,fill:"forwards"}).finished.then(()=>{t.style.opacity="1",requestAnimationFrame(()=>{requestAnimationFrame(()=>{t.style.removeProperty("transition"),document.documentElement.classList.add("entrance-complete")})})}).catch(()=>{}),n()},e.delay??0)})}function aa(){const t=document.documentElement,e=document.getElementById("brand-logo"),n=document.getElementById("main-links");e&&(e.style.removeProperty("opacity"),e.style.visibility="visible"),n&&(n.style.removeProperty("opacity"),n.style.visibility="visible"),t.classList.add("ui-entered");const o=document.getElementById("fade-blocking");o&&o.remove()}function ia(){let t="";for(const[e,n]of Object.entries(xc)){t+='<div class="sound-dock__section">',t+=`<div class="sound-dock__section-title">${n.title}</div>`,t+='<div class="sound-dock__group">';for(const e of n.controls)t+=`\n        <label class="sound-dock__row">\n          <span class="sound-dock__label">${e.label}</span>\n          <input type="range" \n            id="sound_${e.id}" \n            class="sound-dock__slider" \n            min="${e.min}" \n            max="${e.max}" \n            step="${e.step}">\n          <span class="sound-dock__val" id="sound_${e.id}_val">${e.format(e.fromConfig(0))}</span>\n        </label>`;t+="</div></div>"}return t}function ra(t,e,n){for(const o of Object.values(xc))for(const e of o.controls){const o=t.querySelector("#sound_"+e.id),a=t.querySelector(`#sound_${e.id}_val`);if(!o)continue;const i=t=>{const i=(r=t,s=parseFloat(o.min),c=parseFloat(o.max),s>r?s:r>c?c:r);var r,s,c;o.value=i+"";const l=e.toConfig(i);a&&(a.textContent=e.format(i)),n({[e.id]:l})};o.addEventListener("input",()=>{i(parseFloat(o.value))}),o.addEventListener("wheel",t=>{if(t.ctrlKey)return;const e=(parseFloat(o.step)||1)*(t.altKey?.1:t.shiftKey?.2:1),n=0>t.deltaY?1:-1,a=parseFloat(o.value);t.preventDefault(),i(a+n*e)},{passive:!1}),a&&a.addEventListener("wheel",t=>{if(t.ctrlKey)return;const e=(parseFloat(o.step)||1)*(t.altKey?.1:t.shiftKey?.2:1),n=0>t.deltaY?1:-1,a=parseFloat(o.value);t.preventDefault(),i(a+n*e)},{passive:!1})}}function sa(t,e){const n=e();for(const o of Object.values(xc))for(const e of o.controls){const o=t.querySelector("#sound_"+e.id),a=t.querySelector(`#sound_${e.id}_val`);if(!o||void 0===n[e.id])continue;const i=e.fromConfig(n[e.id]);o.value=i,a&&(a.textContent=e.format(i))}}const ca={PIT:"pit",FLIES:"flies",WEIGHTLESS:"weightless",WATER:"water",VORTEX:"vortex",PING_PONG:"ping-pong",DVD_LOGO:"dvd-logo",MAGNETIC:"magnetic",BUBBLES:"bubbles",KALEIDOSCOPE:"kaleidoscope-3",CRITTERS:"critters",NEURAL:"neural",PARALLAX_LINEAR:"parallax-linear",SPHERE_3D:"3d-sphere",CUBE_3D:"3d-cube",STARFIELD_3D:"starfield-3d",ELASTIC_CENTER:"elastic-center",SNAKE:"snake",PARTICLE_FOUNTAIN:"particle-fountain"},la=[ca.PIT,ca.FLIES,ca.CUBE_3D,ca.BUBBLES,ca.MAGNETIC,ca.WATER,ca.PING_PONG,ca.DVD_LOGO,ca.NEURAL,ca.SPHERE_3D,ca.WEIGHTLESS,ca.PARALLAX_LINEAR,ca.CRITTERS,ca.ELASTIC_CENTER,ca.VORTEX,ca.KALEIDOSCOPE,ca.STARFIELD_3D,ca.SNAKE,ca.PARTICLE_FOUNTAIN],ua={[ca.PIT]:"SOURCE MATERIAL",[ca.FLIES]:"IDEA SPARK",[ca.BUBBLES]:"NOISE SIGNAL",[ca.MAGNETIC]:"DESIGN FORCES",[ca.WATER]:"USER FLOW",[ca.PING_PONG]:"FEEDBACK CYCLE",[ca.DVD_LOGO]:"DVD SCREENSAVER",[ca.NEURAL]:"CONNECTION MAP",[ca.VORTEX]:"ATOMIC STRUCTURE",[ca.WEIGHTLESS]:"OPEN SPACE",[ca.PARALLAX_LINEAR]:"PERSPECTIVE SHIFT",[ca.CRITTERS]:"BEHAVIOR MODEL",[ca.ELASTIC_CENTER]:"ELASTIC CENTER",[ca.SPHERE_3D]:"3D SHELL",[ca.CUBE_3D]:"3D FRAME",[ca.KALEIDOSCOPE]:"VOCAB BLOOM",[ca.STARFIELD_3D]:"DEPTH FIELD",[ca.SNAKE]:"SNAKE",[ca.PARTICLE_FOUNTAIN]:"PARTICLE FLOW"},da={DPR:Math.max(1,Math.min(2,window.devicePixelRatio||1)),OFFSCREEN_MOUSE:-1e9,MIN_DISTANCE_EPSILON:1e-6,ACCUMULATOR_RESET_THRESHOLD:3,MAX_PHYSICS_STEPS:4,SPIN_DAMP_PER_S:3,SPIN_GAIN:.25,SPIN_GAIN_TANGENT:.18,ROLL_FRICTION_PER_S:2.5,SQUASH_MAX_BASE:.2,SQUASH_DECAY_PER_S:18,WALL_REST_VEL_THRESHOLD:70,GROUND_COUPLING_PER_S:12,SLEEP_VELOCITY_THRESHOLD:12,SLEEP_ANGULAR_THRESHOLD:.18,TIME_TO_SLEEP:.25,PHYSICS_DT:1/120,PHYSICS_DT_MOBILE:1/60},ha={rubber:{label:"Rubber (balanced)",description:"Balanced rubber ring with clear bounce and crisp ripples.",values:{wallWobbleMaxDeform:50,wallWobbleStiffness:2100,wallWobbleDamping:34,wallWobbleSigma:2.2,wallWobbleCornerClamp:.6,wallWobbleImpactThreshold:110,wallWobbleSettlingSpeed:70,wallWobbleMaxVel:900,wallWobbleMaxImpulse:240,wallWobbleMaxEnergyPerStep:24e3,wallInset:3}},pudding:{label:"Pudding (thick, soft)",description:"Overdamped, broad blobs. Big squish, quick settling, minimal ringing.",values:{wallWobbleMaxDeform:85,wallWobbleStiffness:520,wallWobbleDamping:82,wallWobbleSigma:5.2,wallWobbleCornerClamp:.25,wallWobbleImpactThreshold:55,wallWobbleSettlingSpeed:94,wallWobbleMaxVel:650,wallWobbleMaxImpulse:180,wallWobbleMaxEnergyPerStep:22e3,wallInset:3}},trampoline:{label:"Trampoline (snappy)",description:"High elasticity and low viscosity. Fast rebound with lively oscillation.",values:{wallWobbleMaxDeform:60,wallWobbleStiffness:2900,wallWobbleDamping:14,wallWobbleSigma:2.4,wallWobbleCornerClamp:.55,wallWobbleImpactThreshold:95,wallWobbleSettlingSpeed:35,wallWobbleMaxVel:1200,wallWobbleMaxImpulse:320,wallWobbleMaxEnergyPerStep:3e4,wallInset:3}},jelly:{label:"Jelly (slow wobble)",description:"Soft and springy with slow, smooth undulation. More gel sheet.",values:{wallWobbleMaxDeform:95,wallWobbleStiffness:820,wallWobbleDamping:16,wallWobbleSigma:3.6,wallWobbleCornerClamp:.4,wallWobbleImpactThreshold:75,wallWobbleSettlingSpeed:28,wallWobbleMaxVel:900,wallWobbleMaxImpulse:260,wallWobbleMaxEnergyPerStep:26e3,wallInset:3}},stiff:{label:"Stiff (rigid-ish)",description:"Small deformation with heavy damping: feels like thick industrial gasket.",values:{wallWobbleMaxDeform:28,wallWobbleStiffness:3200,wallWobbleDamping:62,wallWobbleSigma:1.7,wallWobbleCornerClamp:.8,wallWobbleImpactThreshold:160,wallWobbleSettlingSpeed:92,wallWobbleMaxVel:700,wallWobbleMaxImpulse:160,wallWobbleMaxEnergyPerStep:2e4,wallInset:3}},steel:{label:"Steel (almost solid)",description:"Barely moves; impact gating high. Useful as a near-static control case.",values:{wallWobbleMaxDeform:10,wallWobbleStiffness:3600,wallWobbleDamping:75,wallWobbleSigma:1.2,wallWobbleCornerClamp:.9,wallWobbleImpactThreshold:190,wallWobbleSettlingSpeed:98,wallWobbleMaxVel:500,wallWobbleMaxImpulse:90,wallWobbleMaxEnergyPerStep:16e3,wallInset:3}},latex:{label:"Latex (tight snap)",description:"Taut membrane: smaller blobs, higher tension, crisp rebounds.",values:{wallWobbleMaxDeform:55,wallWobbleStiffness:2600,wallWobbleDamping:22,wallWobbleSigma:1.8,wallWobbleCornerClamp:.7,wallWobbleImpactThreshold:105,wallWobbleSettlingSpeed:55,wallWobbleMaxVel:1100,wallWobbleMaxImpulse:300,wallWobbleMaxEnergyPerStep:28e3,wallInset:3}},memoryFoam:{label:"Memory Foam (slow sink)",description:"Very soft with heavy damping: sinks in and slowly recovers.",values:{wallWobbleMaxDeform:120,wallWobbleStiffness:420,wallWobbleDamping:88,wallWobbleSigma:6,wallWobbleCornerClamp:.2,wallWobbleImpactThreshold:45,wallWobbleSettlingSpeed:96,wallWobbleMaxVel:520,wallWobbleMaxImpulse:150,wallWobbleMaxEnergyPerStep:22e3,wallInset:3}},hydraulic:{label:"Hydraulic (damped)",description:"Medium squish with very high viscosity: controlled, mechanical response.",values:{wallWobbleMaxDeform:70,wallWobbleStiffness:1400,wallWobbleDamping:78,wallWobbleSigma:3,wallWobbleCornerClamp:.55,wallWobbleImpactThreshold:85,wallWobbleSettlingSpeed:90,wallWobbleMaxVel:650,wallWobbleMaxImpulse:200,wallWobbleMaxEnergyPerStep:24e3,wallInset:3}},gelSheet:{label:"Gel Sheet (wide ripples)",description:"Wide, slow waves with moderate bounce. Feels like a gel panel.",values:{wallWobbleMaxDeform:95,wallWobbleStiffness:1e3,wallWobbleDamping:28,wallWobbleSigma:4.8,wallWobbleCornerClamp:.35,wallWobbleImpactThreshold:70,wallWobbleSettlingSpeed:45,wallWobbleMaxVel:900,wallWobbleMaxImpulse:260,wallWobbleMaxEnergyPerStep:26e3,wallDeformPhysicsPrecision:75,wallInset:3}}},fa={default:{label:"Default (Full View Grid)",parallaxLinearDotSizeMul:1.8,sizeVariationParallaxLinear:0,parallaxLinearGridX:14,parallaxLinearGridY:10,parallaxLinearGridZ:7,parallaxLinearSpanX:1.35,parallaxLinearSpanY:1.35,parallaxLinearZNear:50,parallaxLinearZFar:900,parallaxLinearFocalLength:420,parallaxLinearParallaxStrength:260},dense:{label:"Dense (More Vertices)",parallaxLinearDotSizeMul:1.6,sizeVariationParallaxLinear:.1,parallaxLinearGridX:18,parallaxLinearGridY:13,parallaxLinearGridZ:9,parallaxLinearSpanX:1.25,parallaxLinearSpanY:1.25,parallaxLinearZNear:45,parallaxLinearZFar:1e3,parallaxLinearFocalLength:420,parallaxLinearParallaxStrength:240},deep:{label:"Deep Field (Stronger Depth)",parallaxLinearDotSizeMul:1.7,sizeVariationParallaxLinear:.08,parallaxLinearGridX:14,parallaxLinearGridY:10,parallaxLinearGridZ:10,parallaxLinearSpanX:2.2,parallaxLinearSpanY:2.2,parallaxLinearZNear:30,parallaxLinearZFar:1500,parallaxLinearFocalLength:520,parallaxLinearParallaxStrength:320},calm:{label:"Calm (Slow Camera)",parallaxLinearDotSizeMul:1.8,sizeVariationParallaxLinear:.05,parallaxLinearGridX:12,parallaxLinearGridY:9,parallaxLinearGridZ:6,parallaxLinearSpanX:2,parallaxLinearSpanY:2,parallaxLinearZNear:60,parallaxLinearZFar:900,parallaxLinearFocalLength:420,parallaxLinearParallaxStrength:160},minimal:{label:"Minimal (Big Dots)",parallaxLinearDotSizeMul:2.4,sizeVariationParallaxLinear:.15,parallaxLinearGridX:10,parallaxLinearGridY:7,parallaxLinearGridZ:4,parallaxLinearSpanX:2.6,parallaxLinearSpanY:2.6,parallaxLinearZNear:70,parallaxLinearZFar:800,parallaxLinearFocalLength:380,parallaxLinearParallaxStrength:220}};let ma=Math.max(1,Math.min(2,window.devicePixelRatio||1));const pa={config:{},currentMode:ca.CRITTERS,warmupFramesRemaining:0,balls:[],canvas:null,ctx:null,container:null,mouseX:da.OFFSCREEN_MOUSE,mouseY:da.OFFSCREEN_MOUSE,mouseInCanvas:!1,lastPointerMoveMs:0,lastPointerMoveX:da.OFFSCREEN_MOUSE,lastPointerMoveY:da.OFFSCREEN_MOUSE,GE:1960,G:0,gravityScale:1,gravityMultiplier:0,gravityMultiplierPit:1.1,REST:.31,FRICTION:.011,ballMassKg:240,MASS_BASELINE_KG:240,MASS_REST_EXP:.15,MASS_GRAVITY_EXP:.35,get DPR(){return ma},sizeScale:1.2,sizeVariationGlobalMul:1,sizeVariationCap:.12,sizeVariationPit:0,sizeVariationFlies:0,sizeVariationWeightless:0,sizeVariationWater:0,sizeVariationVortex:.2,sizeVariationPingPong:0,sizeVariationMagnetic:0,sizeVariationBubbles:.2,sizeVariationKaleidoscope:0,sizeVariationCritters:.2,sizeVariationNeural:.05,sizeVariationParallaxLinear:0,pitWarmupFrames:10,fliesWarmupFrames:10,weightlessWarmupFrames:10,waterWarmupFrames:10,vortexWarmupFrames:10,pingPongWarmupFrames:10,magneticWarmupFrames:10,bubblesWarmupFrames:10,kaleidoscope3WarmupFrames:10,crittersWarmupFrames:10,neuralWarmupFrames:10,parallaxLinearWarmupFrames:10,sphere3dRadiusVw:18,sphere3dDensity:140,sphere3dFocalLength:600,sphere3dDotSizeMul:1.5,sphere3dIdleSpeed:.15,sphere3dCursorInfluence:1.2,sphere3dTumbleSpeed:2.5,sphere3dTumbleDamping:.94,sphere3dWarmupFrames:10,cube3dSizeVw:50,cube3dEdgeDensity:8,cube3dFaceGrid:0,cube3dIdleSpeed:.2,cube3dCursorInfluence:1.5,cube3dTumbleSpeed:3,cube3dTumbleDamping:.95,cube3dFocalLength:500,cube3dDotSizeMul:1.5,cube3dWarmupFrames:10,starfieldCount:200,starfieldSpanX:1.5,starfieldSpanY:1.2,starfieldZNear:100,starfieldZFar:2e3,starfieldFocalLength:500,starfieldParallaxStrength:320,starfieldSpeed:400,starfieldDotSizeMul:1,starfieldIdleJitter:0,starfieldFadeDuration:.5,starfield3dWarmupFrames:10,sizeVariation:0,ballSizeDesktop:18,ballSizeMobile:8.64,isMobile:!1,isMobileViewport:!1,wallDeformationEnabled:!0,mobileObjectReductionFactor:.5,mobileObjectReductionThreshold:200,liteModeEnabled:!1,liteModeObjectReductionFactor:.6,R_MED:18,R_MIN:18,R_MAX:18,cursorSize:1,cursorColorMode:"auto",cursorColorIndex:5,cursorColorHex:"#ff4013",cursorColorLumaMax:.62,cursorColorAllowIndices:[],cursorColorDenyIndices:[],mouseTrailEnabled:!0,mouseTrailLength:18,mouseTrailSize:1.3,mouseTrailFadeMs:220,mouseTrailOpacity:.35,cursorExplosionEnabled:!0,cursorExplosionParticleCount:6,cursorExplosionSpeed:180,cursorExplosionSpreadDeg:360,cursorExplosionLifetime:.5,cursorExplosionFadeStartRatio:.4,cursorExplosionDrag:.88,cursorExplosionShrinkEnabled:!0,cursorExplosionImpactMinFactor:.5,cursorExplosionImpactMaxFactor:4,cursorExplosionImpactSensitivity:400,cursorExplosionLifetimeImpactMin:.7,cursorExplosionLifetimeImpactMax:1.8,cursorExplosionLifetimeImpactSensitivity:600,ballSoftness:20,ballSpacing:.08,sleepVelocityThreshold:12,sleepAngularThreshold:.18,timeToSleep:.25,physicsCollisionIterations:10,physicsSkipSleepingCollisions:!0,physicsSleepThreshold:12,physicsSleepTime:.25,physicsSkipSleepingSteps:!0,physicsSpatialGridOptimization:!0,wallPhysicsSamples:48,wallPhysicsSkipInactive:!0,wallPhysicsUpdateHz:30,wallPhysicsMaxSubstepHz:60,wallPhysicsInterpolation:!0,wallPhysicsAdaptiveSamples:!0,wallPhysicsMinSamples:24,wallVisualDeformMul:1,wallRenderDecimation:2,critterCount:90,critterSpeed:680,critterMaxSpeed:1400,critterStepHz:5,critterStepSharpness:2.4,critterTurnNoise:2.2,critterTurnDamp:10,critterTurnSeek:10,critterAvoidRadius:90,critterAvoidForce:9500,critterEdgeAvoid:1,critterMousePull:1,critterMouseRadiusVw:30,critterRestitution:.18,critterFriction:.018,cornerRadius:42,layoutViewportWidthPx:0,containerBorderVw:0,simulationPaddingVw:0,contentPaddingRatio:.03,contentPaddingHorizontalRatio:1,contentPaddingBottomRatio:1.3,mobileWallThicknessXFactor:1.4,desktopWallThicknessFactor:1,mobileEdgeLabelsVisible:!0,wallRadiusVw:0,wallThicknessVw:0,wallThicknessAreaMultiplier:1,noiseEnabled:!0,noiseSeed:1337,noiseTextureSize:256,noiseDistribution:"gaussian",noiseMonochrome:!1,noiseChroma:.9,noiseMotion:"jitter",noiseMotionAmount:1.2,noiseSpeedMs:1100,noiseSpeedVariance:.3,noiseFlicker:.08,noiseFlickerSpeedMs:180,noiseBlurPx:0,noiseContrast:1.2,noiseBrightness:1.15,noiseSaturation:1,noiseHue:0,noiseSize:85,noiseOpacity:.08,noiseOpacityLight:.08,noiseOpacityDark:.12,noiseBlendMode:"normal",noiseColorLight:"#ffffff",noiseColorDark:"#ffffff",detailNoiseOpacity:1,layoutMinWallRadiusPx:28,wallInset:3,vortexSwirlStrength:450,vortexBallCount:90,vortexSpeedMultiplier:2.6,vortexRadius:100,vortexRotationDirection:1,vortexDepthVariation:.95,vortexSpiralTightness:.15,magneticBallCount:180,magneticStrength:65e3,magneticMaxVelocity:2800,magneticRadius:0,magneticExplosionInterval:5,bubblesSpawnRate:16,bubblesRiseSpeed:650,bubblesWobble:65,bubblesMaxCount:200,bubblesDeflectRadius:0,pingPongBallCount:35,pingPongSpeed:400,pingPongCursorRadius:0,currentColors:["#b5b7b6","#bbbdbd","#ffffff","#00695c","#000000","#ff4013","#0d5cb6","#ffa000"],currentTemplate:"industrialTeal",paletteRotateOnReload:!1,colorDistribution:[{label:"Product & Systems",colorIndex:0,weight:30},{label:"Interaction & Motion",colorIndex:4,weight:18},{label:"Creative Technology",colorIndex:3,weight:15},{label:"AI-Driven Design",colorIndex:2,weight:12},{label:"Experience Direction",colorIndex:5,weight:10},{label:"Art & Visual Direction",colorIndex:6,weight:10},{label:"Prototyping",colorIndex:7,weight:5}],fliesBallCount:60,attractionPower:5e3,orbitRadius:180,swarmSpeed:.4,fliesSeparation:15e3,weightlessCount:66,weightlessInitialSpeed:250,weightlessBounce:.7,weightlessRepelRadius:220,weightlessRepelPower:5e4,dvdLogoSpeed:200,dvdLogoSize:.7,dvdLogoBallCount:60,dvdLogoBallSpacing:1.5,dvdLogoLetterSpacing:1.5,dvdLogoMassMultiplier:2,dvdLogoWarmupFrames:10,elasticCenterBallCount:93,elasticCenterMassMultiplier:2,elasticCenterSpacingMultiplier:2.8,elasticCenterElasticStrength:2e3,elasticCenterMouseRepelStrength:12e3,elasticCenterMouseRadius:200,elasticCenterDamping:.94,elasticCenterWarmupFrames:10,snakeBallCount:95,snakeRestLength:29,snakeSpringStrength:238,snakeDamping:.92,snakeGroundFriction:1.9,snakeSpeed:400,snakeWarmupFrames:10,particleFountainEmissionRate:29,particleFountainInitialVelocity:4700,particleFountainSpreadAngle:20,particleFountainWaterDrag:.02,particleFountainGravityMultiplier:1.7,particleFountainUpwardForce:300,particleFountainMaxParticles:230,particleFountainLifetime:8,particleFountainWarmupFrames:120,particleFountainMouseRepelStrength:5e4,particleFountainMouseRepelRadiusVw:5,particleFountainMouseRepelRadius:0,weightlessRepelSoft:5.4,kaleidoscopeMirror:1,kaleidoscopeIdleDrift:.012,kaleidoscope3BallCount:150,kaleidoscope3Wedges:10,kaleidoscope3WedgesMobile:6,kaleidoscope3Speed:1.2,kaleidoscope3DotSizeVh:1.05,kaleidoscope3DotAreaMul:.75,kaleidoscope3SpawnAreaMul:1.05,kaleidoscope3SizeVariance:.5,kaleidoscope3WarmupFrames:65,neuralBallCount:311,neuralLinkDistanceVw:5,neuralLineOpacity:.06,neuralConnectorDensity:3,neuralWanderStrength:1e3,neuralMouseStrength:15e4,neuralSeparationRadius:100,neuralSeparationStrength:11e3,neuralMaxLinksPerBall:6,neuralDamping:.9,parallaxLinearDotCount:95,parallaxLinearRowPattern:"thirds",parallaxLinearSpacingPattern:"even",parallaxLinearFarPct:.42,parallaxLinearMidPct:.32,parallaxLinearFarSpeed:.15,parallaxLinearMidSpeed:.5,parallaxLinearNearSpeed:1,parallaxLinearFollowStrength:16,parallaxLinearDamping:12,parallaxLinearGridX:14,parallaxLinearGridY:10,parallaxLinearGridZ:7,parallaxLinearSpanX:5,parallaxLinearSpanY:2.6,parallaxLinearZNear:50,parallaxLinearZFar:900,parallaxLinearFocalLength:420,parallaxLinearParallaxStrength:260,parallaxLinearDotSizeMul:1.8,waterBallCount:300,waterDrag:.015,waterRippleSpeed:300,waterRippleStrength:18e3,waterDriftStrength:40,waterInitialVelocity:200,vortexDrag:.005,pingPongVerticalDamp:.911,magneticDamping:.998,repelRadius:120,repelPower:274e3,repelSoft:3.4,repellerEnabled:!1,cursorInfluenceRadiusVw:14,cursorInfluenceRadiusPx:140,emitterTimer:0,autoDarkModeEnabled:!0,isDarkMode:!1,chromeHarmonyMode:"site",autoDarkNightStartHour:18,autoDarkNightEndHour:6,clickCycleEnabled:!0,sceneImpactEnabled:!0,sceneImpactMul:.005,sceneImpactMobileMulFactor:1,sceneImpactLogoCompMul:1.8,sceneImpactOvershoot:.22,sceneImpactAnticipation:0,sceneImpactPressMs:0,sceneImpactReleaseMs:620,sceneChangeSoundEnabled:!0,sceneChangeSoundIntensity:.35,sceneChangeSoundRadius:18,brandLogoImpactMul:.014,brandLogoSquashMul:1,brandLogoOvershoot:.22,brandLogoAnticipation:0,brandLogoTiltDeg:0,brandLogoSkewDeg:0,brandLogoPressMs:75,brandLogoHoldMs:55,brandLogoReleaseMs:220,containerBorder:20,containerBorderX:20,simulationPadding:0,contentPadding:40,contentPaddingX:40,contentPaddingY:40,bgLight:"#f5f5f5",bgDark:"#0a0a0a",frameColor:"#242529",frameColorLight:"#242529",frameColorDark:"#242529",textColorLight:"#161616",textColorLightMuted:"#2f2f2f",textColorDark:"#7a8fa3",textColorDarkMuted:"#9db0c4",edgeLabelInsetAdjustPx:0,edgeCaptionDistanceMinPx:8,edgeCaptionDistanceMaxPx:48,simulationOverlayIntensity:1,depthWashOpacity:.65,depthWashBlendModeLight:"color-dodge",depthWashBlendModeDark:"multiply",depthWashCenterY:.3,depthWashRadiusScale:1,depthWashCenterColorLight:"#ffffff",depthWashEdgeColorLight:"#142b48",depthWashCenterAlphaLight:.3,depthWashEdgeAlphaLight:.4,depthWashCenterColorDark:"#1a1e23",depthWashEdgeColorDark:"#05020f",depthWashCenterAlphaDark:0,depthWashEdgeAlphaDark:.8,linkHoverColor:"#ff4013",topLogoWidthVw:35,homeMainLinksBelowLogoPx:40,footerNavBarTopVh:50,footerNavBarGapVw:2.5,wallThickness:12,wallRadius:42,wallInset:3,wallPreset:"pudding",wallSoftness:50,wallBounciness:50,wallWobbleMaxDeform:70,wallWobbleStiffness:420,wallWobbleDamping:92,wallWobbleSigma:5.5,wallWobbleCornerClamp:.25,wallWobbleMaxVel:620,wallWobbleMaxImpulse:160,wallWobbleMaxEnergyPerStep:2e4,wallWobbleImpactThreshold:60,wallWobbleSettlingSpeed:94,modalOverlayEnabled:!0,modalOverlayOpacity:.01,modalOverlayBlurPx:8,modalOverlayTransitionMs:800,modalOverlayTransitionOutMs:600,modalOverlayContentDelayMs:200,modalDepthScale:.96,modalDepthTranslateY:8,logoBlurInactive:0,logoBlurActive:12,entranceEnabled:!0,entranceWallTransitionDelay:300,entranceWallTransitionDuration:800,entranceWallInitialScale:1.1,entranceWallEasing:"cubic-bezier(0.16, 1, 0.3, 1)",entranceElementDuration:800,entranceElementScaleStart:.95,entranceElementTranslateZStart:-20,contentFadeInDelay:500,contentFadeInDuration:1e3,entranceElementEasing:"cubic-bezier(0.16, 1, 0.3, 1)",entranceLateElementDuration:600,entranceLateElementStagger:250,entranceLateElementScaleFrom:.92,entrancePerspectiveLandscape:1200,entrancePerspectiveSquare:1e3,entrancePerspectivePortrait:800,uiHitAreaMul:1,uiIconCornerRadiusMul:.5,uiIconFramePx:0,uiIconGlyphPx:0,uiIconGroupMarginPx:0,linkTextPadding:30,linkIconPadding:24,linkColorInfluence:1,linkImpactScale:.95,linkImpactBlur:10,linkImpactDuration:150,hoverSnapEnabled:!0,hoverSnapDuration:450,hoverSnapOvershoot:1.08,hoverSnapUndershoot:.98,getSquashMax(){return 0===this.ballSoftness?0:da.SQUASH_MAX_BASE*(this.ballSoftness/40)},getCanvasCornerRadius(){return Math.max(0,this.cornerRadius-this.simulationPadding)}};var Ma=Object.freeze({__proto__:null,applyLayoutCSSVars:m,applyLayoutFromVwToPx:f,clearBalls:w,detectResponsiveScale:y,getBalls:()=>pa.balls,getConfig:()=>pa.config,getEffectiveDPR:()=>ma,getGlobals:M,getLayoutViewportHeightPx:c,getLayoutViewportWidthPx:s,getMobileAdjustedCount:b,getNormalizedScreenArea:u,getScreenAreaPx:l,getState:()=>pa,initState:p,pxToVw:d,setCanvas:v,setEffectiveDPR:a,setMode:g,updateBallSizes:x,vwToPx:h});const ba=.85,va=["#b5b7b6","#bbbdbd","#ffffff","#00695c","#000000","#ff4013","#0d5cb6","#ffa000"],ga=["#5b8378","#345d51","#8a928a","#00e6c3","#d5d5d5","#ff6b47","#5b9aff","#ffb84d"],wa=1.35,ya={satMul:.1,valMul:.03},xa={satMul:.14,valMul:.07},Sa={industrialTeal:{label:"Industrial Teal",light:R(va,.2),dark:R(ga,.2)},industrialRust:{label:"Industrial Rust",light:R(W(_(va,E(va,["#b5b7b6","#bbbdbd","#ffffff","#a33a22","#000000","#00695c","#1f4bb8","#ff8a1f"],wa),ba),ya),.2),dark:R(W(_(ga,E(ga,["#7f6f64","#54433a","#b6b1aa","#ff6a3d","#d5d5d5","#00e6c3","#6aa0ff","#ffb15a"],wa),ba),xa),.2)},industrialSlate:{label:"Industrial Slate",light:R(W(_(va,E(va,["#b5b7b6","#bbbdbd","#ffffff","#1f2937","#000000","#00a8cc","#7c3aed","#ff5d2e"],wa),ba),ya),.2),dark:R(W(_(ga,E(ga,["#6f7780","#3f4851","#98a2b3","#7dd3fc","#d5d5d5","#22d3ee","#c084fc","#ff7a45"],wa),ba),xa),.2)},industrialAmber:{label:"Industrial Amber",light:R(W(_(va,E(va,["#b5b7b6","#bbbdbd","#ffffff","#d97706","#000000","#00695c","#6b46c1","#ff4013"],wa),ba),ya),.2),dark:R(W(_(ga,E(ga,["#82745d","#5a4b35","#a9a193","#fbbf24","#d5d5d5","#00e6c3","#c4b5fd","#ff6b47"],wa),ba),xa),.2)},industrialViolet:{label:"Industrial Violet",light:R(W(_(va,E(va,["#b5b7b6","#bbbdbd","#ffffff","#6b46c1","#000000","#00695c","#7fbf2a","#d94666"],wa),ba),ya),.2),dark:R(W(_(ga,E(ga,["#7a6f83","#52475b","#a7a0b0","#c084fc","#d5d5d5","#00e6c3","#bef264","#fb7185"],wa),ba),xa),.2)},industrialForest:{label:"Industrial Forest",light:R(W(_(va,E(va,["#b5b7b6","#bbbdbd","#ffffff","#166534","#000000","#00695c","#f59e0b","#7c3aed"],wa),ba),ya),.2),dark:R(W(_(ga,E(ga,["#637563","#3d4f3f","#98a593","#4ade80","#d5d5d5","#00e6c3","#fcd34d","#c4b5fd"],wa),ba),xa),.2)},industrialSteel:{label:"Industrial Steel",light:R(W(_(va,E(va,["#b5b7b6","#bbbdbd","#ffffff","#334155","#000000","#0ea5e9","#c2410c","#65a30d"],wa),ba),ya),.2),dark:R(W(_(ga,E(ga,["#6f737a","#464a52","#98a2ab","#94a3b8","#d5d5d5","#38bdf8","#fb923c","#a3e635"],wa),ba),xa),.2)}},ka=["industrialTeal","industrialRust","industrialSlate","industrialAmber","industrialViolet","industrialForest","industrialSteel"],Ca="abs_palette_chapter",Ta=[.5,.25,.12,.06,.03,.02,.01,.01],Aa=[3,5,6,7];var La=Object.freeze({__proto__:null,COLOR_TEMPLATES:Sa,PALETTE_CHAPTER_ORDER:ka,applyColorTemplate:Q,applyCursorColorIndex:U,getCurrentPalette:X,getCursorCandidateIndices:q,maybeAutoPickCursorColor:Y,pickRandomColor:K,pickRandomColorWithIndex:Z,populateColorSelect:J,rotatePaletteChapterOnReload:tt});const Fa={attackTime:.003,decayTime:.12,harmonicGain:.02,filterBaseFreq:580,filterVelocityRange:400,filterQ:.18,filterMinHz:350,filterMaxHz:2800,pitchMinHz:220,pitchMaxHz:880,pitchCurve:1.2,reverbDecay:.25,reverbWetMix:.18,reverbHighDamp:.55,minGain:.001,maxGain:.0125,masterGain:.28,voiceGainMax:.02,minTimeBetweenSounds:.012,maxPan:.15,noiseTransientEnabled:!0,noiseTransientGain:.018,noiseTransientDecay:.004,noiseTransientFilterMin:800,noiseTransientFilterMax:2400,noiseTransientQ:.8,sparkleGain:.035,sparkleRatioMin:2,sparkleRatioMax:5,sparkleDecayMul:.85,variancePitch:.06,varianceDecay:.2,varianceGain:.15,varianceFilter:.18,varianceNoise:.25,velocityNoiseScale:1.8,velocityBrightnessScale:1.4,velocityDecayScale:.65,intensityExponent:1.5,toneSafetyMinHz:130,toneSafetyMaxHz:480,toneSafetyExponent:2.2,toneSafetyHighGainAtten:.25,toneSafetyLowGainAtten:.06,toneSafetyHighBrightAtten:.45,collisionMinImpact:.58,highShelfFreq:2200,highShelfGain:-6};let Pa={continuousEnabled:!1,tickGainMul:1,swishGainMul:1,tickBaseGain:.05,tickMinVelocity:50,tickMaxVelocity:1600,tickMinRate:.6,tickMaxRate:9,swishBaseGain:.04,swishMinVelocity:220,swishMaxVelocity:2200,swishMinHz:600,swishMaxHz:2200,centerGain:.08,centerFilterHz:1600,snapGain:.12,openGain:.12,openFilterHz:1800,closeGain:.1,closeFilterHz:1600,snapDebounceMs:300,stopDelayMs:60},Ia=null;const Da={organicImpact:{label:"Organic Impact",description:"Warm, natural thuds with intensity dynamics",...Fa},glassMarbles:{label:"Glass Marbles",description:"Clear, glassy impacts with more presence",...Fa,pitchMinHz:260,pitchMaxHz:780,pitchCurve:1.05,filterBaseFreq:850,filterVelocityRange:600,noiseTransientGain:.065,noiseTransientFilterMin:650,noiseTransientFilterMax:2200,noiseTransientQ:1.6,decayTime:.055,intensityExponent:1.3,highShelfGain:-4.5},crystalPebbles:{label:"Crystal Pebbles ",description:"Crisp, close, soothing micro-chimes (non-repetitive)",...Fa,pitchMinHz:420,pitchMaxHz:1600,pitchCurve:1.15,filterBaseFreq:1300,filterVelocityRange:1700,filterQ:.22,filterMaxHz:6200,decayTime:.04,intensityExponent:1.65,collisionMinImpact:.7,minTimeBetweenSounds:.018,noiseTransientGain:.02,noiseTransientDecay:.006,noiseTransientFilterMin:1200,noiseTransientFilterMax:7e3,noiseTransientQ:2.8,sparkleGain:.12,sparkleRatioMin:2.6,sparkleRatioMax:4.4,sparkleDecayMul:.55,reverbWetMix:.04,reverbDecay:.1,highShelfGain:-4,masterGain:.24},woodenBeads:{label:"Wooden Beads ",description:"Ultra-soft, muted thuds (recommended)",...Fa,filterBaseFreq:420,filterVelocityRange:200,noiseTransientGain:.025,noiseTransientFilterMin:380,noiseTransientFilterMax:1400,noiseTransientQ:1.1,decayTime:.095,intensityExponent:1.7,collisionMinImpact:.62,highShelfGain:-7.5,reverbWetMix:.12},rubberBalls:{label:"Rubber Balls",description:"Bouncy, playful with longer decay",...Fa,pitchMinHz:160,pitchMaxHz:360,filterBaseFreq:520,filterVelocityRange:350,noiseTransientGain:.035,noiseTransientFilterMin:450,noiseTransientFilterMax:1600,noiseTransientQ:1.2,decayTime:.12,intensityExponent:1.4,reverbWetMix:.14,highShelfGain:-5},metallicClick:{label:"Metallic Click",description:"Crisp, percussive impacts",...Fa,pitchMinHz:220,pitchMaxHz:620,pitchCurve:1.1,filterBaseFreq:720,filterVelocityRange:550,noiseTransientGain:.08,noiseTransientFilterMin:700,noiseTransientFilterMax:2400,noiseTransientQ:1.8,noiseTransientDecay:.006,decayTime:.045,intensityExponent:1.2,highShelfGain:-3.5,collisionMinImpact:.5}};let _a="crystalPebbles";Ia={...Da[_a]},delete Ia.label,delete Ia.description;let Ea=null,Wa=null,Ra=null,Na=null,za=null,Oa=null,Ba=null,Va=null,Ga=null,$a=!1,Ha=!1;const ja="bravia-balls:sound-state",qa=8;let Ua=[],Ya=0,Xa=new Map,Za=!1,Ka=null,Qa=null,Ja=null,ti=null,ei=null,ni=null,oi=null,ai=null,ii=null,ri=null,si=!1;const ci=new Map,li=[],ui=[],di=768,hi=45,fi=1/30,mi=.25;let pi=null;class Mi{constructor(t){const e=Math.max(8,Math.round(t||di));this.n=e,this.deformations=new Float32Array(e),this.velocities=new Float32Array(e),this.pressure=new Float32Array(e),this.renderDeformations=new Float32Array(e),this.Mt=0,this.bt=0,this.vt=0,this.gt=0,this.wt=0,this.yt=0,this.xt=0,this.St=0,this.kt=0,this.Ct=0,this.Tt=0,this.At=0,this.Lt=0,this.Ft=0,this.Pt=0,this.baseX=new Float32Array(e),this.baseY=new Float32Array(e),this.normX=new Float32Array(e),this.normY=new Float32Array(e),this.cornerMask=new Float32Array(e),this.It=0,this.Dt=0,this._t=!1,this.Et=0}ensureSampleCount(t){const e=Math.max(8,Math.round(+t||di));if(e===this.n)return;const n=this.n,o=this.deformations,a=this.velocities,i=this.pressure,r=new Float32Array(e),s=new Float32Array(e),c=new Float32Array(e),l=new Float32Array(e);if(n>0){let t=0,l=0;for(let u=0;e>u;u++){const d=u/e*n,h=Math.floor(d)%n,f=d-h,m=(h+1)%n,p=(1-f)*o[h]+f*o[m],M=(1-f)*a[h]+f*a[m],b=(1-f)*i[h]+f*i[m];r[u]=p,s[u]=M,c[u]=b,p>t&&(t=p);const v=Math.abs(M);v>l&&(l=v)}this.It=t,this.Dt=l,this._t=t>0||l>0}else this.It=0,this.Dt=0,this._t=!1;this.n=e,this.deformations=r,this.velocities=s,this.pressure=c,this.renderDeformations=l,this.baseX=new Float32Array(e),this.baseY=new Float32Array(e),this.normX=new Float32Array(e),this.normY=new Float32Array(e),this.cornerMask=new Float32Array(e),this.Mt=0,this.bt=0,this.vt=0,this.gt=0,this.wt=0,this.yt=0,this.xt=0,this.St=0,this.kt=0,this.Ct=0,this.Tt=0,this.At=0,this.Lt=0,this.Ft=0,this.Pt=0}clearPressure(){this.pressure.fill(0)}reset(){this.deformations.fill(0),this.velocities.fill(0),this.pressure.fill(0),this.renderDeformations.fill(0),this.It=0,this.Dt=0,this._t=!1,this.Et=0}hasDeformation(){return this.It>2}ensureGeometry(t,e,n){const o=Math.max(1,0|t),a=Math.max(1,0|e),i=Math.max(0,Math.min(+n||0,.5*Math.min(o,a)));if(o===this.Mt&&a===this.bt&&.001>Math.abs(i-this.vt))return;if(this.Mt=o,this.bt=a,this.vt=i,0>=i){const t=o,e=a,n=2*(t+e);this.gt=t,this.wt=e,this.yt=0,this.xt=n,this.Ct=0,this.kt=t/2,this.St=t/2+e,this.Tt=t/2+e+t,this.At=0,this.Lt=0,this.Ft=0,this.Pt=0;for(let i=0;this.n>i;i++){const r=(i/this.n*n+t/2)%n;if(t/2>r)this.baseX[i]=o/2+r,this.baseY[i]=a,this.normX[i]=0,this.normY[i]=-1;else if(t/2+e>r){const e=r-t/2;this.baseX[i]=o,this.baseY[i]=e,this.normX[i]=-1,this.normY[i]=0}else if(t/2+e+t>r)this.baseX[i]=o-(r-(t/2+e)),this.baseY[i]=0,this.normX[i]=0,this.normY[i]=1;else if(t/2+e+t+e>r){const n=r-(t/2+e+t);this.baseX[i]=0,this.baseY[i]=a-n,this.normX[i]=1,this.normY[i]=0}else this.baseX[i]=r-(t/2+e+t+e),this.baseY[i]=a,this.normX[i]=0,this.normY[i]=-1;this.cornerMask[i]=0}return}const r=Math.max(0,o-2*i),s=Math.max(0,a-2*i),c=.5*Math.PI*i,l=2*(r+s)+4*c;this.gt=r,this.wt=s,this.yt=c,this.xt=l,this.Ct=0,this.Pt=r/2,this.kt=r/2+c,this.Lt=r/2+c+s,this.St=r/2+c+s+c,this.At=r/2+c+s+c+r,this.Tt=r/2+c+s+c+r+c,this.Ft=r/2+c+s+c+r+c+s;const u=[r/2,c,s,c,r,c,s,c],d=u.reduce((t,e)=>t+e,0),h=u.map(t=>t/d),f=[0];for(let y=0;h.length>y;y++)f.push(f[y]+h[y]);const m=o,p=a,M=i,b=this.n,v=(t,e,n,o,a,i)=>{const r=o+(a-o)*i,s=Math.cos(r),c=Math.sin(r);return{x:t+n*s,y:e+n*c,nx:-s,ny:-c}},g=M+r/2,w=m-M;for(let y=0;b>y;y++){const t=y/b;let e=0,n=0,o=0,a=0,i=0,c=0;for(let r=0;h.length>r;r++)if(t>=f[r]&&f[r+1]>t){c=r;break}f[h.length]>t||(c=h.length-1);const l=(t-f[c])/h[c];switch(c){case 0:e=g+l*(r/2),n=p,o=0,a=-1;break;case 1:const t=v(m-M,p-M,M,Math.PI/2,0,l);e=t.x,n=t.y,o=t.nx,a=t.ny,i=1;break;case 2:e=m,n=p-M-l*s,o=-1,a=0;break;case 3:const c=v(m-M,M,M,0,-Math.PI/2,l);e=c.x,n=c.y,o=c.nx,a=c.ny,i=1;break;case 4:e=w-l*r,n=0,o=0,a=1;break;case 5:const u=v(M,M,M,3*Math.PI/2,Math.PI,l);e=u.x,n=u.y,o=u.nx,a=u.ny,i=1;break;case 6:e=0,n=M+l*s,o=1,a=0;break;case 7:const d=v(M,p-M,M,Math.PI,Math.PI/2,l);e=d.x,n=d.y,o=d.nx,a=d.ny,i=1}this.baseX[y]=e,this.baseY[y]=n,this.normX[y]=o,this.normY[y]=a,this.cornerMask[y]=i?1:0}}tFromPoint(t,e){const n=this.Mt,o=this.bt;if(0===this.n||0>=n||0>=o)return 0;const a=n,i=o,r=this.vt,s=t>a-r&&r>e,c=r>t&&e>i-r,l=t>a-r&&e>i-r;let u=0;if(r>t&&r>e){const n=t-r,o=e-r;if(Math.sqrt(n*n+o*o)>0){const t=this.At/this.xt,e=(this.At+this.yt)/this.xt;u=t+Math.max(0,Math.min(1,(Math.atan2(o,n)-Math.PI)/(Math.PI/2)))*(e-t)}else u=this.At/this.xt}else if(s){const n=t-(a-r),o=e-r;if(Math.sqrt(n*n+o*o)>0){const t=this.Lt/this.xt,e=(this.Lt+this.yt)/this.xt;u=t+Math.max(0,Math.min(1,(Math.atan2(o,n)+Math.PI/2)/(Math.PI/2)))*(e-t)}else u=this.Lt/this.xt}else if(l){const n=t-(a-r),o=e-(i-r);if(Math.sqrt(n*n+o*o)>0){const t=this.Pt/this.xt,e=(this.Pt+this.yt)/this.xt;u=t+Math.max(0,Math.min(1,Math.atan2(o,n)/(Math.PI/2)))*(e-t)}else u=this.Pt/this.xt}else if(c){const n=t-r,o=e-(i-r);if(Math.sqrt(n*n+o*o)>0){const t=this.Ft/this.xt,e=1;u=t+Math.max(0,Math.min(1,(Math.atan2(o,n)-Math.PI/2)/(Math.PI/2)))*(e-t),1>u||(u-=1)}else u=this.Ft/this.xt}else if(r>e)u=(this.St+Math.max(0,Math.min(this.gt,t-r)))/this.xt;else if(t>a-r)u=(this.kt+Math.max(0,Math.min(this.wt,e-r)))/this.xt;else if(e>i-r){const e=a-r-t;e>this.gt/2?(u=(this.Ct+(this.gt/2+(this.gt/2-(t-r))))/this.xt,1>u||(u-=1)):u=(this.Ct+(this.gt/2-e))/this.xt}else r>t&&(u=(this.Tt+Math.max(0,Math.min(this.wt,i-r-e)))/this.xt);return(u%1+1)%1}getDeformationAtPoint(t,e){const n=this.n;if(0===n)return 0;const o=this.tFromPoint(t,e)*n,a=Math.floor(o)%n,i=o-a;return(1-i)*this.deformations[a]+i*this.deformations[(a+1)%n]}impactAtPoint(t,e,n){const o=this.tFromPoint(t,e);this.impactAtT(o,n)}addPressureAtPoint(t,e,n,o={}){const a=this.tFromPoint(t,e);this.addPressureAtT(a,n,o)}tFromWall(t,e){const n=this.Mt,o=this.bt,a=this.vt,i=this.gt,r=this.wt,s=this.xt;if(0>=s)return 0;const c=Math.max(0,Math.min(1,+e||0));return"top"===t?(this.St+Math.max(0,Math.min(i,c*n-a)))/s:"right"===t?(this.kt+Math.max(0,Math.min(r,c*o-a)))/s:"bottom"===t?(this.Ct+Math.max(0,Math.min(i,n-a-c*n)))/s:"left"===t?(this.Tt+Math.max(0,Math.min(r,o-a-c*o)))/s:0}impactAtT(t,e){const n=M(),o=this.n;if(0>=o)return;const a=Math.max(0,n.wallWobbleMaxDeform??hi)*Math.max(0,Math.min(1,+e||0));if(0>=a)return;const i=Math.max(.25,Math.min(6,n.wallWobbleSigma??2)),r=((+t||0)%1+1)%1*o,s=Math.max(0,+(n.wallWobbleMaxImpulse??220)||0),c=Math.max(0,+(n.wallWobbleMaxVel??800)||0),l=Math.max(0,+(n.wallWobbleMaxEnergyPerStep??2e4)||0),u=Math.max(2,Math.min(o,Math.min(24,Math.ceil(3*i))));for(let d=-u;u>=d;d++){const t=((Math.round(r)+d)%o+o)%o,e=Math.abs(r-t),n=Math.min(e,o-e);let u=a*Math.exp(-n*n/(2*i*i));s>0&&u>s&&(u=s);const h=this.pressure[t]||0;if(h>0&&(u*=Math.max(mi,1-.65*h)),l>0){const t=l-this.Et;if(0>=t)break;u>t&&(u=t)}let f=this.velocities[t]+u;if(c>0){const e=this.pressure[t]||0,n=e>0?c*Math.max(mi,1-.55*e):c;f>n?f=n:-n>f&&(f=-n)}this.velocities[t]=f,l>0&&(this.Et+=Math.abs(u))}this._t=!0}addPressureAtT(t,e,n={}){const o=this.n;if(0>=o)return;const a=Math.max(0,Math.min(1,+e||0));if(0>=a)return;const i=Math.round(((+t||0)%1+1)%1*o)%o,r=n.fast?1:3;for(let s=-r;r>=s;s++){const t=((i+s)%o+o)%o,e=this.pressure[t]+a*Math.max(0,1-Math.abs(s)/(r+1));this.pressure[t]=e>1?1:e}this._t=!0}step(t){const e=M(),n=this.n;if(0>=n)return;const o=Math.min(fi,Math.max(0,+t||0));if(0>=o)return;if(!this._t){let t=!1;const a=200,i=3,r=5;for(let s=0;n>s;s++)if(this.deformations[s]>.001||Math.abs(this.velocities[s])>.001){t=!0;const n=1>this.baseY[s]&&!this.cornerMask[s]&&this.normY[s]>.7,c=!this.cornerMask[s]&&this.vt+2>this.baseX[s]&&this.vt+2>this.baseY[s],l=c||!this.cornerMask[s]&&this.baseX[s]>this.Mt-this.vt-1&&this.vt+1>this.baseY[s],u=this.cornerMask[s]&&this.vt+3>this.baseX[s]&&this.vt+3>this.baseY[s],d=u||this.cornerMask[s]&&this.baseX[s]>this.Mt-this.vt-2&&this.vt+2>this.baseY[s];this.velocities[s]+=(-(u||c?a*i*r:n||l||d?a*i:a)*this.deformations[s]-20*this.velocities[s])*o,this.deformations[s]+=this.velocities[s]*o;const h=Math.max(0,e.wallWobbleMaxDeform??hi);-h>this.deformations[s]?(this.deformations[s]=-h,this.velocities[s]=0):this.deformations[s]>h&&(this.deformations[s]=h,this.velocities[s]=0);const f=n||l||d,m=u||c;(m?.01:f?.02:.1)>this.deformations[s]&&(m?.2:f?.3:1)>Math.abs(this.velocities[s])&&(this.deformations[s]=0,this.velocities[s]=0)}return this._t=t,void(t||(this.It=0,this.Dt=0))}const a=Math.max(1,e.wallWobbleStiffness??2200),i=Math.max(0,e.wallWobbleDamping??35),r=Math.max(0,e.wallWobbleMaxDeform??hi),s=Math.max(0,+(e.wallWobbleMaxVel??800)||0),c=.18*a,l=Math.max(0,Math.min(100,e.wallWobbleSettlingSpeed??50))/100,u=5+30*l,d=.5+1.5*l;let h=0,f=0;for(let m=0;n>m;m++){const t=0===m?n-1:m-1,e=m===n-1?0:m+1,l=this.deformations[m],p=this.velocities[m],M=a*(1>this.baseY[m]&&this.normY[m]>.7?1.9:1.7),b=Math.abs(l),v=Math.abs(p),g=this.pressure[m];let w=p+(-M*l+c*(this.deformations[t]+this.deformations[e]-2*l)-Math.min(i*(1+1*Math.max(0,Math.min(1,1-b/20)))*(1+g*u),1.9*Math.sqrt(M+2*c))*p)*o;if(s>0){const t=this.pressure[m]||0,e=t>0?s*Math.max(mi,1-.55*t):s;w>e?w=e:-e>w&&(w=-e)}let y=l+w*o,x=!1,S=!1;-r>y&&(y=-r,x=!0),y>r&&(y=r,S=!0),x&&0>w&&(w=0),S&&w>0&&(w=0);const k=1>this.baseY[m]&&this.normY[m]>.7?4:2,C=(g>.5?.5:g>.1?3:10)*d*k;(g>.5?.3:g>.1?.8:2)*d*k>Math.abs(y)&&C>v?(this.deformations[m]=0,this.velocities[m]=0):(this.deformations[m]=y,this.velocities[m]=w),this.deformations[m]>h&&(h=this.deformations[m]);const T=Math.abs(this.velocities[m]);T>f&&(f=T)}Number.isFinite(h)&&Number.isFinite(f)?(this.It=h,this.Dt=f,this._t=h>0||f>0):this.reset()}}const bi={ringPhysics:new Mi(di),ringRender:new Mi(di),tt:0,et:0,Wt:1/30,Rt:0,u:0,Nt:null,S:null,p:null,M:null,zt:null,resetStepBudgets(){this.tt=0,this.et=0,this.ringPhysics.Et=0},clearPressureFrame(){this.ringPhysics.clearPressure()},step(t){const e=M(),n=!1!==e.wallPhysicsAdaptiveSamples,o=Math.max(8,Math.min(48,Math.round(+(e.wallPhysicsMinSamples??24)||24))),a=Math.min(di,Math.round(+(e.wallPhysicsSamples??di)||di));if(!1!==e.wallPhysicsSkipInactive&&!this.ringPhysics._t)return this.ringPhysics.step(t),this.ringRender.step(t),void(this.u=1);const i=1/Math.max(10,Math.min(60,+(e.wallPhysicsUpdateHz??30)||30)),r=!1!==e.wallPhysicsInterpolation;if(this.Rt+=t,i>this.Rt)this.u=r?Math.max(0,Math.min(1,this.Rt/i)):1;else{if(n){const t=this.ringPhysics.n;let e=t;e=this.ringPhysics._t?5>(this.ringPhysics.It||0)&&2>(this.ringPhysics.Dt||0)?Math.max(o,Math.min(a,t-1)):Math.min(a,Math.max(o,t+1)):Math.max(o,Math.min(a,t-1)),e!==t&&this.ringPhysics.ensureSampleCount(e)}else{const t=Math.max(8,Math.min(di,a));this.ringPhysics.n!==t&&this.ringPhysics.ensureSampleCount(t)}if(r&&this.ringPhysics.n>0){const t=this.ringPhysics.n;this.Nt&&this.Nt.length===t||(this.Nt=new Float32Array(t)),this.Nt.set(this.ringPhysics.deformations)}let t=i;this.Rt-=i;const c=1/Math.max(30,Math.min(240,+(e.wallPhysicsMaxSubstepHz??60)||60));let l=0;const u=6;for(;t>1e-6&&u>l;){const e=t>c?c:t;this.ringPhysics.step(e),t-=e,l++}try{const t=this.ringPhysics,e=0|t.n,n=0|this.ringRender.n;if(e>0&&n>0){this.p&&this.p.length===n?this.p.set(this.M):(this.p=new Float32Array(n),this.M=new Float32Array(n),this.zt=new Float32Array(n));const o=t.deformations,a=this.zt,i=this.M;for(let t=0;n>t;t++){const i=t/n*e,r=Math.floor(i)%e,s=i-r;a[t]=(1-s)*o[r]+s*o[(r+1)%e]}for(let t=0;n>t;t++)i[t]=(a[(t-2+n)%n]+4*a[(t-1+n)%n]+6*a[t]+4*a[(t+1)%n]+a[(t+2)%n])*(1/16);for(let t=0;n>t;t++)a[t]=(i[(t-2+n)%n]+4*i[(t-1+n)%n]+6*i[t]+4*i[(t+1)%n]+i[(t+2)%n])*(1/16);for(let t=0;n>t;t++)i[t]=a[t]}}catch(s){}this.u=r?Math.max(0,Math.min(1,this.Rt/i)):1}},reset(){this.ringPhysics.reset(),this.ringRender.reset(),this.Rt=0,this.u=0,this.Nt=null,this.p=null,this.M=null,this.S=null,this.k=0,this.zt=null},hasAnyDeformation(){return this.ringPhysics.hasDeformation()},getDeformationAtPoint(t,e){const n=this.ringPhysics;if(!n||0===n.n)return 0;const o=M();if(!o.canvas)return 0;const a=o.DPR||1,i=Math.max(0,(+o.wallThickness||0)*a),r=n.getDeformationAtPoint(t-i,e-i);return r>0?r*a:0}};let vi=0;class gi{constructor(t,e,n,o){const a=M();this.x=t,this.y=e,this.vx=200*(2*Math.random()-1),this.vy=200*-Math.random(),this.r=n,this.rBase=n,this.m=a.ballMassKg,this.color=o,this.t=0,this.age=0,this.driftAx=0,this.driftTime=0,this.omega=0,this.squash=1,this.squashDirX=1,this.squashDirY=0,this.theta=0,this.squashAmount=0,this.squashNormalAngle=0,this.alpha=1,this.isSleeping=!1,this.sleepTimer=0,this.isGrounded=!1,this.hasSupport=!1,this.Ot="ball-"+vi++}step(t,e){const n=M(),{currentMode:o,G:a,gravityScale:i,FRICTION:r,MASS_BASELINE_KG:s}=n;if(this.t+=t,this.age+=t,this.isSleeping){const t=(n.repelRadius||710)*n.DPR*1.2,e=this.x-n.mouseX,o=this.y-n.mouseY;t*t>e*e+o*o&&this.wake()}if(this.isSleeping&&!1!==n.physicsSkipSleepingSteps)return;const c=n.DPR||1,l=this.isGrounded,u=this.hasSupport;this.isGrounded=!1,this.hasSupport=!1,o!==ca.WEIGHTLESS&&(!l&&!u||-8*c>this.vy)&&(this.vy+=a*i*t);const d=Math.max(.25,this.m/s),h=Math.max(0,1-(o===ca.WEIGHTLESS?0:r)*(1+1*Math.max(0,Math.min(1,1-Math.sqrt(this.vx*this.vx+this.vy*this.vy)/(100*c))))/d);this.vx*=h,this.vy*=h;const f=2*c;f>Math.abs(this.vx)&&(this.vx=0),f>Math.abs(this.vy)&&o===ca.WEIGHTLESS&&(this.vy=0),0!==this.driftAx&&this.driftTime>this.age?this.vx+=this.driftAx*t/d:0!==this.driftAx&&(this.driftAx=0),e&&e(this,t),this.x+=this.vx*t,this.y+=this.vy*t,this.omega*=Math.max(0,1-da.SPIN_DAMP_PER_S*(1+.5*Math.max(0,Math.min(1,1-Math.abs(this.omega)/2)))*t),this.theta+=this.omega*t,.01>Math.abs(this.omega)&&(this.omega=0),this.ut?(this.squashAmount=0,this.squash=1):(this.squashAmount+=(0-this.squashAmount)*Math.min(1,da.SQUASH_DECAY_PER_S*t),this.squash=1-this.squashAmount)}updateSleepState(t,e){const n=Math.sqrt(this.vx*this.vx+this.vy*this.vy),o=Math.abs(this.omega),a=e.DPR||1,i=(Number.isFinite(e.sleepVelocityThreshold)?e.sleepVelocityThreshold:da.SLEEP_VELOCITY_THRESHOLD)*a,r=Number.isFinite(e.sleepAngularThreshold)?e.sleepAngularThreshold:da.SLEEP_ANGULAR_THRESHOLD,s=Number.isFinite(e.timeToSleep)?e.timeToSleep:da.TIME_TO_SLEEP;(this.isGrounded||this.hasSupport)&&i>n&&r>o?(this.sleepTimer+=t,s>this.sleepTimer||(this.vx=0,this.vy=0,this.omega=0,this.isSleeping=!0)):this.sleepTimer=0}wake(){this.isSleeping=!1,this.sleepTimer=0}walls(t,e,n,o,a={}){const i=!1!==a.registerEffects&&!this.lt,r=M(),{REST:s,MASS_BASELINE_KG:c,currentMode:l,DPR:u}=r,d=void 0!==o?o:s,h=r.wallWobbleImpactThreshold??da.WALL_REST_VEL_THRESHOLD,f=this.r*(1+(r.ballSpacing||0)),m="function"==typeof r.getCanvasCornerRadius?r.getCanvasCornerRadius():r.cornerRadius??r.wallRadius??0,p=Math.max(0,+m||0)*(u||1),b=Math.max(0,(r.wallThickness??0)*(u||1)),v=Math.max(0,r.wallInset??3)*(u||1),g=Math.max(1,t-2*b),w=Math.max(1,e-2*b);let y=!1;const x=l===ca.PIT,S=.5*g,k=.5*w,C=Math.max(0,Math.min(p,.5*g,.5*w)),T=this.x-(b+S),A=this.y-(b+k),L=Math.abs(T)-(S-C),F=Math.abs(A)-(k-C),P=Math.hypot(Math.max(L,0),Math.max(F,0))+Math.min(Math.max(L,F),0)-C;let I=0,D=0;if(L>0&&F>0){const t=Math.hypot(L,F);t>1e-6&&(I=L/t,D=F/t)}else L>F?(I=1,D=0):(I=0,D=1);I*=0>T?-1:1,D*=0>A?-1:1;const _=P+(f+v);if(!(0>=_||x&&-.5>D||l===ca.BUBBLES&&-.5>D)){y=!0;const e=this.vx*I+this.vy*D;this.x-=I*_,this.y-=D*_,e>0&&(this.vx-=(1+d)*e*I,this.vy-=(1+d)*e*D);const o=D>.7,a=Math.abs(e),s=Math.min(1,a/(80*this.r));if(o){this.isGrounded=!0;const t=Math.max(.25,this.m/c);this.vx*=Math.max(0,1-da.ROLL_FRICTION_PER_S*(1+Math.max(0,Math.min(1,1-Math.abs(this.vx)/(80*u))))*n/t),3*u>Math.abs(this.vx)&&(this.vx=0),this.omega+=(this.vx-this.omega*this.r)/this.r*da.SPIN_GAIN/t,this.omega+=(this.vx/this.r-this.omega)*Math.min(1,da.GROUND_COUPLING_PER_S*n),.05>Math.abs(this.omega)&&(this.omega=0)}if(this.ut||(this.squashAmount=Math.min(r.getSquashMax(),.8*s),this.squashNormalAngle=Math.atan2(-D,-I)),i){bt(this.r,.65*s,this.x/Math.max(1,t),this.Ot);const n=Math.max(0,e);if(!this.isSleeping&&n>=(!0===this.isMeteor?Math.max(20,.3*h):h)){const t=Math.max(.5,Math.min(4,.5+.5*Math.sqrt(this.m/c)));((t,e,n)=>{const o=M(),a=o.canvas;if(!a)return;const i="function"==typeof o.getCanvasCornerRadius?o.getCanvasCornerRadius():o.cornerRadius??o.wallRadius??0,r=Math.max(0,(+i||0)*(o.DPR||1)),s=Math.max(0,(+o.wallThickness||0)*(o.DPR||1)),c=Math.max(1,a.width-2*s),l=Math.max(1,a.height-2*s);bi.ringPhysics.ensureGeometry(c,l,Math.max(0,Math.min(r,.5*c,.5*l)));const u=t-s,d=e-s;if(64>bi.tt)bi.ringPhysics.impactAtPoint(u,d,n);else{const t=bi.ringPhysics.n;if(t>0){const e=bi.ringPhysics.tFromPoint(u,d);bi.ringPhysics.velocities[Math.round(((+e||0)%1+1)%1*t)%t]+=Math.max(0,o.wallWobbleMaxDeform??hi)*Math.max(0,Math.min(1,+n||0)),bi.ringPhysics._t=!0}}bi.tt++})(this.x-I*f,this.y-D*f,Math.min(1,Math.min(1,n/(80*this.r))*t))}const o=this.isSleeping?1:Math.max(0,(h-a)/h);o>.1&&((t,e,n=1)=>{const o=M(),a=o.canvas;if(!a)return;const i="function"==typeof o.getCanvasCornerRadius?o.getCanvasCornerRadius():o.cornerRadius??o.wallRadius??0,r=Math.max(0,(+i||0)*(o.DPR||1)),s=Math.max(0,(+o.wallThickness||0)*(o.DPR||1)),c=Math.max(1,a.width-2*s),l=Math.max(1,a.height-2*s);bi.ringPhysics.ensureGeometry(c,l,Math.max(0,Math.min(r,.5*c,.5*l))),bi.ringPhysics.addPressureAtPoint(t-s,e-s,n,{fast:bi.et>=256}),bi.et++})(this.x-I*f,this.y-D*f,o)}}y&&(this.isSleeping||!0===this.isMeteor)&&this.wake()}getDisplayRadius(){return this.r*(this.filterSizeMultiplier??1)}draw(t){const e=this.squashAmount>.01,n=this.alpha*(this.filterOpacity??1),o=1>n,a=this.getDisplayRadius();e||o?(t.save(),(e||o)&&(t.translate(this.x,this.y),e?(t.rotate(this.theta+this.squashNormalAngle),t.scale(1-.3*this.squashAmount,1+.3*this.squashAmount),t.rotate(-this.squashNormalAngle)):t.rotate(this.theta),o&&(t.globalAlpha=n),t.beginPath(),t.arc(0,0,a,0,2*Math.PI),t.fillStyle=this.color,t.fill()),t.restore()):(t.fillStyle=this.color,t.beginPath(),t.arc(this.x,this.y,a,0,2*Math.PI),t.fill())}}const wi=.2,yi=[];let xi,Si,ki=null,Ci="",Ti=da.DPR,Ai=0,Li=0,Fi=null,Pi=null,Ii=0,Di=0,_i=0;var Ei=Object.freeze({__proto__:null,getCanvas:Xt,getContext:Zt,resize:Yt,setForceRenderCallback:qt,setupRenderer:Ut});const Wi=new WeakMap,Ri=new WeakMap,Ni=new WeakMap,zi=new WeakMap,Oi=new WeakMap,Bi=2*Math.PI,Vi=1e-6;let Gi=0,$i=[],Hi=[],ji=[],qi=0,Ui=0,Yi=0,Xi=0,Zi=0,Ki=0,Qi=0,Ji=0;const tr=new WeakMap,er=new WeakMap,nr=new WeakMap,or=new WeakMap;let ar=[],ir=0,rr=0,sr=0,cr=0,lr=performance.now()/1e3,ur=0,dr=!0,hr=null;const fr=1e3/60;let mr=[],pr=0;var Mr=Object.freeze({__proto__:null,MODES:ca,getForceApplicator:je,getModeRenderer:Ue,getModeUpdater:qe,resetCurrentMode:He,setMode:$e});let br=null,vr=null,gr=null,wr=!0,yr=!1;const xr=new WeakMap;let Sr=!1;var kr=Object.freeze({__proto__:null,hideOverlay:on,initModalOverlay:Je,isOverlayActive:an,mountModalIntoOverlay:Xe,showOverlay:nn,unmountModalFromOverlay:Ze,updateBlurFromWallThickness:Qe,updateGateContentDelay(t){document.documentElement.style.setProperty("--modal-content-delay",t+"ms")},updateGateDepthScale(t){document.documentElement.style.setProperty("--modal-depth-scale",t),en(an())},updateGateDepthTranslateY(t){document.documentElement.style.setProperty("--modal-depth-translate-y",t+"px"),en(an())},updateLogoBlurActive(t){const e=document.documentElement;e.style.setProperty("--logo-blur-active-target",t+"px"),an()&&e.style.setProperty("--logo-blur-active",t+"px"),en(an())},updateLogoBlurInactive(t){const e=document.documentElement;e.style.setProperty("--logo-blur-inactive",t+"px"),an()||e.style.setProperty("--logo-blur-active",t+"px"),en(an())},updateOverlayBlur(t){br&&(void 0!==t?(Sr=!0,br.style.setProperty("--modal-overlay-blur",t+"px")):Qe())},updateOverlayOpacity(t){br&&br.style.setProperty("--modal-overlay-opacity",t)},updateOverlayTransition(t){br&&(br.style.setProperty("--modal-overlay-transition-duration",t+"ms"),document.documentElement.style.setProperty("--modal-depth-duration",t+"ms"),en(an()))},updateOverlayTransitionOut(t){br&&(br.style.setProperty("--modal-overlay-transition-out-duration",t+"ms"),document.documentElement.style.setProperty("--modal-depth-out-duration",t+"ms"),en(an()))}});const Cr=64;let Tr=0;const Ar=new Float32Array(Cr),Lr=new Float32Array(Cr),Fr=new Float32Array(Cr),Pr=new Float32Array(Cr),Ir=new Float32Array(Cr),Dr=new Float32Array(Cr),_r=new Float32Array(Cr),Er=new Float32Array(Cr),Wr=Array(Cr);let Rr=0,Nr=0;const zr="--abs-scene-impact",Or="--abs-scene-impact-dur",Br="--abs-scene-impact-logo-scale";let Vr=null,Gr=!1,$r=0,Hr=0,jr=0,qr=!1,Ur=0,Yr=0,Xr=0,Zr=0,Kr=0,Qr=0,Jr=0,ts=0,es=null,ns=!1,os=!1,as=null,is=0;const rs=100;let ss=!1,cs=null,ls=!1;const us="translate(-50%, -50%) scale(0)",ds="translate(-50%, -50%) scale(0.25)",hs="translate(-50%, -50%) scale(1)";var fs=Object.freeze({__proto__:null,getCursorColor:mn,hideCursor:vn,setupCustomCursor:pn,showCursor:gn,updateCursorPosition:bn,updateCursorSize:Mn});let ms=0,ps=null,Ms=null,bs=null,vs=0,gs=0,ws=!1,ys=0;const xs=da.PHYSICS_DT,Ss=da.PHYSICS_DT_MOBILE,ks=42,Cs=1800,Ts=1/60,As={map:new Map,arrays:[],arrayIndex:0};var Ls=Object.freeze({__proto__:null,getBalls:()=>M().balls||[],render:In,resetPhysicsAccumulator:Tn,syncChromeColor:Dn,updatePhysics:Pn});const Fs=(()=>{try{return{log:console.log?.bind(console)??(()=>{}),info:console.info?.bind(console)??(()=>{}),warn:console.warn?.bind(console)??(()=>{}),error:console.error?.bind(console)??(()=>{}),debug:console.debug?.bind(console)??(()=>{}),groupCollapsed:console.groupCollapsed?.bind(console)??(()=>{}),groupEnd:console.groupEnd?.bind(console)??(()=>{}),table:console.table?.bind(console)??(()=>{})}}catch(t){return{log(){},info(){},warn(){},error(){},debug(){},groupCollapsed(){},groupEnd(){},table(){}}}})();let Ps=null,Is=0,Ds="undefined"!=typeof performance&&performance.now?performance.now():Date.now(),_s=!1;const Es=["#b7bcb7","#d0d0d0","#ffffff","#00695c","#1a1a1a","#ff4013","#0d5cb6","#ffa000"],Ws=[.5,.25,.12,.06,.03,.02,.01,.01];let Rs=null,Ns=null;const zs="theme-preference-v2",Os="theme-preference";let Bs="auto",Vs="light",Gs=!1;var $s=Object.freeze({__proto__:null,getCurrentTheme:()=>Bs,initializeDarkMode:Un,setTheme:qn,toggleDarkMode:Yn});let Hs=!1,js=null,qs=null,Us=null,Ys=null,Xs=null,Zs=0,Ks=null,Qs=0,Js=null,tc="";const ec=["noiseEnabled","noiseSeed","noiseTextureSize","noiseDistribution","noiseMonochrome","noiseChroma","noiseMotion","noiseMotionAmount","noiseSpeedMs","noiseSpeedVariance","noiseFlicker","noiseFlickerSpeedMs","noiseBlurPx","noiseContrast","noiseBrightness","noiseSaturation","noiseHue","noiseSize","noiseOpacity","noiseOpacityLight","noiseOpacityDark","noiseBlendMode","noiseColorLight","noiseColorDark","detailNoiseOpacity"],nc=new Map,oc=new Map;var ac=Object.freeze({__proto__:null,saveConfigBulk:mo,syncConfigToFile:fo});let ic=null;const rc="abs_nav_state",sc="abs_nav_ts";"undefined"!=typeof window&&(window.addEventListener("pagereveal",t=>{t.viewTransition&&(lc=!0,console.log(" View Transition detected on pagereveal"),document.documentElement.classList.remove("entrance-pre-transition","entrance-transitioning"),document.documentElement.classList.add("entrance-complete"),["#app-frame","#abs-scene","#brand-logo","#main-links"].forEach(t=>{const e=document.querySelector(t);e&&(e.style.opacity="1",e.style.visibility="visible")}),document.querySelectorAll("#main-links .footer_link").forEach(t=>{t.style.opacity="1",t.style.transform="translateY(0) scale(1)",t.style.filter="blur(0)"}))}),window.addEventListener("pageswap",()=>{wo()}),window.addEventListener("pagehide",()=>{wo()}));const cc={INTERNAL:"internal",OPEN_CV_MODAL:"open_cv",OPEN_PORTFOLIO_MODAL:"open_portfolio",OPEN_CONTACT_MODAL:"open_contact"};let lc=!1;try{const t=sessionStorage.getItem(rc),e=parseInt(sessionStorage.getItem(sc)||"0",10),n=5e3>Date.now()-e,o="function"==typeof document.startViewTransition;t&&n&&o&&(lc=!0,console.log(" View Transition detected at module load"))}catch(kc){}let uc=!1;var dc=Object.freeze({__proto__:null,NAV_STATES:cc,didViewTransitionRun:()=>lc,getModalToAutoOpen(){try{const t=sessionStorage.getItem(rc);if(t===cc.OPEN_CV_MODAL)return"cv";if(t===cc.OPEN_PORTFOLIO_MODAL)return"portfolio";if(t===cc.OPEN_CONTACT_MODAL)return"contact"}catch(kc){}return null},getNavigationState:xo,initSpeculativePrefetch(){function t(t){const n=t.href||t.dataset.href;if(!n||e.has(n))return;if(!n.endsWith(".html")&&!n.includes("/"))return;const o=setTimeout(()=>{To(n),e.add(n)},100),a=()=>{clearTimeout(o),t.removeEventListener("mouseleave",a),t.removeEventListener("touchend",a),t.removeEventListener("blur",a)};t.addEventListener("mouseleave",a,{once:!0}),t.addEventListener("touchend",a,{once:!0}),t.addEventListener("blur",a,{once:!0})}const e=new Set,n=navigator.connection;n?.saveData?console.log(" Data saver enabled, skipping speculative prefetch"):(document.addEventListener("mouseenter",e=>{const n=e.target.closest("a[href], [data-href], [data-transition]");n&&t(n)},{capture:!0}),document.addEventListener("focusin",e=>{const n=e.target.closest("a[href], [data-href], [data-transition]");n&&t(n)}),document.addEventListener("touchstart",t=>{const n=t.target.closest("a[href], [data-href], [data-transition]");if(n){const t=n.href||n.dataset.href;t&&!e.has(t)&&(To(t),e.add(t))}},{passive:!0}),console.log(" Speculative prefetch initialized"))},isBackForwardNavigation:So,navigateWithTransition:ko,prefetchPage:To,resetTransitionState:Co,setNavigationState:yo,setupPrefetchOnHover:Ao,shouldSkipWallAnimation:()=>null!==xo()||So(),supportsViewTransitions:go});const hc=1700,fc='<i class="ti ti-volume-off" aria-hidden="true"></i>';let mc=null,pc=null,Mc=null;const bc=new Map([["apple music",'<i class="ti ti-brand-apple" aria-hidden="true"></i>'],["instagram",'<i class="ti ti-brand-instagram" aria-hidden="true"></i>'],["linkedin",'<i class="ti ti-brand-linkedin" aria-hidden="true"></i>'],["x",'<i class="ti ti-brand-x" aria-hidden="true"></i>']]);let vc=!1;const gc="abs-link-hovering",wc=['1em "Geist"','1em "Geist Mono"','1em "Sarina"','1em "tabler-icons"'];var yc=Object.freeze({__proto__:null,applyAspectRatioClass:Jo,applyPerspectiveCSS:ta,detectAspectRatioCategory:Qo,async orchestrateEntrance(t={}){const e=M(),n=!!t.skipWallAnimation,o=!!t.skipEntranceAnimation,a=t.centralContent||[],i=t.reducedMotion??!!window.matchMedia?.("(prefers-reduced-motion: reduce)")?.matches;if(Jo(),ta(),t.waitForFonts&&await t.waitForFonts(),o)return document.documentElement.classList.remove("entrance-pre-transition","entrance-transitioning"),document.documentElement.classList.add("entrance-complete"),aa(),void console.log(" Entrance skipped (View Transition handled animation)");if(i)return void(()=>{const t=document.getElementById("app-frame"),e=document.getElementById("brand-logo"),n=document.getElementById("main-links"),o=n?Array.from(n.querySelectorAll(".footer_link")):[],a=document.documentElement;a.classList.remove("entrance-pre-transition","entrance-transitioning"),a.classList.add("entrance-complete");const i=[t,e,n,...o].filter(Boolean);i.forEach(t=>{t.style.transition="opacity 200ms ease-out",t.style.opacity="0",t.style.visibility="visible"}),requestAnimationFrame(()=>{i.forEach(t=>{t.style.opacity="1"}),setTimeout(()=>{i.forEach(t=>{t.style.removeProperty("transition"),t.style.removeProperty("opacity"),t.style.removeProperty("filter"),t.style.removeProperty("transform")});const t=document.getElementById("fade-blocking");t&&t.remove()},250)})})();n?(document.documentElement.classList.remove("entrance-pre-transition","entrance-transitioning"),document.documentElement.classList.add("entrance-complete")):ea(),n||na();const r=e.entranceElementEasing??"cubic-bezier(0.16, 1, 0.3, 1)",s=e.contentFadeInDelay??500,c=e.contentFadeInDuration??1e3,l=e.entranceLateElementDuration??500,u=document.getElementById("abs-scene");if(u){const t=document.getElementById("fade-blocking");t&&t.remove(),u.style.opacity="0",u.style.visibility="visible",u.style.willChange="opacity",setTimeout(()=>{if("function"==typeof u.animate){const t=u.animate([{opacity:0},{opacity:1}],{duration:c,easing:r,fill:"forwards"});t.addEventListener("finish",()=>{u.style.opacity="1",u.style.willChange="auto"}),t.addEventListener("cancel",()=>{u.style.opacity="1",u.style.willChange="auto"})}else u.style.transition=`opacity ${c}ms ${r}`,requestAnimationFrame(()=>{u.style.opacity="1"})},s)}const d=s+.6*c,h=document.getElementById("brand-logo");h&&setTimeout(()=>{((t,e={})=>{new Promise(n=>{if(!t)return void n();const o=M(),a=e.duration??o.entranceLateElementDuration??600,i=e.easing??"cubic-bezier(0.16, 1, 0.3, 1)",r="calc(var(--abs-scene-impact-logo-scale, 1) * var(--brand-logo-user-scale, 1))",s=`translateY(calc(var(--brand-logo-offset-y) - var(--gap-xs))) scale(calc(${r} * 0.96))`,c=`translateY(var(--brand-logo-offset-y)) scale(${r})`;setTimeout(()=>{t.style.transition="none",t.style.visibility="visible",t.animate([{opacity:0,transform:s,filter:"blur(calc(var(--link-impact-blur) * 0.6))"},{opacity:1,transform:c,filter:"blur(0px)"}],{duration:a,easing:i,fill:"forwards"}).finished.then(()=>{t.style.opacity="1",t.style.filter="blur(0px)",requestAnimationFrame(()=>{requestAnimationFrame(()=>{t.style.removeProperty("transition"),t.style.removeProperty("transform"),t.style.removeProperty("filter"),n()})})}).catch(()=>{n()})},e.delay??0)})})(h,{delay:0,duration:l,easing:r})},d);const f=[];for(const M of a){const t="string"==typeof M?document.querySelector(M):M;t&&f.push(t)}const m=d+.5*l;for(let M=0;f.length>M;M++){const t=f[M];setTimeout(()=>{oa(t,{delay:0,duration:l,easing:r})},m+150*M)}const p=d+.35*l,b=document.getElementById("main-links");b&&(b.classList.add("main-links--staggered"),setTimeout(()=>{b.style.transition="none",b.style.visibility="visible",b.style.opacity="1",b.classList.add("main-links--staggered-in"),requestAnimationFrame(()=>{b.style.removeProperty("transition")}),setTimeout(()=>{b.querySelectorAll(".footer_link").forEach(t=>{t.style.opacity="1",t.style.transform="translateY(0) scale(1)",t.style.filter="blur(0)"}),b.classList.remove("main-links--staggered","main-links--staggered-in")},1300)},p))},revealAllLateElements:aa,revealLateElement:oa,setInitialBrowserDefaultState:ea,transitionToWallState:na});const xc={core:{title:"Core",controls:[{id:"masterGain",label:"Master Volume",min:10,max:100,step:1,format:t=>Math.round(t)+"%",toConfig:t=>t/100,fromConfig:t=>100*t},{id:"collisionMinImpact",label:"Silence Threshold",min:20,max:85,step:1,format:t=>Math.round(t)+"%",toConfig:t=>t/100,fromConfig:t=>100*t}]},envelope:{title:"Envelope",controls:[{id:"decayTime",label:"Click Length",min:20,max:180,step:1,format:t=>Math.round(t)+"ms",toConfig:t=>t/1e3,fromConfig:t=>1e3*t}]},tone:{title:"Tone",controls:[{id:"filterBaseFreq",label:"Brightness",min:300,max:6e3,step:50,format:t=>Math.round(t)+"Hz",toConfig:t=>t,fromConfig:t=>t},{id:"harmonicGain",label:"Warmth",min:0,max:50,step:1,format:t=>Math.round(t)+"%",toConfig:t=>t/100,fromConfig:t=>100*t},{id:"filterQ",label:"Resonance",min:10,max:200,step:5,format:t=>""+(t/100).toFixed(2),toConfig:t=>t/100,fromConfig:t=>100*t}]},crystal:{title:"Crystal",controls:[{id:"pitchMinHz",label:"Pitch Low",min:80,max:1200,step:10,format:t=>Math.round(t)+"Hz",toConfig:t=>t,fromConfig:t=>t},{id:"pitchMaxHz",label:"Pitch High",min:200,max:4e3,step:20,format:t=>Math.round(t)+"Hz",toConfig:t=>t,fromConfig:t=>t},{id:"pitchCurve",label:"Pitch Curve",min:70,max:160,step:1,format:t=>(t/100).toFixed(2)+"",toConfig:t=>t/100,fromConfig:t=>100*t},{id:"sparkleGain",label:"Sparkle",min:0,max:35,step:1,format:t=>Math.round(t)+"%",toConfig:t=>t/100,fromConfig:t=>100*t},{id:"sparkleRatioMin",label:"Sparkle Min",min:120,max:600,step:10,format:t=>(t/100).toFixed(2)+"",toConfig:t=>t/100,fromConfig:t=>100*t},{id:"sparkleRatioMax",label:"Sparkle Max",min:160,max:800,step:10,format:t=>(t/100).toFixed(2)+"",toConfig:t=>t/100,fromConfig:t=>100*t},{id:"sparkleDecayMul",label:"Sparkle Decay",min:20,max:95,step:1,format:t=>Math.round(t)+"%",toConfig:t=>t/100,fromConfig:t=>100*t},{id:"noiseTransientQ",label:"Sparkle Q",min:60,max:600,step:5,format:t=>""+(t/100).toFixed(2),toConfig:t=>t/100,fromConfig:t=>100*t}]},space:{title:"Space",controls:[{id:"reverbWetMix",label:"Reverb Mix",min:0,max:50,step:1,format:t=>Math.round(t)+"%",toConfig:t=>t/100,fromConfig:t=>100*t},{id:"reverbDecay",label:"Room Size",min:5,max:80,step:1,format:t=>(t/100).toFixed(2)+"s",toConfig:t=>t/100,fromConfig:t=>100*t}]},dynamics:{title:"Dynamics",controls:[{id:"minGain",label:"Min Hit Volume",min:0,max:20,step:1,format:t=>Math.round(t)+"%",toConfig:t=>t/100,fromConfig:t=>100*t},{id:"maxGain",label:"Max Hit Volume",min:5,max:50,step:1,format:t=>Math.round(t)+"%",toConfig:t=>t/100,fromConfig:t=>100*t}]},realism:{title:"Realism",controls:[{id:"noiseTransientGain",label:"Impact Snap",min:0,max:80,step:1,format:t=>Math.round(t)+"%",toConfig:t=>t/100,fromConfig:t=>100*t},{id:"varianceGain",label:"Volume Variance",min:0,max:50,step:1,format:t=>`${Math.round(t)}%`,toConfig:t=>t/100,fromConfig:t=>100*t},{id:"variancePitch",label:"Pitch Variance",min:0,max:25,step:1,format:t=>`${Math.round(t)}%`,toConfig:t=>t/100,fromConfig:t=>100*t},{id:"velocityNoiseScale",label:"Hard Hit Crack",min:100,max:500,step:10,format:t=>(t/100).toFixed(1)+"",toConfig:t=>t/100,fromConfig:t=>100*t}]}};var Sc=Object.freeze({__proto__:null,async animateDeparture(t={}){const e=t.duration??300,n=t.easing??"cubic-bezier(0.16, 1, 0.3, 1)";if(window.matchMedia?.("(prefers-reduced-motion: reduce)")?.matches)return Promise.resolve();const o=["#expertise-legend",".decorative-script",".portfolio-stage","#portfolioMeta",".cv-scroll-container","#bravia-balls canvas",".ui-top",".ui-bottom","#main-links"].map(t=>document.querySelector(t)).filter(Boolean);if(0===o.length)return Promise.resolve();const a=o.map(t=>t.animate([{opacity:1,transform:"scale(1) translateZ(0)",filter:"blur(0)"},{opacity:0,transform:"scale(0.95) translateZ(-30px)",filter:"blur(4px)"}],{duration:e,easing:n,fill:"forwards"}));await Promise.all(a.map(t=>t.finished))}});export{ko as $,Un as A,Je as B,Fo as C,Io as D,Do as E,zo as F,Oo as G,_o as H,Y as I,Ge as J,Vn as K,Gn as L,ca as M,la as N,zn as O,Wn as P,Rn as Q,Uo as R,Zt as S,vo as T,qt as U,In as V,je as W,Xo as X,Zo as Y,Ko as Z,Yo as _,jo as a,cc as a0,Co as a1,Ao as a2,nt as a3,ht as a4,ft as a5,mt as a6,pt as a7,dt as a8,a as a9,Pt as aA,bi as aB,ha as aC,ua as aD,J as aE,Ma as aF,La as aG,Ei as aH,Mr as aI,kr as aJ,fs as aK,Ls as aL,$s as aM,ac as aN,dc as aO,yc as aP,It as aa,Q as ab,w as ac,Rt as ad,Gt as ae,Tt as af,St as ag,ia as ah,mo as ai,vt as aj,Ct as ak,Da as al,sa as am,kt as an,xt as ao,rt as ap,yt as aq,ra as ar,ja as as,s as at,f as au,Mt as av,fa as aw,co as ax,ho as ay,fo as az,Nn as b,On as c,qo as d,p as e,m as f,M as g,so as h,_n as i,Ut as j,Xt as k,bo as l,Bn as m,v as n,Yt as o,bt as p,fn as q,He as r,$e as s,pn as t,$o as u,hn as v,uo as w,tt as x,at as y,it as z};