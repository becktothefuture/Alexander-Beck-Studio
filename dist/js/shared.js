function e(e,t=""){const a=(e+"").startsWith("--")?e:"--"+e,n=(()=>{try{if("undefined"==typeof window)return null;const e=window.__TOKENS__;return e&&"object"==typeof e?e:null}catch(e){return null}})(),o=(e=>{try{return"undefined"==typeof document?"":getComputedStyle(document.documentElement).getPropertyValue(e).trim()}catch(t){return""}})(a);if(o&&!o.includes("var("))return o;if(n){const e=((e,t)=>{const a=(e||"")+"";if(!a.includes("var("))return a.trim();if(!t)return a.trim();const n=/var\((--[a-z0-9-_]+)(?:\s*,\s*([^)]+))?\)/gi;let o=a,i=0;for(;o.includes("var(")&&8>i;)o=o.replace(n,(e,a,n)=>{const o=t.resolved?.[a]??t.cssVars?.[a];return null!=o?(o+"").trim():n?(n+"").trim():""}),i+=1;return o.trim()})(n.resolved?.[a]??n.cssVars?.[a]??o,n);if(e&&!e.includes("var("))return e}return o&&!o.includes("var(")?o:t}function t(t,a){const n=e(t,""),o=parseFloat(n);return Number.isFinite(o)?o:a}function a(t,a){const n=e(t,"");if(!n)return a;const o=parseFloat((n+"").replace(/px$/i,""));return Number.isFinite(o)?o:a}function n(t,a){const n=e(t,"");if(!n)return a;const o=(n+"").trim().toLowerCase(),i=parseFloat(o);return Number.isFinite(i)?o.endsWith("ms")?i:o.endsWith("s")?1e3*i:i:a}function o(e){go=e}function i(e,t,a,n){const o=+e;return Number.isFinite(o)?Math.min(a,Math.max(t,o)):n}function r(e,t,a,n){const o=i(e,t,a,n);return Math.round(o)}function l(){const e=+bo.layoutViewportWidthPx;return Number.isFinite(e)&&e>0?e:Math.max(1,window.innerWidth||1)}function s(){try{const e=window.visualViewport;if(e&&"number"==typeof e.height&&e.height>0)return Math.max(1,e.height)}catch(e){}return Math.max(1,window.innerHeight||1)}function d(){return l()*s()}function c(e=64e4){const t=d();return t>0&&e>0?t/e:1}function u(e,t){const a=Math.max(1,t||l()),n=+e;return Number.isFinite(n)?n/a*100:0}function p(e,t){const a=Math.max(1,t||l()),n=+e;return Number.isFinite(n)?n/100*a:0}function m(){const e=l(),t=s(),a=Number.isFinite(bo.wallThicknessVw)&&bo.wallThicknessVw>0?bo.wallThicknessVw:0,n=a>0?a:Number.isFinite(bo.containerBorderVw)?bo.containerBorderVw:0;bo.containerBorderVw=n;const o=p(n,e),i=p(bo.simulationPaddingVw,e),r=p(bo.wallRadiusVw,e),d=Math.max(0,Math.round(bo.layoutMinWallRadiusPx||0)),u=p(a>0?a:n,e)*(1+(c()-1)*(Number.isFinite(bo.wallThicknessAreaMultiplier)&&bo.wallThicknessAreaMultiplier>=0?bo.wallThicknessAreaMultiplier:0)),m=bo.isMobile||bo.isMobileViewport,h=m?Math.max(.5,bo.mobileWallThicknessXFactor||1):1,f=m?1:Math.max(.5,bo.desktopWallThicknessFactor||1);bo.containerBorder=Math.round(o*f),bo.containerBorderX=Math.round(o*h),bo.simulationPadding=Math.round(i);const g=u*(m?h:f);bo.wallThickness=Math.round(Math.max(Number.isFinite(bo.wallThicknessMinPx)?bo.wallThicknessMinPx:0,Math.min(Number.isFinite(bo.wallThicknessMaxPx)&&bo.wallThicknessMaxPx>0?bo.wallThicknessMaxPx:1/0,g)));const b=Math.max(1,Math.sqrt(e*t)),y=Number.isFinite(bo.contentPaddingRatio)?bo.contentPaddingRatio:0;bo.contentPadding=Math.round(bo.wallThickness+b*(Math.abs(y)>1?y/b:y));const v=Math.max(.1,bo.contentPaddingHorizontalRatio||1);bo.contentPaddingY=bo.contentPadding,bo.contentPaddingX=Math.round(bo.contentPadding*v),bo.wallRadius=Math.max(d,Math.round(r)),bo.cornerRadius=bo.wallRadius;const w=Math.max(0,p(bo.cursorInfluenceRadiusVw||0,e));bo.cursorInfluenceRadiusPx=Math.round(w),bo.repelRadius=Math.round(w),bo.weightlessRepelRadius=Math.round(w),bo.bubblesDeflectRadius=Math.round(w);const x=Math.max(0,p(bo.particleFountainMouseRepelRadiusVw??5,e));bo.particleFountainMouseRepelRadius=Math.round(x)}function h(){const e=document.documentElement,t=bo.isMobile||bo.isMobileViewport,a=t?Math.max(.5,bo.mobileWallThicknessXFactor||1):1,n=t?1:Math.max(.5,bo.desktopWallThicknessFactor||1);e.style.setProperty("--container-border",bo.containerBorder+"px"),e.style.setProperty("--container-border-x",bo.containerBorderX+"px"),e.style.setProperty("--container-border-y",bo.containerBorder+"px"),e.style.setProperty("--simulation-padding",bo.simulationPadding+"px"),e.style.setProperty("--content-padding",bo.contentPadding+"px"),e.style.setProperty("--content-padding-x",bo.contentPaddingX+"px"),e.style.setProperty("--content-padding-y",bo.contentPaddingY+"px"),e.style.setProperty("--wall-radius",bo.wallRadius+"px"),e.style.setProperty("--wall-thickness",bo.wallThickness+"px");try{const t=l(),a=s(),n=Math.max(0,t*a),o=Math.sqrt(n);e.style.setProperty("--layout-viewport-area-px",Math.round(n)+""),e.style.setProperty("--layout-viewport-size-px",Math.round(o)+"px")}catch(h){}const o=bo.containerBorderVw||1.3;e.style.setProperty("--container-border-vw",""+o*n),e.style.setProperty("--container-border-x-vw",""+o*a),e.style.setProperty("--wall-thickness-vw",""+(Number.isFinite(bo.wallThicknessVw)&&bo.wallThicknessVw>0?bo.wallThicknessVw:bo.containerBorderVw)*(t?a:n)),e.style.setProperty("--edge-label-inset-adjust",(bo.edgeLabelInsetAdjustPx||0)+"px");const i=Number.isFinite(bo.edgeCaptionDistanceMinPx)?bo.edgeCaptionDistanceMinPx:8,r=Number.isFinite(bo.edgeCaptionDistanceMaxPx)?bo.edgeCaptionDistanceMaxPx:48;e.style.setProperty("--edge-caption-distance-min",Math.max(0,i)+"px"),e.style.setProperty("--edge-caption-distance-max",Math.max(i,r)+"px"),e.style.setProperty("--simulation-overlay-intensity",(Number.isFinite(bo.simulationOverlayIntensity)?Math.max(0,Math.min(1,bo.simulationOverlayIntensity)):1)+"");const d=bo.wallThickness+bo.contentPadding;e.style.setProperty("--edge-inset",d+"px"),e.style.setProperty("--edge-inset-lg",d+"px"),t?e.style.setProperty("--edge-label-mobile-display",bo.mobileEdgeLabelsVisible?"flex":"none"):e.style.removeProperty("--edge-label-mobile-display"),e.style.setProperty("--ui-hit-area-mul",(bo.uiHitAreaMul??1)+""),e.style.setProperty("--ui-icon-corner-radius-mul",(bo.uiIconCornerRadiusMul??.5)+""),Number.isFinite(bo.uiIconFramePx)&&bo.uiIconFramePx>0?e.style.setProperty("--ui-icon-frame-size",Math.round(bo.uiIconFramePx)+"px"):e.style.removeProperty("--ui-icon-frame-size"),Number.isFinite(bo.uiIconGlyphPx)&&bo.uiIconGlyphPx>0?e.style.setProperty("--ui-icon-glyph-size",Math.round(bo.uiIconGlyphPx)+"px"):e.style.removeProperty("--ui-icon-glyph-size"),Number.isFinite(bo.uiIconGroupMarginPx)&&0!==bo.uiIconGroupMarginPx?e.style.setProperty("--ui-icon-group-margin",Math.round(bo.uiIconGroupMarginPx)+"px"):e.style.removeProperty("--ui-icon-group-margin"),e.style.setProperty("--hover-edge-enabled",bo.hoverEdgeEnabled?"1":"0"),e.style.setProperty("--hover-edge-width",(bo.hoverEdgeWidth??1)+"px"),e.style.setProperty("--hover-edge-inset",(bo.hoverEdgeInset??0)+"px"),e.style.setProperty("--hover-edge-bottom-enabled",bo.hoverEdgeBottomEnabled?"1":"0"),e.style.setProperty("--hover-edge-bottom-radius",(bo.hoverEdgeBottomRadius??1.2)+""),e.style.setProperty("--hover-edge-bottom-opacity",(bo.hoverEdgeBottomOpacity??.6)+""),e.style.setProperty("--hover-edge-bottom-color-mix",(bo.hoverEdgeBottomColorMix??70)+"%"),e.style.setProperty("--hover-edge-top-enabled",bo.hoverEdgeTopEnabled?"1":"0"),e.style.setProperty("--hover-edge-top-radius",(bo.hoverEdgeTopRadius??1)+""),e.style.setProperty("--hover-edge-top-opacity",(bo.hoverEdgeTopOpacity??.3)+""),e.style.setProperty("--hover-edge-top-color-mix",(bo.hoverEdgeTopColorMix??50)+"%");const c=document.body.classList.contains("dark-mode");e.style.setProperty("--outer-wall-radius-adjust",(bo.outerWallRadiusAdjust??2)+"px"),e.style.setProperty("--outer-wall-top-dark-offset",(bo.outerWallTopDarkOffset??1)+"px"),e.style.setProperty("--outer-wall-top-dark-blur",(bo.outerWallTopDarkBlur??3)+"px"),e.style.setProperty("--outer-wall-top-dark-spread",(bo.outerWallTopDarkSpread??0)+"px"),e.style.setProperty("--outer-wall-top-dark-opacity",(c?bo.outerWallTopDarkOpacityDark??.4:bo.outerWallTopDarkOpacityLight??.6)+""),e.style.setProperty("--outer-wall-bottom-light-offset",(bo.outerWallBottomLightOffset??.5)+"px"),e.style.setProperty("--outer-wall-bottom-light-blur",(bo.outerWallBottomLightBlur??0)+"px"),e.style.setProperty("--outer-wall-bottom-light-spread",(bo.outerWallBottomLightSpread??0)+"px"),e.style.setProperty("--outer-wall-bottom-light-opacity",(c?bo.outerWallBottomLightOpacityDark??.3:bo.outerWallBottomLightOpacityLight??.5)+""),e.style.setProperty("--outer-wall-cast-shadow-offset",(bo.outerWallCastShadowOffset??3)+"px"),e.style.setProperty("--outer-wall-cast-shadow-blur",(bo.outerWallCastShadowBlur??12)+"px"),e.style.setProperty("--outer-wall-cast-shadow-spread",(bo.outerWallCastShadowSpread??0)+"px"),e.style.setProperty("--outer-wall-cast-shadow-opacity",(c?bo.outerWallCastShadowOpacityDark??.25:bo.outerWallCastShadowOpacityLight??.15)+"");const u=bo.innerWallOutwardShadowBlur??8,p=bo.innerWallOutwardShadowSpread??2;if(e.style.setProperty("--inner-wall-outward-shadow-offset",Math.max(0,Math.min(bo.innerWallOutwardShadowOffset??2,Math.max(0,bo.wallThickness-p)))+"px"),e.style.setProperty("--inner-wall-outward-shadow-blur",u+"px"),e.style.setProperty("--inner-wall-outward-shadow-spread",p+"px"),e.style.setProperty("--inner-wall-outward-shadow-opacity",(c?bo.innerWallOutwardShadowOpacityDark??.35:bo.innerWallOutwardShadowOpacityLight??.2)+""),e.style.setProperty("--inner-wall-outward-shadow-opacity-dark",(bo.innerWallOutwardShadowOpacityDark??.35)+""),e.style.setProperty("--inner-wall-inner-glow-blur",(bo.innerWallInnerGlowBlur??25)+"px"),e.style.setProperty("--inner-wall-inner-glow-spread",(bo.innerWallInnerGlowSpread??3)+"px"),e.style.setProperty("--inner-wall-inner-glow-offset-y",(bo.innerWallInnerGlowOffsetY??12)+"px"),e.style.setProperty("--inner-wall-inner-glow-opacity",(c?bo.innerWallInnerGlowOpacityDark??.08:bo.innerWallInnerGlowOpacityLight??0)+""),e.style.setProperty("--inner-wall-inner-glow-opacity-dark",(bo.innerWallInnerGlowOpacityDark??.08)+""),bo.innerWallInnerGlowColor){const t=(e=>{if(!e)return"255, 255, 255";3===(e=e.replace(/^#/,"")).length&&(e=e[0]+e[0]+e[1]+e[1]+e[2]+e[2]);const t=parseInt(e,16);return`${t>>16&255}, ${t>>8&255}, ${255&t}`})(bo.innerWallInnerGlowColor);e.style.setProperty("--inner-wall-inner-glow-rgb",t)}e.style.setProperty("--outer-wall-top-bevel-width",(bo.outerWallTopBevelWidth??3)+"px"),e.style.setProperty("--outer-wall-top-bevel-opacity",(c?bo.outerWallTopBevelOpacityDark??.35:bo.outerWallTopBevelOpacityLight??.25)+""),e.style.setProperty("--inner-wall-top-bevel-width",(bo.innerWallTopBevelWidth??2)+"px"),e.style.setProperty("--inner-wall-top-light-opacity",(c?bo.innerWallTopLightOpacityDark??.4:bo.innerWallTopLightOpacityLight??.3)+""),e.style.setProperty("--inner-wall-bottom-bevel-width",(bo.innerWallBottomBevelWidth??2)+"px"),e.style.setProperty("--inner-wall-top-bevel-opacity",(c?bo.innerWallTopBevelOpacityDark??.25:bo.innerWallTopBevelOpacityLight??.18)+"");const m=document.getElementById("bravia-balls");m&&m.classList.toggle("outer-wall-edge-disabled",!bo.outerWallEdgeEnabled)}function f(n){if(bo.config={...n},void 0!==n.layoutViewportWidthPx&&(bo.layoutViewportWidthPx=i(n.layoutViewportWidthPx,0,4096,0)),n.ballMass&&(bo.ballMassKg=n.ballMass),void 0!==n.gravityMultiplier&&(bo.gravityMultiplier=n.gravityMultiplier,bo.gravityMultiplierPit=n.gravityMultiplier),n.restitution&&(bo.REST=n.restitution),n.friction&&(bo.FRICTION=n.friction),void 0!==n.ballScale&&(bo.sizeScale=n.ballScale),void 0!==n.sizeScale&&(bo.sizeScale=n.sizeScale),void 0!==n.sizeVariationGlobalMul&&(bo.sizeVariationGlobalMul=i(n.sizeVariationGlobalMul,0,2,bo.sizeVariationGlobalMul)),void 0!==n.sizeVariationCap&&(bo.sizeVariationCap=i(n.sizeVariationCap,0,.2,bo.sizeVariationCap)),void 0!==n.sizeVariationPit&&(bo.sizeVariationPit=i(n.sizeVariationPit,0,1,bo.sizeVariationPit)),void 0!==n.sizeVariationFlies&&(bo.sizeVariationFlies=i(n.sizeVariationFlies,0,1,bo.sizeVariationFlies)),void 0!==n.sizeVariationWeightless&&(bo.sizeVariationWeightless=i(n.sizeVariationWeightless,0,1,bo.sizeVariationWeightless)),void 0!==n.sizeVariationWater&&(bo.sizeVariationWater=i(n.sizeVariationWater,0,1,bo.sizeVariationWater)),void 0!==n.sizeVariationMagnetic&&(bo.sizeVariationMagnetic=i(n.sizeVariationMagnetic,0,1,bo.sizeVariationMagnetic)),void 0!==n.sizeVariationBubbles&&(bo.sizeVariationBubbles=i(n.sizeVariationBubbles,0,1,bo.sizeVariationBubbles)),void 0!==n.sizeVariationKaleidoscope&&(bo.sizeVariationKaleidoscope=i(n.sizeVariationKaleidoscope,0,1,bo.sizeVariationKaleidoscope)),void 0!==n.sizeVariationCritters&&(bo.sizeVariationCritters=i(n.sizeVariationCritters,0,1,bo.sizeVariationCritters)),void 0!==n.sizeVariationParallaxLinear&&(bo.sizeVariationParallaxLinear=i(n.sizeVariationParallaxLinear,0,1,bo.sizeVariationParallaxLinear)),void 0!==n.sizeVariation&&(bo.sizeVariation=n.sizeVariation),Array.isArray(n.colorDistribution)){const e=n.colorDistribution,t=Array.isArray(bo.colorDistribution)?bo.colorDistribution:[],a=[];for(let n=0;7>n;n++){const o=t[n]||{},i=e[n]||{};let l="string"==typeof i.label&&i.label.trim()?i.label.trim():"string"==typeof o.label?o.label:"Discipline "+(n+1);"frontend craft"===(l+"").trim().toLowerCase()&&(l="Art & Visual Direction");const s=r(i.colorIndex,0,7,r(o.colorIndex,0,7,0)),d=r(i.weight,0,100,r(o.weight,0,100,0));a.push({label:l,colorIndex:s,weight:d})}bo.colorDistribution=a}void 0!==n.pitWarmupFrames&&(bo.pitWarmupFrames=r(n.pitWarmupFrames,0,240,bo.pitWarmupFrames)),void 0!==n.fliesWarmupFrames&&(bo.fliesWarmupFrames=r(n.fliesWarmupFrames,0,240,bo.fliesWarmupFrames)),void 0!==n.weightlessWarmupFrames&&(bo.weightlessWarmupFrames=r(n.weightlessWarmupFrames,0,240,bo.weightlessWarmupFrames)),void 0!==n.waterWarmupFrames&&(bo.waterWarmupFrames=r(n.waterWarmupFrames,0,240,bo.waterWarmupFrames)),void 0!==n.magneticWarmupFrames&&(bo.magneticWarmupFrames=r(n.magneticWarmupFrames,0,240,bo.magneticWarmupFrames)),void 0!==n.bubblesWarmupFrames&&(bo.bubblesWarmupFrames=r(n.bubblesWarmupFrames,0,240,bo.bubblesWarmupFrames)),void 0!==n.kaleidoscope3WarmupFrames&&(bo.kaleidoscope3WarmupFrames=r(n.kaleidoscope3WarmupFrames,0,240,bo.kaleidoscope3WarmupFrames)),void 0!==n.crittersWarmupFrames&&(bo.crittersWarmupFrames=r(n.crittersWarmupFrames,0,240,bo.crittersWarmupFrames)),void 0!==n.parallaxLinearWarmupFrames&&(bo.parallaxLinearWarmupFrames=r(n.parallaxLinearWarmupFrames,0,240,bo.parallaxLinearWarmupFrames)),void 0!==n.elasticCenterWarmupFrames&&(bo.elasticCenterWarmupFrames=r(n.elasticCenterWarmupFrames,0,240,bo.elasticCenterWarmupFrames)),void 0!==n.maxBalls&&(bo.maxBalls=n.maxBalls),void 0!==n.repelRadius&&(bo.repelRadius=n.repelRadius),void 0!==n.repelPower&&(bo.repelPower=n.repelPower),void 0!==n.repelSoft&&(bo.repelSoft=n.repelSoft),void 0!==n.repelSoftness&&(bo.repelSoft=n.repelSoftness),void 0!==n.cursorInfluenceRadiusVw?bo.cursorInfluenceRadiusVw=i(n.cursorInfluenceRadiusVw,0,80,bo.cursorInfluenceRadiusVw):void 0!==n.repelRadius&&(bo.cursorInfluenceRadiusVw=i(n.repelRadius/10,0,80,bo.cursorInfluenceRadiusVw)),void 0!==n.ballSizeMin&&(bo.ballSizeMin=i(n.ballSizeMin,1,100,bo.ballSizeMin)),void 0!==n.ballSizeMax&&(bo.ballSizeMax=i(n.ballSizeMax,1,100,bo.ballSizeMax)),void 0!==n.ballSizeBreakpointMin&&(bo.ballSizeBreakpointMin=i(n.ballSizeBreakpointMin,100,2e3,bo.ballSizeBreakpointMin)),void 0!==n.ballSizeBreakpointMax&&(bo.ballSizeBreakpointMax=i(n.ballSizeBreakpointMax,500,4e3,bo.ballSizeBreakpointMax)),void 0!==n.ballSizeCurve&&(bo.ballSizeCurve=i(n.ballSizeCurve,.1,5,bo.ballSizeCurve)),void 0!==n.ballSizeDesktop&&void 0===n.ballSizeMin&&(bo.ballSizeMax=n.ballSizeDesktop),void 0!==n.ballSizeMobile&&void 0===n.ballSizeMin&&(bo.ballSizeMin=n.ballSizeMobile),void 0!==n.liteModeEnabled&&(bo.liteModeEnabled=!!n.liteModeEnabled),void 0!==n.liteModeObjectReductionFactor&&(bo.liteModeObjectReductionFactor=i(n.liteModeObjectReductionFactor,0,1,bo.liteModeObjectReductionFactor)),void 0!==n.mobileObjectReductionFactor&&(bo.mobileObjectReductionFactor=i(n.mobileObjectReductionFactor,0,1,bo.mobileObjectReductionFactor)),void 0!==n.mobileObjectReductionThreshold&&(bo.mobileObjectReductionThreshold=r(n.mobileObjectReductionThreshold,0,1e4,bo.mobileObjectReductionThreshold));const o=n.featureFlags&&"object"==typeof n.featureFlags?n.featureFlags:null,s=(e,t)=>void 0!==n[e]?!!n[e]:o&&void 0!==o[e]?!!o[e]:t;if(bo.featureRenderSchedulerEnabled=s("featureRenderSchedulerEnabled",bo.featureRenderSchedulerEnabled),bo.featureLazyModeLoadingEnabled=s("featureLazyModeLoadingEnabled",bo.featureLazyModeLoadingEnabled),bo.featureQualityTieringEnabled=s("featureQualityTieringEnabled",bo.featureQualityTieringEnabled),bo.featureCrittersNeighborCacheEnabled=s("featureCrittersNeighborCacheEnabled",bo.featureCrittersNeighborCacheEnabled),void 0!==n.performanceModeEnabled&&(bo.performanceModeEnabled=!!n.performanceModeEnabled),void 0!==n.performanceHudEnabled&&(bo.performanceHudEnabled=!!n.performanceHudEnabled),void 0!==n.renderTargetFpsDesktop&&(bo.renderTargetFpsDesktop=r(n.renderTargetFpsDesktop,30,60,bo.renderTargetFpsDesktop)),void 0!==n.renderTargetFpsMobile&&(bo.renderTargetFpsMobile=r(n.renderTargetFpsMobile,30,60,bo.renderTargetFpsMobile)),void 0!==n.renderTargetFpsReducedMotion&&(bo.renderTargetFpsReducedMotion=r(n.renderTargetFpsReducedMotion,30,60,bo.renderTargetFpsReducedMotion)),void 0!==n.renderQualityTier){const e=(n.renderQualityTier+"").toLowerCase();"auto"!==e&&"high"!==e&&"balanced"!==e&&"medium"!==e&&"low"!==e||(bo.renderQualityTier="medium"===e?"balanced":e)}if(n.modePerformanceBudgets&&"object"==typeof n.modePerformanceBudgets){const e={...bo.modePerformanceBudgets||{}},t=Object.entries(n.modePerformanceBudgets);for(let a=0;t.length>a;a++){const[n,o]=t[a];if(!o||"object"!=typeof o)continue;const i=e[n]||{},l=r(o.desktop,1,1e4,r(i.desktop,1,1e4,1e3)),s=r(o.mobile,1,1e4,r(i.mobile,1,1e4,l));e[n]={desktop:l,mobile:s}}bo.modePerformanceBudgets=e}if(M(),S(),void 0!==n.kaleidoscopeBallCount&&(bo.kaleidoscopeBallCount=i(n.kaleidoscopeBallCount,10,300,bo.kaleidoscopeBallCount)),void 0!==n.kaleidoscopeDotSizeVh&&(bo.kaleidoscopeDotSizeVh=i(n.kaleidoscopeDotSizeVh,.1,6,bo.kaleidoscopeDotSizeVh)),void 0!==n.kaleidoscopeDotAreaMul&&(bo.kaleidoscopeDotAreaMul=i(n.kaleidoscopeDotAreaMul,.1,2,bo.kaleidoscopeDotAreaMul)),void 0!==n.kaleidoscopeSpawnAreaMul&&(bo.kaleidoscopeSpawnAreaMul=i(n.kaleidoscopeSpawnAreaMul,.2,2,bo.kaleidoscopeSpawnAreaMul)),void 0!==n.kaleidoscopeSizeVariance&&(bo.kaleidoscopeSizeVariance=i(n.kaleidoscopeSizeVariance,0,1,bo.kaleidoscopeSizeVariance)),void 0!==n.kaleidoscope3BallCount&&(bo.kaleidoscope3BallCount=i(n.kaleidoscope3BallCount,3,300,bo.kaleidoscope3BallCount)),void 0!==n.kaleidoscope3Wedges&&(bo.kaleidoscope3Wedges=i(n.kaleidoscope3Wedges,3,24,bo.kaleidoscope3Wedges)),void 0!==n.kaleidoscope3Speed&&(bo.kaleidoscope3Speed=i(n.kaleidoscope3Speed,.2,2,bo.kaleidoscope3Speed)),void 0!==n.kaleidoscope3DotSizeVh&&(bo.kaleidoscope3DotSizeVh=i(n.kaleidoscope3DotSizeVh,.1,6,bo.kaleidoscope3DotSizeVh)),void 0!==n.kaleidoscope3DotAreaMul&&(bo.kaleidoscope3DotAreaMul=i(n.kaleidoscope3DotAreaMul,.1,2,bo.kaleidoscope3DotAreaMul)),void 0!==n.kaleidoscope3SpawnAreaMul&&(bo.kaleidoscope3SpawnAreaMul=i(n.kaleidoscope3SpawnAreaMul,.2,2,bo.kaleidoscope3SpawnAreaMul)),void 0!==n.kaleidoscope3SizeVariance&&(bo.kaleidoscope3SizeVariance=i(n.kaleidoscope3SizeVariance,0,1,bo.kaleidoscope3SizeVariance)),void 0!==n.kaleidoscopeWedges?bo.kaleidoscopeWedges=i(n.kaleidoscopeWedges,3,24,bo.kaleidoscopeWedges):void 0!==n.kaleidoscopeSegments&&(bo.kaleidoscopeWedges=i(n.kaleidoscopeSegments,3,24,bo.kaleidoscopeWedges)),void 0!==n.kaleidoscopeMirror&&(bo.kaleidoscopeMirror=i(n.kaleidoscopeMirror,0,1,bo.kaleidoscopeMirror)),void 0!==n.kaleidoscopeSpeed)bo.kaleidoscopeSpeed=i(n.kaleidoscopeSpeed,.2,2,bo.kaleidoscopeSpeed);else if(void 0!==n.kaleidoscopeSwirlStrength){const e=i(n.kaleidoscopeSwirlStrength,0,800,52);bo.kaleidoscopeSpeed=i(.2+e/800*1.8,.2,2,bo.kaleidoscopeSpeed)}void 0!==n.critterCount&&(bo.critterCount=n.critterCount),void 0!==n.critterSpeed&&(bo.critterSpeed=n.critterSpeed),void 0!==n.critterMaxSpeed&&(bo.critterMaxSpeed=n.critterMaxSpeed),void 0!==n.critterStepHz&&(bo.critterStepHz=n.critterStepHz),void 0!==n.critterStepSharpness&&(bo.critterStepSharpness=n.critterStepSharpness),void 0!==n.critterTurnNoise&&(bo.critterTurnNoise=n.critterTurnNoise),void 0!==n.critterTurnDamp&&(bo.critterTurnDamp=n.critterTurnDamp),void 0!==n.critterTurnSeek&&(bo.critterTurnSeek=n.critterTurnSeek),void 0!==n.critterAvoidRadius&&(bo.critterAvoidRadius=n.critterAvoidRadius),void 0!==n.critterAvoidForce&&(bo.critterAvoidForce=n.critterAvoidForce),void 0!==n.critterEdgeAvoid&&(bo.critterEdgeAvoid=n.critterEdgeAvoid),void 0!==n.critterMousePull&&(bo.critterMousePull=n.critterMousePull),bo.layoutMinWallRadiusPx=void 0!==n.layoutMinWallRadiusPx?i(n.layoutMinWallRadiusPx,0,400,bo.layoutMinWallRadiusPx):a("--layout-min-wall-radius",bo.layoutMinWallRadiusPx),void 0!==n.critterMouseRadiusVw&&(bo.critterMouseRadiusVw=n.critterMouseRadiusVw),void 0!==n.critterRestitution&&(bo.critterRestitution=n.critterRestitution),void 0!==n.critterFriction&&(bo.critterFriction=n.critterFriction),void 0!==n.critterHiveStirInterval&&(bo.critterHiveStirInterval=n.critterHiveStirInterval),void 0!==n.critterHiveStirStrength&&(bo.critterHiveStirStrength=n.critterHiveStirStrength),void 0!==n.critterHiveWaveSpeed&&(bo.critterHiveWaveSpeed=n.critterHiveWaveSpeed),void 0!==n.critterNervousnessMin&&(bo.critterNervousnessMin=n.critterNervousnessMin),void 0!==n.critterNervousnessMax&&(bo.critterNervousnessMax=n.critterNervousnessMax),void 0!==n.critterCuriosityBias&&(bo.critterCuriosityBias=n.critterCuriosityBias),void 0!==n.parallaxLinearDotCount&&(bo.parallaxLinearDotCount=i(n.parallaxLinearDotCount,20,220,bo.parallaxLinearDotCount)),void 0!==n.parallaxLinearGridJitter&&(bo.parallaxLinearGridJitter=i(n.parallaxLinearGridJitter,0,1,bo.parallaxLinearGridJitter)),void 0!==n.parallaxLinearFarSpeed&&(bo.parallaxLinearFarSpeed=i(n.parallaxLinearFarSpeed,0,1.5,bo.parallaxLinearFarSpeed)),void 0!==n.parallaxLinearMidSpeed&&(bo.parallaxLinearMidSpeed=i(n.parallaxLinearMidSpeed,0,1.5,bo.parallaxLinearMidSpeed)),void 0!==n.parallaxLinearNearSpeed&&(bo.parallaxLinearNearSpeed=i(n.parallaxLinearNearSpeed,0,1.5,bo.parallaxLinearNearSpeed)),void 0!==n.parallaxLinearGridX&&(bo.parallaxLinearGridX=r(n.parallaxLinearGridX,3,40,bo.parallaxLinearGridX)),void 0!==n.parallaxLinearGridY&&(bo.parallaxLinearGridY=r(n.parallaxLinearGridY,3,40,bo.parallaxLinearGridY)),void 0!==n.parallaxLinearGridZ&&(bo.parallaxLinearGridZ=r(n.parallaxLinearGridZ,2,20,bo.parallaxLinearGridZ)),void 0!==n.parallaxLinearSpanX&&(bo.parallaxLinearSpanX=i(n.parallaxLinearSpanX,.2,3,bo.parallaxLinearSpanX)),void 0!==n.parallaxLinearSpanY&&(bo.parallaxLinearSpanY=i(n.parallaxLinearSpanY,.2,3,bo.parallaxLinearSpanY)),void 0!==n.parallaxLinearZNear&&(bo.parallaxLinearZNear=i(n.parallaxLinearZNear,10,1200,bo.parallaxLinearZNear)),void 0!==n.parallaxLinearZFar&&(bo.parallaxLinearZFar=i(n.parallaxLinearZFar,50,3e3,bo.parallaxLinearZFar)),void 0!==n.parallaxLinearFocalLength&&(bo.parallaxLinearFocalLength=i(n.parallaxLinearFocalLength,80,2e3,bo.parallaxLinearFocalLength)),void 0!==n.parallaxLinearParallaxStrength&&(bo.parallaxLinearParallaxStrength=i(n.parallaxLinearParallaxStrength,0,2e3,bo.parallaxLinearParallaxStrength)),void 0!==n.parallaxLinearDotSizeMul&&(bo.parallaxLinearDotSizeMul=i(n.parallaxLinearDotSizeMul,.1,6,bo.parallaxLinearDotSizeMul)),void 0!==n.parallaxLinearFollowStrength&&(bo.parallaxLinearFollowStrength=i(n.parallaxLinearFollowStrength,1,80,bo.parallaxLinearFollowStrength)),void 0!==n.parallaxLinearDamping&&(bo.parallaxLinearDamping=i(n.parallaxLinearDamping,1,80,bo.parallaxLinearDamping));for(const[e,t]of Object.entries(n||{}))e in bo&&"config"!==e&&"soundConfig"!==e&&"soundPreset"!==e&&"function"!=typeof bo[e]&&(Array.isArray(t)||null===t||["string","number","boolean"].includes(typeof t))&&void 0!==t&&(bo[e]=t);if(void 0!==n.bubblesVerticalExtent&&(bo.bubblesVerticalExtent=i(n.bubblesVerticalExtent,.15,1,bo.bubblesVerticalExtent)),void 0!==n.bubblesDepthSpan&&(bo.bubblesDepthSpan=i(n.bubblesDepthSpan,.1,1,bo.bubblesDepthSpan)),void 0!==n.sphere3dRadiusVw&&(bo.sphere3dRadiusVw=i(n.sphere3dRadiusVw,5,60,bo.sphere3dRadiusVw)),void 0!==n.sphere3dDensity&&(bo.sphere3dDensity=r(n.sphere3dDensity,30,600,bo.sphere3dDensity)),void 0!==n.sphere3dFocalLength&&(bo.sphere3dFocalLength=r(n.sphere3dFocalLength,80,2e3,bo.sphere3dFocalLength)),void 0!==n.sphere3dDotSizeMul&&(bo.sphere3dDotSizeMul=i(n.sphere3dDotSizeMul,.2,4,bo.sphere3dDotSizeMul)),void 0!==n.sphere3dIdleSpeed&&(bo.sphere3dIdleSpeed=i(n.sphere3dIdleSpeed,0,1,bo.sphere3dIdleSpeed)),void 0!==n.sphere3dCursorInfluence&&(bo.sphere3dCursorInfluence=i(n.sphere3dCursorInfluence,0,4,bo.sphere3dCursorInfluence)),void 0!==n.sphere3dTumbleSpeed&&(bo.sphere3dTumbleSpeed=i(n.sphere3dTumbleSpeed,0,10,bo.sphere3dTumbleSpeed)),void 0!==n.sphere3dTumbleDamping&&(bo.sphere3dTumbleDamping=i(n.sphere3dTumbleDamping,.8,.99,bo.sphere3dTumbleDamping)),void 0!==n.sphere3dWarmupFrames&&(bo.sphere3dWarmupFrames=r(n.sphere3dWarmupFrames,0,240,bo.sphere3dWarmupFrames)),void 0!==n.cube3dSizeVw&&(bo.cube3dSizeVw=i(n.cube3dSizeVw,10,50,bo.cube3dSizeVw)),void 0!==n.cube3dEdgeDensity&&(bo.cube3dEdgeDensity=r(n.cube3dEdgeDensity,2,30,bo.cube3dEdgeDensity)),void 0!==n.cube3dFaceGrid&&(bo.cube3dFaceGrid=r(n.cube3dFaceGrid,0,10,bo.cube3dFaceGrid)),void 0!==n.cube3dIdleSpeed&&(bo.cube3dIdleSpeed=i(n.cube3dIdleSpeed,0,1,bo.cube3dIdleSpeed)),void 0!==n.cube3dCursorInfluence&&(bo.cube3dCursorInfluence=i(n.cube3dCursorInfluence,0,4,bo.cube3dCursorInfluence)),void 0!==n.cube3dTumbleSpeed&&(bo.cube3dTumbleSpeed=i(n.cube3dTumbleSpeed,0,10,bo.cube3dTumbleSpeed)),void 0!==n.cube3dTumbleDamping&&(bo.cube3dTumbleDamping=i(n.cube3dTumbleDamping,.8,.99,bo.cube3dTumbleDamping)),void 0!==n.cube3dFocalLength&&(bo.cube3dFocalLength=r(n.cube3dFocalLength,80,2e3,bo.cube3dFocalLength)),void 0!==n.cube3dDotSizeMul&&(bo.cube3dDotSizeMul=i(n.cube3dDotSizeMul,.2,4,bo.cube3dDotSizeMul)),void 0!==n.cube3dFogStart&&(bo.cube3dFogStart=i(n.cube3dFogStart,0,1,bo.cube3dFogStart)),void 0!==n.cube3dFogMin&&(bo.cube3dFogMin=i(n.cube3dFogMin,0,1,bo.cube3dFogMin)),void 0!==n.cube3dWarmupFrames&&(bo.cube3dWarmupFrames=r(n.cube3dWarmupFrames,0,240,bo.cube3dWarmupFrames)),void 0!==n.starfieldCount&&(bo.starfieldCount=r(n.starfieldCount,20,500,bo.starfieldCount)),void 0!==n.starfieldSpanX&&(bo.starfieldSpanX=i(n.starfieldSpanX,.4,4,bo.starfieldSpanX)),void 0!==n.starfieldSpanY&&(bo.starfieldSpanY=i(n.starfieldSpanY,.4,4,bo.starfieldSpanY)),void 0!==n.starfieldZNear&&(bo.starfieldZNear=r(n.starfieldZNear,20,800,bo.starfieldZNear)),void 0!==n.starfieldZFar&&(bo.starfieldZFar=r(n.starfieldZFar,400,4e3,bo.starfieldZFar)),void 0!==n.starfieldFocalLength&&(bo.starfieldFocalLength=r(n.starfieldFocalLength,100,2e3,bo.starfieldFocalLength)),void 0!==n.starfieldParallaxStrength&&(bo.starfieldParallaxStrength=r(n.starfieldParallaxStrength,0,1200,bo.starfieldParallaxStrength)),void 0!==n.starfieldSpeed&&(bo.starfieldSpeed=r(n.starfieldSpeed,10,1600,bo.starfieldSpeed)),void 0!==n.starfieldDotSizeMul&&(bo.starfieldDotSizeMul=i(n.starfieldDotSizeMul,.2,4,bo.starfieldDotSizeMul)),void 0!==n.starfieldIdleJitter&&(bo.starfieldIdleJitter=i(n.starfieldIdleJitter,0,20,bo.starfieldIdleJitter)),void 0!==n.starfieldFadeDuration&&(bo.starfieldFadeDuration=i(n.starfieldFadeDuration,0,3,bo.starfieldFadeDuration)),void 0!==n.starfield3dWarmupFrames&&(bo.starfield3dWarmupFrames=r(n.starfield3dWarmupFrames,0,240,bo.starfield3dWarmupFrames)),void 0!==n.elasticCenterRingCount&&(bo.elasticCenterRingCount=r(n.elasticCenterRingCount,2,20,bo.elasticCenterRingCount)),void 0!==n.elasticCenterMassMultiplier&&(bo.elasticCenterMassMultiplier=i(n.elasticCenterMassMultiplier,.5,5,bo.elasticCenterMassMultiplier)),void 0!==n.elasticCenterSpacingMultiplier&&(bo.elasticCenterSpacingMultiplier=i(n.elasticCenterSpacingMultiplier,2,4,bo.elasticCenterSpacingMultiplier)),void 0!==n.elasticCenterElasticStrength&&(bo.elasticCenterElasticStrength=r(n.elasticCenterElasticStrength,0,15e3,bo.elasticCenterElasticStrength)),void 0!==n.elasticCenterMouseRepelStrength&&(bo.elasticCenterMouseRepelStrength=r(n.elasticCenterMouseRepelStrength,3e3,25e3,bo.elasticCenterMouseRepelStrength)),void 0!==n.elasticCenterMouseRadius&&(bo.elasticCenterMouseRadius=r(n.elasticCenterMouseRadius,50,400,bo.elasticCenterMouseRadius)),void 0!==n.elasticCenterDamping&&(bo.elasticCenterDamping=i(n.elasticCenterDamping,.85,.99,bo.elasticCenterDamping)),void 0!==n.elasticCenterWarmupFrames&&(bo.elasticCenterWarmupFrames=r(n.elasticCenterWarmupFrames,0,240,bo.elasticCenterWarmupFrames)),void 0!==n.particleFountainEmissionRate&&(bo.particleFountainEmissionRate=r(n.particleFountainEmissionRate,5,100,bo.particleFountainEmissionRate)),void 0!==n.particleFountainInitialVelocity&&(bo.particleFountainInitialVelocity=r(n.particleFountainInitialVelocity,200,1e4,bo.particleFountainInitialVelocity)),void 0!==n.particleFountainSpreadAngle&&(bo.particleFountainSpreadAngle=r(n.particleFountainSpreadAngle,10,120,bo.particleFountainSpreadAngle)),void 0!==n.particleFountainWaterDrag&&(bo.particleFountainWaterDrag=i(n.particleFountainWaterDrag,.01,.2,bo.particleFountainWaterDrag)),void 0!==n.particleFountainGravityMultiplier&&(bo.particleFountainGravityMultiplier=i(n.particleFountainGravityMultiplier,0,2,bo.particleFountainGravityMultiplier)),void 0!==n.particleFountainUpwardForce&&(bo.particleFountainUpwardForce=r(n.particleFountainUpwardForce,0,800,bo.particleFountainUpwardForce)),void 0!==n.particleFountainMaxParticles&&(bo.particleFountainMaxParticles=r(n.particleFountainMaxParticles,20,300,bo.particleFountainMaxParticles)),void 0!==n.particleFountainLifetime&&(bo.particleFountainLifetime=i(n.particleFountainLifetime,1,30,bo.particleFountainLifetime)),void 0!==n.particleFountainMouseRepelStrength&&(bo.particleFountainMouseRepelStrength=r(n.particleFountainMouseRepelStrength,1e4,1e5,bo.particleFountainMouseRepelStrength)),void 0!==n.particleFountainMouseRepelRadiusVw&&(bo.particleFountainMouseRepelRadiusVw=i(n.particleFountainMouseRepelRadiusVw,1,20,bo.particleFountainMouseRepelRadiusVw)),void 0!==n.particleFountainWarmupFrames&&(bo.particleFountainWarmupFrames=r(n.particleFountainWarmupFrames,0,240,bo.particleFountainWarmupFrames)),void 0!==n.sceneImpactEnabled&&(bo.sceneImpactEnabled=!!n.sceneImpactEnabled),void 0!==n.sceneImpactMul?bo.sceneImpactMul=i(n.sceneImpactMul,0,.05,bo.sceneImpactMul):void 0!==n.brandLogoImpactMul&&(bo.sceneImpactMul=i(n.brandLogoImpactMul,0,.05,bo.sceneImpactMul)),void 0!==n.sceneImpactMobileMulFactor&&(bo.sceneImpactMobileMulFactor=i(n.sceneImpactMobileMulFactor,.25,3,bo.sceneImpactMobileMulFactor)),void 0!==n.sceneImpactLogoCompMul&&(bo.sceneImpactLogoCompMul=i(n.sceneImpactLogoCompMul,.25,6,bo.sceneImpactLogoCompMul)),void 0!==n.sceneImpactOvershoot?bo.sceneImpactOvershoot=i(n.sceneImpactOvershoot,0,.8,bo.sceneImpactOvershoot):void 0!==n.brandLogoOvershoot&&(bo.sceneImpactOvershoot=i(n.brandLogoOvershoot,0,.8,bo.sceneImpactOvershoot)),void 0!==n.sceneImpactAnticipation?bo.sceneImpactAnticipation=i(n.sceneImpactAnticipation,0,.6,bo.sceneImpactAnticipation):void 0!==n.brandLogoAnticipation&&(bo.sceneImpactAnticipation=i(n.brandLogoAnticipation,0,.6,bo.sceneImpactAnticipation)),void 0!==n.sceneImpactPressMs?bo.sceneImpactPressMs=i(n.sceneImpactPressMs,20,300,bo.sceneImpactPressMs):void 0!==n.brandLogoPressMs&&(bo.sceneImpactPressMs=i(n.brandLogoPressMs,20,300,bo.sceneImpactPressMs)),void 0!==n.sceneImpactReleaseMs?bo.sceneImpactReleaseMs=i(n.sceneImpactReleaseMs,40,1200,bo.sceneImpactReleaseMs):void 0!==n.brandLogoReleaseMs&&(bo.sceneImpactReleaseMs=i(n.brandLogoReleaseMs,40,1200,bo.sceneImpactReleaseMs)),void 0!==n.sceneChangeSoundEnabled&&(bo.sceneChangeSoundEnabled=!!n.sceneChangeSoundEnabled),void 0!==n.sceneChangeSoundIntensity&&(bo.sceneChangeSoundIntensity=i(n.sceneChangeSoundIntensity,0,1,bo.sceneChangeSoundIntensity)),void 0!==n.sceneChangeSoundRadius&&(bo.sceneChangeSoundRadius=i(n.sceneChangeSoundRadius,6,60,bo.sceneChangeSoundRadius)),void 0!==n.containerBorder&&(bo.containerBorder=n.containerBorder),void 0!==n.simulationPadding&&(bo.simulationPadding=n.simulationPadding),void 0!==n.contentPadding&&(bo.contentPadding=n.contentPadding),bo.bgLight=void 0!==n.bgLight?n.bgLight:e("--bg-light",bo.bgLight),bo.bgDark=void 0!==n.bgDark?n.bgDark:e("--bg-dark",bo.bgDark),bo.frameColorLight=void 0!==n.frameColorLight?n.frameColorLight:e("--frame-color-light",bo.frameColorLight),bo.frameColorDark=void 0!==n.frameColorDark?n.frameColorDark:e("--frame-color-dark",bo.frameColorDark),void 0!==n.frameColor)bo.frameColor=n.frameColor,bo.frameColorLight=n.frameColor,bo.frameColorDark=n.frameColor;else{const e=bo.frameColorLight||bo.frameColorDark||"#242529";bo.frameColor=e,bo.frameColorLight=e,bo.frameColorDark=e}bo.frameColorLight=bo.frameColor,bo.frameColorDark=bo.frameColor,bo.textColorLight=void 0!==n.textColorLight?n.textColorLight:e("--text-color-light",bo.textColorLight),bo.textColorLightMuted=void 0!==n.textColorLightMuted?n.textColorLightMuted:e("--text-color-light-muted",bo.textColorLightMuted),bo.textColorDark=void 0!==n.textColorDark?n.textColorDark:e("--text-color-dark",bo.textColorDark),bo.textColorDarkMuted=void 0!==n.textColorDarkMuted?n.textColorDarkMuted:e("--text-color-dark-muted",bo.textColorDarkMuted),void 0!==n.edgeLabelInsetAdjustPx&&(bo.edgeLabelInsetAdjustPx=i(n.edgeLabelInsetAdjustPx,-500,500,bo.edgeLabelInsetAdjustPx)),void 0!==n.edgeCaptionDistanceMinPx&&(bo.edgeCaptionDistanceMinPx=r(n.edgeCaptionDistanceMinPx,0,200,bo.edgeCaptionDistanceMinPx)),void 0!==n.edgeCaptionDistanceMaxPx&&(bo.edgeCaptionDistanceMaxPx=r(n.edgeCaptionDistanceMaxPx,0,400,bo.edgeCaptionDistanceMaxPx)),void 0!==n.simulationOverlayIntensity&&(bo.simulationOverlayIntensity=i(n.simulationOverlayIntensity,0,1,bo.simulationOverlayIntensity)),void 0!==n.depthWashOpacity&&(bo.depthWashOpacity=i(n.depthWashOpacity,0,1,bo.depthWashOpacity));const d=["source-over","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion"];if(void 0!==n.depthWashBlendModeLight){const e=n.depthWashBlendModeLight+"";bo.depthWashBlendModeLight=d.includes(e)?e:bo.depthWashBlendModeLight}if(void 0!==n.depthWashBlendModeDark){const e=n.depthWashBlendModeDark+"";bo.depthWashBlendModeDark=d.includes(e)?e:bo.depthWashBlendModeDark}if(void 0!==n.depthWashCenterY&&(bo.depthWashCenterY=i(n.depthWashCenterY,0,1,bo.depthWashCenterY)),void 0!==n.depthWashRadiusScale&&(bo.depthWashRadiusScale=i(n.depthWashRadiusScale,.2,3,bo.depthWashRadiusScale)),void 0!==n.depthWashCenterColorLight&&(bo.depthWashCenterColorLight=n.depthWashCenterColorLight+""),void 0!==n.depthWashEdgeColorLight&&(bo.depthWashEdgeColorLight=n.depthWashEdgeColorLight+""),void 0!==n.depthWashCenterAlphaLight&&(bo.depthWashCenterAlphaLight=i(n.depthWashCenterAlphaLight,0,1,bo.depthWashCenterAlphaLight)),void 0!==n.depthWashEdgeAlphaLight&&(bo.depthWashEdgeAlphaLight=i(n.depthWashEdgeAlphaLight,0,1,bo.depthWashEdgeAlphaLight)),void 0!==n.depthWashCenterColorDark&&(bo.depthWashCenterColorDark=n.depthWashCenterColorDark+""),void 0!==n.depthWashEdgeColorDark&&(bo.depthWashEdgeColorDark=n.depthWashEdgeColorDark+""),void 0!==n.depthWashCenterAlphaDark&&(bo.depthWashCenterAlphaDark=i(n.depthWashCenterAlphaDark,0,1,bo.depthWashCenterAlphaDark)),void 0!==n.depthWashEdgeAlphaDark&&(bo.depthWashEdgeAlphaDark=i(n.depthWashEdgeAlphaDark,0,1,bo.depthWashEdgeAlphaDark)),void 0!==n.topLogoWidthVw&&(bo.topLogoWidthVw=i(n.topLogoWidthVw,0,120,bo.topLogoWidthVw)),void 0!==n.homeMainLinksBelowLogoPx&&(bo.homeMainLinksBelowLogoPx=i(n.homeMainLinksBelowLogoPx,-500,500,bo.homeMainLinksBelowLogoPx)),void 0!==n.footerNavBarTopVh&&(bo.footerNavBarTopVh=i(n.footerNavBarTopVh,0,100,bo.footerNavBarTopVh)),void 0!==n.footerNavBarGapVw&&(bo.footerNavBarGapVw=i(n.footerNavBarGapVw,0,30,bo.footerNavBarGapVw)),bo.linkHoverColor=void 0!==n.linkHoverColor?n.linkHoverColor:e("--link-hover-color",bo.linkHoverColor),void 0!==n.uiHitAreaMul&&(bo.uiHitAreaMul=i(n.uiHitAreaMul,.5,3,bo.uiHitAreaMul)),void 0!==n.uiIconCornerRadiusMul&&(bo.uiIconCornerRadiusMul=i(n.uiIconCornerRadiusMul,0,1,bo.uiIconCornerRadiusMul)),bo.uiIconFramePx=r(void 0!==n.uiIconFramePx?n.uiIconFramePx:a("--ui-icon-frame-size",bo.uiIconFramePx),0,240,bo.uiIconFramePx),bo.uiIconGlyphPx=r(void 0!==n.uiIconGlyphPx?n.uiIconGlyphPx:a("--ui-icon-glyph-size",bo.uiIconGlyphPx),0,120,bo.uiIconGlyphPx),bo.uiIconGroupMarginPx=r(void 0!==n.uiIconGroupMarginPx?n.uiIconGroupMarginPx:a("--ui-icon-group-margin",bo.uiIconGroupMarginPx),-200,200,bo.uiIconGroupMarginPx),void 0!==n.linkTextPadding&&(bo.linkTextPadding=i(n.linkTextPadding,0,200,bo.linkTextPadding)),void 0!==n.linkIconPadding&&(bo.linkIconPadding=i(n.linkIconPadding,0,200,bo.linkIconPadding)),void 0!==n.linkColorInfluence&&(bo.linkColorInfluence=i(n.linkColorInfluence,0,1,bo.linkColorInfluence)),void 0!==n.linkImpactScale&&(bo.linkImpactScale=i(n.linkImpactScale,.5,1,bo.linkImpactScale)),void 0!==n.linkImpactBlur&&(bo.linkImpactBlur=i(n.linkImpactBlur,0,40,bo.linkImpactBlur)),void 0!==n.linkImpactDuration&&(bo.linkImpactDuration=r(n.linkImpactDuration,0,3e3,bo.linkImpactDuration)),void 0!==n.linkHoverNudge&&(bo.linkHoverNudge=i(n.linkHoverNudge,0,4,bo.linkHoverNudge)),void 0!==n.linkHoverIntensityLight&&(bo.linkHoverIntensityLight=i(n.linkHoverIntensityLight,0,1,bo.linkHoverIntensityLight)),void 0!==n.linkHoverIntensityDark&&(bo.linkHoverIntensityDark=i(n.linkHoverIntensityDark,0,1,bo.linkHoverIntensityDark)),void 0!==n.linkHoverIntensityActive&&(bo.linkHoverIntensityActive=i(n.linkHoverIntensityActive,0,1,bo.linkHoverIntensityActive)),void 0!==n.hoverSnapEnabled&&(bo.hoverSnapEnabled=!!n.hoverSnapEnabled),void 0!==n.hoverSnapDuration&&(bo.hoverSnapDuration=r(n.hoverSnapDuration,0,2e3,bo.hoverSnapDuration)),void 0!==n.hoverSnapOvershoot&&(bo.hoverSnapOvershoot=i(n.hoverSnapOvershoot,1,1.35,bo.hoverSnapOvershoot)),void 0!==n.hoverSnapUndershoot&&(bo.hoverSnapUndershoot=i(n.hoverSnapUndershoot,.7,1,bo.hoverSnapUndershoot)),void 0!==n.noiseEnabled&&(bo.noiseEnabled=!!n.noiseEnabled),void 0!==n.noiseSeed&&(bo.noiseSeed=r(n.noiseSeed,0,999999,bo.noiseSeed)),void 0!==n.noiseTextureSize&&(bo.noiseTextureSize=r(n.noiseTextureSize,64,512,bo.noiseTextureSize)),void 0!==n.noiseDistribution){const e=n.noiseDistribution+"";bo.noiseDistribution="uniform"===e||"gaussian"===e?e:bo.noiseDistribution}if(void 0!==n.noiseMonochrome&&(bo.noiseMonochrome=!!n.noiseMonochrome),void 0!==n.noiseChroma&&(bo.noiseChroma=i(n.noiseChroma,0,1,bo.noiseChroma)),void 0!==n.noiseMotion){const e=n.noiseMotion+"";bo.noiseMotion="jitter"===e||"drift"===e||"static"===e?e:bo.noiseMotion}void 0!==n.noiseMotionAmount&&(bo.noiseMotionAmount=i(n.noiseMotionAmount,0,2.5,bo.noiseMotionAmount)),void 0!==n.noiseSpeedMs&&(bo.noiseSpeedMs=r(n.noiseSpeedMs,0,1e4,bo.noiseSpeedMs)),void 0!==n.noiseSpeedVariance&&(bo.noiseSpeedVariance=i(n.noiseSpeedVariance,0,1,bo.noiseSpeedVariance)),void 0!==n.noiseFlicker&&(bo.noiseFlicker=i(n.noiseFlicker,0,1,bo.noiseFlicker)),void 0!==n.noiseFlickerSpeedMs&&(bo.noiseFlickerSpeedMs=r(n.noiseFlickerSpeedMs,0,5e3,bo.noiseFlickerSpeedMs)),void 0!==n.noiseBlurPx&&(bo.noiseBlurPx=i(n.noiseBlurPx,0,6,bo.noiseBlurPx)),void 0!==n.noiseContrast&&(bo.noiseContrast=i(n.noiseContrast,.25,5,bo.noiseContrast)),void 0!==n.noiseBrightness&&(bo.noiseBrightness=i(n.noiseBrightness,.25,3,bo.noiseBrightness)),void 0!==n.noiseSaturation&&(bo.noiseSaturation=i(n.noiseSaturation,0,3,bo.noiseSaturation)),void 0!==n.noiseHue&&(bo.noiseHue=i(n.noiseHue,0,360,bo.noiseHue)),void 0!==n.noiseSize&&(bo.noiseSize=i(n.noiseSize,20,600,bo.noiseSize)),void 0!==n.noiseOpacity&&(bo.noiseOpacity=i(n.noiseOpacity,0,1,bo.noiseOpacity)),void 0!==n.noiseOpacityLight&&(bo.noiseOpacityLight=i(n.noiseOpacityLight,0,1,bo.noiseOpacityLight)),void 0!==n.noiseOpacityDark&&(bo.noiseOpacityDark=i(n.noiseOpacityDark,0,1,bo.noiseOpacityDark)),void 0!==n.noiseBlendMode&&(bo.noiseBlendMode="normal"),void 0!==n.noiseColorLight&&(bo.noiseColorLight=n.noiseColorLight+""),void 0!==n.noiseColorDark&&(bo.noiseColorDark=n.noiseColorDark+""),void 0!==n.detailNoiseOpacity&&(bo.detailNoiseOpacity=i(n.detailNoiseOpacity,0,1,bo.detailNoiseOpacity)),void 0!==n.wallThickness&&(bo.wallThickness=n.wallThickness),void 0!==n.wallRadius&&(bo.wallRadius=n.wallRadius,bo.cornerRadius=n.wallRadius),void 0!==n.wallInset&&(bo.wallInset=n.wallInset),void 0!==n.wallInset&&(bo.wallInset=n.wallInset),void 0!==n.ballSpacing&&(bo.ballSpacing=n.ballSpacing),void 0!==n.wallPreset&&(bo.wallPreset=n.wallPreset),void 0!==n.wallColorLight&&(bo.frameColorLight=n.wallColorLight,bo.frameColor=n.wallColorLight),void 0!==n.wallColorDark&&(bo.frameColorDark=n.wallColorDark,n.wallColorLight||(bo.frameColor=n.wallColorDark)),void 0!==n.modalOverlayEnabled&&(bo.modalOverlayEnabled=n.modalOverlayEnabled),void 0!==n.modalOverlayOpacity&&(bo.modalOverlayOpacity=n.modalOverlayOpacity),void 0!==n.modalOverlayBlurPx&&(bo.modalOverlayBlurPx=n.modalOverlayBlurPx),void 0!==n.modalOverlayTransitionMs&&(bo.modalOverlayTransitionMs=n.modalOverlayTransitionMs),void 0!==n.modalOverlayTransitionOutMs&&(bo.modalOverlayTransitionOutMs=n.modalOverlayTransitionOutMs),void 0!==n.grungeVideoEnabled&&(bo.grungeVideoEnabled=n.grungeVideoEnabled),void 0!==n.grungeVideoOpacity&&(bo.grungeVideoOpacity=n.grungeVideoOpacity),void 0!==n.grungeVideoBlendMode&&(bo.grungeVideoBlendMode=n.grungeVideoBlendMode),void 0!==n.outerWallBorderWidth&&(bo.outerWallBorderWidth=n.outerWallBorderWidth),void 0!==n.outerWallBorderGradientSpread&&(bo.outerWallBorderGradientSpread=n.outerWallBorderGradientSpread),void 0!==n.outerWallBorderBrightOpacityLight&&(bo.outerWallBorderBrightOpacityLight=n.outerWallBorderBrightOpacityLight),void 0!==n.outerWallBorderBrightOpacityDark&&(bo.outerWallBorderBrightOpacityDark=n.outerWallBorderBrightOpacityDark),void 0!==n.outerWallBorderDimOpacityLight&&(bo.outerWallBorderDimOpacityLight=n.outerWallBorderDimOpacityLight),void 0!==n.outerWallBorderDimOpacityDark&&(bo.outerWallBorderDimOpacityDark=n.outerWallBorderDimOpacityDark),void 0!==n.outerWallBorderShadowOpacityLight&&(bo.outerWallBorderShadowOpacityLight=n.outerWallBorderShadowOpacityLight),void 0!==n.outerWallBorderShadowOpacityDark&&(bo.outerWallBorderShadowOpacityDark=n.outerWallBorderShadowOpacityDark),void 0!==n.outerWallCastShadowOpacityLight&&(bo.outerWallCastShadowOpacityLight=n.outerWallCastShadowOpacityLight),void 0!==n.outerWallCastShadowOpacityDark&&(bo.outerWallCastShadowOpacityDark=n.outerWallCastShadowOpacityDark),void 0!==n.outerWallCastShadowBlur&&(bo.outerWallCastShadowBlur=n.outerWallCastShadowBlur),void 0!==n.outerWallCastShadowOffset&&(bo.outerWallCastShadowOffset=n.outerWallCastShadowOffset),void 0!==n.outerWallRadiusAdjust&&(bo.outerWallRadiusAdjust=n.outerWallRadiusAdjust),void 0!==n.outerWallTopShadowOffset&&(bo.outerWallTopShadowOffset=n.outerWallTopShadowOffset),void 0!==n.outerWallTopShadowBlur&&(bo.outerWallTopShadowBlur=n.outerWallTopShadowBlur),void 0!==n.outerWallTopShadowOpacityLight&&(bo.outerWallTopShadowOpacityLight=n.outerWallTopShadowOpacityLight),void 0!==n.outerWallTopShadowOpacityDark&&(bo.outerWallTopShadowOpacityDark=n.outerWallTopShadowOpacityDark),void 0!==n.outerWallShineBlurLight&&(bo.outerWallShineBlurLight=n.outerWallShineBlurLight),void 0!==n.outerWallShineSpreadLight&&(bo.outerWallShineSpreadLight=n.outerWallShineSpreadLight),void 0!==n.outerWallShineOvershootLight&&(bo.outerWallShineOvershootLight=n.outerWallShineOvershootLight),void 0!==n.outerWallShineOpacityLight&&(bo.outerWallShineOpacityLight=n.outerWallShineOpacityLight),void 0!==n.outerWallShineColorLight&&(bo.outerWallShineColorLight=n.outerWallShineColorLight),void 0!==n.outerWallShineBlurDark&&(bo.outerWallShineBlurDark=n.outerWallShineBlurDark),void 0!==n.outerWallShineSpreadDark&&(bo.outerWallShineSpreadDark=n.outerWallShineSpreadDark),void 0!==n.outerWallShineOvershootDark&&(bo.outerWallShineOvershootDark=n.outerWallShineOvershootDark),void 0!==n.outerWallShineOpacityDark&&(bo.outerWallShineOpacityDark=n.outerWallShineOpacityDark),void 0!==n.outerWallShineColorDark&&(bo.outerWallShineColorDark=n.outerWallShineColorDark),void 0!==n.outerWallShineEnabled&&(bo.outerWallShineEnabled=!!n.outerWallShineEnabled),void 0!==n.innerWallBorderWidth&&(bo.innerWallBorderWidth=n.innerWallBorderWidth),void 0!==n.innerWallBorderGradientSpread&&(bo.innerWallBorderGradientSpread=n.innerWallBorderGradientSpread),void 0!==n.innerWallBorderBrightOpacityLight&&(bo.innerWallBorderBrightOpacityLight=n.innerWallBorderBrightOpacityLight),void 0!==n.innerWallBorderBrightOpacityDark&&(bo.innerWallBorderBrightOpacityDark=n.innerWallBorderBrightOpacityDark),void 0!==n.innerWallBorderDimOpacityLight&&(bo.innerWallBorderDimOpacityLight=n.innerWallBorderDimOpacityLight),void 0!==n.innerWallBorderDimOpacityDark&&(bo.innerWallBorderDimOpacityDark=n.innerWallBorderDimOpacityDark),void 0!==n.innerWallBorderShadowOpacityLight&&(bo.innerWallBorderShadowOpacityLight=n.innerWallBorderShadowOpacityLight),void 0!==n.innerWallBorderShadowOpacityDark&&(bo.innerWallBorderShadowOpacityDark=n.innerWallBorderShadowOpacityDark),void 0!==n.innerWallOutwardShadowOpacityLight&&(bo.innerWallOutwardShadowOpacityLight=n.innerWallOutwardShadowOpacityLight),void 0!==n.innerWallOutwardShadowOpacityDark&&(bo.innerWallOutwardShadowOpacityDark=n.innerWallOutwardShadowOpacityDark),void 0!==n.innerWallOutwardShadowBlur&&(bo.innerWallOutwardShadowBlur=n.innerWallOutwardShadowBlur),void 0!==n.innerWallOutwardShadowOffset&&(bo.innerWallOutwardShadowOffset=n.innerWallOutwardShadowOffset),void 0!==n.innerWallOutwardShadowSpread&&(bo.innerWallOutwardShadowSpread=n.innerWallOutwardShadowSpread),void 0!==n.innerWallInnerGlowOpacityLight&&(bo.innerWallInnerGlowOpacityLight=n.innerWallInnerGlowOpacityLight),void 0!==n.innerWallInnerGlowOpacityDark&&(bo.innerWallInnerGlowOpacityDark=n.innerWallInnerGlowOpacityDark),void 0!==n.innerWallInnerGlowBlur&&(bo.innerWallInnerGlowBlur=n.innerWallInnerGlowBlur),void 0!==n.innerWallInnerGlowSpread&&(bo.innerWallInnerGlowSpread=n.innerWallInnerGlowSpread),void 0!==n.innerWallInnerGlowOffsetY&&(bo.innerWallInnerGlowOffsetY=n.innerWallInnerGlowOffsetY),void 0!==n.innerWallInnerGlowColor&&(bo.innerWallInnerGlowColor=n.innerWallInnerGlowColor),void 0!==n.innerWallShineEnabled&&(bo.innerWallShineEnabled=!!n.innerWallShineEnabled),void 0!==n.wallAOOpacityLight&&(bo.wallAOOpacityLight=n.wallAOOpacityLight),void 0!==n.wallAOOpacityDark&&(bo.wallAOOpacityDark=n.wallAOOpacityDark),void 0!==n.wallAOSpread&&(bo.wallAOSpread=n.wallAOSpread),void 0!==n.wallSpecularOpacityLight&&(bo.wallSpecularOpacityLight=n.wallSpecularOpacityLight),void 0!==n.wallSpecularOpacityDark&&(bo.wallSpecularOpacityDark=n.wallSpecularOpacityDark),void 0!==n.wallSpecularWidth&&(bo.wallSpecularWidth=n.wallSpecularWidth),void 0!==n.wallSpecularEnabled&&(bo.wallSpecularEnabled=!!n.wallSpecularEnabled),void 0!==n.wallLightFluctuationStrength&&(bo.wallLightFluctuationStrength=n.wallLightFluctuationStrength),void 0!==n.wallLightFluctuationEnabled&&(bo.wallLightFluctuationEnabled=!!n.wallLightFluctuationEnabled);const c=l();if(void 0!==n.containerBorderVw&&(bo.containerBorderVw=i(n.containerBorderVw,0,20,bo.containerBorderVw)),void 0!==n.simulationPaddingVw&&(bo.simulationPaddingVw=i(n.simulationPaddingVw,0,20,bo.simulationPaddingVw)),void 0!==n.contentPaddingRatio){const e=+n.contentPaddingRatio;Number.isFinite(e)&&(bo.contentPaddingRatio=Math.abs(e)>1?i(e,-500,500,bo.contentPaddingRatio):i(e,-.2,.2,bo.contentPaddingRatio))}if(void 0!==n.contentPaddingHorizontalRatio&&(bo.contentPaddingHorizontalRatio=i(n.contentPaddingHorizontalRatio,.1,3,bo.contentPaddingHorizontalRatio)),void 0!==n.contentPaddingBottomRatio&&(bo.contentPaddingBottomRatio=i(n.contentPaddingBottomRatio,.5,2.5,1.3),document.documentElement.style.setProperty("--abs-content-pad-mul-bottom",bo.contentPaddingBottomRatio+"")),void 0!==n.mobileWallThicknessXFactor&&(bo.mobileWallThicknessXFactor=i(n.mobileWallThicknessXFactor,.5,3,bo.mobileWallThicknessXFactor)),void 0!==n.desktopWallThicknessFactor&&(bo.desktopWallThicknessFactor=i(n.desktopWallThicknessFactor,.5,3,bo.desktopWallThicknessFactor)),void 0!==n.mobileEdgeLabelsVisible&&(bo.mobileEdgeLabelsVisible=!!n.mobileEdgeLabelsVisible),void 0!==n.wallRadiusVw&&(bo.wallRadiusVw=i(n.wallRadiusVw,0,40,bo.wallRadiusVw)),void 0!==n.wallThicknessVw&&(bo.wallThicknessVw=i(n.wallThicknessVw,0,20,bo.wallThicknessVw)),void 0!==n.wallThicknessAreaMultiplier&&(bo.wallThicknessAreaMultiplier=i(n.wallThicknessAreaMultiplier,0,10,bo.wallThicknessAreaMultiplier)),void 0!==n.wallThicknessMinPx&&(bo.wallThicknessMinPx=i(n.wallThicknessMinPx,0,200,bo.wallThicknessMinPx)),void 0!==n.wallThicknessMaxPx&&(bo.wallThicknessMaxPx=i(n.wallThicknessMaxPx,0,200,bo.wallThicknessMaxPx)),!Number.isFinite(bo.containerBorderVw)||0>=bo.containerBorderVw){const e=t("--container-border-vw",null);Number.isFinite(e)&&e>0&&(bo.containerBorderVw=e)}if(!Number.isFinite(bo.wallRadiusVw)||0>=bo.wallRadiusVw){const e=t("--wall-radius-vw",null);Number.isFinite(e)&&e>0&&(bo.wallRadiusVw=e)}if(!Number.isFinite(bo.wallThicknessVw)||0>=bo.wallThicknessVw){const e=t("--wall-thickness-vw",null);Number.isFinite(e)&&e>0&&(bo.wallThicknessVw=e)}Number.isFinite(bo.containerBorderVw)&&bo.containerBorderVw>0||(bo.containerBorderVw=u(bo.containerBorder,c)),Number.isFinite(bo.simulationPaddingVw)&&bo.simulationPaddingVw>=0||(bo.simulationPaddingVw=u(bo.simulationPadding,c)),Number.isFinite(bo.wallRadiusVw)&&bo.wallRadiusVw>0||(bo.wallRadiusVw=u(bo.wallRadius,c)),Number.isFinite(bo.wallThicknessVw)&&bo.wallThicknessVw>0||(bo.wallThicknessVw=u(bo.wallThickness,c)),m()}function g(){return bo}function b(){return bo}function y(e){const t=b();let a=Math.round(+e||0);if(!1!==t.featureQualityTieringEnabled){const e=(e=>{const t=e?.modePerformanceBudgets;if(!t||"object"!=typeof t)return 1/0;const a=e?.currentMode;if(!a)return 1/0;const n=t[a];if(!n||"object"!=typeof n)return 1/0;const o=+(e.isMobile||e.isMobileViewport?n.mobile:n.desktop);return Number.isFinite(o)&&o>0?o:1/0})(t);Number.isFinite(e)&&(a=Math.min(a,Math.round(e)))}let n=1;if(t.isMobile){const e=Math.max(0,Math.min(1,+(t.mobileObjectReductionFactor??.7))),o=Math.max(0,+(t.mobileObjectReductionThreshold??0));(0>=o||a>=o)&&(n*=e)}return t.liteModeEnabled&&(n*=Math.max(0,Math.min(1,+(t.liteModeObjectReductionFactor??.6)))),Math.max(0,Math.round(a*n))}function v(e,t,a){bo.canvas=e,bo.ctx=t,bo.container=a}function w(e){bo.currentMode=e}function x(){bo.balls.length=0}function M(){const e=navigator.userAgent||"",t=/iPad/.test(e)||/Mac/.test(e)&&navigator.maxTouchPoints>1,a=/iPhone/.test(e);let n=!1;try{const e=!(!window.matchMedia||!window.matchMedia("(max-width: 600px)").matches),t=[window.visualViewport?.width,window.innerWidth,document.documentElement?.clientWidth].filter(e=>Number.isFinite(e)),a=t.length?Math.min(...t):null;n=e||!!Number.isFinite(a)&&600>=a}catch(s){}const o=!(!t&&!a),i=n;(bo.isMobile!==o||bo.isMobileViewport!==i)&&(bo.isMobile=o,bo.isMobileViewport=i,(bo.isMobile||bo.isMobileViewport)&&(bo.physicsCollisionIterations=4,bo.mouseTrailEnabled=!1));const r=bo.R_MED;S();const l=bo.R_MED;if(Math.abs(l-r)>.1)try{if(Number.isFinite(l)&&l>0&&Array.isArray(bo.balls)&&bo.balls.length)for(let e=0;bo.balls.length>e;e++){const t=bo.balls[e];t&&(t.r=l,t.rBase=l)}}catch(s){}}function S(){const e=bo.ballSizeMin||28.6,t=bo.ballSizeMax||39,a=bo.ballSizeBreakpointMin||320,n=bo.ballSizeBreakpointMax||1920,o=bo.ballSizeCurve||1,i=l(),r=e+(t-e)*Math.pow(Math.max(0,Math.min(1,(i-a)/(n-a))),o);bo.R_MED=r,bo.R_MIN=r,bo.R_MAX=r}function k(){const e=((e=new Date)=>{const t=new Date(e.getFullYear(),0,0);return Math.floor((e-t)/864e5)})();return uo[e%uo.length]}function C(e){const t=+e;return Number.isFinite(t)?0>t?0:t>1?1:t:0}function F(e){const t=((e||"")+"").trim();if(!t)return null;const a="#"===t[0]?t.slice(1):t;if(3!==a.length&&6!==a.length)return null;const n=parseInt(3===a.length?a[0]+a[0]+a[1]+a[1]+a[2]+a[2]:a,16);return Number.isFinite(n)?{r:n>>16&255,g:n>>8&255,b:255&n}:null}function L({r:e,g:t,b:a}){return"#"+((255&e)<<16|(255&t)<<8|255&a).toString(16).padStart(6,"0")}function O({r:e,g:t,b:a}){const n=C(e),o=C(t),i=C(a),r=Math.max(n,o,i),l=r-Math.min(n,o,i);let s=0;return l>0&&(s=r===n?(o-i)/l%6:r===o?(i-n)/l+2:(n-o)/l+4,s*=60,0>s&&(s+=360)),{h:s,s:r>0?l/r:0,v:r}}function D({h:e,s:t,v:a}){const n=(+e%360+360)%360,o=C(t),i=C(a),r=i*o,l=r*(1-Math.abs(n/60%2-1)),s=i-r;let d=0,c=0,u=0;return 60>n?(d=r,c=l,u=0):120>n?(d=l,c=r,u=0):180>n?(d=0,c=r,u=l):240>n?(d=0,c=l,u=r):300>n?(d=l,c=0,u=r):(d=r,c=0,u=l),{r:d+s,g:c+s,b:u+s}}function I(e,{satMul:t=0,valMul:a=0}={}){const n=F(e);if(!n)return((e||"")+"").trim()||"#ffffff";const o=O({r:n.r/255,g:n.g/255,b:n.b/255}),i=(e=>Math.max(0,Math.min(.88,+e||0)))(o.s*(1+(+t||0))),r=C(o.v*(1+(+a||0))),l=D({h:o.h,s:i,v:r});return L({r:Math.round(255*l.r),g:Math.round(255*l.g),b:Math.round(255*l.b)})}function P(e,t,a){return Math.round(e+(t-e)*a)}function W(e,t,a){const n=C(a),o=F(e),i=F(t);return o||i?o?i?L({r:P(o.r,i.r,n),g:P(o.g,i.g,n),b:P(o.b,i.b,n)}):e+"":t+"":"#ffffff"}function K(e){const t=+e;return Number.isFinite(t)?0>t?0:t>255?255:t:0}function T(e,t,a=1){const n=Math.max(1,+a||1),o=F(e),i=F(t);return o||i?o&&i?L({r:K(o.r+(i.r-o.r)*n),g:K(o.g+(i.g-o.g)*n),b:K(o.b+(i.b-o.b)*n)}):t+"":"#ffffff"}function E(e,t,a=.5){const n=C(a),o=[,,,,,,,,];for(let i=0;8>i;i++)o[i]=W(e?.[i],t?.[i],n);return o}function B(e,t,a=1.25){const n=[,,,,,,,,];for(let i=0;8>i;i++)n[i]=t?.[i];const o=[3,5,6,7];for(let i=0;o.length>i;i++){const r=o[i];n[r]=T(e?.[r],t?.[r],a)}return n}function A(e,t){const a=[,,,,,,,,];for(let o=0;8>o;o++)a[o]=e?.[o];const n=[3,5,6,7];for(let o=0;n.length>o;o++){const e=n[o];a[e]=I(a[e],t)}return a}function G(e,t=.2){const a=[,,,,,,,,];for(let i=0;8>i;i++)a[i]=e?.[i];let n=-1,o=-1;for(let i=0;8>i;i++){const e=a[i];if(!e)continue;const t=H(e);t>o&&(o=t,n=i)}return 0>n||(a[n]=I(a[n],{satMul:t,valMul:0})),a}function R(e,t,a,n=t){const o=+e;if(!Number.isFinite(o))return n;const i=Math.floor(o);return t>i?t:i>a?a:i}function z(e,t,a){const n=+e;if(!Number.isFinite(n))return t;const o=Math.floor(n);return t>o?t:o>a?a:o}function $(e){return Array.isArray(e)&&e.every(e=>Number.isFinite(+e))}function _(e){const t=((e||"")+"").trim();if(!t)return null;const a="#"===t[0]?t.slice(1):t;if(3!==a.length&&6!==a.length)return null;const n=parseInt(3===a.length?a[0]+a[0]+a[1]+a[1]+a[2]+a[2]:a,16);return Number.isFinite(n)?{r:(n>>16&255)/255,g:(n>>8&255)/255,b:(255&n)/255}:null}function N(e){return e>.04045?Math.pow((e+.055)/1.055,2.4):e/12.92}function V(e){const t=_(e);return t?.2126*N(t.r)+.7152*N(t.g)+.0722*N(t.b):1}function H(e){const t=_(e);if(!t)return 0;const a=Math.max(t.r,t.g,t.b);return a>0?(a-Math.min(t.r,t.g,t.b))/a:0}function j(e,t){const a=q(e),n=q(t);return(Math.max(a,n)+.05)/(Math.min(a,n)+.05)}function q({r:e,g:t,b:a}){const n=e=>{const t=e/255;return t>.04045?Math.pow((t+.055)/1.055,2.4):t/12.92};return.2126*n(e)+.7152*n(t)+.0722*n(a)}function Z(e,t){const a=t||b(),n=e&&e.length?e:[],o=Math.min(7,n.length-1);if(0>o)return[];const i=Number.isFinite(+a.cursorColorLumaMax)?+a.cursorColorLumaMax:.62,r=$(a.cursorColorAllowIndices)?a.cursorColorAllowIndices.map(e=>z(e,0,7)):[],l=$(a.cursorColorDenyIndices)?a.cursorColorDenyIndices.map(e=>z(e,0,7)):[],s=new Set(l),d=r.length?new Set(r):null,c=[];for(let p=0;o>=p;p++){if(s.has(p))continue;if(d&&!d.has(p))continue;const e=n[p];e&&(V(e)>i||.18>H(e)||c.push(p))}if(c.length)return c;const u=[];for(const p of Do)p>o||s.has(p)||d&&!d.has(p)||u.push(p);if(u.length)return u;for(let p=0;o>=p;p++)s.has(p)||d&&!d.has(p)||u.push(p);return u}function Y(e,{forceMode:t}={}){const a=b(),n=a.currentColors,o=Z(n,a),i=z(e,0,7),r=o.includes(i)?i:o[0]??i,l=((e,t)=>{const a=e&&e.length?e:[];return a[z(t,0,Math.max(0,Math.min(7,a.length-1)))]||"#000000"})(n,r);return t&&(a.cursorColorMode=t),a.cursorColorIndex=r,a.cursorColorHex=l,(e=>{try{document.documentElement.style.setProperty("--cursor-color",(e+"").trim()||"#000000");const t=(e=>{const t=b(),a=t?.isDarkMode||!1,n=F(e);if(!n)return null;const o=F(a?t.bgDark||"#0a0a0a":t.bgLight||"#f5f5f5");if(!o)return null;const i=.12,r={r:Math.round(o.r+(n.r-o.r)*i),g:Math.round(o.g+(n.g-o.g)*i),b:Math.round(o.b+(n.b-o.b)*i)},l=((e,t,a=null)=>{const n={r:255,g:255,b:255},o={r:0,g:0,b:0},i=a=>{for(let n=0;20>=n;n++){const o=n/20,i={r:Math.round(e.r+(a.r-e.r)*o),g:Math.round(e.g+(a.g-e.g)*o),b:Math.round(e.b+(a.b-e.b)*o)},r=j(i,t);if(r>=4.5)return{rgb:i,t:o,cr:r}}return null},r=i(n),l=i(o);if(r&&l)return"black"===a?l.rgb:"white"===a?r.rgb:r.t>l.t?l.rgb:r.rgb;if(r)return r.rgb;if(l)return l.rgb;const s=j(n,t);return j(o,t)>s?o:n})(n,r,V(L(r))>.45?"black":"white");return`rgb(${l.r} ${l.g} ${l.b})`})(e);t&&document.documentElement.style.setProperty("--cursor-hover-fg",t)}catch(t){}})(l),{index:r,hex:l}}function U(){const e=b();if("auto"!==e.cursorColorMode)return Y(e.cursorColorIndex,{forceMode:e.cursorColorMode}),!1;const t=Z(e.currentColors,e);if(!t.length)return!1;const a=Number.isFinite(+e.o)?+e.o:-1;let n=t[Math.random()*t.length|0];return t.length>1&&n===a&&(n=t[Math.random()*t.length|0],n===a&&(n=t[(t.indexOf(a)+1)%t.length])),e.o=n,Y(n,{forceMode:"auto"}),!0}function X(e){const t=b(),a=Co[e];if(!a)return Co.industrialTeal.light;const n=t.isDarkMode||!1;return((e,t,a=!1)=>{if(!e||!Array.isArray(e))return e;const n=[...e],o=_(t);if(!o)return n;const i=O(o),r=.05>i.s?0:i.h,l=[0,1];for(const s of l){const e=n[s];if(!e)continue;const t=_(e);if(!t)continue;const o=O(t),i=Math.max(0,Math.min(.15,.1*o.s));let l=o.v;a&&(l=Math.max(.15,.55*o.v));const d=D({h:r,s:i,v:l});n[s]=L({r:Math.round(255*d.r),g:Math.round(255*d.g),b:Math.round(255*d.b)})}return n})(t.isDarkMode?a.dark:a.light,n?t.bgDark||"#0a0a0a":t.bgLight||"#f5f5f5",n)}function Q(){const e=b(),t=e.currentColors;if(!t||0===t.length)return console.warn("No colors available, using fallback"),{color:"#ffffff",distributionIndex:0};const a=(e=>{const t=e?.colorDistribution;return Array.isArray(t)?t:null})(e);if(a&&a.length){let e=0;for(let t=0;a.length>t;t++){const n=+a[t]?.weight;Number.isFinite(n)&&n>0&&(e+=n)}if(e>0){let n=Math.random()*e;for(let e=0;a.length>e;e++){const o=a[e],i=+o?.weight;if(Number.isFinite(i)&&i>0&&(n-=i,0>=n))return{color:t[R(o?.colorIndex,0,7,0)]||t[0]||"#ffffff",distributionIndex:e}}const o=a[a.length-1];return{color:t[R(o?.colorIndex,0,7,0)]||t[0]||"#ffffff",distributionIndex:a.length-1}}}const n=Math.random();let o=0;const i=Math.min(t.length,8,8);for(let r=0;i>r;r++)if(o+=Oo[r],o>=n)return{color:t[r],distributionIndex:r};return{color:t[Math.min(t.length-1,7)]||"#ffffff",distributionIndex:0}}function J(){return Q().color}function ee(e){const t=b().currentColors;return t&&0!==t.length?t[Math.max(0,Math.min(7,Math.floor(e)))]||"#ffffff":(console.warn("No colors available, using fallback"),"#ffffff")}function te(e){const t=b();t.currentTemplate=e,t.currentColors=X(e);try{localStorage.setItem(Lo,(e||"")+"")}catch(a){}try{const t=document.getElementById("colorSelect");t&&(t.value=e)}catch(a){}"auto"!==t.cursorColorMode&&"manual"!==t.cursorColorMode&&(t.cursorColorMode="auto"),Y(t.cursorColorIndex,{forceMode:t.cursorColorMode}),(()=>{const e=b(),t=e.balls,a="critters"===e.currentMode,n=[0,1];for(let o=0;t.length>o;o++)t[o].color=a?ee(n[Math.floor(Math.random()*n.length)]):J()})(),(e=>{try{const t=document.documentElement,a=(e&&e.length?e:[]).slice(0,8);for(let e=0;8>e;e++)t.style.setProperty("--ball-"+(e+1),a[e]||"#ffffff")}catch(a){}})(t.currentColors),(()=>{const e=b().currentColors;for(let t=1;8>=t;t++){const a=document.getElementById("color"+t),n=document.getElementById(`color${t}Val`);a&&e[t-1]&&(a.value=e[t-1],n&&(n.textContent=e[t-1].toUpperCase()))}})();try{window.dispatchEvent(new CustomEvent("bb:paletteChanged",{detail:{template:e}}))}catch(a){}}function ae(){const e=document.getElementById("colorSelect");if(!e)return;e.innerHTML="";for(const a of Fo){const t=Co[a];if(!t)continue;const n=document.createElement("option");n.value=a,n.textContent=t.label,e.appendChild(n)}const t=b();e.value=t.currentTemplate}function ne(){const e=b(),t=Fo.length?Fo:Object.keys(Co);if(!t.length)return null;let a=null;try{a=localStorage.getItem(Lo)}catch(i){}const n="string"==typeof a?t.indexOf(a):-1,o=t[0>n?Math.random()*t.length|0:(n+1)%t.length];e.currentTemplate=o;try{localStorage.setItem(Lo,o)}catch(i){}return o}function oe(e,t=.15){return e*(1+2*(Math.random()-.5)*t)}function ie(e){for(const[t,a]of Object.entries(e))t in Wo&&(Wo[t]=a)}function re(){try{"undefined"!=typeof window&&window.dispatchEvent&&window.dispatchEvent(new CustomEvent(qo,{detail:Ce()}))}catch(e){}}function le(){if(!di&&(di=!0,"undefined"!=typeof window&&window.matchMedia)){const e=window.matchMedia("(prefers-reduced-motion: reduce)");Qo=e.matches,e.addEventListener("change",e=>{Qo=e.matches})}}function se(e){const t=e&&"object"==typeof e?e:null;if(!t)return;if("string"==typeof t.soundPreset&&Oe(t.soundPreset),t.soundConfig&&"object"==typeof t.soundConfig)return void Le(t.soundConfig);const a={};let n=!1;for(const[o,i]of Object.entries(t))o in Ko&&(a[o]=i,n=!0);n&&Le(a)}async function de(){if(jo)return!0;try{const e=window.AudioContext||window.webkitAudioContext;return e?(Bo=new e({latencyHint:"interactive",sampleRate:44100}),"suspended"===Bo.state&&await Bo.resume(),(()=>{Ao=Bo.createGain(),Ao.gain.value=Ko.masterGain,$o=Bo.createDynamicsCompressor(),$o.threshold.value=-12,$o.knee.value=3,$o.ratio.value=20,$o.attack.value=.001,$o.release.value=.05,No=Bo.createBiquadFilter(),No.type="highshelf",No.frequency.value=Ko.highShelfFreq,No.gain.value=Ko.highShelfGain,No.Q.value=.7,_o=Bo.createWaveShaper(),_o.curve=((e=.55)=>{const t=1024,a=new Float32Array(t),n=1+8*e;for(let o=0;t>o;o++)a[o]=Math.tanh(n*(2*o/(t-1)-1))/Math.tanh(n);return a})(.55),_o.oversample="2x",Ro=Bo.createGain(),Ro.gain.value=1-Ko.reverbWetMix,zo=Bo.createGain(),zo.gain.value=Ko.reverbWetMix,Go=(()=>{const e=Bo.createGain(),t=Bo.createGain(),a=[.029,.037,.053,.067].map(e=>{const t=Bo.createDelay(.1);return t.delayTime.value=e*Ko.reverbDecay,t}),n=a.map(()=>{const e=Bo.createGain();return e.gain.value=.4,e}),o=Bo.createBiquadFilter();return o.type="lowpass",o.frequency.value=2e3*(1-Ko.reverbHighDamp),o.Q.value=.5,a.forEach((t,i)=>{e.connect(t),t.connect(n[i]),n[i].connect(o),n[i].connect(a[(i+1)%a.length])}),o.connect(t),e.connect(t),e.l=t,e})();const e=Go.l;Ro.connect(_o),zo.connect(Go),e.connect(_o),_o.connect(No),No.connect($o),$o.connect(Ao),Ao.connect(Bo.destination),ce(),(()=>{Yo=[];for(let e=0;Zo>e;e++){const t={id:e,inUse:!1,startTime:0,filter:Bo.createBiquadFilter(),envelope:Bo.createGain(),panner:Bo.createStereoPanner(),reverbSend:Bo.createGain(),noiseFilter:Bo.createBiquadFilter(),noiseEnvelope:Bo.createGain(),osc:null,harmonicOsc:null,sparkleOsc:null,noiseSource:null};t.filter.type="lowpass",t.noiseFilter.type="bandpass",t.noiseFilter.Q.value=1.2,t.filter.connect(t.envelope),t.envelope.connect(t.panner),t.panner.connect(Ro),t.panner.connect(t.reverbSend),t.reverbSend.connect(zo),t.noiseFilter.connect(t.noiseEnvelope),t.noiseEnvelope.connect(t.panner),Yo.push(t)}})()})(),jo=!0,Ho=!0,re(),console.log(` Audio unlocked (${(1e3*(Bo.baseLatency||0)).toFixed(1)}ms base latency)`),!0):(console.warn("Web Audio API not supported"),!1)}catch(e){return console.error("Failed to unlock audio:",e),!1}}function ce(){if(Bo){if(Vo)try{Vo.disconnect()}catch(e){}else Vo=Bo.createGain(),Vo.gain.value=1;Vo.connect($o||Bo.destination)}}function ue(){if(ei||!Bo)return;const e=Bo.sampleRate;ei=Bo.createBuffer(1,Math.floor(.045*e),e);const t=ei.getChannelData(0),a=Math.floor(.003*e),n=Math.floor(.01*e);for(let o=0;a>o;o++){const e=Math.exp(-o/a*6);t[o]=(2*Math.random()-1)*e}for(let o=a;n>o;o++){const i=.65*(1-(o-a)/(n-a));t[o]=Math.sin(1760*Math.PI*(o/e))*i}}function pe(){if(si&&(clearTimeout(si),si=null),ti){try{ti.stop()}catch(e){}ti.disconnect(),ai.disconnect(),ni.disconnect(),ti=ai=ni=null}if(ii){try{ii.stop()}catch(e){}ii.disconnect(),ri.disconnect(),li.disconnect(),ii=ri=li=null}}function me(e,t){if(!Ho||!jo||!Bo||Qo)return;ce(),ue();const a=Bo.createBufferSource();a.buffer=ei;const n=Bo.createGain();n.gain.value=e;const o=Bo.createBiquadFilter();o.type="lowpass",o.frequency.value=t,a.connect(o).connect(n).connect(Vo),a.start()}function he(e=0){if(!Ho||!jo||!Bo||Qo)return void pe();if(!Wo.continuousEnabled)return void pe();const t=Math.abs(e);if(!Number.isFinite(t))return;if(Wo.tickMinVelocity>t)return ai&&ai.gain.setTargetAtTime(0,Bo.currentTime,.05),ri&&ri.gain.setTargetAtTime(0,Bo.currentTime,.08),void(si||(si=setTimeout(pe,Wo.stopDelayMs)));si&&(clearTimeout(si),si=null),Bo&&(ti&&ii||(ce(),ue(),ti=Bo.createBufferSource(),ti.buffer=ei,ti.loop=!0,ai=Bo.createGain(),ai.gain.value=0,ni=Bo.createBiquadFilter(),ni.type="highpass",ni.frequency.value=700,ti.connect(ni).connect(ai).connect(Vo),ti.start(),(()=>{if(oi||!Bo)return;const e=Bo.sampleRate,t=Math.floor(.28*e);oi=Bo.createBuffer(1,t,e);const a=oi.getChannelData(0);for(let n=0;t>n;n++){const e=n/t,o=.08>e?e/.08:e>.92?(1-e)/.08:1;a[n]=(2*Math.random()-1)*o*.6}})(),ii=Bo.createBufferSource(),ii.buffer=oi,ii.loop=!0,ri=Bo.createGain(),ri.gain.value=0,li=Bo.createBiquadFilter(),li.type="bandpass",li.frequency.value=Wo.swishMinHz,li.Q.value=.8,ii.connect(li).connect(ri).connect(Vo),ii.start()));const a=Bo.currentTime,n=Se((t-Wo.tickMinVelocity)/(Wo.tickMaxVelocity-Wo.tickMinVelocity),0,1);ti&&ti.playbackRate.setTargetAtTime(Wo.tickMinRate+(Wo.tickMaxRate-Wo.tickMinRate)*n,a,.04),ai&&ai.gain.setTargetAtTime(Wo.tickBaseGain*(.35+.75*n)*Math.max(0,Number.isFinite(Wo.tickGainMul)?Wo.tickGainMul:1),a,.05);const o=Se((t-Wo.swishMinVelocity)/(Wo.swishMaxVelocity-Wo.swishMinVelocity),0,1);if(ri){const e=Number.isFinite(Wo.swishGainMul)?Wo.swishGainMul:1;ri.gain.setTargetAtTime(Wo.swishBaseGain*Math.pow(o,1.4)*Math.max(0,e),a,.08)}li&&li.frequency.setTargetAtTime(Wo.swishMinHz+(Wo.swishMaxHz-Wo.swishMinHz)*o,a,.08)}function fe(){me(Wo.snapGain,1600)}function ge(){me(Wo.centerGain,Wo.centerFilterHz||1600)}function be(){me(Wo.openGain,Wo.openFilterHz||1800)}function ye(){me(Wo.closeGain,Wo.closeFilterHz||1600)}function ve(){Ho&&jo&&Bo&&!Qo&&me(.099,2200)}function we(e,t,a=.5,n=null){if(!Ho||!jo||!Bo||Qo)return;if(Ko.collisionMinImpact>t)return;const o=Bo.currentTime;if(.005>o-Uo)return;if(null!==n){const e=Xo.get(n)||0;if(Ko.minTimeBetweenSounds>o-e)return;Xo.set(n,o)}if(Uo=o,Xo.size>200){const e=o-.5;for(const[t,a]of Xo)e>a&&Xo.delete(t)}const i=(()=>{for(let t=0;Zo>t;t++)if(!Yo[t].inUse)return Yo[t];let e=Yo[0];for(let t=1;Zo>t;t++)e.startTime>Yo[t].startTime&&(e=Yo[t]);return Me(e),e})();i&&((e,t,a,n,o)=>{e.inUse=!0,e.startTime=o;const i=Math.pow(Math.max(0,Math.min(1,a)),Ko.intensityExponent),r=oe(t,Ko.variancePitch),l=oe(Ko.decayTime,Ko.varianceDecay)*(1-i*(1-Ko.velocityDecayScale)),s=l+.02;let d=Ko.minGain+(Ko.maxGain-Ko.minGain)*i;d*=oe(1,Ko.varianceGain);const c=1+(Ko.velocityBrightnessScale-1)*i;let u=Ko.filterBaseFreq+Ko.filterVelocityRange*Math.pow(i,1.3);u*=oe(1,Ko.varianceFilter)*c;const p=2*(n-.5)*Ko.maxPan,m=.12+.5*(1-i);({gain:d,filterFreq:u}=((e,t,a)=>{const n=Se((e-Ko.toneSafetyMinHz)/(Ko.toneSafetyMaxHz-Ko.toneSafetyMinHz),0,1),o=Ko.toneSafetyExponent,i=Math.pow(n,o),r=Se(1-Ko.toneSafetyHighGainAtten*i-Ko.toneSafetyLowGainAtten*Math.pow(1-n,o),.6,1);let l=Math.min(t*r,Ko.voiceGainMax);const s=Se(1-Ko.toneSafetyHighBrightAtten*i,.55,1);return{gain:l,filterFreq:Se(a*s,Ko.filterMinHz,Ko.filterMaxHz)}})(r,d,u)),e.filter.frequency.value=u,e.filter.Q.value=Ko.filterQ,e.panner.pan.value=p,e.reverbSend.gain.value=m,e.noiseFilter.Q.value=Se(Ko.noiseTransientQ||1.2,.5,8),e.envelope.gain.cancelScheduledValues(o),e.envelope.gain.setValueAtTime(d,o),e.envelope.gain.exponentialRampToValueAtTime(.001,o+l);const h=Bo.createOscillator();if(h.type="sine",h.frequency.value=r,e.osc=h,h.connect(e.filter),(Ko.harmonicGain||0)>.001){const t=Bo.createOscillator();t.type="sine",t.frequency.value=2*r;const a=Bo.createGain();a.gain.cancelScheduledValues(o),a.gain.setValueAtTime(d*Ko.harmonicGain,o),a.gain.exponentialRampToValueAtTime(.001,o+l),e.harmonicOsc=t,t.connect(a),a.connect(e.filter),t.onended=()=>{try{a.disconnect()}catch(e){}},t.start(o),t.stop(o+s)}else e.harmonicOsc=null;if((Ko.sparkleGain||0)>.001){const t=Bo.createOscillator();t.type="sine";const a=Ko.sparkleRatioMin||2.3,n=Ko.sparkleRatioMax||4.1,i=Se(a+Math.random()*(n-a),1.2,10);t.frequency.value=r*oe(i,.02);const c=Bo.createGain(),u=Math.max(.012,l*Se(Ko.sparkleDecayMul||.65,.25,.95));c.gain.cancelScheduledValues(o),c.gain.setValueAtTime(d*Ko.sparkleGain,o),c.gain.exponentialRampToValueAtTime(.001,o+u),e.sparkleOsc=t,t.connect(c),c.connect(e.filter),t.onended=()=>{try{c.disconnect()}catch(e){}},t.start(o),t.stop(o+s)}else e.sparkleOsc=null;if(Ko.noiseTransientEnabled&&i>.25){const t=(()=>{if(!Jo){const e=2*Bo.sampleRate;Jo=Bo.createBuffer(1,e,Bo.sampleRate);const t=Jo.getChannelData(0);let a=0,n=0,o=0;for(let i=0;e>i;i++){const e=2*Math.random()-1;a=.99765*a+.099046*e,n=.963*n+.2965164*e,o=.57*o+1.0526913*e,t[i]=.25*(a+n+o+.1848*e)}}const e=Bo.createBufferSource();return e.buffer=Jo,e.loopStart=1.5*Math.random(),e.loopEnd=e.loopStart+.1,e.loop=!1,e})();e.noiseSource=t;const a=Math.pow(i,1.4);e.noiseFilter.frequency.value=oe(Ko.noiseTransientFilterMin+(Ko.noiseTransientFilterMax-Ko.noiseTransientFilterMin)*a,Ko.varianceNoise);const n=Ko.noiseTransientGain*Ko.velocityNoiseScale*a*d,r=oe(Ko.noiseTransientDecay,Ko.varianceNoise);e.noiseEnvelope.gain.cancelScheduledValues(o),e.noiseEnvelope.gain.setValueAtTime(n,o),e.noiseEnvelope.gain.exponentialRampToValueAtTime(.001,o+r),t.connect(e.noiseFilter),t.start(o),t.stop(o+r+.01)}else e.noiseSource=null;h.start(o),h.stop(o+s),h.onended=()=>Me(e)})(i,(e=>{const t=1-Se((e-8)/47,0,1),a=Se(Ko.pitchMinHz||145,40,6e3),n=Se(Ko.pitchMaxHz||280,a+10,12e3),o=Se(Ko.pitchCurve||1,.5,2.5);return(a+Math.pow(t,o)*(n-a))*oe(1,1.5*(Ko.variancePitch||.06))})(e),Math.max(0,Math.min(1,t)),a,o)}function xe({intensity:e=.82,radius:t=18,xPosition:a=.72}={}){we(t,e,a,null)}function Me(e){if(e.osc){try{e.osc.stop(),e.osc.disconnect()}catch(t){}e.osc=null}if(e.harmonicOsc){try{e.harmonicOsc.stop(),e.harmonicOsc.disconnect()}catch(t){}e.harmonicOsc=null}if(e.sparkleOsc){try{e.sparkleOsc.stop(),e.sparkleOsc.disconnect()}catch(t){}e.sparkleOsc=null}if(e.noiseSource){try{e.noiseSource.stop(),e.noiseSource.disconnect()}catch(t){}e.noiseSource=null}e.inUse=!1}function Se(e,t,a){return t>e?t:e>a?a:e}function ke(){return!!jo&&(Ho=!Ho,Ho||pe(),re(),Ho)}function Ce(){return{isUnlocked:jo,isEnabled:Ho,activeSounds:Yo.filter(e=>e.inUse).length,poolSize:Zo}}function Fe(){return{...Ko}}function Le(e){for(const[t,a]of Object.entries(e))t in Ko&&(Ko[t]=a);zo&&Ro&&"reverbWetMix"in e&&(zo.gain.value=Ko.reverbWetMix,Ro.gain.value=1-Ko.reverbWetMix),No&&("highShelfFreq"in e||"highShelfGain"in e)&&(No.frequency.value=Ko.highShelfFreq,No.gain.value=Ko.highShelfGain),Ao&&"masterGain"in e&&(Ao.gain.value=Ko.masterGain)}function Oe(e){const t=To[e];if(!t)return!1;Eo=e;const{label:a,description:n,...o}=t;return Le(o),!0}function De(){return Eo}function Ie(){const e=b(),t=e.balls,a=e.canvas,n=e.R_MAX,o=e.ballSpacing||0,i=t.length;if(ui.length=0,2>i)return ui;const r=!1!==e.physicsSpatialGridOptimization;if(r){let e=!1;for(let a=0;i>a;a++){const n=t[a];if(n&&!n.isSleeping){e=!0;break}}if(!e)return ui}const l=Math.max(1,2*n*(1+o)),s=Math.ceil(a.width/l)+1;if(r)for(const d of ci.values())d.length=0;else ci.clear();for(let d=0;i>d;d++){const e=t[d],a=(e.y/l|0)*s+(e.x/l|0);let n=ci.get(a);n||(n=[],ci.set(a,n)),n.push(d)}for(const[d,c]of ci){if(0===c.length)continue;const e=d/s|0,a=d%s;for(let n=-1;1>=n;n++)for(let i=-1;1>=i;i++){const r=ci.get((e+n)*s+(a+i));if(r&&0!==r.length)for(let e=0;c.length>e;e++){const a=c[e];for(let e=0;r.length>e;e++){const n=r[e];if(a>=n)continue;const i=t[a],l=t[n],s=l.x-i.x,d=l.y-i.y,c=i.r+l.r+(i.r+l.r)/2*o,u=s*s+d*d;if(c*c>u){const e=c-Math.sqrt(Math.max(u,ho.MIN_DISTANCE_EPSILON)),t=ui.length;let o=pi[t];o||(o={i:0,j:0,overlap:0},pi[t]=o),o.i=a,o.j=n,o.overlap=e,ui.push(o)}}}}}return ui}function Pe(e=10){const t=b(),a=t.balls,n=Ie(),o=t.REST,i=.5*t.DPR,r=t.ballSpacing||0,l=!!t.physicsSkipSleepingCollisions;for(let s=0;e>s;s++)for(let e=0;n.length>e;e++){const{i:d,j:c}=n[e],u=a[d],p=a[c],m=p.x-u.x,h=p.y-u.y,f=u.r+p.r+(u.r+p.r)/2*r,g=m*m+h*h;if(0===g||g>f*f)continue;const b=Math.sqrt(g),y=m/b,v=h/b,w=f-b,x=1/Math.max(u.m,.001),M=1/Math.max(p.m,.001),S=u.isSleeping&&p.isSleeping,k=.8*Math.max(w-i,0)/(x+M),C=k*y,F=k*v;u.x-=C*x,u.y-=F*x,p.x+=C*M,p.y+=F*M;const L="pit"===t.currentMode;if(L&&-.3>v?p.hasSupport=!0:L&&v>.3&&(u.hasSupport=!0),l&&S)continue;if(S)continue;const O=p.vx-u.vx,D=p.vy-u.vy,I=O*y+D*v,P=-15*(t.DPR||1)>I;if((!u.isSleeping||P)&&(!p.isSleeping||P)&&(u.isSleeping&&u.wake(),p.isSleeping&&p.wake(),0>I)){const e=-(1+(30>Math.abs(I)?0:o))*I/(x+M),a=e*y,n=e*v;u.vx-=a*x,u.vy-=n*x,p.vx+=a*M,p.vy+=n*M;const i=O-I*y,r=D-I*v,l=Math.hypot(i,r);if(l>.001){const e=0>i*-v+r*y?-1:1,t=ho.SPIN_GAIN_TANGENT;u.omega-=e*t*l/Math.max(u.r,1),p.omega+=e*t*l/Math.max(p.r,1)}const c=Math.min(1,Math.abs(I)/(50*(u.r+p.r))),m=Math.min(t.getSquashMax(),.8*c);u.squashAmount=Math.max(u.squashAmount,.8*m),u.squashNormalAngle=Math.atan2(-v,-y),p.squashAmount=Math.max(p.squashAmount,.8*m),p.squashNormalAngle=Math.atan2(v,y),0===s&&we((u.r+p.r)/2,c,(u.x+p.x)/2/(t.canvas?.width||1),`${d}-${e}`)}}}function We(e,t,a,n,o,i){e.beginPath(),e.moveTo(t+i,a),e.lineTo(t+n-i,a),i>0&&e.arcTo(t+n,a,t+n,a+i,i),e.lineTo(t+n,a+o-i),i>0&&e.arcTo(t+n,a+o,t+n-i,a+o,i),e.lineTo(t+i,a+o),i>0&&e.arcTo(t,a+o,t,a+o-i,i),e.lineTo(t,a+i),i>0&&e.arcTo(t,a,t+i,a,i),e.closePath()}function Ke(e,t,a,n={}){const o=b();if(!e)return;const i=fi||Ee(),r=o.DPR||1,l="function"==typeof o.getCanvasCornerRadius?o.getCanvasCornerRadius():o.cornerRadius??o.wallRadius??0,s=Math.max(0,(+l||0)*r),d=Math.max(0,(+o.wallThickness||0)*r),c=Math.max(1,t-2*d),u=Math.max(1,a-2*d),p=Math.max(0,Math.min(s,.5*c,.5*u)),m=Math.max(2,2*r);e.save(),e.fillStyle=i,e.beginPath(),e.moveTo(-m,-m),e.lineTo(t+m,-m),e.lineTo(t+m,a+m),e.lineTo(-m,a+m),e.closePath();const h=d,f=d,g=p;e.moveTo(h+g,f+u),e.lineTo(h+c-g,f+u),e.arcTo(h+c,f+u,h+c,f+u-g,g),e.lineTo(h+c,f+g),e.arcTo(h+c,f,h+c-g,f,g),e.lineTo(h+g,f),e.arcTo(h,f,h,f+g,g),e.lineTo(h,f+u-g),e.arcTo(h,f+u,h+g,f+u,g),e.closePath();try{e.fill("evenodd")}catch(y){e.fill()}e.restore(),(n.wallGradientStrokeEnabled??o.wallGradientStrokeEnabled)&&((e,t,a,n,o,i,r,l,s)=>{(e=>{gi!==e&&(gi=e,bi="",yi=null,vi="",wi=null,xi="",Mi=null)})(e);const d=Math.max(1,(n.wallGradientStrokeWidth??.33)*o),c=i,u=i,p=s,m=`${c}|${u}|${r}|${l}|${p}`,h="function"==typeof Path2D;if(h&&m!==bi&&(bi=m,yi=((e,t,a,n,o)=>{const i=new Path2D;return i.moveTo(e+o,t),i.lineTo(e+a-o,t),o>0&&i.arcTo(e+a,t,e+a,t+o,o),i.lineTo(e+a,t+n-o),o>0&&i.arcTo(e+a,t+n,e+a-o,t+n,o),i.lineTo(e+o,t+n),o>0&&i.arcTo(e,t+n,e,t+n-o,o),i.lineTo(e,t+o),o>0&&i.arcTo(e,t,e+o,t,o),i.closePath(),i})(c,u,r,l,p)),n.wallGradientStrokeBottomEnabled??1){const o=.5*t,i=0,s=(n.wallGradientStrokeBottomRadius??1)*a*.7,m=n.wallGradientStrokeBottomOpacity??1,f=n.wallGradientStrokeBottomColor??"#ffffff",g=`${o}|${i}|${s}|${m}|${f}`;if(g!==vi){vi=g;const t=e.createRadialGradient(o,i,0,o,i,s);t.addColorStop(0,Te(f,m)),t.addColorStop(.1,Te(f,m)),t.addColorStop(.5,Te(f,.5*m)),t.addColorStop(1,Te(f,0)),wi=t}e.save(),e.strokeStyle=wi,e.lineWidth=d,e.lineCap="round",e.lineJoin="round",h&&yi?e.stroke(yi):(We(e,c,u,r,l,p),e.stroke()),e.restore()}if(n.wallGradientStrokeTopEnabled??1){const o=.5*t,i=(n.wallGradientStrokeTopRadius??1)*a*.7,s=n.wallGradientStrokeTopOpacity??.5,m=n.wallGradientStrokeTopColor??"#ffffff",f=`${o}|${a}|${i}|${s}|${m}`;if(f!==xi){xi=f;const t=e.createRadialGradient(o,a,0,o,a,i);t.addColorStop(0,Te(m,s)),t.addColorStop(.1,Te(m,s)),t.addColorStop(.5,Te(m,.5*s)),t.addColorStop(1,Te(m,0)),Mi=t}e.save(),e.strokeStyle=Mi,e.lineWidth=d,e.lineCap="round",e.lineJoin="round",h&&yi?e.stroke(yi):(We(e,c,u,r,l,p),e.stroke()),e.restore()}})(e,t,a,o,r,d,c,u,p)}function Te(e,t){let a,n,o;return 4===e.length?(a=parseInt(e[1]+e[1],16),n=parseInt(e[2]+e[2],16),o=parseInt(e[3]+e[3],16)):(a=parseInt(e.slice(1,3),16),n=parseInt(e.slice(3,5),16),o=parseInt(e.slice(5,7),16)),`rgba(${a}, ${n}, ${o}, ${t})`}function Ee(){try{const e=document.documentElement,t=document.body,a=document.getElementById("bravia-balls"),n=(e,t)=>{if(!e)return"";try{return getComputedStyle(e).getPropertyValue(t).trim()||getComputedStyle(e).getPropertyValue(t).trim()}catch(a){return""}};let o=n(e,"--wall-color");return o||(o=e.classList.contains("dark-mode")||t.classList.contains("dark-mode")?n(e,"--wall-color-dark")||n(e,"--frame-color-dark"):n(e,"--wall-color-light")||n(e,"--frame-color-light")),o||(o=n(t,"--wall-color")||n(a,"--wall-color")),o||"#0a0a0a"}catch{return"#0a0a0a"}}function Be(e){const t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return t?{r:parseInt(t[1],16),g:parseInt(t[2],16),b:parseInt(t[3],16)}:{r:0,g:0,b:0}}function Ae(e){Di=e}function Ge(){if(mi=document.getElementById("c"),!mi)return void console.error("Canvas not found");hi=mi.getContext("2d",{alpha:!0,desynchronized:!0,willReadFrequently:!1}),hi||(hi=mi.getContext("2d"),console.warn(" Desynchronized mode unavailable, using standard context")),(()=>{const e=window.devicePixelRatio||1;navigator.connection?.saveData||4>=navigator.hardwareConcurrency||/Android|iPhone|iPad|iPod/i.test(navigator.userAgent)?(Ci=Math.min(e,1.25),console.log(` Adaptive DPR: Reduced to ${Ci}x for performance`)):Ci=Math.min(e,2),o(Ci)})(),hi.imageSmoothingEnabled=!1;const e=()=>{Oi&&cancelAnimationFrame(Oi),Oi=requestAnimationFrame(()=>{Re(),Oi=null})};if(window.addEventListener("resize",e,{passive:!0}),window.addEventListener("orientationchange",()=>{setTimeout(Re,100),setTimeout(Re,300)},{passive:!0}),window.visualViewport&&(window.visualViewport.addEventListener("resize",e,{passive:!0}),window.visualViewport.addEventListener("scroll",e,{passive:!0})),"undefined"!=typeof ResizeObserver){const t=document.getElementById("bravia-balls");t&&new ResizeObserver(()=>{e()}).observe(t)}console.log(` Renderer optimized (DPR: ${Ci.toFixed(2)}, desync: ${hi.getContextAttributes?.()?.desynchronized??"unknown"})`)}function Re(){if(!mi)return;const e=b();try{const e=window.visualViewport,t=e&&"number"==typeof e.height?e.height:window.innerHeight,a=e&&"number"==typeof e.width?e.width:window.innerWidth,n=t>0?t:window.innerHeight,o=a>0?a:window.innerWidth,i=e&&"number"==typeof e.offsetTop?e.offsetTop:0,r=e&&"number"==typeof e.offsetLeft?e.offsetLeft:0,l=Number.isFinite(i)?i:0,s=Number.isFinite(r)?r:0;let d=l+n/2,c=s+o/2;c>0||(c=window.innerWidth/2),d>0||(d=window.innerHeight/2);const u=document.documentElement?.style;u?.setProperty("--abs-viewport-h",n+"px"),u?.setProperty("--abs-vv-offset-top",l+"px"),u?.setProperty("--abs-vv-offset-left",s+"px"),u?.setProperty("--abs-vv-h",n+"px"),u?.setProperty("--abs-vv-w",o+"px"),u?.setProperty("--abs-vv-center-x",c+"px"),u?.setProperty("--abs-vv-center-y",d+"px")}catch(c){}try{m(),h()}catch(c){}try{M()}catch(c){}const t=e.container||document.getElementById("bravia-balls"),a=t?t.clientWidth:window.innerWidth,n=t?t.clientHeight:window.innerHeight;if(0>=a||0>=n)return;const o=a+2,i=n+2,r=Ci,l=Math.ceil(o*r),s=Math.ceil(i*r);if(0>=l||0>=s)return;if(l===Fi&&s===Li)return;if(Fi>0&&Li>0&&e.balls&&e.balls.length>0){const t=l/Fi,a=s/Li;if(t>.1&&10>t&&a>.1&&10>a){const n=e.balls;for(let e=0;n.length>e;e++){const o=n[e];if(!o)continue;o.x*=t,o.y*=a;const i=o.r||10;o.x=Math.max(i,Math.min(l-i,o.x)),o.y=Math.max(i,Math.min(s-i,o.y)),o.isSleeping&&(o.isSleeping=!1,o.sleepTimer=0)}}}Fi=l,Li=s;const d=mi.width!==l||mi.height!==s;if(d&&(mi.width=l,mi.height=s,hi&&(hi.imageSmoothingEnabled=!1)),mi.style.width=o+"px",mi.style.height=i+"px",d&&((e=>{e.style.filter=""})(mi),Di))try{Di()}catch(c){}try{const t=0;(mi.width!==Ii||mi.height!==Pi||Math.abs(t-Wi)>.001)&&(Ii=mi.width,Pi=mi.height,Wi=t,e.canvasClipPath=((e,t,a)=>{const n=Math.max(0,Math.min(a,.5*Math.min(e,t)));if("undefined"==typeof Path2D)return null;const o=new Path2D;return n>0?(o.moveTo(n,0),o.lineTo(e-n,0),o.arcTo(e,0,e,n,n),o.lineTo(e,t-n),o.arcTo(e,t,e-n,t,n),o.lineTo(n,t),o.arcTo(0,t,0,t-n,n),o.lineTo(0,n),o.arcTo(0,0,n,0,n),o.closePath(),o):(o.rect(0,0,e,t),o)})(mi.width,mi.height,t))}catch(c){}}function ze(){return mi}function $e(){return hi}function _e(e,t,a,n){const o=+e;return Number.isFinite(o)?t>o?t:o>a?a:o:n}function Ne(e,{getForcesFn:t}={}){function a(o){if(!ji)return void(qi=null);Zi++;const i=b(),r=(e=>{if(!1===e?.featureRenderSchedulerEnabled)return 60;const t=_e(e?.renderTargetFpsDesktop,30,60,60),a=_e(e?.renderTargetFpsMobile,30,60,60),n=_e(e?.renderTargetFpsReducedMotion,30,60,60),o=e?.isMobile||e?.isMobileViewport?a:t,i=(e=>{if(e?.isMobile||e?.isMobileViewport)return 60;const t=+globalThis?.navigator?.hardwareConcurrency||4,a=+globalThis?.navigator?.deviceMemory||4;return t>4&&a>4?t>8&&a>8?120:90:60})(e);let r=(()=>{try{return!1}catch(e){}try{return(globalThis?.location?.port??"")+""=="8001"}catch(e){return!1}})()||!0===e?.performanceModeEnabled?o:Math.min(o,i);return(()=>{try{return!!window.matchMedia?.("(prefers-reduced-motion: reduce)")?.matches}catch(e){return!1}})()&&(r=Math.min(r,n)),_e(r,30,60,60)})(i),l=1e3/r,s=o-Hi;if(l>s)return void(qi=requestAnimationFrame(a));Hi=o-s%l,((e,t)=>{if(Ui.push(e),Ui.length>30&&Ui.shift(),30===Ui.length){const e=Ui.reduce((e,t)=>e+t,0)/30,a=1e3/Math.max(1,e);Qi=a;const n=Math.max(22,.5*t),o=Math.max(45,.8*t);n>a&&2>Xi?(Xi++,console.log(` Adaptive throttle increased to level ${Xi} (avg FPS: ${a.toFixed(1)})`)):a>o&&Xi>0&&(Xi--,console.log(` Adaptive throttle decreased to level ${Xi} (avg FPS: ${a.toFixed(1)})`))}})(s,r);const d=o/1e3;let c=Math.min(.033,d-Vi);Vi=d,t&&(n=t());const u=0>=Xi||(1===Xi?Zi%4!=0:Zi%2==0);u&&Qt(c,n??e),Jt(),((e,t={})=>{const a=+e||performance.now();if(0===Ti&&(Ti=a),Bi>0&&(Ri=a-Bi,Ri>16.67&&zi++,Ri>8.33&&$i++),Bi=a,Ai++,Ni={targetFPS:+t.targetFPS||Ni.targetFPS,throttleLevel:+t.throttleLevel||0,throttled:!!t.throttled},a-Ti>=1e3){Gi=Math.round(1e3*Ai/Math.max(1,a-Ti)),Ai=0,Ti=a;const e=document.getElementById("render-fps");e&&(e.textContent=Gi+"")}((e,t)=>{if(250>e-Ei)return;if(Ei=e,!(()=>{if(!(()=>{try{return!1}catch(e){}try{if((globalThis?.location?.port??"")+""=="8001")return!0}catch(e){}try{return Array.from(document?.scripts||[]).some(e=>{if("module"!==(e.getAttribute("type")||"").toLowerCase())return!1;const t=e.getAttribute("src")||"";return/(^|\/)main\.js(\?|#|$)/.test(t)})}catch(e){return!1}})())return!1;try{const e=b();return!1!==e?.performanceHudEnabled}catch(e){return!0}})())return void(()=>{if(_i){try{_i.remove()}catch(e){}_i=null}})();const a=(()=>{if(_i||"undefined"==typeof document)return _i;const e=document.createElement("div");return e.id="dev-perf-hud",e.className="dev-perf-hud",e.setAttribute("aria-hidden","true"),e.setAttribute("role","presentation"),e.style.pointerEvents="none",e.style.userSelect="none",e.style.zIndex="9999",document.body?.appendChild(e),_i=e,_i})();a&&(a.textContent=(e=>`FPS ${Number.isFinite(Gi)?Gi:0} / ${Number.isFinite(e.targetFPS)?Math.round(e.targetFPS):60} | ${Number.isFinite(Ri)?Ri.toFixed(2):"0.00"}ms | throttle L${Number.isFinite(e.throttleLevel)?e.throttleLevel:0} (${e.throttled?"yes":"no"}) | >16.67ms ${zi} | >8.33ms ${$i}`)(t))})(a,Ni)})(performance.now(),{targetFPS:r,throttleLevel:Xi,throttled:!u}),i&&(i.adaptiveThrottleLevel=Xi,i.adaptiveAverageFps=Qi,i.currentTargetFps=r),qi=requestAnimationFrame(a)}let n=null;Yi||(document.addEventListener("visibilitychange",()=>{ji=!document.hidden,ji?(Vi=performance.now()/1e3,Hi=performance.now(),console.log(" Animation resumed"),qi||(qi=requestAnimationFrame(a))):(console.log(" Animation paused (tab hidden)"),qi&&(cancelAnimationFrame(qi),qi=null))},{passive:!0}),Yi=!0),qi=requestAnimationFrame(a),console.log(" Render loop started (adaptive target FPS, visibility-aware)")}function Ve(e,t){if(!t)return null;const a=e?.[t];return"function"==typeof a?a:null}async function He(e){const t=er[e];if(!t)return null;if(tr.has(e))return tr.get(e);if(ar.has(e))return ar.get(e);const a=t.load().then(a=>{const n=((e,t={})=>({initialize:Ve(e,t.initialize),force:Ve(e,t.force),update:Ve(e,t.update),preRender:Ve(e,t.preRender),postRender:Ve(e,t.postRender),customRender:Ve(e,t.render),bounds:Ve(e,t.bounds)}))(a,t.hooks);return tr.set(e,n),ar.delete(e),n}).catch(t=>(ar.delete(e),console.warn(`[ModeLoader] Failed to load "${e}"`,t),null));return ar.set(e,a),a}function je(){if(!1!==b().featureLazyModeLoadingEnabled||nr)return;nr=!0;const e=Object.keys(er);for(let t=0;e.length>t;t++)He(e[t])}function qe(){const e=b().currentMode;return tr.get(e)||(ar.has(e)||He(e),null)}function Ze(){je()}async function Ye(e){const t=b();let a=e;a===co.PARALLAX_LINEAR&&(a=uo[0]??co.PIT),je();const n=++or,o=await He(a);if(n!==or)return!1;if(!o||"function"!=typeof o.initialize)return console.warn(`[ModeLoader] Runtime for "${a}" missing initialize hook.`),a!==co.PIT&&Ye(co.PIT);const i=t.currentMode;try{if(Gt(),Ui=[],Xi=0,Qi=60,Zi=0,((e,t)=>{e.currentMode===co.CRITTERS&&t!==co.CRITTERS&&(void 0!==e.u&&(e.REST=e.u,delete e.u),void 0!==e.p&&(e.FRICTION=e.p,delete e.p),void 0!==e.M&&(e.ballSpacing=e.M,delete e.M))})(t,a),w(a),a!==i)try{U?.()}catch(r){}if(console.log("Switching to mode: "+a),(e=>{const t=document.getElementById("announcer");t&&(t.textContent="",setTimeout(()=>{t.textContent=e},10))})(`Switched to ${Ji[a]||a} mode`),t.container){const e=t.container.classList.contains("dark-mode");t.container.className="",a===co.PIT&&t.container.classList.add("mode-pit"),(e||t.isDarkMode)&&t.container.classList.add("dark-mode")}if(Re(),((e,t)=>{const a=new Set([co.FLIES,co.WEIGHTLESS,co.WATER,co.MAGNETIC,co.BUBBLES,co.KALEIDOSCOPE,co.SPHERE_3D,co.CUBE_3D,co.CRITTERS,co.PARALLAX_LINEAR,co.PARALLAX_FLOAT,co.STARFIELD_3D,co.ELASTIC_CENTER]);e===co.PIT?(t.gravityMultiplier=t.gravityMultiplierPit,t.G=t.GE*t.gravityMultiplier,t.repellerEnabled=!0):e===co.PARTICLE_FOUNTAIN?(t.gravityMultiplier=t.particleFountainGravityMultiplier||1,t.G=t.GE*t.gravityMultiplier,t.repellerEnabled=!0):a.has(e)&&(t.gravityMultiplier=0,t.G=0,t.repellerEnabled=!1)})(a,t),((e,t)=>{t===co.CRITTERS&&(void 0===e.u&&(e.u=e.REST),void 0===e.p&&(e.p=e.FRICTION),void 0===e.M&&(e.M=e.ballSpacing),e.REST=e.critterRestitution??e.REST,e.FRICTION=e.critterFriction??e.FRICTION,e.ballSpacing=Math.min(e.ballSpacing||0,1))})(t,a),o.initialize(),console.log(`Mode ${a} initialized with ${t.balls.length} balls`),"undefined"!=typeof window&&window.legendFilter&&window.legendFilter.syncAllBalls)try{window.legendFilter.syncAllBalls()}catch(r){console.warn("Legend filter sync failed:",r)}const e=Math.max(0,Math.round(((e,t)=>{switch(e){case co.PIT:return t.pitWarmupFrames??10;case co.FLIES:return t.fliesWarmupFrames??10;case co.WEIGHTLESS:return t.weightlessWarmupFrames??10;case co.WATER:return t.waterWarmupFrames??10;case co.MAGNETIC:return t.magneticWarmupFrames??10;case co.BUBBLES:return t.bubblesWarmupFrames??10;case co.KALEIDOSCOPE:return t.kaleidoscope3WarmupFrames??t.kaleidoscopeWarmupFrames??10;case co.CRITTERS:return t.crittersWarmupFrames??10;case co.SPHERE_3D:return t.sphere3dWarmupFrames??10;case co.CUBE_3D:return t.cube3dWarmupFrames??10;case co.PARALLAX_LINEAR:return t.parallaxLinearWarmupFrames??10;case co.PARALLAX_FLOAT:return t.parallaxFloatWarmupFrames??10;case co.STARFIELD_3D:return t.starfield3dWarmupFrames??10;case co.ELASTIC_CENTER:return t.elasticCenterWarmupFrames??10;case co.PARTICLE_FOUNTAIN:return t.particleFountainWarmupFrames??0;default:return 10}})(a,t)||0));if(t.warmupFramesRemaining=e,"undefined"!=typeof window&&a!==i)try{window.dispatchEvent(new CustomEvent("bb:modeChanged",{detail:{prevMode:i,mode:a}}))}catch(r){}return!0}catch(l){return console.warn(`[ModeLoader] Failed while applying mode "${a}"`,l),a!==co.PIT&&Ye(co.PIT)}}function Ue(){const e=b();try{U?.()}catch(t){}return Ye(e.currentMode)}function Xe(){const e=qe();return e?.force||null}function Qe(){const e=qe();return e?.update||null}function Je(){const e=qe();return e?.preRender||e?.postRender?{preRender:e.preRender||null,postRender:e.postRender||null}:null}function et(){const e=qe();return e?.customRender||null}function tt(){const e=qe();return e?.bounds||null}function at(){if(!lr)return null;if(sr&&sr.isConnected)return sr;let e=document.getElementById("modal-modal-host");return e||(e=document.createElement("div"),e.id="modal-modal-host",e.className="modal-modal-host",lr.appendChild(e)),sr=e,sr}function nt(e){if(!lr||!e)return;const t=at();t&&(ur.has(e)||ur.set(e,{parent:e.parentNode,nextSibling:e.nextSibling}),t.appendChild(e))}function ot(e){if(!e)return;const t=ur.get(e);if(t&&t.parent)try{t.nextSibling&&t.nextSibling.parentNode===t.parent?t.parent.insertBefore(e,t.nextSibling):t.parent.appendChild(e)}catch(a){}}function it(){const t=e("--wall-thickness","");if(t&&!/calc\(|vw|vh|vmin|vmax|%/i.test(t)){const e=parseFloat(t);if(Number.isFinite(e)&&e>0)return e}const a=b();return a?.wallThickness||12}function rt(){if(rr&&!pr){const e=it();rr.style.setProperty("--modal-overlay-blur",e/4+"px")}}function lt(e){if(rr=document.getElementById("modal-blur-layer"),lr=document.getElementById("modal-content-layer"),!rr||!lr)return void console.warn("Modal Overlay: #modal-blur-layer or #modal-content-layer not found");if((()=>{const e=navigator.userAgent||"",t=navigator.vendor||"",a=/Safari\//.test(e)&&/Apple/.test(t)&&!/Chrome\//.test(e)&&!/Chromium\//.test(e),n=/iPad|iPhone|iPod/.test(e)||"MacIntel"===navigator.platform&&navigator.maxTouchPoints>1;return a||n})()&&document.documentElement.classList.add("is-safari"),dr=!1!==e.modalOverlayEnabled,!dr)return console.log("Modal Overlay: Disabled by config"),rr.style.display="none",void(lr.style.display="none");rr.style.display="",lr.style.display="",at();const o=e.modalOverlayOpacity??t("--modal-overlay-opacity",.01),i=e.modalOverlayTransitionMs??n("--modal-overlay-transition-duration",800),r=e.modalOverlayTransitionOutMs??n("--modal-overlay-transition-out-duration",600),l=e.modalOverlayContentDelayMs??n("--modal-content-delay",200),s=e.modalDepthScale??t("--modal-depth-scale",.96),d=e.modalDepthTranslateY??a("--modal-depth-translate-y",8),c=e.logoBlurInactive??a("--logo-blur-inactive",0),u=e.logoBlurActive??a("--logo-blur-active-target",12),p=document.documentElement;if(p.style.setProperty("--modal-depth-scale",s),p.style.setProperty("--modal-depth-translate-y",d+"px"),p.style.setProperty("--modal-depth-duration",i+"ms"),p.style.setProperty("--modal-depth-out-duration",r+"ms"),p.style.setProperty("--modal-content-delay",l+"ms"),p.style.setProperty("--logo-blur-inactive",c+"px"),p.style.setProperty("--logo-blur-active-target",u+"px"),p.style.setProperty("--logo-blur-active",c+"px"),void 0!==e.modalOverlayBlurPx?(pr=!0,rr.style.setProperty("--modal-overlay-blur",e.modalOverlayBlurPx+"px")):(pr=!1,rt()),cr)return;cr=!0,p.style.setProperty("--modal-overlay-opacity",o),p.style.setProperty("--modal-overlay-transition-duration",i+"ms"),p.style.setProperty("--modal-overlay-transition-out-duration",r+"ms"),rr.classList.remove("active"),lr.classList.remove("active"),rr.setAttribute("aria-hidden","true"),lr.setAttribute("aria-hidden","true"),dt(!1),lr.addEventListener("click",st,{capture:!0}),window.addEventListener("resize",()=>rt()),document.addEventListener("layout-updated",()=>rt());const m=it()/2;console.log(`Modal Overlay: Initialized (two-layer architecture, blur: ${m}px, transition: ${i}ms)`)}function st(e){if(!dr||!lr.classList.contains("active"))return;const t=e.target?.closest?e.target:e.target?.parentElement;if(!t?.closest)return;if(t.closest("button"))return;if(t.closest("input"))return;if(t.closest("a"))return;if(t.closest("select"))return;if(t.closest("textarea"))return;const a="cv-modal"===t.id||"portfolio-modal"===t.id||"contact-modal"===t.id||t.classList.contains("modal-label")||t.classList.contains("modal-description");(t===lr||"modal-modal-host"===t?.id||a)&&document.dispatchEvent(new CustomEvent("modal-overlay-dismiss",{detail:{instant:!1}}))}function dt(e){const t=document.documentElement,a=document.getElementById("abs-scene");if(e){const e=getComputedStyle(t).getPropertyValue("--modal-depth-scale").trim()||"0.96",n=getComputedStyle(t).getPropertyValue("--modal-depth-translate-y").trim()||"8px",o=getComputedStyle(t).getPropertyValue("--logo-blur-active-target").trim()||t.style.getPropertyValue("--logo-blur-active-target")||"12px";t.style.setProperty("--modal-depth-scale-active",e),t.style.setProperty("--modal-depth-ty-active",n),t.style.setProperty("--logo-blur-active",o),a&&a.classList.add("gate-depth-active")}else{const e=getComputedStyle(t).getPropertyValue("--logo-blur-inactive").trim()||"0px";t.style.setProperty("--modal-depth-scale-active","1"),t.style.setProperty("--modal-depth-ty-active","0px"),t.style.setProperty("--logo-blur-active",e),a&&a.classList.remove("gate-depth-active")}}function ct(){if(!rr||!lr||!dr)return;rt(),document.documentElement.classList.add("modal-active"),rr.setAttribute("aria-hidden","false"),lr.setAttribute("aria-hidden","false"),rr.classList.add("active"),lr.classList.add("active");const e=document.getElementById("custom-cursor");if(e){let a=!1;try{a=!(!window.matchMedia||!window.matchMedia("(max-width: 600px)").matches)}catch(t){}a?(e.classList.remove("modal-active"),e.style.display="none"):(e.classList.add("modal-active"),e.style.display="block")}dt(!0)}function ut(){if(!rr||!lr||!dr)return;rr.classList.remove("active"),lr.classList.remove("active"),document.documentElement.classList.remove("modal-active"),rr.setAttribute("aria-hidden","true"),lr.setAttribute("aria-hidden","true");const e=document.getElementById("custom-cursor");e&&e.classList.remove("modal-active"),dt(!1)}function pt(){return!!lr&&lr.classList.contains("active")}function mt(){try{return!!window.matchMedia?.("(prefers-reduced-motion: reduce)")?.matches}catch(e){return!1}}function ht(e,t,a){return t>e?t:e>a?a:e}function ft(e,t=.15){try{const a=parseInt(e.slice(1,3),16),n=parseInt(e.slice(3,5),16),o=parseInt(e.slice(5,7),16),i=Math.round(ht(a+(Math.random()-.5)*t*255,0,255)),r=Math.round(ht(n+(Math.random()-.5)*t*255,0,255)),l=Math.round(ht(o+(Math.random()-.5)*t*255,0,255));return`#${i.toString(16).padStart(2,"0")}${r.toString(16).padStart(2,"0")}${l.toString(16).padStart(2,"0")}`}catch(a){return e}}function gt(e,t,a,n=0,o={}){const i=b();if(!i?.cursorExplosionEnabled)return;if(mt())return;if(!i.canvas||!i.ctx)return;const r=i.DPR||1,l=(i.cursorExplosionSpeed??400)*r,s=Math.floor(i.cursorExplosionParticleCount??16),d=i.cursorExplosionSpreadDeg??360,c=i.cursorExplosionLifetime??.8,u=i.cursorExplosionImpactMinFactor??.5,p=ht(u+n/(i.cursorExplosionImpactSensitivity??400),u,i.cursorExplosionImpactMaxFactor??4),m=ht(o?.particleScale??1,.1,1),h=Math.floor(s*p*m),f=l*p,g=Math.min(d*(.6+.4*p),360),y=i.cursorExplosionLifetimeImpactMin??.7,v=c*ht(y+n/(i.cursorExplosionLifetimeImpactSensitivity??600),y,i.cursorExplosionLifetimeImpactMax??1.8);let w=Math.random()*Math.PI*2;const x=o?.emissionCenter;if(!x||x.x===e&&x.y===t){if(0!==Cr||0!==Fr){const e=Math.atan2(Fr,Cr),t=ht(n/500,.3,.8);w=e+(Math.random()-.5)*(1-t)*Math.PI*2}}else w=Math.atan2(t-x.y,e-x.x);const M=g*Math.PI/180,S=Math.min(h,hr-fr);for(let b=0;S>b;b++){const n=fr+b;if(n>=hr)break;const o=w+(Math.random()-.5)*M,l=f*(.8+.4*Math.random()),s=(i.cursorSize??1.15)*(i.R_MIN??5)*.3*r,d=Math.random()*Math.PI*2;gr[n]=e+Math.cos(d)*s*Math.random(),br[n]=t+Math.sin(d)*s*Math.random(),yr[n]=Math.cos(o)*l,vr[n]=Math.sin(o)*l,xr[n]=v*(.9+.2*Math.random()),wr[n]=0,Mr[n]=1;const c=ht(3*(i.cursorSize??1.15)*r,2*r,6*r);Sr[n]=c*(.8+.4*Math.random()),kr[n]=.7>Math.random()?a:ft(a,.12)}fr+=S}function bt(e){const t=+e?.sceneImpactMul,a=Number.isFinite(t)?t:0,n=+e?.sceneImpactMobileMulFactor,o=Number.isFinite(n)&&n>0?n:1;return a*((e=>{if(e?.isMobile||e?.isMobileViewport)return!0;try{return!(!window.matchMedia||!window.matchMedia("(max-width: 600px)").matches)}catch(t){return!1}})(e)?o:1)}function yt(){if(!Ir)return;let e=null;try{e=b()}catch(n){}if(!e)return;const t=bt(e);Ir.style.setProperty("--abs-scene-impact-mul",t+"");const a=+e.sceneImpactLogoCompMul;Number.isFinite(a)&&a>0&&Ir.style.setProperty("--abs-scene-impact-logo-comp-mul",a+"")}function vt(){Kr&&(window.clearTimeout(Kr),Kr=0),Tr&&(window.clearTimeout(Tr),Tr=0)}function wt(){if("undefined"!=typeof window&&"undefined"!=typeof document&&(Ir=document.querySelector("#abs-scene")||null,Ir&&(Ir.style.setProperty(Lr,"0"),Ir.style.setProperty(Or,"100ms"),Ir.style.setProperty(Dr,"1"),yt(),!(()=>{try{return!(!window.matchMedia||!window.matchMedia("(prefers-reduced-motion: reduce)").matches)}catch(e){return!1}})()))){Pr=!0,Ir.classList.add("abs-scene--impact");try{window.addEventListener("resize",yt,{passive:!0})}catch(e){}window.addEventListener("bb:modeChanged",e=>{const t=b();if(!1===t?.sceneImpactEnabled)return;if(Er)return void(Er=!1);const a=e?.detail||{};((e=1,t={})=>{if(!Pr||!Ir)return;const a=b();if(!1===a?.sceneImpactEnabled)return;const n=Math.max(0,Math.min(1,+e||0)),o=++Wr;vt(),Ir.classList.add("abs-scene--animating"),t?.armManual&&(Er=!0);const i=a?.sceneImpactPressMs??75,r=a?.sceneImpactReleaseMs??220,l=Math.max(1,Math.round(.8*(+i||0))),s=Math.max(1,Math.round(1.2*(+r||0))),d=Math.round(Math.min(80,Math.max(0,.4*(+l||0))));Ir.style.setProperty(Or,Math.round(l)+"ms"),window.requestAnimationFrame(()=>{Pr&&Ir&&o===Wr&&(Ir.style.setProperty(Lr,n+""),Ir.style.setProperty(Dr,((e,t)=>{const a=bt(t),n=Math.max(0,+e||0)*a,o=1/Math.max(.001,1-n),i=+t?.sceneImpactLogoCompMul;return Math.max(.5,Math.min(4,o*(1+((Number.isFinite(i)&&i>0?i:1)-1)*n)))})(n,a)+""))}),Kr=window.setTimeout(()=>{(({token:e,releaseMs:t})=>{vt(),Pr&&Ir&&e===Wr&&(Ir.style.setProperty(Or,Math.round(t)+"ms"),window.requestAnimationFrame(()=>{Pr&&Ir&&e===Wr&&(Ir.style.setProperty(Lr,"0"),Ir.style.setProperty(Dr,"1"))}),Tr=window.setTimeout(()=>{Tr=0,Ir&&Ir.classList.remove("abs-scene--animating")},Math.max(0,Math.round(t)+80)))})({token:o,releaseMs:s})},Math.max(0,Math.round(l)+d)),Tr=window.setTimeout(()=>{Tr=0,Ir&&Ir.classList.remove("abs-scene--animating")},Math.max(0,Math.round(l)+d+Math.round(s)+80))})(a.prevMode&&a.mode&&a.prevMode!==a.mode?1:.75,{armManual:!1})},{passive:!0})}}function xt(){function e(e){return!(!e||!e.closest||!(e.closest("#panelDock")||e.closest("#masterPanel")||e.closest("#dockToggle")||e.closest(".panel-dock")||e.closest(".panel")||e.closest("#expertise-legend")||e.closest(".legend__item")))}function t(e,t){const a=o.getBoundingClientRect();return{x:o.width/(a.width||1)*(e-a.left),y:o.height/(a.height||1)*(t-a.top),inBounds:!(a.left>e||e>a.right||a.top>t||t>a.bottom)}}function a(a,o,i,{isMouseLike:r}={isMouseLike:!0}){const l=t(a,o),s=performance.now(),d=s-zr;if(d>0&&zr>0){const e=l.x-Gr,t=l.y-Rr,a=Math.sqrt(e*e+t*t);$r=a/d,a>.1&&(_r=e/a,Nr=t/a)}if(r?Dt(a,o):It(),e(i))return;if(pt())return;n.mouseX=l.x,n.mouseY=l.y,n.mouseInCanvas=l.inBounds,"undefined"!=typeof window&&(window.mouseInCanvas=l.inBounds);const c=Math.hypot(l.x-(n.lastPointerMoveX??l.x),l.y-(n.lastPointerMoveY??l.y));var u,p,m;c>.5&&(n.lastPointerMoveMs=s,n.lastPointerMoveX=l.x,n.lastPointerMoveY=l.y),r&&c>.5&&((e,t,a,n)=>{if(Wt())return;const o=b();if(!o?.mouseTrailEnabled)return;if(!n)return;if(Kt())return;if((e=>{const t=Math.max(0,0|e);t>0&&(il===t&&rl&&ll&&sl||(il=t,rl=new Float32Array(il),ll=new Float32Array(il),sl=new Float64Array(il),dl=0,cl=0))})(Tt(0|(o.mouseTrailLength??18),4,96)),!il)return;const i=o.DPR||1,r=Tt(+(o.mouseTrailSize??1.3),.5,10)*i,l=Math.max(.35,.55*r),s=l*l;if(cl>0){const n=(dl-1+il)%il;if(((e,t,a,n)=>{const o=e-a,i=t-n;return o*o+i*i})(e,t,rl[n],ll[n])<s)return void(sl[n]=a)}rl[dl]=e,ll[dl]=t,sl[dl]=a,dl=(dl+1)%il,il>cl&&cl++})(l.x,l.y,s,l.inBounds),n.currentMode===co.WATER&&l.inBounds&&$r>.3&&s-Vr>80&&(u=l.x,p=l.y,m=Math.min(2*$r,3),"function"!=typeof Br?(Ar||(Ar=import("./water.js").then(e=>{Br="function"==typeof e.createWaterRipple?e.createWaterRipple:null}).catch(()=>{})),Ar.then(()=>{"function"==typeof Br&&Br(u,p,m)}).catch(()=>{})):Br(u,p,m),Vr=s),Gr=l.x,Rr=l.y,zr=s}const n=b(),o=n.canvas;n.clickCycleEnabled=!1,o?(document.addEventListener("mousemove",e=>{window.PointerEvent||a(e.clientX,e.clientY,e.target,{isMouseLike:!0})},{passive:!0}),document.addEventListener("pointermove",e=>{a(e.clientX,e.clientY,e.target,{isMouseLike:"mouse"===e.pointerType||"pen"===e.pointerType})},{passive:!0}),document.addEventListener("touchmove",e=>{if(!pt()&&e.touches&&e.touches[0]){const a=t(e.touches[0].clientX,e.touches[0].clientY);n.mouseX=a.x,n.mouseY=a.y,n.mouseInCanvas=a.inBounds;const o=performance.now();Math.hypot(a.x-(n.lastPointerMoveX??a.x),a.y-(n.lastPointerMoveY??a.y))>.5&&(n.lastPointerMoveMs=o,n.lastPointerMoveX=a.x,n.lastPointerMoveY=a.y),n.currentMode===co.WATER&&a.inBounds&&o-Vr>80&&(createWaterRipple(a.x,a.y,2),Vr=o)}},{passive:!0}),document.addEventListener("touchstart",t=>{window.PointerEvent||e(t.target)||pt()||It()},{passive:!0}),document.addEventListener("mouseleave",()=>{n.mouseX=ho.OFFSCREEN_MOUSE,n.mouseY=ho.OFFSCREEN_MOUSE,n.mouseInCanvas=!1,$r=0,_r=0,Nr=0,"undefined"!=typeof window&&(window.mouseInCanvas=!1),It()},{passive:!0}),document.addEventListener("mouseenter",()=>{Pt()},{passive:!0}),document.addEventListener("touchend",()=>{n.mouseX=ho.OFFSCREEN_MOUSE,n.mouseY=ho.OFFSCREEN_MOUSE,n.mouseInCanvas=!1},{passive:!0}),console.log(" Unified pointer system configured (document-level)"),n.S=!0,"undefined"!=typeof window&&(window.S=!0)):console.error("Canvas not available for pointer setup")}function Mt(e){try{el=e?.detail?.element??null}catch(t){el=null}}function St(){const e=b();return e?.cursorColorHex&&"string"==typeof e.cursorColorHex?e.cursorColorHex:"#000000"}function kt(){if(jr)return;Hr=document.createElement("div"),Hr.id="custom-cursor",Hr.setAttribute("aria-hidden","true");const e=document.getElementById("bravia-balls");e?e.appendChild(Hr):document.body.appendChild(Hr),Hr.style.display="none",Hr.style.opacity="0",jr=!0,document.addEventListener("abs-link-hover",Mt),Ct(),(()=>{if(Xr||!Hr)return;Xr=!0;const e=b(),t=(e.entranceWallTransitionDelay??300)+.3*(e.entranceWallTransitionDuration??800)+(e.entranceElementDuration??500)+600,a="cubic-bezier(0.16, 1, 0.3, 1)";window.matchMedia?.("(prefers-reduced-motion: reduce)")?.matches?setTimeout(()=>{Hr&&(Hr.style.opacity="1")},t):setTimeout(()=>{Hr&&requestAnimationFrame(()=>{requestAnimationFrame(()=>{if(Hr){if("function"!=typeof Hr.animate)return Hr.style.opacity="1",void(Hr.style.transition="opacity 800ms "+a);qr&&(Hr.style.display="block"),Qr=Hr.animate([{opacity:0},{opacity:1}],{duration:800,easing:a,fill:"forwards"}),Qr?.addEventListener?.("finish",()=>{Hr&&(Hr.style.opacity="1")}),Qr?.addEventListener?.("cancel",()=>{Hr&&(Hr.style.opacity="1")})}})})},t)})()}function Ct(){if(!Hr)return;const e=b(),t=.5*(e.R_MIN+e.R_MAX)*e.cursorSize*2;Hr.style.width=t+"px",Hr.style.height=t+"px",Hr.style.borderRadius="50%",Hr.style.marginLeft="0",Hr.style.marginTop="0",qr||(Hr.style.transform=tl)}function Ft(e,t){const a=b(),n=a?.canvas;if(!n)return null;const o=n.getBoundingClientRect();return{x:n.width/(o.width||1)*(e-o.left),y:n.height/(o.height||1)*(t-o.top),inBounds:!(o.left>e||e>o.right||o.top>t||t>o.bottom)}}function Lt(e,t,a){return{x:Math.max(0,Math.min(a.width,e)),y:Math.max(0,Math.min(a.height,t))}}function Ot(e,t){const a=b(),n=a?.canvas;if(!n)return null;const o=Ft(e,t);if(!o)return null;const i=o.inBounds?o:Lt(o.x,o.y,n);return{x:i.x,y:i.y}}function Dt(e,t){if(!Hr)return;const a=(()=>{try{return!!document?.body?.classList?.contains?.("abs-link-hovering")}catch(e){return!1}})();if(a&&!Jr){const a=b(),n=a?.canvas,o=St(),i=$r||0,r={x:_r||0,y:Nr||0},l=()=>{if(!n)return;let a=!1;if(el){const e=(e=>{if(!e?.getBoundingClientRect)return null;const t=e.getBoundingClientRect();if(0>=t.width||0>=t.height)return null;const a=t.left+.5*t.width,n=t.top+.5*t.height,o=Ot(a,n);if(!o)return null;const i=[{x:t.left,y:n},{x:t.right,y:n},{x:a,y:t.top},{x:a,y:t.bottom}].map(e=>Ot(e.x,e.y)).filter(Boolean);return i.length?{center:o,points:i}:null})(el);if(e){const t=1/e.points.length;e.points.forEach(a=>{gt(a.x,a.y,o,i,{emissionCenter:e.center,particleScale:t})}),a=!0}}if(!a){const a=Ft(e,t);if(a){const e=a.inBounds?a:Lt(a.x,a.y,n);0>e.x||0>e.y||e.x>n.width||e.y>n.height||gt(e.x,e.y,o,i)}}!r||0===r.x&&0===r.y||((e,t,a)=>{if(e>0){const e=Math.sqrt(t*t+a*a);e>.01&&(Cr=t/e,Fr=a/e)}})(i,r.x,r.y)};requestAnimationFrame(l)}Jr=a;const n=qr;qr=((e,t)=>{const a=document.querySelector(".inner-wall");if(!a){const a=document.getElementById("bravia-balls");if(!a)return!1;const n=performance.now();return Zr&&Ur>=n-Yr||(Zr=a.getBoundingClientRect(),Yr=n),!(Zr.left>e||e>Zr.right||Zr.top>t||t>Zr.bottom)}const n=performance.now();return Zr&&Ur>=n-Yr||(Zr=a.getBoundingClientRect(),Yr=n),!(Zr.left>e||e>Zr.right||Zr.top>t||t>Zr.bottom)})(e,t);const o=pt(),i=document.getElementById("bravia-balls");if(o)i&&i.contains(Hr)&&(document.body.appendChild(Hr),Hr.style.position="fixed",Hr.style.zIndex="20000"),Hr.style.left=e+"px",Hr.style.top=t+"px";else if(i&&!i.contains(Hr)&&(i.appendChild(Hr),Hr.style.position="absolute",Hr.style.zIndex="3"),i){const a=i.getBoundingClientRect();Hr.style.left=e-a.left+"px",Hr.style.top=t-a.top+"px"}else Hr.style.left=e+"px",Hr.style.top=t+"px";return qr||o?document.body.classList.add("abs-in-simulation"):document.body.classList.remove("abs-in-simulation"),a?(Hr.style.display="block",void(Hr.style.transform=tl)):o?(Hr.style.display="block",void(Hr.style.transform=nl)):void(qr?(Hr.style.display="block",n?Hr.style.transform!==al&&(Hr.style.transform=al):(Hr.style.transform=tl,requestAnimationFrame(()=>{Hr.style.transform=al}))):(Hr.style.display="none",n&&(Hr.style.transform=tl,Hr.style.backgroundColor="",Hr.style.filter="")))}function It(){Hr&&(Hr.style.display="none",document.body.classList.remove("abs-in-simulation"),qr=!1)}function Pt(){Hr&&(qr=!1)}function Wt(){const e=(()=>{try{return!!document?.body?.classList?.contains?.("abs-link-hovering")}catch(e){return!1}})();return e&&!ul&&(dl=0,cl=0),ul=e,e}function Kt(){try{return!!window.matchMedia?.("(prefers-reduced-motion: reduce)")?.matches}catch(e){return!1}}function Tt(e,t,a){return t>e?t:e>a?a:e}function Et(){return gl}function Bt(e){gl=e}function At(e){gl-=e}function Gt(){gl=0}function Rt(e,t="#000000"){if(!Pl)return t;try{return Pl.fillStyle=t,Pl.fillStyle=((e||"")+"").trim()||t,Pl.fillStyle||t}catch(a){return t}}function zt(e){if(!e)return null;const t=(e+"").trim().toLowerCase();if(t.startsWith("#")){let e=t.slice(1);if(3===e.length&&(e=e.split("").map(e=>e+e).join("")),6!==e.length)return null;const a=Number.parseInt(e,16);return Number.isFinite(a)?{r:a>>16&255,g:a>>8&255,b:255&a}:null}const a=t.match(/^rgba?\(([^)]+)\)$/);if(!a)return null;const n=a[1].split(",").map(e=>Number.parseFloat(e.trim()));return 3>n.length||n.slice(0,3).some(e=>!Number.isFinite(e))?null:{r:Math.max(0,Math.min(255,Math.round(n[0]))),g:Math.max(0,Math.min(255,Math.round(n[1]))),b:Math.max(0,Math.min(255,Math.round(n[2])))}}function $t(e){const t=e=>{const t=e/255;return t>.03928?Math.pow((t+.055)/1.055,2.4):t/12.92};return.2126*t(e.r)+.7152*t(e.g)+.0722*t(e.b)}function _t(e,t){const a=$t(e),n=$t(t);return(Math.max(a,n)+.05)/(Math.min(a,n)+.05)}function Nt(e=performance.now()){if(!Il.isStarted||Il.isComplete)return;Number.isFinite(Il.startTimeMs)&&Il.startTimeMs>0||(Il.startTimeMs=e);const t=Math.min(1,Math.max(0,e-Il.startTimeMs)/Sl);Il.progress=t,1>t||(Il.isComplete=!0)}function Vt(){return!!Dl||(Fl=(()=>{const e=document.querySelector("#brand-logo .brand-logo-svg");if(!e)return console.warn("[canvas-logo] SVG element not found"),null;const t=e.querySelectorAll("path"),a=[];return t.forEach(e=>{const t=e.getAttribute("d");t&&a.push(t)}),a})(),Fl&&0!==Fl.length?(Dl=!0,!0):(console.error("[canvas-logo] Failed to extract SVG paths"),!1))}function Ht(e,t,a,n=1){if(!Dl)return;const o=(()=>{const e=getComputedStyle(document.documentElement),t=e.getPropertyValue("--text-logo").trim()||(document.getElementById("brand-logo")?getComputedStyle(document.getElementById("brand-logo")).color:""),a=(e=>{const t=document.getElementById("bravia-balls");if(t){const e=getComputedStyle(t).backgroundColor?.trim();if(e)return e}const a=document.documentElement.classList.contains("dark-mode")||document.body?.classList.contains("dark-mode");return e.getPropertyValue(a?"--bg-dark":"--bg-light").trim()||e.getPropertyValue("--wall-color").trim()||"#242529"})(e),n=Rt(t,xl),o=Rt(a,"#242529"),i=zt(n),r=zt(o);if(!r)return n;const l=zt(wl),s=zt(xl);if(!l||!s)return n;const d=_t(l,r)>_t(s,r)?wl:xl;return i&&_t(i,r)>=Ml?n:d})();let i=Cl.get(o);if(i||(i=((e,t,a,n)=>{if(!e||0===e.length||0>=t||0>=a)return null;const o=2*t,i=2*a,r=document.createElement("canvas");r.width=o,r.height=i;const l=r.getContext("2d",{alpha:!0});if(!l)return null;l.imageSmoothingEnabled=!0,l.imageSmoothingQuality="high";const s=o/bl,d=i/yl;return l.fillStyle=n,l.scale(s,d),e.forEach(e=>{const t=new Path2D(e);l.fill(t)}),r.k=2,r})(Fl,Ll.width,Ll.height,o),i&&Cl.set(o,i)),!i)return;const r=((e,t)=>({x:(e-Ll.width)/2,y:(t-Ll.height)/2}))(t,a);if(!Il.isStarted&&!Il.isComplete){const e=document.documentElement;(e?.classList.contains("entrance-complete")||e?.classList.contains("ui-entered"))&&jt()}Nt();let l=1,s=0;if(!Il.isComplete)if(Il.isStarted){const e=(e=>1===e?1:1-Math.pow(2,-10*e))(Il.progress);l=e,s=(1-e)*kl}else l=0;if(0>=l)return;let d=n;try{const e=getComputedStyle(document.getElementById("abs-scene")).getPropertyValue("--abs-scene-impact-logo-scale");if(e){const t=parseFloat(e);Number.isFinite(t)&&t>0&&(d*=t)}}catch(c){}if(e.save(),1!==d){const t=r.x+Ll.width/2,a=r.y+Ll.height/2;e.translate(t,a),e.scale(d,d),e.translate(-t,-a)}1>l&&(e.globalAlpha=l),s>.5&&(e.filter=`blur(${s}px)`),e.imageSmoothingEnabled=!0,e.imageSmoothingQuality="high",e.drawImage(i,0,0,i.width,i.height,r.x,r.y,Ll.width,Ll.height),e.restore()}function jt(){Il.isStarted=!0,Il.progress=0,Il.isComplete=!1,Il.startTimeMs=performance.now()}function qt(){Il.isStarted=!0,Il.progress=1,Il.isComplete=!0,Il.startTimeMs=performance.now()-Sl}function Zt(e){return El>e?Tl+e/El*(1-Tl):1}function Yt(){if(Hl.arrays.length>Hl.arrayIndex){const e=Hl.arrays[Hl.arrayIndex++];return e.length=0,e}const e=[];return Hl.arrays.push(e),Hl.arrayIndex++,e}function Ut(e,t,a,n,o=!1){const i=Rl+e.r,r=i*i;let l=e.x-Rl,s=e.y-Rl,d=l*l+s*s;if(r>d&&d>0){const t=Math.sqrt(d),a=(i-t)/i*zl,o=1/t;e.vx+=l*o*a*n,e.vy+=s*o*a*n}if(l=e.x-(t-Rl),s=e.y-Rl,d=l*l+s*s,r>d&&d>0){const t=Math.sqrt(d),a=(i-t)/i*zl,o=1/t;e.vx+=l*o*a*n,e.vy+=s*o*a*n}if(!o){if(l=e.x-Rl,s=e.y-(a-Rl),d=l*l+s*s,r>d&&d>0){const t=Math.sqrt(d),a=(i-t)/i*zl,o=1/t;e.vx+=l*o*a*n,e.vy+=s*o*a*n}if(l=e.x-(t-Rl),s=e.y-(a-Rl),d=l*l+s*s,r>d&&d>0){const t=Math.sqrt(d),a=(i-t)/i*zl,o=1/t;e.vx+=l*o*a*n,e.vy+=s*o*a*n}}}function Xt(e,t){const a=b(),n=a.balls,o=a.canvas;if(!o)return;if(0===n.length)return;const i=a.isMobile||a.isMobileViewport?Gl:Wl;if(a.currentMode===co.KALEIDOSCOPE){const i=tt(),r=Math.min(.033,Math.max(0,e)),l=n.length;for(let e=0;l>e;e++)n[e].step(r,t);Vl.maxCorrectionPx=1.25*(a.DPR||1),(({iterations:e=4,positionalCorrectionPercent:t=.25,positionalCorrectionSlopPx:a=null,maxCorrectionPx:n=null,enableSound:o=!0}={})=>{const i=b(),r=i.balls,l=Ie(),s=i.REST,d=t,c=a??.5*i.DPR,u=i.ballSpacing||0,p=n??2*(i.DPR||1);for(let m=0;e>m;m++)for(let e=0;l.length>e;e++){const{i:t,j:a}=l[e],n=r[t],h=r[a];if(n.isSleeping&&h.isSleeping)continue;n.isSleeping&&n.wake(),h.isSleeping&&h.wake();const f=h.x-n.x,g=h.y-n.y,b=n.r+h.r+(n.r+h.r)/2*u,y=f*f+g*g;if(0===y||y>b*b)continue;const v=Math.sqrt(y),w=f/v,x=g/v,M=b-v,S=1/Math.max(n.m,.001),k=1/Math.max(h.m,.001);let C=d*Math.max(M-c,0)/(S+k);C>p&&(C=p);const F=C*w,L=C*x;n.x-=F*S,n.y-=L*S,h.x+=F*k,h.y+=L*k;const O=(h.vx-n.vx)*w+(h.vy-n.vy)*x;if(0>O){const e=-(1+(30>Math.abs(O)?0:s))*O/(S+k),r=e*w,l=e*x;if(n.vx-=r*S,n.vy-=l*S,h.vx+=r*k,h.vy+=l*k,o&&0===m){const e=(n.r+h.r)/2,o=(n.x+h.x)/2/(i.canvas?.width||1);we(e,Math.min(1,Math.abs(O)/(50*(n.r+h.r))),o,`${t}-${a}`)}}}})(Vl);for(let e=0;l>e;e++)i&&i(n[e],o.width,o.height,r);return void Bt(0)}gl+=e;let r=0;for(;Et()>=i&&ho.MAX_PHYSICS_STEPS>r;){const e=n.length;for(let a=0;e>a;a++)n[a].step(i,t);const l=Math.max(1,Math.min(20,Math.round(+(a.physicsCollisionIterations??10)||10)));a.currentMode===co.KALEIDOSCOPE?Pe(6):a.currentMode!==co.FLIES&&a.currentMode!==co.SPHERE_3D&&a.currentMode!==co.CUBE_3D&&a.currentMode!==co.PARALLAX_LINEAR&&a.currentMode!==co.PARALLAX_FLOAT&&a.currentMode!==co.STARFIELD_3D&&a.currentMode!==co.DVD_LOGO&&Pe(l);const s=a.currentMode;if(s!==co.SPHERE_3D&&s!==co.CUBE_3D&&s!==co.PARALLAX_LINEAR&&s!==co.PARALLAX_FLOAT&&s!==co.STARFIELD_3D){const e=s===co.WEIGHTLESS?a.weightlessBounce:a.REST,t=s===co.PIT,r=n.length,l=_l,d=a.isMobile||a.isMobileViewport,c=o.width,u=o.height;for(let a=0;r>a;a++){const o=n[a];o.isDvdLogo||(t||Ut(o,c,u,i,d),o.walls(c,u,i,e,l))}}if(s===co.PIT){Pe(3);const e=a.REST,t=n.length,r=o.width,l=o.height;for(let a=0;t>a;a++)n[a].walls(r,l,i,e,Nl);const s=a.DPR||1,d=(Number.isFinite(a.sleepVelocityThreshold)?a.sleepVelocityThreshold:12)*s,c=d*d,u=4*s*s,p=Number.isFinite(a.sleepAngularThreshold)?a.sleepAngularThreshold:.18,m=a.timeToSleep??.25;for(let a=0;t>a;a++){const e=n[a];if(!e||e.isSleeping)continue;const t=e.vx*e.vx+e.vy*e.vy,o=Math.abs(e.omega);(e.isGrounded||e.hasSupport)&&c>t&&p>o?(e.vx*=.5,e.vy*=.5,e.omega*=.5,u>t&&(e.vx=0,e.vy=0),.02>o&&(e.omega=0),e.sleepTimer+=i,m>e.sleepTimer||(e.vx=0,e.vy=0,e.omega=0,e.isSleeping=!0)):e.sleepTimer=0}}if(!1!==a.physicsSkipSleepingSteps&&s!==co.FLIES&&s!==co.SPHERE_3D&&s!==co.CUBE_3D&&s!==co.PARALLAX_LINEAR&&s!==co.PARALLAX_FLOAT&&s!==co.KALEIDOSCOPE&&s!==co.PIT){const e=a.DPR||1,t=Math.max(0,+(a.physicsSleepThreshold??12)||0)*e,o=t*t,r=Math.max(0,+(a.physicsSleepTime??.25)||0),l=Number.isFinite(a.sleepAngularThreshold)?a.sleepAngularThreshold:.18;if(t>0&&r>0){const e=n.length;for(let t=0;e>t;t++){const e=n[t];e&&!e.isSleeping&&(!0!==e.isMeteor&&o>e.vx*e.vx+e.vy*e.vy&&l>Math.abs(e.omega)?(e.sleepTimer+=i,r>e.sleepTimer||(e.vx=0,e.vy=0,e.omega=0,e.isSleeping=!0)):e.sleepTimer=0)}}}At(i),r++}const l=Qe();l&&l(e),Et()>i*ho.ACCUMULATOR_RESET_THRESHOLD&&Bt(0)}async function Qt(e,t){const a=b(),n=a.canvas,o=a.balls;if(i=e,Il.isStarted&&!Il.isComplete&&(Number.isFinite(i)&&i>0?(Il.progress+=1e3*i/Sl,1>Il.progress||(Il.progress=1,Il.isComplete=!0),Il.startTimeMs=performance.now()-Il.progress*Sl):Nt()),(e=>{const t=b();if(!t?.cursorExplosionEnabled)return;if(!fr)return;const a=t.cursorExplosionDrag??.95,n=t.cursorExplosionFadeStartRatio??.6;let o=0;for(let i=0;fr>i;i++){const r=wr[i]+e,l=xr[i];if(r>=l)continue;wr[i]=r,yr[i]*=a,vr[i]*=a,gr[i]+=yr[i]*e,br[i]+=vr[i]*e;const s=r/l;let d=1;if(s>=n){const e=(s-n)/(1-n);d=1-e*e*e}Mr[i]=Math.max(0,d),!1!==t.cursorExplosionShrinkEnabled&&(Sr[i]=Sr[i]*(1-.3*s)),i!==o&&(gr[o]=gr[i],br[o]=br[i],yr[o]=yr[i],vr[o]=vr[i],wr[o]=wr[i],xr[o]=xr[i],Mr[o]=Mr[i],Sr[o]=Sr[i],kr[o]=kr[i]),o++}fr=o})(e),!n)return;var i;if(!o||0===o.length)return;const r=Math.max(0,Math.round(a.warmupFramesRemaining||0));if(r>0){a.warmupFramesRemaining=0,Bt(0);for(let e=0;r>e;e++)Xt($l,t)}else Xt(e,t)}function Jt(){const e=b(),t=e.ctx,a=e.balls,n=e.canvas;if(!t||!n)return;const o=e.DPR||1,i=((e=b())=>{const t=!1!==e?.featureQualityTieringEnabled,a=(e=>{const t=((e||fl)+"").toLowerCase();return t===pl?pl:t===ml||"medium"===t?ml:t===hl?hl:fl})(e?.renderQualityTier);let n=pl;return t&&(n=a===fl?(e=>{const t=Math.max(0,+e?.adaptiveThrottleLevel||0);return 2>t?1>t?!0===e?.performanceModeEnabled&&(e?.isMobile||e?.isMobileViewport)?ml:pl:ml:hl})(e):a),n===hl?{tier:n,depthWashOpacityScale:.55,wallGradientStrokeEnabled:!1,drawMouseTrail:!1,drawCursorExplosion:!1}:n===ml?{tier:n,depthWashOpacityScale:.85,wallGradientStrokeEnabled:!0,drawMouseTrail:!0,drawCursorExplosion:!0}:{tier:pl,depthWashOpacityScale:1,wallGradientStrokeEnabled:!0,drawMouseTrail:!0,drawCursorExplosion:!0}})(e);e.renderQualityTierResolved=i.tier,((e,t,a)=>{if(!Dl||!Fl)return;const n=((e,t,a)=>{const n=window.innerWidth;let o;o=n>600?Math.max(250,Math.min(500,.45*n)):.6*n,o=Math.min(o,.9*n),o=Math.min(o,e/a*.95);const i=o/vl;return{width:Math.round(o*a),height:Math.round(i*a),cssWidth:o,cssHeight:i}})(e,0,a);(n.width!==Ll.width||n.height!==Ll.height||a!==Ol||0>=Cl.size)&&(Ll=n,Ol=a,Cl.clear())})(n.width,0,o),t.clearRect(0,0,n.width,n.height);const r=e.canvasClipPath,l=r&&(e.cornerRadius??e.wallRadius??0)>0;if(l){t.save();try{t.clip(r)}catch(u){}}const s=Je();s&&s.preRender&&s.preRender(t);const d=!Bl.has(e.currentMode),c=Dl&&Ll.width>0&&Ll.height>0;if(e.currentMode===co.KALEIDOSCOPE){const e=et();c&&Ht(t,n.width,n.height),e?e(t):ea(t,a)}else if(d){Al.behind.length=0,Al.inFront.length=0;for(let e=0;a.length>e;e++){const t=a[e];Kl>(t.z??1)?Al.behind.push(t):Al.inFront.push(t)}Al.behind.length>0&&ea(t,Al.behind,!0),c&&Ht(t,n.width,n.height),Al.inFront.length>0&&ea(t,Al.inFront,!0)}else c&&Ht(t,n.width,n.height),ea(t,a);s&&s.postRender&&s.postRender(t),l&&t.restore(),i.drawMouseTrail&&(e=>{if(Wt())return;const t=b();if(!t?.mouseTrailEnabled)return;if(Kt())return;if(!e||!cl||!il)return;const a=performance.now(),n=Tt(+(t.mouseTrailFadeMs??220),40,2e3),o=Tt(+(t.mouseTrailOpacity??.35),0,1);if(0>=o)return;const i=t.DPR||1,r=Tt(+(t.mouseTrailSize??1.3),.5,10)*i;for(;cl>0&&a-sl[(dl-cl+il)%il]>n;)cl--;if(!cl)return;if(2>cl)return;const l=St(),s=e.globalAlpha,d=e.globalCompositeOperation,c=e.lineCap,u=e.lineJoin,p=e.strokeStyle,m=e.lineWidth;e.globalCompositeOperation="source-over",e.lineCap="round",e.lineJoin="round",e.strokeStyle=l,e.lineWidth=r,e.globalAlpha=o;const h=cl,f=(dl-h+il)%il;if(e.beginPath(),e.moveTo(rl[f],ll[f]),2===h)e.lineTo(rl[(f+1)%il],ll[(f+1)%il]);else{for(let a=1;h-1>a;a++){const t=(f+a)%il,n=(f+a+1)%il,o=rl[t],i=ll[t];e.quadraticCurveTo(o,i,.5*(o+rl[n]),.5*(i+ll[n]))}const t=(f+h-1)%il;e.lineTo(rl[t],ll[t])}e.stroke(),e.globalAlpha=s,e.globalCompositeOperation=d,e.lineCap=c,e.lineJoin=u,e.strokeStyle=p,e.lineWidth=m})(t),i.drawCursorExplosion&&(e=>{const t=b();if(!t?.cursorExplosionEnabled)return;if(mt())return;if(!fr||!e)return;const a=new Map;for(let i=0;fr>i;i++){const e=kr[i];a.has(e)||a.set(e,[]),a.get(e).push(i)}const n=e.globalAlpha,o=e.globalCompositeOperation;e.globalCompositeOperation="source-over";for(const[i,r]of a){e.fillStyle=i;for(const t of r){const a=Mr[t];if(0>=a)continue;const n=Math.max(.5,Sr[t]);e.globalAlpha=a,e.beginPath(),e.arc(gr[t],br[t],n,0,2*Math.PI),e.fill()}}e.globalAlpha=n,e.globalCompositeOperation=o})(t),((e,t,a,n={})=>{const o=b(),i=o.isDarkMode||!1,r=("number"==typeof o.depthWashOpacity?o.depthWashOpacity:.65)*(Number.isFinite(n.opacityScale)?n.opacityScale:1);if(0>=r)return;const l=((e,t,a,n)=>`${e}|${t}|${n}|${a.depthWashCenterY}|${a.depthWashRadiusScale}|${a.depthWashCenterColorLight}|${a.depthWashEdgeColorLight}|${a.depthWashCenterAlphaLight}|${a.depthWashEdgeAlphaLight}|${a.depthWashCenterColorDark}|${a.depthWashEdgeColorDark}|${a.depthWashCenterAlphaDark}|${a.depthWashEdgeAlphaDark}`)(t,a,o,i);null!==Si&&ki===l||(Si=((e,t,a,n,o)=>{const i="number"==typeof n.depthWashRadiusScale?n.depthWashRadiusScale:1,r=t/2,l=a*("number"==typeof n.depthWashCenterY?n.depthWashCenterY:.3),s=e.createRadialGradient(r,l,0,r,l,Math.max(t,a)*i),d=o?n.depthWashEdgeColorDark||"#05020f":n.depthWashEdgeColorLight||"#142b48",c=o?"number"==typeof n.depthWashCenterAlphaDark?n.depthWashCenterAlphaDark:0:"number"==typeof n.depthWashCenterAlphaLight?n.depthWashCenterAlphaLight:.3,u=o?"number"==typeof n.depthWashEdgeAlphaDark?n.depthWashEdgeAlphaDark:.8:"number"==typeof n.depthWashEdgeAlphaLight?n.depthWashEdgeAlphaLight:.4,p=Be(o?n.depthWashCenterColorDark||"#1a1e23":n.depthWashCenterColorLight||"#ffffff"),m=Be(d);return s.addColorStop(0,`rgba(${p.r}, ${p.g}, ${p.b}, ${c})`),s.addColorStop(1,`rgba(${m.r}, ${m.g}, ${m.b}, ${u})`),s})(e,t,a,o,i),ki=l),e.save(),e.globalCompositeOperation=i?o.depthWashBlendModeDark||"multiply":o.depthWashBlendModeLight||"color-dodge",e.globalAlpha=r,e.fillStyle=Si,e.fillRect(0,0,t,a),e.restore()})(t,n.width,n.height,{opacityScale:i.depthWashOpacityScale}),Ke(t,n.width,n.height,{wallGradientStrokeEnabled:i.wallGradientStrokeEnabled})}function ea(e,t,a=!1){if(!t||0===t.length)return;Hl.map.clear(),Hl.arrayIndex=0;const n=Hl.map;for(let o=0;t.length>o;o++){const e=t[o],a=e.color;n.has(a)||n.set(a,Yt()),n.get(a).push(e)}for(const[o,i]of n){e.fillStyle=o;for(let t=0;i.length>t;t++){const n=i[t],o=n.squashAmount>.01;let r=n.alpha*(n.filterOpacity??1);if(a&&(r*=Zt(n.z??1)),o||1>r){if(e.save(),e.globalAlpha=r,o){const t=n.alpha;n.alpha=1,n.draw(e),n.alpha=t}else e.beginPath(),e.arc(n.x,n.y,n.getDisplayRadius(),0,2*Math.PI),e.fill();e.restore()}else e.beginPath(),e.arc(n.x,n.y,n.getDisplayRadius(),0,2*Math.PI),e.fill()}}}function ta(){fi=Ee()}function aa(){return null===Zl&&(Zl=(()=>{try{return!1}catch(e){}try{if("8001"==(globalThis?.location?.port??"")+"")return!0}catch(e){}try{if(Array.from(document.scripts||[]).some(e=>{if("module"!==(e.getAttribute("type")||"").toLowerCase())return!1;const t=e.getAttribute("src")||"";return/(^|\/)main\.js(\?|#|$)/.test(t)}))return!0}catch(e){}return!1})()),Zl}function na(e){const t=Math.random();let a=0;for(let n=0;8>n;n++)if(a+=Jl[n],a>=t)return e[n];return e[0]}function oa({sentence:e="Curious mind detected. Design meets engineering at 60fps.",ascii:t=["        ","                   ","             ","                   ","        "],silence:a=!1}={}){if(!Xl){Xl=!0;try{ql.log("%c"+e,"color: #888; font-style: italic;"),ql.log("");try{const e=((e,t=3)=>{const{colorAssignments:a}=((e,t=3)=>{let a;try{a=(()=>{try{const e=b(),t=e?.currentColors;if(Array.isArray(t)&&t.length>=8)return t.slice(0,8)}catch(e){}return Ql})(),Array.isArray(a)&&a.length>=8||(a=Ql)}catch(l){a=Ql}const n=[];for(let s=0;e.length>s;s++){const a=e[s];for(let e=0;a.length>e;e+=t){const o=a.slice(e,e+t);n.push({row:s,col:e,visible:o.trim().length>0})}}const o=n.map((e,t)=>e.visible?t:-1).filter(e=>e>=0),i=Array(n.length).fill(null),r=(e=>{for(let t=e.length-1;t>0;t--){const a=Math.floor(Math.random()*(t+1));[e[t],e[a]]=[e[a],e[t]]}return e})([...o]);for(let s=0;Math.min(8,r.length)>s;s++){const e=Math.min(s,a.length-1);i[r[s]]=a[e]||Ql[e]}for(const s of o)null===i[s]&&(i[s]=na(a));for(let s=0;n.length>s;s++)null===i[s]&&(i[s]="transparent");return{clusters:n,colorAssignments:i}})(e,t),n=[];let o=0;for(const i of e){let e="";const r=[];for(let n=0;i.length>n;n+=t)e+="%c"+i.slice(n,n+t),r.push(`color: ${a[o]}; font-family: monospace; font-weight: bold; font-size: 12px; letter-spacing: 0;`),o++;n.push([e,...r])}return n})(t,3);for(const t of e)ql.log(...t)}catch(n){for(const e of t)ql.log(e)}ql.log("");const a=(new Date).getFullYear();ql.log("%c "+a+" Alexander Beck Studio. All rights reserved. Unauthorized reproduction prohibited.","color: #555; font-size: 10px;")}catch(o){}if(a)try{console.log=()=>{},console.info=()=>{},console.warn=()=>{},console.debug=()=>{},console.table=()=>{},console.group=()=>{},console.groupCollapsed=()=>{},console.groupEnd=()=>{}}catch(o){}}}function ia({sentence:e="Curious mind detected. Design meets engineering at 60fps.",ascii:t=["        ","                   ","             ","                   ","        "]}={}){aa()||oa({sentence:e,ascii:t,silence:!0})}function ra(e){aa()&&ql.groupCollapsed(e)}function la(){aa()&&ql.groupEnd()}function sa(e){if(!aa())return;const t=("undefined"!=typeof performance&&performance.now?performance.now():Date.now())-Ul;Yl+=1,ql.log(`[${(Yl+"").padStart(2,"0")}] +${t.toFixed(1)}ms ${e}`)}function da(e){if(aa())try{performance.mark(e)}catch(t){}}function ca(e,t,a){if(!aa())return null;try{performance.measure(e,t,a);const n=performance.getEntriesByName(e),o=n&&n.length?n[n.length-1]:null;return o?o.duration:null}catch(n){return null}}function ua(e){if(aa())try{ql.table(e)}catch(t){}}function pa(e,t,a){const n=document.documentElement,o=a?t:e;n.style.setProperty("--frame-color-light",e),n.style.setProperty("--frame-color-dark",t),n.style.setProperty("--wall-color-light",e),n.style.setProperty("--wall-color-dark",t),n.style.setProperty("--chrome-bg-light",e),n.style.setProperty("--chrome-bg-dark",t),n.style.setProperty("--frame-color",o),n.style.setProperty("--wall-color",o),n.style.setProperty("--chrome-bg",o)}function ma(t){if(es&&ts)return void pa(es,ts,t);const a=b();pa(a?.frameColorLight||a?.frameColor||e("--frame-color-light","#0a0a0a"),a?.frameColorDark||a?.frameColor||e("--frame-color-dark","#0a0a0a"),t)}function ha(t,a){(()=>{if(es&&ts)return;const t=b();es=t?.frameColorLight||t?.frameColor||e("--frame-color-light","#0a0a0a"),ts=t?.frameColorDark||t?.frameColor||e("--frame-color-dark","#0a0a0a")})(),((e,t)=>{pa(e,e,t)})(a.isFirefox?e(t?"--wall-color-browser-firefox-dark":"--wall-color-browser-firefox-light",t?"#1c1b22":"#f9f9fb"):e(t?"--wall-color-browser-dark":"--wall-color-browser-light",t?"#202124":"#f1f3f4"),t)}function fa(e){const t={};if(!e||"object"!=typeof e)return t;for(const a of ms)({}).hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t}function ga(e,t,a,n){const o="number"==typeof e?e:+e;return Number.isFinite(o)?Math.min(a,Math.max(t,o)):n}function ba(e,t,a,n){const o="number"==typeof e?e:+e;return Number.isFinite(o)?Math.min(a,Math.max(t,Math.round(o))):n}function ya(e,t=0){return ga(e,0,1,t)}function va(e,t,a){return t.includes(e)?e:a}function wa(e,t){try{const a=getComputedStyle(document.documentElement).getPropertyValue(e).trim(),n=Number.parseFloat(a);return Number.isFinite(n)?n:t}catch{return t}}function xa(e){let t=e>>>0;return()=>{t+=1831565813;let e=t;return e=Math.imul(e^e>>>15,1|e),e^=e+Math.imul(e^e>>>7,61|e),((e^e>>>14)>>>0)/4294967296}}function Ma(e){const t=(e()+e()+e())/3;return Math.max(0,Math.min(1,.5+1.15*(t-.5)))}function Sa(e){const t=document.documentElement;t.style.setProperty("--abs-noise-enabled",e.noiseEnabled?"1":"0");const a=e.noiseMotion,n="drift"===a?"linear":"steps(1, end)";t.style.setProperty("--abs-noise-keyframes","static"===a?"none":"drift"===a?"abs-noise-drift":"abs-noise-jitter"),t.style.setProperty("--abs-noise-timing",n);const o=ga(e.noiseSpeedMs??1100,0,1e4,1100),i=ga(e.noiseSpeedVariance??0,0,1,0),r=xa((2134518556^e.noiseSeed)>>>0),l=i>0?(2*r()-1)*i:0;t.style.setProperty("--abs-noise-speed",Math.max(0,Math.round(o*(1+l)))+"ms"),t.style.setProperty("--abs-noise-speed-variance",i+""),t.style.setProperty("--abs-noise-motion-amount",e.noiseMotionAmount+""),t.style.setProperty("--abs-noise-flicker",e.noiseFlicker+""),t.style.setProperty("--abs-noise-flicker-speed",Math.max(0,Math.round(e.noiseFlickerSpeedMs))+"ms");const s=ga(e.noiseBlurPx,0,6,0);t.style.setProperty("--abs-noise-blur",s.toFixed(2)+"px"),t.style.setProperty("--abs-noise-filter",s>0?`blur(${s.toFixed(2)}px)`:"none");const d=ga(e.noiseMotionAmount,0,2.5,1),c="static"!==e.noiseMotion&&d>0,u=ga(e.noiseSize??85,20,600,85),p=ga(.55*u,24,120,82),m=c?p*d:0;t.style.setProperty("--abs-noise-overscan",`-${Math.ceil(m+(s>0?6*s:0)+32)}px`);const h=xa((2772082231^e.noiseSeed)>>>0);for(let v=1;40>=v;v++){const e=.9*(2*h()-1)*m,a=.9*(2*h()-1)*m;t.style.setProperty(`--abs-noise-j${v}-x`,Math.round(e)+"px"),t.style.setProperty(`--abs-noise-j${v}-y`,Math.round(a)+"px")}const f=h()*Math.PI*2;t.style.setProperty("--abs-noise-drift-x",Math.round(Math.cos(f)*m)+"px"),t.style.setProperty("--abs-noise-drift-y",Math.round(Math.sin(f)*m)+"px"),t.style.setProperty("--noise-size",Math.round(u)+"px");const g=ga(e.noiseOpacityLight??e.noiseOpacity??.03,0,1,.03),b=ga(e.noiseOpacityDark??e.noiseOpacity??.03,0,1,.03);t.style.setProperty("--noise-opacity-light",g+""),t.style.setProperty("--noise-opacity-dark",b+"");const y=e.noiseColorDark??"#ffffff";t.style.setProperty("--noise-color-light",e.noiseColorLight??"#ffffff"),t.style.setProperty("--noise-color-dark",y),t.style.setProperty("--detail-noise-opacity",(e.detailNoiseOpacity??1)+"")}function ka(e={}){const t=wa("--noise-size",85),a=wa("--noise-opacity-light",.03),n=wa("--noise-opacity-dark",.03),o={noiseSeed:ba(e.noiseSeed,0,999999,1337),noiseTextureSize:ba(e.noiseTextureSize,64,512,256),noiseDistribution:va(e.noiseDistribution,["uniform","gaussian"],"gaussian"),noiseMonochrome:void 0!==e.noiseMonochrome&&!!e.noiseMonochrome,noiseChroma:ya(e.noiseChroma,.9),noiseEnabled:void 0===e.noiseEnabled||!!e.noiseEnabled,noiseMotion:va(e.noiseMotion,["jitter","drift","static"],"jitter"),noiseMotionAmount:ga(e.noiseMotionAmount,0,2.5,1),noiseSpeedMs:ba(e.noiseSpeedMs,0,1e4,1100),noiseSpeedVariance:ga(e.noiseSpeedVariance,0,1,0),noiseFlicker:ga(e.noiseFlicker,0,1,.12),noiseFlickerSpeedMs:ba(e.noiseFlickerSpeedMs,0,5e3,220),noiseBlurPx:ga(e.noiseBlurPx,0,6,0),noiseContrast:ga(e.noiseContrast,.25,5,1.35),noiseBrightness:ga(e.noiseBrightness,.25,3,1),noiseSaturation:ga(e.noiseSaturation,0,3,1),noiseHue:ga(e.noiseHue,0,360,0),noiseSize:ga(e.noiseSize,20,600,t),noiseOpacity:ga(e.noiseOpacity,0,1,.03),noiseOpacityLight:ga(e.noiseOpacityLight,0,1,a),noiseOpacityDark:ga(e.noiseOpacityDark,0,1,n),noiseColorLight:"string"==typeof e.noiseColorLight?e.noiseColorLight:"#ffffff",noiseColorDark:"string"==typeof e.noiseColorDark?e.noiseColorDark:"#ffffff",detailNoiseOpacity:ga(e.detailNoiseOpacity,0,1,1)};return o.noiseMonochrome&&(o.noiseChroma=ya(o.noiseChroma,.9)),o}function Ca(e,{force:t=!1}={}){const a=JSON.stringify({seed:e.noiseSeed,size:e.noiseTextureSize,distribution:e.noiseDistribution,monochrome:e.noiseMonochrome,chroma:e.noiseChroma,contrast:(+e.noiseContrast).toFixed(3),brightness:(+e.noiseBrightness).toFixed(3),saturation:(+e.noiseSaturation).toFixed(3),hue:(+e.noiseHue).toFixed(1)});if(e.noiseEnabled)t||a!==ps?(ps=a,us&&window.clearTimeout(us),us=window.setTimeout(async()=>{us=null;const t=++cs,a=await(async({size:e,seed:t,distribution:a,monochrome:n,chroma:o,contrast:i,brightness:r,saturation:l,hue:s})=>{const d=(e=>(os||(os=document.createElement("canvas"),is=os.getContext("2d",{willReadFrequently:!0})),is?(os.width!==e&&(os.width=e),os.height!==e&&(os.height=e),ss!==e&&(ss=e,rs=null,ls=null),is):null))(e);if(!d)return null;rs||(rs=d.createImageData(e,e),ls=new Uint32Array(rs.data.buffer));const c=ls,u=xa(t),p="gaussian"===a,m=ya(o,0),h=1-m,f=ga(i,.25,5,1),g=ga(r,.25,3,1),b=ga(l,0,3,1),y=ga(s,0,360,0),v=1!==f||1!==g,w=1!==b,x=0!==y,M=.213,S=.715,k=.072;let C=1,F=0,L=0,O=0,D=1,I=0,P=0,W=0,K=1;if(x){const e=y*Math.PI/180,t=Math.cos(e),a=Math.sin(e);C=M+.787*t-a*M,F=S-t*S-a*S,L=k-t*k+.928*a,O=M-t*M+.143*a,D=S+t*(1-S)+.14*a,I=k-t*k-.283*a,P=M-t*M-.787*a,W=S-t*S+a*S,K=k+.928*t+a*k}for(let E=0;c.length>E;E++){const e=p?Ma(u):u();let t=e,a=e,o=e;if(n||(t=e*h+(p?Ma(u):u())*m,a=e*h+(p?Ma(u):u())*m,o=e*h+(p?Ma(u):u())*m),v&&(t=(t-.5)*f+.5,a=(a-.5)*f+.5,o=(o-.5)*f+.5,t*=g,a*=g,o*=g),w){const e=t*M+a*S+o*k;t=e*(1-b)+t*b,a=e*(1-b)+a*b,o=e*(1-b)+o*b}if(x){const e=t*O+a*D+o*I,n=t*P+a*W+o*K;t=t*C+a*F+o*L,a=e,o=n}const i=Math.max(0,Math.min(255,Math.round(255*t))),r=Math.max(0,Math.min(255,Math.round(255*a)));c[E]=255<<24|Math.max(0,Math.min(255,Math.round(255*o)))<<16|r<<8|i}d.putImageData(rs,0,0);const T=await(async e=>await new Promise(t=>{try{e.toBlob(e=>t(e),"image/png")}catch(a){t(null)}}))(os);return T?URL.createObjectURL(T):null})({size:e.noiseTextureSize,seed:e.noiseSeed,distribution:e.noiseDistribution,monochrome:e.noiseMonochrome,chroma:e.noiseChroma,contrast:e.noiseContrast,brightness:e.noiseBrightness,saturation:e.noiseSaturation,hue:e.noiseHue});if(t===cs){if(a)try{document.documentElement.style.setProperty("--abs-noise-texture",`url("${a}")`),ds&&URL.revokeObjectURL(ds),ds=a,document.body?.classList.add("noise-ready")}catch(n){URL.revokeObjectURL(a)}}else a&&URL.revokeObjectURL(a)},140)):ds&&e.noiseEnabled&&document.body?.classList.add("noise-ready");else{us&&window.clearTimeout(us),us=null,cs++,ps="";try{document.documentElement.style.setProperty("--abs-noise-texture","none"),document.body?.classList.remove("noise-ready")}catch(n){}if(ds)try{URL.revokeObjectURL(ds)}catch(n){}ds=null}}function Fa(e={}){const t=ns||ka({});return ka({...t,...fa(e)})}function La(e={}){ns=Fa(e),as=!0,Sa(ns),Ca(ns,{force:!0}),ns.noiseEnabled&&ds&&document.body?.classList.add("noise-ready")}function Oa(e={}){as||La(e),ns=Fa(e),Sa(ns),Ca(ns)}function Da(e){hs&&hs.style.setProperty("--ambient-light-mul",e+""),gs&&gs.style.setProperty("--ambient-light-mul",e+"")}function Ia(){Ms&&clearTimeout(Ms),Ms=null,Da(1);const e=b();if(!e||!0!==e.wallLightFluctuationEnabled)return;if(!hs)return;const t=()=>{const e=b();if(!e||!hs)return void(Ms=setTimeout(t,1e3));if(!0!==e.wallLightFluctuationEnabled)return Ms=null,void Da(1);const a=Math.max(0,+(e.wallLightFluctuationStrength??.15)||0);Da((1+2*(Math.random()-.5)*a).toFixed(3)),Ms=setTimeout(t,3e3+3e3*Math.random())};t()}function Pa(){if(ws)return;const e=document.getElementById("bravia-balls");if(!e)return void console.warn(" #bravia-balls not found, cannot create wall elements");hs=document.createElement("div"),hs.className="outer-wall",hs.setAttribute("aria-hidden","true"),e.insertBefore(hs,e.firstChild),fs=document.createElement("div"),fs.className="outer-wall__shine",fs.setAttribute("aria-hidden","true"),fs.style.position="absolute",fs.style.pointerEvents="none",hs.appendChild(fs),gs=document.createElement("div"),gs.className="inner-wall",gs.setAttribute("aria-hidden","true"),e.insertBefore(gs,e.firstChild.nextSibling),bs=document.createElement("div"),bs.className="inner-wall__glow",bs.setAttribute("aria-hidden","true"),bs.style.position="absolute",bs.style.top="0",bs.style.left="0",bs.style.right="0",bs.style.pointerEvents="none",gs.appendChild(bs),ys=document.createElement("div"),ys.className="inner-wall__shine",ys.setAttribute("aria-hidden","true"),ys.style.position="absolute",ys.style.pointerEvents="none",gs.appendChild(ys),vs=document.createElement("div"),vs.className="inner-shadow",vs.setAttribute("aria-hidden","true"),e.appendChild(vs),ws=!0,Ia(),Ka();const t=b();t&&Promise.resolve().then(()=>Ks).then(({updateWallShadowCSS:e})=>{e(t)}).catch(()=>{})}function Wa(){null===xs&&(xs=requestAnimationFrame(()=>{xs=null,hs&&gs&&((e,t)=>{const a=(getComputedStyle(document.documentElement).getPropertyValue("--wall-color")||"").trim();if(bs){const a=t?e.innerWallInnerGlowOpacityDark??.08:e.innerWallInnerGlowOpacityLight??0;if(a>.01){bs.style.display="block";const t=e.innerWallInnerGlowBlur??30,n=e.innerWallInnerGlowSpread??-5,o=e.innerWallInnerGlowOffsetY??0,i=(e=>{3===(e=e.replace(/^#/,"")).length&&(e=e[0]+e[0]+e[1]+e[1]+e[2]+e[2]);const t=parseInt(e,16);return{r:t>>16&255,g:t>>8&255,b:255&t}})(e.innerWallInnerGlowColor??"#ffffff");bs.style.inset="0",bs.style.boxShadow=`inset 0 ${o}px ${t}px ${n}px rgba(${i.r}, ${i.g}, ${i.b}, ${a})`}else bs.style.display="none",bs.style.boxShadow="none"}if(ys){const n=t?e.innerWallShineOpacityDark??.5:e.innerWallShineOpacityLight??.4;if(!1!==e.innerWallShineEnabled&&n>.01){ys.style.display="block";const o=e.innerWallShineBlur??20,i=e.innerWallShineSpread??4,r=e.innerWallShineOvershoot??10;ys.style.setProperty("--inner-wall-shine-opacity",n),ys.style.setProperty("--inner-wall-shine-blur",o+"px"),ys.style.setProperty("--inner-wall-shine-spread",i+"px"),ys.style.setProperty("--inner-wall-shine-overshoot",`-${r}px`),ys.style.setProperty("--inner-wall-shine-color",e.innerWallShineColor||a||(t?e.frameColorDark??e.frameColor??"#242529":e.frameColorLight??e.frameColor??"#242529"))}else ys.style.display="none"}if(fs){const n=t?e.outerWallShineOpacityDark??.5:e.outerWallShineOpacityLight??.4;if(!1!==e.outerWallShineEnabled&&n>.01){fs.style.display="block";const o=t?e.outerWallShineBlurDark??20:e.outerWallShineBlurLight??20,i=t?e.outerWallShineSpreadDark??4:e.outerWallShineSpreadLight??4,r=t?e.outerWallShineOvershootDark??10:e.outerWallShineOvershootLight??10;fs.style.setProperty("--outer-wall-shine-opacity",n),fs.style.setProperty("--outer-wall-shine-blur",o+"px"),fs.style.setProperty("--outer-wall-shine-spread",i+"px"),fs.style.setProperty("--outer-wall-shine-overshoot",`-${r}px`),fs.style.setProperty("--outer-wall-shine-color",t?e.outerWallShineColorDark||a||e.frameColorDark||e.frameColor||"#242529":e.outerWallShineColorLight||a||e.frameColorLight||e.frameColor||"#242529")}else fs.style.display="none"}if(gs){const a=e.innerWallBorderGradientSpread??75,n=t?e.innerWallBorderBrightOpacityDark??.6:e.innerWallBorderBrightOpacityLight??.5,o=t?e.innerWallBorderDimOpacityDark??.2:e.innerWallBorderDimOpacityLight??.15,i=t?e.innerWallBorderShadowOpacityDark??.35:e.innerWallBorderShadowOpacityLight??.2;gs.style.setProperty("--inner-wall-border-width",(e.innerWallBorderWidth??2)+"px"),gs.style.setProperty("--inner-wall-grad-stop-bright","0deg"),gs.style.setProperty("--inner-wall-grad-stop-dim-start",a+"deg"),gs.style.setProperty("--inner-wall-grad-stop-dim-end",360-a+"deg"),gs.style.setProperty("--inner-wall-border-bright-opacity",`calc(${n} * var(--ambient-light-mul, 1))`),gs.style.setProperty("--inner-wall-border-dim-opacity",`calc(${o} * var(--ambient-light-mul, 1))`),gs.style.setProperty("--inner-wall-border-shadow-opacity",i)}if(hs){const a=e.outerWallBorderGradientSpread??85,n=t?e.outerWallBorderBrightOpacityDark??.6:e.outerWallBorderBrightOpacityLight??.5,o=t?e.outerWallBorderDimOpacityDark??.2:e.outerWallBorderDimOpacityLight??.15,i=t?e.outerWallBorderShadowOpacityDark??.4:e.outerWallBorderShadowOpacityLight??.25;hs.style.setProperty("--outer-wall-border-width",(e.outerWallBorderWidth??2)+"px"),hs.style.setProperty("--outer-wall-grad-stop-bright","0deg"),hs.style.setProperty("--outer-wall-grad-stop-dim-start",a+"deg"),hs.style.setProperty("--outer-wall-grad-stop-dim-end",360-a+"deg"),hs.style.setProperty("--outer-wall-border-bright-opacity",`calc(${n} * var(--ambient-light-mul, 1))`),hs.style.setProperty("--outer-wall-border-dim-opacity",`calc(${o} * var(--ambient-light-mul, 1))`),hs.style.setProperty("--outer-wall-border-shadow-opacity",i);const r=e.wallAOSpread??2;hs.style.setProperty("--wall-ao-opacity",t?e.wallAOOpacityDark??.3:e.wallAOOpacityLight??.15),hs.style.setProperty("--wall-ao-spread",r+"px");const l=e.wallSpecularWidth??.5;hs.style.setProperty("--wall-specular-opacity",!1!==e.wallSpecularEnabled?t?e.wallSpecularOpacityDark??.5:e.wallSpecularOpacityLight??.4:0),hs.style.setProperty("--wall-specular-width",l+"px");const s=e.outerWallTopShadowBlur??8,d=e.outerWallTopShadowOffset??3;hs.style.setProperty("--outer-wall-top-shadow-opacity",t?e.outerWallTopShadowOpacityDark??.6:e.outerWallTopShadowOpacityLight??.4),hs.style.setProperty("--outer-wall-top-shadow-blur",s+"px"),hs.style.setProperty("--outer-wall-top-shadow-offset",d+"px")}})(b(),document.body.classList.contains("dark-mode"))}))}function Ka(){Wa()}function Ta(e){3===(e=e.replace(/^#/,"")).length&&(e=e[0]+e[0]+e[1]+e[1]+e[2]+e[2]);const t=parseInt(e,16);return{r:t>>16&255,g:t>>8&255,b:255&t}}function Ea(e){const t=document.getElementById("bravia-balls");if(!t)return;const a=document.body.classList.contains("dark-mode"),n=a?e.wallShadowEdgeTopOpacityDark??0:e.wallShadowEdgeTopOpacityLight??0,o=a?e.wallShadowEdgeLeftOpacityDark??0:e.wallShadowEdgeLeftOpacityLight??0,i=a?e.wallShadowEdgeBottomOpacityDark??0:e.wallShadowEdgeBottomOpacityLight??0,r=a?e.wallShadowEdgeRightOpacityDark??0:e.wallShadowEdgeRightOpacityLight??0,l=e.wallShadowAmbientBlur??20,s=a?e.wallShadowAmbientOpacityDark??.12:e.wallShadowAmbientOpacityLight??.04,d=a?e.wallShadowStrokeOpacityDark??0:e.wallShadowStrokeOpacityLight??0,c=[];n>0&&c.push(`inset 0 1px 0 rgba(0,0,0, ${n.toFixed(3)})`),o>0&&c.push(`inset 1px 0 0 rgba(0,0,0, ${o.toFixed(3)})`),i>0&&c.push(`inset 0 -1px 0 rgba(255,255,255, ${i.toFixed(3)})`),r>0&&c.push(`inset -1px 0 0 rgba(255,255,255, ${r.toFixed(3)})`),s>0&&c.push(`inset 2px 3px ${l}px rgba(0,0,0, ${s.toFixed(3)})`);let u="none",p=0;if(e.wallInnerShadowEnabled??1){const t=a?e.wallInnerShadowOpacityDarkV2??1:e.wallInnerShadowOpacityLightV2??1;if(p=t,t>0){const n=(e.wallInnerShadowBlurVh??15)+"vh",o=e.wallInnerShadowSpreadVh??15,i=0!==o?o+"vh":"0",r=a?"#0a0a0a":"#f5f5f5",{r:l,g:s,b:d}=Ta(r);u=`inset 0 0 ${n} ${i} rgba(${l}, ${s}, ${d}, ${t.toFixed(3)})`}}t.style.setProperty("--inner-wall-inner-shadow",u),t.style.setProperty("--inner-wall-inner-shadow-opacity",p+""),t.style.setProperty("--wall-stroke-opacity",d.toFixed(3));const m=document.getElementById("wall-shadow-override-style");m&&m.remove()}async function Ba(){if(!ks){const e=await Promise.resolve().then(()=>Ss);ks=e.updateWallElements}return ks}async function Aa(){return Ba()}function Ga(e,t){for(let a=0;e.length>a;a++){const n=e[a],o=document.getElementById(n+"Slider");o&&(o.disabled=t);const i=document.getElementById(n+"Picker");i&&(i.disabled=t);const r=document.querySelector(`[data-control-id="${n}"]`);r&&r.classList.toggle("is-disabled",t)}}function Ra(e=b()){e&&(Ga(Cs,!1===e.outerWallShineEnabled),Ga(Fs,!1===e.innerWallShineEnabled),Ga(Ls,!1===e.wallSpecularEnabled))}function za(e){return!1!==Os[e]}function $a(e,t=!0){const a=fo[e];if(!a)return;const n=b();for(const[i,r]of Object.entries(a))"label"!==i&&void 0!==n[i]&&(n[i]=r);n.parallaxLinearPreset=e,t&&Promise.resolve().then(()=>ir).then(({resetCurrentMode:e})=>e());try{an()}catch(o){}console.log("Applied parallax linear preset: "+a.label)}function _a(e){return{id:e,label:"Warmup Frames",stateKey:e,type:"range",min:0,max:240,step:1,default:10,format:e=>Math.round(e)+"",parse:e=>parseInt(e,10),reinitMode:!0,hint:"Pre-runs physics before first render to avoid visible settling on mode start."}}function Na(e,t){try{if("function"==typeof e?.format)return e.format(t)}catch(a){}return(t??"")+""}function Va(e){return((e??"")+"").replaceAll("&","&amp;").replaceAll('"',"&quot;").replaceAll("'","&#39;").replaceAll("<","&lt;").replaceAll(">","&gt;")}function Ha(){const e=[];for(const t of Object.values(Is))for(const a of t.controls)e.push({...a,section:t.title});return e}function ja(e){if("divider"===e.type)return`<div class="control-divider"><span class="control-divider-label">${e.label||""}</span></div>`;if(!za(e.id))return"";const t=e.id+"Slider",a=e.id+"Val",n=e.id+"Picker",o=e.hint?` title="${Va(e.hint)}"`:"",i=e.isHero?"control-row control-row--hero":"control-row";if("colorDistribution"===e.type){const t=(Array.isArray(e.labels)?e.labels:[]).map((e,t)=>{const a=((e||"")+"").trim();return`\n        <div class="color-dist-row" data-color-dist-row="${t}">\n          <div class="color-dist-row-label">${a}</div>\n          <div class="color-dist-row-controls">\n            <span class="color-dist-swatch" id="${"colorDistSwatch"+t}" aria-hidden="true"></span>\n            <select id="${"colorDistColor"+t}" class="control-select color-dist-select" aria-label="${a} color"></select>\n            <input type="range" id="${"colorDistWeight"+t}" min="0" max="100" step="1" value="0" aria-label="${a} weight">\n            <span class="color-dist-weight" id="${"colorDistWeightVal"+t}">0%</span>\n          </div>\n        </div>`}).join("");return`\n      <div class="${i}" data-control-id="${e.id}">\n        <div class="control-row-header">\n          <span class="control-label">${e.label}</span>\n          <span class="control-value" id="colorDistTotalVal">100%</span>\n        </div>\n        <div class="color-dist-grid" id="colorDistGrid">\n          ${t}\n        </div>\n        <div class="color-dist-actions">\n          <button type="button" class="secondary" id="colorDistResetBtn" aria-label="Reset color distribution to defaults">Reset Defaults</button>\n        </div>\n      </div>\n      ${e.hint?`<p class="control-hint">${e.hint}</p>`:""}`}if("color"===e.type)return`\n      <label class="${i}" data-control-id="${e.id}">\n        <div class="control-row-header">\n          <span class="control-label"${o}>${e.label}</span>\n          <span class="control-value" id="${a}">${e.default}</span>\n        </div>\n        <input type="color" id="${n}" value="${e.default}" aria-label="${e.label}" />\n      </label>\n      ${e.hint?`<p class="control-hint">${e.hint}</p>`:""}`;if("select"===e.type){const n=(Array.isArray(e.options)?e.options:[]).map(t=>{const a=t.value+"";return`<option value="${a}" ${e.default+""===a?"selected":""}>${(t.label??t.value)+""}</option>`}).join(""),r=e.hint?`<p class="control-hint">${e.hint}</p>`:"";return`\n      <label class="${i}" data-control-id="${e.id}">\n        <div class="control-row-header">\n          <span class="control-label"${o}>${e.label}</span>\n          <span class="control-value" id="${a}">${Na(e,e.default)}</span>\n        </div>\n        <select id="${t}" class="control-select" aria-label="${e.label}">\n          ${n}\n        </select>\n      </label>\n      ${r}`}if("checkbox"===e.type||"toggle"===e.type)return`\n      <label class="${i}" data-control-id="${e.id}">\n        <div class="control-row-header">\n          <span class="control-label"${o}>${e.label}</span>\n          <span class="control-value" id="${a}">${e.default?"On":"Off"}</span>\n        </div>\n        <input type="checkbox" id="${t}" ${e.default?"checked":""} aria-label="${e.label}">\n      </label>\n      ${e.hint?`<p class="control-hint">${e.hint}</p>`:""}`;const r=e.hint?`<p class="control-hint">${e.hint}</p>`:"";return`\n      <label class="${i}" data-control-id="${e.id}">\n        <div class="control-row-header">\n          <span class="control-label"${o}>${e.label}</span>\n          <span class="control-value" id="${a}">${Na(e,e.default)}</span>\n        </div>\n        <input type="range" id="${t}" min="${e.min}" max="${e.max}" step="${e.step}" value="${e.default}">\n      </label>\n      ${r}`}function qa(e,t){if("outerWall"===e||"innerWall"===e)return((e,t)=>{const a=t.controls.filter(e=>"divider"!==e.type&&e.id&&za(e.id));if(0===a.length)return"";const n=a.filter(e=>null==e.theme),o=a.filter(e=>"light"===e.theme),i=a.filter(e=>"dark"===e.theme),r="undefined"!=typeof document&&document.body.classList.contains("dark-mode")?"dark":"light",l=(e,t)=>"outerWall"===t?{shadow:1,micro:2,shine:3,geometry:4}[e]??99:"innerWall"===t?{innerShadow:1,shine:2,innerGlow:3,shadow:4,micro:5,geometry:6}[e]??99:99,s=t=>[...t].sort((t,a)=>{const n=l(t.wallGroup,e),o=l(a.wallGroup,e);return n!==o?n-o:0}),d=Za(s(n)),c=Za(s(o)),u=Za(s(i));return`\n    <details class="panel-section-accordion" data-section-key="${e}" ${t.defaultOpen?"open":""}>\n      \n    <summary class="panel-section-header">\n      ${t.icon?`<span class="section-icon">${t.icon}</span>`:""}\n      <span class="section-label">${t.title}</span>\n    </summary>\n      <div class="panel-section-content wall-section-with-tabs">\n    ${d}\n    \n    <div class="wall-theme-tabs" role="tablist" aria-label="Light or dark theme">\n      <button type="button" class="wall-theme-tab${"light"===r?" active":""}" data-wall-section="${e}" data-theme="light" role="tab" aria-selected="${"light"===r}">Light</button>\n      <button type="button" class="wall-theme-tab${"dark"===r?" active":""}" data-wall-section="${e}" data-theme="dark" role="tab" aria-selected="${"dark"===r}">Dark</button>\n    </div>\n    <div id="${e}LightPanel" class="wall-tab-panel${"light"===r?" active":""}" role="tabpanel" data-theme="light">${c}</div>\n    <div id="${e}DarkPanel" class="wall-tab-panel${"dark"===r?" active":""}" role="tabpanel" data-theme="dark">${u}</div>\n  </div>\n    </details>`})(e,t);const a=t.controls.filter(e=>za(e.id));if(0===a.length)return"";let n=null,o="";for(const s of a)s.group&&s.group!==n?(null!==n&&(o+="</div>"),o+=`<div class="section-title">${s.group}</div><div class="group ${s.groupLayout||""}">`,n=s.group):s.group||null===n||(o+="</div>",n=null),o+=ja(s);null!==n&&(o+="</div>");const i=t.defaultOpen?"open":"",r=`\n    <summary class="panel-section-header">\n      ${t.icon?`<span class="section-icon">${t.icon}</span>`:""}\n      <span class="section-label">${t.title}</span>\n    </summary>`,l=`<div class="panel-section-content">${o}</div>`;return t.mode?`\n      <div id="${t.mode}Controls" class="mode-controls">\n        <details class="panel-section-accordion" ${i}>\n          ${r}\n          ${l}\n        </details>\n      </div>`:`\n    <details class="panel-section-accordion" ${i}>\n      ${r}\n      ${l}\n    </details>`}function Za(e){let t="",a=null,n=!1;for(const o of e){const e=o.wallGroup||null;if(e!==a){if(n&&(t+="</div>"),n=!1,e&&Ps[e]){const a=Ps[e],o=Ws[e]||"";t+=`<div class="wall-chunk" data-wall-group="${Va(e)}"><div class="wall-chunk-header"><span class="wall-chunk-label">${Va(a)}</span><p class="wall-chunk-desc">${Va(o)}</p></div>`,n=!0}a=e}t+=ja(o)}return n&&(t+="</div>"),t}function Ya(){return'\n    <div class="wall-stack-diagram-sticky">\n    <div class="wall-stack-iso" role="img" aria-label="Wall layer stack, top to bottom">\n      <div class="wall-stack-iso__caption">Wall stack (top  bottom)</div>\n      <div class="wall-stack-iso__groups">\n        <div class="wall-stack-iso__group" data-wall="inner">\n          <div class="wall-stack-iso__group-label">Inner Wall</div>\n          <div class="wall-stack-iso__group-body">\n            <div class="wall-stack-iso__row" data-layer="inner-shine" data-section="innerWall" data-group="shine">\n              <div class="wall-stack-iso__layer" data-layer="inner-shine"></div>\n              <div class="wall-stack-iso__label">Inner Shine <span class="wall-stack-iso__z">Z:35</span></div>\n            </div>\n            <div class="wall-stack-iso__row" data-layer="inner-glow" data-section="innerWall" data-group="innerGlow">\n              <div class="wall-stack-iso__layer" data-layer="inner-glow"></div>\n              <div class="wall-stack-iso__label">Inner Glow <span class="wall-stack-iso__z">Z:30</span></div>\n            </div>\n            <div class="wall-stack-iso__row" data-layer="inner-shadow" data-section="innerWall" data-group="innerShadow">\n              <div class="wall-stack-iso__layer" data-layer="inner-shadow"></div>\n              <div class="wall-stack-iso__label">Inner Shadow <span class="wall-stack-iso__z">Z:25</span></div>\n            </div>\n          </div>\n        </div>\n        <div class="wall-stack-iso__group" data-wall="outer">\n          <div class="wall-stack-iso__group-label">Outer Wall</div>\n          <div class="wall-stack-iso__group-body">\n            <div class="wall-stack-iso__row" data-layer="outer-shine" data-section="outerWall" data-group="shine">\n              <div class="wall-stack-iso__layer" data-layer="outer-shine"></div>\n              <div class="wall-stack-iso__label">Outer Shine <span class="wall-stack-iso__z">Z:25</span></div>\n            </div>\n            <div class="wall-stack-iso__row" data-layer="outer-shadow" data-section="outerWall" data-group="shadow">\n              <div class="wall-stack-iso__layer" data-layer="outer-shadow"></div>\n              <div class="wall-stack-iso__label">Outer Shadow <span class="wall-stack-iso__z">Z:25</span></div>\n            </div>\n            <div class="wall-stack-iso__row" data-layer="outer-micro" data-section="outerWall" data-group="micro">\n              <div class="wall-stack-iso__layer" data-layer="outer-micro"></div>\n              <div class="wall-stack-iso__label">Outer Micro <span class="wall-stack-iso__z">Z:25</span></div>\n            </div>\n          </div>\n        </div>\n        <div class="wall-stack-iso__group" data-wall="shared">\n          <div class="wall-stack-iso__group-label">Shared</div>\n          <div class="wall-stack-iso__group-body">\n            <div class="wall-stack-iso__row" data-layer="geometry" data-section="outerWall" data-group="geometry">\n              <div class="wall-stack-iso__layer" data-layer="geometry"></div>\n              <div class="wall-stack-iso__label">Geometry <span class="wall-stack-iso__z">Z:25</span></div>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n    </div>\n  '}function Ua({open:e=!0}={}){return`\n    <details class="panel-section-accordion" ${e?"open":""}>\n      <summary class="panel-section-header">\n        <span class="section-icon"></span>\n        <span class="section-label">Theme</span>\n      </summary>\n      <div class="panel-section-content">\n        <div class="theme-segment-control" role="group" aria-label="Theme selector">\n          <button id="themeAuto" class="theme-segment-btn" aria-label="Auto theme">Auto</button>\n          <button id="themeLight" class="theme-segment-btn active" aria-label="Light theme">Light</button>\n          <button id="themeDark" class="theme-segment-btn" aria-label="Dark theme">Dark</button>\n        </div>\n        <div id="themeStatus" class="panel-status"> Light Mode</div>\n      </div>\n    </details>`}function Xa({open:e=!1}={}){return`\n    <details class="panel-section-accordion" ${e?"open":""}>\n      <summary class="panel-section-header">\n        <span class="section-icon"></span>\n        <span class="section-label">Palette</span>\n      </summary>\n      <div class="panel-section-content">\n        <label class="control-row">\n          <div class="control-row-header">\n            <span class="control-label">Color Template</span>\n            <span class="control-value"></span>\n          </div>\n          <select id="colorSelect"></select>\n        </label>\n        <label class="control-row">\n          <div class="control-row-header">\n            <span class="control-label">Rotate on Reload</span>\n            <span class="control-value"></span>\n          </div>\n          <input id="paletteRotateOnReload" type="checkbox" />\n        </label>\n      </div>\n    </details>`}function Qa(e={}){const{prepend:t={},append:a={},replace:n={}}=e;let o="";for(const i of Ds){if(n[i.id]){o+=`\n      <details class="panel-master-group" data-group-id="${i.id}">\n        <summary class="panel-master-group-header">\n          ${i.icon?`<span class="panel-master-group-icon">${i.icon}</span>`:""}\n          <span class="panel-master-group-title">${i.title}</span>\n        </summary>\n        <div class="panel-master-group-content">\n          ${n[i.id]}\n        </div>\n      </details>`;continue}let e="";t[i.id]&&(e+=t[i.id]);for(const t of i.sections)Is[t]&&(e+=qa(t,Is[t]));a[i.id]&&(e+=a[i.id]),e&&(o+=`\n      <details class="panel-master-group" data-group-id="${i.id}">\n        <summary class="panel-master-group-header">\n          ${i.icon?`<span class="panel-master-group-icon">${i.icon}</span>`:""}\n          <span class="panel-master-group-title">${i.title}</span>\n        </summary>\n        <div class="panel-master-group-content">\n          ${e}\n        </div>\n      </details>`)}return o}function Ja(){const e={pit:"",bubbles:"",critters:"",flies:"",water:"",magnetic:"",weightless:"","kaleidoscope-3":"","parallax-linear":"","parallax-float":"","3d-sphere":"","3d-cube":"","starfield-3d":"","elastic-center":"","particle-fountain":""},t={pit:"Pit",bubbles:"Bubbles",critters:"Hive",flies:"Flies",water:"Water",magnetic:"Magnet",weightless:"Zero-G","kaleidoscope-3":"Kalei","parallax-linear":"Parallax Lin","parallax-float":"Parallax Float","3d-sphere":"Sphere 3D","3d-cube":"Cube 3D","starfield-3d":"Starfield 3D","elastic-center":"Elastic Center","particle-fountain":"Fountain"},a=((e=new Date)=>{const t=new Date(e.getFullYear(),0,0);return Math.floor((e-t)/864e5)})(),n=uo[a%uo.length];let o="";return uo.forEach((a,i)=>{const r=e[a]||"",l=t[a]||a,s=(i+1+"").padStart(2,"0"),d=a===n;o+=`<button class="mode-button${d?" is-daily-mode":""}" data-mode="${a}" aria-label="${s}  ${po[a]||l} mode${d?" (Today's Simulation)":""}"><span class="mode-button-number">${s}</span><span class="mode-button-label">${r} ${l}${d?'<span class="daily-badge" title="Today\'s Simulation"></span>':""}</span></button>`}),`\n    <details class="panel-section-accordion" id="modeSwitcherSection" open>\n      <summary class="panel-section-header">\n        <span class="section-icon"></span>\n        <span class="section-label">Mode</span>\n      </summary>\n      <div class="panel-section-content">\n        <div class="mode-switcher" role="group" aria-label="Simulation mode selector">\n          ${o}\n        </div>\n      </div>\n    </details>`}function en(){const e=new Set(uo);let t="";for(const[a,n]of Object.entries(Is))n?.mode&&e.has(n.mode)&&(t+=qa(a,n));return t}function tn(){const e=b();for(const[a,n]of Object.entries(Is))for(const o of n.controls){const i=document.getElementById(o.id+"Val");if("colorDistribution"===o.type){const l=Array.isArray(o.labels)?o.labels:[],s=document.getElementById("colorDistResetBtn");function d(e){return((e||"")+"").trim().toLowerCase()}function c(e,t,a,n=t){const o=+e;if(!Number.isFinite(o))return n;const i=Math.floor(o);return t>i?t:i>a?a:i}function u(e){const t=[];for(let a=0;8>a;a++)t.push({value:a+"",label:`Ball ${a+1}${e[a]?"  "+e[a]:""}`});return t}function p(t){const a=Array.isArray(e.colorDistribution)?e.colorDistribution:[],n=new Map;for(const e of a)n.set(d(e?.label),e);const o=new Map([["art & visual direction","frontend craft"]]),i=Array.isArray(t)?t:a,r=[],s=new Set;for(let e=0;l.length>e;e++){const t=((l[e]||"")+"").trim(),a=d(t),u=o.get(a),p=i.find(e=>d(e?.label)===a)||(u?i.find(e=>d(e?.label)===u):null)||n.get(a)||(u?n.get(u):null)||{};let m=c(p?.colorIndex,0,7,c(n.get(a)?.colorIndex,0,7,0));if(s.has(m))for(let e=0;8>e;e++)if(!s.has(e)){m=e;break}s.add(m);const h=c(p?.weight,0,100,c(n.get(a)?.weight,0,100,0));r.push({label:t,colorIndex:m,weight:h})}return r}function m(e,t=0){const a=e.map(e=>c(e,0,100,0));let n=0;for(let l=0;a.length>l;l++)n+=a[l];if(100===n)return a;if(0===n)return a[t]=100,a;const o=Array(a.length).fill(0);let i=0;for(let l=0;a.length>l;l++){const e=Math.round(a[l]/n*100);o[l]=e,i+=e}let r=100-i;for(;0!==r;)if(r>0){let e=0;for(let t=1;o.length>t;t++)o[t]>o[e]&&(e=t);o[e]+=1,r-=1}else{let e=-1;for(let t=0;o.length>t;t++)o[t]>0&&(-1===e||o[t]>o[e])&&(e=t);if(-1===e)break;o[e]-=1,r+=1}return o.map(e=>c(e,0,100,0))}function h(e,t,a){const n=e.map(e=>c(e?.weight,0,100,0));return n[t]=c(a,0,100,n[t]),100===n.reduce((e,t)=>e+t,0)?n:m(n,t)}function f(){const t=e.currentMode,a={pit:null,flies:e.fliesBallCount,weightless:e.weightlessCount,water:e.waterBallCount,magnetic:e.magneticBallCount,bubbles:e.bubblesMaxCount,"kaleidoscope-3":e.kaleidoscope3BallCount,critters:e.critterCount,"parallax-linear":Math.max(0,Math.round((e.parallaxLinearGridX??0)*(e.parallaxLinearGridY??0)*(e.parallaxLinearGridZ??0))),"parallax-float":Math.max(0,Math.round((e.parallaxFloatGridX??e.parallaxLinearGridX??0)*(e.parallaxFloatGridY??e.parallaxLinearGridY??0)*(e.parallaxFloatGridZ??e.parallaxLinearGridZ??0))),"3d-sphere":e.sphere3dDensity,"3d-cube":null,"starfield-3d":e.starfieldCount,"elastic-center":null,"particle-fountain":e.particleFountainMaxParticles}[t];return Number.isFinite(+a)?+a:null}function g(){import("./legend-colors.js").then(({applyExpertiseLegendColors:e})=>e?.()).catch(()=>{}),Promise.resolve().then(()=>Io).then(({pickRandomColor:t})=>{if("function"!=typeof t)return;const a=e.balls||[];for(let e=0;a.length>e;e++)a[e].color=t()}).catch(()=>{})}function y(){const t=p(e.colorDistribution),a=m(t.map(e=>e.weight),0);for(let e=0;t.length>e;e++)t[e].weight=a[e];e.colorDistribution=t;const n={};for(let e=0;t.length>e;e++)n[t[e].colorIndex]=t[e].label;const o=u(n),i=f();for(let e=0;l.length>e;e++){const a=t[e]||{colorIndex:0,weight:0},r=document.getElementById("colorDistSwatch"+e),l=document.getElementById("colorDistColor"+e),s=document.getElementById("colorDistWeight"+e),d=document.getElementById("colorDistWeightVal"+e);if(l){l.innerHTML="";for(const e of o){const t=document.createElement("option");t.value=e.value,t.textContent=e.label;const o=c(e.value,0,7,0);n[o]&&!(o===a.colorIndex)&&(t.disabled=!0),l.appendChild(t)}l.value=a.colorIndex+""}if(s&&(s.value=c(a.weight,0,100,0)+""),d){const e=c(a.weight,0,100,0),t=null!=i?Math.round(e/100*i):null;d.textContent=null!=t?`${e}% (${t})`:e+"%"}if(r){const e=c(a.colorIndex,0,7,0);r.style.backgroundColor=`var(--ball-${e+1})`}}const r=document.getElementById("colorDistTotalVal");if(r){let e=0;for(let a=0;t.length>a;a++)e+=t[a].weight;r.textContent=e+"%"}}try{y()}catch(t){}s&&s.addEventListener("click",()=>{const t=e?.config?.colorDistribution;e.colorDistribution=p(t);const a=m(e.colorDistribution.map(e=>e.weight),0);for(let n=0;e.colorDistribution.length>n;n++)e.colorDistribution[n].weight=a[n];y(),g()});for(let v=0;l.length>v;v++){const w=document.getElementById("colorDistColor"+v),x=document.getElementById("colorDistWeight"+v);w&&w.addEventListener("change",()=>{const t=c(w.value,0,7,0),a=p(e.colorDistribution);a[v].colorIndex=t,e.colorDistribution=a,y(),g()}),x&&x.addEventListener("input",()=>{const t=c(x.value,0,100,0),a=p(e.colorDistribution),n=h(a,v,t);for(let e=0;a.length>e;e++)a[e].weight=n[e];e.colorDistribution=a,y(),g()})}continue}if("color"===o.type){const M=document.getElementById(o.id+"Picker");if(!M)continue;M.addEventListener("input",()=>{const t=M.value;o.stateKey&&(e[o.stateKey]=t),o.onChange&&o.onChange(e,t),i&&(i.textContent=t)});continue}if("select"===o.type){const S=document.getElementById(o.id+"Slider");if(!S)continue;S.addEventListener("change",()=>{const t=o.parse?o.parse(S.value):S.value;if(o.stateKey&&(e[o.stateKey]=t),o.onChange&&o.onChange(e,t),i){const a=o.stateKey?e[o.stateKey]:t;i.textContent=o.format?o.format(a):a+""}});continue}if("checkbox"===o.type||"toggle"===o.type){const k=document.getElementById(o.id+"Slider");if(!k)continue;k.addEventListener("change",()=>{const t=!!k.checked;o.stateKey&&(e[o.stateKey]=t),o.onChange&&o.onChange(e,t),Ra(e),i&&(i.textContent=t?"On":"Off"),o.reinitMode&&e.currentMode===n.mode&&Promise.resolve().then(()=>ir).then(({resetCurrentMode:e})=>e?.()).catch(()=>{})});continue}const r=document.getElementById(o.id+"Slider");r&&r.addEventListener("input",()=>{const t="function"==typeof o?.parse?o.parse(r.value):Number.parseFloat(r.value);o.stateKey&&(e[o.stateKey]=t),o.onChange&&o.onChange(e,t),i&&(i.textContent=o.format(o.stateKey?e[o.stateKey]:t)),o.reinitMode&&e.currentMode===n.mode&&Promise.resolve().then(()=>ir).then(({resetCurrentMode:e})=>e?.()).catch(()=>{})})}Ra(e)}function an(e={}){const t=b(),a=!1!==e.runOnChange;for(const n of Object.values(Is))for(const e of n.controls){if("colorDistribution"===e.type)continue;const n=e.id+"Val",o=document.getElementById("color"===e.type?e.id+"Picker":e.id+"Slider"),i=document.getElementById(n);if(!o||!e.stateKey)continue;const r=t[e.stateKey];void 0!==r&&("checkbox"===e.type||"toggle"===e.type?(o.checked=!!r,i&&(i.textContent=r?"On":"Off")):"color"===e.type?(o.value=r,i&&(i.textContent=r)):(o.value=r,i&&(i.textContent=e.format?e.format(r):r+"")),a&&e.onChange&&"wallPreset"!==e.id&&e.onChange(t,r))}Ra(t)}function nn(){document.querySelectorAll(".wall-theme-tab").forEach(e=>{e.C||(e.C=!0,e.addEventListener("click",()=>{const t=e.getAttribute("data-wall-section"),a=e.getAttribute("data-theme");if(!t||!a)return;const n=e.closest(".wall-section-with-tabs");if(!n)return;n.querySelectorAll(".wall-theme-tab").forEach(e=>{e.classList.remove("active"),e.setAttribute("aria-selected","false")}),n.querySelectorAll(".wall-tab-panel").forEach(e=>e.classList.remove("active")),e.classList.add("active"),e.setAttribute("aria-selected","true");const o=document.getElementById(t+("light"===a?"LightPanel":"DarkPanel"));o&&o.classList.add("active")}))})}function on(){const e=document.body.classList.contains("dark-mode")?"dark":"light";document.querySelectorAll(".wall-section-with-tabs").forEach(t=>{const a=t.querySelector(".wall-theme-tab")?.getAttribute("data-wall-section");if(!a)return;const n=t.querySelector(`.wall-theme-tab[data-theme="${e}"]`),o=document.getElementById(a+("light"===e?"LightPanel":"DarkPanel"));n&&o&&(t.querySelectorAll(".wall-theme-tab").forEach(e=>{e.classList.remove("active"),e.setAttribute("aria-selected","false")}),t.querySelectorAll(".wall-tab-panel").forEach(e=>e.classList.remove("active")),n.classList.add("active"),n.setAttribute("aria-selected","true"),o.classList.add("active"))})}function rn(t){Bs=t;let a=!1;a="auto"===t?"dark"===As||(()=>{const e=b();if(!e.autoDarkModeEnabled)return!1;const t=Number.isFinite(e.autoDarkNightStartHour)?e.autoDarkNightStartHour:18,a=Number.isFinite(e.autoDarkNightEndHour)?e.autoDarkNightEndHour:6,n=(new Date).getHours();return t!==a&&(a>t?n>=t&&a>n:n>=t||a>n)})():"dark"===t,(t=>{const a=b();a.isDarkMode=t,document.documentElement.style.colorScheme=t?"dark":"light",t?(a.container?.classList.add("dark-mode"),document.body.classList.add("dark-mode"),document.documentElement.classList.add("dark-mode")):(a.container?.classList.remove("dark-mode"),document.body.classList.remove("dark-mode"),document.documentElement.classList.remove("dark-mode")),(e=>{const t=(b().chromeHarmonyMode||"auto")+"",a=(()=>{const e=navigator.userAgent||"",t=navigator.vendor||"",a=/Firefox\//.test(e)||/FxiOS\//.test(e),n=/Safari\//.test(e)&&/Apple/.test(t)&&!/Chrome\//.test(e)&&!/Chromium\//.test(e)&&!/CriOS\//.test(e)&&!/FxiOS\//.test(e)&&!/Edg\//.test(e)&&!/EdgiOS\//.test(e)&&!/OPR\//.test(e)&&!/OPiOS\//.test(e),o=/SamsungBrowser\//.test(e);return{isFirefox:a,isSafari:n,isSamsungInternet:o,isChromium:/Chrome\//.test(e)||/Chromium\//.test(e)||/CriOS\//.test(e)||/Edg\//.test(e)||/EdgiOS\//.test(e)||/OPR\//.test(e)||/OPiOS\//.test(e)||/Brave\//.test(e)||o,ua:e}})(),n=(e=>{const t=navigator.userAgent||"",a=/Android/.test(t),n=/iPhone|iPad|iPod/.test(t)||/Mac/.test(t)&&navigator.maxTouchPoints>1,o=window.matchMedia&&window.matchMedia("(display-mode: standalone)").matches||window.matchMedia&&window.matchMedia("(display-mode: minimal-ui)").matches||!0===navigator.standalone;return!e.isFirefox&&(!!o||!!e.isSafari||(e.isChromium?a||e.isSamsungInternet:a||n))})(a);"site"===t?ma(e):"browser"===t?ha(e,a):a.isSafari||!a.isChromium&&!a.isFirefox||n?ma(e):ha(e,a)})(t),(t=>{const a=b(),n=e("--wall-color",""),o=e("--wall-color-light",""),i=e("--wall-color-dark",""),r=n||(t?i||o:o||i)||a?.frameColor||a?.frameColorLight||a?.frameColorDark||"#242529",l=o||r,s=i||r;let d=document.querySelector('meta[name="theme-color"]:not([media])');d||(d=document.createElement("meta"),d.name="theme-color",document.head.appendChild(d)),d.content=r;let c=document.querySelector('meta[name="theme-color"][media="(prefers-color-scheme: light)"]');c||(c=document.createElement("meta"),c.name="theme-color",c.media="(prefers-color-scheme: light)",document.head.appendChild(c)),c.content=l;let u=document.querySelector('meta[name="theme-color"][media="(prefers-color-scheme: dark)"]');u||(u=document.createElement("meta"),u.name="theme-color",u.media="(prefers-color-scheme: dark)",document.head.appendChild(u)),u.content=s;let p=document.querySelector('meta[name="apple-mobile-web-app-status-bar-style"]');p||(p=document.createElement("meta"),p.name="apple-mobile-web-app-status-bar-style",document.head.appendChild(p)),p.content="black-translucent"})(t),ta(),Si=null,ki="",te(a.currentTemplate),Ea(a),((e,t)=>{const a=document.documentElement;a.style.setProperty("--outer-wall-top-dark-opacity",(e?t.outerWallTopDarkOpacityDark??.4:t.outerWallTopDarkOpacityLight??.6)+""),a.style.setProperty("--outer-wall-bottom-light-opacity",(e?t.outerWallBottomLightOpacityDark??.3:t.outerWallBottomLightOpacityLight??.5)+""),a.style.setProperty("--outer-wall-cast-shadow-opacity",(e?t.outerWallCastShadowOpacityDark??.25:t.outerWallCastShadowOpacityLight??.15)+""),a.style.setProperty("--inner-wall-outward-shadow-opacity",(e?t.innerWallOutwardShadowOpacityDark??.35:t.innerWallOutwardShadowOpacityLight??.2)+""),a.style.setProperty("--inner-wall-inner-glow-opacity",(e?t.innerWallInnerGlowOpacityDark??.08:t.innerWallInnerGlowOpacityLight??0)+""),a.style.setProperty("--outer-wall-top-bevel-opacity",(e?t.outerWallTopBevelOpacityDark??.35:t.outerWallTopBevelOpacityLight??.25)+""),a.style.setProperty("--inner-wall-top-bevel-opacity",(e?t.innerWallTopBevelOpacityDark??.25:t.innerWallTopBevelOpacityLight??.18)+""),a.style.setProperty("--inner-wall-top-light-opacity",(e?t.innerWallTopLightOpacityDark??.4:t.innerWallTopLightOpacityLight??.3)+"")})(t,a),Ka(),(()=>{const e=document.getElementById("themeAuto"),t=document.getElementById("themeLight"),a=document.getElementById("themeDark");if(!e||!t||!a)return;[e,t,a].forEach(e=>e.classList.remove("active")),"auto"===Bs?e.classList.add("active"):"light"===Bs?t.classList.add("active"):a.classList.add("active");const n=document.getElementById("themeStatus");if(n){const e=b();n.textContent="auto"===Bs?e.isDarkMode?" Auto (Dark)":" Auto (Light)":"light"===Bs?" Light Mode":" Dark Mode"}})(),on()})(a),(e=>{try{localStorage.setItem(Ts,e),localStorage.removeItem(Es)}catch(t){}})(t),sa(` Theme set to: ${t} (rendering: ${a?"dark":"light"})`)}function ln(){if(Gs)return;Gs=!0,(()=>{try{localStorage.removeItem(Ts),localStorage.removeItem(Es),localStorage.removeItem("abs_palette_chapter"),sa(" Cleared color-related localStorage cache")}catch(e){}})(),(()=>{const e=b(),t=document.documentElement;e?.bgLight&&t.style.setProperty("--bg-light",e.bgLight),e?.bgDark&&t.style.setProperty("--bg-dark",e.bgDark);const a=e?.frameColor||e?.frameColorLight||e?.frameColorDark||"#242529";t.style.setProperty("--frame-color",a),t.style.setProperty("--wall-color",a),t.style.setProperty("--chrome-bg",a),t.style.setProperty("--frame-color-light",a),t.style.setProperty("--frame-color-dark",a),t.style.setProperty("--wall-color-light",a),t.style.setProperty("--wall-color-dark",a),t.style.setProperty("--chrome-bg-light",a),t.style.setProperty("--chrome-bg-dark",a);const n=document.querySelector('meta[name="theme-color"]');n&&(n.content=a),e?.textColorLight&&t.style.setProperty("--text-color-light",e.textColorLight),e?.textColorLightMuted&&t.style.setProperty("--text-color-light-muted",e.textColorLightMuted),e?.textColorDark&&t.style.setProperty("--text-color-dark",e.textColorDark),e?.textColorDarkMuted&&t.style.setProperty("--text-color-dark-muted",e.textColorDarkMuted),Number.isFinite(e?.edgeLabelInsetAdjustPx)&&t.style.setProperty("--edge-label-inset-adjust",e.edgeLabelInsetAdjustPx+"px"),e?.linkHoverColor&&t.style.setProperty("--link-hover-color",e.linkHoverColor)})(),As=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light",sa(" System prefers: "+As),rn((()=>{try{const e=localStorage.getItem(Ts);if("auto"===e||"light"===e||"dark"===e)return e;const t=localStorage.getItem(Es);"auto"!==t&&"light"!==t&&"dark"!==t||(localStorage.removeItem(Es),localStorage.setItem(Ts,"auto"))}catch(e){}return"auto"})());const e=document.getElementById("themeAuto"),t=document.getElementById("themeLight"),a=document.getElementById("themeDark");e&&e.addEventListener("click",()=>rn("auto")),t&&t.addEventListener("click",()=>rn("light")),a&&a.addEventListener("click",()=>rn("dark")),window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",e=>{As=e.matches?"dark":"light",sa(" System preference changed to: "+As),"auto"===Bs&&rn("auto")}),window.setInterval(()=>{"auto"===Bs&&rn("auto")},6e4),sa(" Modern dark mode initialized")}function sn(){rn("light"===Bs?"dark":"light")}function dn(){console.log(" localStorage is disabled")}function cn(){return console.log(" localStorage is disabled - using defaults"),!1}function un(){clearTimeout(window.settingsSaveTimeout),window.settingsSaveTimeout=setTimeout(dn,500)}function pn(e){return!!e&&"object"==typeof e&&!Array.isArray(e)}function mn(){try{const e="undefined"!=typeof window?window.__TEXT__:null;return pn(e)?e:null}catch(e){return null}}async function hn(){if(zs)return zs;const e=mn();if(e)return zs=e,zs;const t=await(async()=>{const e=["config/contents-home.json","js/contents-home.json","../dist/js/contents-home.json"];for(const a of e)try{const e=await fetch(a,{cache:"no-cache"});if(!e.ok)continue;const t=await e.json();if(pn(t))return t}catch(t){}throw Error("No contents-home.json found")})();zs=t;try{"undefined"!=typeof window&&(window.__TEXT__=t)}catch(a){}return zs}function fn(e,t=""){const a=zs||mn();if(!a)return t;if(!e)return t;const n=(e+"").split(".").filter(Boolean);let o=a;for(const i of n){if(!pn(o)&&!Array.isArray(o))return t;if(o=o?.[i],null==o)return t}return o}function gn(){return"function"==typeof document.startViewTransition}function bn(){document.querySelectorAll(".modal.active, [data-modal].active").forEach(e=>{e.classList.remove("active"),e.setAttribute("aria-hidden","true")});const e=document.getElementById("modal-overlay");e?.classList.contains("active")&&e.classList.remove("active");const t=document.getElementById("master-panel");t?.classList.contains("open")&&t.classList.remove("open"),document.documentElement.classList.remove("modal-active")}function yn(e=Ns.INTERNAL){try{sessionStorage.setItem($s,e),sessionStorage.setItem(_s,Date.now()+"")}catch(t){}}function vn(){try{const e=sessionStorage.getItem($s),t=parseInt(sessionStorage.getItem(_s)||"0",10),a=5e3>Date.now()-t;if(sessionStorage.removeItem($s),sessionStorage.removeItem(_s),sessionStorage.removeItem("abs_open_cv_modal"),sessionStorage.removeItem("abs_open_cv_gate"),sessionStorage.removeItem("abs_open_portfolio_modal"),sessionStorage.removeItem("abs_open_contact_modal"),sessionStorage.removeItem("abs_internal_nav"),e&&a)return e}catch(e){}return null}function wn(){try{const e=performance.getEntriesByType("navigation");if(e.length>0)return"back_forward"===e[0].type}catch(e){}return!1}async function xn(e,t=Ns.INTERNAL){if(Hs)return;Hs=!0,yn(t);const a=!!window.matchMedia?.("(prefers-reduced-motion: reduce)")?.matches;if(gn())window.location.href=e;else{document.body.classList.add("page-transitioning");try{const{animateDeparture:e}=await Promise.resolve().then(()=>sd);await e({duration:a?150:300})}catch(n){await new Promise(e=>setTimeout(e,a?150:300))}window.location.href=e}}function Mn(){Hs=!1,document.body.classList.remove("page-transitioning")}function Sn(e){if(document.querySelector(`link[rel="prefetch"][href="${e}"]`))return;const t=document.createElement("link");t.rel="prefetch",t.href=e,document.head.appendChild(t)}function kn(e,t){e&&e.addEventListener("mouseenter",()=>Sn(t),{once:!0})}function Cn(){const e=document.getElementById("cv-modal-trigger"),t=document.getElementById("brand-logo"),a=document.getElementById("cv-modal"),n=document.getElementById("portfolio-modal"),o=document.getElementById("contact-modal"),i=Array.from(document.querySelectorAll(".cv-digit")),r=document.getElementById("cv-modal-label");if(!e||!a||0===i.length)return void console.warn("CV Gate: Missing required elements");if("true"===a.dataset.modalInitialized)return;a.dataset.modalInitialized="true";const l=fn("gates.common.backText","BACK"),s=fn("gates.common.backAriaLabel","Back"),d=fn("gates.cv.title","Bio/CV"),c=fn("gates.cv.description","Because spam bots don't deserve nice things. This keeps my inbox a little more civilised. Need access? Get in touch for the code.");r&&(r.innerHTML=`\n            <div class="modal-nav">\n                <button type="button" class="gate-back abs-icon-btn" data-modal-back aria-label="${s}">\n                    <i class="ti ti-arrow-left" aria-hidden="true"></i>\n                    <span>${l}</span>\n                </button>\n            </div>\n            <h2 class="modal-title">${d}</h2>\n            <p class="modal-description">${c}</p>\n        `);let u=!1;const p=()=>a&&a.classList.contains("active")||n&&n.classList.contains("active")||o&&o.classList.contains("active"),m=e=>{e?.preventDefault?.();const r=p();n&&n.classList.contains("active")&&(n.classList.remove("active"),n.setAttribute("aria-hidden","true"),setTimeout(()=>{n.classList.add("hidden"),ot(n)},400)),o&&o.classList.contains("active")&&(o.classList.remove("active"),o.setAttribute("aria-hidden","true"),setTimeout(()=>{o.classList.add("hidden"),ot(o)},400)),u=!0,r||ct(),t&&t.classList.add("fade-out-up");const l=document.querySelector(".cv-scroll-container");l&&l.classList.add("fade-out-up"),requestAnimationFrame(()=>{nt(a),a.classList.remove("hidden"),a.setAttribute("aria-hidden","false"),a.classList.add("active"),i[0].focus()})},h=(e=!1)=>{if(u=!1,i.forEach(e=>e.value=""),e){a.style.transition="none",t&&(t.style.transition="none"),a.classList.remove("active"),a.setAttribute("aria-hidden","true"),a.classList.add("hidden"),ot(a),t&&t.classList.remove("fade-out-up");const e=document.querySelector(".cv-scroll-container");e&&e.classList.remove("fade-out-up"),p()||ut(),requestAnimationFrame(()=>{a.style.removeProperty("transition"),t&&t.style.removeProperty("transition")})}else{a.classList.remove("active"),a.setAttribute("aria-hidden","true"),t&&t.classList.remove("fade-out-up");const e=document.querySelector(".cv-scroll-container");e&&e.classList.remove("fade-out-up"),p()||ut(),setTimeout(()=>{u||(a.classList.add("hidden"),ot(a))},1700)}};try{const e=r?.querySelector?.("[data-modal-back]");e&&e.addEventListener("click",()=>h(!1))}catch(g){}a.addEventListener("click",e=>{(e.target===a||e.target.classList.contains("modal-label")||e.target.classList.contains("modal-description")||"H2"===e.target.tagName||"P"===e.target.tagName)&&h(!1)});const f=()=>{const e=i.map(e=>e.value).join("");if(4===e.length)if("1111"===e){const e=document.querySelector(".cv-modal-inputs");e&&(e.classList.remove("pulse-energy"),e.classList.add("pulse-energy")),setTimeout(()=>{"function"==typeof a.animate?a.animate([{transform:"scale(1)",opacity:1,filter:"blur(0)"},{transform:"scale(1.03)",opacity:0,filter:"blur(4px)"}],{duration:250,easing:"cubic-bezier(0.16, 1, 0.3, 1)",fill:"forwards"}):(a.style.transition="transform 250ms ease-out, opacity 250ms ease-out, filter 250ms ease-out",a.style.transform="scale(1.03)",a.style.opacity="0",a.style.filter="blur(4px)")},200),setTimeout(()=>{xn("cv.html",Ns.INTERNAL)},450)}else setTimeout(()=>{i.forEach(e=>e.value=""),i[0].focus()},150)};e.addEventListener("click",m);try{sessionStorage.getItem("abs_open_cv_modal")&&(sessionStorage.removeItem("abs_open_cv_modal"),setTimeout(()=>m(),300))}catch(g){}document.addEventListener("keydown",e=>{"Escape"===e.key&&u&&h()}),document.addEventListener("modal-overlay-dismiss",e=>{u&&h(e.detail?.instant||!1)}),i.forEach((e,t)=>{e.addEventListener("keydown",a=>{"Backspace"===a.key&&""===e.value&&(t>0?i[t-1].focus():h())}),e.addEventListener("input",e=>{const a=e.target.value;if(/^\d*$/.test(a)){if(1===a.length)i.length-1>t?i[t+1].focus():f();else if(a.length>1){const n=a.split("");e.target.value=n[0];let o=t+1;for(let e=1;n.length>e&&i.length>o;e++)i[o].value=n[e],o++;i.length>o?i[o].focus():f()}}else e.target.value=a.replace(/\D/g,"")}),e.addEventListener("focus",()=>{e.select()})})}function Fn(){const e=document.getElementById("portfolio-modal-trigger"),t=document.getElementById("portfolio-modal"),a=document.getElementById("brand-logo"),n=document.getElementById("cv-modal"),o=document.getElementById("contact-modal"),i=Array.from(document.querySelectorAll(".portfolio-digit")),r=document.getElementById("portfolio-modal-label");if(!e||!t||0===i.length)return void console.warn("Portfolio Gate: Missing required elements");if("true"===t.dataset.modalInitialized)return;t.dataset.modalInitialized="true";const l=fn("gates.common.backText","BACK"),s=fn("gates.common.backAriaLabel","Back"),d=fn("gates.portfolio.title","View Portfolio"),c=fn("gates.portfolio.description","Good work deserves good context. Many of my projects across finance, automotive, and digital innovation startups are NDA-protected, so access is code-gated.");r&&(r.innerHTML=`\n            <div class="modal-nav">\n                <button type="button" class="gate-back abs-icon-btn" data-modal-back aria-label="${s}">\n                    <i class="ti ti-arrow-left" aria-hidden="true"></i>\n                    <span>${l}</span>\n                </button>\n            </div>\n            <h2 class="modal-title">${d}</h2>\n            <p class="modal-description">${c}</p>\n        `);let u=!1;const p=()=>t&&t.classList.contains("active")||n&&n.classList.contains("active")||o&&o.classList.contains("active"),m=e=>{e&&e.preventDefault();const r=p(),l=(()=>{try{const e=window.PORTFOLIO_BASE||"";return e&&!e.endsWith("/")?e+"/":e}catch(e){return""}})(),s=aa()?"modules/portfolio/app.js":"js/portfolio-bundle.js",d=document.createElement("link");d.rel="prefetch",d.href=`${l}${s}`,document.head.appendChild(d);const c=document.createElement("link");c.rel="prefetch",c.href=l+"images/portfolio/pages/chapter-1-1.webp",document.head.appendChild(c),n&&n.classList.contains("active")&&(n.classList.remove("active"),n.setAttribute("aria-hidden","true"),setTimeout(()=>{n.classList.add("hidden"),ot(n)},400)),o&&o.classList.contains("active")&&(o.classList.remove("active"),o.setAttribute("aria-hidden","true"),setTimeout(()=>{o.classList.add("hidden"),ot(o)},400)),u=!0,r||ct(),a&&a.classList.add("fade-out-up");const m=document.querySelector(".cv-scroll-container");m&&m.classList.add("fade-out-up"),requestAnimationFrame(()=>{nt(t),t.classList.remove("hidden"),t.setAttribute("aria-hidden","false"),t.classList.add("active"),i[0].focus()})},h=(e=!1)=>{if(u=!1,i.forEach(e=>e.value=""),e){t.style.transition="none",a&&(a.style.transition="none"),t.classList.remove("active"),t.setAttribute("aria-hidden","true"),t.classList.add("hidden"),ot(t),a&&a.classList.remove("fade-out-up");const e=document.querySelector(".cv-scroll-container");e&&e.classList.remove("fade-out-up"),p()||ut(),requestAnimationFrame(()=>{t.style.removeProperty("transition"),a&&a.style.removeProperty("transition")})}else{t.classList.remove("active"),t.setAttribute("aria-hidden","true"),a&&a.classList.remove("fade-out-up");const e=document.querySelector(".cv-scroll-container");e&&e.classList.remove("fade-out-up"),p()||ut(),setTimeout(()=>{u||(t.classList.add("hidden"),ot(t))},1700)}};try{const e=r?.querySelector?.("[data-modal-back]");e&&e.addEventListener("click",()=>h(!1))}catch(g){}t.addEventListener("click",e=>{(e.target===t||e.target.classList.contains("modal-label")||e.target.classList.contains("modal-description")||"H2"===e.target.tagName||"P"===e.target.tagName)&&h(!1)});const f=()=>{const e=i.map(e=>e.value).join("");if(4===e.length)if("1234"===e){const e=document.querySelector(".portfolio-modal-inputs");e&&(e.classList.remove("pulse-energy"),e.classList.add("pulse-energy")),sessionStorage.setItem("abs_portfolio_ok",Date.now()),setTimeout(()=>{"function"==typeof t.animate?t.animate([{transform:"scale(1)",opacity:1,filter:"blur(0)"},{transform:"scale(1.03)",opacity:0,filter:"blur(4px)"}],{duration:250,easing:"cubic-bezier(0.16, 1, 0.3, 1)",fill:"forwards"}):(t.style.transition="transform 250ms ease-out, opacity 250ms ease-out, filter 250ms ease-out",t.style.transform="scale(1.03)",t.style.opacity="0",t.style.filter="blur(4px)")},200),setTimeout(()=>{xn("portfolio.html",Ns.INTERNAL)},450)}else setTimeout(()=>{i.forEach(e=>e.value=""),i[0].focus()},150)};sessionStorage.getItem("abs_open_portfolio_modal")&&(sessionStorage.removeItem("abs_open_portfolio_modal"),setTimeout(()=>m(),300)),e.addEventListener("click",m),document.addEventListener("keydown",e=>{"Escape"===e.key&&u&&h()}),document.addEventListener("modal-overlay-dismiss",e=>{u&&h(e.detail?.instant||!1)}),i.forEach((e,t)=>{e.addEventListener("keydown",a=>{"Backspace"===a.key&&""===e.value&&(t>0?i[t-1].focus():h())}),e.addEventListener("input",e=>{const a=e.target.value;if(/^\d*$/.test(a)){if(1===a.length)i.length-1>t?i[t+1].focus():f();else if(a.length>1){const n=a.split("");e.target.value=n[0];let o=t+1;for(let e=1;n.length>e&&i.length>o;e++)i[o].value=n[e],o++;i.length>o?i[o].focus():f()}}else e.target.value=a.replace(/\D/g,"")}),e.addEventListener("focus",()=>{e.select()})})}function Ln(){const e=fn("contact.email","alexander@beck.fyi"),t=fn("gates.common.backText","BACK"),a=fn("gates.common.backAriaLabel","Back"),n=fn("gates.contact.title","Contact"),o=fn("gates.contact.description","For collaborations, product design work, AI prototyping, or anything that needs a crisp creative + technical brain. For job opportunities, drop me a note."),i=fn("contact.copy.buttonAriaLabel","Copy email address"),r=fn("contact.copy.statusCopied","Copied"),l=fn("contact.copy.statusError","Copy failed"),s=[document.getElementById("contact-email"),document.getElementById("contact-email-inline"),document.querySelector(".decorative-script")].filter(Boolean),d=document.getElementById("brand-logo"),c=document.getElementById("contact-modal"),u=document.getElementById("contact-modal-label"),p=document.getElementById("contact-modal-inputs"),m=document.getElementById("cv-modal"),h=document.getElementById("portfolio-modal");if(!(s.length&&c&&u&&p))return void console.warn("Contact Gate: Missing required elements");if("true"===c.dataset.modalInitialized)return;c.dataset.modalInitialized="true",u.innerHTML=`\n    <div class="modal-nav">\n      <button type="button" class="gate-back abs-icon-btn" data-modal-back aria-label="${a}">\n        <i class="ti ti-arrow-left" aria-hidden="true"></i>\n        <span>${t}</span>\n      </button>\n    </div>\n    <h2 class="modal-title">${n}</h2>\n    <p class="modal-description">\n      ${o}\n    </p>\n  `,p.innerHTML=`\n    <button type="button" class="contact-email-row" data-copy-email aria-label="${i}">\n      <span class="contact-email-text">${e}</span>\n      <span class="contact-email-copy" data-copy-icon-container>\n        <i class="ti ti-copy" aria-hidden="true"></i>\n      </span>\n    </button>\n    <div class="contact-copy-status" data-copy-status aria-live="polite"></div>\n  `;const f=u.querySelector("[data-modal-back]"),g=p.querySelector("[data-copy-email]");p.querySelector("[data-copy-icon-container]");const b=p.querySelector("[data-copy-status]"),y=p.querySelector(".contact-email-copy i");let v=!1,w=null;const x=()=>c&&c.classList.contains("active")||m&&m.classList.contains("active")||h&&h.classList.contains("active"),M=e=>{if(g&&b){if(w&&window.clearTimeout(w),"copied"===e)return g.classList.add("is-copied"),g.classList.remove("is-error"),b.textContent=r,y&&(y.className="ti ti-check",y.parentElement.classList.add("is-active")),void(w=window.setTimeout(()=>M("idle"),3e3));if("error"===e)return g.classList.add("is-error"),g.classList.remove("is-copied"),b.textContent=l,y&&(y.className="ti ti-alert-triangle",y.parentElement.classList.add("is-active")),void(w=window.setTimeout(()=>M("idle"),3e3));g.classList.remove("is-copied","is-error"),b.textContent="",y&&(y.className="ti ti-copy",y.parentElement.classList.remove("is-active"))}},S=e=>{e?.preventDefault?.();const t=x();m&&m.classList.contains("active")&&(m.classList.remove("active"),m.setAttribute("aria-hidden","true"),setTimeout(()=>{m.classList.add("hidden"),ot(m)},qs)),h&&h.classList.contains("active")&&(h.classList.remove("active"),h.setAttribute("aria-hidden","true"),setTimeout(()=>{h.classList.add("hidden"),ot(h)},qs)),v=!0,t||ct(),M("idle"),d&&d.classList.add("fade-out-up");const a=document.querySelector(".cv-scroll-container");a&&a.classList.add("fade-out-up"),requestAnimationFrame(()=>{nt(c),c.classList.remove("hidden"),c.setAttribute("aria-hidden","false"),c.classList.add("active"),g?.focus?.()})},k=(e=!1)=>{if(v=!1,M("idle"),e){c.style.transition="none",d&&(d.style.transition="none"),c.classList.remove("active"),c.setAttribute("aria-hidden","true"),c.classList.add("hidden"),ot(c),d&&d.classList.remove("fade-out-up");const e=document.querySelector(".cv-scroll-container");e&&e.classList.remove("fade-out-up"),x()||ut(),requestAnimationFrame(()=>{c.style.removeProperty("transition"),d&&d.style.removeProperty("transition")})}else{c.classList.remove("active"),c.setAttribute("aria-hidden","true"),d&&d.classList.remove("fade-out-up");const e=document.querySelector(".cv-scroll-container");e&&e.classList.remove("fade-out-up"),x()||ut(),setTimeout(()=>{v||(c.classList.add("hidden"),ot(c))},qs)}};s.forEach(e=>e.addEventListener("click",S,{capture:!0})),f?.addEventListener("click",()=>k(!1)),c.addEventListener("click",e=>{(e.target===c||e.target.classList.contains("modal-label")||e.target.classList.contains("modal-description")||"H2"===e.target.tagName||"P"===e.target.tagName)&&k(!1)}),g?.addEventListener("click",async()=>{const t=await(async e=>{try{if(navigator?.clipboard?.writeText)return await navigator.clipboard.writeText(e),!0}catch(t){}try{const t=document.createElement("textarea");t.value=e,t.setAttribute("readonly","true"),t.style.position="fixed",t.style.left="-9999px",t.style.top="0",document.body.appendChild(t),t.select();const a=!0===document.execCommand?.("copy");return document.body.removeChild(t),a}catch(t){return!1}})(e);t&&(g.classList.remove("pulse-energy"),g.classList.add("pulse-energy"),setTimeout(()=>{g.classList.remove("pulse-energy")},800)),M(t?"copied":"error")}),document.addEventListener("keydown",e=>{"Escape"===e.key&&v&&k()}),document.addEventListener("modal-overlay-dismiss",e=>{v&&k(e.detail?.instant||!1)});try{sessionStorage.getItem("abs_open_contact_modal")&&(sessionStorage.removeItem("abs_open_contact_modal"),requestAnimationFrame(()=>S()))}catch(C){}}function On(){if(le(),"undefined"!=typeof window&&window.matchMedia&&window.matchMedia("(prefers-reduced-motion: reduce)").matches)return console.log(" Sound toggle hidden (prefers-reduced-motion)"),null;Ys=document.createElement("button"),Ys.className="sound-toggle abs-icon-btn",Ys.id="sound-toggle",Ys.type="button",Ys.setAttribute("aria-label","Toggle collision sounds"),Ys.setAttribute("aria-pressed","false"),Ys.setAttribute("data-enabled","false"),Ys.innerHTML=Zs,Ys.addEventListener("click",Dn);const e=document.getElementById("app-frame"),t=document.getElementById("sound-toggle-slot"),a=document.getElementById("top-elements-soundRow"),n=document.getElementById("social-links"),o=document.querySelector(".ui-meta-right"),i=!!t,r=n&&(!e||e.contains(n)),l="undefined"!=typeof window&&"function"==typeof window.matchMedia&&window.matchMedia("(max-width: 600px)").matches,s=e=>{if(!e)return!1;try{Ys.parentElement&&Ys.parentElement!==e&&Ys.parentElement.removeChild(Ys)}catch(t){}if(e.classList.contains("ui-meta-right")){const t=e.querySelector("time");if(t)return e.insertBefore(Ys,t),!0}return e.appendChild(Ys),!0};if(l&&a)Ys.classList.add("sound-toggle--top"),Ys.classList.add("sound-toggle--topwide"),s(a);else if(i)Ys.classList.add("sound-toggle--top"),s(t);else if(o)s(o);else if(r){const e=document.createElement("li");e.className="margin-bottom_none sound-toggle-item",Ys.classList.add("sound-toggle--social"),e.appendChild(Ys),n.appendChild(e)}else e?e.appendChild(Ys):document.body.appendChild(Ys);try{if("undefined"!=typeof window&&"function"==typeof window.matchMedia){const e=window.matchMedia("(max-width: 600px)"),t=()=>{const t=document.getElementById("top-elements-soundRow"),a=document.getElementById("sound-toggle-slot"),n=e.matches&&!!t;Ys.classList.toggle("sound-toggle--topwide",n),n?s(t):a&&s(a)};"function"==typeof e.addEventListener?e.addEventListener("change",t):"function"==typeof e.addListener&&e.addListener(t)}}catch(d){}console.log(" Sound toggle created");try{const e=Ce();In(!(!e.isUnlocked||!e.isEnabled))}catch(d){}return"undefined"!=typeof window&&window.addEventListener&&window.addEventListener(qo,e=>{const t=e&&e.detail?e.detail:null;t&&In(!(!t.isUnlocked||!t.isEnabled))}),Ys}async function Dn(){Ce().isUnlocked?In(ke()):await de()?In(!0):(Ys&&(Ys.innerHTML=Zs,Ys.setAttribute("aria-label","Audio unavailable")),setTimeout(()=>{In(!1)},2e3))}function In(e){Ys&&(Ys.setAttribute("data-enabled",e?"true":"false"),Ys.setAttribute("aria-pressed",e?"true":"false"),Ys.setAttribute("aria-label",e?"Sound on":"Sound off"),Ys.innerHTML=e?'<i class="ti ti-volume-2" aria-hidden="true"></i>':Zs)}function Pn(){const e=document.getElementById("social-links");if(!e)return;if(e.querySelector("i.ti"))return;const t=Array.from(e.querySelectorAll(".footer_icon-link[aria-label]"));for(const a of t){const e=(a.getAttribute("aria-label")||"").trim().toLowerCase(),t=Us.get(e);if(!t)continue;const n=a.querySelector("svg");n?(a.insertAdjacentHTML("afterbegin",t),n.remove()):a.insertAdjacentHTML("afterbegin",t)}}function Wn(){function e(){t.textContent=n.format(new Date).toUpperCase()}const t=document.getElementById("time-display"),a=document.getElementById("site-year");if(!t)return;const n=new Intl.DateTimeFormat("en-GB",{timeZone:"Europe/London",hour:"numeric",minute:"2-digit",second:"2-digit",hour12:!0});e(),setInterval(e,1e3),a&&a.addEventListener("click",sn)}function Kn(e){if(!e||!e.closest)return null;const t=e.closest('a, button, [role="button"]');if(!t)return null;try{if(t.classList?.contains?.("slide"))return null;if(t.closest?.(".slide"))return null}catch(a){}return t}function Tn(e){const t=Kn(e.target);var a;if(t&&!((a=t)&&a.closest&&(a.closest("#panelDock")||a.closest("#masterPanel")||a.closest("#dockToggle")||a.closest(".panel-dock")||a.closest(".panel"))))try{document.body.classList.add(Qs),document.body.dispatchEvent(new CustomEvent("abs-link-hover",{detail:{element:t}})),ve()}catch(e){}}function En(e){const t=Kn(e.target);if(!t)return;const a=e.relatedTarget;if(!a||!t.contains(a))try{document.body.classList.remove(Qs)}catch(e){}}function Bn(){if(!Xs){Xs=!0;try{document.body.classList.remove(Qs)}catch(e){}document.addEventListener("pointerover",Tn,!0),document.addEventListener("pointerout",En,!0),window.PointerEvent||(document.addEventListener("mouseover",Tn,!0),document.addEventListener("mouseout",En,!0)),window.addEventListener("blur",()=>{try{document.body.classList.remove(Qs)}catch(e){}},{passive:!0}),window.addEventListener("mouseout",t=>{if(!t.relatedTarget&&!t.toElement)try{document.body.classList.remove(Qs)}catch(e){}},{passive:!0})}}async function An(e){const t=document.getElementById("bravia-balls");t?(ed||(ed=document.createElement("div"),ed.id="tactile-layer",ed.style.position="absolute",ed.style.inset="var(--wall-thickness, 9px)",ed.style.borderRadius="var(--wall-radius, 24px)",ed.style.overflow="hidden",ed.style.zIndex="20",ed.style.pointerEvents="none",t.appendChild(ed)),(e=>{if(!ed)return;const t=e.tactileEnabled??!1,a=e.tactileProjectId||"qBFxB3kkFBqgLxFNFleF";var n;ed.style.display=t?"block":"none",t?(Js&&nd!==a&&(Js.destroy(),Js=null,nd=null),ed.style.opacity=e.tactileOpacity??1,ed.style.mixBlendMode=e.tactileBlendMode||"overlay",ed.style.pointerEvents=e.tactilePointerEvents?"auto":"none",td||ad?!td||Js||ad||Gn(e):(ad=!0,(n="https://cdn.jsdelivr.net/gh/hiunicornstudio/unicornstudio.js@v2.0.4/dist/unicornStudio.umd.js",new Promise((e,t)=>{if(document.querySelector(`script[src="${n}"]`))return void e();const a=document.createElement("script");a.src=n,a.onload=e,a.onerror=t,document.head.appendChild(a)})).then(()=>{td=!0,ad=!1,Gn(e)}).catch(e=>{console.error("Failed to load Unicorn Studio SDK:",e),ad=!1}))):Js&&(Js.destroy(),Js=null,nd=null)})(e)):console.warn("Tactile Layer: #bravia-balls container not found.")}function Gn(e){if(!window.UnicornStudio||Js)return;const t=e.tactileProjectId||"qBFxB3kkFBqgLxFNFleF";UnicornStudio.addScene({elementId:ed.id,projectId:t,scale:e.tactileScale||1,dpi:e.tactileDpi||1,fps:60,lazyLoad:!0}).then(e=>{Js=e,nd=t,console.log(" Unicorn Studio Scene Initialized")}).catch(e=>{console.error("Failed to init Unicorn Studio scene:",e)})}function Rn(e,t,a){if(e&&null!=a)try{e.setAttribute(t,a+"")}catch(n){}}function zn(){try{(()=>{const e=fn("meta.title","");e&&(document.title=e);const t=fn("meta.description","");if(t){const e=document.querySelector('meta[name="description"]');e&&e.setAttribute("content",t)}})(),((e,t)=>{e&&(e.textContent=(t??"")+"")})(document.getElementById("edge-caption-tagline"),fn("edge.tagline",fn("edge.copyright",""))),(()=>{const e=document.getElementById("expertise-legend");Rn(e,"aria-label",fn("legend.ariaLabel",""));const t=fn("legend.items",null);if(!Array.isArray(t)||!e)return;const a=e.querySelectorAll(".legend__item");for(let n=0;a.length>n&&t.length>n;n++){const e=a[n],o=t?.[n]?.label,i=t?.[n]?.tooltip,r=t?.[n]?.colorClass,l=e.querySelector("span");if(o&&l&&(l.textContent=o),i&&e.setAttribute("data-tooltip",i),r){const t=e.querySelector(".circle");if(t){const e=[];for(const a of((t.className||"")+"").split(/\s+/).filter(Boolean))a.startsWith("bg-ball-")||e.push(a);e.push(r),t.className=e.join(" ")}}}})(),(()=>{const e=document.querySelector(".decorative-script p");if(!e)return;const t=fn("philosophy.textBeforeLink",""),a=fn("philosophy.link.id","contact-email-inline")||"contact-email-inline",n=fn("philosophy.link.href","#")||"#",o=fn("philosophy.link.text","")||"";let i=document.getElementById(a);if(i||(i=e.querySelector("a")),!i)return;i.id=a,i.setAttribute("href",n),i.textContent=o;const r=i.previousSibling;r&&r.nodeType===Node.TEXT_NODE?r.nodeValue=t:e.insertBefore(document.createTextNode(t),i);const l=i.nextSibling;l&&l.nodeType===Node.TEXT_NODE&&(l.nodeValue="")})(),(()=>{Rn(document.getElementById("main-links"),"aria-label",fn("footer.navAriaLabel",""));const e=fn("footer.links",null);if(e&&"object"==typeof e)for(const t of["contact","portfolio","cv"]){const a=e?.[t];if(!a)continue;const n=document.getElementById(a.id||"");n&&(a.href&&n.setAttribute("href",a.href),a.text&&(n.textContent=a.text))}})(),(()=>{const e=document.getElementById("social-links");Rn(e,"aria-label",fn("socials.ariaLabel",""));const t=fn("socials.items",null);if(!e||!t||"object"!=typeof t)return;const a=["appleMusic","x","linkedin"],n=e.querySelectorAll(".footer_icon-link");for(let o=0;n.length>o&&3>o;o++){const e=n[o],i=t?.[a[o]];if(!i)continue;i.url&&("A"===e.tagName?e.setAttribute("href",i.url):e.onclick=()=>window.open(i.url,"_blank","noopener,noreferrer")),i.ariaLabel&&e.setAttribute("aria-label",i.ariaLabel);const r=e.querySelector(".screen-reader");r&&i.screenReaderText&&(r.textContent=i.screenReaderText)}})(),(()=>{const e=document.getElementById("header-cv-link");if(!e)return;const t=fn("footer.links.cv",null);t&&"object"==typeof t&&(t.href&&e.setAttribute("href",t.href),t.text&&(e.textContent=t.text))})(),(()=>{const e=document.querySelector("[data-portfolio-ui] .decorative-script p");if(!e)return;const t=fn("portfolio.blurb","");t&&(e.textContent=t)})()}catch(e){}}async function $n(){try{try{if("undefined"!=typeof window&&window.__RUNTIME_CONFIG__&&"object"==typeof window.__RUNTIME_CONFIG__)return window.__RUNTIME_CONFIG__}catch(e){}const t=["config/default-config.json","../config/default-config.json","js/config.json","../js/config.json","../dist/js/config.json"];for(const a of t)try{const e=await fetch(a,{cache:"no-cache"});if(e.ok)return await e.json()}catch(e){}throw Error("No config found")}catch(e){return console.warn("Config load failed, using defaults"),{gravityMultiplier:1.05,ballMass:91,maxBalls:300}}}async function _n({timeoutMs:e=4e3,fontFaces:t=od}={}){const a=document.documentElement;if(a&&a.classList.add("fonts-loading"),!document.fonts||!document.fonts.ready)return a&&a.classList.remove("fonts-loading"),!1;let n;const o=new Promise(t=>{n=window.setTimeout(()=>t(!1),e)}),i=Promise.all(t.map(e=>document.fonts.load(e).catch(()=>null))).then(()=>document.fonts.ready).then(()=>!0).catch(()=>!1),r=await Promise.race([i,o]);return n&&window.clearTimeout(n),a&&a.classList.remove("fonts-loading"),r}function Nn(e){e&&(f(e),(e=>{const t=document.documentElement;void 0!==e.topLogoWidthVw&&t.style.setProperty("--top-logo-width-vw",e.topLogoWidthVw+""),e.bgLight&&(t.style.setProperty("--bg-light",e.bgLight),t.style.setProperty("--chrome-bg-light",e.bgLight)),e.bgDark&&(t.style.setProperty("--bg-dark",e.bgDark),t.style.setProperty("--chrome-bg-dark",e.bgDark));const a=e.frameColorLight||e.frameColor,n=e.frameColorDark||e.frameColor;a&&t.style.setProperty("--frame-color-light",a),n&&t.style.setProperty("--frame-color-dark",n)})(e),Vn())}function Vn(){try{M()}catch(e){}try{m()}catch(e){}try{h()}catch(e){}}function Hn(e={}){const{contactModal:t=!1,cvModal:a=!1,portfolioModal:n=!1,cursorHiding:o=!0,modalOverlayConfig:i={}}=e;if(t||a||n)try{lt(i)}catch(r){console.warn("Failed to initialize modal overlay:",r)}if(t)try{Ln()}catch(r){console.warn("Failed to initialize contact modal:",r)}if(a)try{Cn()}catch(r){console.warn("Failed to initialize CV modal:",r)}if(n)try{Fn()}catch(r){console.warn("Failed to initialize portfolio modal:",r)}if(o)try{Bn()}catch(r){console.warn("Failed to initialize cursor hiding:",r)}}function jn(e,t,a){return t>e?t:e>a?a:e}function qn(e,t,a){return e+(t-e)*a}function Zn(e,t){switch(t){case co.PIT:return e.sizeVariationPit??0;case co.FLIES:return e.sizeVariationFlies??0;case co.WEIGHTLESS:return e.sizeVariationWeightless??0;case co.WATER:return e.sizeVariationWater??0;case co.MAGNETIC:return e.sizeVariationMagnetic??0;case co.BUBBLES:return e.sizeVariationBubbles??0;case co.KALEIDOSCOPE:return e.sizeVariationKaleidoscope??0;case co.CRITTERS:return e.sizeVariationCritters??0;case co.PARALLAX_LINEAR:return e.sizeVariationParallaxLinear??0;case co.PARALLAX_FLOAT:return e.sizeVariationParallaxFloat??0;default:return 0}}function Yn(e,t){const a=jn(+(e.sizeVariationCap??.12),0,id),n=jn(+(e.sizeVariationGlobalMul??1),0,2),o=jn(+(Zn(e,t)??0),0,1);return jn(a*n*o,0,id)}function Un(e,t){const a=Number.isFinite(e?.R_MIN)?Math.max(1,e.R_MIN):0,n=Number.isFinite(e?.R_MAX)?Math.max(a||1,e.R_MAX):0;if(a>0&&n>0)return jn(t,a,n);const o=Math.max(1,e?.R_MED||t||1);return jn(t,.8*o,1.2*o)}function Xn(e,t){const a=e?.canvas,n=a?.height||0;if(!n)return Qn(e,t);const o=jn(+(e.kaleidoscope3DotSizeVh??e.kaleidoscopeDotSizeVh??1.05),.1,6),i=jn(+(e.kaleidoscope3DotAreaMul??e.kaleidoscopeDotAreaMul??.75),.1,2),r=Math.max(1,.01*o*n*Math.sqrt(i)),l=jn(.5*+(e.kaleidoscope3SizeVariance??e.kaleidoscopeSizeVariance??.5),0,id),s=Math.max(1,r*(1-l)),d=Math.max(1,r*(1+l));return Un(e,1e-6>d-s?r:qn(s,d,Math.random()))}function Qn(e,t){const{minR:a,maxR:n,medR:o}=((e,t)=>{const a=Math.max(1,e.R_MED||.5*(e.R_MIN+e.R_MAX)||10),n=jn(+(e.sizeVariationCap??.12),0,id),o=jn(+(e.sizeVariationGlobalMul??1),0,2),i=jn(+(Zn(e,t)??0),0,1),r=jn(n*o*i,0,id);return{minR:Math.max(1,a*(1-r)),maxR:Math.max(1,a*(1+r)),medR:a}})(e,t);return 1e-6>n-a?o:qn(a,n,Math.random())}function Jn(){const e=window.innerWidth/window.innerHeight;return e>1.1?"landscape":.9>e?"portrait":"square"}function eo(){const e=Jn();let t;document.documentElement.classList.remove("aspect-landscape","aspect-square","aspect-portrait"),document.documentElement.classList.add("aspect-"+e),window.addEventListener("resize",()=>{clearTimeout(t),t=setTimeout(()=>{const t=Jn();t!==e&&(document.documentElement.classList.remove("aspect-landscape","aspect-square","aspect-portrait"),document.documentElement.classList.add("aspect-"+t))},150)})}function to(){const e=(()=>{const e=b();switch(Jn()){case"landscape":return e.entrancePerspectiveLandscape||1200;case"portrait":return e.entrancePerspectivePortrait||800;default:return e.entrancePerspectiveSquare||1e3}})();document.documentElement.style.setProperty("--entrance-perspective",e+"px")}function ao(){document.documentElement.classList.add("entrance-pre-transition")}function no(e={}){const t=b(),a=document.documentElement,n=t.entranceWallTransitionDelay||300,o=t.entranceWallTransitionDuration||800,i=e.wallContent||[],r=document.getElementById("bravia-balls");if(!r)return console.warn(" #bravia-balls not found, falling back to simple transition"),void setTimeout(()=>{a.classList.remove("entrance-pre-transition"),a.classList.add("entrance-transitioning"),setTimeout(()=>{a.classList.remove("entrance-transitioning"),a.classList.add("entrance-complete")},o)},n);const l=document.body.classList.contains("portfolio-page")?t.wallRadius&&"number"==typeof t.wallRadius&&t.wallRadius>0?t.wallRadius+"px":"42px":"0px",s=t.entranceWallInitialScale||1.1,d=t.entranceWallEasing||"cubic-bezier(0.16, 1, 0.3, 1)",c=r.style.transition,u=[];for(const p of i){const e="string"==typeof p?document.querySelector(p):p;e&&u.push(e)}setTimeout(()=>{if(a.classList.remove("entrance-pre-transition"),a.classList.add("entrance-transitioning"),r.style.transition="none",r.style.transform=`scale(${s})`,r.style.transformOrigin="center center",r.style.borderRadius="0px",r.style.opacity="1",r.style.visibility="visible",u.forEach(e=>{e.style.transition="none",e.style.opacity="0",e.style.visibility="visible",e.style.willChange="opacity"}),"function"==typeof r.animate){const e=r.animate([{transform:`scale(${s})`},{transform:"scale(1)"}],{duration:o,easing:d,fill:"forwards"}),t=r.animate([{borderRadius:"0px"},{borderRadius:l}],{duration:o,easing:d,fill:"forwards"}),n=.2*o,i=.8*o,p=u.map(e=>e.animate([{opacity:0},{opacity:1}],{duration:i,delay:n,easing:d,fill:"forwards"}));let m=!1,h=!1,f=0===u.length;const g=()=>{m&&h&&f&&(r.style.transform="scale(1)",r.style.borderRadius=l,r.style.opacity="1",u.forEach(e=>{e.style.opacity="1",e.style.willChange="auto"}),setTimeout(()=>{r.style.transition=c||"",a.classList.remove("entrance-transitioning"),a.classList.add("entrance-complete")},50))};if(e.addEventListener("finish",()=>{m=!0,g()}),e.addEventListener("cancel",()=>{m=!0,g()}),t.addEventListener("finish",()=>{h=!0,g()}),t.addEventListener("cancel",()=>{h=!0,g()}),p.length>0){let e=0;p.forEach(t=>{const a=()=>{e++,p.length>e||(f=!0,g())};t.addEventListener("finish",a),t.addEventListener("cancel",a)})}}else{requestAnimationFrame(()=>{r.style.transition=`transform ${o}ms ${d}, border-radius ${o}ms ${d}`,requestAnimationFrame(()=>{r.style.transform="scale(1)",r.style.borderRadius=l})});const e=.8*o;setTimeout(()=>{u.forEach(t=>{t.style.transition=`opacity ${e}ms ${d}`,requestAnimationFrame(()=>{t.style.opacity="1"})})},.2*o),setTimeout(()=>{r.style.transition=c||"",u.forEach(e=>{e.style.opacity="1",e.style.willChange="auto",e.style.removeProperty("transition")}),a.classList.remove("entrance-transitioning"),a.classList.add("entrance-complete")},o+50)}},n)}function oo(e,t={}){return new Promise(a=>{if(!e)return void a();const n=b(),o=2*(t.duration??n.entranceLateElementDuration??600),i=t.easing??"cubic-bezier(0.16, 1, 0.3, 1)",r=t.scaleFrom??n.entranceLateElementScaleFrom??.92,l=t.scaleTo??1;setTimeout(()=>{e.style.transition="none",e.style.visibility="visible",e.style.willChange="opacity, transform",e.style.transform=`scale(${r})`,e.style.transformOrigin="center center",e.style.opacity="0",e.animate([{opacity:0,transform:`scale(${r})`},{opacity:1,transform:`scale(${l})`}],{duration:o,easing:i,fill:"forwards"}).finished.then(()=>{e.style.opacity="1",e.style.transform=`scale(${l})`,e.style.willChange="auto",requestAnimationFrame(()=>{requestAnimationFrame(()=>{e.style.removeProperty("transition"),e.style.removeProperty("transform"),e.style.removeProperty("transformOrigin"),document.documentElement.classList.add("entrance-complete")})})}).catch(()=>{}),a()},t.delay??0)})}function io(){const e=document.documentElement,t=document.getElementById("brand-logo"),a=document.getElementById("main-links");t&&(t.style.removeProperty("opacity"),t.style.visibility="visible"),a&&(a.style.removeProperty("opacity"),a.style.visibility="visible"),e.classList.add("ui-entered");const n=document.getElementById("fade-blocking");n&&n.remove()}function ro(){let e="";for(const[t,a]of Object.entries(ld)){e+='<div class="sound-dock__section">',e+=`<div class="sound-dock__section-title">${a.title}</div>`,e+='<div class="sound-dock__group">';for(const t of a.controls)e+=`\n        <label class="sound-dock__row">\n          <span class="sound-dock__label">${t.label}</span>\n          <input type="range" \n            id="sound_${t.id}" \n            class="sound-dock__slider" \n            min="${t.min}" \n            max="${t.max}" \n            step="${t.step}">\n          <span class="sound-dock__val" id="sound_${t.id}_val">${t.format(t.fromConfig(0))}</span>\n        </label>`;e+="</div></div>"}return e}function lo(e,t,a){for(const n of Object.values(ld))for(const t of n.controls){const n=e.querySelector("#sound_"+t.id),o=e.querySelector(`#sound_${t.id}_val`);if(!n)continue;const i=e=>{const i=(r=e,l=parseFloat(n.min),s=parseFloat(n.max),l>r?l:r>s?s:r);var r,l,s;n.value=i+"";const d=t.toConfig(i);o&&(o.textContent=t.format(i)),a({[t.id]:d})};n.addEventListener("input",()=>{i(parseFloat(n.value))}),n.addEventListener("wheel",e=>{if(e.ctrlKey)return;const t=(parseFloat(n.step)||1)*(e.altKey?.1:e.shiftKey?.2:1),a=0>e.deltaY?1:-1,o=parseFloat(n.value);e.preventDefault(),i(o+a*t)},{passive:!1}),o&&o.addEventListener("wheel",e=>{if(e.ctrlKey)return;const t=(parseFloat(n.step)||1)*(e.altKey?.1:e.shiftKey?.2:1),a=0>e.deltaY?1:-1,o=parseFloat(n.value);e.preventDefault(),i(o+a*t)},{passive:!1})}}function so(e,t){const a=t();for(const n of Object.values(ld))for(const t of n.controls){const n=e.querySelector("#sound_"+t.id),o=e.querySelector(`#sound_${t.id}_val`);if(!n||void 0===a[t.id])continue;const i=t.fromConfig(a[t.id]);n.value=i,o&&(o.textContent=t.format(i))}}const co={PIT:"pit",FLIES:"flies",WEIGHTLESS:"weightless",WATER:"water",MAGNETIC:"magnetic",BUBBLES:"bubbles",KALEIDOSCOPE:"kaleidoscope-3",CRITTERS:"critters",PARALLAX_LINEAR:"parallax-linear",PARALLAX_FLOAT:"parallax-float",SPHERE_3D:"3d-sphere",CUBE_3D:"3d-cube",STARFIELD_3D:"starfield-3d",ELASTIC_CENTER:"elastic-center",PARTICLE_FOUNTAIN:"particle-fountain"},uo=[co.PIT,co.FLIES,co.CUBE_3D,co.WATER,co.SPHERE_3D,co.ELASTIC_CENTER,co.KALEIDOSCOPE,co.BUBBLES,co.MAGNETIC,co.WEIGHTLESS,co.CRITTERS,co.STARFIELD_3D,co.PARALLAX_FLOAT,co.PARTICLE_FOUNTAIN],po={[co.PIT]:"SOURCE MATERIAL",[co.FLIES]:"IDEA SPARK",[co.BUBBLES]:"NOISE SIGNAL",[co.MAGNETIC]:"DESIGN FORCES",[co.WATER]:"USER FLOW",[co.WEIGHTLESS]:"OPEN SPACE",[co.CRITTERS]:"BEHAVIOR MODEL",[co.ELASTIC_CENTER]:"ELASTIC CENTER",[co.SPHERE_3D]:"3D SHELL",[co.CUBE_3D]:"3D FRAME",[co.KALEIDOSCOPE]:"VOCAB BLOOM",[co.STARFIELD_3D]:"DEPTH FIELD",[co.PARALLAX_FLOAT]:"ORGANIC DRIFT",[co.PARTICLE_FOUNTAIN]:"PARTICLE FLOW"},mo={[co.PIT]:{quote:"The details are not the details. They make the design.",author:"Charles Eames"},[co.FLIES]:{quote:"No man ever steps in the same river twice.",author:"Heraclitus"},[co.CUBE_3D]:{quote:"Less, but better.",author:"Dieter Rams"},[co.BUBBLES]:{quote:"In the middle of difficulty lies opportunity.",author:"Albert Einstein"},[co.MAGNETIC]:{quote:"Order is never observed; it is disorder that attracts attention.",author:"Henri Bergson"},[co.WATER]:{quote:"Be like water making its way through cracks.",author:"Bruce Lee"},[co.SPHERE_3D]:{quote:"Nature uses only the longest threads to weave her patterns.",author:"Richard Feynman"},[co.WEIGHTLESS]:{quote:"An empty space is never empty.",author:"John Cage"},[co.CRITTERS]:{quote:"The whole is other than the sum of the parts.",author:"Kurt Koffka"},[co.ELASTIC_CENTER]:{quote:"Having guts always works out for me.",author:"Stefan Sagmeister"},[co.KALEIDOSCOPE]:{quote:"Creativity takes courage.",author:"Henri Matisse"},[co.STARFIELD_3D]:{quote:"The cosmos is within us. We are made of star-stuff.",author:"Carl Sagan"},[co.PARALLAX_FLOAT]:{quote:"Nature does not hurry, yet everything is accomplished.",author:"Lao Tzu"},[co.PARTICLE_FOUNTAIN]:{quote:"You can't use up creativity. The more you use, the more you have.",author:"Maya Angelou"}},ho={DPR:Math.max(1,Math.min(2,window.devicePixelRatio||1)),OFFSCREEN_MOUSE:-1e9,MIN_DISTANCE_EPSILON:1e-6,ACCUMULATOR_RESET_THRESHOLD:3,MAX_PHYSICS_STEPS:4,SPIN_DAMP_PER_S:3,SPIN_GAIN:.25,SPIN_GAIN_TANGENT:.18,ROLL_FRICTION_PER_S:2.5,SQUASH_MAX_BASE:.2,SQUASH_DECAY_PER_S:18,GROUND_COUPLING_PER_S:12,SLEEP_VELOCITY_THRESHOLD:12,SLEEP_ANGULAR_THRESHOLD:.18,TIME_TO_SLEEP:.25,PHYSICS_DT:1/120,PHYSICS_DT_MOBILE:1/60},fo={default:{label:"Default (Full View Grid)",parallaxLinearDotSizeMul:1.8,sizeVariationParallaxLinear:0,parallaxLinearGridX:14,parallaxLinearGridY:10,parallaxLinearGridZ:7,parallaxLinearSpanX:1.35,parallaxLinearSpanY:1.35,parallaxLinearZNear:50,parallaxLinearZFar:900,parallaxLinearFocalLength:420,parallaxLinearParallaxStrength:260},dense:{label:"Dense (More Vertices)",parallaxLinearDotSizeMul:1.6,sizeVariationParallaxLinear:.1,parallaxLinearGridX:18,parallaxLinearGridY:13,parallaxLinearGridZ:9,parallaxLinearSpanX:1.25,parallaxLinearSpanY:1.25,parallaxLinearZNear:45,parallaxLinearZFar:1e3,parallaxLinearFocalLength:420,parallaxLinearParallaxStrength:240},deep:{label:"Deep Field (Stronger Depth)",parallaxLinearDotSizeMul:1.7,sizeVariationParallaxLinear:.08,parallaxLinearGridX:14,parallaxLinearGridY:10,parallaxLinearGridZ:10,parallaxLinearSpanX:2.2,parallaxLinearSpanY:2.2,parallaxLinearZNear:30,parallaxLinearZFar:1500,parallaxLinearFocalLength:520,parallaxLinearParallaxStrength:320},calm:{label:"Calm (Slow Camera)",parallaxLinearDotSizeMul:1.8,sizeVariationParallaxLinear:.05,parallaxLinearGridX:12,parallaxLinearGridY:9,parallaxLinearGridZ:6,parallaxLinearSpanX:2,parallaxLinearSpanY:2,parallaxLinearZNear:60,parallaxLinearZFar:900,parallaxLinearFocalLength:420,parallaxLinearParallaxStrength:160},minimal:{label:"Minimal (Big Dots)",parallaxLinearDotSizeMul:2.4,sizeVariationParallaxLinear:.15,parallaxLinearGridX:10,parallaxLinearGridY:7,parallaxLinearGridZ:4,parallaxLinearSpanX:2.6,parallaxLinearSpanY:2.6,parallaxLinearZNear:70,parallaxLinearZFar:800,parallaxLinearFocalLength:380,parallaxLinearParallaxStrength:220}};let go=Math.max(1,Math.min(2,window.devicePixelRatio||1));const bo={config:{},currentMode:co.PIT,warmupFramesRemaining:0,balls:[],canvas:null,ctx:null,container:null,mouseX:ho.OFFSCREEN_MOUSE,mouseY:ho.OFFSCREEN_MOUSE,mouseInCanvas:!1,lastPointerMoveMs:0,lastPointerMoveX:ho.OFFSCREEN_MOUSE,lastPointerMoveY:ho.OFFSCREEN_MOUSE,GE:1960,G:0,gravityScale:1,gravityMultiplier:0,gravityMultiplierPit:1.1,REST:.31,FRICTION:.011,ballMassKg:240,MASS_BASELINE_KG:240,MASS_REST_EXP:.15,MASS_GRAVITY_EXP:.35,get DPR(){return go},sizeScale:1.2,sizeVariationGlobalMul:1,sizeVariationCap:.12,sizeVariationPit:0,sizeVariationFlies:0,sizeVariationWeightless:0,sizeVariationWater:0,sizeVariationMagnetic:0,sizeVariationBubbles:.2,sizeVariationKaleidoscope:0,sizeVariationCritters:.2,sizeVariationParallaxLinear:0,sizeVariationParallaxFloat:0,pitWarmupFrames:10,fliesWarmupFrames:10,weightlessWarmupFrames:10,waterWarmupFrames:10,magneticWarmupFrames:10,bubblesWarmupFrames:10,kaleidoscope3WarmupFrames:10,crittersWarmupFrames:10,parallaxLinearWarmupFrames:10,parallaxFloatWarmupFrames:10,sphere3dRadiusVw:60,sphere3dDensity:140,sphere3dFocalLength:600,sphere3dDotSizeMul:1.5,sphere3dIdleSpeed:.15,sphere3dCursorInfluence:1.2,sphere3dTumbleSpeed:2.5,sphere3dTumbleDamping:.94,sphere3dWarmupFrames:10,cube3dSizeVw:50,cube3dEdgeDensity:8,cube3dFaceGrid:0,cube3dIdleSpeed:.2,cube3dCursorInfluence:1.5,cube3dTumbleSpeed:3,cube3dTumbleDamping:.95,cube3dFocalLength:500,cube3dDotSizeMul:1.5,cube3dFogStart:.5,cube3dFogMin:.1,cube3dWarmupFrames:10,starfieldCount:200,starfieldSpanX:1.5,starfieldSpanY:1.2,starfieldZNear:100,starfieldZFar:2e3,starfieldFocalLength:500,starfieldParallaxStrength:320,starfieldSpeed:400,starfieldDotSizeMul:1,starfieldIdleJitter:0,starfieldFadeDuration:.5,starfield3dWarmupFrames:10,sizeVariation:0,ballSizeMin:12,ballSizeMax:12,ballSizeBreakpointMin:320,ballSizeBreakpointMax:1920,ballSizeCurve:1.6,isMobile:!1,isMobileViewport:!1,mobileObjectReductionFactor:1,mobileObjectReductionThreshold:200,liteModeEnabled:!1,liteModeObjectReductionFactor:.6,featureRenderSchedulerEnabled:!0,featureLazyModeLoadingEnabled:!0,featureQualityTieringEnabled:!0,featureCrittersNeighborCacheEnabled:!0,performanceModeEnabled:!1,performanceHudEnabled:!0,renderTargetFpsDesktop:60,renderTargetFpsMobile:60,renderTargetFpsReducedMotion:60,renderQualityTier:"auto",modePerformanceBudgets:{[co.PIT]:{desktop:320,mobile:220},[co.FLIES]:{desktop:90,mobile:64},[co.WEIGHTLESS]:{desktop:220,mobile:140},[co.WATER]:{desktop:1800,mobile:900},[co.MAGNETIC]:{desktop:220,mobile:140},[co.BUBBLES]:{desktop:260,mobile:180},[co.KALEIDOSCOPE]:{desktop:180,mobile:120},[co.CRITTERS]:{desktop:140,mobile:95},[co.STARFIELD_3D]:{desktop:220,mobile:150},[co.PARTICLE_FOUNTAIN]:{desktop:260,mobile:180}},R_MED:18,R_MIN:18,R_MAX:18,cursorSize:1,cursorColorMode:"auto",cursorColorIndex:5,cursorColorHex:"#ff4013",cursorColorLumaMax:.62,cursorColorAllowIndices:[],cursorColorDenyIndices:[],mouseTrailEnabled:!0,mouseTrailLength:18,mouseTrailSize:1.3,mouseTrailFadeMs:220,mouseTrailOpacity:.35,ballSoftness:29,ballSpacing:.08,sizeVariationGlobalMul:1,sizeVariationCap:0,sleepVelocityThreshold:12,sleepAngularThreshold:.18,timeToSleep:.25,physicsCollisionIterations:10,physicsSkipSleepingCollisions:!0,physicsSleepThreshold:12,physicsSleepTime:.25,physicsSkipSleepingSteps:!0,physicsSpatialGridOptimization:!0,wallPhysicsSamples:48,wallPhysicsSkipInactive:!0,wallPhysicsUpdateHz:30,wallPhysicsMaxSubstepHz:60,wallPhysicsInterpolation:!0,wallPhysicsAdaptiveSamples:!0,wallPhysicsMinSamples:24,wallVisualDeformMul:1,wallRenderDecimation:2,critterCount:90,critterSpeed:680,critterMaxSpeed:1400,critterStepHz:5,critterStepSharpness:2.4,critterTurnNoise:2.2,critterTurnDamp:10,critterTurnSeek:10,critterAvoidRadius:90,critterAvoidForce:9500,critterEdgeAvoid:1,critterMousePull:1,critterMouseRadiusVw:30,critterRestitution:.18,critterFriction:.018,critterHiveStirInterval:5,critterHiveStirStrength:2.5,critterHiveWaveSpeed:.4,critterNervousnessMin:.4,critterNervousnessMax:1,critterCuriosityBias:.5,hiveJourneyPointCount:4,hiveJourneyPointMargin:.05,hiveGoalAttractionStrength:.25,hiveGoalSwitchMinS:4,hiveGoalSwitchMaxS:14,hiveGoalReachedRadius:50,hivePathAdherence:.5,cornerRadius:42,layoutViewportWidthPx:0,containerBorderVw:0,simulationPaddingVw:0,contentPaddingRatio:.03,contentPaddingHorizontalRatio:1,contentPaddingBottomRatio:1.3,mobileWallThicknessXFactor:1.4,desktopWallThicknessFactor:1,mobileEdgeLabelsVisible:!0,wallRadiusVw:0,wallThicknessVw:0,wallThicknessAreaMultiplier:1,wallThicknessMinPx:6,wallThicknessMaxPx:25,noiseEnabled:!0,noiseSeed:1337,noiseTextureSize:256,noiseDistribution:"gaussian",noiseMonochrome:!1,noiseChroma:.9,noiseMotion:"jitter",noiseMotionAmount:1.2,noiseSpeedMs:1100,noiseSpeedVariance:.3,noiseFlicker:.08,noiseFlickerSpeedMs:180,noiseBlurPx:0,noiseContrast:1.2,noiseBrightness:1.15,noiseSaturation:1,noiseHue:0,noiseSize:85,noiseOpacity:.03,noiseOpacityLight:.03,noiseOpacityDark:.03,noiseBlendMode:"normal",noiseColorLight:"#ffffff",noiseColorDark:"#ffffff",detailNoiseOpacity:1,layoutMinWallRadiusPx:28,wallInset:3,magneticBallCount:180,magneticStrength:65e3,magneticMaxVelocity:2800,magneticRadius:0,magneticExplosionInterval:5,bubblesSpawnRate:16,bubblesRiseSpeed:650,bubblesWobble:65,bubblesMaxCount:200,bubblesVerticalExtent:.7,bubblesDepthSpan:.8,bubblesDeflectRadius:0,currentColors:["#b5b7b6","#bbbdbd","#ffffff","#00695c","#000000","#ff4013","#0d5cb6","#ffa000"],currentTemplate:"industrialTeal",paletteRotateOnReload:!1,colorDistribution:[{label:"Product Systems",colorIndex:0,weight:30},{label:"Interaction Design",colorIndex:4,weight:18},{label:"Creative Technology",colorIndex:3,weight:15},{label:"Applied AI",colorIndex:2,weight:12},{label:"Experience Strategy",colorIndex:5,weight:10},{label:"Art Direction",colorIndex:6,weight:10},{label:"Prototyping",colorIndex:7,weight:5}],fliesBallCount:60,attractionPower:5e3,orbitRadius:180,swarmSpeed:.4,fliesSeparation:15e3,weightlessCount:66,weightlessInitialSpeed:250,weightlessBounce:.7,weightlessRepelRadius:220,weightlessRepelPower:5e4,elasticCenterRingCount:10,elasticCenterMassMultiplier:2,elasticCenterSpacingMultiplier:2.8,elasticCenterElasticStrength:2e3,elasticCenterMouseRepelStrength:12e3,elasticCenterMouseRadius:200,elasticCenterDamping:.94,elasticCenterWarmupFrames:10,particleFountainEmissionRate:29,particleFountainInitialVelocity:4700,particleFountainSpreadAngle:20,particleFountainWaterDrag:.02,particleFountainGravityMultiplier:1.7,particleFountainUpwardForce:300,particleFountainMaxParticles:230,particleFountainLifetime:8,particleFountainWarmupFrames:120,particleFountainMouseRepelStrength:5e4,particleFountainMouseRepelRadiusVw:5,particleFountainMouseRepelRadius:0,weightlessRepelSoft:5.4,kaleidoscopeMirror:1,kaleidoscopeIdleDrift:.012,kaleidoscope3BallCount:150,kaleidoscope3Wedges:10,kaleidoscope3WedgesMobile:6,kaleidoscope3Speed:1.2,kaleidoscope3DotSizeVh:1.05,kaleidoscope3DotAreaMul:.75,kaleidoscope3SpawnAreaMul:1.05,kaleidoscope3SizeVariance:.5,kaleidoscope3WarmupFrames:65,parallaxLinearDotCount:95,parallaxLinearRowPattern:"thirds",parallaxLinearSpacingPattern:"even",parallaxLinearFarPct:.42,parallaxLinearMidPct:.32,parallaxLinearFarSpeed:.15,parallaxLinearMidSpeed:.5,parallaxLinearNearSpeed:1,parallaxLinearFollowStrength:16,parallaxLinearDamping:12,parallaxLinearGridX:14,parallaxLinearGridY:10,parallaxLinearGridZ:7,parallaxLinearSpanX:5,parallaxLinearSpanY:2.6,parallaxLinearZNear:50,parallaxLinearZFar:900,parallaxLinearFocalLength:420,parallaxLinearParallaxStrength:260,parallaxLinearDotSizeMul:1.8,waterBallCount:300,waterDrag:.015,waterRippleSpeed:300,waterRippleStrength:18e3,waterDriftStrength:40,waterInitialVelocity:200,magneticDamping:.998,repelRadius:120,repelPower:274e3,repelSoft:3.4,repellerEnabled:!1,cursorInfluenceRadiusVw:14,cursorInfluenceRadiusPx:140,emitterTimer:0,autoDarkModeEnabled:!0,isDarkMode:!1,chromeHarmonyMode:"auto",autoDarkNightStartHour:18,autoDarkNightEndHour:6,clickCycleEnabled:!0,sceneImpactEnabled:!0,sceneImpactMul:.005,sceneImpactMobileMulFactor:1,sceneImpactLogoCompMul:1.8,sceneImpactOvershoot:.22,sceneImpactAnticipation:0,sceneImpactPressMs:0,sceneImpactReleaseMs:620,sceneChangeSoundEnabled:!0,sceneChangeSoundIntensity:.35,sceneChangeSoundRadius:18,brandLogoImpactMul:.014,brandLogoSquashMul:1,brandLogoOvershoot:.22,brandLogoAnticipation:0,brandLogoTiltDeg:0,brandLogoSkewDeg:0,brandLogoPressMs:75,brandLogoHoldMs:55,brandLogoReleaseMs:220,containerBorder:20,containerBorderX:20,simulationPadding:0,contentPadding:40,contentPaddingX:40,contentPaddingY:40,bgLight:"#f5f5f5",bgDark:"#0a0a0a",frameColor:"#242529",frameColorLight:"#242529",frameColorDark:"#242529",textColorLight:"#161616",textColorLightMuted:"#2f2f2f",textColorDark:"#7a8fa3",textColorDarkMuted:"#9db0c4",edgeLabelInsetAdjustPx:0,edgeCaptionDistanceMinPx:8,edgeCaptionDistanceMaxPx:48,simulationOverlayIntensity:1,depthWashOpacity:.65,depthWashBlendModeLight:"color-dodge",depthWashBlendModeDark:"multiply",depthWashCenterY:.3,depthWashRadiusScale:1,depthWashCenterColorLight:"#ffffff",depthWashEdgeColorLight:"#142b48",depthWashCenterAlphaLight:.3,depthWashEdgeAlphaLight:.4,depthWashCenterColorDark:"#1a1e23",depthWashEdgeColorDark:"#05020f",depthWashCenterAlphaDark:0,depthWashEdgeAlphaDark:.8,linkHoverColor:"#ff4013",topLogoWidthVw:35,homeMainLinksBelowLogoPx:40,footerNavBarTopVh:50,footerNavBarGapVw:2.5,wallThickness:12,wallRadius:42,wallInset:3,wallShadowEdgeTopOpacityLight:.08,wallShadowEdgeTopOpacityDark:.25,wallShadowEdgeLeftOpacityLight:.06,wallShadowEdgeLeftOpacityDark:.18,wallShadowEdgeBottomOpacityLight:.06,wallShadowEdgeBottomOpacityDark:.03,wallShadowEdgeRightOpacityLight:.04,wallShadowEdgeRightOpacityDark:.02,wallShadowAmbientBlur:20,wallShadowAmbientOpacityLight:.04,wallShadowAmbientOpacityDark:.12,wallShadowStrokeOpacityLight:.06,wallShadowStrokeOpacityDark:.04,wallInnerShadowEnabled:!0,wallInnerShadowOpacityLightV2:1,wallInnerShadowOpacityDarkV2:1,wallInnerShadowBlurVh:15,wallInnerShadowSpreadVh:15,wallInnerShadowBlur1:3,wallInnerShadowBlur2:8,wallInnerShadowBlur3:20,wallGradientStrokeEnabled:!0,wallGradientStrokeWidth:.33,wallGradientStrokeBottomEnabled:!0,wallGradientStrokeBottomRadius:1,wallGradientStrokeBottomOpacity:1,wallGradientStrokeBottomColor:"#ffffff",wallGradientStrokeTopEnabled:!0,wallGradientStrokeTopRadius:1,wallGradientStrokeTopOpacity:.5,wallGradientStrokeTopColor:"#ffffff",outerWallBorderWidth:1.4,outerWallBorderGradientSpread:85,outerWallBorderBrightOpacityLight:.3,outerWallBorderBrightOpacityDark:.4,outerWallBorderDimOpacityLight:.1,outerWallBorderDimOpacityDark:.15,outerWallBorderShadowOpacityLight:.25,outerWallBorderShadowOpacityDark:.4,outerWallCastShadowOffset:3,outerWallCastShadowBlur:12,outerWallCastShadowSpread:0,outerWallCastShadowOpacityLight:.15,outerWallCastShadowOpacityDark:.25,outerWallRadiusAdjust:2,outerWallTopShadowOffset:3,outerWallTopShadowBlur:8,outerWallTopShadowOpacityLight:.4,outerWallTopShadowOpacityDark:.6,outerWallShineBlurLight:20,outerWallShineSpreadLight:4,outerWallShineOvershootLight:10,outerWallShineOpacityLight:.4,outerWallShineColorLight:"",outerWallShineBlurDark:20,outerWallShineSpreadDark:4,outerWallShineOvershootDark:10,outerWallShineOpacityDark:.5,outerWallShineColorDark:"",outerWallShineEnabled:!0,innerWallOutwardShadowOffset:2,innerWallOutwardShadowBlur:8,innerWallOutwardShadowSpread:2,innerWallOutwardShadowOpacityLight:.2,innerWallOutwardShadowOpacityDark:.35,innerWallBorderWidth:2,innerWallBorderBrightOpacityLight:.5,innerWallBorderBrightOpacityDark:.6,innerWallBorderDimOpacityLight:.15,innerWallBorderDimOpacityDark:.2,innerWallBorderShadowOpacityLight:.2,innerWallBorderShadowOpacityDark:.35,innerWallInnerGlowOpacityLight:.1,innerWallInnerGlowOpacityDark:.12,innerWallInnerGlowBlur:30,innerWallInnerGlowSpread:-5,innerWallInnerGlowOffsetY:8,innerWallInnerGlowColor:"#ffffff",innerWallShineEnabled:!0,wallAOOpacityLight:.15,wallAOOpacityDark:.3,wallAOSpread:2,wallSpecularOpacityLight:.4,wallSpecularOpacityDark:.5,wallSpecularWidth:.5,wallSpecularEnabled:!1,wallLightFluctuationStrength:.15,wallLightFluctuationEnabled:!1,modalOverlayEnabled:!0,modalOverlayOpacity:.01,modalOverlayBlurPx:8,modalOverlayTransitionMs:800,modalOverlayTransitionOutMs:600,modalOverlayContentDelayMs:200,modalDepthScale:.96,modalDepthTranslateY:8,logoBlurInactive:0,logoBlurActive:12,grungeVideoEnabled:!0,grungeVideoOpacity:.8,grungeVideoBlendModeLight:"overlay",grungeVideoBlendModeDark:"screen",entranceEnabled:!0,entranceWallTransitionDelay:300,entranceWallTransitionDuration:800,entranceWallInitialScale:1.1,entranceWallEasing:"cubic-bezier(0.16, 1, 0.3, 1)",entranceElementDuration:800,entranceElementScaleStart:.95,entranceElementTranslateZStart:-20,contentFadeInDelay:500,contentFadeInDuration:1e3,entranceElementEasing:"cubic-bezier(0.16, 1, 0.3, 1)",entranceLateElementDuration:600,entranceLateElementStagger:250,entranceLateElementScaleFrom:.92,entrancePerspectiveLandscape:1200,entrancePerspectiveSquare:1e3,entrancePerspectivePortrait:800,uiHitAreaMul:1,uiIconCornerRadiusMul:.5,uiIconFramePx:0,uiIconGlyphPx:0,uiIconGroupMarginPx:0,linkTextPadding:30,linkIconPadding:24,linkColorInfluence:1,linkImpactScale:.95,linkImpactBlur:10,linkImpactDuration:150,linkHoverNudge:1,linkHoverIntensityLight:.2,linkHoverIntensityDark:.24,linkHoverIntensityActive:.18,hoverSnapEnabled:!0,hoverSnapDuration:450,hoverSnapOvershoot:1.08,hoverSnapUndershoot:.98,hoverEdgeEnabled:!0,hoverEdgeWidth:1,hoverEdgeInset:0,hoverEdgeBottomEnabled:!0,hoverEdgeBottomRadius:1.2,hoverEdgeBottomOpacity:.6,hoverEdgeBottomColorMix:70,hoverEdgeTopEnabled:!0,hoverEdgeTopRadius:1,hoverEdgeTopOpacity:.3,hoverEdgeTopColorMix:50,getSquashMax(){return 0===this.ballSoftness?0:ho.SQUASH_MAX_BASE*(this.ballSoftness/40)},getCanvasCornerRadius(){return Math.max(0,this.cornerRadius-this.simulationPadding)}};var yo=Object.freeze({__proto__:null,applyLayoutCSSVars:h,applyLayoutFromVwToPx:m,clearBalls:x,detectResponsiveScale:M,getBalls:()=>bo.balls,getConfig:()=>bo.config,getEffectiveDPR:()=>go,getGlobals:b,getLayoutViewportHeightPx:s,getLayoutViewportWidthPx:l,getMobileAdjustedCount:y,getNormalizedScreenArea:c,getScreenAreaPx:d,getState:g,initState:f,pxToVw:u,setCanvas:v,setEffectiveDPR:o,setMode:w,updateBallSizes:S,vwToPx:p});const vo=.85,wo=["#b5b7b6","#bbbdbd","#ffffff","#00695c","#000000","#ff4013","#0d5cb6","#ffa000"],xo=["#5b8378","#345d51","#8a928a","#00e6c3","#d5d5d5","#ff6b47","#5b9aff","#ffb84d"],Mo=1.35,So={satMul:.1,valMul:.03},ko={satMul:.14,valMul:.07},Co={industrialTeal:{label:"Industrial Teal",light:G(wo,.2),dark:G(xo,.2)},industrialRust:{label:"Industrial Rust",light:G(A(E(wo,B(wo,["#b5b7b6","#bbbdbd","#ffffff","#a33a22","#000000","#00695c","#1f4bb8","#ff8a1f"],Mo),vo),So),.2),dark:G(A(E(xo,B(xo,["#7f6f64","#54433a","#b6b1aa","#ff6a3d","#d5d5d5","#00e6c3","#6aa0ff","#ffb15a"],Mo),vo),ko),.2)},industrialSlate:{label:"Industrial Slate",light:G(A(E(wo,B(wo,["#b5b7b6","#bbbdbd","#ffffff","#1f2937","#000000","#00a8cc","#7c3aed","#ff5d2e"],Mo),vo),So),.2),dark:G(A(E(xo,B(xo,["#6f7780","#3f4851","#98a2b3","#7dd3fc","#d5d5d5","#22d3ee","#c084fc","#ff7a45"],Mo),vo),ko),.2)},industrialAmber:{label:"Industrial Amber",light:G(A(E(wo,B(wo,["#b5b7b6","#bbbdbd","#ffffff","#d97706","#000000","#00695c","#6b46c1","#ff4013"],Mo),vo),So),.2),dark:G(A(E(xo,B(xo,["#82745d","#5a4b35","#a9a193","#fbbf24","#d5d5d5","#00e6c3","#c4b5fd","#ff6b47"],Mo),vo),ko),.2)},industrialViolet:{label:"Industrial Violet",light:G(A(E(wo,B(wo,["#b5b7b6","#bbbdbd","#ffffff","#6b46c1","#000000","#00695c","#7fbf2a","#d94666"],Mo),vo),So),.2),dark:G(A(E(xo,B(xo,["#7a6f83","#52475b","#a7a0b0","#c084fc","#d5d5d5","#00e6c3","#bef264","#fb7185"],Mo),vo),ko),.2)},industrialForest:{label:"Industrial Forest",light:G(A(E(wo,B(wo,["#b5b7b6","#bbbdbd","#ffffff","#166534","#000000","#00695c","#f59e0b","#7c3aed"],Mo),vo),So),.2),dark:G(A(E(xo,B(xo,["#637563","#3d4f3f","#98a593","#4ade80","#d5d5d5","#00e6c3","#fcd34d","#c4b5fd"],Mo),vo),ko),.2)},industrialSteel:{label:"Industrial Steel",light:G(A(E(wo,B(wo,["#b5b7b6","#bbbdbd","#ffffff","#334155","#000000","#0ea5e9","#c2410c","#65a30d"],Mo),vo),So),.2),dark:G(A(E(xo,B(xo,["#6f737a","#464a52","#98a2ab","#94a3b8","#d5d5d5","#38bdf8","#fb923c","#a3e635"],Mo),vo),ko),.2)}},Fo=["industrialTeal","industrialRust","industrialSlate","industrialAmber","industrialViolet","industrialForest","industrialSteel"],Lo="abs_palette_chapter",Oo=[.5,.25,.12,.06,.03,.02,.01,.01],Do=[3,5,6,7];var Io=Object.freeze({__proto__:null,COLOR_TEMPLATES:Co,PALETTE_CHAPTER_ORDER:Fo,applyColorTemplate:te,applyCursorColorIndex:Y,getColorByIndex:ee,getCurrentPalette:X,getCursorCandidateIndices:Z,maybeAutoPickCursorColor:U,pickRandomColor:J,pickRandomColorWithIndex:Q,populateColorSelect:ae,rotatePaletteChapterOnReload:ne});const Po={attackTime:.003,decayTime:.12,harmonicGain:.02,filterBaseFreq:580,filterVelocityRange:400,filterQ:.18,filterMinHz:350,filterMaxHz:2800,pitchMinHz:220,pitchMaxHz:880,pitchCurve:1.2,reverbDecay:.25,reverbWetMix:.18,reverbHighDamp:.55,minGain:.001,maxGain:.0125,masterGain:.28,voiceGainMax:.02,minTimeBetweenSounds:.012,maxPan:.15,noiseTransientEnabled:!0,noiseTransientGain:.018,noiseTransientDecay:.004,noiseTransientFilterMin:800,noiseTransientFilterMax:2400,noiseTransientQ:.8,sparkleGain:.035,sparkleRatioMin:2,sparkleRatioMax:5,sparkleDecayMul:.85,variancePitch:.06,varianceDecay:.2,varianceGain:.15,varianceFilter:.18,varianceNoise:.25,velocityNoiseScale:1.8,velocityBrightnessScale:1.4,velocityDecayScale:.65,intensityExponent:1.5,toneSafetyMinHz:130,toneSafetyMaxHz:480,toneSafetyExponent:2.2,toneSafetyHighGainAtten:.25,toneSafetyLowGainAtten:.06,toneSafetyHighBrightAtten:.45,collisionMinImpact:.58,highShelfFreq:2200,highShelfGain:-6};let Wo={continuousEnabled:!1,tickGainMul:1,swishGainMul:1,tickBaseGain:.05,tickMinVelocity:50,tickMaxVelocity:1600,tickMinRate:.6,tickMaxRate:9,swishBaseGain:.04,swishMinVelocity:220,swishMaxVelocity:2200,swishMinHz:600,swishMaxHz:2200,centerGain:.08,centerFilterHz:1600,snapGain:.12,openGain:.12,openFilterHz:1800,closeGain:.1,closeFilterHz:1600,snapDebounceMs:300,stopDelayMs:60},Ko=null;const To={organicImpact:{label:"Organic Impact",description:"Warm, natural thuds with intensity dynamics",...Po},glassMarbles:{label:"Glass Marbles",description:"Clear, glassy impacts with more presence",...Po,pitchMinHz:260,pitchMaxHz:780,pitchCurve:1.05,filterBaseFreq:850,filterVelocityRange:600,noiseTransientGain:.065,noiseTransientFilterMin:650,noiseTransientFilterMax:2200,noiseTransientQ:1.6,decayTime:.055,intensityExponent:1.3,highShelfGain:-4.5},crystalPebbles:{label:"Crystal Pebbles ",description:"Crisp, close, soothing micro-chimes (non-repetitive)",...Po,pitchMinHz:420,pitchMaxHz:1600,pitchCurve:1.15,filterBaseFreq:1300,filterVelocityRange:1700,filterQ:.22,filterMaxHz:6200,decayTime:.04,intensityExponent:1.65,collisionMinImpact:.7,minTimeBetweenSounds:.018,noiseTransientGain:.02,noiseTransientDecay:.006,noiseTransientFilterMin:1200,noiseTransientFilterMax:7e3,noiseTransientQ:2.8,sparkleGain:.12,sparkleRatioMin:2.6,sparkleRatioMax:4.4,sparkleDecayMul:.55,reverbWetMix:.04,reverbDecay:.1,highShelfGain:-4,masterGain:.24},woodenBeads:{label:"Wooden Beads ",description:"Ultra-soft, muted thuds (recommended)",...Po,filterBaseFreq:420,filterVelocityRange:200,noiseTransientGain:.025,noiseTransientFilterMin:380,noiseTransientFilterMax:1400,noiseTransientQ:1.1,decayTime:.095,intensityExponent:1.7,collisionMinImpact:.62,highShelfGain:-7.5,reverbWetMix:.12},rubberBalls:{label:"Rubber Balls",description:"Bouncy, playful with longer decay",...Po,pitchMinHz:160,pitchMaxHz:360,filterBaseFreq:520,filterVelocityRange:350,noiseTransientGain:.035,noiseTransientFilterMin:450,noiseTransientFilterMax:1600,noiseTransientQ:1.2,decayTime:.12,intensityExponent:1.4,reverbWetMix:.14,highShelfGain:-5},metallicClick:{label:"Metallic Click",description:"Crisp, percussive impacts",...Po,pitchMinHz:220,pitchMaxHz:620,pitchCurve:1.1,filterBaseFreq:720,filterVelocityRange:550,noiseTransientGain:.08,noiseTransientFilterMin:700,noiseTransientFilterMax:2400,noiseTransientQ:1.8,noiseTransientDecay:.006,decayTime:.045,intensityExponent:1.2,highShelfGain:-3.5,collisionMinImpact:.5}};let Eo="crystalPebbles";Ko={...To[Eo]},delete Ko.label,delete Ko.description;let Bo=null,Ao=null,Go=null,Ro=null,zo=null,$o=null,_o=null,No=null,Vo=null,Ho=!1,jo=!1;const qo="bravia-balls:sound-state",Zo=8;let Yo=[],Uo=0,Xo=new Map,Qo=!1,Jo=null,ei=null,ti=null,ai=null,ni=null,oi=null,ii=null,ri=null,li=null,si=null,di=!1;const ci=new Map,ui=[],pi=[];let mi,hi,fi=null,gi=null,bi="",yi=null,vi="",wi=null,xi="",Mi=null,Si=null,ki="",Ci=ho.DPR,Fi=0,Li=0,Oi=null,Di=null,Ii=0,Pi=0,Wi=0;var Ki=Object.freeze({__proto__:null,getCanvas:ze,getContext:$e,resize:Re,setForceRenderCallback:Ae,setupRenderer:Ge});let Ti=0,Ei=0,Bi=0,Ai=0,Gi=0,Ri=0,zi=0,$i=0,_i=null,Ni={targetFPS:60,throttleLevel:0,throttled:!1},Vi=performance.now()/1e3,Hi=0,ji=!0,qi=null,Zi=0,Yi=!1,Ui=[],Xi=0,Qi=60;const Ji={pit:"Ball Pit",flies:"Flies to Light",weightless:"Zero Gravity",water:"Water Swimming",magnetic:"Magnetic",bubbles:"Carbonated Bubbles","kaleidoscope-3":"Kaleidoscope",critters:"Hive","parallax-linear":"Parallax (Linear)","parallax-float":"Parallax (Float)","3d-sphere":"3D Sphere","3d-cube":"3D Cube","starfield-3d":"3D Starfield","elastic-center":"Elastic Center","particle-fountain":"Particle Fountain"},er={[co.PIT]:{load:()=>import("./ball-pit.js"),hooks:{initialize:"initializeBallPit",force:"applyBallPitForces"}},[co.FLIES]:{load:()=>import("./flies.js"),hooks:{initialize:"initializeFlies",force:"applyFliesForces"}},[co.WEIGHTLESS]:{load:()=>import("./weightless.js"),hooks:{initialize:"initializeWeightless",force:"applyWeightlessForces"}},[co.WATER]:{load:()=>import("./water.js"),hooks:{initialize:"initializeWater",force:"applyWaterForces",update:"updateWaterRipples"}},[co.MAGNETIC]:{load:()=>import("./magnetic.js"),hooks:{initialize:"initializeMagnetic",force:"applyMagneticForces",update:"updateMagnetic"}},[co.BUBBLES]:{load:()=>import("./bubbles.js"),hooks:{initialize:"initializeBubbles",force:"applyBubblesForces",update:"updateBubbles"}},[co.KALEIDOSCOPE]:{load:()=>import("./kaleidoscope.js"),hooks:{initialize:"initializeKaleidoscope",force:"applyKaleidoscopeForces",render:"renderKaleidoscope",bounds:"applyKaleidoscopeBounds"}},[co.CRITTERS]:{load:()=>import("./critters.js"),hooks:{initialize:"initializeCritters",force:"applyCrittersForces",update:"updateCrittersGrid",preRender:"renderCrittersWaypoints"}},[co.PARALLAX_LINEAR]:{load:()=>import("./parallax-linear.js"),hooks:{initialize:"initializeParallaxLinear",force:"applyParallaxLinearForces",update:"updateParallaxLinearMouse"}},[co.PARALLAX_FLOAT]:{load:()=>import("./parallax-float.js"),hooks:{initialize:"initializeParallaxFloat",force:"applyParallaxFloatForces",update:"updateParallaxFloatMouse"}},[co.SPHERE_3D]:{load:()=>import("./3d-sphere.js"),hooks:{initialize:"initialize3DSphere",force:"apply3DSphereForces"}},[co.CUBE_3D]:{load:()=>import("./3d-cube.js"),hooks:{initialize:"initialize3DCube",force:"apply3DCubeForces"}},[co.STARFIELD_3D]:{load:()=>import("./starfield-3d.js"),hooks:{initialize:"initializeStarfield3D",force:"applyStarfield3DForces",update:"updateStarfield3D",preRender:"renderStarfield3D"}},[co.ELASTIC_CENTER]:{load:()=>import("./elastic-center.js"),hooks:{initialize:"initializeElasticCenter",force:"applyElasticCenterForces",update:"updateElasticCenter"}},[co.PARTICLE_FOUNTAIN]:{load:()=>import("./particle-fountain.js"),hooks:{initialize:"initializeParticleFountain",force:"applyParticleFountainForces",update:"updateParticleFountain"}}},tr=new Map,ar=new Map;let nr=!1,or=0;var ir=Object.freeze({__proto__:null,MODES:co,getForceApplicator:Xe,getModeBoundsHandler:tt,getModeCustomRenderer:et,getModeRenderer:Je,getModeUpdater:Qe,initModeSystem:Ze,resetCurrentMode:Ue,setMode:Ye});let rr=null,lr=null,sr=null,dr=!0,cr=!1;const ur=new WeakMap;let pr=!1;var mr=Object.freeze({__proto__:null,hideOverlay:ut,initModalOverlay:lt,isOverlayActive:pt,mountModalIntoOverlay:nt,showOverlay:ct,unmountModalFromOverlay:ot,updateBlurFromWallThickness:rt,updateGateContentDelay(e){document.documentElement.style.setProperty("--modal-content-delay",e+"ms")},updateGateDepthScale(e){document.documentElement.style.setProperty("--modal-depth-scale",e),dt(pt())},updateGateDepthTranslateY(e){document.documentElement.style.setProperty("--modal-depth-translate-y",e+"px"),dt(pt())},updateLogoBlurActive(e){const t=document.documentElement;t.style.setProperty("--logo-blur-active-target",e+"px"),pt()&&t.style.setProperty("--logo-blur-active",e+"px"),dt(pt())},updateLogoBlurInactive(e){const t=document.documentElement;t.style.setProperty("--logo-blur-inactive",e+"px"),pt()||t.style.setProperty("--logo-blur-active",e+"px"),dt(pt())},updateOverlayBlur(e){rr&&(void 0!==e?(pr=!0,rr.style.setProperty("--modal-overlay-blur",e+"px")):rt())},updateOverlayOpacity(e){rr&&rr.style.setProperty("--modal-overlay-opacity",e)},updateOverlayTransition(e){rr&&(rr.style.setProperty("--modal-overlay-transition-duration",e+"ms"),document.documentElement.style.setProperty("--modal-depth-duration",e+"ms"),dt(pt()))},updateOverlayTransitionOut(e){rr&&(rr.style.setProperty("--modal-overlay-transition-out-duration",e+"ms"),document.documentElement.style.setProperty("--modal-depth-out-duration",e+"ms"),dt(pt()))}});const hr=64;let fr=0;const gr=new Float32Array(hr),br=new Float32Array(hr),yr=new Float32Array(hr),vr=new Float32Array(hr),wr=new Float32Array(hr),xr=new Float32Array(hr),Mr=new Float32Array(hr),Sr=new Float32Array(hr),kr=Array(hr);let Cr=0,Fr=0;const Lr="--abs-scene-impact",Or="--abs-scene-impact-dur",Dr="--abs-scene-impact-logo-scale";let Ir=null,Pr=!1,Wr=0,Kr=0,Tr=0,Er=!1,Br=null,Ar=null,Gr=0,Rr=0,zr=0,$r=0,_r=0,Nr=0,Vr=0,Hr=null,jr=!1,qr=!1,Zr=null,Yr=0;const Ur=100;let Xr=!1,Qr=null,Jr=!1,el=null;const tl="translate(-50%, -50%) scale(0)",al="translate(-50%, -50%) scale(0.25)",nl="translate(-50%, -50%) scale(1)";var ol=Object.freeze({__proto__:null,getCursorColor:St,hideCursor:It,setupCustomCursor:kt,showCursor:Pt,updateCursorPosition:Dt,updateCursorSize:Ct});let il=0,rl=null,ll=null,sl=null,dl=0,cl=0,ul=!1;const pl="high",ml="balanced",hl="low",fl="auto";let gl=0;const bl=919,yl=66,vl=bl/yl,wl="#161616",xl="#e3e9f0",Ml=2.2,Sl=1e3,kl=8;let Cl=new Map,Fl=null,Ll={width:0,height:0},Ol=0,Dl=!1;const Il={progress:0,isComplete:!1,isStarted:!1,startTimeMs:0},Pl="undefined"!=typeof document?(()=>{const e=document.createElement("canvas");return e.width=1,e.height=1,e.getContext("2d")})():null,Wl=ho.PHYSICS_DT,Kl=.5,Tl=.3,El=.75,Bl=new Set([co.PIT,co.FLIES,co.WEIGHTLESS,co.CRITTERS,co.MAGNETIC,co.ELASTIC_CENTER,co.WATER,co.KALEIDOSCOPE,co.DVD_LOGO,co.SHOOTING_STARS]),Al={behind:[],inFront:[]},Gl=ho.PHYSICS_DT_MOBILE,Rl=42,zl=1800,$l=1/60,_l={},Nl=Object.freeze({registerEffects:!1}),Vl={iterations:3,positionalCorrectionPercent:.22,maxCorrectionPx:1.25,enableSound:!1},Hl={map:new Map,arrays:[],arrayIndex:0};var jl=Object.freeze({__proto__:null,getBalls:()=>b().balls||[],render:Jt,resetPhysicsAccumulator:Gt,syncChromeColor:ta,updatePhysics:Qt});const ql=(()=>{try{return{log:console.log?.bind(console)??(()=>{}),info:console.info?.bind(console)??(()=>{}),warn:console.warn?.bind(console)??(()=>{}),error:console.error?.bind(console)??(()=>{}),debug:console.debug?.bind(console)??(()=>{}),groupCollapsed:console.groupCollapsed?.bind(console)??(()=>{}),groupEnd:console.groupEnd?.bind(console)??(()=>{}),table:console.table?.bind(console)??(()=>{})}}catch(e){return{log(){},info(){},warn(){},error(){},debug(){},groupCollapsed(){},groupEnd(){},table(){}}}})();let Zl=null,Yl=0,Ul="undefined"!=typeof performance&&performance.now?performance.now():Date.now(),Xl=!1;const Ql=["#b7bcb7","#d0d0d0","#ffffff","#00695c","#1a1a1a","#ff4013","#0d5cb6","#ffa000"],Jl=[.5,.25,.12,.06,.03,.02,.01,.01];let es=null,ts=null,as=!1,ns=null,os=null,is=null,rs=null,ls=null,ss=0,ds=null,cs=0,us=null,ps="";const ms=["noiseEnabled","noiseSeed","noiseTextureSize","noiseDistribution","noiseMonochrome","noiseChroma","noiseMotion","noiseMotionAmount","noiseSpeedMs","noiseSpeedVariance","noiseFlicker","noiseFlickerSpeedMs","noiseBlurPx","noiseContrast","noiseBrightness","noiseSaturation","noiseHue","noiseSize","noiseOpacity","noiseOpacityLight","noiseOpacityDark","noiseColorLight","noiseColorDark","detailNoiseOpacity"];let hs=null,fs=null,gs=null,bs=null,ys=null,vs=null,ws=!1,xs=null,Ms=null;var Ss=Object.freeze({__proto__:null,initLightSimulation:Ia,initWallElements:Pa,requestWallElementUpdate:Wa,updateWallElements:Ka});let ks=null;const Cs=["outerWallShineBlurLight","outerWallShineSpreadLight","outerWallShineOvershootLight","outerWallShineOpacityLight","outerWallShineColorLight","outerWallShineBlurDark","outerWallShineSpreadDark","outerWallShineOvershootDark","outerWallShineOpacityDark","outerWallShineColorDark"],Fs=["innerWallShineBlur","innerWallShineOvershoot","innerWallShineSpread","innerWallShineOpacityLight","innerWallShineOpacityDark","innerWallShineColor"],Ls=["wallSpecularWidth","wallSpecularOpacityLight","wallSpecularOpacityDark"];let Os={};(()=>{try{const e=localStorage.getItem("panel_control_visibility");e&&(Os=JSON.parse(e))}catch(e){Os={}}})();const Ds=[{id:"appearance",title:"Appearance",icon:"",sections:["colors","colorDistribution","noise","tactileLayer"]},{id:"frame",title:"Frame",icon:"",sections:["wallGeometry","layers","uiSpacing"]},{id:"effects",title:"Effects",icon:"",sections:["innerWall","outerWall","simulationOverlay","overlay"]},{id:"interaction",title:"Interaction",icon:"",sections:["cursor","trail","links"]},{id:"simulation",title:"Simulation",icon:"",sections:["liteMode","physics","balls"]},{id:"motion",title:"Motion",icon:"",sections:["scene","entrance","environment"]}];Ds.flatMap(e=>e.sections);const Is={liteMode:{title:"Lite Mode",icon:"",defaultOpen:!0,controls:[{id:"liteModeEnabled",label:"Lite Mode",stateKey:"liteModeEnabled",type:"toggle",default:!1,format:e=>e?"On":"Off",parse:e=>!!e,hint:"Reduces simulation density for smoother 90fps targets.",isHero:!0,onChange(e){Promise.resolve().then(()=>ir).then(({setMode:t})=>{t(e.currentMode)}).catch(()=>{})}}]},environment:{title:"Browser",icon:"",defaultOpen:!1,controls:[{id:"chromeHarmonyMode",label:"Chrome Harmony",stateKey:"chromeHarmonyMode",type:"select",options:[{value:"auto",label:"Auto (adapt only when needed)"},{value:"site",label:"Site (benchmark)"},{value:"browser",label:"Browser (force adapt)"}],default:"auto",format:e=>e+"",parse:e=>e+"",hint:"If desktop browsers ignore theme-color, the wall adapts to match the browser UI palette.",onChange(){Promise.resolve().then(()=>Rs).then(({getCurrentTheme:e,setTheme:t})=>{t(e())}).catch(()=>{})}},{id:"autoDarkModeEnabled",label:"Auto Dark (Night)",stateKey:"autoDarkModeEnabled",type:"checkbox",default:!0,format:e=>e?"On":"Off",parse:e=>!!e,hint:"In Auto theme, prefer Dark during the night window (privacy-first: local clock only).",onChange(){Promise.resolve().then(()=>Rs).then(({getCurrentTheme:e,setTheme:t})=>{"auto"===e()&&t("auto")}).catch(()=>{})}},{id:"autoDarkNightStartHour",label:"Night Starts",stateKey:"autoDarkNightStartHour",type:"range",min:0,max:23,step:1,default:18,format:e=>Math.round(e)+":00",parse:e=>parseInt(e,10),onChange(){Promise.resolve().then(()=>Rs).then(({getCurrentTheme:e,setTheme:t})=>{"auto"===e()&&t("auto")}).catch(()=>{})}},{id:"autoDarkNightEndHour",label:"Night Ends",stateKey:"autoDarkNightEndHour",type:"range",min:0,max:23,step:1,default:6,format:e=>Math.round(e)+":00",parse:e=>parseInt(e,10),onChange(){Promise.resolve().then(()=>Rs).then(({getCurrentTheme:e,setTheme:t})=>{"auto"===e()&&t("auto")}).catch(()=>{})}}]},physics:{title:"Material World",icon:"",defaultOpen:!1,controls:[{id:"ballMassKg",label:"Ball Mass",stateKey:"ballMassKg",type:"range",min:20,max:400,step:1,default:91,format:e=>Math.round(e)+" kg",parse:e=>parseInt(e,10),hint:"Heavier = snooker feel (more inertia, less jitter).",onChange(e,t){const a=+t;if(Number.isFinite(a)&&Array.isArray(e.balls))for(let n=0;e.balls.length>n;n++){const t=e.balls[n];t&&(t.m=a)}}},{id:"REST",label:"Restitution",stateKey:"REST",type:"range",min:0,max:.95,step:.01,default:.42,format:e=>e.toFixed(2),parse:parseFloat,hint:"Global bounciness for collisions (modes may override)."},{id:"FRICTION",label:"Friction",stateKey:"FRICTION",type:"range",min:0,max:.06,step:.001,default:.018,format:e=>e.toFixed(3),parse:parseFloat,hint:"Global drag/energy loss (modes may override)."},{id:"physicsCollisionIterations",label:"Collision Iterations",stateKey:"physicsCollisionIterations",type:"range",min:3,max:20,step:1,default:10,format:e=>Math.round(e)+"",parse:e=>parseInt(e,10),group:"Performance",groupCollapsed:!0,hint:"How many times per frame we resolve collisions. Lower = faster, higher = tighter stacks."},{id:"physicsSkipSleepingCollisions",label:"Skip Sleeping Pairs",stateKey:"physicsSkipSleepingCollisions",type:"toggle",default:!0,group:"Performance",hint:"When enabled, collisions between two sleeping balls are skipped until something wakes them. Big CPU win with piles."},{id:"physicsSpatialGridOptimization",label:"Grid Reuse",stateKey:"physicsSpatialGridOptimization",type:"toggle",default:!0,group:"Performance",hint:"Reuses the spatial grid data structures to reduce allocations/GC. Keep on unless debugging."},{id:"physicsSleepThreshold",label:"Sleep Threshold",stateKey:"physicsSleepThreshold",type:"range",min:0,max:30,step:1,default:12,format:e=>Math.round(e)+" px/s",parse:e=>parseInt(e,10),group:"Performance",hint:"Velocity below which a ball is considered at rest (nonPit modes). 0 disables sleeping."},{id:"physicsSleepTime",label:"Sleep Time",stateKey:"physicsSleepTime",type:"range",min:0,max:1,step:.05,default:.25,format:e=>e.toFixed(2)+"s",parse:parseFloat,group:"Performance",hint:"How long a ball must stay under the Sleep Threshold before it sleeps. Higher = more stability + more performance."},{id:"physicsSkipSleepingSteps",label:"Skip Sleeping Steps",stateKey:"physicsSkipSleepingSteps",type:"toggle",default:!0,group:"Performance",hint:"When enabled, sleeping balls dont run physics integration each tick. Improves performance; tiny motions may be delayed until wake."}]},balls:{title:"Balls",icon:"",defaultOpen:!1,controls:[{id:"ballSizeMin",label:"Size Min",stateKey:"ballSizeMin",type:"range",min:8,max:40,step:1,default:12,format:e=>e+"px",parse:parseFloat,hint:"Ball radius at smallest viewport (320px)",onChange(e,t){e.ballSizeMin=t,Promise.resolve().then(()=>yo).then(({updateBallSizes:t})=>{t();const a=e.R_MED;e.balls&&e.balls.length&&e.balls.forEach(e=>{e.r=a,e.rBase=a})}),Promise.resolve().then(()=>ol).then(({updateCursorSize:e})=>{e()})}},{id:"ballSizeMax",label:"Size Max",stateKey:"ballSizeMax",type:"range",min:10,max:60,step:1,default:12,format:e=>e+"px",parse:parseFloat,hint:"Ball radius at largest viewport (1920px)",onChange(e,t){e.ballSizeMax=t,Promise.resolve().then(()=>yo).then(({updateBallSizes:t})=>{t();const a=e.R_MED;e.balls&&e.balls.length&&e.balls.forEach(e=>{e.r=a,e.rBase=a})}),Promise.resolve().then(()=>ol).then(({updateCursorSize:e})=>{e()})}},{id:"ballSizeCurve",label:"Size Curve",stateKey:"ballSizeCurve",type:"range",min:.2,max:5,step:.1,default:1.6,format:e=>e.toFixed(1),parse:parseFloat,hint:"Easing curve (1=linear, >1=smaller longer, <1=grows faster)",onChange(e,t){e.ballSizeCurve=t,Promise.resolve().then(()=>yo).then(({updateBallSizes:t})=>{t();const a=e.R_MED;e.balls&&e.balls.length&&e.balls.forEach(e=>{e.r=a,e.rBase=a})}),Promise.resolve().then(()=>ol).then(({updateCursorSize:e})=>{e()})}},{id:"mobileObjectReductionFactor",label:"Mobile Density",stateKey:"mobileObjectReductionFactor",type:"range",min:0,max:1,step:.05,default:1,format:e=>Math.round(100*e)+"%",parse:parseFloat,hint:"Scales object counts on mobile (0% = none). Resets the current mode.",onChange(e){Promise.resolve().then(()=>ir).then(({setMode:t})=>{t(e.currentMode)}).catch(()=>{})}},{id:"ballSoftnessGlobal",label:"Softness",stateKey:"ballSoftness",type:"range",min:0,max:100,step:1,default:29,format:e=>e+"",parse:e=>parseInt(e,10)},{id:"ballSpacing",label:"Spacing",stateKey:"ballSpacing",type:"range",min:0,max:.5,step:.01,default:.08,format:e=>Math.round(100*e)+"%",parse:parseFloat,hint:"Collision gap as % of ball radius (affects physics)"},{id:"sizeVariationGlobalMul",label:"Variation Scale",stateKey:"sizeVariationGlobalMul",type:"range",min:0,max:2,step:.05,default:1,format:e=>e.toFixed(2)+"x",parse:parseFloat,hint:"Global multiplier for per-mode size variation",onChange(){Promise.resolve().then(()=>yo).then(({updateBallSizes:e})=>{e()})}},{id:"sizeVariationCap",label:"Variation Cap",stateKey:"sizeVariationCap",type:"range",min:0,max:.2,step:.01,default:0,format:e=>Math.round(100*e)+"%",parse:parseFloat,hint:"Max radius deviation from medium (20% = 20%)",onChange(){Promise.resolve().then(()=>yo).then(({updateBallSizes:e})=>{e()})}}]},cursor:{title:"Hand",icon:"",defaultOpen:!1,controls:[{id:"cursorInfluenceRadiusVw",label:"Influence Radius",stateKey:"cursorInfluenceRadiusVw",type:"range",min:0,max:80,step:.5,default:14,format:e=>e.toFixed(1)+"vw",parse:parseFloat,hint:"Universal cursor interaction zone (scales with viewport width)."}]},trail:{title:"Mouse & Trail",icon:"",defaultOpen:!1,controls:[{id:"cursorSize",label:"Cursor Size",stateKey:"cursorSize",type:"range",min:.1,max:3,step:.05,default:1,format:e=>e.toFixed(2),parse:parseFloat,onChange(){Promise.resolve().then(()=>ol).then(({updateCursorSize:e})=>{e()})}},{id:"mouseTrailEnabled",label:"Trail Enabled",stateKey:"mouseTrailEnabled",type:"checkbox",default:!0},{id:"mouseTrailLength",label:"Trail Length",stateKey:"mouseTrailLength",type:"range",min:4,max:96,step:1,default:18,format:e=>Math.round(e)+"",parse:e=>parseInt(e,10),hint:"Max samples kept (higher = smoother, slightly more work)"},{id:"mouseTrailSize",label:"Trail Size",stateKey:"mouseTrailSize",type:"range",min:.5,max:10,step:.1,default:1.3,format:e=>e.toFixed(1)+"px",parse:parseFloat},{id:"mouseTrailFadeMs",label:"Trail Fade",stateKey:"mouseTrailFadeMs",type:"range",min:40,max:1200,step:10,default:220,format:e=>Math.round(e)+"ms",parse:e=>parseInt(e,10)},{id:"mouseTrailOpacity",label:"Trail Opacity",stateKey:"mouseTrailOpacity",type:"range",min:0,max:1,step:.01,default:.35,format:e=>e.toFixed(2),parse:parseFloat}]},uiSpacing:{title:"UI Spacing",icon:"",defaultOpen:!1,controls:[{type:"divider",label:"Content"},{id:"contentPaddingRatio",label:"Padding Additive",stateKey:"contentPaddingRatio",type:"range",min:-.05,max:.1,step:.001,default:0,format:e=>(100*+e).toFixed(1)+"%",parse:parseFloat,hint:"Additive padding as a fraction of viewport size (sqrt(w*h)). Back-compat: old px values are auto-converted.",onChange(e,t){const a=void 0!==t?t:void 0!==e.contentPaddingRatio?e.contentPaddingRatio:0;Promise.resolve().then(()=>yo).then(({applyLayoutFromVwToPx:t,applyLayoutCSSVars:n})=>{t(),n();try{const t=document.getElementById("contentPaddingRatioVal");if(t){const n=+a||0,o=(()=>{try{const e=getComputedStyle(document.documentElement).getPropertyValue("--layout-viewport-size-px").trim(),t=parseFloat(e);return Number.isFinite(t)?t:0}catch(e){return 0}})(),i=Math.round(o*n),r=Math.round(e.contentPadding||0);t.textContent=`${0>n?"":"+"}${(100*n).toFixed(1)}% (${0>i?"":"+"}${i}px)  ${r}px`}}catch(o){}try{document.dispatchEvent(new CustomEvent("layout-updated"))}catch(o){}}).catch(()=>{}),Promise.resolve().then(()=>Ki).then(({resize:e})=>{try{e()}catch(t){}}).catch(()=>{})}},{id:"contentPaddingHorizontalRatio",label:"Horizontal Ratio",stateKey:"contentPaddingHorizontalRatio",type:"range",min:.5,max:2.5,step:.05,default:1,format:e=>(+e).toFixed(2)+"",parse:parseFloat,hint:"Horizontal padding = base  ratio.",onChange(e){Promise.resolve().then(()=>yo).then(({applyLayoutFromVwToPx:t,applyLayoutCSSVars:a})=>{t(),a();try{const t=document.getElementById("contentPaddingHorizontalRatioVal");t&&(t.textContent=`${(+(e.contentPaddingHorizontalRatio||1)).toFixed(2)}  ${Math.round(e.contentPaddingX||e.contentPadding)}px`)}catch(n){}}).catch(()=>{})}},{id:"contentPaddingBottomRatio",label:"Bottom Padding Ratio",stateKey:"contentPaddingBottomRatio",type:"range",min:.5,max:2.5,step:.05,default:1.3,format:e=>(+e).toFixed(2)+"",parse:parseFloat,hint:"Bottom padding multiplier (applied to vertical padding).",onChange(e,t){document.documentElement.style.setProperty("--abs-content-pad-mul-bottom",(+t||1.3)+"")}},{type:"divider",label:"Hit Areas"},{id:"uiHitAreaMul",label:"Hit Area Mul",stateKey:"uiHitAreaMul",type:"range",min:.5,max:2.5,step:.05,default:.7,format:e=>(+e).toFixed(2)+"",parse:parseFloat,hint:"Scales most UI button/link hit areas (drives --ui-hit-area-mul).",onChange(e,t){document.documentElement.style.setProperty("--ui-hit-area-mul",t+"")}},{type:"divider",label:"Icon Buttons"},{id:"uiIconFramePx",label:"Icon Frame Size",stateKey:"uiIconFramePx",type:"range",min:0,max:120,step:1,default:0,format:e=>+e>0?Math.round(e)+"px":"Auto",parse:e=>parseInt(e,10),hint:"Square icon button frame size (height/width). 0 = auto (derived from icon padding tokens).",onChange(e,t){const a=document.documentElement;+t>0?a.style.setProperty("--ui-icon-frame-size",Math.round(t)+"px"):a.style.removeProperty("--ui-icon-frame-size")}},{id:"uiIconGlyphPx",label:"Icon Glyph Size",stateKey:"uiIconGlyphPx",type:"range",min:0,max:64,step:1,default:0,format:e=>+e>0?Math.round(e)+"px":"Auto",parse:e=>parseInt(e,10),hint:"Icon glyph size inside the square frame. 0 = auto (uses token defaults).",onChange(e,t){const a=document.documentElement;+t>0?a.style.setProperty("--ui-icon-glyph-size",Math.round(t)+"px"):a.style.removeProperty("--ui-icon-glyph-size")}},{id:"uiIconGroupMarginPx",label:"Icon Group Margin",stateKey:"uiIconGroupMarginPx",type:"range",min:-60,max:60,step:1,default:0,format:e=>Math.round(e)+"px",parse:e=>parseInt(e,10),hint:"Margin applied to the social icon group. Use negative values to push icons outward.",onChange(e,t){const a=document.documentElement;0===+t?a.style.removeProperty("--ui-icon-group-margin"):a.style.setProperty("--ui-icon-group-margin",Math.round(t)+"px")}},{id:"uiIconCornerRadiusMul",label:"Corner Radius",stateKey:"uiIconCornerRadiusMul",type:"range",min:0,max:1,step:.01,default:.4,format:e=>Math.round(100*+e)+"% of wall",parse:parseFloat,hint:"Icon button corner radius as a fraction of wall radius (drives --ui-icon-corner-radius-mul).",onChange(e,t){document.documentElement.style.setProperty("--ui-icon-corner-radius-mul",t+"")}},{id:"uiIconFramePx",label:"Frame Size",stateKey:"uiIconFramePx",type:"range",min:0,max:140,step:1,default:0,format:e=>Math.round(+e)>0?Math.round(+e)+"px":"Auto",parse:e=>parseInt(e,10),hint:"Square icon button frame size (px). 0 = use token-derived default (--ui-icon-frame-size).",onChange(e,t){try{const e=document.documentElement,a=Math.round(+(t||0));a>0?e.style.setProperty("--ui-icon-frame-size",a+"px"):e.style.removeProperty("--ui-icon-frame-size")}catch(a){}}},{id:"uiIconGlyphPx",label:"Glyph Size",stateKey:"uiIconGlyphPx",type:"range",min:0,max:80,step:1,default:0,format:e=>Math.round(+e)>0?Math.round(+e)+"px":"Auto",parse:e=>parseInt(e,10),hint:"Icon glyph size (px). 0 = use token-derived default (--ui-icon-glyph-size).",onChange(e,t){try{const e=document.documentElement,a=Math.round(+(t||0));a>0?e.style.setProperty("--ui-icon-glyph-size",a+"px"):e.style.removeProperty("--ui-icon-glyph-size")}catch(a){}}},{type:"divider",label:"Links"},{id:"linkTextPadding",label:"Text Link Padding",stateKey:"linkTextPadding",type:"range",min:4,max:40,step:1,default:30,format:e=>Math.round(e)+"px",parse:e=>parseInt(e,10),hint:"Padding for text links (main links, CV links).",onChange(e,t){document.documentElement.style.setProperty("--link-text-padding",t+"px"),document.documentElement.style.setProperty("--link-text-margin",-t+"px")}},{id:"linkIconPadding",label:"Icon Link Padding",stateKey:"linkIconPadding",type:"range",min:4,max:40,step:1,default:24,format:e=>Math.round(e)+"px",parse:e=>parseInt(e,10),hint:"Legacy: used to derive auto icon button sizing when Icon Frame Size is set to Auto.",onChange(e,t){document.documentElement.style.setProperty("--link-icon-padding",t+"px"),document.documentElement.style.setProperty("--link-icon-margin",-t+"px")}},{type:"divider",label:"Main Links + Labels"},{id:"footerNavBarTopVh",label:"Nav Bar Position",stateKey:"footerNavBarTopVh",type:"range",min:0,max:100,step:.5,default:50,format:e=>(+e).toFixed(1)+"vh",parse:e=>parseFloat(e),hint:"Vertical position of main links nav bar from top of viewport.",onChange(e,t){const a=document.documentElement;a.style.setProperty("--footer-nav-bar-top",t+"vh"),a.style.setProperty("--footer-nav-bar-top-svh",t+"svh"),a.style.setProperty("--footer-nav-bar-top-dvh",t+"dvh")}},{id:"footerNavBarGapVw",label:"Nav Link Gap",stateKey:"footerNavBarGapVw",type:"range",min:0,max:10,step:.1,default:2.5,format:e=>(+e).toFixed(1)+"vw",parse:e=>parseFloat(e),hint:"Horizontal gap between nav bar links (vw  clamp).",onChange(e,t){const a=+t;if(!Number.isFinite(a))return;const n=Math.round(9.6*a);document.documentElement.style.setProperty("--footer-nav-bar-gap",`clamp(${n}px, ${a}vw, ${Math.round(1.67*n)}px)`)}},{id:"homeMainLinksBelowLogoPx",label:"Links Offset",stateKey:"homeMainLinksBelowLogoPx",type:"range",min:-120,max:240,step:1,default:40,format:e=>Math.round(e)+"px",parse:e=>parseInt(e,10),hint:"Index: move the main links up/down below the logo.",onChange(e,t){document.documentElement.style.setProperty("--home-main-links-below-logo-px",t+"")}},{id:"edgeLabelInsetAdjustPx",label:"Edge Label Inset",stateKey:"edgeLabelInsetAdjustPx",type:"range",min:-120,max:240,step:1,default:0,format:e=>Math.round(e)+"px",parse:e=>parseInt(e,10),hint:"Adjusts edge label inset relative to wall. Higher = inward; lower = outward.",onChange(){Promise.resolve().then(()=>yo).then(e=>{e.applyLayoutCSSVars()}).catch(()=>{})}},{id:"edgeCaptionDistanceMinPx",label:"Caption Distance Min",stateKey:"edgeCaptionDistanceMinPx",type:"range",min:0,max:80,step:2,default:8,format:e=>Math.round(e)+"px",parse:e=>parseInt(e,10),hint:"Padding from bottom inner edge of wall (0 = flush). Index, portfolio, cv.",onChange(){Promise.resolve().then(()=>yo).then(e=>{e.applyLayoutCSSVars()}).catch(()=>{})}},{id:"edgeCaptionDistanceMaxPx",label:"Caption Distance Max",stateKey:"edgeCaptionDistanceMaxPx",type:"range",min:16,max:200,step:2,default:48,format:e=>Math.round(e)+"px",parse:e=>parseInt(e,10),hint:"Maximum distance; at largest breakpoint does not grow further.",onChange(){Promise.resolve().then(()=>yo).then(e=>{e.applyLayoutCSSVars()}).catch(()=>{})}}]},simulationOverlay:{title:"Simulation Overlay",icon:"",defaultOpen:!1,controls:[{id:"simulationOverlayIntensity",label:"CSS Gradient",stateKey:"simulationOverlayIntensity",type:"range",min:0,max:1,step:.05,default:1,format:e=>e.toFixed(2),parse:parseFloat,hint:"Intensity of the soft gradient overlay on the simulation (viewport ::before).",onChange(){Promise.resolve().then(()=>yo).then(e=>{e.applyLayoutCSSVars()}).catch(()=>{})}},{type:"divider",label:"Depth Wash (Canvas)"},{id:"depthWashOpacity",label:"Opacity",stateKey:"depthWashOpacity",type:"range",min:0,max:1,step:.05,default:.65,format:e=>Math.round(100*e)+"%",parse:parseFloat,hint:"Master opacity of the radial depth overlay"},{id:"depthWashCenterY",label:"Center Y",stateKey:"depthWashCenterY",type:"range",min:0,max:1,step:.05,default:.3,format:e=>Math.round(100*e)+"%",parse:parseFloat,hint:"Vertical center of gradient (0=top, 100%=bottom)"},{id:"depthWashRadiusScale",label:"Radius",stateKey:"depthWashRadiusScale",type:"range",min:.2,max:3,step:.1,default:1,format:e=>e.toFixed(1)+"",parse:parseFloat,hint:"Size of the gradient"},{type:"divider",label:"Light Mode"},{id:"depthWashBlendModeLight",label:"Blend Mode",stateKey:"depthWashBlendModeLight",type:"select",options:[{value:"source-over",label:"Normal"},{value:"multiply",label:"Multiply"},{value:"screen",label:"Screen"},{value:"overlay",label:"Overlay"},{value:"darken",label:"Darken"},{value:"lighten",label:"Lighten"},{value:"color-dodge",label:"Color Dodge"},{value:"color-burn",label:"Color Burn"},{value:"hard-light",label:"Hard Light"},{value:"soft-light",label:"Soft Light"},{value:"difference",label:"Difference"},{value:"exclusion",label:"Exclusion"}],default:"color-dodge",format:e=>e+"",parse:e=>e+""},{id:"depthWashCenterColorLight",label:"Center Color",stateKey:"depthWashCenterColorLight",type:"color",default:"#ffffff",format:e=>e+"",parse:e=>e+""},{id:"depthWashCenterAlphaLight",label:"Center Alpha",stateKey:"depthWashCenterAlphaLight",type:"range",min:0,max:1,step:.05,default:.3,format:e=>Math.round(100*e)+"%",parse:parseFloat},{id:"depthWashEdgeColorLight",label:"Edge Color",stateKey:"depthWashEdgeColorLight",type:"color",default:"#142b48",format:e=>e+"",parse:e=>e+""},{id:"depthWashEdgeAlphaLight",label:"Edge Alpha",stateKey:"depthWashEdgeAlphaLight",type:"range",min:0,max:1,step:.05,default:.4,format:e=>Math.round(100*e)+"%",parse:parseFloat},{type:"divider",label:"Dark Mode"},{id:"depthWashBlendModeDark",label:"Blend Mode",stateKey:"depthWashBlendModeDark",type:"select",options:[{value:"source-over",label:"Normal"},{value:"multiply",label:"Multiply"},{value:"screen",label:"Screen"},{value:"overlay",label:"Overlay"},{value:"darken",label:"Darken"},{value:"lighten",label:"Lighten"},{value:"color-dodge",label:"Color Dodge"},{value:"color-burn",label:"Color Burn"},{value:"hard-light",label:"Hard Light"},{value:"soft-light",label:"Soft Light"},{value:"difference",label:"Difference"},{value:"exclusion",label:"Exclusion"}],default:"multiply",format:e=>e+"",parse:e=>e+""},{id:"depthWashCenterColorDark",label:"Center Color",stateKey:"depthWashCenterColorDark",type:"color",default:"#1a1e23",format:e=>e+"",parse:e=>e+""},{id:"depthWashCenterAlphaDark",label:"Center Alpha",stateKey:"depthWashCenterAlphaDark",type:"range",min:0,max:1,step:.05,default:0,format:e=>Math.round(100*e)+"%",parse:parseFloat},{id:"depthWashEdgeColorDark",label:"Edge Color",stateKey:"depthWashEdgeColorDark",type:"color",default:"#05020f",format:e=>e+"",parse:e=>e+""},{id:"depthWashEdgeAlphaDark",label:"Edge Alpha",stateKey:"depthWashEdgeAlphaDark",type:"range",min:0,max:1,step:.05,default:.8,format:e=>Math.round(100*e)+"%",parse:parseFloat}]},links:{title:"Links",icon:"",defaultOpen:!1,controls:[{id:"linkColorInfluence",label:"Color Influence",stateKey:"linkColorInfluence",type:"range",min:0,max:1,step:.01,default:1,format:e=>e.toFixed(2),parse:parseFloat,hint:"How much cursor color affects link colors (0 = none, 1 = full)",onChange(e,t){document.documentElement.style.setProperty("--link-color-influence",t+"")}},{id:"linkImpactScale",label:"Impact Scale",stateKey:"linkImpactScale",type:"range",min:.7,max:1,step:.01,default:.95,format:e=>e.toFixed(2),parse:parseFloat,hint:"Scale when link is pressed (lower = more dramatic press)",onChange(e,t){document.documentElement.style.setProperty("--link-impact-scale",t+"")}},{id:"linkImpactBlur",label:"Impact Blur",stateKey:"linkImpactBlur",type:"range",min:0,max:20,step:.5,default:10,format:e=>e.toFixed(1)+"px",parse:parseFloat,hint:"Blur amount when link is pressed (creates depth effect)",onChange(e,t){document.documentElement.style.setProperty("--link-impact-blur",t+"px")}},{id:"linkImpactDuration",label:"Impact Duration",stateKey:"linkImpactDuration",type:"range",min:50,max:300,step:10,default:150,format:e=>Math.round(e)+"ms",parse:e=>parseInt(e,10),hint:"Duration of press animation (fast and subtle)",onChange(e,t){document.documentElement.style.setProperty("--link-impact-duration",t+"ms")}},{type:"divider",label:"Hover Motion",group:"Motion"},{id:"hoverSnapEnabled",label:"Hover Snap",stateKey:"hoverSnapEnabled",type:"checkbox",default:!0,hint:"Hover targets: a tiny snap onto bounce on hover entry (scale-only; color stays instant).",onChange(e,t){document.documentElement.style.setProperty("--abs-hover-snap-enabled",t?"1":"0")}},{id:"hoverSnapDuration",label:"Snap Duration",stateKey:"hoverSnapDuration",type:"range",min:0,max:1200,step:10,default:450,format:e=>Math.round(e)+"ms",parse:e=>parseInt(e,10),hint:"Total duration of the hover snap bounce (ms).",onChange(e,t){document.documentElement.style.setProperty("--abs-hover-snap-duration",Math.max(0,Math.round(t))+"ms")}},{id:"hoverSnapOvershoot",label:"Snap Overshoot",stateKey:"hoverSnapOvershoot",type:"range",min:1,max:1.25,step:.005,default:1.08,format:e=>e.toFixed(3),parse:parseFloat,hint:"Peak scale during hover snap (>= 1.0).",onChange(e,t){document.documentElement.style.setProperty("--abs-hover-snap-overshoot",t+"")}},{id:"hoverSnapUndershoot",label:"Snap Recoil",stateKey:"hoverSnapUndershoot",type:"range",min:.8,max:1,step:.005,default:.98,format:e=>e.toFixed(3),parse:parseFloat,hint:"Small recoil scale before settling back to 1.0 (<= 1.0).",onChange(e,t){document.documentElement.style.setProperty("--abs-hover-snap-undershoot",t+"")}},{id:"linkHoverNudge",label:"Hover Nudge",stateKey:"linkHoverNudge",type:"range",min:0,max:4,step:.25,default:1,format:e=>e.toFixed(2)+"px",parse:parseFloat,hint:"Vertical translation applied to hover/focus/active states for corner links.",onChange(e,t){document.documentElement.style.setProperty("--link-nudge",t+"px")}},{type:"divider",label:"Hover Background Bounce",group:"Motion"},{id:"hoverBgBounceEnabled",label:"BG Bounce",stateKey:"hoverBgBounceEnabled",type:"checkbox",default:!0,hint:"Enable bouncy fade-in animation for hover pseudoelement backgrounds.",onChange(e,t){document.documentElement.style.setProperty("--abs-hover-bg-bounce-enabled",t?"1":"0")}},{id:"hoverBgBounceDuration",label:"BG Duration",stateKey:"hoverBgBounceDuration",type:"range",min:0,max:1200,step:10,default:450,format:e=>Math.round(e)+"ms",parse:parseFloat,hint:"Total duration of the hover background bounce (ms).",onChange(e,t){document.documentElement.style.setProperty("--abs-hover-bg-bounce-duration",Math.max(0,Math.round(t))+"ms")}},{id:"hoverBgBounceOvershoot",label:"BG Overshoot",stateKey:"hoverBgBounceOvershoot",type:"range",min:1,max:1.5,step:.005,default:1.12,format:e=>e.toFixed(3),parse:parseFloat,hint:"Peak scale during hover background bounce (>= 1.0).",onChange(e,t){document.documentElement.style.setProperty("--abs-hover-bg-bounce-overshoot",t+"")}},{id:"hoverBgBounceEndSize",label:"BG End Size",stateKey:"hoverBgBounceEndSize",type:"range",min:.8,max:1.2,step:.005,default:1,format:e=>e.toFixed(3),parse:parseFloat,hint:"Final settled scale for hover background (typically 1.0).",onChange(e,t){document.documentElement.style.setProperty("--abs-hover-bg-bounce-end-size",t+"")}},{type:"divider",label:"Hover Color",group:"Color"},{id:"linkHoverIntensityLight",label:"Tint (Light)",stateKey:"linkHoverIntensityLight",type:"range",min:0,max:.6,step:.01,default:.2,format:e=>(100*e).toFixed(1)+"%",parse:parseFloat,hint:"Cursor color mix percentage for hover backgrounds in light mode.",onChange(e,t){document.documentElement.style.setProperty("--abs-hover-intensity-light",(100*Math.max(0,Math.min(1,t))).toFixed(1)+"%")}},{id:"linkHoverIntensityDark",label:"Tint (Dark)",stateKey:"linkHoverIntensityDark",type:"range",min:0,max:.6,step:.01,default:.24,format:e=>(100*e).toFixed(1)+"%",parse:parseFloat,hint:"Cursor color mix percentage for hover backgrounds in dark mode.",onChange(e,t){document.documentElement.style.setProperty("--abs-hover-intensity-dark",(100*Math.max(0,Math.min(1,t))).toFixed(1)+"%")}},{id:"linkHoverIntensityActive",label:"Tint (Active)",stateKey:"linkHoverIntensityActive",type:"range",min:0,max:.4,step:.01,default:.18,format:e=>(100*e).toFixed(1)+"%",parse:parseFloat,hint:"Cursor color mix percentage while a link/button is active.",onChange(e,t){document.documentElement.style.setProperty("--abs-hover-intensity-active",(100*Math.max(0,Math.min(1,t))).toFixed(1)+"%")}},{type:"divider",label:"Edge Lighting",group:"Edge Lighting"},{id:"hoverEdgeEnabled",label:"Enabled",stateKey:"hoverEdgeEnabled",type:"checkbox",default:!0,format:e=>e?"On":"Off",parse:e=>!!e,group:"Edge Lighting",hint:"Master toggle for hover edge lighting effect",onChange(e,t){document.documentElement.style.setProperty("--hover-edge-enabled",t?"1":"0")}},{id:"hoverEdgeWidth",label:"Stroke Width",stateKey:"hoverEdgeWidth",type:"range",min:.1,max:3,step:.1,default:1,format:e=>e.toFixed(1)+"px",parse:parseFloat,group:"Edge Lighting",hint:"Width of the edge lighting stroke",onChange(e,t){document.documentElement.style.setProperty("--hover-edge-width",t+"px")}},{id:"hoverEdgeInset",label:"Inset",stateKey:"hoverEdgeInset",type:"range",min:0,max:4,step:.5,default:0,format:e=>e.toFixed(1)+"px",parse:parseFloat,group:"Edge Lighting",hint:"How far inside the element edge to draw",onChange(e,t){document.documentElement.style.setProperty("--hover-edge-inset",t+"px")}},{type:"divider",label:"Bottom Light",group:"Edge Lighting"},{id:"hoverEdgeBottomEnabled",label:"Enabled",stateKey:"hoverEdgeBottomEnabled",type:"checkbox",default:!0,format:e=>e?"On":"Off",parse:e=>!!e,group:"Edge Lighting",hint:"Primary upward light source",onChange(e,t){document.documentElement.style.setProperty("--hover-edge-bottom-enabled",t?"1":"0")}},{id:"hoverEdgeBottomRadius",label:"Size",stateKey:"hoverEdgeBottomRadius",type:"range",min:.5,max:3,step:.05,default:1.2,format:e=>e.toFixed(2)+"",parse:parseFloat,group:"Edge Lighting",hint:"Gradient radius (1.0 = element height)",onChange(e,t){document.documentElement.style.setProperty("--hover-edge-bottom-radius",t+"")}},{id:"hoverEdgeBottomOpacity",label:"Opacity",stateKey:"hoverEdgeBottomOpacity",type:"range",min:0,max:1,step:.02,default:.6,format:e=>Math.round(100*e)+"%",parse:parseFloat,group:"Edge Lighting",hint:"Light intensity at center",onChange(e,t){document.documentElement.style.setProperty("--hover-edge-bottom-opacity",t+"")}},{id:"hoverEdgeBottomColorMix",label:"Color Mix",stateKey:"hoverEdgeBottomColorMix",type:"range",min:0,max:100,step:5,default:70,format:e=>Math.round(e)+"%",parse:parseFloat,group:"Edge Lighting",hint:"How much cursor color vs white",onChange(e,t){document.documentElement.style.setProperty("--hover-edge-bottom-color-mix",t+"%")}},{type:"divider",label:"Top Light",group:"Edge Lighting"},{id:"hoverEdgeTopEnabled",label:"Enabled",stateKey:"hoverEdgeTopEnabled",type:"checkbox",default:!0,format:e=>e?"On":"Off",parse:e=>!!e,group:"Edge Lighting",hint:"Ambient downward light source",onChange(e,t){document.documentElement.style.setProperty("--hover-edge-top-enabled",t?"1":"0")}},{id:"hoverEdgeTopRadius",label:"Size",stateKey:"hoverEdgeTopRadius",type:"range",min:.5,max:3,step:.05,default:1,format:e=>e.toFixed(2)+"",parse:parseFloat,group:"Edge Lighting",hint:"Gradient radius (1.0 = element height)",onChange(e,t){document.documentElement.style.setProperty("--hover-edge-top-radius",t+"")}},{id:"hoverEdgeTopOpacity",label:"Opacity",stateKey:"hoverEdgeTopOpacity",type:"range",min:0,max:1,step:.02,default:.3,format:e=>Math.round(100*e)+"%",parse:parseFloat,group:"Edge Lighting",hint:"Light intensity at center",onChange(e,t){document.documentElement.style.setProperty("--hover-edge-top-opacity",t+"")}},{id:"hoverEdgeTopColorMix",label:"Color Mix",stateKey:"hoverEdgeTopColorMix",type:"range",min:0,max:100,step:5,default:50,format:e=>Math.round(e)+"%",parse:parseFloat,group:"Edge Lighting",hint:"How much cursor color vs white",onChange(e,t){document.documentElement.style.setProperty("--hover-edge-top-color-mix",t+"%")}}]},scene:{title:"Scene Impact",icon:"",defaultOpen:!1,controls:[{id:"sceneImpactEnabled",label:"Enabled",stateKey:"sceneImpactEnabled",type:"checkbox",default:!0,hint:"If disabled, mode changes will not animate the scene."},{id:"sceneImpactMul",label:"Click Depth",stateKey:"sceneImpactMul",type:"range",min:0,max:.05,step:.001,default:.01,format:e=>e.toFixed(3),parse:parseFloat,hint:"How far the entire scene presses in on simulation change.",onChange(e,t){const a=document.getElementById("abs-scene");if(!a)return;const n=e||{},o=+n.sceneImpactMobileMulFactor;a.style.setProperty("--abs-scene-impact-mul",+t*((n.isMobile||n.isMobileViewport)&&Number.isFinite(o)&&o>0?o:1)+"")}},{id:"sceneImpactLogoCompMul",label:"Logo Comp",stateKey:"sceneImpactLogoCompMul",type:"range",min:.25,max:6,step:.05,default:3.6,format:e=>e.toFixed(2)+"x",parse:parseFloat,hint:'How strongly the logo counter-scales against the scene press (higher = logo feels more "anchored").',onChange(e,t){const a=document.getElementById("abs-scene");if(!a)return;const n=+t;a.style.setProperty("--abs-scene-impact-logo-comp-mul",(Number.isFinite(n)&&n>0?n:1)+"")}},{id:"sceneImpactMobileMulFactor",label:"Mobile Depth ",stateKey:"sceneImpactMobileMulFactor",type:"range",min:.25,max:3,step:.05,default:1,format:e=>e.toFixed(2)+"x",parse:parseFloat,hint:"Multiplier applied to Click Depth on mobile-sized viewports.",onChange(e,t){const a=document.getElementById("abs-scene");if(!a)return;const n=e||{},o=+n.sceneImpactMul,i=+t;a.style.setProperty("--abs-scene-impact-mul",(Number.isFinite(o)?o:0)*((n.isMobile||n.isMobileViewport)&&Number.isFinite(i)&&i>0?i:1)+"")}},{id:"sceneImpactPressMs",label:"Press",stateKey:"sceneImpactPressMs",type:"range",min:20,max:300,step:5,default:90,format:e=>Math.round(e)+"ms",parse:e=>parseInt(e,10),hint:"Press-in duration."},{id:"sceneImpactReleaseMs",label:"Release",stateKey:"sceneImpactReleaseMs",type:"range",min:40,max:1200,step:10,default:310,format:e=>Math.round(e)+"ms",parse:e=>parseInt(e,10),hint:"Release duration (bounce out length)."},{id:"sceneImpactAnticipation",label:"Anticipation",stateKey:"sceneImpactAnticipation",type:"range",min:0,max:.6,step:.01,default:0,format:e=>e.toFixed(2),parse:parseFloat,hint:"Micro pre-pop before the click-in (0 = off)."},{id:"sceneChangeSoundEnabled",label:"Scene Sound",stateKey:"sceneChangeSoundEnabled",type:"checkbox",default:!0,hint:"Plays a soft pebble-like tick when switching simulations (only if sound is enabled)."},{id:"sceneChangeSoundIntensity",label:"Scene Sound Intensity",stateKey:"sceneChangeSoundIntensity",type:"range",min:0,max:1,step:.01,default:.35,format:e=>e.toFixed(2),parse:parseFloat},{id:"sceneChangeSoundRadius",label:"Scene Sound Pitch",stateKey:"sceneChangeSoundRadius",type:"range",min:6,max:60,step:1,default:18,format:e=>""+Math.round(e),parse:e=>parseInt(e,10),hint:"Higher = lower pitch (maps like ball size)."}]},overlay:{title:"Depth & Blur",icon:"",defaultOpen:!1,controls:[{id:"modalOverlayEnabled",label:"Enabled",stateKey:"modalOverlayEnabled",type:"checkbox",default:!0},{id:"modalOverlayOpacity",label:"White Wash",stateKey:"modalOverlayOpacity",type:"range",min:0,max:.1,step:.001,default:.01,format:e=>e.toFixed(3),parse:parseFloat,onChange(e,t){Promise.resolve().then(()=>mr).then(({updateOverlayOpacity:e})=>{e(t)})}},{id:"modalOverlayBlurPx",label:"Blur Amount",stateKey:"modalOverlayBlurPx",type:"range",min:0,max:30,step:.5,default:8,format:e=>e.toFixed(1)+"px",parse:parseFloat,hint:"Backdrop blur strength (0 = off)",onChange(e,t){Promise.resolve().then(()=>mr).then(({updateOverlayBlur:e})=>{e(t)})}},{id:"modalOverlayTransitionMs",label:"Anim In Speed",stateKey:"modalOverlayTransitionMs",type:"range",min:200,max:1500,step:50,default:800,format:e=>Math.round(e)+"ms",parse:e=>parseInt(e,10),hint:"Duration for blur & depth zoom when opening",onChange(e,t){Promise.resolve().then(()=>mr).then(({updateOverlayTransition:e})=>{e(t)})}},{id:"modalOverlayTransitionOutMs",label:"Anim Out Speed",stateKey:"modalOverlayTransitionOutMs",type:"range",min:200,max:1200,step:50,default:600,format:e=>Math.round(e)+"ms",parse:e=>parseInt(e,10),hint:"Duration for blur & depth zoom when closing",onChange(e,t){Promise.resolve().then(()=>mr).then(({updateOverlayTransitionOut:e})=>{e(t)})}},{id:"modalOverlayContentDelayMs",label:"Content Delay",stateKey:"modalOverlayContentDelayMs",type:"range",min:0,max:1e3,step:50,default:200,format:e=>Math.round(e)+"ms",parse:e=>parseInt(e,10),hint:"Wait before showing dialog content",onChange(e,t){Promise.resolve().then(()=>mr).then(({updateGateContentDelay:e})=>{e(t)})}},{id:"modalDepthScale",label:"Depth Scale",stateKey:"modalDepthScale",type:"range",min:.9,max:1,step:.001,default:.96,format:e=>e.toFixed(3),parse:parseFloat,hint:"Scene scale when gate opens (0.9-1.0)",onChange(e,t){Promise.resolve().then(()=>mr).then(({updateGateDepthScale:e})=>{e(t)})}},{id:"gateDepthTranslateY",label:"Depth Shift",stateKey:"modalDepthTranslateY",type:"range",min:0,max:30,step:1,default:8,format:e=>Math.round(e)+"px",parse:parseInt,hint:"Vertical shift when gate opens",onChange(e,t){Promise.resolve().then(()=>mr).then(({updateGateDepthTranslateY:e})=>{e(t)})}},{id:"logoBlurInactive",label:"Logo Blur Closed",stateKey:"logoBlurInactive",type:"range",min:0,max:20,step:.5,default:0,format:e=>e.toFixed(1)+"px",parse:parseFloat,hint:"Logo blur when gate is closed (0 = sharp)",onChange(e,t){Promise.resolve().then(()=>mr).then(({updateLogoBlurInactive:e})=>{e(t)})}},{id:"logoBlurActive",label:"Logo Blur Open",stateKey:"logoBlurActive",type:"range",min:0,max:30,step:.5,default:12,format:e=>e.toFixed(1)+"px",parse:parseFloat,hint:"Logo blur when gate is active (12px = soft blur)",onChange(e,t){Promise.resolve().then(()=>mr).then(({updateLogoBlurActive:e})=>{e(t)})}}]},tactileLayer:{title:"Tactile Layer",icon:"",defaultOpen:!1,controls:[{id:"tactileEnabled",label:"Enabled",stateKey:"tactileEnabled",type:"checkbox",default:!1,hint:"Enable Unicorn Studio WebGL layer",onChange(){}},{id:"tactileProjectId",label:"Project ID",stateKey:"tactileProjectId",type:"text",default:"qBFxB3kkFBqgLxFNFleF",hint:"Unicorn Studio Project ID",onChange(){}},{id:"tactileScale",label:"Scale",stateKey:"tactileScale",type:"range",min:.1,max:1,step:.1,default:1,hint:"Resolution scale (lower for performance)",onChange(){}},{id:"tactileDpi",label:"DPI",stateKey:"tactileDpi",type:"range",min:.5,max:2,step:.1,default:1,hint:"Device Pixel Ratio (Keep low for performance)",onChange(){}},{id:"tactileOpacity",label:"Opacity",stateKey:"tactileOpacity",type:"range",min:0,max:1,step:.05,default:1,format:e=>Math.round(100*e)+"%",parse:parseFloat,onChange(){}},{id:"tactileBlendMode",label:"Blend Mode",stateKey:"tactileBlendMode",type:"select",options:["normal","overlay","screen","multiply","color-burn","linear-burn","soft-light","hard-light","lighten","difference"],default:"overlay",onChange(){}},{id:"tactilePointerEvents",label:"Interactive",stateKey:"tactilePointerEvents",type:"checkbox",default:!1,hint:"If true, blocks underlying elements. Enable if visual requires direct interaction.",onChange(){}}]},layers:{title:"Layers & Edges",icon:"",defaultOpen:!1,controls:[{type:"divider",label:"Vertical Offset"},{id:"noiseOffsetY",label:"Noise Y Offset",stateKey:"noiseOffsetY",type:"range",min:-50,max:50,step:1,default:0,format:e=>e+"px",parse:parseFloat,hint:"Move noise layer up (negative) or down (positive)",onChange(e,t){document.documentElement.style.setProperty("--abs-noise-offset-y",t+"px")}},{id:"videoOffsetY",label:"Video Y Offset",stateKey:"videoOffsetY",type:"range",min:-50,max:50,step:1,default:0,format:e=>e+"px",parse:parseFloat,hint:"Move video layer up (negative) or down (positive)",onChange(e,t){document.documentElement.style.setProperty("--grunge-video-offset-y",t+"px")}},{type:"divider",label:"Wall Frame"},{id:"safariTintInset",label:"Outer Inset",stateKey:"safariTintInset",type:"range",min:0,max:40,step:1,default:15,format:e=>e+"px",parse:parseFloat,hint:"Distance from viewport edge to wall outer edge (px)",onChange(e,t){document.documentElement.style.setProperty("--safari-tint-inset",t+"px")}}]},colors:{title:"Color & Surface",icon:"",defaultOpen:!1,controls:[{type:"divider",label:"Backgrounds"},{id:"bgLight",label:"Light Mode",stateKey:"bgLight",type:"color",default:"#f5f5f5",hint:"Background color for light mode",onChange(e,t){document.documentElement.style.setProperty("--bg-light",t)}},{id:"bgDark",label:"Dark Mode",stateKey:"bgDark",type:"color",default:"#0a0a0a",hint:"Background color for dark mode",onChange(e,t){document.documentElement.style.setProperty("--bg-dark",t)}},{type:"divider",label:"Text  Light Mode"},{id:"textColorLight",label:"Primary",stateKey:"textColorLight",type:"color",default:"#161616",hint:"Main text color in light mode",onChange(e,t){document.documentElement.style.setProperty("--text-color-light",t)}},{id:"textColorLightMuted",label:"Muted",stateKey:"textColorLightMuted",type:"color",default:"#2f2f2f",hint:"Secondary/muted text in light mode",onChange(e,t){document.documentElement.style.setProperty("--text-color-light-muted",t)}},{type:"divider",label:"Text  Dark Mode"},{id:"textColorDark",label:"Primary",stateKey:"textColorDark",type:"color",default:"#b3b3b3",hint:"Main text color in dark mode",onChange(e,t){document.documentElement.style.setProperty("--text-color-dark",t)}},{id:"textColorDarkMuted",label:"Muted",stateKey:"textColorDarkMuted",type:"color",default:"#808080",hint:"Secondary/muted text in dark mode",onChange(e,t){document.documentElement.style.setProperty("--text-color-dark-muted",t)}},{type:"divider",label:"Links"},{id:"linkHoverColor",label:"Hover Accent",stateKey:"linkHoverColor",type:"color",default:"#ff4013",hint:"Link hover color (accent)",onChange(e,t){document.documentElement.style.setProperty("--link-hover-color",t)}},{type:"divider",label:"Logo"},{id:"topLogoWidthVw",label:"Logo Size",stateKey:"topLogoWidthVw",type:"range",min:15,max:45,step:.25,default:35,format:e=>parseFloat(e).toFixed(2)+"vw",parse:parseFloat,hint:"Top-center logo width (clamped by min/max tokens).",onChange(e,t){document.documentElement.style.setProperty("--top-logo-width-vw",t+"")}}]},colorDistribution:{title:"Palette Mix",icon:"",defaultOpen:!1,controls:[{id:"colorDistribution",label:"Disciplines",stateKey:"colorDistribution",type:"colorDistribution",labels:["Product Systems","Interaction Design","Creative Technology","Applied AI","Experience Strategy","Art Direction","Prototyping"],hint:"Assign each discipline to a palette color, then set weights that sum to 100%. Used for all ball spawns across modes."}]},wallGeometry:{title:"Wall  Frame",icon:"",defaultOpen:!1,controls:[{id:"frameColorLight",label:"Color  Light Mode",stateKey:"frameColorLight",type:"color",default:"#242529",hint:"Wall color (unified across all modes, also used for browser chrome)",onChange(e,t){const a=document.documentElement;a.style.setProperty("--frame-color",t),a.style.setProperty("--frame-color-light",t),a.style.setProperty("--frame-color-dark",t),a.style.setProperty("--wall-color",t),a.style.setProperty("--wall-color-light",t),a.style.setProperty("--wall-color-dark",t),a.style.setProperty("--chrome-bg",t),a.style.setProperty("--chrome-bg-light",t),a.style.setProperty("--chrome-bg-dark",t),e.frameColor=t,e.frameColorLight=t,e.frameColorDark=t;const n=document.querySelector('meta[name="theme-color"]:not([media])');n&&(n.content=t);const o=document.querySelector('meta[name="theme-color"][media="(prefers-color-scheme: light)"]');o&&(o.content=t);const i=document.querySelector('meta[name="theme-color"][media="(prefers-color-scheme: dark)"]');i&&(i.content=t),Promise.resolve().then(()=>jl).then(e=>{e.syncChromeColor()})}},{id:"frameColorDark",label:"Color  Dark Mode",stateKey:"frameColorDark",type:"color",default:"#242529",hint:"Wall color (unified across all modes, also used for browser chrome)",onChange(e,t){const a=document.documentElement;a.style.setProperty("--frame-color",t),a.style.setProperty("--frame-color-light",t),a.style.setProperty("--frame-color-dark",t),a.style.setProperty("--wall-color",t),a.style.setProperty("--wall-color-light",t),a.style.setProperty("--wall-color-dark",t),a.style.setProperty("--chrome-bg",t),a.style.setProperty("--chrome-bg-light",t),a.style.setProperty("--chrome-bg-dark",t),e.frameColor=t,e.frameColorLight=t,e.frameColorDark=t;const n=document.querySelector('meta[name="theme-color"]:not([media])');n&&(n.content=t);const o=document.querySelector('meta[name="theme-color"][media="(prefers-color-scheme: light)"]');o&&(o.content=t);const i=document.querySelector('meta[name="theme-color"][media="(prefers-color-scheme: dark)"]');i&&(i.content=t),Promise.resolve().then(()=>jl).then(e=>{e.syncChromeColor()})}},{id:"wallThicknessVw",label:"Wall Thickness",stateKey:"wallThicknessVw",type:"range",min:0,max:8,step:.1,default:1.3,format:e=>e.toFixed(1)+"vw",parse:parseFloat,hint:"Wall tube thickness (content padding is layout-only)",onChange(){Promise.resolve().then(()=>yo).then(e=>{e.applyLayoutFromVwToPx(),e.applyLayoutCSSVars(),Promise.resolve().then(()=>mr).then(({updateBlurFromWallThickness:e})=>{e()})})}},{id:"wallThicknessAreaMultiplier",label:"Area Scaling",stateKey:"wallThicknessAreaMultiplier",type:"range",min:0,max:2,step:.01,default:0,format:e=>e.toFixed(2)+"",parse:parseFloat,hint:"Area-based scaling multiplier (0.0 = vw-only, 1.0 = full area scaling, >1.0 = exaggerated)",onChange(){Promise.resolve().then(()=>yo).then(e=>{e.applyLayoutFromVwToPx(),e.applyLayoutCSSVars(),Promise.resolve().then(()=>mr).then(({updateBlurFromWallThickness:e})=>{e()})})}},{id:"wallThicknessMinPx",label:"Thickness Min",stateKey:"wallThicknessMinPx",type:"range",min:0,max:100,step:1,default:12,format:e=>e+"px",parse:e=>parseInt(e,10),hint:"Minimum wall thickness clamp (for small viewports)",onChange(){Promise.resolve().then(()=>yo).then(e=>{e.applyLayoutFromVwToPx(),e.applyLayoutCSSVars(),Promise.resolve().then(()=>mr).then(({updateBlurFromWallThickness:e})=>{e()})})}},{id:"wallThicknessMaxPx",label:"Thickness Max",stateKey:"wallThicknessMaxPx",type:"range",min:0,max:100,step:1,default:50,format:e=>e+"px",parse:e=>parseInt(e,10),hint:"Maximum wall thickness clamp (for large viewports)",onChange(){Promise.resolve().then(()=>yo).then(e=>{e.applyLayoutFromVwToPx(),e.applyLayoutCSSVars(),Promise.resolve().then(()=>mr).then(({updateBlurFromWallThickness:e})=>{e()})})}},{id:"wallRadiusVw",label:"Corner Radius",stateKey:"wallRadiusVw",type:"range",min:0,max:12,step:.1,default:3.7,format:e=>e.toFixed(1)+"vw",parse:parseFloat,onChange(){Promise.resolve().then(()=>yo).then(e=>{e.applyLayoutFromVwToPx(),e.applyLayoutCSSVars()})}},{id:"wallInset",label:"Collision Inset",stateKey:"wallInset",type:"range",min:0,max:20,step:1,default:2,format:e=>e+"px",parse:e=>parseInt(e,10),hint:"Physics padding inside the visual wall"},{id:"mobileWallThicknessXFactor",label:"Mobile L/R Thickness",stateKey:"mobileWallThicknessXFactor",type:"range",min:.5,max:3,step:.05,default:1.4,format:e=>e.toFixed(2)+"",parse:parseFloat,hint:"Wall thickness multiplier for LEFT/RIGHT sides on mobile",onChange(){Promise.resolve().then(()=>yo).then(e=>{e.applyLayoutFromVwToPx(),e.applyLayoutCSSVars()})}},{id:"mobileEdgeLabelsVisible",label:"Mobile Edge Labels",stateKey:"mobileEdgeLabelsVisible",type:"toggle",default:!0,hint:"Show side edge labels on mobile (chapter/copyright)",onChange(){Promise.resolve().then(()=>yo).then(e=>{e.applyLayoutCSSVars()})}},{id:"mobileEdgeLabelSizeFactor",label:"Mobile Label Size",stateKey:"mobileEdgeLabelSizeFactor",type:"range",min:.3,max:2,step:.05,default:.85,format:e=>e.toFixed(2)+"",parse:parseFloat,hint:"Font size multiplier for edge labels on mobile",onChange(){Promise.resolve().then(()=>yo).then(e=>{e.applyLayoutCSSVars()})}},{id:"mobileEdgeLabelOpacity",label:"Mobile Label Opacity",stateKey:"mobileEdgeLabelOpacity",type:"range",min:0,max:1,step:.05,default:.5,format:e=>(100*e).toFixed(0)+"%",parse:parseFloat,hint:"Opacity for edge labels on mobile",onChange(){Promise.resolve().then(()=>yo).then(e=>{e.applyLayoutCSSVars()})}},{id:"restitution",label:"Bounce",stateKey:"restitution",type:"range",min:.3,max:.95,step:.05,default:.7,format:e=>Math.round(100*e)+"%",parse:parseFloat,group:"Wall Material",hint:"Energy kept on bounce. 100% = elastic, 30% = soft"}]},outerWall:{title:"Outer Wall",icon:"",defaultOpen:!1,controls:[{id:"outerWallEdgeEnabled",label:"Enable Outer Wall",stateKey:"outerWallEdgeEnabled",type:"checkbox",default:!0,format:e=>e?"On":"Off",parse:e=>!!e,hint:"Show outer wall (creates depth between walls)",theme:null,wallGroup:null,onChange(e,t){const a=document.getElementById("bravia-balls");a&&a.classList.toggle("outer-wall-edge-disabled",!t)}},{id:"outerWallShineEnabled",label:"Shine Layer",stateKey:"outerWallShineEnabled",type:"checkbox",default:!0,format:e=>e?"On":"Off",parse:e=>!!e,hint:"Enable outer wall shine layer (blur glow).",theme:null,wallGroup:"shine",onChange(e,t){e.outerWallShineEnabled=!!t,Ra(e),Ka()}},{id:"wallLightFluctuationEnabled",label:"Ambient Fluctuation",stateKey:"wallLightFluctuationEnabled",type:"checkbox",default:!1,format:e=>e?"On":"Off",parse:e=>!!e,hint:"Enable subtle ambient light fluctuation (off keeps static baseline).",theme:null,wallGroup:"micro",onChange(e,t){e.wallLightFluctuationEnabled=!!t,Ia(),Ka()}},{id:"outerWallTopShadowOffset",label:"Top Shadow Offset",stateKey:"outerWallTopShadowOffset",type:"range",min:0,max:20,step:1,default:3,format:e=>e+"px",parse:parseFloat,hint:"Vertical offset of the top overhang shadow",theme:null,wallGroup:"shadow",onChange:()=>Ba().then(e=>e?.())},{id:"outerWallTopShadowBlur",label:"Top Shadow Blur",stateKey:"outerWallTopShadowBlur",type:"range",min:0,max:30,step:1,default:8,format:e=>e+"px",parse:parseFloat,hint:"Blur radius of the top overhang shadow",theme:null,wallGroup:"shadow",onChange:()=>Ba().then(e=>e?.())},{id:"outerWallCastShadowBlur",label:"Inward Shadow Blur",stateKey:"outerWallCastShadowBlur",type:"range",min:0,max:40,step:1,default:12,format:e=>e+"px",parse:parseFloat,hint:"Softness of inward (depth) shadow",theme:null,wallGroup:"shadow",onChange(e,t){document.documentElement.style.setProperty("--outer-wall-cast-shadow-blur",t+"px")}},{id:"outerWallCastShadowOffset",label:"Inward Shadow Offset",stateKey:"outerWallCastShadowOffset",type:"range",min:0,max:15,step:1,default:3,format:e=>e+"px",parse:parseFloat,hint:"Vertical offset of inward shadow",theme:null,wallGroup:"shadow",onChange(e,t){document.documentElement.style.setProperty("--outer-wall-cast-shadow-offset",t+"px")}},{id:"wallAOSpread",label:"AO Spread",stateKey:"wallAOSpread",type:"range",min:0,max:10,step:.5,default:2,format:e=>e.toFixed(1)+"px",parse:parseFloat,hint:"Spread size of the ambient occlusion shadow",theme:null,wallGroup:"micro",onChange:()=>Ba().then(e=>e?.())},{id:"wallSpecularEnabled",label:"Specular Layer",stateKey:"wallSpecularEnabled",type:"checkbox",default:!1,format:e=>e?"On":"Off",parse:e=>!!e,hint:"Enable micro specular highlight on the outer wall.",theme:null,wallGroup:"micro",onChange(e,t){e.wallSpecularEnabled=!!t,Ra(e),Ka()}},{id:"wallSpecularWidth",label:"Specular Width",stateKey:"wallSpecularWidth",type:"range",min:.1,max:2,step:.1,default:.5,format:e=>e.toFixed(1)+"px",parse:parseFloat,hint:"Width of the razor-sharp specular highlight",theme:null,wallGroup:"micro",onChange:()=>Ba().then(e=>e?.())},{id:"outerWallBorderWidth",label:"Width",stateKey:"outerWallBorderWidth",type:"range",min:0,max:10,step:.1,default:2,format:e=>e.toFixed(1)+"px",parse:parseFloat,hint:"Thickness of the continuous border (shine)",theme:null,wallGroup:"shine",onChange(e,t){document.documentElement.style.setProperty("--outer-wall-border-width",+t+"px"),Ka()}},{id:"outerWallBorderGradientSpread",label:"Gradient Spread",stateKey:"outerWallBorderGradientSpread",type:"range",min:10,max:170,step:5,default:85,format:e=>e+"",parse:parseFloat,hint:"Angle of the bright spot (half-width)",theme:null,wallGroup:"shine",onChange:()=>Ba().then(e=>e?.())},{id:"outerWallRadiusAdjust",label:"Corner Adjust",stateKey:"outerWallRadiusAdjust",type:"range",min:-5,max:10,step:1,default:2,format:e=>e+"px",parse:parseFloat,hint:"Fine-tune outer wall corner roundness",theme:null,wallGroup:"geometry",onChange(e,t){document.documentElement.style.setProperty("--outer-wall-radius-adjust",t+"px")}},{id:"outerWallTopShadowOpacityLight",label:"Top Shadow Opacity",stateKey:"outerWallTopShadowOpacityLight",type:"range",min:0,max:1,step:.05,default:.4,format:e=>Math.round(100*e)+"%",parse:parseFloat,hint:"Top overhang shadow",theme:"light",wallGroup:"shadow",onChange:()=>Ba().then(e=>e?.())},{id:"outerWallCastShadowOpacityLight",label:"Inward Shadow Opacity",stateKey:"outerWallCastShadowOpacityLight",type:"range",min:0,max:.5,step:.01,default:.15,format:e=>Math.round(100*e)+"%",parse:parseFloat,hint:"Inward (depth) shadow",theme:"light",wallGroup:"shadow",onChange(e,t){document.body.classList.contains("dark-mode")||document.documentElement.style.setProperty("--outer-wall-cast-shadow-opacity",t+"")}},{id:"wallAOOpacityLight",label:"AO Opacity",stateKey:"wallAOOpacityLight",type:"range",min:0,max:1,step:.05,default:.15,format:e=>Math.round(100*e)+"%",parse:parseFloat,hint:"Ambient occlusion (gap shadow)",theme:"light",wallGroup:"micro",onChange:()=>Ba().then(e=>e?.())},{id:"wallSpecularOpacityLight",label:"Specular Opacity",stateKey:"wallSpecularOpacityLight",type:"range",min:0,max:1,step:.05,default:.4,format:e=>Math.round(100*e)+"%",parse:parseFloat,hint:"Razor-sharp edge highlight",theme:"light",wallGroup:"micro",onChange:()=>Ba().then(e=>e?.())},{id:"outerWallBorderBrightOpacityLight",label:"Bright Opacity",stateKey:"outerWallBorderBrightOpacityLight",type:"range",min:0,max:1,step:.05,default:.5,format:e=>Math.round(100*e)+"%",parse:parseFloat,hint:"Shine: brightest point (bottom)",theme:"light",wallGroup:"shine",onChange:()=>Ba().then(e=>e?.())},{id:"outerWallBorderDimOpacityLight",label:"Dim Opacity",stateKey:"outerWallBorderDimOpacityLight",type:"range",min:0,max:1,step:.05,default:.15,format:e=>Math.round(100*e)+"%",parse:parseFloat,hint:"Shine: dim sides",theme:"light",wallGroup:"shine",onChange:()=>Ba().then(e=>e?.())},{id:"outerWallBorderShadowOpacityLight",label:"Shadow Opacity",stateKey:"outerWallBorderShadowOpacityLight",type:"range",min:0,max:1,step:.05,default:.25,format:e=>Math.round(100*e)+"%",parse:parseFloat,hint:"Shine: shadow point (top)",theme:"light",wallGroup:"shine",onChange:()=>Ba().then(e=>e?.())},{id:"outerWallShineBlurLight",label:"Shine Blur",stateKey:"outerWallShineBlurLight",wallGroup:"shine",theme:"light",type:"range",min:0,max:300,step:1,default:20,format:e=>e+"px",parse:parseFloat,hint:"Blur radius (larger = softer edge blend)",onChange(){document.body.classList.contains("dark-mode")||Promise.resolve().then(()=>Ss).then(({updateWallElements:e})=>{e()})}},{id:"outerWallShineSpreadLight",label:"Shine Spread",stateKey:"outerWallShineSpreadLight",wallGroup:"shine",theme:"light",type:"range",min:-50,max:150,step:1,default:4,format:e=>e+"px",parse:parseFloat,hint:"Inset box-shadow spread (larger = thicker shadow band)",onChange(){document.body.classList.contains("dark-mode")||Promise.resolve().then(()=>Ss).then(({updateWallElements:e})=>{e()})}},{id:"outerWallShineOvershootLight",label:"Shine Overshoot",stateKey:"outerWallShineOvershootLight",wallGroup:"shine",theme:"light",type:"range",min:-100,max:100,step:1,default:10,format:e=>e+"px",parse:parseFloat,hint:"Negative = extends outside wall edge, positive = inset from edge",onChange(){document.body.classList.contains("dark-mode")||Promise.resolve().then(()=>Ss).then(({updateWallElements:e})=>{e()})}},{id:"outerWallShineOpacityLight",label:"Shine Opacity",stateKey:"outerWallShineOpacityLight",wallGroup:"shine",theme:"light",type:"range",min:0,max:1,step:.01,default:.4,format:e=>e.toFixed(2),parse:parseFloat,hint:"Blur glow layer opacity",onChange(){document.body.classList.contains("dark-mode")||Promise.resolve().then(()=>Ss).then(({updateWallElements:e})=>{e()})}},{id:"outerWallShineColorLight",label:"Shine Color Override",stateKey:"outerWallShineColorLight",wallGroup:"shine",theme:"light",type:"text",default:"",hint:"Leave empty to use frame/wall background color (hex)",onChange(){document.body.classList.contains("dark-mode")||Promise.resolve().then(()=>Ss).then(({updateWallElements:e})=>{e()})}},{id:"outerWallTopShadowOpacityDark",label:"Top Shadow Opacity",stateKey:"outerWallTopShadowOpacityDark",type:"range",min:0,max:1,step:.05,default:.6,format:e=>Math.round(100*e)+"%",parse:parseFloat,hint:"Top overhang shadow",theme:"dark",wallGroup:"shadow",onChange:()=>Ba().then(e=>e?.())},{id:"outerWallCastShadowOpacityDark",label:"Inward Shadow Opacity",stateKey:"outerWallCastShadowOpacityDark",type:"range",min:0,max:.5,step:.01,default:.25,format:e=>Math.round(100*e)+"%",parse:parseFloat,hint:"Inward (depth) shadow",theme:"dark",wallGroup:"shadow",onChange(e,t){document.body.classList.contains("dark-mode")&&document.documentElement.style.setProperty("--outer-wall-cast-shadow-opacity",t+"")}},{id:"wallAOOpacityDark",label:"AO Opacity",stateKey:"wallAOOpacityDark",type:"range",min:0,max:1,step:.05,default:.3,format:e=>Math.round(100*e)+"%",parse:parseFloat,hint:"Ambient occlusion (gap shadow)",theme:"dark",wallGroup:"micro",onChange:()=>Ba().then(e=>e?.())},{id:"wallSpecularOpacityDark",label:"Specular Opacity",stateKey:"wallSpecularOpacityDark",type:"range",min:0,max:1,step:.05,default:.5,format:e=>Math.round(100*e)+"%",parse:parseFloat,hint:"Razor-sharp edge highlight",theme:"dark",wallGroup:"micro",onChange:()=>Ba().then(e=>e?.())},{id:"outerWallBorderBrightOpacityDark",label:"Bright Opacity",stateKey:"outerWallBorderBrightOpacityDark",type:"range",min:0,max:1,step:.05,default:.6,format:e=>Math.round(100*e)+"%",parse:parseFloat,hint:"Shine: brightest point (bottom)",theme:"dark",wallGroup:"shine",onChange:()=>Ba().then(e=>e?.())},{id:"outerWallBorderDimOpacityDark",label:"Dim Opacity",stateKey:"outerWallBorderDimOpacityDark",type:"range",min:0,max:1,step:.05,default:.2,format:e=>Math.round(100*e)+"%",parse:parseFloat,hint:"Shine: dim sides",theme:"dark",wallGroup:"shine",onChange:()=>Ba().then(e=>e?.())},{id:"outerWallBorderShadowOpacityDark",label:"Shadow Opacity",stateKey:"outerWallBorderShadowOpacityDark",type:"range",min:0,max:1,step:.05,default:.4,format:e=>Math.round(100*e)+"%",parse:parseFloat,hint:"Shine: shadow point (top)",theme:"dark",wallGroup:"shine",onChange:()=>Ba().then(e=>e?.())},{id:"outerWallShineBlurDark",label:"Shine Blur",stateKey:"outerWallShineBlurDark",wallGroup:"shine",theme:"dark",type:"range",min:0,max:300,step:1,default:20,format:e=>e+"px",parse:parseFloat,hint:"Blur radius (larger = softer edge blend)",onChange(){document.body.classList.contains("dark-mode")&&Promise.resolve().then(()=>Ss).then(({updateWallElements:e})=>{e()})}},{id:"outerWallShineSpreadDark",label:"Shine Spread",stateKey:"outerWallShineSpreadDark",wallGroup:"shine",theme:"dark",type:"range",min:-50,max:150,step:1,default:4,format:e=>e+"px",parse:parseFloat,hint:"Inset box-shadow spread (larger = thicker shadow band)",onChange(){document.body.classList.contains("dark-mode")&&Promise.resolve().then(()=>Ss).then(({updateWallElements:e})=>{e()})}},{id:"outerWallShineOvershootDark",label:"Shine Overshoot",stateKey:"outerWallShineOvershootDark",wallGroup:"shine",theme:"dark",type:"range",min:-100,max:100,step:1,default:10,format:e=>e+"px",parse:parseFloat,hint:"Negative = extends outside wall edge, positive = inset from edge",onChange(){document.body.classList.contains("dark-mode")&&Promise.resolve().then(()=>Ss).then(({updateWallElements:e})=>{e()})}},{id:"outerWallShineOpacityDark",label:"Shine Opacity",stateKey:"outerWallShineOpacityDark",wallGroup:"shine",theme:"dark",type:"range",min:0,max:1,step:.01,default:.5,format:e=>e.toFixed(2),parse:parseFloat,hint:"Blur glow layer opacity",onChange(){document.body.classList.contains("dark-mode")&&Promise.resolve().then(()=>Ss).then(({updateWallElements:e})=>{e()})}},{id:"outerWallShineColorDark",label:"Shine Color Override",stateKey:"outerWallShineColorDark",wallGroup:"shine",theme:"dark",type:"text",default:"",hint:"Leave empty to use frame/wall background color (hex)",onChange(){document.body.classList.contains("dark-mode")&&Promise.resolve().then(()=>Ss).then(({updateWallElements:e})=>{e()})}}]},innerWall:{title:"Inner Wall",icon:"",defaultOpen:!1,controls:[{id:"innerWallShineEnabled",label:"Shine Layer",stateKey:"innerWallShineEnabled",type:"checkbox",default:!0,format:e=>e?"On":"Off",parse:e=>!!e,hint:"Enable inner wall shine layer (blur glow).",theme:null,wallGroup:"shine",onChange(e,t){e.innerWallShineEnabled=!!t,Ra(e),Ka()}},{id:"innerWallShineBlur",label:"Blur",stateKey:"innerWallShineBlur",wallGroup:"shine",type:"range",min:0,max:300,step:1,default:20,format:e=>e+"px",parse:parseFloat,hint:"Blur radius (larger = softer edge blend)",onChange(){Promise.resolve().then(()=>Ss).then(({updateWallElements:e})=>{e()})}},{id:"innerWallShineOvershoot",label:"Overshoot",stateKey:"innerWallShineOvershoot",wallGroup:"shine",type:"range",min:-100,max:100,step:1,default:10,format:e=>e+"px",parse:parseFloat,hint:"Negative = extends outside wall edge, positive = inset from edge",onChange(){Promise.resolve().then(()=>Ss).then(({updateWallElements:e})=>{e()})}},{id:"innerWallShineSpread",label:"Spread",stateKey:"innerWallShineSpread",wallGroup:"shine",type:"range",min:-50,max:150,step:1,default:4,format:e=>e+"px",parse:parseFloat,hint:"Inset box-shadow spread (larger = thicker shadow band)",onChange(){Promise.resolve().then(()=>Ss).then(({updateWallElements:e})=>{e()})}},{id:"innerWallShineOpacityLight",label:"Opacity (Light)",stateKey:"innerWallShineOpacityLight",wallGroup:"shine",theme:"light",type:"range",min:0,max:1,step:.01,default:.4,format:e=>e.toFixed(2),parse:parseFloat,onChange(){document.body.classList.contains("dark-mode")||Promise.resolve().then(()=>Ss).then(({updateWallElements:e})=>{e()})}},{id:"innerWallShineOpacityDark",label:"Opacity (Dark)",stateKey:"innerWallShineOpacityDark",wallGroup:"shine",theme:"dark",type:"range",min:0,max:1,step:.01,default:.5,format:e=>e.toFixed(2),parse:parseFloat,onChange(){document.body.classList.contains("dark-mode")&&Promise.resolve().then(()=>Ss).then(({updateWallElements:e})=>{e()})}},{id:"innerWallShineColor",label:"Color Override",stateKey:"innerWallShineColor",wallGroup:"shine",type:"text",default:"",hint:"Leave empty to use background color (hex)",onChange(){Promise.resolve().then(()=>Ss).then(({updateWallElements:e})=>{e()})}},{id:"innerWallOutwardShadowBlur",label:"Shadow Blur",stateKey:"innerWallOutwardShadowBlur",type:"range",min:0,max:30,step:1,default:8,format:e=>e+"px",parse:parseFloat,hint:"Softness of outward shadow",theme:null,wallGroup:"shadow",onChange(e,t){document.documentElement.style.setProperty("--inner-wall-outward-shadow-blur",t+"px")}},{id:"innerWallOutwardShadowOffset",label:"Shadow Offset",stateKey:"innerWallOutwardShadowOffset",type:"range",min:-5,max:10,step:1,default:2,format:e=>e+"px",parse:parseFloat,hint:"Vertical offset of outward shadow",theme:null,wallGroup:"shadow",onChange(e,t){document.documentElement.style.setProperty("--inner-wall-outward-shadow-offset",t+"px")}},{id:"innerWallOutwardShadowSpread",label:"Shadow Spread",stateKey:"innerWallOutwardShadowSpread",type:"range",min:-5,max:15,step:1,default:2,format:e=>e+"px",parse:parseFloat,hint:"Spread of outward shadow",theme:null,wallGroup:"shadow",onChange(e,t){document.documentElement.style.setProperty("--inner-wall-outward-shadow-spread",t+"px")}},{id:"innerWallInnerGlowBlur",label:"Glow Blur",stateKey:"innerWallInnerGlowBlur",type:"range",min:0,max:100,step:1,default:30,format:e=>e+"px",parse:parseFloat,hint:"Blur/softness of the inner glow",theme:null,wallGroup:"innerGlow",onChange(e,t){document.documentElement.style.setProperty("--inner-wall-inner-glow-blur",t+"px"),Aa().then(e=>e?.())}},{id:"innerWallInnerGlowSpread",label:"Glow Spread",stateKey:"innerWallInnerGlowSpread",type:"range",min:-20,max:20,step:1,default:-5,format:e=>e+"px",parse:parseFloat,hint:"Spread (negative tightens to edges)",theme:null,wallGroup:"innerGlow",onChange(){Aa().then(e=>e?.())}},{id:"innerWallInnerGlowOffsetY",label:"Glow Offset Y",stateKey:"innerWallInnerGlowOffsetY",type:"range",min:-50,max:50,step:1,default:0,format:e=>e+"px",parse:parseFloat,hint:"Vertical bias (+ = top brighter, - = bottom brighter)",theme:null,wallGroup:"innerGlow",onChange(){Aa().then(e=>e?.())}},{id:"innerWallInnerGlowColor",label:"Glow Color",stateKey:"innerWallInnerGlowColor",type:"color",default:"#ffffff",hint:"Color of the inner glow",theme:null,wallGroup:"innerGlow",onChange(e,t){const a=(e=>{const{r:t,g:a,b:n}=Ta(e);return`${t}, ${a}, ${n}`})(t);document.documentElement.style.setProperty("--inner-wall-inner-glow-rgb",a),Aa().then(e=>e?.())}},{id:"wallInnerShadowEnabled",label:"Enabled",stateKey:"wallInnerShadowEnabled",type:"checkbox",default:!0,hint:"Inset shadow in background colour for depth",theme:null,wallGroup:"innerShadow",onChange:e=>Ea(e)},{id:"wallInnerShadowBlurVh",label:"Blur (vh)",stateKey:"wallInnerShadowBlurVh",type:"range",min:0,max:100,step:1,default:15,format:e=>e+"vh",parse:parseFloat,hint:"Blur softness (larger = wider gradient into center)",theme:null,wallGroup:"innerShadow",onChange:e=>Ea(e)},{id:"wallInnerShadowSpreadVh",label:"Spread (vh)",stateKey:"wallInnerShadowSpreadVh",type:"range",min:-20,max:50,step:1,default:15,format:e=>e+"vh",parse:parseFloat,hint:"Solid edge band (larger = thicker opaque border before blur)",theme:null,wallGroup:"innerShadow",onChange:e=>Ea(e)},{id:"wallInnerShadowOpacityLight",label:"Opacity (Light)",stateKey:"wallInnerShadowOpacityLightV2",type:"range",min:0,max:1,step:.01,default:1,format:e=>Math.round(100*e)+"%",parse:parseFloat,hint:"Inner shadow opacity in light mode",theme:"light",wallGroup:"innerShadow",onChange:e=>Ea(e)},{id:"wallInnerShadowOpacityDark",label:"Opacity (Dark)",stateKey:"wallInnerShadowOpacityDarkV2",type:"range",min:0,max:1,step:.01,default:1,format:e=>Math.round(100*e)+"%",parse:parseFloat,hint:"Inner shadow opacity in dark mode",theme:"dark",wallGroup:"innerShadow",onChange:e=>Ea(e)},{id:"innerWallBorderWidth",label:"Width",stateKey:"innerWallBorderWidth",type:"range",min:0,max:10,step:.1,default:2,format:e=>e.toFixed(1)+"px",parse:parseFloat,hint:"Thickness of the continuous border (shine)",theme:null,wallGroup:"shine",onChange(e,t){document.documentElement.style.setProperty("--inner-wall-border-width",+t+"px"),Ka()}},{id:"innerWallOutwardShadowOpacityLight",label:"Outward Shadow Opacity",stateKey:"innerWallOutwardShadowOpacityLight",type:"range",min:0,max:.8,step:.02,default:.2,format:e=>Math.round(100*e)+"%",parse:parseFloat,hint:"Outward shadow",theme:"light",wallGroup:"shadow",onChange(e,t){document.body.classList.contains("dark-mode")||document.documentElement.style.setProperty("--inner-wall-outward-shadow-opacity",t+"")}},{id:"innerWallInnerGlowOpacityLight",label:"Glow Opacity",stateKey:"innerWallInnerGlowOpacityLight",type:"range",min:0,max:.5,step:.01,default:0,format:e=>Math.round(100*e)+"%",parse:parseFloat,hint:"Inner glow strength",theme:"light",wallGroup:"innerGlow",onChange(e,t){document.body.classList.contains("dark-mode")||document.documentElement.style.setProperty("--inner-wall-inner-glow-opacity",t+""),Aa().then(e=>e?.())}},{id:"innerWallBorderBrightOpacityLight",label:"Bright Opacity",stateKey:"innerWallBorderBrightOpacityLight",type:"range",min:0,max:1,step:.05,default:.5,format:e=>Math.round(100*e)+"%",parse:parseFloat,hint:"Shine: brightest point (top)",theme:"light",wallGroup:"shine",onChange:()=>Ba().then(e=>e?.())},{id:"innerWallBorderDimOpacityLight",label:"Dim Opacity",stateKey:"innerWallBorderDimOpacityLight",type:"range",min:0,max:1,step:.05,default:.15,format:e=>Math.round(100*e)+"%",parse:parseFloat,hint:"Shine: dim sides",theme:"light",wallGroup:"shine",onChange:()=>Ba().then(e=>e?.())},{id:"innerWallBorderShadowOpacityLight",label:"Shadow Opacity",stateKey:"innerWallBorderShadowOpacityLight",type:"range",min:0,max:1,step:.05,default:.2,format:e=>Math.round(100*e)+"%",parse:parseFloat,hint:"Shine: shadow point (bottom)",theme:"light",wallGroup:"shine",onChange:()=>Ba().then(e=>e?.())},{id:"innerWallOutwardShadowOpacityDark",label:"Outward Shadow Opacity",stateKey:"innerWallOutwardShadowOpacityDark",type:"range",min:0,max:.8,step:.02,default:.35,format:e=>Math.round(100*e)+"%",parse:parseFloat,hint:"Outward shadow",theme:"dark",wallGroup:"shadow",onChange(e,t){document.documentElement.style.setProperty("--inner-wall-outward-shadow-opacity-dark",t+""),document.body.classList.contains("dark-mode")&&document.documentElement.style.setProperty("--inner-wall-outward-shadow-opacity",t+"")}},{id:"innerWallInnerGlowOpacityDark",label:"Glow Opacity",stateKey:"innerWallInnerGlowOpacityDark",type:"range",min:0,max:.5,step:.01,default:.08,format:e=>Math.round(100*e)+"%",parse:parseFloat,hint:"Inner glow strength",theme:"dark",wallGroup:"innerGlow",onChange(e,t){document.documentElement.style.setProperty("--inner-wall-inner-glow-opacity-dark",t+""),document.body.classList.contains("dark-mode")&&document.documentElement.style.setProperty("--inner-wall-inner-glow-opacity",t+""),Aa().then(e=>e?.())}},{id:"innerWallBorderBrightOpacityDark",label:"Bright Opacity",stateKey:"innerWallBorderBrightOpacityDark",type:"range",min:0,max:1,step:.05,default:.6,format:e=>Math.round(100*e)+"%",parse:parseFloat,hint:"Shine: brightest point (top)",theme:"dark",wallGroup:"shine",onChange:()=>Ba().then(e=>e?.())},{id:"innerWallBorderDimOpacityDark",label:"Dim Opacity",stateKey:"innerWallBorderDimOpacityDark",type:"range",min:0,max:1,step:.05,default:.2,format:e=>Math.round(100*e)+"%",parse:parseFloat,hint:"Shine: dim sides",theme:"dark",wallGroup:"shine",onChange:()=>Ba().then(e=>e?.())},{id:"innerWallBorderShadowOpacityDark",label:"Shadow Opacity",stateKey:"innerWallBorderShadowOpacityDark",type:"range",min:0,max:1,step:.05,default:.35,format:e=>Math.round(100*e)+"%",parse:parseFloat,hint:"Shine: shadow point (bottom)",theme:"dark",wallGroup:"shine",onChange:()=>Ba().then(e=>e?.())}]},noise:{title:"Grain",icon:"",defaultOpen:!1,controls:[{id:"noiseEnabled",label:"Enabled",stateKey:"noiseEnabled",type:"checkbox",default:!0,format:e=>e?"On":"Off",parse:e=>!!e,group:"Render",hint:"Procedural noise texture (no GIF).",onChange:(e,t)=>Oa({noiseEnabled:t})},{id:"noiseSeed",label:"Seed",stateKey:"noiseSeed",type:"range",min:0,max:999999,step:1,default:1337,format:e=>Math.round(e)+"",parse:e=>parseInt(e,10),group:"Texture",hint:"Changes the generated grain pattern.",onChange:(e,t)=>Oa({noiseSeed:t})},{id:"noiseTextureSize",label:"Tile Size",stateKey:"noiseTextureSize",type:"range",min:64,max:512,step:32,default:256,format:e=>Math.round(e)+" px",parse:e=>parseInt(e,10),group:"Texture",hint:"Bigger tiles reduce repetition but cost more memory.",onChange:(e,t)=>Oa({noiseTextureSize:t})},{id:"noiseDistribution",label:"Distribution",stateKey:"noiseDistribution",type:"select",options:[{value:"gaussian",label:"Gaussian (filmic)"},{value:"uniform",label:"Uniform (flat)"}],default:"gaussian",format:e=>e+"",parse:e=>e+"",group:"Texture",onChange:(e,t)=>Oa({noiseDistribution:t})},{id:"noiseMonochrome",label:"Monochrome",stateKey:"noiseMonochrome",type:"checkbox",default:!0,format:e=>e?"On":"Off",parse:e=>!!e,group:"Texture",hint:"Off = subtle RGB grain.",onChange:(e,t)=>Oa({noiseMonochrome:t})},{id:"noiseChroma",label:"Chroma",stateKey:"noiseChroma",type:"range",min:0,max:1,step:.01,default:.9,format:e=>Math.round(100*e)+"%",parse:parseFloat,group:"Texture",hint:"How different R/G/B channels are (ignored when Monochrome is on).",onChange:(e,t)=>Oa({noiseChroma:t})},{id:"noiseSize",label:"Grain Size",stateKey:"noiseSize",type:"range",min:20,max:600,step:5,default:85,format:e=>Math.round(e)+" px",parse:e=>parseInt(e,10),group:"Layer",onChange:(e,t)=>Oa({noiseSize:t})},{id:"noiseOpacityLight",label:"Opacity (Light)",stateKey:"noiseOpacityLight",type:"range",min:0,max:1,step:.01,default:.03,format:e=>Math.round(100*e)+"%",parse:parseFloat,group:"Layer",onChange:(e,t)=>Oa({noiseOpacityLight:t})},{id:"noiseOpacityDark",label:"Opacity (Dark)",stateKey:"noiseOpacityDark",type:"range",min:0,max:1,step:.01,default:.03,format:e=>Math.round(100*e)+"%",parse:parseFloat,group:"Layer",onChange:(e,t)=>Oa({noiseOpacityDark:t})},{id:"noiseColorLight",label:"Color (Light)",stateKey:"noiseColorLight",type:"color",default:"#ffffff",format:e=>e+"",parse:e=>e+"",group:"Layer",onChange:(e,t)=>Oa({noiseColorLight:t})},{id:"noiseColorDark",label:"Color (Dark)",stateKey:"noiseColorDark",type:"color",default:"#ffffff",format:e=>e+"",parse:e=>e+"",group:"Layer",onChange:(e,t)=>Oa({noiseColorDark:t})},{id:"noiseMotion",label:"Motion",stateKey:"noiseMotion",type:"select",options:[{value:"jitter",label:"Jitter (film grain)"},{value:"drift",label:"Drift (slow pan)"},{value:"static",label:"Static"}],default:"jitter",format:e=>e+"",parse:e=>e+"",group:"Motion",onChange:(e,t)=>Oa({noiseMotion:t})},{id:"noiseMotionAmount",label:"Motion Amount",stateKey:"noiseMotionAmount",type:"range",min:0,max:2.5,step:.01,default:1,format:e=>e.toFixed(2)+"x",parse:parseFloat,group:"Motion",onChange:(e,t)=>Oa({noiseMotionAmount:t})},{id:"noiseSpeedMs",label:"Speed",stateKey:"noiseSpeedMs",type:"range",min:0,max:1e4,step:50,default:1100,format:e=>Math.round(e)+" ms",parse:e=>parseInt(e,10),group:"Motion",onChange:(e,t)=>Oa({noiseSpeedMs:t})},{id:"noiseSpeedVariance",label:"Timing Variance",stateKey:"noiseSpeedVariance",type:"range",min:0,max:1,step:.01,default:0,format:e=>Math.round(100*e)+"%",parse:parseFloat,group:"Motion",hint:"Adds randomness to animation timing (0 = no variance, 1 = max variance)",onChange:(e,t)=>Oa({noiseSpeedVariance:t})},{id:"noiseFlicker",label:"Flicker",stateKey:"noiseFlicker",type:"range",min:0,max:1,step:.01,default:.12,format:e=>Math.round(100*e)+"%",parse:parseFloat,group:"Motion",onChange:(e,t)=>Oa({noiseFlicker:t})},{id:"noiseFlickerSpeedMs",label:"Flicker Speed",stateKey:"noiseFlickerSpeedMs",type:"range",min:0,max:5e3,step:20,default:220,format:e=>Math.round(e)+" ms",parse:e=>parseInt(e,10),group:"Motion",onChange:(e,t)=>Oa({noiseFlickerSpeedMs:t})},{id:"noiseBlurPx",label:"Blur",stateKey:"noiseBlurPx",type:"range",min:0,max:6,step:.05,default:0,format:e=>e.toFixed(2)+" px",parse:parseFloat,group:"Look",onChange:(e,t)=>Oa({noiseBlurPx:t})},{id:"noiseContrast",label:"Contrast",stateKey:"noiseContrast",type:"range",min:.25,max:3,step:.05,default:1.35,format:e=>e.toFixed(2)+"x",parse:parseFloat,group:"Look",onChange:(e,t)=>Oa({noiseContrast:t})},{id:"noiseBrightness",label:"Brightness",stateKey:"noiseBrightness",type:"range",min:.25,max:2,step:.01,default:1,format:e=>e.toFixed(2)+"x",parse:parseFloat,group:"Look",onChange:(e,t)=>Oa({noiseBrightness:t})},{id:"noiseSaturation",label:"Saturation",stateKey:"noiseSaturation",type:"range",min:0,max:3,step:.01,default:1,format:e=>e.toFixed(2)+"x",parse:parseFloat,group:"Look",onChange:(e,t)=>Oa({noiseSaturation:t})},{id:"noiseHue",label:"Hue Rotate",stateKey:"noiseHue",type:"range",min:0,max:360,step:1,default:0,format:e=>Math.round(e)+"",parse:e=>parseInt(e,10),group:"Look",onChange:(e,t)=>Oa({noiseHue:t})}]},critters:{title:"Hive",icon:"",mode:"critters",defaultOpen:!1,controls:[{type:"divider",label:"Population"},{id:"critterCount",label:"Count",stateKey:"critterCount",type:"range",min:10,max:260,step:5,default:90,format:e=>Math.round(e)+"",parse:e=>parseInt(e,10),reinitMode:!0},{type:"divider",label:"Movement"},{id:"critterSpeed",label:"Speed",stateKey:"critterSpeed",type:"range",min:0,max:1800,step:10,default:680,format:e=>""+Math.round(e),parse:parseFloat},{id:"critterMaxSpeed",label:"Max Speed",stateKey:"critterMaxSpeed",type:"range",min:200,max:4e3,step:25,default:1400,format:e=>""+Math.round(e),parse:parseFloat},{id:"critterStepHz",label:"Step Rate",stateKey:"critterStepHz",type:"range",min:0,max:16,step:.1,default:5,format:e=>e.toFixed(1)+" Hz",parse:parseFloat},{id:"critterStepSharpness",label:"Step Sharpness",stateKey:"critterStepSharpness",type:"range",min:.5,max:6,step:.1,default:2.4,format:e=>e.toFixed(1),parse:parseFloat},{id:"critterTurnNoise",label:"Wander",stateKey:"critterTurnNoise",type:"range",min:0,max:8,step:.1,default:2.2,format:e=>e.toFixed(1),parse:parseFloat},{id:"critterTurnDamp",label:"Turn Inertia",stateKey:"critterTurnDamp",type:"range",min:.5,max:30,step:.5,default:10,format:e=>e.toFixed(1),parse:parseFloat},{id:"critterTurnSeek",label:"Steering",stateKey:"critterTurnSeek",type:"range",min:0,max:30,step:.5,default:10,format:e=>e.toFixed(1),parse:parseFloat},{type:"divider",label:"Avoidance"},{id:"critterAvoidRadius",label:"Avoid Radius",stateKey:"critterAvoidRadius",type:"range",min:0,max:260,step:5,default:90,format:e=>Math.round(e)+"px",parse:parseFloat},{id:"critterAvoidForce",label:"Avoid Force",stateKey:"critterAvoidForce",type:"range",min:0,max:25e3,step:250,default:9500,format:e=>Math.round(e)+"",parse:parseFloat},{id:"critterEdgeAvoid",label:"Edge Avoid",stateKey:"critterEdgeAvoid",type:"range",min:0,max:3,step:.05,default:1,format:e=>e.toFixed(2)+"x",parse:parseFloat},{type:"divider",label:"Mouse Interaction"},{id:"critterMousePull",label:"Mouse Fear",stateKey:"critterMousePull",type:"range",min:0,max:4,step:.05,default:1,format:e=>e.toFixed(2)+"x",parse:parseFloat,hint:"Flee strength inside the mouse zone"},{id:"critterMouseRadiusVw",label:"Mouse Zone",stateKey:"critterMouseRadiusVw",type:"range",min:0,max:80,step:1,default:30,format:e=>Math.round(e)+"vw",parse:parseFloat},{type:"divider",label:"Physics"},{id:"critterRestitution",label:"Bounciness",stateKey:"critterRestitution",type:"range",min:0,max:.6,step:.01,default:.18,format:e=>e.toFixed(2),parse:parseFloat,hint:"Mode-only override",onChange(e,t){"critters"===e.currentMode&&(e.REST=t)}},{id:"critterFriction",label:"Friction",stateKey:"critterFriction",type:"range",min:0,max:.06,step:.001,default:.018,format:e=>e.toFixed(3),parse:parseFloat,hint:"Mode-only override",onChange(e,t){"critters"===e.currentMode&&(e.FRICTION=t)}},{type:"divider",label:"Hive Behavior"},{id:"critterHiveStirInterval",label:"Hive Stir Interval",stateKey:"critterHiveStirInterval",type:"range",min:1,max:15,step:.5,default:5,format:e=>e.toFixed(1)+"s",parse:parseFloat,hint:"Seconds between activity waves"},{id:"critterHiveStirStrength",label:"Hive Stir Strength",stateKey:"critterHiveStirStrength",type:"range",min:0,max:6,step:.1,default:2.5,format:e=>e.toFixed(1)+"x",parse:parseFloat,hint:"Force of activity waves"},{id:"critterHiveWaveSpeed",label:"Hive Wave Speed",stateKey:"critterHiveWaveSpeed",type:"range",min:.1,max:1,step:.05,default:.4,format:e=>e.toFixed(2),parse:parseFloat,hint:"How fast stir wave expands"},{type:"divider",label:"Character Traits"},{id:"critterNervousnessMin",label:"Nervousness (Min)",stateKey:"critterNervousnessMin",type:"range",min:0,max:1,step:.05,default:.4,format:e=>e.toFixed(2),parse:parseFloat,hint:"Minimum startle sensitivity",reinitMode:!0},{id:"critterNervousnessMax",label:"Nervousness (Max)",stateKey:"critterNervousnessMax",type:"range",min:0,max:1,step:.05,default:1,format:e=>e.toFixed(2),parse:parseFloat,hint:"Maximum startle sensitivity",reinitMode:!0},{id:"critterCuriosityBias",label:"Curiosity Bias",stateKey:"critterCuriosityBias",type:"range",min:0,max:1,step:.05,default:.5,format:e=>e.toFixed(2),parse:parseFloat,hint:"0=stay put, 1=explore edges",reinitMode:!0},{type:"divider",label:"Journey Points"},{id:"hiveJourneyPointCount",label:"Point Count",stateKey:"hiveJourneyPointCount",type:"range",min:1,max:8,step:1,default:4,format:e=>Math.round(e)+"",parse:e=>parseInt(e,10),hint:"Number of goal destinations scattered across viewport",reinitMode:!0},{id:"hiveJourneyPointMargin",label:"Point Margin",stateKey:"hiveJourneyPointMargin",type:"range",min:0,max:.2,step:.01,default:.05,format:e=>Math.round(100*e)+"%",parse:parseFloat,hint:"Margin from edges for journey point placement",reinitMode:!0},{id:"hiveGoalAttractionStrength",label:"Goal Attraction",stateKey:"hiveGoalAttractionStrength",type:"range",min:0,max:1,step:.05,default:.25,format:e=>e.toFixed(2),parse:parseFloat,hint:"How strongly critters steer toward goals"},{id:"hiveGoalSwitchMinS",label:"Goal Switch (Min)",stateKey:"hiveGoalSwitchMinS",type:"range",min:1,max:20,step:.5,default:4,format:e=>e.toFixed(1)+"s",parse:parseFloat,hint:"Minimum seconds before switching to new goal"},{id:"hiveGoalSwitchMaxS",label:"Goal Switch (Max)",stateKey:"hiveGoalSwitchMaxS",type:"range",min:5,max:30,step:.5,default:14,format:e=>e.toFixed(1)+"s",parse:parseFloat,hint:"Maximum seconds before switching to new goal"},{id:"hiveGoalReachedRadius",label:"Goal Reached Radius",stateKey:"hiveGoalReachedRadius",type:"range",min:10,max:200,step:5,default:50,format:e=>Math.round(e)+"px",parse:parseFloat,hint:"Distance threshold to consider goal reached"},{id:"hivePathAdherence",label:"Path Adherence",stateKey:"hivePathAdherence",type:"range",min:0,max:1,step:.05,default:.5,format:e=>Math.round(100*e)+"%",parse:parseFloat,hint:"Probability to pick next sequential point vs random"},{type:"divider",label:"Waypoint Appearance"},{id:"hiveWaypointVisible",label:"Show Waypoints",stateKey:"hiveWaypointVisible",type:"checkbox",default:!0,hint:"Display colored balls at journey point locations"},{id:"hiveWaypointSizeMul",label:"Waypoint Size",stateKey:"hiveWaypointSizeMul",type:"range",min:.5,max:3,step:.1,default:1.5,format:e=>e.toFixed(1)+"",parse:parseFloat,hint:"Size multiplier for waypoint balls (relative to base ball size)"},{id:"hiveWaypointOpacity",label:"Waypoint Opacity",stateKey:"hiveWaypointOpacity",type:"range",min:.1,max:1,step:.05,default:.9,format:e=>Math.round(100*e)+"%",parse:parseFloat,hint:"Opacity of waypoint balls"},{id:"hiveCritterSaturation",label:"Critter Saturation",stateKey:"hiveCritterSaturation",type:"range",min:0,max:1,step:.05,default:.3,format:e=>Math.round(100*e)+"%",parse:parseFloat,hint:"Color saturation for critters (low = faint, high = vibrant)",reinitMode:!0},_a("crittersWarmupFrames")]},pit:{title:"Ball Pit",icon:"",mode:"pit",defaultOpen:!1,controls:[{id:"gravityPit",label:"Gravity",stateKey:"gravityMultiplierPit",type:"range",min:0,max:2,step:.05,default:1.1,format:e=>e.toFixed(2),parse:parseFloat,onChange(e,t){"pit"===e.currentMode&&(e.G=e.GE*t)}},{id:"repelPower",label:"Repel Power",stateKey:"repelPower",type:"range",min:0,max:1e4,step:100,default:8500,format:e=>""+Math.round(e),parse:parseFloat,onChange(e,t){e.repelPower=24e3*Math.pow(2,12*(Math.max(0,Math.min(1e4,t))/1e4-.5))}},{id:"sleepVelocityThreshold",label:"Sleep Speed",stateKey:"sleepVelocityThreshold",type:"range",min:0,max:40,step:.5,default:12,format:e=>(+e).toFixed(1)+" px/s",parse:parseFloat,hint:"Pit modes only. Higher = settles sooner."},{id:"sleepAngularThreshold",label:"Sleep Spin",stateKey:"sleepAngularThreshold",type:"range",min:0,max:1,step:.01,default:.18,format:e=>(+e).toFixed(2)+" rad/s",parse:parseFloat,hint:"Pit modes only. Higher = stops spinning sooner."},{id:"timeToSleep",label:"Sleep Time",stateKey:"timeToSleep",type:"range",min:.05,max:2,step:.05,default:.25,format:e=>(+e).toFixed(2)+"s",parse:parseFloat,hint:"Pit modes only. Lower = sleeps faster."},_a("pitWarmupFrames")]},flies:{title:"Flies",icon:"",mode:"flies",defaultOpen:!1,controls:[{id:"fliesBallCount",label:"Ball Count",stateKey:"fliesBallCount",type:"range",min:20,max:150,step:5,default:60,format:e=>e+"",parse:e=>parseInt(e,10),reinitMode:!0},{id:"attractPower",label:"Attraction",stateKey:"attractionPower",type:"range",min:100,max:8e3,step:50,default:5e3,format:e=>""+Math.round(e),parse:parseFloat},{id:"swarmSpeed",label:"Swarm Speed",stateKey:"swarmSpeed",type:"range",min:.2,max:5,step:.1,default:.4,format:e=>e.toFixed(1),parse:parseFloat},{id:"fliesSeparation",label:"Separation",stateKey:"fliesSeparation",type:"range",min:5e3,max:3e4,step:1e3,default:15e3,format:e=>""+Math.round(e),parse:parseFloat},_a("fliesWarmupFrames")]},weightless:{title:"Zero-G",icon:"",mode:"weightless",defaultOpen:!1,controls:[{id:"weightlessCount",label:"Ball Count",stateKey:"weightlessCount",type:"range",min:20,max:200,step:10,default:66,format:e=>e+"",parse:e=>parseInt(e,10),reinitMode:!0},{id:"weightlessSpeed",label:"Initial Speed",stateKey:"weightlessInitialSpeed",type:"range",min:100,max:600,step:25,default:250,format:e=>e.toFixed(0),parse:parseFloat,reinitMode:!0},{id:"weightlessBounce",label:"Bounce",stateKey:"weightlessBounce",type:"range",min:.5,max:1,step:.05,default:.7,format:e=>e.toFixed(2),parse:parseFloat},{id:"weightlessRepelPower",label:"Cursor Blast Power",stateKey:"weightlessRepelPower",type:"range",min:0,max:6e5,step:1e4,default:5e4,format:e=>""+Math.round(e),parse:parseFloat},{id:"weightlessRepelSoft",label:"Cursor Blast Falloff",stateKey:"weightlessRepelSoft",type:"range",min:.5,max:6,step:.1,default:5.4,format:e=>e.toFixed(1),parse:parseFloat},_a("weightlessWarmupFrames")]},water:{title:"Water",icon:"",mode:"water",defaultOpen:!1,controls:[{id:"waterBallCount",label:"Ball Count",stateKey:"waterBallCount",type:"range",min:200,max:1800,step:10,default:1e3,format:e=>e+"",parse:e=>parseInt(e,10),reinitMode:!0},{id:"waterDrag",label:"Water Resistance",stateKey:"waterDrag",type:"range",min:.001,max:.15,step:.001,default:.12,format:e=>e.toFixed(3),parse:parseFloat},{id:"waterRippleStrength",label:"Ripple Strength",stateKey:"waterRippleStrength",type:"range",min:1e3,max:15e3,step:500,default:6e3,format:e=>e.toFixed(0),parse:parseFloat},{id:"waterMotion",label:"Drift Strength",stateKey:"waterDriftStrength",type:"range",min:0,max:80,step:1,default:40,format:e=>e.toFixed(0),parse:parseFloat,onChange(e,t){e.waterInitialVelocity=5*t},reinitMode:!0},_a("waterWarmupFrames")]},magnetic:{title:"Magnetic",icon:"",mode:"magnetic",defaultOpen:!1,controls:[{id:"magneticBallCount",label:"Ball Count",stateKey:"magneticBallCount",type:"range",min:50,max:300,step:10,default:180,format:e=>e+"",parse:e=>parseInt(e,10),reinitMode:!0},{id:"magneticStrength",label:"Strength",stateKey:"magneticStrength",type:"range",min:1e4,max:1e5,step:5e3,default:65e3,format:e=>e.toFixed(0),parse:parseFloat,hint:"Magnetic attraction strength to cursor"},{id:"magneticRadius",label:"Magnetic Radius",stateKey:"magneticRadius",type:"range",min:0,max:600,step:20,default:0,format:e=>0===e?"Unlimited":Math.round(e)+"px",parse:parseFloat,hint:"Maximum distance for magnetic effect (0 = unlimited)"},{id:"magneticVelocity",label:"Max Velocity",stateKey:"magneticMaxVelocity",type:"range",min:500,max:4e3,step:100,default:2800,format:e=>e.toFixed(0),parse:parseFloat},{id:"magneticDamping",label:"Damping",stateKey:"magneticDamping",type:"range",min:.8,max:.999,step:.001,default:.998,format:e=>e.toFixed(3),parse:parseFloat},_a("magneticWarmupFrames")]},bubbles:{title:"Bubbles",icon:"",mode:"bubbles",defaultOpen:!1,controls:[{id:"bubblesRate",label:"Bubble Rate",stateKey:"bubblesSpawnRate",type:"range",min:1,max:20,step:1,default:16,format:e=>e+"",parse:e=>parseInt(e,10)},{id:"bubblesSpeed",label:"Rise Speed",stateKey:"bubblesRiseSpeed",type:"range",min:50,max:900,step:25,default:650,format:e=>e.toFixed(0),parse:parseFloat},{id:"bubblesWobble",label:"Wobble",stateKey:"bubblesWobble",type:"range",min:0,max:100,step:5,default:65,format:e=>e.toFixed(0),parse:parseFloat},{id:"bubblesVerticalExtent",label:"Vertical Extent",stateKey:"bubblesVerticalExtent",type:"range",min:.15,max:1,step:.05,default:.7,format:e=>e.toFixed(2),parse:parseFloat,hint:"Height of the bubble band around the logo (1 = full screen)."},{id:"bubblesDepthSpan",label:"Depth Span",stateKey:"bubblesDepthSpan",type:"range",min:.1,max:1,step:.05,default:.8,format:e=>e.toFixed(2),parse:parseFloat,hint:"Z range around the logo depth (1 = full depth)."},{id:"bubblesMax",label:"Max Bubbles",stateKey:"bubblesMaxCount",type:"range",min:50,max:300,step:10,default:150,format:e=>e+"",parse:e=>parseInt(e,10)},_a("bubblesWarmupFrames")]},tilt:{title:"Tilt",icon:"",mode:"tilt",defaultOpen:!1,controls:[{id:"tiltBallCount",label:"Particle Count",stateKey:"tiltBallCount",type:"range",min:100,max:500,step:10,default:300,format:e=>e+"",parse:e=>parseInt(e,10),reinitMode:!0},{id:"tiltMaxAngle",label:"Max Angle",stateKey:"tiltMaxAngle",type:"range",min:.5,max:10,step:.5,default:2,format:e=>e.toFixed(1)+"",parse:parseFloat},{id:"tiltLerpSpeed",label:"Smoothness",stateKey:"tiltLerpSpeed",type:"range",min:.01,max:.5,step:.01,default:.08,format:e=>e.toFixed(2),parse:parseFloat},{id:"tiltGlassMass",label:"Particle Mass",stateKey:"tiltGlassBallMass",type:"range",min:.02,max:.3,step:.01,default:.08,format:e=>e.toFixed(2)+"x",parse:parseFloat,reinitMode:!0},{id:"tiltFriction",label:"Friction",stateKey:"tiltFriction",type:"range",min:.002,max:.02,step:.001,default:.008,format:e=>e.toFixed(3),parse:parseFloat}]},kaleidoscope:{title:"Kaleidoscope",icon:"",mode:"kaleidoscope-3",defaultOpen:!1,controls:[{id:"kaleiBallCount",label:"Ball Count",stateKey:"kaleidoscope3BallCount",type:"range",min:12,max:300,step:3,default:150,format:e=>Math.round(e)+"",parse:e=>parseInt(e,10),reinitMode:!0},{id:"kaleiWedges",label:"Wedges",stateKey:"kaleidoscope3Wedges",type:"range",min:3,max:24,step:1,default:10,format:e=>Math.round(e)+"",parse:e=>parseInt(e,10)},{id:"kaleiMirror",label:"Mirror",type:"range",min:0,max:1,step:1,default:1,format:e=>e?"On":"Off",parse:e=>parseInt(e,10)},{id:"kaleiSpeed",label:"Speed",stateKey:"kaleidoscope3Speed",type:"range",min:.2,max:2,step:.05,default:1.2,format:e=>e.toFixed(2),parse:parseFloat},{id:"kaleiIdleDrift",label:"Idle Drift",stateKey:"kaleidoscopeIdleDrift",type:"range",min:0,max:.05,step:.002,default:.012,format:e=>(1e3*e).toFixed(0)+"",parse:parseFloat,hint:"Subtle movement when idle; respects prefers-reduced-motion."},{id:"kaleiDotSizeVh",label:"Dot Size (vh)",stateKey:"kaleidoscope3DotSizeVh",type:"range",min:.2,max:2.5,step:.05,default:1.05,format:e=>e.toFixed(2)+"vh",parse:parseFloat,reinitMode:!0},{id:"kaleiDotAreaMul",label:"Dot Area",stateKey:"kaleidoscope3DotAreaMul",type:"range",min:.3,max:1.5,step:.05,default:.75,format:e=>e.toFixed(2)+"",parse:parseFloat,reinitMode:!0},{id:"kaleiSpawnArea",label:"Spawn Density",stateKey:"kaleidoscope3SpawnAreaMul",type:"range",min:.2,max:2,step:.05,default:1.05,format:e=>e.toFixed(2)+"",parse:parseFloat,reinitMode:!0},{id:"kaleiSizeVar",label:"Size Variance",stateKey:"kaleidoscope3SizeVariance",type:"range",min:0,max:1,step:.05,default:.5,format:e=>(100*e).toFixed(0)+"%",parse:parseFloat,reinitMode:!0},_a("kaleidoscope3WarmupFrames")]},parallaxLinear:{title:"Parallax (Linear)",icon:"",mode:"parallax-linear",defaultOpen:!1,controls:[{id:"parallaxLinearPreset",label:"Preset",stateKey:"parallaxLinearPreset",type:"select",options:Object.keys(fo).map(e=>({value:e,label:fo[e].label})),default:"default",format:e=>fo[e]?.label||e,onChange(e){$a(e,!0)}},{id:"parallaxLinearDotSizeMul",label:"Dot Size",stateKey:"parallaxLinearDotSizeMul",type:"range",min:.2,max:6,step:.1,default:1.8,format:e=>e.toFixed(1)+"",parse:parseFloat,reinitMode:!0},{id:"sizeVariationParallaxLinear",label:"Size Variation",stateKey:"sizeVariationParallaxLinear",type:"range",min:0,max:1,step:.05,default:0,format:e=>e.toFixed(2),parse:parseFloat,reinitMode:!0},{id:"parallaxLinearGridX",label:"Grid X (Cols)",stateKey:"parallaxLinearGridX",type:"range",min:3,max:40,step:1,default:14,format:e=>Math.round(e)+"",parse:e=>parseInt(e,10),reinitMode:!0},{id:"parallaxLinearGridY",label:"Grid Y (Rows)",stateKey:"parallaxLinearGridY",type:"range",min:3,max:40,step:1,default:10,format:e=>Math.round(e)+"",parse:e=>parseInt(e,10),reinitMode:!0},{id:"parallaxLinearGridZ",label:"Grid Z (Layers)",stateKey:"parallaxLinearGridZ",type:"range",min:2,max:20,step:1,default:7,format:e=>Math.round(e)+"",parse:e=>parseInt(e,10),reinitMode:!0},{id:"parallaxLinearSpanX",label:"Span X",stateKey:"parallaxLinearSpanX",type:"range",min:.2,max:8,step:.05,default:5,format:e=>e.toFixed(2)+"",parse:parseFloat,reinitMode:!0,hint:"World-space width as a multiple of the viewport width. Use >1 to fill edge-to-edge."},{id:"parallaxLinearSpanY",label:"Span Y",stateKey:"parallaxLinearSpanY",type:"range",min:.2,max:3,step:.05,default:2.6,format:e=>e.toFixed(2)+"",parse:parseFloat,reinitMode:!0,hint:"World-space height as a multiple of the viewport height."},{id:"parallaxLinearZNear",label:"Z Near",stateKey:"parallaxLinearZNear",type:"range",min:10,max:1200,step:10,default:50,format:e=>Math.round(e)+"",parse:e=>parseInt(e,10),reinitMode:!0},{id:"parallaxLinearZFar",label:"Z Far",stateKey:"parallaxLinearZFar",type:"range",min:50,max:3e3,step:25,default:900,format:e=>Math.round(e)+"",parse:e=>parseInt(e,10),reinitMode:!0},{id:"parallaxLinearFocalLength",label:"Focal Length",stateKey:"parallaxLinearFocalLength",type:"range",min:80,max:2e3,step:10,default:420,format:e=>Math.round(e)+"px",parse:e=>parseInt(e,10)},{id:"parallaxLinearParallaxStrength",label:"Parallax Strength",stateKey:"parallaxLinearParallaxStrength",type:"range",min:0,max:2e3,step:10,default:260,format:e=>Math.round(e)+"",parse:e=>parseInt(e,10)},{id:"parallaxLinearMouseEasing",label:"Mouse Smoothing",stateKey:"parallaxLinearMouseEasing",type:"range",min:.5,max:50,step:.5,default:20,format:e=>e.toFixed(1),parse:parseFloat,hint:"Higher = snappier, lower = smoother camera pan (20 = near-instant)"},_a("parallaxLinearWarmupFrames")]},parallaxFloat:{title:"Parallax (Float)",icon:"",mode:"parallax-float",defaultOpen:!1,controls:[{id:"parallaxFloatRandomize",label:"Randomness",stateKey:"parallaxFloatRandomize",type:"range",min:0,max:100,step:1,default:50,format:e=>Math.round(e)+"%",parse:e=>parseInt(e,10),reinitMode:!0,hint:"0% = perfect grid, 100% = fully random positions"},{id:"parallaxFloatLevitationAmp",label:"Levitation Amplitude",stateKey:"parallaxFloatLevitationAmp",type:"range",min:0,max:100,step:1,default:25,format:e=>Math.round(e)+"px",parse:e=>parseInt(e,10),reinitMode:!0,hint:"How far particles drift during levitation"},{id:"parallaxFloatLevitationSpeed",label:"Levitation Speed",stateKey:"parallaxFloatLevitationSpeed",type:"range",min:.01,max:1,step:.01,default:.25,format:e=>e.toFixed(2),parse:parseFloat,reinitMode:!0,hint:"How fast particles oscillate"},{id:"parallaxFloatMouseEasing",label:"Mouse Smoothing",stateKey:"parallaxFloatMouseEasing",type:"range",min:.5,max:20,step:.5,default:5,format:e=>e.toFixed(1),parse:parseFloat,hint:"Higher = snappier, lower = smoother camera pan"},{id:"parallaxFloatDotSizeMul",label:"Dot Size",stateKey:"parallaxFloatDotSizeMul",type:"range",min:.2,max:6,step:.1,default:1.4,format:e=>e.toFixed(1)+"",parse:parseFloat,reinitMode:!0},{id:"sizeVariationParallaxFloat",label:"Size Variation",stateKey:"sizeVariationParallaxFloat",type:"range",min:0,max:1,step:.05,default:0,format:e=>e.toFixed(2),parse:parseFloat,reinitMode:!0},{id:"parallaxFloatGridX",label:"Grid X (Cols)",stateKey:"parallaxFloatGridX",type:"range",min:3,max:40,step:1,default:15,format:e=>Math.round(e)+"",parse:e=>parseInt(e,10),reinitMode:!0},{id:"parallaxFloatGridY",label:"Grid Y (Rows)",stateKey:"parallaxFloatGridY",type:"range",min:3,max:40,step:1,default:10,format:e=>Math.round(e)+"",parse:e=>parseInt(e,10),reinitMode:!0},{id:"parallaxFloatGridZ",label:"Grid Z (Layers)",stateKey:"parallaxFloatGridZ",type:"range",min:2,max:20,step:1,default:12,format:e=>Math.round(e)+"",parse:e=>parseInt(e,10),reinitMode:!0},{id:"parallaxFloatSpanX",label:"Span X",stateKey:"parallaxFloatSpanX",type:"range",min:.2,max:10,step:.1,default:4,format:e=>e.toFixed(1)+"",parse:parseFloat,reinitMode:!0,hint:"World-space width as a multiple of the viewport width"},{id:"parallaxFloatSpanY",label:"Span Y",stateKey:"parallaxFloatSpanY",type:"range",min:.2,max:10,step:.1,default:3,format:e=>e.toFixed(1)+"",parse:parseFloat,reinitMode:!0,hint:"World-space height as a multiple of the viewport height"},{id:"parallaxFloatZNear",label:"Z Near",stateKey:"parallaxFloatZNear",type:"range",min:10,max:1200,step:10,default:100,format:e=>Math.round(e)+"",parse:e=>parseInt(e,10),reinitMode:!0},{id:"parallaxFloatZFar",label:"Z Far",stateKey:"parallaxFloatZFar",type:"range",min:200,max:4e3,step:50,default:2500,format:e=>Math.round(e)+"",parse:e=>parseInt(e,10),reinitMode:!0},{id:"parallaxFloatFocalLength",label:"Focal Length",stateKey:"parallaxFloatFocalLength",type:"range",min:80,max:2e3,step:10,default:500,format:e=>Math.round(e)+"px",parse:e=>parseInt(e,10)},{id:"parallaxFloatParallaxStrength",label:"Parallax Strength",stateKey:"parallaxFloatParallaxStrength",type:"range",min:0,max:2e3,step:10,default:350,format:e=>Math.round(e)+"",parse:e=>parseInt(e,10)},_a("parallaxFloatWarmupFrames")]},starfield3d:{title:"3D Starfield",icon:"",mode:"starfield-3d",defaultOpen:!1,controls:[{id:"starfieldCount",label:"Star Count",stateKey:"starfieldCount",type:"range",min:20,max:320,step:2,default:150,format:e=>Math.round(e)+"",parse:e=>parseInt(e,10),reinitMode:!0},{id:"starfieldSpanX",label:"Span X",stateKey:"starfieldSpanX",type:"range",min:.4,max:3.5,step:.05,default:2.45,format:e=>e.toFixed(2)+"",parse:parseFloat,reinitMode:!0},{id:"starfieldSpanY",label:"Span Y",stateKey:"starfieldSpanY",type:"range",min:.4,max:3.5,step:.05,default:2.05,format:e=>e.toFixed(2)+"",parse:parseFloat,reinitMode:!0},{id:"starfieldZNear",label:"Z Near",stateKey:"starfieldZNear",type:"range",min:40,max:800,step:10,default:70,format:e=>Math.round(e)+"",parse:e=>parseInt(e,10),reinitMode:!0},{id:"starfieldZFar",label:"Z Far",stateKey:"starfieldZFar",type:"range",min:400,max:4e3,step:50,default:4e3,format:e=>Math.round(e)+"",parse:e=>parseInt(e,10),reinitMode:!0},{id:"starfieldFocalLength",label:"Focal Length",stateKey:"starfieldFocalLength",type:"range",min:120,max:2e3,step:10,default:310,format:e=>Math.round(e)+"px",parse:e=>parseInt(e,10)},{id:"starfieldParallaxStrength",label:"Parallax Strength",stateKey:"starfieldParallaxStrength",type:"range",min:0,max:1200,step:10,default:320,format:e=>Math.round(e)+"",parse:e=>parseInt(e,10)},{id:"starfieldSpeed",label:"Flow Speed",stateKey:"starfieldSpeed",type:"range",min:60,max:1600,step:10,default:390,format:e=>Math.round(e)+"px/s",parse:e=>parseInt(e,10)},{id:"starfieldDotSizeMul",label:"Dot Size",stateKey:"starfieldDotSizeMul",type:"range",min:.2,max:4,step:.05,default:.35,format:e=>e.toFixed(2)+"",parse:parseFloat},{id:"starfieldIdleJitter",label:"Idle Drift",stateKey:"starfieldIdleJitter",type:"range",min:0,max:20,step:.5,default:20,format:e=>e.toFixed(1)+"px",parse:parseFloat,hint:"Subtle twinkle when idle; disabled for reduced-motion."},{id:"starfieldFadeDuration",label:"Fade Duration",stateKey:"starfieldFadeDuration",type:"range",min:0,max:3,step:.1,default:.5,format:e=>e.toFixed(1)+"s",parse:parseFloat,hint:"Duration of fade in/out when stars appear and disappear."},_a("starfield3dWarmupFrames")]},elasticCenter:{title:"Elastic Center",icon:"",mode:"elastic-center",defaultOpen:!1,controls:[{id:"elasticCenterRingCount",label:"Ring Count",stateKey:"elasticCenterRingCount",type:"range",min:2,max:20,step:1,default:10,format:e=>e+"",parse:e=>parseInt(e,10),reinitMode:!0,hint:"Number of concentric rings (more rings = more balls)"},{id:"elasticCenterMassMultiplier",label:"Mass Multiplier",stateKey:"elasticCenterMassMultiplier",type:"range",min:.5,max:5,step:.1,default:2,format:e=>e.toFixed(1)+"",parse:parseFloat,hint:"Mass of individual dots"},{id:"elasticCenterElasticStrength",label:"Elastic Strength",stateKey:"elasticCenterElasticStrength",type:"range",min:0,max:15e3,step:250,default:2e3,format:e=>e.toFixed(0)+"px/s",parse:parseFloat,hint:"Force pulling dots back to center position (0 = no elastic force, circle moves freely)"},{id:"elasticCenterMouseRepelStrength",label:"Mouse Repel Strength",stateKey:"elasticCenterMouseRepelStrength",type:"range",min:3e3,max:25e3,step:500,default:12e3,format:e=>e.toFixed(0)+"px/s",parse:parseFloat,hint:"Force pushing dots away from mouse cursor"},{id:"elasticCenterMouseRadius",label:"Mouse Influence Radius",stateKey:"elasticCenterMouseRadius",type:"range",min:50,max:400,step:10,default:200,format:e=>e.toFixed(0)+"px",parse:parseFloat,hint:"Distance from cursor where mouse affects dots"},{id:"elasticCenterDamping",label:"Damping",stateKey:"elasticCenterDamping",type:"range",min:.85,max:.99,step:.01,default:.94,format:e=>e.toFixed(2),parse:parseFloat,hint:"Velocity damping for stability (higher = less damping)"},_a("elasticCenterWarmupFrames")]},particleFountain:{title:"Particle Fountain",icon:"",mode:"particle-fountain",defaultOpen:!1,controls:[{id:"particleFountainEmissionRate",label:"Emission Rate",stateKey:"particleFountainEmissionRate",type:"range",min:5,max:100,step:1,default:29,format:e=>e.toFixed(0)+" particles/s",parse:e=>parseInt(e,10),hint:"Number of particles emitted per second"},{id:"particleFountainInitialVelocity",label:"Initial Velocity",stateKey:"particleFountainInitialVelocity",type:"range",min:200,max:1e4,step:100,default:4700,format:e=>e.toFixed(0)+"px/s",parse:e=>parseInt(e,10),hint:"Initial upward velocity of particles"},{id:"particleFountainSpreadAngle",label:"Spread Angle",stateKey:"particleFountainSpreadAngle",type:"range",min:10,max:120,step:5,default:20,format:e=>e.toFixed(0)+"",parse:e=>parseInt(e,10),hint:"How wide the fountain spreads (degrees)"},{id:"particleFountainWaterDrag",label:"Water Drag",stateKey:"particleFountainWaterDrag",type:"range",min:.01,max:.2,step:.01,default:.02,format:e=>e.toFixed(2),parse:parseFloat,hint:"Water-like drag for smooth fluid motion (lower = more natural water, higher = more resistance)"},{id:"particleFountainGravityMultiplier",label:"Gravity",stateKey:"particleFountainGravityMultiplier",type:"range",min:0,max:2,step:.1,default:1.7,format:e=>e.toFixed(1)+"",parse:parseFloat,hint:"Gravity strength (particles fall after rising, 0 = no gravity)"},{id:"particleFountainUpwardForce",label:"Upward Force",stateKey:"particleFountainUpwardForce",type:"range",min:0,max:800,step:50,default:300,format:e=>e.toFixed(0)+"px/s",parse:e=>parseInt(e,10),hint:"Optional upward force (buoyancy), 0 = disabled"},{id:"particleFountainMaxParticles",label:"Max Particles",stateKey:"particleFountainMaxParticles",type:"range",min:20,max:300,step:10,default:230,format:e=>e.toFixed(0)+" particles",parse:e=>parseInt(e,10),hint:"Maximum active particles"},{id:"particleFountainLifetime",label:"Lifetime",stateKey:"particleFountainLifetime",type:"range",min:1,max:30,step:.5,default:8,format:e=>e.toFixed(1)+"s",parse:parseFloat,hint:"How long particles live before fading out (2s fade animation)"},{id:"particleFountainMouseRepelStrength",label:"Mouse Repel Strength",stateKey:"particleFountainMouseRepelStrength",type:"range",min:1e4,max:1e5,step:5e3,default:5e4,format:e=>e.toFixed(0)+"px/s",parse:e=>parseInt(e,10),hint:"Force pushing particles away from mouse cursor"},{id:"particleFountainMouseRepelRadiusVw",label:"Mouse Repel Radius",stateKey:"particleFountainMouseRepelRadiusVw",type:"range",min:1,max:20,step:.5,default:5,format:e=>e.toFixed(1)+"vw",parse:parseFloat,hint:"Radius of mouse repulsion (viewport width percentage)",onChange(){Promise.resolve().then(()=>yo).then(({applyLayoutFromVwToPx:e})=>{e()}).catch(()=>{})}}]},sphere3d:{title:"3D Sphere",icon:"",mode:"3d-sphere",defaultOpen:!1,controls:[{id:"sphere3dRadiusVw",label:"Radius",stateKey:"sphere3dRadiusVw",type:"range",min:5,max:40,step:.5,default:18,format:e=>e.toFixed(1)+"vw",parse:parseFloat,reinitMode:!0},{id:"sphere3dDensity",label:"Point Count",stateKey:"sphere3dDensity",type:"range",min:30,max:600,step:10,default:140,format:e=>Math.round(e)+"",parse:e=>parseInt(e,10),reinitMode:!0},{id:"sphere3dFocalLength",label:"Focal Length",stateKey:"sphere3dFocalLength",type:"range",min:80,max:2e3,step:10,default:600,format:e=>Math.round(e)+"px",parse:e=>parseInt(e,10)},{id:"sphere3dDotSizeMul",label:"Dot Size",stateKey:"sphere3dDotSizeMul",type:"range",min:.2,max:4,step:.05,default:1.5,format:e=>e.toFixed(2)+"",parse:parseFloat},{id:"sphere3dIdleSpeed",label:"Idle Rotation",stateKey:"sphere3dIdleSpeed",type:"range",min:0,max:1,step:.02,default:.15,format:e=>e.toFixed(2)+" rad/s",parse:parseFloat},{id:"sphere3dTumbleSpeed",label:"Spin Sensitivity",stateKey:"sphere3dTumbleSpeed",type:"range",min:0,max:10,step:.1,default:2.5,format:e=>e.toFixed(1),parse:parseFloat,hint:"How much dragging the mouse over the sphere spins it. Higher = more sensitive."},{id:"sphere3dTumbleDamping",label:"Tumble Damping",stateKey:"sphere3dTumbleDamping",type:"range",min:.8,max:.99,step:.005,default:.94,format:e=>e.toFixed(3),parse:parseFloat},_a("sphere3dWarmupFrames")]},cube3d:{title:"3D Cube",icon:"",mode:"3d-cube",defaultOpen:!1,controls:[{id:"cube3dSizeVw",label:"Size",stateKey:"cube3dSizeVw",type:"range",min:10,max:50,step:.5,default:50,format:e=>e.toFixed(1)+"vw",parse:parseFloat,reinitMode:!0},{id:"cube3dEdgeDensity",label:"Edge Density",stateKey:"cube3dEdgeDensity",type:"range",min:2,max:30,step:1,default:8,format:e=>Math.round(e)+"",parse:e=>parseInt(e,10),reinitMode:!0},{id:"cube3dFaceGrid",label:"Face Grid",stateKey:"cube3dFaceGrid",type:"range",min:0,max:10,step:1,default:0,format:e=>Math.round(e)+"",parse:e=>parseInt(e,10),reinitMode:!0,hint:"0 = edges only. >0 adds face lattice points."},{id:"cube3dIdleSpeed",label:"Idle Rotation",stateKey:"cube3dIdleSpeed",type:"range",min:0,max:1,step:.02,default:.2,format:e=>e.toFixed(2)+" rad/s",parse:parseFloat},{id:"cube3dCursorInfluence",label:"Cursor Influence",stateKey:"cube3dCursorInfluence",type:"range",min:0,max:4,step:.05,default:1.5,format:e=>e.toFixed(2),parse:parseFloat},{id:"cube3dTumbleSpeed",label:"Tumble Speed",stateKey:"cube3dTumbleSpeed",type:"range",min:0,max:10,step:.1,default:3,format:e=>e.toFixed(1),parse:parseFloat},{id:"cube3dTumbleDamping",label:"Tumble Damping",stateKey:"cube3dTumbleDamping",type:"range",min:.8,max:.99,step:.005,default:.95,format:e=>e.toFixed(3),parse:parseFloat},{id:"cube3dFocalLength",label:"Focal Length",stateKey:"cube3dFocalLength",type:"range",min:80,max:2e3,step:10,default:500,format:e=>Math.round(e)+"px",parse:e=>parseInt(e,10)},{id:"cube3dDotSizeMul",label:"Dot Size",stateKey:"cube3dDotSizeMul",type:"range",min:.2,max:4,step:.05,default:1.5,format:e=>e.toFixed(2)+"",parse:parseFloat},{id:"cube3dFogStart",label:"Fog Start",stateKey:"cube3dFogStart",type:"range",min:0,max:1,step:.05,default:.5,format:e=>Math.round(100*e)+"%",parse:parseFloat},{id:"cube3dFogMin",label:"Fog Min Opacity",stateKey:"cube3dFogMin",type:"range",min:0,max:1,step:.05,default:.1,format:e=>Math.round(100*e)+"%",parse:parseFloat},_a("cube3dWarmupFrames")]},parallaxLinear:{title:"Parallax (Linear)",icon:"",mode:"parallax-linear",defaultOpen:!1,controls:[{id:"parallaxLinearGridX",label:"Grid X",stateKey:"parallaxLinearGridX",type:"range",min:4,max:30,step:1,default:14,format:e=>Math.round(e)+"",parse:e=>parseInt(e,10),reinitMode:!0},{id:"parallaxLinearGridY",label:"Grid Y",stateKey:"parallaxLinearGridY",type:"range",min:4,max:30,step:1,default:10,format:e=>Math.round(e)+"",parse:e=>parseInt(e,10),reinitMode:!0},{id:"parallaxLinearGridZ",label:"Grid Z (Depth)",stateKey:"parallaxLinearGridZ",type:"range",min:2,max:15,step:1,default:7,format:e=>Math.round(e)+"",parse:e=>parseInt(e,10),reinitMode:!0},{type:"divider",label:"Spread & Depth"},{id:"parallaxLinearSpanX",label:"Span X",stateKey:"parallaxLinearSpanX",type:"range",min:1,max:12,step:.1,default:5.4,format:e=>e.toFixed(1)+"",parse:parseFloat,reinitMode:!0,hint:"How far the grid extends horizontally"},{id:"parallaxLinearSpanY",label:"Span Y",stateKey:"parallaxLinearSpanY",type:"range",min:1,max:12,step:.1,default:5.4,format:e=>e.toFixed(1)+"",parse:parseFloat,reinitMode:!0,hint:"How far the grid extends vertically"},{id:"parallaxLinearZNear",label:"Z Near",stateKey:"parallaxLinearZNear",type:"range",min:10,max:200,step:5,default:50,format:e=>Math.round(e)+"px",parse:e=>parseInt(e,10),reinitMode:!0},{id:"parallaxLinearZFar",label:"Z Far",stateKey:"parallaxLinearZFar",type:"range",min:200,max:2e3,step:50,default:800,format:e=>Math.round(e)+"px",parse:e=>parseInt(e,10),reinitMode:!0},{type:"divider",label:"Camera & Mouse"},{id:"parallaxLinearFocalLength",label:"Focal Length",stateKey:"parallaxLinearFocalLength",type:"range",min:100,max:1e3,step:10,default:420,format:e=>Math.round(e)+"px",parse:e=>parseInt(e,10)},{id:"parallaxLinearParallaxStrength",label:"Parallax Strength",stateKey:"parallaxLinearParallaxStrength",type:"range",min:0,max:500,step:10,default:120,format:e=>Math.round(e)+"px",parse:e=>parseInt(e,10),hint:"How much the view shifts with mouse movement"},{id:"parallaxLinearMouseEasing",label:"Mouse Smoothing",stateKey:"parallaxLinearMouseEasing",type:"range",min:.5,max:15,step:.5,default:4,format:e=>e.toFixed(1),parse:parseFloat,hint:"Lower = smoother/slower, higher = snappier"},{type:"divider",label:"Appearance"},{id:"parallaxLinearDotSizeMul",label:"Dot Size",stateKey:"parallaxLinearDotSizeMul",type:"range",min:.5,max:4,step:.1,default:1.8,format:e=>e.toFixed(1)+"",parse:parseFloat},_a("parallaxLinearWarmupFrames")]},parallaxFloat:{title:"Parallax (Float)",icon:"",mode:"parallax-float",defaultOpen:!1,controls:[{id:"parallaxFloatRandomize",label:"Randomize",stateKey:"parallaxFloatRandomize",type:"range",min:0,max:1,step:.05,default:.5,format:e=>Math.round(100*e)+"%",parse:parseFloat,reinitMode:!0,hint:"0 = perfect grid, 1 = fully scattered"},{type:"divider",label:"Levitation"},{id:"parallaxFloatLevitationAmp",label:"Amplitude",stateKey:"parallaxFloatLevitationAmp",type:"range",min:0,max:60,step:2,default:20,format:e=>Math.round(e)+"px",parse:e=>parseInt(e,10),hint:"How far particles drift"},{id:"parallaxFloatLevitationSpeed",label:"Speed",stateKey:"parallaxFloatLevitationSpeed",type:"range",min:.05,max:.5,step:.02,default:.2,format:e=>e.toFixed(2)+" Hz",parse:parseFloat,hint:"How fast particles drift"},{type:"divider",label:"Mouse"},{id:"parallaxFloatParallaxStrength",label:"Parallax Strength",stateKey:"parallaxFloatParallaxStrength",type:"range",min:0,max:500,step:10,default:120,format:e=>Math.round(e)+"px",parse:e=>parseInt(e,10),hint:"How much the view shifts with mouse"},{id:"parallaxFloatMouseEasing",label:"Mouse Smoothing",stateKey:"parallaxFloatMouseEasing",type:"range",min:.5,max:15,step:.5,default:4,format:e=>e.toFixed(1),parse:parseFloat,hint:"Lower = smoother/slower, higher = snappier"},{type:"divider",label:"Appearance"},{id:"parallaxFloatDotSizeMul",label:"Dot Size",stateKey:"parallaxFloatDotSizeMul",type:"range",min:.5,max:4,step:.1,default:1.8,format:e=>e.toFixed(1)+"",parse:parseFloat},_a("parallaxFloatWarmupFrames")]},entrance:{title:"Entrance",icon:"",defaultOpen:!1,controls:[{id:"entranceEnabled",label:"Enabled",stateKey:"entranceEnabled",type:"checkbox",default:!0,format:e=>e?"On":"Off",parse:e=>!!e,hint:"Enable dramatic entrance animation (browser default  wall-state)",onChange(){"undefined"!=typeof window&&setTimeout(()=>window.location.reload(),300)}},{id:"entranceWallTransitionDelay",label:"Wall Transition Delay",stateKey:"entranceWallTransitionDelay",type:"range",min:0,max:2e3,step:50,default:300,format:e=>Math.round(e)+"ms",parse:e=>parseInt(e,10),hint:"Delay before wall background transition starts"},{id:"entranceWallTransitionDuration",label:"Wall Growth Duration",stateKey:"entranceWallTransitionDuration",type:"range",min:200,max:2e3,step:50,default:800,format:e=>Math.round(e)+"ms",parse:e=>parseInt(e,10),hint:"Duration of wall scaling down into viewport animation"},{id:"entranceWallInitialScale",label:"Initial Scale",stateKey:"entranceWallInitialScale",type:"range",min:1.05,max:1.5,step:.05,default:1.1,format:e=>e.toFixed(2),parse:e=>parseFloat(e),hint:"Starting scale (wall starts slightly larger, scales down to 1.0)"},{id:"entranceWallEasing",label:"Wall Growth Easing",stateKey:"entranceWallEasing",type:"select",options:[{value:"cubic-bezier(0.16, 1, 0.3, 1)",label:"Organic (default)"},{value:"ease-out",label:"Ease Out"},{value:"ease-in-out",label:"Ease In Out"},{value:"cubic-bezier(0.34, 1.56, 0.64, 1)",label:"Bounce"},{value:"cubic-bezier(0.68, -0.55, 0.265, 1.55)",label:"Overshoot"}],default:"cubic-bezier(0.16, 1, 0.3, 1)",format:e=>e+"",parse:e=>e+"",hint:"Easing function for wall growth animation"},{id:"entranceElementDuration",label:"Element Duration",stateKey:"entranceElementDuration",type:"range",min:100,max:1e3,step:50,default:800,format:e=>Math.round(e)+"ms",parse:e=>parseInt(e,10),hint:"Duration for individual element animations"},{id:"entranceElementScaleStart",label:"Element Scale Start",stateKey:"entranceElementScaleStart",type:"range",min:.5,max:1,step:.01,default:.95,format:e=>e.toFixed(2),parse:e=>parseFloat(e),hint:"Initial scale for elements (0-1)"},{id:"entranceElementTranslateZStart",label:"Element Z Start",stateKey:"entranceElementTranslateZStart",type:"range",min:-100,max:0,step:5,default:-20,format:e=>Math.round(e)+"px",parse:e=>parseInt(e,10),hint:"Initial z-axis position (negative = back in 3D space)"},{id:"entrancePerspectiveLandscape",label:"Perspective (Landscape)",stateKey:"entrancePerspectiveLandscape",type:"range",min:500,max:3e3,step:50,default:1200,format:e=>Math.round(e)+"px",parse:e=>parseInt(e,10),hint:"3D perspective for landscape aspect ratio",onChange(){Promise.resolve().then(()=>rd).then(({applyPerspectiveCSS:e})=>{e()}).catch(()=>{})}},{id:"entrancePerspectiveSquare",label:"Perspective (Square)",stateKey:"entrancePerspectiveSquare",type:"range",min:500,max:3e3,step:50,default:1e3,format:e=>Math.round(e)+"px",parse:e=>parseInt(e,10),hint:"3D perspective for square aspect ratio",onChange(){Promise.resolve().then(()=>rd).then(({applyPerspectiveCSS:e})=>{e()}).catch(()=>{})}},{id:"entrancePerspectivePortrait",label:"Perspective (Portrait)",stateKey:"entrancePerspectivePortrait",type:"range",min:500,max:3e3,step:50,default:800,format:e=>Math.round(e)+"px",parse:e=>parseInt(e,10),hint:"3D perspective for portrait aspect ratio",onChange(){Promise.resolve().then(()=>rd).then(({applyPerspectiveCSS:e})=>{e()}).catch(()=>{})}},{id:"contentFadeInDelay",label:"Content Fade-In Delay",stateKey:"contentFadeInDelay",type:"range",min:0,max:2e3,step:50,default:500,format:e=>Math.round(e)+"ms",parse:e=>parseInt(e,10),hint:"Delay before content fade-in animation starts (excludes background/wall color)",onChange(){"undefined"!=typeof window&&setTimeout(()=>window.location.reload(),300)}},{id:"contentFadeInDuration",label:"Content Fade-In Duration",stateKey:"contentFadeInDuration",type:"range",min:100,max:3e3,step:50,default:1e3,format:e=>Math.round(e)+"ms",parse:e=>parseInt(e,10),hint:"Duration of content fade-in animation (excludes background/wall color)",onChange(){"undefined"!=typeof window&&setTimeout(()=>window.location.reload(),300)}}]}},Ps={shine:"Shine",shadow:"Shadow",innerGlow:"Inner Glow",innerShadow:"Inner Shadow",micro:"Micro-details",geometry:"Geometry"},Ws={shine:"Continuous border light around the edge (bright, dim, shadow points).",shadow:"Inner or outward shadow (depth, overhang, cast shadow).",innerGlow:"Soft top light inside the inner wall.",innerShadow:"Inner shadow behind the wall (creates depth).",micro:"Ambient occlusion and specular highlight on the edge.",geometry:"Corner roundness and shape."};var Ks=Object.freeze({__proto__:null,CONTROL_SECTIONS:Is,MASTER_GROUPS:Ds,applyParallaxLinearPreset:$a,bindRegisteredControls:tn,generateColorTemplateSectionHTML:Xa,generateMasterSectionsHTML:Qa,generateModeSpecificSectionsHTML:en,generateModeSwitcherHTML:Ja,generateThemeSectionHTML:Ua,generateWallStackDiagramHTML:Ya,getAllControls:Ha,isControlVisible:za,setupWallSectionTabs:nn,syncSlidersToState:an,syncWallPanelTabsToTheme:on,updateWallShadowCSS:Ea});const Ts="theme-preference-v2",Es="theme-preference";let Bs="auto",As="light",Gs=!1;var Rs=Object.freeze({__proto__:null,getCurrentTheme:()=>Bs,initializeDarkMode:ln,setTheme:rn,toggleDarkMode:sn});let zs=null;const $s="abs_nav_state",_s="abs_nav_ts";"undefined"!=typeof window&&(window.addEventListener("pagereveal",e=>{e.viewTransition&&(Vs=!0,console.log(" View Transition detected on pagereveal"),document.documentElement.classList.remove("entrance-pre-transition","entrance-transitioning"),document.documentElement.classList.add("entrance-complete"),["#app-frame","#abs-scene","#brand-logo","#main-links"].forEach(e=>{const t=document.querySelector(e);t&&(t.style.opacity="1",t.style.visibility="visible")}),document.querySelectorAll("#main-links .footer_link").forEach(e=>{e.style.opacity="1",e.style.transform="translateY(0) scale(1)",e.style.filter="blur(0)"}))}),window.addEventListener("pageswap",()=>{bn()}),window.addEventListener("pagehide",()=>{bn()}));const Ns={INTERNAL:"internal",OPEN_CV_MODAL:"open_cv",OPEN_PORTFOLIO_MODAL:"open_portfolio",OPEN_CONTACT_MODAL:"open_contact"};let Vs=!1;try{const e=sessionStorage.getItem($s),t=parseInt(sessionStorage.getItem(_s)||"0",10),a=5e3>Date.now()-t,n="function"==typeof document.startViewTransition;e&&a&&n&&(Vs=!0,console.log(" View Transition detected at module load"))}catch(dd){}let Hs=!1;var js=Object.freeze({__proto__:null,NAV_STATES:Ns,didViewTransitionRun:()=>Vs,getModalToAutoOpen(){try{const e=sessionStorage.getItem($s);if(e===Ns.OPEN_CV_MODAL)return"cv";if(e===Ns.OPEN_PORTFOLIO_MODAL)return"portfolio";if(e===Ns.OPEN_CONTACT_MODAL)return"contact"}catch(dd){}return null},getNavigationState:vn,initSpeculativePrefetch(){function e(e){const a=e.href||e.dataset.href;if(!a||t.has(a))return;if(!a.endsWith(".html")&&!a.includes("/"))return;const n=setTimeout(()=>{Sn(a),t.add(a)},100),o=()=>{clearTimeout(n),e.removeEventListener("mouseleave",o),e.removeEventListener("touchend",o),e.removeEventListener("blur",o)};e.addEventListener("mouseleave",o,{once:!0}),e.addEventListener("touchend",o,{once:!0}),e.addEventListener("blur",o,{once:!0})}const t=new Set,a=navigator.connection;a?.saveData?console.log(" Data saver enabled, skipping speculative prefetch"):(document.addEventListener("mouseenter",t=>{try{if(!t.target||"function"!=typeof t.target.closest)return;const a=t.target.closest("a[href], [data-href], [data-transition]");a&&e(a)}catch(a){console.error("Prefetch mouseenter error:",a)}},{capture:!0}),document.addEventListener("focusin",t=>{try{if(!t.target||"function"!=typeof t.target.closest)return;const a=t.target.closest("a[href], [data-href], [data-transition]");a&&e(a)}catch(a){console.error("Prefetch focusin error:",a)}}),document.addEventListener("touchstart",e=>{try{if(!e.target||"function"!=typeof e.target.closest)return;const a=e.target.closest("a[href], [data-href], [data-transition]");if(a){const e=a.href||a.dataset.href;e&&!t.has(e)&&(Sn(e),t.add(e))}}catch(a){console.error("Prefetch touchstart error:",a)}},{passive:!0}),console.log(" Speculative prefetch initialized"))},isBackForwardNavigation:wn,navigateWithTransition:xn,prefetchPage:Sn,resetTransitionState:Mn,setNavigationState:yn,setupPrefetchOnHover:kn,shouldSkipWallAnimation:()=>null!==vn()||wn(),supportsViewTransitions:gn});const qs=1700,Zs='<i class="ti ti-volume-off" aria-hidden="true"></i>';let Ys=null;const Us=new Map([["apple music",'<i class="ti ti-brand-apple" aria-hidden="true"></i>'],["instagram",'<i class="ti ti-brand-instagram" aria-hidden="true"></i>'],["linkedin",'<i class="ti ti-brand-linkedin" aria-hidden="true"></i>'],["x",'<i class="ti ti-brand-x" aria-hidden="true"></i>']]);let Xs=!1;const Qs="abs-link-hovering";let Js=null,ed=null,td=!1,ad=!1,nd=null;const od=['1em "Geist"','1em "Geist Mono"','1em "Sarina"','1em "tabler-icons"'],id=.2;var rd=Object.freeze({__proto__:null,applyAspectRatioClass:eo,applyPerspectiveCSS:to,detectAspectRatioCategory:Jn,async orchestrateEntrance(e={}){const t=b(),a=!!e.skipWallAnimation,n=!!e.skipEntranceAnimation,o=e.wallContent||[],i=e.centralContent||[],r=e.reducedMotion??!!window.matchMedia?.("(prefers-reduced-motion: reduce)")?.matches;if(eo(),to(),e.waitForFonts&&await e.waitForFonts(),n)return document.documentElement.classList.remove("entrance-pre-transition","entrance-transitioning"),document.documentElement.classList.add("entrance-complete"),io(),void console.log(" Entrance skipped (View Transition handled animation)");if(r)return void(()=>{const e=document.getElementById("app-frame"),t=document.getElementById("brand-logo"),a=document.getElementById("main-links"),n=a?Array.from(a.querySelectorAll(".footer_link")):[],o=document.documentElement;o.classList.remove("entrance-pre-transition","entrance-transitioning"),o.classList.add("entrance-complete");const i=[e,t,a,...n].filter(Boolean);i.forEach(e=>{e.style.transition="opacity 200ms ease-out",e.style.opacity="0",e.style.visibility="visible"}),requestAnimationFrame(()=>{i.forEach(e=>{e.style.opacity="1"}),setTimeout(()=>{i.forEach(e=>{e.style.removeProperty("transition"),e.style.removeProperty("opacity"),e.style.removeProperty("filter"),e.style.removeProperty("transform")});const e=document.getElementById("fade-blocking");e&&e.remove()},250)})})();a?(document.documentElement.classList.remove("entrance-pre-transition","entrance-transitioning"),document.documentElement.classList.add("entrance-complete")):ao(),a||no({wallContent:o});const l=t.entranceElementEasing??"cubic-bezier(0.16, 1, 0.3, 1)",s=t.contentFadeInDelay??500,d=t.contentFadeInDuration??1e3,c=t.entranceLateElementDuration??500,u=document.getElementById("abs-scene");if(u){const e=document.getElementById("fade-blocking");e&&e.remove(),u.style.opacity="0",u.style.visibility="visible",u.style.willChange="opacity",setTimeout(()=>{if("function"==typeof u.animate){const e=u.animate([{opacity:0},{opacity:1}],{duration:d,easing:l,fill:"forwards"});e.addEventListener("finish",()=>{u.style.opacity="1",u.style.willChange="auto"}),e.addEventListener("cancel",()=>{u.style.opacity="1",u.style.willChange="auto"})}else u.style.transition=`opacity ${d}ms ${l}`,requestAnimationFrame(()=>{u.style.opacity="1"})},s)}const p=s+.6*d,m=document.getElementById("brand-logo");m&&setTimeout(()=>{((e,t={})=>{new Promise(a=>{if(!e)return void a();const n=b(),o=t.delay??0,i=t.duration??n.entranceLateElementDuration??600,r=t.easing??"cubic-bezier(0.16, 1, 0.3, 1)",l=e.classList.contains("brand-logo-in-grid");setTimeout(()=>{let t;if(e.style.transition="none",e.style.visibility="visible",l)t=e.animate([{opacity:0,filter:"blur(8px)"},{opacity:1,filter:"blur(0px)"}],{duration:i,easing:r,fill:"forwards"});else{const a="calc(var(--abs-scene-impact-logo-scale, 1) * var(--brand-logo-user-scale, 1))";t=e.animate([{opacity:0,transform:`translateY(calc(var(--brand-logo-offset-y) - var(--gap-xs))) scale(calc(${a} * 0.96))`,filter:"blur(calc(var(--link-impact-blur) * 0.6))"},{opacity:1,transform:`translateY(var(--brand-logo-offset-y)) scale(${a})`,filter:"blur(0px)"}],{duration:i,easing:r,fill:"forwards"})}t.finished.then(()=>{e.style.opacity="1",e.style.filter="blur(0px)",requestAnimationFrame(()=>{requestAnimationFrame(()=>{e.style.removeProperty("transition"),e.style.removeProperty("transform"),e.style.removeProperty("filter"),a()})})}).catch(()=>{a()})},o)})})(m,{delay:0,duration:c,easing:l})},p);const h=[];for(const b of i){const e="string"==typeof b?document.querySelector(b):b;e&&h.push(e)}const f=p+.5*c;for(let b=0;h.length>b;b++){const e=h[b];setTimeout(()=>{oo(e,{delay:0,duration:c,easing:l,scaleFrom:t.entranceLateElementScaleFrom??.92})},f+150*b)}const g=p+.35*c,y=document.getElementById("main-links");y&&(y.classList.add("main-links--staggered"),setTimeout(()=>{y.style.transition="none",y.style.visibility="visible",y.style.opacity="1",y.classList.add("main-links--staggered-in"),requestAnimationFrame(()=>{y.style.removeProperty("transition")}),setTimeout(()=>{y.querySelectorAll(".footer_link").forEach(e=>{e.style.opacity="1",e.style.transform="translateY(0) scale(1)",e.style.filter="blur(0)"}),y.classList.remove("main-links--staggered","main-links--staggered-in")},1300)},g))},revealAllLateElements:io,revealLateElement:oo,setInitialBrowserDefaultState:ao,transitionToWallState:no});const ld={core:{title:"Core",controls:[{id:"masterGain",label:"Master Volume",min:10,max:100,step:1,format:e=>Math.round(e)+"%",toConfig:e=>e/100,fromConfig:e=>100*e},{id:"collisionMinImpact",label:"Silence Threshold",min:20,max:85,step:1,format:e=>Math.round(e)+"%",toConfig:e=>e/100,fromConfig:e=>100*e}]},envelope:{title:"Envelope",controls:[{id:"decayTime",label:"Click Length",min:20,max:180,step:1,format:e=>Math.round(e)+"ms",toConfig:e=>e/1e3,fromConfig:e=>1e3*e}]},tone:{title:"Tone",controls:[{id:"filterBaseFreq",label:"Brightness",min:300,max:6e3,step:50,format:e=>Math.round(e)+"Hz",toConfig:e=>e,fromConfig:e=>e},{id:"harmonicGain",label:"Warmth",min:0,max:50,step:1,format:e=>Math.round(e)+"%",toConfig:e=>e/100,fromConfig:e=>100*e},{id:"filterQ",label:"Resonance",min:10,max:200,step:5,format:e=>""+(e/100).toFixed(2),toConfig:e=>e/100,fromConfig:e=>100*e}]},crystal:{title:"Crystal",controls:[{id:"pitchMinHz",label:"Pitch Low",min:80,max:1200,step:10,format:e=>Math.round(e)+"Hz",toConfig:e=>e,fromConfig:e=>e},{id:"pitchMaxHz",label:"Pitch High",min:200,max:4e3,step:20,format:e=>Math.round(e)+"Hz",toConfig:e=>e,fromConfig:e=>e},{id:"pitchCurve",label:"Pitch Curve",min:70,max:160,step:1,format:e=>(e/100).toFixed(2)+"",toConfig:e=>e/100,fromConfig:e=>100*e},{id:"sparkleGain",label:"Sparkle",min:0,max:35,step:1,format:e=>Math.round(e)+"%",toConfig:e=>e/100,fromConfig:e=>100*e},{id:"sparkleRatioMin",label:"Sparkle Min",min:120,max:600,step:10,format:e=>(e/100).toFixed(2)+"",toConfig:e=>e/100,fromConfig:e=>100*e},{id:"sparkleRatioMax",label:"Sparkle Max",min:160,max:800,step:10,format:e=>(e/100).toFixed(2)+"",toConfig:e=>e/100,fromConfig:e=>100*e},{id:"sparkleDecayMul",label:"Sparkle Decay",min:20,max:95,step:1,format:e=>Math.round(e)+"%",toConfig:e=>e/100,fromConfig:e=>100*e},{id:"noiseTransientQ",label:"Sparkle Q",min:60,max:600,step:5,format:e=>""+(e/100).toFixed(2),toConfig:e=>e/100,fromConfig:e=>100*e}]},space:{title:"Space",controls:[{id:"reverbWetMix",label:"Reverb Mix",min:0,max:50,step:1,format:e=>Math.round(e)+"%",toConfig:e=>e/100,fromConfig:e=>100*e},{id:"reverbDecay",label:"Room Size",min:5,max:80,step:1,format:e=>(e/100).toFixed(2)+"s",toConfig:e=>e/100,fromConfig:e=>100*e}]},dynamics:{title:"Dynamics",controls:[{id:"minGain",label:"Min Hit Volume",min:0,max:20,step:1,format:e=>Math.round(e)+"%",toConfig:e=>e/100,fromConfig:e=>100*e},{id:"maxGain",label:"Max Hit Volume",min:5,max:50,step:1,format:e=>Math.round(e)+"%",toConfig:e=>e/100,fromConfig:e=>100*e}]},realism:{title:"Realism",controls:[{id:"noiseTransientGain",label:"Impact Snap",min:0,max:80,step:1,format:e=>Math.round(e)+"%",toConfig:e=>e/100,fromConfig:e=>100*e},{id:"varianceGain",label:"Volume Variance",min:0,max:50,step:1,format:e=>`${Math.round(e)}%`,toConfig:e=>e/100,fromConfig:e=>100*e},{id:"variancePitch",label:"Pitch Variance",min:0,max:25,step:1,format:e=>`${Math.round(e)}%`,toConfig:e=>e/100,fromConfig:e=>100*e},{id:"velocityNoiseScale",label:"Hard Hit Crack",min:100,max:500,step:10,format:e=>(e/100).toFixed(1)+"",toConfig:e=>e/100,fromConfig:e=>100*e}]}};var sd=Object.freeze({__proto__:null,async animateDeparture(e={}){const t=e.duration??300,a=e.easing??"cubic-bezier(0.16, 1, 0.3, 1)";if(window.matchMedia?.("(prefers-reduced-motion: reduce)")?.matches)return Promise.resolve();const n=["#expertise-legend",".decorative-script",".portfolio-stage","#portfolioMeta",".cv-scroll-container","#bravia-balls canvas",".ui-top",".ui-bottom","#main-links"].map(e=>document.querySelector(e)).filter(Boolean);if(0===n.length)return Promise.resolve();const o=n.map(e=>e.animate([{opacity:1,transform:"scale(1) translateZ(0)",filter:"blur(0)"},{opacity:0,transform:"scale(0.95) translateZ(-30px)",filter:"blur(4px)"}],{duration:t,easing:a,fill:"forwards"}));await Promise.all(o.map(e=>e.finished))}});export{qt as $,An as A,Bn as B,wt as C,cn as D,ne as E,le as F,se as G,ln as H,lt as I,Cn as J,Fn as K,Ln as L,Pn as M,mo as N,Wn as O,On as P,Ze as Q,k as R,U as S,Ye as T,Ne as U,ca as V,ua as W,la as X,oa as Y,ia as Z,_n as _,te as a,jt as a0,$e as a1,fn as a2,Ae as a3,Xe as a4,Jt as a5,Nn as a6,Vn as a7,Hn as a8,xn as a9,so as aA,Le as aB,Ce as aC,de as aD,ke as aE,lo as aF,qo as aG,Xa as aH,m as aI,l as aJ,ve as aK,Ya as aL,Ua as aM,Q as aN,y as aO,Qn as aP,J as aQ,Xn as aR,ee as aS,Yn as aT,ho as aU,ir as aV,js as aW,rd as aX,Ns as aa,Mn as ab,kn as ac,ie as ad,fe as ae,ge as af,be as ag,ye as ah,he as ai,o as aj,Ke as ak,x as al,Un as am,co as an,Ha as ao,De as ap,Fe as aq,nn as ar,Ea as as,ro as at,Qa as au,Ja as av,en as aw,xe as ax,Oe as ay,To as az,tn as b,un as c,g as d,we as e,zn as f,b as g,ra as h,aa as i,sa as j,$n as k,hn as l,da as m,f as n,h as o,ae as p,La as q,Ue as r,Ge as s,ze as t,v as u,Re as v,Vt as w,xt as x,kt as y,Pa as z};