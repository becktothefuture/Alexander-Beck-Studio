function e(e,t=""){const a=(e+"").startsWith("--")?e:"--"+e,o=(()=>{try{if("undefined"==typeof window)return null;const e=window.__TOKENS__;return e&&"object"==typeof e?e:null}catch(e){return null}})(),n=(e=>{try{return"undefined"==typeof document?"":getComputedStyle(document.documentElement).getPropertyValue(e).trim()}catch(t){return""}})(a);if(n&&!n.includes("var("))return n;if(o){const e=((e,t)=>{const a=(e||"")+"";if(!a.includes("var("))return a.trim();if(!t)return a.trim();const o=/var\((--[a-z0-9-_]+)(?:\s*,\s*([^)]+))?\)/gi;let n=a,i=0;for(;n.includes("var(")&&8>i;)n=n.replace(o,(e,a,o)=>{const n=t.resolved?.[a]??t.cssVars?.[a];return null!=n?(n+"").trim():o?(o+"").trim():""}),i+=1;return n.trim()})(o.resolved?.[a]??o.cssVars?.[a]??n,o);if(e&&!e.includes("var("))return e}return n&&!n.includes("var(")?n:t}function t(t,a){const o=e(t,""),n=parseFloat(o);return Number.isFinite(n)?n:a}function a(t,a){const o=e(t,"");if(!o)return a;const n=parseFloat((o+"").replace(/px$/i,""));return Number.isFinite(n)?n:a}function o(t,a){const o=e(t,"");if(!o)return a;const n=(o+"").trim().toLowerCase(),i=parseFloat(n);return Number.isFinite(i)?n.endsWith("ms")?i:n.endsWith("s")?1e3*i:i:a}function n(e){Nn=e}function i(e,t,a,o){const n=+e;return Number.isFinite(n)?Math.min(a,Math.max(t,n)):o}function r(e,t,a,o){const n=i(e,t,a,o);return Math.round(n)}function l(){const e=+_n.layoutViewportWidthPx;return Number.isFinite(e)&&e>0?e:Math.max(1,window.innerWidth||1)}function s(){try{const e=window.visualViewport;if(e&&"number"==typeof e.height&&e.height>0)return Math.max(1,e.height)}catch(e){}return Math.max(1,window.innerHeight||1)}function c(){return l()*s()}function d(e=64e4){const t=c();return t>0&&e>0?t/e:1}function u(e,t){const a=Math.max(1,t||l()),o=+e;return Number.isFinite(o)?o/a*100:0}function p(e,t){const a=Math.max(1,t||l()),o=+e;return Number.isFinite(o)?o/100*a:0}function h(){const e=l(),t=s(),a=Number.isFinite(_n.wallThicknessVw)&&_n.wallThicknessVw>0?_n.wallThicknessVw:0,o=a>0?a:Number.isFinite(_n.containerBorderVw)?_n.containerBorderVw:0;_n.containerBorderVw=o;const n=p(o,e),i=p(_n.simulationPaddingVw,e),r=p(_n.wallRadiusVw,e),c=Math.max(0,Math.round(_n.layoutMinWallRadiusPx||0)),u=p(a>0?a:o,e)*(1+(d()-1)*(Number.isFinite(_n.wallThicknessAreaMultiplier)&&_n.wallThicknessAreaMultiplier>=0?_n.wallThicknessAreaMultiplier:0)),h=_n.isMobile||_n.isMobileViewport,f=h?Math.max(.5,_n.mobileWallThicknessXFactor||1):1,m=h?1:Math.max(.5,_n.desktopWallThicknessFactor||1);_n.containerBorder=Math.round(n*m),_n.containerBorderX=Math.round(n*f),_n.simulationPadding=Math.round(i);const g=u*(h?f:m);_n.wallThickness=Math.round(Math.max(Number.isFinite(_n.wallThicknessMinPx)?_n.wallThicknessMinPx:0,Math.min(Number.isFinite(_n.wallThicknessMaxPx)&&_n.wallThicknessMaxPx>0?_n.wallThicknessMaxPx:1/0,g)));const y=Math.max(1,Math.sqrt(e*t)),b=Number.isFinite(_n.contentPaddingRatio)?_n.contentPaddingRatio:0;_n.contentPadding=Math.round(_n.wallThickness+y*(Math.abs(b)>1?b/y:b));const M=Math.max(.1,_n.contentPaddingHorizontalRatio||1);_n.contentPaddingY=_n.contentPadding,_n.contentPaddingX=Math.round(_n.contentPadding*M),_n.wallRadius=Math.max(c,Math.round(r)),_n.cornerRadius=_n.wallRadius;const v=Math.max(0,p(_n.cursorInfluenceRadiusVw||0,e));_n.cursorInfluenceRadiusPx=Math.round(v),_n.repelRadius=Math.round(v),_n.weightlessRepelRadius=Math.round(v),_n.bubblesDeflectRadius=Math.round(v);const x=Math.max(0,p(_n.particleFountainMouseRepelRadiusVw??5,e));_n.particleFountainMouseRepelRadius=Math.round(x)}function f(){const e=document.documentElement,t=_n.isMobile||_n.isMobileViewport,a=t?Math.max(.5,_n.mobileWallThicknessXFactor||1):1,o=t?1:Math.max(.5,_n.desktopWallThicknessFactor||1);e.style.setProperty("--container-border",_n.containerBorder+"px"),e.style.setProperty("--container-border-x",_n.containerBorderX+"px"),e.style.setProperty("--container-border-y",_n.containerBorder+"px"),e.style.setProperty("--simulation-padding",_n.simulationPadding+"px"),e.style.setProperty("--content-padding",_n.contentPadding+"px"),e.style.setProperty("--content-padding-x",_n.contentPaddingX+"px"),e.style.setProperty("--content-padding-y",_n.contentPaddingY+"px"),e.style.setProperty("--wall-radius",_n.wallRadius+"px"),e.style.setProperty("--wall-thickness",_n.wallThickness+"px");try{const t=l(),a=s(),o=Math.max(0,t*a),n=Math.sqrt(o);e.style.setProperty("--layout-viewport-area-px",Math.round(o)+""),e.style.setProperty("--layout-viewport-size-px",Math.round(n)+"px")}catch(p){}const n=_n.containerBorderVw||1.3;e.style.setProperty("--container-border-vw",""+n*o),e.style.setProperty("--container-border-x-vw",""+n*a),e.style.setProperty("--wall-thickness-vw",""+(Number.isFinite(_n.wallThicknessVw)&&_n.wallThicknessVw>0?_n.wallThicknessVw:_n.containerBorderVw)*(t?a:o)),e.style.setProperty("--edge-label-inset-adjust",(_n.edgeLabelInsetAdjustPx||0)+"px");const i=Number.isFinite(_n.edgeCaptionDistanceMinPx)?_n.edgeCaptionDistanceMinPx:8,r=Number.isFinite(_n.edgeCaptionDistanceMaxPx)?_n.edgeCaptionDistanceMaxPx:48;e.style.setProperty("--edge-caption-distance-min",Math.max(0,i)+"px"),e.style.setProperty("--edge-caption-distance-max",Math.max(i,r)+"px"),e.style.setProperty("--simulation-overlay-intensity",(Number.isFinite(_n.simulationOverlayIntensity)?Math.max(0,Math.min(1,_n.simulationOverlayIntensity)):1)+"");const c=_n.wallThickness+_n.contentPadding;e.style.setProperty("--edge-inset",c+"px"),e.style.setProperty("--edge-inset-lg",c+"px"),t?e.style.setProperty("--edge-label-mobile-display",_n.mobileEdgeLabelsVisible?"flex":"none"):e.style.removeProperty("--edge-label-mobile-display"),e.style.setProperty("--ui-hit-area-mul",(_n.uiHitAreaMul??1)+""),e.style.setProperty("--ui-icon-corner-radius-mul",(_n.uiIconCornerRadiusMul??.5)+""),Number.isFinite(_n.uiIconFramePx)&&_n.uiIconFramePx>0?e.style.setProperty("--ui-icon-frame-size",Math.round(_n.uiIconFramePx)+"px"):e.style.removeProperty("--ui-icon-frame-size"),Number.isFinite(_n.uiIconGlyphPx)&&_n.uiIconGlyphPx>0?e.style.setProperty("--ui-icon-glyph-size",Math.round(_n.uiIconGlyphPx)+"px"):e.style.removeProperty("--ui-icon-glyph-size"),Number.isFinite(_n.uiIconGroupMarginPx)&&0!==_n.uiIconGroupMarginPx?e.style.setProperty("--ui-icon-group-margin",Math.round(_n.uiIconGroupMarginPx)+"px"):e.style.removeProperty("--ui-icon-group-margin"),e.style.setProperty("--hover-edge-enabled",_n.hoverEdgeEnabled?"1":"0"),e.style.setProperty("--hover-edge-width",(_n.hoverEdgeWidth??1)+"px"),e.style.setProperty("--hover-edge-inset",(_n.hoverEdgeInset??0)+"px"),e.style.setProperty("--hover-edge-bottom-enabled",_n.hoverEdgeBottomEnabled?"1":"0"),e.style.setProperty("--hover-edge-bottom-radius",(_n.hoverEdgeBottomRadius??1.2)+""),e.style.setProperty("--hover-edge-bottom-opacity",(_n.hoverEdgeBottomOpacity??.6)+""),e.style.setProperty("--hover-edge-bottom-color-mix",(_n.hoverEdgeBottomColorMix??70)+"%"),e.style.setProperty("--hover-edge-top-enabled",_n.hoverEdgeTopEnabled?"1":"0"),e.style.setProperty("--hover-edge-top-radius",(_n.hoverEdgeTopRadius??1)+""),e.style.setProperty("--hover-edge-top-opacity",(_n.hoverEdgeTopOpacity??.3)+""),e.style.setProperty("--hover-edge-top-color-mix",(_n.hoverEdgeTopColorMix??50)+"%");const d=document.body.classList.contains("dark-mode");if(e.style.setProperty("--outer-wall-radius-adjust",(_n.outerWallRadiusAdjust??2)+"px"),e.style.setProperty("--outer-wall-top-dark-offset",(_n.outerWallTopDarkOffset??1)+"px"),e.style.setProperty("--outer-wall-top-dark-blur",(_n.outerWallTopDarkBlur??3)+"px"),e.style.setProperty("--outer-wall-top-dark-spread",(_n.outerWallTopDarkSpread??0)+"px"),e.style.setProperty("--outer-wall-top-dark-opacity",(d?_n.outerWallTopDarkOpacityDark??.4:_n.outerWallTopDarkOpacityLight??.6)+""),e.style.setProperty("--outer-wall-bottom-light-offset",(_n.outerWallBottomLightOffset??.5)+"px"),e.style.setProperty("--outer-wall-bottom-light-blur",(_n.outerWallBottomLightBlur??0)+"px"),e.style.setProperty("--outer-wall-bottom-light-spread",(_n.outerWallBottomLightSpread??0)+"px"),e.style.setProperty("--outer-wall-bottom-light-opacity",(d?_n.outerWallBottomLightOpacityDark??.3:_n.outerWallBottomLightOpacityLight??.5)+""),e.style.setProperty("--outer-wall-cast-shadow-offset",(_n.outerWallCastShadowOffset??3)+"px"),e.style.setProperty("--outer-wall-cast-shadow-blur",(_n.outerWallCastShadowBlur??12)+"px"),e.style.setProperty("--outer-wall-cast-shadow-spread",(_n.outerWallCastShadowSpread??0)+"px"),e.style.setProperty("--outer-wall-cast-shadow-opacity",(d?_n.outerWallCastShadowOpacityDark??.25:_n.outerWallCastShadowOpacityLight??.15)+""),e.style.setProperty("--inner-wall-outward-shadow-offset",(_n.innerWallOutwardShadowOffset??2)+"px"),e.style.setProperty("--inner-wall-outward-shadow-blur",(_n.innerWallOutwardShadowBlur??8)+"px"),e.style.setProperty("--inner-wall-outward-shadow-spread",(_n.innerWallOutwardShadowSpread??2)+"px"),e.style.setProperty("--inner-wall-outward-shadow-opacity",(d?_n.innerWallOutwardShadowOpacityDark??.35:_n.innerWallOutwardShadowOpacityLight??.2)+""),e.style.setProperty("--inner-wall-outward-shadow-opacity-dark",(_n.innerWallOutwardShadowOpacityDark??.35)+""),e.style.setProperty("--inner-wall-inner-glow-blur",(_n.innerWallInnerGlowBlur??25)+"px"),e.style.setProperty("--inner-wall-inner-glow-spread",(_n.innerWallInnerGlowSpread??3)+"px"),e.style.setProperty("--inner-wall-inner-glow-offset-y",(_n.innerWallInnerGlowOffsetY??12)+"px"),e.style.setProperty("--inner-wall-inner-glow-opacity",(d?_n.innerWallInnerGlowOpacityDark??.08:_n.innerWallInnerGlowOpacityLight??0)+""),e.style.setProperty("--inner-wall-inner-glow-opacity-dark",(_n.innerWallInnerGlowOpacityDark??.08)+""),_n.innerWallInnerGlowColor){const t=(e=>{if(!e)return"255, 255, 255";3===(e=e.replace(/^#/,"")).length&&(e=e[0]+e[0]+e[1]+e[1]+e[2]+e[2]);const t=parseInt(e,16);return`${t>>16&255}, ${t>>8&255}, ${255&t}`})(_n.innerWallInnerGlowColor);e.style.setProperty("--inner-wall-inner-glow-rgb",t)}e.style.setProperty("--outer-wall-top-bevel-width",(_n.outerWallTopBevelWidth??3)+"px"),e.style.setProperty("--outer-wall-top-bevel-opacity",(d?_n.outerWallTopBevelOpacityDark??.35:_n.outerWallTopBevelOpacityLight??.25)+""),e.style.setProperty("--inner-wall-top-bevel-width",(_n.innerWallTopBevelWidth??2)+"px"),e.style.setProperty("--inner-wall-top-light-opacity",(d?_n.innerWallTopLightOpacityDark??.4:_n.innerWallTopLightOpacityLight??.3)+""),e.style.setProperty("--inner-wall-bottom-bevel-width",(_n.innerWallBottomBevelWidth??2)+"px"),e.style.setProperty("--inner-wall-top-bevel-opacity",(d?_n.innerWallTopBevelOpacityDark??.25:_n.innerWallTopBevelOpacityLight??.18)+"");const u=document.getElementById("bravia-balls");u&&u.classList.toggle("outer-wall-edge-disabled",!_n.outerWallEdgeEnabled)}function m(o){if(_n.config={...o},void 0!==o.layoutViewportWidthPx&&(_n.layoutViewportWidthPx=i(o.layoutViewportWidthPx,0,4096,0)),o.ballMass&&(_n.ballMassKg=o.ballMass),void 0!==o.gravityMultiplier&&(_n.gravityMultiplier=o.gravityMultiplier,_n.gravityMultiplierPit=o.gravityMultiplier),o.restitution&&(_n.REST=o.restitution),o.friction&&(_n.FRICTION=o.friction),void 0!==o.ballScale&&(_n.sizeScale=o.ballScale),void 0!==o.sizeScale&&(_n.sizeScale=o.sizeScale),void 0!==o.sizeVariationGlobalMul&&(_n.sizeVariationGlobalMul=i(o.sizeVariationGlobalMul,0,2,_n.sizeVariationGlobalMul)),void 0!==o.sizeVariationCap&&(_n.sizeVariationCap=i(o.sizeVariationCap,0,.2,_n.sizeVariationCap)),void 0!==o.sizeVariationPit&&(_n.sizeVariationPit=i(o.sizeVariationPit,0,1,_n.sizeVariationPit)),void 0!==o.sizeVariationFlies&&(_n.sizeVariationFlies=i(o.sizeVariationFlies,0,1,_n.sizeVariationFlies)),void 0!==o.sizeVariationWeightless&&(_n.sizeVariationWeightless=i(o.sizeVariationWeightless,0,1,_n.sizeVariationWeightless)),void 0!==o.sizeVariationWater&&(_n.sizeVariationWater=i(o.sizeVariationWater,0,1,_n.sizeVariationWater)),void 0!==o.sizeVariationVortex&&(_n.sizeVariationVortex=i(o.sizeVariationVortex,0,1,_n.sizeVariationVortex)),void 0!==o.sizeVariationMagnetic&&(_n.sizeVariationMagnetic=i(o.sizeVariationMagnetic,0,1,_n.sizeVariationMagnetic)),void 0!==o.sizeVariationBubbles&&(_n.sizeVariationBubbles=i(o.sizeVariationBubbles,0,1,_n.sizeVariationBubbles)),void 0!==o.sizeVariationKaleidoscope&&(_n.sizeVariationKaleidoscope=i(o.sizeVariationKaleidoscope,0,1,_n.sizeVariationKaleidoscope)),void 0!==o.sizeVariationCritters&&(_n.sizeVariationCritters=i(o.sizeVariationCritters,0,1,_n.sizeVariationCritters)),void 0!==o.sizeVariationNeural&&(_n.sizeVariationNeural=i(o.sizeVariationNeural,0,1,_n.sizeVariationNeural)),void 0!==o.sizeVariationParallaxLinear&&(_n.sizeVariationParallaxLinear=i(o.sizeVariationParallaxLinear,0,1,_n.sizeVariationParallaxLinear)),void 0!==o.sizeVariation&&(_n.sizeVariation=o.sizeVariation),Array.isArray(o.colorDistribution)){const e=o.colorDistribution,t=Array.isArray(_n.colorDistribution)?_n.colorDistribution:[],a=[];for(let o=0;7>o;o++){const n=t[o]||{},i=e[o]||{};let l="string"==typeof i.label&&i.label.trim()?i.label.trim():"string"==typeof n.label?n.label:"Discipline "+(o+1);"frontend craft"===(l+"").trim().toLowerCase()&&(l="Art & Visual Direction");const s=r(i.colorIndex,0,7,r(n.colorIndex,0,7,0)),c=r(i.weight,0,100,r(n.weight,0,100,0));a.push({label:l,colorIndex:s,weight:c})}_n.colorDistribution=a}if(void 0!==o.pitWarmupFrames&&(_n.pitWarmupFrames=r(o.pitWarmupFrames,0,240,_n.pitWarmupFrames)),void 0!==o.fliesWarmupFrames&&(_n.fliesWarmupFrames=r(o.fliesWarmupFrames,0,240,_n.fliesWarmupFrames)),void 0!==o.weightlessWarmupFrames&&(_n.weightlessWarmupFrames=r(o.weightlessWarmupFrames,0,240,_n.weightlessWarmupFrames)),void 0!==o.waterWarmupFrames&&(_n.waterWarmupFrames=r(o.waterWarmupFrames,0,240,_n.waterWarmupFrames)),void 0!==o.vortexWarmupFrames&&(_n.vortexWarmupFrames=r(o.vortexWarmupFrames,0,240,_n.vortexWarmupFrames)),void 0!==o.magneticWarmupFrames&&(_n.magneticWarmupFrames=r(o.magneticWarmupFrames,0,240,_n.magneticWarmupFrames)),void 0!==o.bubblesWarmupFrames&&(_n.bubblesWarmupFrames=r(o.bubblesWarmupFrames,0,240,_n.bubblesWarmupFrames)),void 0!==o.kaleidoscope3WarmupFrames&&(_n.kaleidoscope3WarmupFrames=r(o.kaleidoscope3WarmupFrames,0,240,_n.kaleidoscope3WarmupFrames)),void 0!==o.crittersWarmupFrames&&(_n.crittersWarmupFrames=r(o.crittersWarmupFrames,0,240,_n.crittersWarmupFrames)),void 0!==o.neuralWarmupFrames&&(_n.neuralWarmupFrames=r(o.neuralWarmupFrames,0,240,_n.neuralWarmupFrames)),void 0!==o.parallaxLinearWarmupFrames&&(_n.parallaxLinearWarmupFrames=r(o.parallaxLinearWarmupFrames,0,240,_n.parallaxLinearWarmupFrames)),void 0!==o.elasticCenterWarmupFrames&&(_n.elasticCenterWarmupFrames=r(o.elasticCenterWarmupFrames,0,240,_n.elasticCenterWarmupFrames)),void 0!==o.maxBalls&&(_n.maxBalls=o.maxBalls),void 0!==o.repelRadius&&(_n.repelRadius=o.repelRadius),void 0!==o.repelPower&&(_n.repelPower=o.repelPower),void 0!==o.repelSoft&&(_n.repelSoft=o.repelSoft),void 0!==o.repelSoftness&&(_n.repelSoft=o.repelSoftness),void 0!==o.cursorInfluenceRadiusVw?_n.cursorInfluenceRadiusVw=i(o.cursorInfluenceRadiusVw,0,80,_n.cursorInfluenceRadiusVw):void 0!==o.repelRadius&&(_n.cursorInfluenceRadiusVw=i(o.repelRadius/10,0,80,_n.cursorInfluenceRadiusVw)),void 0!==o.ballSizeMin&&(_n.ballSizeMin=i(o.ballSizeMin,1,100,_n.ballSizeMin)),void 0!==o.ballSizeMax&&(_n.ballSizeMax=i(o.ballSizeMax,1,100,_n.ballSizeMax)),void 0!==o.ballSizeBreakpointMin&&(_n.ballSizeBreakpointMin=i(o.ballSizeBreakpointMin,100,2e3,_n.ballSizeBreakpointMin)),void 0!==o.ballSizeBreakpointMax&&(_n.ballSizeBreakpointMax=i(o.ballSizeBreakpointMax,500,4e3,_n.ballSizeBreakpointMax)),void 0!==o.ballSizeCurve&&(_n.ballSizeCurve=i(o.ballSizeCurve,.1,5,_n.ballSizeCurve)),void 0!==o.ballSizeDesktop&&void 0===o.ballSizeMin&&(_n.ballSizeMax=o.ballSizeDesktop),void 0!==o.ballSizeMobile&&void 0===o.ballSizeMin&&(_n.ballSizeMin=o.ballSizeMobile),void 0!==o.liteModeEnabled&&(_n.liteModeEnabled=!!o.liteModeEnabled),void 0!==o.liteModeObjectReductionFactor&&(_n.liteModeObjectReductionFactor=i(o.liteModeObjectReductionFactor,0,1,_n.liteModeObjectReductionFactor)),void 0!==o.mobileObjectReductionFactor&&(_n.mobileObjectReductionFactor=i(o.mobileObjectReductionFactor,0,1,_n.mobileObjectReductionFactor)),void 0!==o.mobileObjectReductionThreshold&&(_n.mobileObjectReductionThreshold=r(o.mobileObjectReductionThreshold,0,1e4,_n.mobileObjectReductionThreshold)),w(),S(),void 0!==o.kaleidoscopeBallCount&&(_n.kaleidoscopeBallCount=i(o.kaleidoscopeBallCount,10,300,_n.kaleidoscopeBallCount)),void 0!==o.kaleidoscopeDotSizeVh&&(_n.kaleidoscopeDotSizeVh=i(o.kaleidoscopeDotSizeVh,.1,6,_n.kaleidoscopeDotSizeVh)),void 0!==o.kaleidoscopeDotAreaMul&&(_n.kaleidoscopeDotAreaMul=i(o.kaleidoscopeDotAreaMul,.1,2,_n.kaleidoscopeDotAreaMul)),void 0!==o.kaleidoscopeSpawnAreaMul&&(_n.kaleidoscopeSpawnAreaMul=i(o.kaleidoscopeSpawnAreaMul,.2,2,_n.kaleidoscopeSpawnAreaMul)),void 0!==o.kaleidoscopeSizeVariance&&(_n.kaleidoscopeSizeVariance=i(o.kaleidoscopeSizeVariance,0,1,_n.kaleidoscopeSizeVariance)),void 0!==o.kaleidoscope3BallCount&&(_n.kaleidoscope3BallCount=i(o.kaleidoscope3BallCount,3,300,_n.kaleidoscope3BallCount)),void 0!==o.kaleidoscope3Wedges&&(_n.kaleidoscope3Wedges=i(o.kaleidoscope3Wedges,3,24,_n.kaleidoscope3Wedges)),void 0!==o.kaleidoscope3Speed&&(_n.kaleidoscope3Speed=i(o.kaleidoscope3Speed,.2,2,_n.kaleidoscope3Speed)),void 0!==o.kaleidoscope3DotSizeVh&&(_n.kaleidoscope3DotSizeVh=i(o.kaleidoscope3DotSizeVh,.1,6,_n.kaleidoscope3DotSizeVh)),void 0!==o.kaleidoscope3DotAreaMul&&(_n.kaleidoscope3DotAreaMul=i(o.kaleidoscope3DotAreaMul,.1,2,_n.kaleidoscope3DotAreaMul)),void 0!==o.kaleidoscope3SpawnAreaMul&&(_n.kaleidoscope3SpawnAreaMul=i(o.kaleidoscope3SpawnAreaMul,.2,2,_n.kaleidoscope3SpawnAreaMul)),void 0!==o.kaleidoscope3SizeVariance&&(_n.kaleidoscope3SizeVariance=i(o.kaleidoscope3SizeVariance,0,1,_n.kaleidoscope3SizeVariance)),void 0!==o.kaleidoscopeWedges?_n.kaleidoscopeWedges=i(o.kaleidoscopeWedges,3,24,_n.kaleidoscopeWedges):void 0!==o.kaleidoscopeSegments&&(_n.kaleidoscopeWedges=i(o.kaleidoscopeSegments,3,24,_n.kaleidoscopeWedges)),void 0!==o.kaleidoscopeMirror&&(_n.kaleidoscopeMirror=i(o.kaleidoscopeMirror,0,1,_n.kaleidoscopeMirror)),void 0!==o.kaleidoscopeSpeed)_n.kaleidoscopeSpeed=i(o.kaleidoscopeSpeed,.2,2,_n.kaleidoscopeSpeed);else if(void 0!==o.kaleidoscopeSwirlStrength){const e=i(o.kaleidoscopeSwirlStrength,0,800,52);_n.kaleidoscopeSpeed=i(.2+e/800*1.8,.2,2,_n.kaleidoscopeSpeed)}void 0!==o.critterCount&&(_n.critterCount=o.critterCount),void 0!==o.critterSpeed&&(_n.critterSpeed=o.critterSpeed),void 0!==o.critterMaxSpeed&&(_n.critterMaxSpeed=o.critterMaxSpeed),void 0!==o.critterStepHz&&(_n.critterStepHz=o.critterStepHz),void 0!==o.critterStepSharpness&&(_n.critterStepSharpness=o.critterStepSharpness),void 0!==o.critterTurnNoise&&(_n.critterTurnNoise=o.critterTurnNoise),void 0!==o.critterTurnDamp&&(_n.critterTurnDamp=o.critterTurnDamp),void 0!==o.critterTurnSeek&&(_n.critterTurnSeek=o.critterTurnSeek),void 0!==o.critterAvoidRadius&&(_n.critterAvoidRadius=o.critterAvoidRadius),void 0!==o.critterAvoidForce&&(_n.critterAvoidForce=o.critterAvoidForce),void 0!==o.critterEdgeAvoid&&(_n.critterEdgeAvoid=o.critterEdgeAvoid),void 0!==o.critterMousePull&&(_n.critterMousePull=o.critterMousePull),_n.layoutMinWallRadiusPx=void 0!==o.layoutMinWallRadiusPx?i(o.layoutMinWallRadiusPx,0,400,_n.layoutMinWallRadiusPx):a("--layout-min-wall-radius",_n.layoutMinWallRadiusPx),void 0!==o.critterMouseRadiusVw&&(_n.critterMouseRadiusVw=o.critterMouseRadiusVw),void 0!==o.critterRestitution&&(_n.critterRestitution=o.critterRestitution),void 0!==o.critterFriction&&(_n.critterFriction=o.critterFriction),void 0!==o.critterHiveStirInterval&&(_n.critterHiveStirInterval=o.critterHiveStirInterval),void 0!==o.critterHiveStirStrength&&(_n.critterHiveStirStrength=o.critterHiveStirStrength),void 0!==o.critterHiveWaveSpeed&&(_n.critterHiveWaveSpeed=o.critterHiveWaveSpeed),void 0!==o.critterNervousnessMin&&(_n.critterNervousnessMin=o.critterNervousnessMin),void 0!==o.critterNervousnessMax&&(_n.critterNervousnessMax=o.critterNervousnessMax),void 0!==o.critterCuriosityBias&&(_n.critterCuriosityBias=o.critterCuriosityBias),void 0!==o.neuralBallCount&&(_n.neuralBallCount=i(o.neuralBallCount,8,400,_n.neuralBallCount)),void 0!==o.neuralLinkDistanceVw&&(_n.neuralLinkDistanceVw=i(o.neuralLinkDistanceVw,1,50,_n.neuralLinkDistanceVw)),void 0!==o.neuralLineOpacity&&(_n.neuralLineOpacity=i(o.neuralLineOpacity,0,1,_n.neuralLineOpacity)),void 0!==o.neuralConnectorDensity&&(_n.neuralConnectorDensity=i(o.neuralConnectorDensity,0,10,_n.neuralConnectorDensity)),void 0!==o.neuralWanderStrength&&(_n.neuralWanderStrength=i(o.neuralWanderStrength,0,4e3,_n.neuralWanderStrength)),void 0!==o.neuralMouseStrength&&(_n.neuralMouseStrength=i(o.neuralMouseStrength,0,3e5,_n.neuralMouseStrength)),void 0!==o.neuralSeparationRadius&&(_n.neuralSeparationRadius=i(o.neuralSeparationRadius,50,300,_n.neuralSeparationRadius)),void 0!==o.neuralSeparationStrength&&(_n.neuralSeparationStrength=i(o.neuralSeparationStrength,0,3e4,_n.neuralSeparationStrength)),void 0!==o.neuralMaxLinksPerBall&&(_n.neuralMaxLinksPerBall=i(o.neuralMaxLinksPerBall,0,16,_n.neuralMaxLinksPerBall)),void 0!==o.neuralDamping&&(_n.neuralDamping=i(o.neuralDamping,.8,1,_n.neuralDamping)),void 0!==o.parallaxLinearDotCount&&(_n.parallaxLinearDotCount=i(o.parallaxLinearDotCount,20,220,_n.parallaxLinearDotCount)),void 0!==o.parallaxLinearGridJitter&&(_n.parallaxLinearGridJitter=i(o.parallaxLinearGridJitter,0,1,_n.parallaxLinearGridJitter)),void 0!==o.parallaxLinearFarSpeed&&(_n.parallaxLinearFarSpeed=i(o.parallaxLinearFarSpeed,0,1.5,_n.parallaxLinearFarSpeed)),void 0!==o.parallaxLinearMidSpeed&&(_n.parallaxLinearMidSpeed=i(o.parallaxLinearMidSpeed,0,1.5,_n.parallaxLinearMidSpeed)),void 0!==o.parallaxLinearNearSpeed&&(_n.parallaxLinearNearSpeed=i(o.parallaxLinearNearSpeed,0,1.5,_n.parallaxLinearNearSpeed)),void 0!==o.parallaxLinearGridX&&(_n.parallaxLinearGridX=r(o.parallaxLinearGridX,3,40,_n.parallaxLinearGridX)),void 0!==o.parallaxLinearGridY&&(_n.parallaxLinearGridY=r(o.parallaxLinearGridY,3,40,_n.parallaxLinearGridY)),void 0!==o.parallaxLinearGridZ&&(_n.parallaxLinearGridZ=r(o.parallaxLinearGridZ,2,20,_n.parallaxLinearGridZ)),void 0!==o.parallaxLinearSpanX&&(_n.parallaxLinearSpanX=i(o.parallaxLinearSpanX,.2,3,_n.parallaxLinearSpanX)),void 0!==o.parallaxLinearSpanY&&(_n.parallaxLinearSpanY=i(o.parallaxLinearSpanY,.2,3,_n.parallaxLinearSpanY)),void 0!==o.parallaxLinearZNear&&(_n.parallaxLinearZNear=i(o.parallaxLinearZNear,10,1200,_n.parallaxLinearZNear)),void 0!==o.parallaxLinearZFar&&(_n.parallaxLinearZFar=i(o.parallaxLinearZFar,50,3e3,_n.parallaxLinearZFar)),void 0!==o.parallaxLinearFocalLength&&(_n.parallaxLinearFocalLength=i(o.parallaxLinearFocalLength,80,2e3,_n.parallaxLinearFocalLength)),void 0!==o.parallaxLinearParallaxStrength&&(_n.parallaxLinearParallaxStrength=i(o.parallaxLinearParallaxStrength,0,2e3,_n.parallaxLinearParallaxStrength)),void 0!==o.parallaxLinearDotSizeMul&&(_n.parallaxLinearDotSizeMul=i(o.parallaxLinearDotSizeMul,.1,6,_n.parallaxLinearDotSizeMul)),void 0!==o.parallaxLinearFollowStrength&&(_n.parallaxLinearFollowStrength=i(o.parallaxLinearFollowStrength,1,80,_n.parallaxLinearFollowStrength)),void 0!==o.parallaxLinearDamping&&(_n.parallaxLinearDamping=i(o.parallaxLinearDamping,1,80,_n.parallaxLinearDamping)),void 0!==o.cursorExplosionImpactMinFactor&&(_n.cursorExplosionImpactMinFactor=i(o.cursorExplosionImpactMinFactor,.1,2,_n.cursorExplosionImpactMinFactor)),void 0!==o.cursorExplosionImpactMaxFactor&&(_n.cursorExplosionImpactMaxFactor=i(o.cursorExplosionImpactMaxFactor,1,8,_n.cursorExplosionImpactMaxFactor)),void 0!==o.cursorExplosionImpactSensitivity&&(_n.cursorExplosionImpactSensitivity=i(o.cursorExplosionImpactSensitivity,100,1e3,_n.cursorExplosionImpactSensitivity)),void 0!==o.cursorExplosionLifetimeImpactMin&&(_n.cursorExplosionLifetimeImpactMin=i(o.cursorExplosionLifetimeImpactMin,.3,1.5,_n.cursorExplosionLifetimeImpactMin)),void 0!==o.cursorExplosionLifetimeImpactMax&&(_n.cursorExplosionLifetimeImpactMax=i(o.cursorExplosionLifetimeImpactMax,1,3,_n.cursorExplosionLifetimeImpactMax)),void 0!==o.cursorExplosionLifetimeImpactSensitivity&&(_n.cursorExplosionLifetimeImpactSensitivity=i(o.cursorExplosionLifetimeImpactSensitivity,200,1500,_n.cursorExplosionLifetimeImpactSensitivity));for(const[e,t]of Object.entries(o||{}))e in _n&&"config"!==e&&"soundConfig"!==e&&"soundPreset"!==e&&"function"!=typeof _n[e]&&(Array.isArray(t)||null===t||["string","number","boolean"].includes(typeof t))&&void 0!==t&&(_n[e]=t);if(void 0!==o.sphere3dRadiusVw&&(_n.sphere3dRadiusVw=i(o.sphere3dRadiusVw,5,40,_n.sphere3dRadiusVw)),void 0!==o.sphere3dDensity&&(_n.sphere3dDensity=r(o.sphere3dDensity,30,600,_n.sphere3dDensity)),void 0!==o.sphere3dFocalLength&&(_n.sphere3dFocalLength=r(o.sphere3dFocalLength,80,2e3,_n.sphere3dFocalLength)),void 0!==o.sphere3dDotSizeMul&&(_n.sphere3dDotSizeMul=i(o.sphere3dDotSizeMul,.2,4,_n.sphere3dDotSizeMul)),void 0!==o.sphere3dIdleSpeed&&(_n.sphere3dIdleSpeed=i(o.sphere3dIdleSpeed,0,1,_n.sphere3dIdleSpeed)),void 0!==o.sphere3dCursorInfluence&&(_n.sphere3dCursorInfluence=i(o.sphere3dCursorInfluence,0,4,_n.sphere3dCursorInfluence)),void 0!==o.sphere3dTumbleSpeed&&(_n.sphere3dTumbleSpeed=i(o.sphere3dTumbleSpeed,0,10,_n.sphere3dTumbleSpeed)),void 0!==o.sphere3dTumbleDamping&&(_n.sphere3dTumbleDamping=i(o.sphere3dTumbleDamping,.8,.99,_n.sphere3dTumbleDamping)),void 0!==o.sphere3dWarmupFrames&&(_n.sphere3dWarmupFrames=r(o.sphere3dWarmupFrames,0,240,_n.sphere3dWarmupFrames)),void 0!==o.cube3dSizeVw&&(_n.cube3dSizeVw=i(o.cube3dSizeVw,10,50,_n.cube3dSizeVw)),void 0!==o.cube3dEdgeDensity&&(_n.cube3dEdgeDensity=r(o.cube3dEdgeDensity,2,30,_n.cube3dEdgeDensity)),void 0!==o.cube3dFaceGrid&&(_n.cube3dFaceGrid=r(o.cube3dFaceGrid,0,10,_n.cube3dFaceGrid)),void 0!==o.cube3dIdleSpeed&&(_n.cube3dIdleSpeed=i(o.cube3dIdleSpeed,0,1,_n.cube3dIdleSpeed)),void 0!==o.cube3dCursorInfluence&&(_n.cube3dCursorInfluence=i(o.cube3dCursorInfluence,0,4,_n.cube3dCursorInfluence)),void 0!==o.cube3dTumbleSpeed&&(_n.cube3dTumbleSpeed=i(o.cube3dTumbleSpeed,0,10,_n.cube3dTumbleSpeed)),void 0!==o.cube3dTumbleDamping&&(_n.cube3dTumbleDamping=i(o.cube3dTumbleDamping,.8,.99,_n.cube3dTumbleDamping)),void 0!==o.cube3dFocalLength&&(_n.cube3dFocalLength=r(o.cube3dFocalLength,80,2e3,_n.cube3dFocalLength)),void 0!==o.cube3dDotSizeMul&&(_n.cube3dDotSizeMul=i(o.cube3dDotSizeMul,.2,4,_n.cube3dDotSizeMul)),void 0!==o.cube3dFogStart&&(_n.cube3dFogStart=i(o.cube3dFogStart,0,1,_n.cube3dFogStart)),void 0!==o.cube3dFogMin&&(_n.cube3dFogMin=i(o.cube3dFogMin,0,1,_n.cube3dFogMin)),void 0!==o.cube3dWarmupFrames&&(_n.cube3dWarmupFrames=r(o.cube3dWarmupFrames,0,240,_n.cube3dWarmupFrames)),void 0!==o.starfieldCount&&(_n.starfieldCount=r(o.starfieldCount,20,500,_n.starfieldCount)),void 0!==o.starfieldSpanX&&(_n.starfieldSpanX=i(o.starfieldSpanX,.4,4,_n.starfieldSpanX)),void 0!==o.starfieldSpanY&&(_n.starfieldSpanY=i(o.starfieldSpanY,.4,4,_n.starfieldSpanY)),void 0!==o.starfieldZNear&&(_n.starfieldZNear=r(o.starfieldZNear,20,800,_n.starfieldZNear)),void 0!==o.starfieldZFar&&(_n.starfieldZFar=r(o.starfieldZFar,400,4e3,_n.starfieldZFar)),void 0!==o.starfieldFocalLength&&(_n.starfieldFocalLength=r(o.starfieldFocalLength,100,2e3,_n.starfieldFocalLength)),void 0!==o.starfieldParallaxStrength&&(_n.starfieldParallaxStrength=r(o.starfieldParallaxStrength,0,1200,_n.starfieldParallaxStrength)),void 0!==o.starfieldSpeed&&(_n.starfieldSpeed=r(o.starfieldSpeed,10,1600,_n.starfieldSpeed)),void 0!==o.starfieldDotSizeMul&&(_n.starfieldDotSizeMul=i(o.starfieldDotSizeMul,.2,4,_n.starfieldDotSizeMul)),void 0!==o.starfieldIdleJitter&&(_n.starfieldIdleJitter=i(o.starfieldIdleJitter,0,20,_n.starfieldIdleJitter)),void 0!==o.starfieldFadeDuration&&(_n.starfieldFadeDuration=i(o.starfieldFadeDuration,0,3,_n.starfieldFadeDuration)),void 0!==o.starfield3dWarmupFrames&&(_n.starfield3dWarmupFrames=r(o.starfield3dWarmupFrames,0,240,_n.starfield3dWarmupFrames)),void 0!==o.dvdLogoSpeed&&(_n.dvdLogoSpeed=r(o.dvdLogoSpeed,200,800,_n.dvdLogoSpeed)),void 0!==o.dvdLogoSize&&(_n.dvdLogoSize=i(o.dvdLogoSize,.5,2,_n.dvdLogoSize)),void 0!==o.dvdLogoBallCount&&(_n.dvdLogoBallCount=r(o.dvdLogoBallCount,30,120,_n.dvdLogoBallCount)),void 0!==o.dvdLogoBallSpacing&&(_n.dvdLogoBallSpacing=i(o.dvdLogoBallSpacing,1,2,_n.dvdLogoBallSpacing)),void 0!==o.dvdLogoLetterSpacing&&(_n.dvdLogoLetterSpacing=i(o.dvdLogoLetterSpacing,.5,2,_n.dvdLogoLetterSpacing)),void 0!==o.dvdLogoMassMultiplier&&(_n.dvdLogoMassMultiplier=i(o.dvdLogoMassMultiplier,1,5,_n.dvdLogoMassMultiplier)),void 0!==o.dvdLogoWarmupFrames&&(_n.dvdLogoWarmupFrames=r(o.dvdLogoWarmupFrames,0,240,_n.dvdLogoWarmupFrames)),void 0!==o.elasticCenterRingCount&&(_n.elasticCenterRingCount=r(o.elasticCenterRingCount,2,20,_n.elasticCenterRingCount)),void 0!==o.elasticCenterMassMultiplier&&(_n.elasticCenterMassMultiplier=i(o.elasticCenterMassMultiplier,.5,5,_n.elasticCenterMassMultiplier)),void 0!==o.elasticCenterSpacingMultiplier&&(_n.elasticCenterSpacingMultiplier=i(o.elasticCenterSpacingMultiplier,2,4,_n.elasticCenterSpacingMultiplier)),void 0!==o.elasticCenterElasticStrength&&(_n.elasticCenterElasticStrength=r(o.elasticCenterElasticStrength,0,15e3,_n.elasticCenterElasticStrength)),void 0!==o.elasticCenterMouseRepelStrength&&(_n.elasticCenterMouseRepelStrength=r(o.elasticCenterMouseRepelStrength,3e3,25e3,_n.elasticCenterMouseRepelStrength)),void 0!==o.elasticCenterMouseRadius&&(_n.elasticCenterMouseRadius=r(o.elasticCenterMouseRadius,50,400,_n.elasticCenterMouseRadius)),void 0!==o.elasticCenterDamping&&(_n.elasticCenterDamping=i(o.elasticCenterDamping,.85,.99,_n.elasticCenterDamping)),void 0!==o.elasticCenterWarmupFrames&&(_n.elasticCenterWarmupFrames=r(o.elasticCenterWarmupFrames,0,240,_n.elasticCenterWarmupFrames)),void 0!==o.particleFountainEmissionRate&&(_n.particleFountainEmissionRate=r(o.particleFountainEmissionRate,5,100,_n.particleFountainEmissionRate)),void 0!==o.particleFountainInitialVelocity&&(_n.particleFountainInitialVelocity=r(o.particleFountainInitialVelocity,200,1e4,_n.particleFountainInitialVelocity)),void 0!==o.particleFountainSpreadAngle&&(_n.particleFountainSpreadAngle=r(o.particleFountainSpreadAngle,10,120,_n.particleFountainSpreadAngle)),void 0!==o.particleFountainWaterDrag&&(_n.particleFountainWaterDrag=i(o.particleFountainWaterDrag,.01,.2,_n.particleFountainWaterDrag)),void 0!==o.particleFountainGravityMultiplier&&(_n.particleFountainGravityMultiplier=i(o.particleFountainGravityMultiplier,0,2,_n.particleFountainGravityMultiplier)),void 0!==o.particleFountainUpwardForce&&(_n.particleFountainUpwardForce=r(o.particleFountainUpwardForce,0,800,_n.particleFountainUpwardForce)),void 0!==o.particleFountainMaxParticles&&(_n.particleFountainMaxParticles=r(o.particleFountainMaxParticles,20,300,_n.particleFountainMaxParticles)),void 0!==o.particleFountainLifetime&&(_n.particleFountainLifetime=i(o.particleFountainLifetime,1,30,_n.particleFountainLifetime)),void 0!==o.particleFountainMouseRepelStrength&&(_n.particleFountainMouseRepelStrength=r(o.particleFountainMouseRepelStrength,1e4,1e5,_n.particleFountainMouseRepelStrength)),void 0!==o.particleFountainMouseRepelRadiusVw&&(_n.particleFountainMouseRepelRadiusVw=i(o.particleFountainMouseRepelRadiusVw,1,20,_n.particleFountainMouseRepelRadiusVw)),void 0!==o.particleFountainWarmupFrames&&(_n.particleFountainWarmupFrames=r(o.particleFountainWarmupFrames,0,240,_n.particleFountainWarmupFrames)),void 0!==o.sceneImpactEnabled&&(_n.sceneImpactEnabled=!!o.sceneImpactEnabled),void 0!==o.sceneImpactMul?_n.sceneImpactMul=i(o.sceneImpactMul,0,.05,_n.sceneImpactMul):void 0!==o.brandLogoImpactMul&&(_n.sceneImpactMul=i(o.brandLogoImpactMul,0,.05,_n.sceneImpactMul)),void 0!==o.sceneImpactMobileMulFactor&&(_n.sceneImpactMobileMulFactor=i(o.sceneImpactMobileMulFactor,.25,3,_n.sceneImpactMobileMulFactor)),void 0!==o.sceneImpactLogoCompMul&&(_n.sceneImpactLogoCompMul=i(o.sceneImpactLogoCompMul,.25,6,_n.sceneImpactLogoCompMul)),void 0!==o.sceneImpactOvershoot?_n.sceneImpactOvershoot=i(o.sceneImpactOvershoot,0,.8,_n.sceneImpactOvershoot):void 0!==o.brandLogoOvershoot&&(_n.sceneImpactOvershoot=i(o.brandLogoOvershoot,0,.8,_n.sceneImpactOvershoot)),void 0!==o.sceneImpactAnticipation?_n.sceneImpactAnticipation=i(o.sceneImpactAnticipation,0,.6,_n.sceneImpactAnticipation):void 0!==o.brandLogoAnticipation&&(_n.sceneImpactAnticipation=i(o.brandLogoAnticipation,0,.6,_n.sceneImpactAnticipation)),void 0!==o.sceneImpactPressMs?_n.sceneImpactPressMs=i(o.sceneImpactPressMs,20,300,_n.sceneImpactPressMs):void 0!==o.brandLogoPressMs&&(_n.sceneImpactPressMs=i(o.brandLogoPressMs,20,300,_n.sceneImpactPressMs)),void 0!==o.sceneImpactReleaseMs?_n.sceneImpactReleaseMs=i(o.sceneImpactReleaseMs,40,1200,_n.sceneImpactReleaseMs):void 0!==o.brandLogoReleaseMs&&(_n.sceneImpactReleaseMs=i(o.brandLogoReleaseMs,40,1200,_n.sceneImpactReleaseMs)),void 0!==o.sceneChangeSoundEnabled&&(_n.sceneChangeSoundEnabled=!!o.sceneChangeSoundEnabled),void 0!==o.sceneChangeSoundIntensity&&(_n.sceneChangeSoundIntensity=i(o.sceneChangeSoundIntensity,0,1,_n.sceneChangeSoundIntensity)),void 0!==o.sceneChangeSoundRadius&&(_n.sceneChangeSoundRadius=i(o.sceneChangeSoundRadius,6,60,_n.sceneChangeSoundRadius)),void 0!==o.containerBorder&&(_n.containerBorder=o.containerBorder),void 0!==o.simulationPadding&&(_n.simulationPadding=o.simulationPadding),void 0!==o.contentPadding&&(_n.contentPadding=o.contentPadding),_n.bgLight=void 0!==o.bgLight?o.bgLight:e("--bg-light",_n.bgLight),_n.bgDark=void 0!==o.bgDark?o.bgDark:e("--bg-dark",_n.bgDark),_n.frameColorLight=void 0!==o.frameColorLight?o.frameColorLight:e("--frame-color-light",_n.frameColorLight),_n.frameColorDark=void 0!==o.frameColorDark?o.frameColorDark:e("--frame-color-dark",_n.frameColorDark),void 0!==o.frameColor)_n.frameColor=o.frameColor,_n.frameColorLight=o.frameColor,_n.frameColorDark=o.frameColor;else{const e=_n.frameColorLight||_n.frameColorDark||"#242529";_n.frameColor=e,_n.frameColorLight=e,_n.frameColorDark=e}_n.frameColorLight=_n.frameColor,_n.frameColorDark=_n.frameColor,_n.textColorLight=void 0!==o.textColorLight?o.textColorLight:e("--text-color-light",_n.textColorLight),_n.textColorLightMuted=void 0!==o.textColorLightMuted?o.textColorLightMuted:e("--text-color-light-muted",_n.textColorLightMuted),_n.textColorDark=void 0!==o.textColorDark?o.textColorDark:e("--text-color-dark",_n.textColorDark),_n.textColorDarkMuted=void 0!==o.textColorDarkMuted?o.textColorDarkMuted:e("--text-color-dark-muted",_n.textColorDarkMuted),void 0!==o.edgeLabelInsetAdjustPx&&(_n.edgeLabelInsetAdjustPx=i(o.edgeLabelInsetAdjustPx,-500,500,_n.edgeLabelInsetAdjustPx)),void 0!==o.edgeCaptionDistanceMinPx&&(_n.edgeCaptionDistanceMinPx=r(o.edgeCaptionDistanceMinPx,0,200,_n.edgeCaptionDistanceMinPx)),void 0!==o.edgeCaptionDistanceMaxPx&&(_n.edgeCaptionDistanceMaxPx=r(o.edgeCaptionDistanceMaxPx,0,400,_n.edgeCaptionDistanceMaxPx)),void 0!==o.simulationOverlayIntensity&&(_n.simulationOverlayIntensity=i(o.simulationOverlayIntensity,0,1,_n.simulationOverlayIntensity)),void 0!==o.depthWashOpacity&&(_n.depthWashOpacity=i(o.depthWashOpacity,0,1,_n.depthWashOpacity));const n=["source-over","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion"];if(void 0!==o.depthWashBlendModeLight){const e=o.depthWashBlendModeLight+"";_n.depthWashBlendModeLight=n.includes(e)?e:_n.depthWashBlendModeLight}if(void 0!==o.depthWashBlendModeDark){const e=o.depthWashBlendModeDark+"";_n.depthWashBlendModeDark=n.includes(e)?e:_n.depthWashBlendModeDark}if(void 0!==o.depthWashCenterY&&(_n.depthWashCenterY=i(o.depthWashCenterY,0,1,_n.depthWashCenterY)),void 0!==o.depthWashRadiusScale&&(_n.depthWashRadiusScale=i(o.depthWashRadiusScale,.2,3,_n.depthWashRadiusScale)),void 0!==o.depthWashCenterColorLight&&(_n.depthWashCenterColorLight=o.depthWashCenterColorLight+""),void 0!==o.depthWashEdgeColorLight&&(_n.depthWashEdgeColorLight=o.depthWashEdgeColorLight+""),void 0!==o.depthWashCenterAlphaLight&&(_n.depthWashCenterAlphaLight=i(o.depthWashCenterAlphaLight,0,1,_n.depthWashCenterAlphaLight)),void 0!==o.depthWashEdgeAlphaLight&&(_n.depthWashEdgeAlphaLight=i(o.depthWashEdgeAlphaLight,0,1,_n.depthWashEdgeAlphaLight)),void 0!==o.depthWashCenterColorDark&&(_n.depthWashCenterColorDark=o.depthWashCenterColorDark+""),void 0!==o.depthWashEdgeColorDark&&(_n.depthWashEdgeColorDark=o.depthWashEdgeColorDark+""),void 0!==o.depthWashCenterAlphaDark&&(_n.depthWashCenterAlphaDark=i(o.depthWashCenterAlphaDark,0,1,_n.depthWashCenterAlphaDark)),void 0!==o.depthWashEdgeAlphaDark&&(_n.depthWashEdgeAlphaDark=i(o.depthWashEdgeAlphaDark,0,1,_n.depthWashEdgeAlphaDark)),void 0!==o.topLogoWidthVw&&(_n.topLogoWidthVw=i(o.topLogoWidthVw,0,120,_n.topLogoWidthVw)),void 0!==o.homeMainLinksBelowLogoPx&&(_n.homeMainLinksBelowLogoPx=i(o.homeMainLinksBelowLogoPx,-500,500,_n.homeMainLinksBelowLogoPx)),void 0!==o.footerNavBarTopVh&&(_n.footerNavBarTopVh=i(o.footerNavBarTopVh,0,100,_n.footerNavBarTopVh)),void 0!==o.footerNavBarGapVw&&(_n.footerNavBarGapVw=i(o.footerNavBarGapVw,0,30,_n.footerNavBarGapVw)),_n.linkHoverColor=void 0!==o.linkHoverColor?o.linkHoverColor:e("--link-hover-color",_n.linkHoverColor),void 0!==o.uiHitAreaMul&&(_n.uiHitAreaMul=i(o.uiHitAreaMul,.5,3,_n.uiHitAreaMul)),void 0!==o.uiIconCornerRadiusMul&&(_n.uiIconCornerRadiusMul=i(o.uiIconCornerRadiusMul,0,1,_n.uiIconCornerRadiusMul)),_n.uiIconFramePx=r(void 0!==o.uiIconFramePx?o.uiIconFramePx:a("--ui-icon-frame-size",_n.uiIconFramePx),0,240,_n.uiIconFramePx),_n.uiIconGlyphPx=r(void 0!==o.uiIconGlyphPx?o.uiIconGlyphPx:a("--ui-icon-glyph-size",_n.uiIconGlyphPx),0,120,_n.uiIconGlyphPx),_n.uiIconGroupMarginPx=r(void 0!==o.uiIconGroupMarginPx?o.uiIconGroupMarginPx:a("--ui-icon-group-margin",_n.uiIconGroupMarginPx),-200,200,_n.uiIconGroupMarginPx),void 0!==o.linkTextPadding&&(_n.linkTextPadding=i(o.linkTextPadding,0,200,_n.linkTextPadding)),void 0!==o.linkIconPadding&&(_n.linkIconPadding=i(o.linkIconPadding,0,200,_n.linkIconPadding)),void 0!==o.linkColorInfluence&&(_n.linkColorInfluence=i(o.linkColorInfluence,0,1,_n.linkColorInfluence)),void 0!==o.linkImpactScale&&(_n.linkImpactScale=i(o.linkImpactScale,.5,1,_n.linkImpactScale)),void 0!==o.linkImpactBlur&&(_n.linkImpactBlur=i(o.linkImpactBlur,0,40,_n.linkImpactBlur)),void 0!==o.linkImpactDuration&&(_n.linkImpactDuration=r(o.linkImpactDuration,0,3e3,_n.linkImpactDuration)),void 0!==o.linkHoverNudge&&(_n.linkHoverNudge=i(o.linkHoverNudge,0,4,_n.linkHoverNudge)),void 0!==o.linkHoverIntensityLight&&(_n.linkHoverIntensityLight=i(o.linkHoverIntensityLight,0,1,_n.linkHoverIntensityLight)),void 0!==o.linkHoverIntensityDark&&(_n.linkHoverIntensityDark=i(o.linkHoverIntensityDark,0,1,_n.linkHoverIntensityDark)),void 0!==o.linkHoverIntensityActive&&(_n.linkHoverIntensityActive=i(o.linkHoverIntensityActive,0,1,_n.linkHoverIntensityActive)),void 0!==o.hoverSnapEnabled&&(_n.hoverSnapEnabled=!!o.hoverSnapEnabled),void 0!==o.hoverSnapDuration&&(_n.hoverSnapDuration=r(o.hoverSnapDuration,0,2e3,_n.hoverSnapDuration)),void 0!==o.hoverSnapOvershoot&&(_n.hoverSnapOvershoot=i(o.hoverSnapOvershoot,1,1.35,_n.hoverSnapOvershoot)),void 0!==o.hoverSnapUndershoot&&(_n.hoverSnapUndershoot=i(o.hoverSnapUndershoot,.7,1,_n.hoverSnapUndershoot)),void 0!==o.noiseEnabled&&(_n.noiseEnabled=!!o.noiseEnabled),void 0!==o.noiseSeed&&(_n.noiseSeed=r(o.noiseSeed,0,999999,_n.noiseSeed)),void 0!==o.noiseTextureSize&&(_n.noiseTextureSize=r(o.noiseTextureSize,64,512,_n.noiseTextureSize)),void 0!==o.noiseDistribution){const e=o.noiseDistribution+"";_n.noiseDistribution="uniform"===e||"gaussian"===e?e:_n.noiseDistribution}if(void 0!==o.noiseMonochrome&&(_n.noiseMonochrome=!!o.noiseMonochrome),void 0!==o.noiseChroma&&(_n.noiseChroma=i(o.noiseChroma,0,1,_n.noiseChroma)),void 0!==o.noiseMotion){const e=o.noiseMotion+"";_n.noiseMotion="jitter"===e||"drift"===e||"static"===e?e:_n.noiseMotion}if(void 0!==o.noiseMotionAmount&&(_n.noiseMotionAmount=i(o.noiseMotionAmount,0,2.5,_n.noiseMotionAmount)),void 0!==o.noiseSpeedMs&&(_n.noiseSpeedMs=r(o.noiseSpeedMs,0,1e4,_n.noiseSpeedMs)),void 0!==o.noiseSpeedVariance&&(_n.noiseSpeedVariance=i(o.noiseSpeedVariance,0,1,_n.noiseSpeedVariance)),void 0!==o.noiseFlicker&&(_n.noiseFlicker=i(o.noiseFlicker,0,1,_n.noiseFlicker)),void 0!==o.noiseFlickerSpeedMs&&(_n.noiseFlickerSpeedMs=r(o.noiseFlickerSpeedMs,0,5e3,_n.noiseFlickerSpeedMs)),void 0!==o.noiseBlurPx&&(_n.noiseBlurPx=i(o.noiseBlurPx,0,6,_n.noiseBlurPx)),void 0!==o.noiseContrast&&(_n.noiseContrast=i(o.noiseContrast,.25,5,_n.noiseContrast)),void 0!==o.noiseBrightness&&(_n.noiseBrightness=i(o.noiseBrightness,.25,3,_n.noiseBrightness)),void 0!==o.noiseSaturation&&(_n.noiseSaturation=i(o.noiseSaturation,0,3,_n.noiseSaturation)),void 0!==o.noiseHue&&(_n.noiseHue=i(o.noiseHue,0,360,_n.noiseHue)),void 0!==o.noiseSize&&(_n.noiseSize=i(o.noiseSize,20,600,_n.noiseSize)),void 0!==o.noiseOpacity&&(_n.noiseOpacity=i(o.noiseOpacity,0,1,_n.noiseOpacity)),void 0!==o.noiseOpacityLight&&(_n.noiseOpacityLight=i(o.noiseOpacityLight,0,1,_n.noiseOpacityLight)),void 0!==o.noiseOpacityDark&&(_n.noiseOpacityDark=i(o.noiseOpacityDark,0,1,_n.noiseOpacityDark)),void 0!==o.noiseBlendMode){const e=o.noiseBlendMode+"";_n.noiseBlendMode=["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion"].includes(e)?e:_n.noiseBlendMode}void 0!==o.noiseColorLight&&(_n.noiseColorLight=o.noiseColorLight+""),void 0!==o.noiseColorDark&&(_n.noiseColorDark=o.noiseColorDark+""),void 0!==o.detailNoiseOpacity&&(_n.detailNoiseOpacity=i(o.detailNoiseOpacity,0,1,_n.detailNoiseOpacity)),void 0!==o.wallThickness&&(_n.wallThickness=o.wallThickness),void 0!==o.wallRadius&&(_n.wallRadius=o.wallRadius,_n.cornerRadius=o.wallRadius),void 0!==o.wallInset&&(_n.wallInset=o.wallInset),void 0!==o.wallInset&&(_n.wallInset=o.wallInset),void 0!==o.ballSpacing&&(_n.ballSpacing=o.ballSpacing),void 0!==o.wallPreset&&(_n.wallPreset=o.wallPreset),void 0!==o.wallColorLight&&(_n.frameColorLight=o.wallColorLight,_n.frameColor=o.wallColorLight),void 0!==o.wallColorDark&&(_n.frameColorDark=o.wallColorDark,o.wallColorLight||(_n.frameColor=o.wallColorDark)),void 0!==o.modalOverlayEnabled&&(_n.modalOverlayEnabled=o.modalOverlayEnabled),void 0!==o.modalOverlayOpacity&&(_n.modalOverlayOpacity=o.modalOverlayOpacity),void 0!==o.modalOverlayBlurPx&&(_n.modalOverlayBlurPx=o.modalOverlayBlurPx),void 0!==o.modalOverlayTransitionMs&&(_n.modalOverlayTransitionMs=o.modalOverlayTransitionMs),void 0!==o.modalOverlayTransitionOutMs&&(_n.modalOverlayTransitionOutMs=o.modalOverlayTransitionOutMs),void 0!==o.grungeVideoEnabled&&(_n.grungeVideoEnabled=o.grungeVideoEnabled),void 0!==o.grungeVideoOpacity&&(_n.grungeVideoOpacity=o.grungeVideoOpacity),void 0!==o.grungeVideoBlendMode&&(_n.grungeVideoBlendMode=o.grungeVideoBlendMode),void 0!==o.outerWallEdgeEnabled&&(_n.outerWallEdgeEnabled=o.outerWallEdgeEnabled),void 0!==o.outerWallEdgeWidth&&(_n.outerWallEdgeWidth=o.outerWallEdgeWidth),void 0!==o.outerWallGradientRadius&&(_n.outerWallGradientRadius=o.outerWallGradientRadius),void 0!==o.outerWallTopDarkOpacityLight&&(_n.outerWallTopDarkOpacityLight=o.outerWallTopDarkOpacityLight),void 0!==o.outerWallTopDarkOpacityDark&&(_n.outerWallTopDarkOpacityDark=o.outerWallTopDarkOpacityDark),void 0!==o.outerWallBottomLightOpacityLight&&(_n.outerWallBottomLightOpacityLight=o.outerWallBottomLightOpacityLight),void 0!==o.outerWallBottomLightOpacityDark&&(_n.outerWallBottomLightOpacityDark=o.outerWallBottomLightOpacityDark),void 0!==o.outerWallCastShadowOpacityLight&&(_n.outerWallCastShadowOpacityLight=o.outerWallCastShadowOpacityLight),void 0!==o.outerWallCastShadowOpacityDark&&(_n.outerWallCastShadowOpacityDark=o.outerWallCastShadowOpacityDark),void 0!==o.outerWallCastShadowBlur&&(_n.outerWallCastShadowBlur=o.outerWallCastShadowBlur),void 0!==o.outerWallCastShadowOffset&&(_n.outerWallCastShadowOffset=o.outerWallCastShadowOffset),void 0!==o.outerWallRadiusAdjust&&(_n.outerWallRadiusAdjust=o.outerWallRadiusAdjust),void 0!==o.innerWallTopBevelWidth&&(_n.innerWallTopBevelWidth=o.innerWallTopBevelWidth),void 0!==o.innerWallGradientRadius&&(_n.innerWallGradientRadius=o.innerWallGradientRadius),void 0!==o.innerWallTopLightOpacityLight&&(_n.innerWallTopLightOpacityLight=o.innerWallTopLightOpacityLight),void 0!==o.innerWallTopLightOpacityDark&&(_n.innerWallTopLightOpacityDark=o.innerWallTopLightOpacityDark),void 0!==o.innerWallTopBevelOpacityLight&&(_n.innerWallTopBevelOpacityLight=o.innerWallTopBevelOpacityLight),void 0!==o.innerWallTopBevelOpacityDark&&(_n.innerWallTopBevelOpacityDark=o.innerWallTopBevelOpacityDark),void 0!==o.innerWallOutwardShadowOpacityLight&&(_n.innerWallOutwardShadowOpacityLight=o.innerWallOutwardShadowOpacityLight),void 0!==o.innerWallOutwardShadowOpacityDark&&(_n.innerWallOutwardShadowOpacityDark=o.innerWallOutwardShadowOpacityDark),void 0!==o.innerWallOutwardShadowBlur&&(_n.innerWallOutwardShadowBlur=o.innerWallOutwardShadowBlur),void 0!==o.innerWallOutwardShadowOffset&&(_n.innerWallOutwardShadowOffset=o.innerWallOutwardShadowOffset),void 0!==o.innerWallOutwardShadowSpread&&(_n.innerWallOutwardShadowSpread=o.innerWallOutwardShadowSpread),void 0!==o.innerWallInnerGlowOpacityLight&&(_n.innerWallInnerGlowOpacityLight=o.innerWallInnerGlowOpacityLight),void 0!==o.innerWallInnerGlowOpacityDark&&(_n.innerWallInnerGlowOpacityDark=o.innerWallInnerGlowOpacityDark),void 0!==o.innerWallInnerGlowBlur&&(_n.innerWallInnerGlowBlur=o.innerWallInnerGlowBlur),void 0!==o.innerWallInnerGlowSpread&&(_n.innerWallInnerGlowSpread=o.innerWallInnerGlowSpread),void 0!==o.innerWallInnerGlowOffsetY&&(_n.innerWallInnerGlowOffsetY=o.innerWallInnerGlowOffsetY),void 0!==o.innerWallInnerGlowColor&&(_n.innerWallInnerGlowColor=o.innerWallInnerGlowColor);const s=l();if(void 0!==o.containerBorderVw&&(_n.containerBorderVw=i(o.containerBorderVw,0,20,_n.containerBorderVw)),void 0!==o.simulationPaddingVw&&(_n.simulationPaddingVw=i(o.simulationPaddingVw,0,20,_n.simulationPaddingVw)),void 0!==o.contentPaddingRatio){const e=+o.contentPaddingRatio;Number.isFinite(e)&&(_n.contentPaddingRatio=Math.abs(e)>1?i(e,-500,500,_n.contentPaddingRatio):i(e,-.2,.2,_n.contentPaddingRatio))}if(void 0!==o.contentPaddingHorizontalRatio&&(_n.contentPaddingHorizontalRatio=i(o.contentPaddingHorizontalRatio,.1,3,_n.contentPaddingHorizontalRatio)),void 0!==o.contentPaddingBottomRatio&&(_n.contentPaddingBottomRatio=i(o.contentPaddingBottomRatio,.5,2.5,1.3),document.documentElement.style.setProperty("--abs-content-pad-mul-bottom",_n.contentPaddingBottomRatio+"")),void 0!==o.mobileWallThicknessXFactor&&(_n.mobileWallThicknessXFactor=i(o.mobileWallThicknessXFactor,.5,3,_n.mobileWallThicknessXFactor)),void 0!==o.desktopWallThicknessFactor&&(_n.desktopWallThicknessFactor=i(o.desktopWallThicknessFactor,.5,3,_n.desktopWallThicknessFactor)),void 0!==o.mobileEdgeLabelsVisible&&(_n.mobileEdgeLabelsVisible=!!o.mobileEdgeLabelsVisible),void 0!==o.wallRadiusVw&&(_n.wallRadiusVw=i(o.wallRadiusVw,0,40,_n.wallRadiusVw)),void 0!==o.wallThicknessVw&&(_n.wallThicknessVw=i(o.wallThicknessVw,0,20,_n.wallThicknessVw)),void 0!==o.wallThicknessAreaMultiplier&&(_n.wallThicknessAreaMultiplier=i(o.wallThicknessAreaMultiplier,0,10,_n.wallThicknessAreaMultiplier)),void 0!==o.wallThicknessMinPx&&(_n.wallThicknessMinPx=i(o.wallThicknessMinPx,0,200,_n.wallThicknessMinPx)),void 0!==o.wallThicknessMaxPx&&(_n.wallThicknessMaxPx=i(o.wallThicknessMaxPx,0,200,_n.wallThicknessMaxPx)),!Number.isFinite(_n.containerBorderVw)||0>=_n.containerBorderVw){const e=t("--container-border-vw",null);Number.isFinite(e)&&e>0&&(_n.containerBorderVw=e)}if(!Number.isFinite(_n.wallRadiusVw)||0>=_n.wallRadiusVw){const e=t("--wall-radius-vw",null);Number.isFinite(e)&&e>0&&(_n.wallRadiusVw=e)}if(!Number.isFinite(_n.wallThicknessVw)||0>=_n.wallThicknessVw){const e=t("--wall-thickness-vw",null);Number.isFinite(e)&&e>0&&(_n.wallThicknessVw=e)}Number.isFinite(_n.containerBorderVw)&&_n.containerBorderVw>0||(_n.containerBorderVw=u(_n.containerBorder,s)),Number.isFinite(_n.simulationPaddingVw)&&_n.simulationPaddingVw>=0||(_n.simulationPaddingVw=u(_n.simulationPadding,s)),Number.isFinite(_n.wallRadiusVw)&&_n.wallRadiusVw>0||(_n.wallRadiusVw=u(_n.wallRadius,s)),Number.isFinite(_n.wallThicknessVw)&&_n.wallThicknessVw>0||(_n.wallThicknessVw=u(_n.wallThickness,s)),h()}function g(){return _n}function y(){return _n}function b(e){const t=y(),a=Math.round(+e||0);let o=1;if(t.isMobile){const e=Math.max(0,Math.min(1,+(t.mobileObjectReductionFactor??.7))),n=Math.max(0,+(t.mobileObjectReductionThreshold??0));(0>=n||a>=n)&&(o*=e)}return t.liteModeEnabled&&(o*=Math.max(0,Math.min(1,+(t.liteModeObjectReductionFactor??.6)))),Math.max(0,Math.round(a*o))}function M(e,t,a){_n.canvas=e,_n.ctx=t,_n.container=a}function v(e){_n.currentMode=e}function x(){_n.balls.length=0}function w(){const e=navigator.userAgent||"",t=/iPad/.test(e)||/Mac/.test(e)&&navigator.maxTouchPoints>1,a=/iPhone/.test(e);let o=!1;try{const e=!(!window.matchMedia||!window.matchMedia("(max-width: 600px)").matches),t=[window.visualViewport?.width,window.innerWidth,document.documentElement?.clientWidth].filter(e=>Number.isFinite(e)),a=t.length?Math.min(...t):null;o=e||!!Number.isFinite(a)&&600>=a}catch(s){}const n=!(!t&&!a),i=o;(_n.isMobile!==n||_n.isMobileViewport!==i)&&(_n.isMobile=n,_n.isMobileViewport=i,(_n.isMobile||_n.isMobileViewport)&&(_n.physicsCollisionIterations=4,_n.mouseTrailEnabled=!1));const r=_n.R_MED;S();const l=_n.R_MED;if(Math.abs(l-r)>.1)try{if(Number.isFinite(l)&&l>0&&Array.isArray(_n.balls)&&_n.balls.length)for(let e=0;_n.balls.length>e;e++){const t=_n.balls[e];t&&(t.r=l,t.rBase=l)}}catch(s){}}function S(){const e=_n.ballSizeMin||22,t=_n.ballSizeMax||30,a=_n.ballSizeBreakpointMin||320,o=_n.ballSizeBreakpointMax||1920,n=_n.ballSizeCurve||1,i=l(),r=e+(t-e)*Math.pow(Math.max(0,Math.min(1,(i-a)/(o-a))),n);_n.R_MED=r,_n.R_MIN=r,_n.R_MAX=r}function C(e){const t=+e;return Number.isFinite(t)?0>t?0:t>1?1:t:0}function k(e){const t=((e||"")+"").trim();if(!t)return null;const a="#"===t[0]?t.slice(1):t;if(3!==a.length&&6!==a.length)return null;const o=parseInt(3===a.length?a[0]+a[0]+a[1]+a[1]+a[2]+a[2]:a,16);return Number.isFinite(o)?{r:o>>16&255,g:o>>8&255,b:255&o}:null}function F({r:e,g:t,b:a}){return"#"+((255&e)<<16|(255&t)<<8|255&a).toString(16).padStart(6,"0")}function L({r:e,g:t,b:a}){const o=C(e),n=C(t),i=C(a),r=Math.max(o,n,i),l=r-Math.min(o,n,i);let s=0;return l>0&&(s=r===o?(n-i)/l%6:r===n?(i-o)/l+2:(o-n)/l+4,s*=60,0>s&&(s+=360)),{h:s,s:r>0?l/r:0,v:r}}function I({h:e,s:t,v:a}){const o=(+e%360+360)%360,n=C(t),i=C(a),r=i*n,l=r*(1-Math.abs(o/60%2-1)),s=i-r;let c=0,d=0,u=0;return 60>o?(c=r,d=l,u=0):120>o?(c=l,d=r,u=0):180>o?(c=0,d=r,u=l):240>o?(c=0,d=l,u=r):300>o?(c=l,d=0,u=r):(c=r,d=0,u=l),{r:c+s,g:d+s,b:u+s}}function D(e,{satMul:t=0,valMul:a=0}={}){const o=k(e);if(!o)return((e||"")+"").trim()||"#ffffff";const n=L({r:o.r/255,g:o.g/255,b:o.b/255}),i=(e=>Math.max(0,Math.min(.88,+e||0)))(n.s*(1+(+t||0))),r=C(n.v*(1+(+a||0))),l=I({h:n.h,s:i,v:r});return F({r:Math.round(255*l.r),g:Math.round(255*l.g),b:Math.round(255*l.b)})}function K(e,t,a){return Math.round(e+(t-e)*a)}function T(e,t,a){const o=C(a),n=k(e),i=k(t);return n||i?n?i?F({r:K(n.r,i.r,o),g:K(n.g,i.g,o),b:K(n.b,i.b,o)}):e+"":t+"":"#ffffff"}function P(e){const t=+e;return Number.isFinite(t)?0>t?0:t>255?255:t:0}function E(e,t,a=1){const o=Math.max(1,+a||1),n=k(e),i=k(t);return n||i?n&&i?F({r:P(n.r+(i.r-n.r)*o),g:P(n.g+(i.g-n.g)*o),b:P(n.b+(i.b-n.b)*o)}):t+"":"#ffffff"}function O(e,t,a=.5){const o=C(a),n=[,,,,,,,,];for(let i=0;8>i;i++)n[i]=T(e?.[i],t?.[i],o);return n}function B(e,t,a=1.25){const o=[,,,,,,,,];for(let i=0;8>i;i++)o[i]=t?.[i];const n=[3,5,6,7];for(let i=0;n.length>i;i++){const r=n[i];o[r]=E(e?.[r],t?.[r],a)}return o}function A(e,t){const a=[,,,,,,,,];for(let n=0;8>n;n++)a[n]=e?.[n];const o=[3,5,6,7];for(let n=0;o.length>n;n++){const e=o[n];a[e]=D(a[e],t)}return a}function R(e,t=.2){const a=[,,,,,,,,];for(let i=0;8>i;i++)a[i]=e?.[i];let o=-1,n=-1;for(let i=0;8>i;i++){const e=a[i];if(!e)continue;const t=_(e);t>n&&(n=t,o=i)}return 0>o||(a[o]=D(a[o],{satMul:t,valMul:0})),a}function W(e,t,a,o=t){const n=+e;if(!Number.isFinite(n))return o;const i=Math.floor(n);return t>i?t:i>a?a:i}function z(e,t,a){const o=+e;if(!Number.isFinite(o))return t;const n=Math.floor(o);return t>n?t:n>a?a:n}function $(e){return Array.isArray(e)&&e.every(e=>Number.isFinite(+e))}function G(e){const t=((e||"")+"").trim();if(!t)return null;const a="#"===t[0]?t.slice(1):t;if(3!==a.length&&6!==a.length)return null;const o=parseInt(3===a.length?a[0]+a[0]+a[1]+a[1]+a[2]+a[2]:a,16);return Number.isFinite(o)?{r:(o>>16&255)/255,g:(o>>8&255)/255,b:(255&o)/255}:null}function V(e){return e>.04045?Math.pow((e+.055)/1.055,2.4):e/12.92}function N(e){const t=G(e);return t?.2126*V(t.r)+.7152*V(t.g)+.0722*V(t.b):1}function _(e){const t=G(e);if(!t)return 0;const a=Math.max(t.r,t.g,t.b);return a>0?(a-Math.min(t.r,t.g,t.b))/a:0}function H(e,t){const a=j(e),o=j(t);return(Math.max(a,o)+.05)/(Math.min(a,o)+.05)}function j({r:e,g:t,b:a}){const o=e=>{const t=e/255;return t>.04045?Math.pow((t+.055)/1.055,2.4):t/12.92};return.2126*o(e)+.7152*o(t)+.0722*o(a)}function q(e,t){const a=t||y(),o=e&&e.length?e:[],n=Math.min(7,o.length-1);if(0>n)return[];const i=Number.isFinite(+a.cursorColorLumaMax)?+a.cursorColorLumaMax:.62,r=$(a.cursorColorAllowIndices)?a.cursorColorAllowIndices.map(e=>z(e,0,7)):[],l=$(a.cursorColorDenyIndices)?a.cursorColorDenyIndices.map(e=>z(e,0,7)):[],s=new Set(l),c=r.length?new Set(r):null,d=[];for(let p=0;n>=p;p++){if(s.has(p))continue;if(c&&!c.has(p))continue;const e=o[p];e&&(N(e)>i||.18>_(e)||d.push(p))}if(d.length)return d;const u=[];for(const p of ai)p>n||s.has(p)||c&&!c.has(p)||u.push(p);if(u.length)return u;for(let p=0;n>=p;p++)s.has(p)||c&&!c.has(p)||u.push(p);return u}function Y(e,{forceMode:t}={}){const a=y(),o=a.currentColors,n=q(o,a),i=z(e,0,7),r=n.includes(i)?i:n[0]??i,l=((e,t)=>{const a=e&&e.length?e:[];return a[z(t,0,Math.max(0,Math.min(7,a.length-1)))]||"#000000"})(o,r);return t&&(a.cursorColorMode=t),a.cursorColorIndex=r,a.cursorColorHex=l,(e=>{try{document.documentElement.style.setProperty("--cursor-color",(e+"").trim()||"#000000");const t=(e=>{const t=y(),a=t?.isDarkMode||!1,o=k(e);if(!o)return null;const n=k(a?t.bgDark||"#0a0a0a":t.bgLight||"#f5f5f5");if(!n)return null;const i=.12,r={r:Math.round(n.r+(o.r-n.r)*i),g:Math.round(n.g+(o.g-n.g)*i),b:Math.round(n.b+(o.b-n.b)*i)},l=((e,t,a=null)=>{const o={r:255,g:255,b:255},n={r:0,g:0,b:0},i=a=>{for(let o=0;20>=o;o++){const n=o/20,i={r:Math.round(e.r+(a.r-e.r)*n),g:Math.round(e.g+(a.g-e.g)*n),b:Math.round(e.b+(a.b-e.b)*n)},r=H(i,t);if(r>=4.5)return{rgb:i,t:n,cr:r}}return null},r=i(o),l=i(n);if(r&&l)return"black"===a?l.rgb:"white"===a?r.rgb:r.t>l.t?l.rgb:r.rgb;if(r)return r.rgb;if(l)return l.rgb;const s=H(o,t);return H(n,t)>s?n:o})(o,r,N(F(r))>.45?"black":"white");return`rgb(${l.r} ${l.g} ${l.b})`})(e);t&&document.documentElement.style.setProperty("--cursor-hover-fg",t)}catch(t){}})(l),{index:r,hex:l}}function Z(){const e=y();if("auto"!==e.cursorColorMode)return Y(e.cursorColorIndex,{forceMode:e.cursorColorMode}),!1;const t=q(e.currentColors,e);if(!t.length)return!1;const a=Number.isFinite(+e.o)?+e.o:-1;let o=t[Math.random()*t.length|0];return t.length>1&&o===a&&(o=t[Math.random()*t.length|0],o===a&&(o=t[(t.indexOf(a)+1)%t.length])),e.o=o,Y(o,{forceMode:"auto"}),!0}function X(e){const t=y(),a=Jn[e];if(!a)return Jn.industrialTeal.light;const o=t.isDarkMode||!1;return((e,t,a=!1)=>{if(!e||!Array.isArray(e))return e;const o=[...e],n=G(t);if(!n)return o;const i=L(n),r=.05>i.s?0:i.h,l=[0,1];for(const s of l){const e=o[s];if(!e)continue;const t=G(e);if(!t)continue;const n=L(t),i=Math.max(0,Math.min(.15,.1*n.s));let l=n.v;a&&(l=Math.max(.15,.55*n.v));const c=I({h:r,s:i,v:l});o[s]=F({r:Math.round(255*c.r),g:Math.round(255*c.g),b:Math.round(255*c.b)})}return o})(t.isDarkMode?a.dark:a.light,o?t.bgDark||"#0a0a0a":t.bgLight||"#f5f5f5",o)}function U(){const e=y(),t=e.currentColors;if(!t||0===t.length)return console.warn("No colors available, using fallback"),{color:"#ffffff",distributionIndex:0};const a=(e=>{const t=e?.colorDistribution;return Array.isArray(t)?t:null})(e);if(a&&a.length){let e=0;for(let t=0;a.length>t;t++){const o=+a[t]?.weight;Number.isFinite(o)&&o>0&&(e+=o)}if(e>0){let o=Math.random()*e;for(let e=0;a.length>e;e++){const n=a[e],i=+n?.weight;if(Number.isFinite(i)&&i>0&&(o-=i,0>=o))return{color:t[W(n?.colorIndex,0,7,0)]||t[0]||"#ffffff",distributionIndex:e}}const n=a[a.length-1];return{color:t[W(n?.colorIndex,0,7,0)]||t[0]||"#ffffff",distributionIndex:a.length-1}}}const o=Math.random();let n=0;const i=Math.min(t.length,8,8);for(let r=0;i>r;r++)if(n+=ti[r],n>=o)return{color:t[r],distributionIndex:r};return{color:t[Math.min(t.length-1,7)]||"#ffffff",distributionIndex:0}}function J(){return U().color}function Q(e){const t=y().currentColors;return t&&0!==t.length?t[Math.max(0,Math.min(7,Math.floor(e)))]||"#ffffff":(console.warn("No colors available, using fallback"),"#ffffff")}function ee(e){const t=y();t.currentTemplate=e,t.currentColors=X(e);try{localStorage.setItem(ei,(e||"")+"")}catch(a){}try{const t=document.getElementById("colorSelect");t&&(t.value=e)}catch(a){}"auto"!==t.cursorColorMode&&"manual"!==t.cursorColorMode&&(t.cursorColorMode="auto"),Y(t.cursorColorIndex,{forceMode:t.cursorColorMode}),(()=>{const e=y(),t=e.balls,a="critters"===e.currentMode,o=[0,1];for(let n=0;t.length>n;n++)t[n].color=a?Q(o[Math.floor(Math.random()*o.length)]):J()})(),(e=>{try{const t=document.documentElement,a=(e&&e.length?e:[]).slice(0,8);for(let e=0;8>e;e++)t.style.setProperty("--ball-"+(e+1),a[e]||"#ffffff")}catch(a){}})(t.currentColors),(()=>{const e=y().currentColors;for(let t=1;8>=t;t++){const a=document.getElementById("color"+t),o=document.getElementById(`color${t}Val`);a&&e[t-1]&&(a.value=e[t-1],o&&(o.textContent=e[t-1].toUpperCase()))}})();try{window.dispatchEvent(new CustomEvent("bb:paletteChanged",{detail:{template:e}}))}catch(a){}}function te(){const e=document.getElementById("colorSelect");if(!e)return;e.innerHTML="";for(const a of Qn){const t=Jn[a];if(!t)continue;const o=document.createElement("option");o.value=a,o.textContent=t.label,e.appendChild(o)}const t=y();e.value=t.currentTemplate}function ae(){const e=y(),t=Qn.length?Qn:Object.keys(Jn);if(!t.length)return null;let a=null;try{a=localStorage.getItem(ei)}catch(i){}const o="string"==typeof a?t.indexOf(a):-1,n=t[0>o?Math.random()*t.length|0:(o+1)%t.length];e.currentTemplate=n;try{localStorage.setItem(ei,n)}catch(i){}return n}function oe(e,t=.15){return e*(1+2*(Math.random()-.5)*t)}function ne(e){for(const[t,a]of Object.entries(e))t in ii&&(ii[t]=a)}function ie(){try{"undefined"!=typeof window&&window.dispatchEvent&&window.dispatchEvent(new CustomEvent(vi,{detail:Ce()}))}catch(e){}}function re(){if(!Ai&&(Ai=!0,"undefined"!=typeof window&&window.matchMedia)){const e=window.matchMedia("(prefers-reduced-motion: reduce)");ki=e.matches,e.addEventListener("change",e=>{ki=e.matches})}}function le(e){const t=e&&"object"==typeof e?e:null;if(!t)return;if("string"==typeof t.soundPreset&&Le(t.soundPreset),t.soundConfig&&"object"==typeof t.soundConfig)return void Fe(t.soundConfig);const a={};let o=!1;for(const[n,i]of Object.entries(t))n in ri&&(a[n]=i,o=!0);o&&Fe(a)}async function se(){if(Mi)return!0;try{const e=window.AudioContext||window.webkitAudioContext;return e?(ci=new e({latencyHint:"interactive",sampleRate:44100}),"suspended"===ci.state&&await ci.resume(),(()=>{di=ci.createGain(),di.gain.value=ri.masterGain,fi=ci.createDynamicsCompressor(),fi.threshold.value=-12,fi.knee.value=3,fi.ratio.value=20,fi.attack.value=.001,fi.release.value=.05,gi=ci.createBiquadFilter(),gi.type="highshelf",gi.frequency.value=ri.highShelfFreq,gi.gain.value=ri.highShelfGain,gi.Q.value=.7,mi=ci.createWaveShaper(),mi.curve=((e=.55)=>{const t=1024,a=new Float32Array(t),o=1+8*e;for(let n=0;t>n;n++)a[n]=Math.tanh(o*(2*n/(t-1)-1))/Math.tanh(o);return a})(.55),mi.oversample="2x",pi=ci.createGain(),pi.gain.value=1-ri.reverbWetMix,hi=ci.createGain(),hi.gain.value=ri.reverbWetMix,ui=(()=>{const e=ci.createGain(),t=ci.createGain(),a=[.029,.037,.053,.067].map(e=>{const t=ci.createDelay(.1);return t.delayTime.value=e*ri.reverbDecay,t}),o=a.map(()=>{const e=ci.createGain();return e.gain.value=.4,e}),n=ci.createBiquadFilter();return n.type="lowpass",n.frequency.value=2e3*(1-ri.reverbHighDamp),n.Q.value=.5,a.forEach((t,i)=>{e.connect(t),t.connect(o[i]),o[i].connect(n),o[i].connect(a[(i+1)%a.length])}),n.connect(t),e.connect(t),e.l=t,e})();const e=ui.l;pi.connect(mi),hi.connect(ui),e.connect(mi),mi.connect(gi),gi.connect(fi),fi.connect(di),di.connect(ci.destination),ce(),(()=>{wi=[];for(let e=0;xi>e;e++){const t={id:e,inUse:!1,startTime:0,filter:ci.createBiquadFilter(),envelope:ci.createGain(),panner:ci.createStereoPanner(),reverbSend:ci.createGain(),noiseFilter:ci.createBiquadFilter(),noiseEnvelope:ci.createGain(),osc:null,harmonicOsc:null,sparkleOsc:null,noiseSource:null};t.filter.type="lowpass",t.noiseFilter.type="bandpass",t.noiseFilter.Q.value=1.2,t.filter.connect(t.envelope),t.envelope.connect(t.panner),t.panner.connect(pi),t.panner.connect(t.reverbSend),t.reverbSend.connect(hi),t.noiseFilter.connect(t.noiseEnvelope),t.noiseEnvelope.connect(t.panner),wi.push(t)}})()})(),Mi=!0,bi=!0,ie(),console.log(` Audio unlocked (${(1e3*(ci.baseLatency||0)).toFixed(1)}ms base latency)`),!0):(console.warn("Web Audio API not supported"),!1)}catch(e){return console.error("Failed to unlock audio:",e),!1}}function ce(){if(ci){if(yi)try{yi.disconnect()}catch(e){}else yi=ci.createGain(),yi.gain.value=1;yi.connect(fi||ci.destination)}}function de(){if(Li||!ci)return;const e=ci.sampleRate;Li=ci.createBuffer(1,Math.floor(.045*e),e);const t=Li.getChannelData(0),a=Math.floor(.003*e),o=Math.floor(.01*e);for(let n=0;a>n;n++){const e=Math.exp(-n/a*6);t[n]=(2*Math.random()-1)*e}for(let n=a;o>n;n++){const i=.65*(1-(n-a)/(o-a));t[n]=Math.sin(1760*Math.PI*(n/e))*i}}function ue(){if(Bi&&(clearTimeout(Bi),Bi=null),Ii){try{Ii.stop()}catch(e){}Ii.disconnect(),Di.disconnect(),Ki.disconnect(),Ii=Di=Ki=null}if(Pi){try{Pi.stop()}catch(e){}Pi.disconnect(),Ei.disconnect(),Oi.disconnect(),Pi=Ei=Oi=null}}function pe(e,t){if(!bi||!Mi||!ci||ki)return;ce(),de();const a=ci.createBufferSource();a.buffer=Li;const o=ci.createGain();o.gain.value=e;const n=ci.createBiquadFilter();n.type="lowpass",n.frequency.value=t,a.connect(n).connect(o).connect(yi),a.start()}function he(e=0){if(!bi||!Mi||!ci||ki)return void ue();if(!ii.continuousEnabled)return void ue();const t=Math.abs(e);if(!Number.isFinite(t))return;if(ii.tickMinVelocity>t)return Di&&Di.gain.setTargetAtTime(0,ci.currentTime,.05),Ei&&Ei.gain.setTargetAtTime(0,ci.currentTime,.08),void(Bi||(Bi=setTimeout(ue,ii.stopDelayMs)));Bi&&(clearTimeout(Bi),Bi=null),ci&&(Ii&&Pi||(ce(),de(),Ii=ci.createBufferSource(),Ii.buffer=Li,Ii.loop=!0,Di=ci.createGain(),Di.gain.value=0,Ki=ci.createBiquadFilter(),Ki.type="highpass",Ki.frequency.value=700,Ii.connect(Ki).connect(Di).connect(yi),Ii.start(),(()=>{if(Ti||!ci)return;const e=ci.sampleRate,t=Math.floor(.28*e);Ti=ci.createBuffer(1,t,e);const a=Ti.getChannelData(0);for(let o=0;t>o;o++){const e=o/t,n=.08>e?e/.08:e>.92?(1-e)/.08:1;a[o]=(2*Math.random()-1)*n*.6}})(),Pi=ci.createBufferSource(),Pi.buffer=Ti,Pi.loop=!0,Ei=ci.createGain(),Ei.gain.value=0,Oi=ci.createBiquadFilter(),Oi.type="bandpass",Oi.frequency.value=ii.swishMinHz,Oi.Q.value=.8,Pi.connect(Oi).connect(Ei).connect(yi),Pi.start()));const a=ci.currentTime,o=we((t-ii.tickMinVelocity)/(ii.tickMaxVelocity-ii.tickMinVelocity),0,1);Ii&&Ii.playbackRate.setTargetAtTime(ii.tickMinRate+(ii.tickMaxRate-ii.tickMinRate)*o,a,.04),Di&&Di.gain.setTargetAtTime(ii.tickBaseGain*(.35+.75*o)*Math.max(0,Number.isFinite(ii.tickGainMul)?ii.tickGainMul:1),a,.05);const n=we((t-ii.swishMinVelocity)/(ii.swishMaxVelocity-ii.swishMinVelocity),0,1);if(Ei){const e=Number.isFinite(ii.swishGainMul)?ii.swishGainMul:1;Ei.gain.setTargetAtTime(ii.swishBaseGain*Math.pow(n,1.4)*Math.max(0,e),a,.08)}Oi&&Oi.frequency.setTargetAtTime(ii.swishMinHz+(ii.swishMaxHz-ii.swishMinHz)*n,a,.08)}function fe(){pe(ii.snapGain,1600)}function me(){pe(ii.centerGain,ii.centerFilterHz||1600)}function ge(){pe(ii.openGain,ii.openFilterHz||1800)}function ye(){pe(ii.closeGain,ii.closeFilterHz||1600)}function be(){bi&&Mi&&ci&&!ki&&pe(.099,2200)}function Me(e,t,a=.5,o=null){if(!bi||!Mi||!ci||ki)return;if(ri.collisionMinImpact>t)return;const n=ci.currentTime;if(.005>n-Si)return;if(null!==o){const e=Ci.get(o)||0;if(ri.minTimeBetweenSounds>n-e)return;Ci.set(o,n)}if(Si=n,Ci.size>200){const e=n-.5;for(const[t,a]of Ci)e>a&&Ci.delete(t)}const i=(()=>{for(let t=0;xi>t;t++)if(!wi[t].inUse)return wi[t];let e=wi[0];for(let t=1;xi>t;t++)e.startTime>wi[t].startTime&&(e=wi[t]);return xe(e),e})();i&&((e,t,a,o,n)=>{e.inUse=!0,e.startTime=n;const i=Math.pow(Math.max(0,Math.min(1,a)),ri.intensityExponent),r=oe(t,ri.variancePitch),l=oe(ri.decayTime,ri.varianceDecay)*(1-i*(1-ri.velocityDecayScale)),s=l+.02;let c=ri.minGain+(ri.maxGain-ri.minGain)*i;c*=oe(1,ri.varianceGain);const d=1+(ri.velocityBrightnessScale-1)*i;let u=ri.filterBaseFreq+ri.filterVelocityRange*Math.pow(i,1.3);u*=oe(1,ri.varianceFilter)*d;const p=2*(o-.5)*ri.maxPan,h=.12+.5*(1-i);({gain:c,filterFreq:u}=((e,t,a)=>{const o=we((e-ri.toneSafetyMinHz)/(ri.toneSafetyMaxHz-ri.toneSafetyMinHz),0,1),n=ri.toneSafetyExponent,i=Math.pow(o,n),r=we(1-ri.toneSafetyHighGainAtten*i-ri.toneSafetyLowGainAtten*Math.pow(1-o,n),.6,1);let l=Math.min(t*r,ri.voiceGainMax);const s=we(1-ri.toneSafetyHighBrightAtten*i,.55,1);return{gain:l,filterFreq:we(a*s,ri.filterMinHz,ri.filterMaxHz)}})(r,c,u)),e.filter.frequency.value=u,e.filter.Q.value=ri.filterQ,e.panner.pan.value=p,e.reverbSend.gain.value=h,e.noiseFilter.Q.value=we(ri.noiseTransientQ||1.2,.5,8),e.envelope.gain.cancelScheduledValues(n),e.envelope.gain.setValueAtTime(c,n),e.envelope.gain.exponentialRampToValueAtTime(.001,n+l);const f=ci.createOscillator();if(f.type="sine",f.frequency.value=r,e.osc=f,f.connect(e.filter),(ri.harmonicGain||0)>.001){const t=ci.createOscillator();t.type="sine",t.frequency.value=2*r;const a=ci.createGain();a.gain.cancelScheduledValues(n),a.gain.setValueAtTime(c*ri.harmonicGain,n),a.gain.exponentialRampToValueAtTime(.001,n+l),e.harmonicOsc=t,t.connect(a),a.connect(e.filter),t.onended=()=>{try{a.disconnect()}catch(e){}},t.start(n),t.stop(n+s)}else e.harmonicOsc=null;if((ri.sparkleGain||0)>.001){const t=ci.createOscillator();t.type="sine";const a=ri.sparkleRatioMin||2.3,o=ri.sparkleRatioMax||4.1,i=we(a+Math.random()*(o-a),1.2,10);t.frequency.value=r*oe(i,.02);const d=ci.createGain(),u=Math.max(.012,l*we(ri.sparkleDecayMul||.65,.25,.95));d.gain.cancelScheduledValues(n),d.gain.setValueAtTime(c*ri.sparkleGain,n),d.gain.exponentialRampToValueAtTime(.001,n+u),e.sparkleOsc=t,t.connect(d),d.connect(e.filter),t.onended=()=>{try{d.disconnect()}catch(e){}},t.start(n),t.stop(n+s)}else e.sparkleOsc=null;if(ri.noiseTransientEnabled&&i>.25){const t=(()=>{if(!Fi){const e=2*ci.sampleRate;Fi=ci.createBuffer(1,e,ci.sampleRate);const t=Fi.getChannelData(0);let a=0,o=0,n=0;for(let i=0;e>i;i++){const e=2*Math.random()-1;a=.99765*a+.099046*e,o=.963*o+.2965164*e,n=.57*n+1.0526913*e,t[i]=.25*(a+o+n+.1848*e)}}const e=ci.createBufferSource();return e.buffer=Fi,e.loopStart=1.5*Math.random(),e.loopEnd=e.loopStart+.1,e.loop=!1,e})();e.noiseSource=t;const a=Math.pow(i,1.4);e.noiseFilter.frequency.value=oe(ri.noiseTransientFilterMin+(ri.noiseTransientFilterMax-ri.noiseTransientFilterMin)*a,ri.varianceNoise);const o=ri.noiseTransientGain*ri.velocityNoiseScale*a*c,r=oe(ri.noiseTransientDecay,ri.varianceNoise);e.noiseEnvelope.gain.cancelScheduledValues(n),e.noiseEnvelope.gain.setValueAtTime(o,n),e.noiseEnvelope.gain.exponentialRampToValueAtTime(.001,n+r),t.connect(e.noiseFilter),t.start(n),t.stop(n+r+.01)}else e.noiseSource=null;f.start(n),f.stop(n+s),f.onended=()=>xe(e)})(i,(e=>{const t=1-we((e-8)/47,0,1),a=we(ri.pitchMinHz||145,40,6e3),o=we(ri.pitchMaxHz||280,a+10,12e3),n=we(ri.pitchCurve||1,.5,2.5);return(a+Math.pow(t,n)*(o-a))*oe(1,1.5*(ri.variancePitch||.06))})(e),Math.max(0,Math.min(1,t)),a,n)}function ve({intensity:e=.82,radius:t=18,xPosition:a=.72}={}){Me(t,e,a,null)}function xe(e){if(e.osc){try{e.osc.stop(),e.osc.disconnect()}catch(t){}e.osc=null}if(e.harmonicOsc){try{e.harmonicOsc.stop(),e.harmonicOsc.disconnect()}catch(t){}e.harmonicOsc=null}if(e.sparkleOsc){try{e.sparkleOsc.stop(),e.sparkleOsc.disconnect()}catch(t){}e.sparkleOsc=null}if(e.noiseSource){try{e.noiseSource.stop(),e.noiseSource.disconnect()}catch(t){}e.noiseSource=null}e.inUse=!1}function we(e,t,a){return t>e?t:e>a?a:e}function Se(){return!!Mi&&(bi=!bi,bi||ue(),ie(),bi)}function Ce(){return{isUnlocked:Mi,isEnabled:bi,activeSounds:wi.filter(e=>e.inUse).length,poolSize:xi}}function ke(){return{...ri}}function Fe(e){for(const[t,a]of Object.entries(e))t in ri&&(ri[t]=a);hi&&pi&&"reverbWetMix"in e&&(hi.gain.value=ri.reverbWetMix,pi.gain.value=1-ri.reverbWetMix),gi&&("highShelfFreq"in e||"highShelfGain"in e)&&(gi.frequency.value=ri.highShelfFreq,gi.gain.value=ri.highShelfGain),di&&"masterGain"in e&&(di.gain.value=ri.masterGain)}function Le(e){const t=li[e];if(!t)return!1;si=e;const{label:a,description:o,...n}=t;return Fe(n),!0}function Ie(){return si}function De(){const e=y(),t=e.balls,a=e.canvas,o=e.R_MAX,n=e.ballSpacing||0,i=t.length;if(Wi.length=0,2>i)return Wi;const r=!1!==e.physicsSpatialGridOptimization;if(r){let e=!1;for(let a=0;i>a;a++){const o=t[a];if(o&&!o.isSleeping){e=!0;break}}if(!e)return Wi}const l=Math.max(1,2*o*(1+n)),s=Math.ceil(a.width/l)+1;if(r)for(const c of Ri.values())c.length=0;else Ri.clear();for(let c=0;i>c;c++){const e=t[c],a=(e.y/l|0)*s+(e.x/l|0);let o=Ri.get(a);o||(o=[],Ri.set(a,o)),o.push(c)}for(const[c,d]of Ri){if(0===d.length)continue;const e=c/s|0,a=c%s;for(let o=-1;1>=o;o++)for(let i=-1;1>=i;i++){const r=Ri.get((e+o)*s+(a+i));if(r&&0!==r.length)for(let e=0;d.length>e;e++){const a=d[e];for(let e=0;r.length>e;e++){const o=r[e];if(a>=o)continue;const i=t[a],l=t[o],s=l.x-i.x,c=l.y-i.y,d=i.r+l.r+(i.r+l.r)/2*n,u=s*s+c*c;if(d*d>u){const e=d-Math.sqrt(Math.max(u,Gn.MIN_DISTANCE_EPSILON)),t=Wi.length;let n=zi[t];n||(n={i:0,j:0,overlap:0},zi[t]=n),n.i=a,n.j=o,n.overlap=e,Wi.push(n)}}}}}return Wi}function Ke(e=10){const t=y(),a=t.balls,o=De(),n=t.REST,i=.5*t.DPR,r=t.ballSpacing||0,l=!!t.physicsSkipSleepingCollisions;for(let s=0;e>s;s++)for(let e=0;o.length>e;e++){const{i:c,j:d}=o[e],u=a[c],p=a[d],h=p.x-u.x,f=p.y-u.y,m=u.r+p.r+(u.r+p.r)/2*r,g=h*h+f*f;if(0===g||g>m*m)continue;const y=Math.sqrt(g),b=h/y,M=f/y,v=m-y,x=1/Math.max(u.m,.001),w=1/Math.max(p.m,.001),S=u.isSleeping&&p.isSleeping,C=.8*Math.max(v-i,0)/(x+w),k=C*b,F=C*M;u.x-=k*x,u.y-=F*x,p.x+=k*w,p.y+=F*w;const L="pit"===t.currentMode;if(L&&-.3>M?p.hasSupport=!0:L&&M>.3&&(u.hasSupport=!0),l&&S)continue;if(S)continue;const I=p.vx-u.vx,D=p.vy-u.vy,K=I*b+D*M,T=-15*(t.DPR||1)>K;if((!u.isSleeping||T)&&(!p.isSleeping||T)&&(u.isSleeping&&u.wake(),p.isSleeping&&p.wake(),0>K)){const e=-(1+(30>Math.abs(K)?0:n))*K/(x+w),a=e*b,o=e*M;u.vx-=a*x,u.vy-=o*x,p.vx+=a*w,p.vy+=o*w;const i=I-K*b,r=D-K*M,l=Math.hypot(i,r);if(l>.001){const e=0>i*-M+r*b?-1:1,t=Gn.SPIN_GAIN_TANGENT;u.omega-=e*t*l/Math.max(u.r,1),p.omega+=e*t*l/Math.max(p.r,1)}const d=Math.min(1,Math.abs(K)/(50*(u.r+p.r))),h=Math.min(t.getSquashMax(),.8*d);u.squashAmount=Math.max(u.squashAmount,.8*h),u.squashNormalAngle=Math.atan2(-M,-b),p.squashAmount=Math.max(p.squashAmount,.8*h),p.squashNormalAngle=Math.atan2(M,b),0===s&&Me((u.r+p.r)/2,d,(u.x+p.x)/2/(t.canvas?.width||1),`${c}-${e}`)}}}function Te(e,t,a){const o=y();if(!e)return;const n=$i||Ee(),i=o.DPR||1,r="function"==typeof o.getCanvasCornerRadius?o.getCanvasCornerRadius():o.cornerRadius??o.wallRadius??0,l=Math.max(0,(+r||0)*i),s=Math.max(0,(+o.wallThickness||0)*i),c=Math.max(1,t-2*s),d=Math.max(1,a-2*s),u=Math.max(0,Math.min(l,.5*c,.5*d)),p=Math.max(2,2*i);e.save(),e.fillStyle=n,e.beginPath(),e.moveTo(-p,-p),e.lineTo(t+p,-p),e.lineTo(t+p,a+p),e.lineTo(-p,a+p),e.closePath();const h=s,f=s,m=u;e.moveTo(h+m,f+d),e.lineTo(h+c-m,f+d),e.arcTo(h+c,f+d,h+c,f+d-m,m),e.lineTo(h+c,f+m),e.arcTo(h+c,f,h+c-m,f,m),e.lineTo(h+m,f),e.arcTo(h,f,h,f+m,m),e.lineTo(h,f+d-m),e.arcTo(h,f+d,h+m,f+d,m),e.closePath();try{e.fill("evenodd")}catch(g){e.fill()}e.restore(),o.wallGradientStrokeEnabled&&((e,t,a,o,n,i,r,l,s)=>{const c=Math.max(1,(o.wallGradientStrokeWidth??.33)*n),d=i,u=i,p=s,h=()=>{e.beginPath(),e.moveTo(d+p,u),e.lineTo(d+r-p,u),p>0&&e.arcTo(d+r,u,d+r,u+p,p),e.lineTo(d+r,u+l-p),p>0&&e.arcTo(d+r,u+l,d+r-p,u+l,p),e.lineTo(d+p,u+l),p>0&&e.arcTo(d,u+l,d,u+l-p,p),e.lineTo(d,u+p),p>0&&e.arcTo(d,u,d+p,u,p),e.closePath()};if(o.wallGradientStrokeBottomEnabled??1){const n=.5*t,i=0,r=o.wallGradientStrokeBottomOpacity??1,l=o.wallGradientStrokeBottomColor??"#ffffff",s=e.createRadialGradient(n,i,0,n,i,(o.wallGradientStrokeBottomRadius??1)*a*.7);s.addColorStop(0,Pe(l,r)),s.addColorStop(.1,Pe(l,r)),s.addColorStop(.5,Pe(l,.5*r)),s.addColorStop(1,Pe(l,0)),e.save(),e.strokeStyle=s,e.lineWidth=c,e.lineCap="round",e.lineJoin="round",h(),e.stroke(),e.restore()}if(o.wallGradientStrokeTopEnabled??1){const n=.5*t,i=o.wallGradientStrokeTopOpacity??.5,r=o.wallGradientStrokeTopColor??"#ffffff",l=e.createRadialGradient(n,a,0,n,a,(o.wallGradientStrokeTopRadius??1)*a*.7);l.addColorStop(0,Pe(r,i)),l.addColorStop(.1,Pe(r,i)),l.addColorStop(.5,Pe(r,.5*i)),l.addColorStop(1,Pe(r,0)),e.save(),e.strokeStyle=l,e.lineWidth=c,e.lineCap="round",e.lineJoin="round",h(),e.stroke(),e.restore()}})(e,t,a,o,i,s,c,d,u)}function Pe(e,t){let a,o,n;return 4===e.length?(a=parseInt(e[1]+e[1],16),o=parseInt(e[2]+e[2],16),n=parseInt(e[3]+e[3],16)):(a=parseInt(e.slice(1,3),16),o=parseInt(e.slice(3,5),16),n=parseInt(e.slice(5,7),16)),`rgba(${a}, ${o}, ${n}, ${t})`}function Ee(){try{const e=document.documentElement,t=document.body,a=document.getElementById("bravia-balls"),o=(e,t)=>{if(!e)return"";try{return getComputedStyle(e).getPropertyValue(t).trim()||getComputedStyle(e).getPropertyValue(t).trim()}catch(a){return""}};let n=o(e,"--wall-color");return n||(n=e.classList.contains("dark-mode")||t.classList.contains("dark-mode")?o(e,"--wall-color-dark")||o(e,"--frame-color-dark"):o(e,"--wall-color-light")||o(e,"--frame-color-light")),n||(n=o(t,"--wall-color")||o(a,"--wall-color")),n||"#0a0a0a"}catch{return"#0a0a0a"}}function Oe(e,t,a){return t>e?t:e>a?a:e}function Be(e,t,a){return e+(t-e)*a}function Ae(e,t){switch(t){case Bn.PIT:return e.sizeVariationPit??0;case Bn.FLIES:return e.sizeVariationFlies??0;case Bn.WEIGHTLESS:return e.sizeVariationWeightless??0;case Bn.WATER:return e.sizeVariationWater??0;case Bn.VORTEX:return e.sizeVariationVortex??0;case Bn.MAGNETIC:return e.sizeVariationMagnetic??0;case Bn.BUBBLES:return e.sizeVariationBubbles??0;case Bn.KALEIDOSCOPE:return e.sizeVariationKaleidoscope??0;case Bn.CRITTERS:return e.sizeVariationCritters??0;case Bn.NEURAL:return e.sizeVariationNeural??0;case Bn.PARALLAX_LINEAR:return e.sizeVariationParallaxLinear??0;case Bn.PARALLAX_FLOAT:return e.sizeVariationParallaxFloat??0;default:return 0}}function Re(e,t){const a=Oe(+(e.sizeVariationCap??.12),0,Ni),o=Oe(+(e.sizeVariationGlobalMul??1),0,2),n=Oe(+(Ae(e,t)??0),0,1);return Oe(a*o*n,0,Ni)}function We(e,t){const a=Number.isFinite(e?.R_MIN)?Math.max(1,e.R_MIN):0,o=Number.isFinite(e?.R_MAX)?Math.max(a||1,e.R_MAX):0;if(a>0&&o>0)return Oe(t,a,o);const n=Math.max(1,e?.R_MED||t||1);return Oe(t,.8*n,1.2*n)}function ze(e,t){const{minR:a,maxR:o,medR:n}=((e,t)=>{const a=Math.max(1,e.R_MED||.5*(e.R_MIN+e.R_MAX)||10),o=Oe(+(e.sizeVariationCap??.12),0,Ni),n=Oe(+(e.sizeVariationGlobalMul??1),0,2),i=Oe(+(Ae(e,t)??0),0,1),r=Oe(o*n*i,0,Ni);return{minR:Math.max(1,a*(1-r)),maxR:Math.max(1,a*(1+r)),medR:a}})(e,t);return 1e-6>o-a?n:Be(a,o,Math.random())}function $e(e,t){const a=y(),o=a.waterDrag||.015;e.vx*=1-o,e.vy*=1-o,e.omega*=1-.5*o;const n=a.DPR||1;for(let r=0;_i.length>r;r++){const a=_i[r],o=e.x-a.x,i=e.y-a.y,l=Math.sqrt(o*o+i*i),s=40*n;if(l>a.radius-s&&a.radius+s>l){const n=a.strength*(1-Math.abs(l-a.radius)/s);if(l>.1){const a=i/l;e.vx+=o/l*n*t,e.vy+=a*n*t}}}const i=a.waterDriftStrength||25;e.vx+=Math.sin(.5*e.t+.01*e.x)*i*t,e.vy+=Math.cos(.7*e.t+.01*e.y)*i*t}function Ge(e){const t=y().waterRippleSpeed||300;for(let a=_i.length-1;a>=0;a--){const o=_i[a];o.radius+=t*e,o.age+=e,o.strength*=.96,(o.age>3||10>o.strength)&&_i.splice(a,1)}}function Ve(e,t,a=1){const o=y();_i.push({x:e,y:t,radius:0,strength:(o.waterRippleStrength||15e3)*Math.min(a,5),age:0})}function Ne(e){const t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return t?{r:parseInt(t[1],16),g:parseInt(t[2],16),b:parseInt(t[3],16)}:{r:0,g:0,b:0}}function _e(e,t,a,o){const n=y();if(!a){const e=U();a=e.color,o=e.distributionIndex}const i=ze(n,n.currentMode||Bn.PIT),r=new Vi(e,t,i,a);r.distributionIndex=void 0!==o?o:-1;const l=.5*n.canvas.width>e?1:-1,s=Math.max(.6,Math.min(1.4,i/(.5*(n.R_MIN+n.R_MAX)))),c=180*s;return r.vx=l*(140*s+Math.random()*c),r.vy=120*-Math.random(),r.driftAx=l*(360+420*Math.random())*s,r.driftTime=.22+.28*Math.random(),n.balls.push(r),r}function He(e,t){const a=y(),o=(-1e9===a.mouseX?.5*a.canvas.width:a.mouseX)-e.x,n=(-1e9===a.mouseY?.5*a.canvas.height:a.mouseY)-e.y,i=Math.sqrt(o*o+n*n+1),r=n/i;e.vx+=o/i*4e3*t,e.vy+=4e3*r*t;const l=120*a.DPR;let s=0,c=0,d=0;for(let u=0;a.balls.length>u;u++){const t=a.balls[u];if(t===e)continue;const o=e.x-t.x,n=e.y-t.y,i=o*o+n*n;if(l*l>i&&i>0){const e=Math.sqrt(i),t=1-e/l;s+=o/e*t,c+=n/e*t,d++}}if(d>0){const a=15e3;e.vx+=s/d*a*t,e.vy+=c/d*a*t}e.vx+=1e3*(Math.random()-.5)*t,e.vy+=1e3*(Math.random()-.5)*t}function je(e,t){const a=y(),o=a.repelPower,n=a.repelRadius;if(!a.repellerEnabled||0>=o||0>=n)return;const i=n*a.DPR,r=e.x-a.mouseX,l=e.y-a.mouseY,s=r*r+l*l;if(s>i*i)return;const c=Math.max(Math.sqrt(s),1e-4),d=r/c,u=l/c,p=20*o*Math.pow(Math.max(0,1-c/i),a.repelSoft||3.4),h=Math.max(.25,e.m/a.MASS_BASELINE_KG);e.vx+=d*p*t/h,e.vy+=u*p*t/h}function qe(e,t){const a=y();if(!a.mouseInCanvas)return;const o=a.weightlessRepelRadius??0,n=a.weightlessRepelPower??0;if(0>=o||0>=n)return;const i=o*(a.DPR||1),r=e.x-a.mouseX,l=e.y-a.mouseY,s=r*r+l*l;if(s>i*i)return;const c=Math.max(Math.sqrt(s),1e-4),d=r/c,u=l/c,p=20*n*Math.pow(Math.max(0,1-c/i),a.weightlessRepelSoft??2.2),h=Math.max(.25,e.m/a.MASS_BASELINE_KG);e.vx+=d*p*t/h,e.vy+=u*p*t/h}function Ye(e){Qi=e}function Ze(){if(Hi=document.getElementById("c"),!Hi)return void console.error("Canvas not found");ji=Hi.getContext("2d",{alpha:!0,desynchronized:!0,willReadFrequently:!1}),ji||(ji=Hi.getContext("2d"),console.warn(" Desynchronized mode unavailable, using standard context")),(()=>{const e=window.devicePixelRatio||1;navigator.connection?.saveData||4>=navigator.hardwareConcurrency||/Android|iPhone|iPad|iPod/i.test(navigator.userAgent)?(Zi=Math.min(e,1.25),console.log(` Adaptive DPR: Reduced to ${Zi}x for performance`)):Zi=Math.min(e,2),n(Zi)})(),ji.imageSmoothingEnabled=!1;const e=()=>{Ji&&cancelAnimationFrame(Ji),Ji=requestAnimationFrame(()=>{Xe(),Ji=null})};if(window.addEventListener("resize",e,{passive:!0}),window.addEventListener("orientationchange",()=>{setTimeout(Xe,100),setTimeout(Xe,300)},{passive:!0}),window.visualViewport&&(window.visualViewport.addEventListener("resize",e,{passive:!0}),window.visualViewport.addEventListener("scroll",e,{passive:!0})),"undefined"!=typeof ResizeObserver){const t=document.getElementById("bravia-balls");t&&new ResizeObserver(()=>{e()}).observe(t)}console.log(` Renderer optimized (DPR: ${Zi.toFixed(2)}, desync: ${ji.getContextAttributes?.()?.desynchronized??"unknown"})`)}function Xe(){if(!Hi)return;const e=y();try{const e=window.visualViewport,t=e&&"number"==typeof e.height?e.height:window.innerHeight,a=e&&"number"==typeof e.width?e.width:window.innerWidth,o=t>0?t:window.innerHeight,n=a>0?a:window.innerWidth,i=e&&"number"==typeof e.offsetTop?e.offsetTop:0,r=e&&"number"==typeof e.offsetLeft?e.offsetLeft:0,l=Number.isFinite(i)?i:0,s=Number.isFinite(r)?r:0;let c=l+o/2,d=s+n/2;d>0||(d=window.innerWidth/2),c>0||(c=window.innerHeight/2);const u=document.documentElement?.style;u?.setProperty("--abs-viewport-h",o+"px"),u?.setProperty("--abs-vv-offset-top",l+"px"),u?.setProperty("--abs-vv-offset-left",s+"px"),u?.setProperty("--abs-vv-h",o+"px"),u?.setProperty("--abs-vv-w",n+"px"),u?.setProperty("--abs-vv-center-x",d+"px"),u?.setProperty("--abs-vv-center-y",c+"px")}catch(d){}try{h(),f()}catch(d){}try{w()}catch(d){}const t=e.container||document.getElementById("bravia-balls"),a=t?t.clientWidth:window.innerWidth,o=t?t.clientHeight:window.innerHeight;if(0>=a||0>=o)return;const n=a+2,i=o+2,r=Zi,l=Math.ceil(n*r),s=Math.ceil(i*r);if(0>=l||0>=s)return;if(l===Xi&&s===Ui)return;if(Xi>0&&Ui>0&&e.balls&&e.balls.length>0){const t=l/Xi,a=s/Ui;if(t>.1&&10>t&&a>.1&&10>a){const o=e.balls;for(let e=0;o.length>e;e++){const n=o[e];if(!n)continue;n.x*=t,n.y*=a;const i=n.r||10;n.x=Math.max(i,Math.min(l-i,n.x)),n.y=Math.max(i,Math.min(s-i,n.y)),n.isSleeping&&(n.isSleeping=!1,n.sleepTimer=0)}}}Xi=l,Ui=s;const c=Hi.width!==l||Hi.height!==s;if(c&&(Hi.width=l,Hi.height=s,ji&&(ji.imageSmoothingEnabled=!1)),Hi.style.width=n+"px",Hi.style.height=i+"px",c&&((e=>{e.style.filter=""})(Hi),Qi))try{Qi()}catch(d){}try{const t=0;(Hi.width!==er||Hi.height!==tr||Math.abs(t-ar)>.001)&&(er=Hi.width,tr=Hi.height,ar=t,e.canvasClipPath=((e,t,a)=>{const o=Math.max(0,Math.min(a,.5*Math.min(e,t)));if("undefined"==typeof Path2D)return null;const n=new Path2D;return o>0?(n.moveTo(o,0),n.lineTo(e-o,0),n.arcTo(e,0,e,o,o),n.lineTo(e,t-o),n.arcTo(e,t,e-o,t,o),n.lineTo(o,t),n.arcTo(0,t,0,t-o,o),n.lineTo(0,o),n.arcTo(0,0,o,0,o),n.closePath(),n):(n.rect(0,0,e,t),n)})(Hi.width,Hi.height,t))}catch(d){}}function Ue(){return Hi}function Je(){return ji}function Qe(e,t,a,o,n){e.u=e.r,ir.set(e,t*(.6+n/3*.8)),nr.set(e,Math.random()*Math.PI*2),rr.set(e,Math.random()*Math.PI*2),sr.set(e,.8*a*(.8+n/3*.4)),lr.set(e,.4*a*(.7+.6*Math.random()))}function et(e,t){const a=y();if(a.currentMode!==Bn.VORTEX)return;const o=a.mouseInCanvas?a.mouseX:a.canvas?.5*a.canvas.width:0,n=a.mouseInCanvas?a.mouseY:a.canvas?.5*a.canvas.height:0;let i=nr.get(e);const r=ir.get(e);let l=rr.get(e);const s=lr.get(e),c=sr.get(e);void 0!==i&&void 0!==r||(Qe(e,void 0!==a.vortexRadius?a.vortexRadius:300,a.vortexSpeedMultiplier??1,0,0),i=nr.get(e),l=rr.get(e));const d=a.vortexRotationDirection??1,u=a.vortexDepthVariation??.6,p=a.vortexSpiralTightness??.5;i+=c*d*t,i>2*Math.PI&&(i-=2*Math.PI),0>i&&(i+=2*Math.PI),nr.set(e,i),l+=s*d*t,l>2*Math.PI&&(l-=2*Math.PI),0>l&&(l+=2*Math.PI),rr.set(e,l);const h=(Math.sin(l)+1)/2,f=r*(1+(1-h)*p*.4),m=o+Math.cos(i)*f,g=n+Math.sin(i)*f,b=e.x-o,M=e.y-n,v=Math.max(30,Math.sqrt(b*b+M*M)),x=f*c*d,w=-Math.sin(i)*d*x,S=Math.cos(i)*d*x,C=a.vortexSwirlStrength||450,k=-(v-f)*C*.2,F=M/v;e.vx+=b/v*k*t,e.vy+=F*k*t;const L=S-e.vy,I=.25*C;e.vx+=(w-e.vx)*I*t,e.vy+=L*I*t;const D=.15*C,K=m-e.x,T=g-e.y,P=Math.max(1,Math.sqrt(K*K+T*T));if(P>.2*f){const a=T/P*D;e.vx+=K/P*D*t,e.vy+=a*t}void 0===e.u&&(e.u=e.rBase||e.r),e.r=e.u*(.4+.6*(1-h*u));const E=Math.max(0,Math.min(1,a.vortexDrag??.01));e.vx*=1-E,e.vy*=1-E}function tt(e,t){const a=y();if(a.currentMode!==Bn.MAGNETIC)return;if(!a.mouseInCanvas)return;const o=a.DPR||1,n=a.magneticStrength||65e3,i=a.magneticRadius||0,r=a.mouseX-e.x,l=a.mouseY-e.y,s=r*r+l*l,c=Math.max(30*o,Math.sqrt(s));if(i>0&&c>i*o)return;const d=n/s*1e3,u=l/c;e.vx+=r/c*d*t,e.vy+=u*d*t,e.omega=0;const p=(a.magneticMaxVelocity||2800)*o,h=Math.sqrt(e.vx*e.vx+e.vy*e.vy);h>p&&(e.vx=e.vx/h*p,e.vy=e.vy/h*p);const f=a.magneticDamping??.998;e.vx*=f,e.vy*=f}function at(){const e=y();if(e.currentMode===Bn.MAGNETIC)for(let t=0;e.balls.length>t;t++)e.balls[t].alpha=1}function ot(e,t,a,o,n=!1,i){const r=y(),l=r.DPR||1,s=.9+.2*Math.random(),c=ze(r,Bn.BUBBLES)*s,d=Number.isFinite(i)?Math.max(0,Math.min(1,i)):n?1:0,u=new Vi(e,t,c*(1-Math.pow(1-d,3)),a);return u.distributionIndex=o,u.isBubble=!0,u.baseRadius=c,u.targetRadius=c,u.wobblePhase=Math.random()*Math.PI*2,u.wobbleFreq=2+3*Math.random(),u.vx=28*(Math.random()-.5)*l,u.vy=(-160-140*Math.random())*l,u.spawning=1>d&&!n,u.spawnProgress=d,u.dissipating=!1,u.dissipateProgress=0,u.alpha=1,u.microBurst=!1,u.microTime=0,u.microLife=0,u.microStartRadius=0,u.wobbleMul=.6+.8*Math.random(),r.balls.push(u),u}function nt(e){const t=y(),a=t.canvas;if(!a)return;const o=t.DPR||1,n=a.width,i=a.height;e.x=Math.random()*n,e.y=i+(60+30*Math.random())*o,e.vx=20*(Math.random()-.5)*o,e.vy=(-50-50*Math.random())*o,e.wobblePhase=Math.random()*Math.PI*2,e.wobbleFreq=2+3*Math.random(),e.color=J();const r=.9+.2*Math.random();e.targetRadius=ze(t,Bn.BUBBLES)*r,e.baseRadius=e.targetRadius,e.r=0,e.rBase=0,e.spawning=!0,e.spawnProgress=0,e.dissipating=!1,e.dissipateProgress=0,e.alpha=1,e.microBurst=!1,e.microTime=0,e.microLife=0,e.microStartRadius=0,e.wobbleMul=.6+.8*Math.random()}function it(e,t){const a=y();if(a.currentMode!==Bn.BUBBLES)return;if(!e.isBubble)return;const o=a.canvas;if(!o)return;if(e.microBurst){e.microTime+=t;const a=e.microLife||.18,o=Math.min(1,a>0?e.microTime/a:1),n=Math.max(0,1-o);return e.vx*=.94,e.vy*=.9,e.r=e.microStartRadius*n,e.rBase=e.r,e.alpha=Math.max(0,1-o),void(1>o||(e.microBurst=!1,nt(e)))}e.spawning&&(e.spawnProgress+=3*t,e.r=e.targetRadius*(1-Math.pow(1-Math.min(1,e.spawnProgress),3)),e.rBase=e.r,1>e.spawnProgress||(e.spawning=!1,e.r=e.targetRadius,e.rBase=e.targetRadius));const n=.01*(a.bubblesWobble||40)*(e.wobbleMul||1);if(e.vy-=(a.bubblesRiseSpeed||150)*a.DPR*t,e.wobblePhase+=e.wobbleFreq*t,e.vx+=Math.sin(e.wobblePhase)*n*100*t,e.vx*=.92,e.vy*=.96,a.mouseInCanvas){const o=e.x-a.mouseX,n=e.y-a.mouseY,i=Math.sqrt(o*o+n*n),r=Math.max(0,a.bubblesDeflectRadius||0)*a.DPR;if(r>i&&i>1){const a=3e3*Math.pow(1-i/r,3),l=o/i,s=n/i;if(e.vx+=l*a*t,e.vy+=s*a*t,.3*r>i){const a=500*(1-i/(.3*r));e.vx+=l*a*t,e.vy+=s*a*t}}}if(2*e.targetRadius>e.y&&!e.spawning&&!e.microBurst)return e.microBurst=!0,e.microTime=0,e.microLife=.18,e.microStartRadius=Math.max(.2,.5*e.targetRadius),e.r=e.microStartRadius,e.rBase=e.r,e.alpha=1,e.vx=40*(Math.random()-.5)*a.DPR,void(e.vy=-(260+140*Math.random())*a.DPR);(4*-e.r>e.x||e.x>o.width+4*e.r)&&nt(e)}function rt(){}function lt(e,t,a){return Math.max(t,Math.min(a,e))}function st(e){const t=e.canvas;return t?lt(Math.min(t.width,t.height)/1e3,.35,3):1}function ct(e,t,a,o){for(let n=0;e.length>n;n++){const i=e[n],r=t-i.x,l=a-i.y,s=o+i.r;if(s*s>r*r+l*l)return!0}return!1}function dt(e,t,a,o=10){const n=2*o;return e.v+=o*o*(t-e.x)*a,e.v*=Math.max(0,1-n*a),e.x+=e.v*a,e.x}function ut(e,t,a,o){const n=y(),i=Math.max(2,n.wallInset||3)*(n.DPR||1),r=i+e.r,l=t-i-e.r,s=i+e.r,c=a-i-e.r,d=.92,u=Math.max(0,1-.15*o);r>e.x?(e.x=r,e.vx=Math.abs(e.vx)*d*u):e.x>l&&(e.x=l,e.vx=-Math.abs(e.vx)*d*u),s>e.y?(e.y=s,e.vy=Math.abs(e.vy)*d*u):e.y>c&&(e.y=c,e.vy=-Math.abs(e.vy)*d*u)}function pt(e){return{count:e.kaleidoscope3BallCount??e.kaleidoscopeBallCount??150,wedges:e.kaleidoscope3Wedges??e.kaleidoscopeWedges??10,speed:e.kaleidoscope3Speed??e.kaleidoscopeSpeed??1.2,complexity:1.35,spawnAreaMul:e.kaleidoscope3SpawnAreaMul??e.kaleidoscopeSpawnAreaMul??1.05,sizeVariance:e.kaleidoscope3SizeVariance??e.kaleidoscopeSizeVariance??.5}}function ht(e){return e===Bn.KALEIDOSCOPE}function ft(e){return pt(e).complexity}function mt(e,t){const a=y();if(!ht(a.currentMode))return;const o=a.canvas;if(!o)return;const n=.5*o.width,i=.5*o.height,r=st(a),l=lt(pt(a).speed??1,.2,2),s=performance.now(),c=120>s-(a.lastPointerMoveMs||0);void 0===a.p&&(a.p=0);const d=c?1:0;a.p+=(d-a.p)*(1-Math.exp(-t/Math.max(1e-4,d>a.p?.45:.65)));const u=a.p,p=ft(a),h=a.prefersReducedMotion?0:Math.max(0,a.kaleidoscopeIdleDrift??.012)*p*(1-Math.min(1,.7*u));if(h>0){const a=(e.M??0)+.02*e.age+35e-5*s,o=Math.cos(a)*h*9,n=Math.sin(1.1*a)*h*9;e.vx+=o*t,e.vy+=n*t}const f=e.x-n,m=e.y-i,g=Math.max(dr,Math.sqrt(f*f+m*m)),b=f/g,M=m/g,v=b,x=30*r*l*u,w=-2.5*(g-(void 0!==e.S?e.S:g))*l*u;e.vx+=(-M*x+b*w)*t,e.vy+=(v*x+M*w)*t,e.vx*=.992,e.vy*=.992}function gt(){fr=[];for(let e=0;64>e;e++)fr[e]=[]}function yt(e,t,a){const o=Math.min(7,Math.max(0,e.x/t*8|0)),n=Math.min(7,Math.max(0,e.y/a*8|0)),i=[];for(let r=-1;1>=r;r++){const t=n+r;if(t>=0&&8>t)for(let a=-1;1>=a;a++){const n=o+a;if(0>n||n>=8)continue;const r=fr[8*t+n];for(let t=0;r.length>t;t++)r[t]!==e&&i.push(r[t])}}return i}function bt(){const e=y(),t=e.hiveJourneyPointCount||4,a=e.hiveJourneyPointMargin||.05;wr=[];const o=1-2*a,n=[{xMin:0,xMax:.5,yMin:0,yMax:.5},{xMin:.5,xMax:1,yMin:0,yMax:.5},{xMin:0,xMax:.5,yMin:.5,yMax:1},{xMin:.5,xMax:1,yMin:.5,yMax:1}];for(let i=0;t>i;i++){let e,t;if(4>i){const r=n[i];e=a+Math.max(0,r.xMin*o)+Math.random()*(r.xMax-r.xMin)*o,t=a+Math.max(0,r.yMin*o)+Math.random()*(r.yMax-r.yMin)*o}else e=a+Math.random()*o,t=a+Math.random()*o;wr.push({x:e,y:t})}}function Mt(e){if(0===wr.length&&bt(),(y().hivePathAdherence??.75)>Math.random()&&wr.length>1){const t=(e+1)%wr.length;return{point:wr[t],index:t}}{let t=Math.floor(Math.random()*wr.length);return wr.length>1&&t===e&&(t=(t+1)%wr.length),{point:wr[t],index:t}}}function vt(){mr=.5,gr=2+3*Math.random(),yr=0,xr=!1,vr=0,bt()}function xt(){Cr.fill(0)}function wt(e,t,a,o){const n=Math.min(31,Math.max(0,e/a*Sr|0)),i=Math.min(31,Math.max(0,t/o*Sr|0));let r=0,l=0;const s=Cr[i*Sr+n];return n>0&&(r-=Cr[i*Sr+(n-1)]-s),31>n&&(r+=Cr[i*Sr+(n+1)]-s),i>0&&(l-=Cr[(i-1)*Sr+n]-s),31>i&&(l+=Cr[(i+1)*Sr+n]-s),{dx:r,dy:l}}function St(e,t,a){return t>e?t:e>a?a:e}function Ct(e){return e>Math.PI?e-=2*Math.PI:-Math.PI>e&&(e+=2*Math.PI),e}function kt(e){const t=y();if(!t.canvas)return;const a=t.canvas.width,o=t.canvas.height,n=t.balls;a===kr&&o===Fr||(kr=a,Fr=o,xt(),vt(),gt()),(e=>{const t=Math.pow(.997,60*e);for(let a=0;1024>a;a++)Cr[a]*=t})(e),((e,t,a)=>{for(let o=0;64>o;o++)fr[o].length=0;for(let o=0;e.length>o;o++){const n=e[o],i=Math.min(7,Math.max(0,n.x/t*8|0));fr[8*Math.min(7,Math.max(0,n.y/a*8|0))+i].push(n)}})(n,a,o);let i=0,r=0;for(let c=0;n.length>c;c++){const e=n[c];e.vx*e.vx+e.vy*e.vy>200&&i++,r+=e.C||0}mr=.95*mr+.05*(n.length>0?i/n.length:0),yr=n.length>0?r/n.length:0;const l=t.critterHiveStirInterval??5,s=t.critterHiveWaveSpeed??.4;gr-=e,gr>0&&mr>=.3||(br=.1+.8*Math.random(),Mr=.1+.8*Math.random(),vr=0,xr=!0,gr=l*(.6+.8*Math.random())),xr&&(vr+=e*s,vr>1.5&&(xr=!1))}function Ft(e,t){const a=y(),o=a.canvas;if(!o)return;const n=a.DPR||1,i=Math.max(0,a.critterSpeed||0),r=Math.max(50,a.critterMaxSpeed||0)*n,l=Math.max(0,a.critterStepHz||0),s=a.critterStepSharpness??2.4,c=Math.max(0,a.critterTurnNoise||0),d=Math.max(0,a.critterTurnSeek||0),u=Math.max(0,(a.critterAvoidRadius||0)*n),p=Math.max(0,a.critterAvoidForce||0),h=Math.max(0,a.critterEdgeAvoid||0),f=Math.max(0,a.critterMousePull||0),m=Math.max(0,a.critterMouseRadiusVw||0),g=o.width,b=o.height,M=e.k||1,v=i*M*.7,x=l*M;let w=e.F||0,S=e.L||0,C=e.I??S,k=e.D||0,F=e.C||0,L=e.K||w,I=e.T||0,D=e.P||0,K=e.O||0,T=e.B||0,P=e.A||0,E=e.R??.5,O=e.W??.5,B=e.$||5,A=e.V??0,R=e.N??.7;const W=e._||.025,z=e.H||.5;let $=e.q||0,G=e.Y||0;const V=e.Z||.5,N=e.X||.5,_=e.U||0,H=e.J||.2;let j=0,q=0,Y=0,Z=0,X=0;if(e.vx*=Math.pow(.88,60*t),e.vy*=Math.pow(.88,60*t),f>0&&-1e9!==a.mouseX){const o=(window.innerWidth||g)/100,i=Math.max(1,m*o)*n,r=1.5*i,l=e.x-a.mouseX,s=e.y-a.mouseY,c=Math.sqrt(l*l+s*s)+1e-6;if(r>c)if(Z=l/c,X=s/c,i>c){const e=1-c/i;Y=e*e*V,F=Math.min(1,F+3*Y*t),j+=Z*Y*1.5,q+=X*Y*1.5}else{const e=.3*(1-(c-i)/(r-i))*V;j+=Z*e*2,q+=X*e*2,F=Math.min(1,F+2*e*t)}}if(u>0){const a=yt(e,g,b),o=1.5*u,n=o*o;let i=0,r=0;for(let t=0;a.length>t;t++){const l=a[t],s=e.x-l.x,c=e.y-l.y,d=s*s+c*c;if(d>0&&n>d){const e=l.C||0;e>.2&&(i+=e*(1-1/(1/Math.sqrt(d))/o),r++)}}r>0&&(F=Math.min(1,F+i/r*V*.5*t))}if(.01>Y&&(F=Math.max(0,F-2*t),.15>F&&F>.01&&0>=P&&(P=.3+.5*Math.random())),P>0&&(P=Math.max(0,P-t)),I>0&&(I=Math.max(0,I-t)),D>0&&(D=Math.max(0,D-t)),K>0&&(K=Math.max(0,K-t)),T-=t,T>0||(T=1+1.5*Math.random(),200>e.vx*e.vx+e.vy*e.vy&&(k>.2&&(k=.2),R=Math.min(1,R+.2))),xr){const t=e.x/g,a=e.y/b,o=.12,n=Math.abs(Math.sqrt((t-br)*(t-br)+(a-Mr)*(a-Mr))-vr);o>n&&(k>.1&&(k=.1),R=Math.min(1,R+.15*(1-n/o)))}const U=.5*yr,J=St(F,0,1),Q=P>0;R=Math.max(.3,R-(k>0?.003:.5*W)*(1+.5*J)*t),R=Math.min(1,R+.02*t+(.2>J?.05*t:0));const ee=.8+.2*R,te=a.hiveGoalSwitchMinS??4,ae=a.hiveGoalSwitchMaxS??14,oe=(a.hiveGoalReachedRadius??50)*n,ne=a.hiveGoalAttractionStrength??.5;if(B-=t,0>=B||J>.5){const e=Mt(A);E=e.point.x,O=e.point.y,A=e.index;const t=Math.max(0,ae-te);B=te+Math.random()*t+5*(1-R)}if(.15>J&&0>=k){const t=E*g-e.x,a=O*b-e.y,o=Math.sqrt(t*t+a*a)+1e-6;oe>o&&(B=Math.min(B,1+2*Math.random()));const n=ne*R*(1-6*J);j+=t/o*n,q+=a/o*n}if(z>.4&&.2>J){const t=wt(e.x,e.y,g,b),a=.2*z*(1-5*J);j-=t.dx*a,q-=t.dy*a}G=Y>G?Y:Math.max(0,G-3*t),$+=t*(1.5+2*J),$>2*Math.PI&&($-=2*Math.PI),J>.4&&0>=D&&4.8*t>Math.random()&&(D=.03+.04*Math.random());const ie=D>0;if(k>0)k=Math.max(0,k-t),K>0&&(w=Ct(w+.15*Math.sin(15*K)*t)),18*t>Math.random()&&(e.vx+=1*(Math.random()-.5),e.vy+=1*(Math.random()-.5)),k>0||(I=.12,K=0);else if(.1>J&&!Q&&.3>U&&(.08+.12*N)*(1-U)*t>Math.random()){const e=.15+.1*N,t=.3+.5*N;k=e+Math.random()*(t-e),K=k}Q&&P>1+.5*Math.random()&&0>=k&&18*t>Math.random()&&(k=.1+.15*Math.random()),J>.2&&(k=0,K=0),.15>J&&(L=Ct(L+(2*Math.random()-1)*H*t));const re=Math.max(24*n,.08*Math.min(g,b)),le=e.x,se=e.y;if(J>.1&&h>0)re>le?j+=(1-le/re)*h:le>g-re&&(j-=(1-(g-le)/re)*h),re>se?q+=(1-se/re)*h:se>b-re&&(q-=(1-(b-se)/re)*h);else if(.1>J){const e=.3,t=2*re;t>le?j-=(1-le/t)*e:le>g-t&&(j+=(1-(g-le)/t)*e),t>se?q-=(1-se/t)*e:se>b-t&&(q+=(1-(b-se)/t)*e)}if(J>.03&&(0!==Z||0!==X)){const e=_*J,t=Math.cos(e),a=Math.sin(e),o=f*(.6+J);j+=(Z*t-X*a)*o,q+=(Z*a+X*t)*o}if(.2>J){const t=wt(e.x,e.y,g,b),a=.3*(1-5*J);j+=t.dx*a,q+=t.dy*a}if(((e,t,a,o,n)=>{const i=((e,t,a,o)=>{const n=Math.min(31,Math.max(0,e/a*Sr|0));return Math.min(31,Math.max(0,t/o*Sr|0))*Sr+n})(e,t,a,o);Cr[i]=Math.min(1,Cr[i]+n)})(e.x,e.y,g,b,1.5*t),.1>J&&0>=k&&(j+=.4*Math.cos(L),q+=.4*Math.sin(L)),u>0&&p>0){const a=yt(e,g,b),o=u*u;let n=0,i=0,r=0;for(let t=0;a.length>t;t++){const l=a[t],s=e.x-l.x,c=e.y-l.y,d=s*s+c*c;if(d>0&&o>d){const e=1/Math.sqrt(d),t=1-1/e/u;n+=s*e*t*t,i+=c*e*t*t,r++}}if(r>0){const a=1/r;j+=n*a*1.2,q+=i*a*1.2,e.vx+=n*a*.5*p*t,e.vy+=i*a*.5*p*t}}const ce=(2*Math.random()-1)*c*t;if(j*j+q*q>1e-6){const e=Math.atan2(q,j);let a=Ct(e-w);if(Math.abs(a)>.3&&.5>J){const t=(e=>{const t=[0,Math.PI/4,Math.PI/2,3*Math.PI/4,Math.PI,3*-Math.PI/4,-Math.PI/2,-Math.PI/4];let a=e,o=1/0;for(let n=0;t.length>n;n++){const i=Math.abs(Ct(e-t[n]));o>i&&(o=i,a=t[n])}return e+.4*Ct(a-e)})(e);a=Ct(t-w)}w=Ct(w+a*d*t+ce)}else w=Ct(w+ce);w=Ct(w),x>0&&(C=S,S+=x*(1+.5*J)*t,S-=0|S);const de=k>0||ie,ue=de?0:((e,t)=>{const a=(o=St(o=.5>e?2*e:2-2*e,0,1))*o*(3-2*o);var o;const n=St(t,.5,6);return Math.pow(a,n)})(S,s),pe=(1+.43*J)*(I>0?1.15:1)*(Q?.5:1)*ee;if(!de&&S>.82){const t=(S-.82)/.18*.08;t>e.squashAmount&&(e.squashAmount=t,e.squashNormalAngle=-Math.PI/2)}if(!de&&x>0&&C>S){const t=Math.max(.25,e.m/(a.MASS_BASELINE_KG||129)),o=v*(.5+.5*ue)*pe*(.85+.3*Math.random()),n=Math.cos(w),i=Math.sin(w);e.vx+=n*o/t,e.vy+=i*o/t,e.squashAmount=Math.max(e.squashAmount,.18+.1*J),e.squashNormalAngle=Math.PI/2}if(!de){const a=v*(.1+.2*ue)*pe;e.vx+=Math.cos(w)*a*t,e.vy+=Math.sin(w)*a*t}const he=r*M,fe=e.vx,me=e.vy,ge=fe*fe+me*me;if(ge>he*he){const t=he/(Math.sqrt(ge)+1e-6);e.vx=fe*t,e.vy=me*t}const ye=e.rBase||e.r,be=de?.03:.015,Me=1+Math.sin($)*be,ve=1+.08*G,xe=de?0:.02*Math.sin(S*Math.PI*2);e.r=ye*Me*ve*(.95+.05*R),!de&&ge>100&&(e.squashAmount=Math.max(e.squashAmount,Math.min(.06,1e-4*Math.sqrt(ge))+xe),e.squashNormalAngle=w+Math.PI/2),e.F=w,e.L=S,e.I=C,e.D=k,e.C=F,e.K=L,e.T=I,e.P=D,e.O=K,e.B=T,e.A=P,e.R=E,e.W=O,e.$=B,e.V=A,e.N=R,e.q=$,e.Y=G,e.theta=w}function Lt(e){const t=y();if(!1===t.hiveWaypointVisible)return;if(0===wr.length)return;const a=t.canvas;if(!a)return;const o=a.width,n=a.height,i=t.hiveWaypointOpacity??1,r=((t.R_MIN+t.R_MAX)/2||12)*(t.hiveWaypointSizeMul??1.5);(()=>{const e=y(),t=e.hiveJourneyPointCount||4,a=e.currentTemplate||"industrialTeal";if(Lr.length!==t||Ir!==t||Dr!==a){Lr=[];for(let e=0;t>e;e++)Lr.push(Q(pr[e%pr.length]));Ir=t,Dr=a}})(),e.save(),e.globalAlpha=i;for(let l=0;wr.length>l;l++){const t=wr[l],a=t.x*o,i=t.y*n,s=Lr[l]||"#ffffff";e.beginPath(),e.arc(a,i,r,0,2*Math.PI),e.fillStyle=s,e.fill()}e.restore()}function It(e,t){if(e.ee)return;const a=y(),o=Math.max(.25,e.m/a.MASS_BASELINE_KG),n=a.DPR||1,i=Math.max(0,a.neuralWanderStrength??350),r=e.te??0;e.te=r+t*(e.ae??.2);const l=Math.cos(r)*i,s=Math.sin(r)*i;e.vx+=l*t/o,e.vy+=s*t/o;const c=(a.neuralSeparationRadius??100)*n,d=a.neuralSeparationStrength??8e3;let u=0,p=0,h=0;const f=a.balls;for(let g=0;f.length>g;g++){const t=f[g];if(t===e||t.ee)continue;const a=e.x-t.x,o=e.y-t.y,n=Math.sqrt(a*a+o*o);if(c>n&&n>.1){const e=1-n/c;u+=a/n*e,p+=o/n*e,h++}}if(h>0&&(e.vx+=u/h*d*t/o,e.vy+=p/h*d*t/o),a.mouseInCanvas){const i=a.mouseX-e.x,r=a.mouseY-e.y,l=Math.max(20*n,Math.sqrt(i*i+r*r)),s=300*n,c=(a.neuralMouseStrength??4e4)*(l>s?0:1-l/s)/(l+50*n),d=r/l;e.vx+=i/l*c*t/o,e.vy+=d*c*t/o}const m=Math.pow(Math.max(0,Math.min(1,a.neuralDamping??.985)),60*t);e.vx*=m,e.vy*=m}function Dt(){const e=y();if(e.currentMode!==Bn.NEURAL)return;const t=e.neuralMaxLinksPerBall??6,a=e.neuralConnectorDensity??3,o=e.DPR||1,n=(e.neuralLinkDistanceVw??18)*(e.canvas.width/100||10)*o,i=n*n,r=e.balls.filter(e=>e.oe);if(2>r.length)return;const l=[];for(let p=0;r.length>p;p++){const e=r[p];let a=0;for(let o=p+1;r.length>o&&t>a;o++){const t=r[o],n=e.x-t.x,s=e.y-t.y,c=n*n+s*s;i>c&&c>.1&&(l.push({nodeA:e,nodeB:t,dist:Math.sqrt(c)}),a++)}}const s=l.length*a;let c=e.balls.filter(e=>!e.oe);for(;c.length>s;){const t=c.pop(),a=e.balls.indexOf(t);if(a>-1){e.balls.splice(a,1);const o=Kr.indexOf(t);o>-1&&Kr.splice(o,1)}}for(;s>c.length;){const t=new Vi(0,0,.4*(e.R_MED||22)*o,"#888");t.oe=!1,t.ee=!0,t.vx=0,t.vy=0,t.m=t.r*t.r*.05,t.alpha=.6,e.balls.push(t),Kr.push(t),c.push(t)}const d=e.balls.filter(e=>!e.oe);let u=0;for(const p of l){const{nodeA:e,nodeB:t}=p;for(let o=0;a>o&&d.length>u;o++){const n=(o+1)/(a+1),i=d[u];i.x=e.x+(t.x-e.x)*n,i.y=e.y+(t.y-e.y)*n,u++}}}function Kt(){Dt()}function Tt(){}function Pt(e){const t=y(),a=t.canvas;if(!a)return;const o=.5*a.height;let n=0,i=0;t.mouseInCanvas&&(n=Math.max(-1,Math.min(1,(t.mouseX-.5*a.width)/(.5*a.width))),i=Math.max(-1,Math.min(1,(t.mouseY-o)/(.5*a.height))));const r=1-Math.exp(-Math.max(.5,Math.min(50,t.parallaxLinearMouseEasing??20))*e);Or?(Pr+=(n-Pr)*r,Er+=(i-Er)*r):(Pr=n,Er=i,Or=!0)}function Et(e){if(!e.ne)return;const t=y(),a=t.canvas;if(!a)return;const o=.5*a.width,n=.5*a.height,i=Pr,r=Er,l=Math.max(100,t.parallaxLinearFocalLength??400),s=Math.max(0,t.parallaxLinearParallaxStrength??120),{x:c,y:d,z:u}=e.ne,p=l/(l+u),h=o+(c+i*s)*p,f=n+(d+r*s)*p;e.r=We(t,.768*(t.R_MED||20)*(t.DPR||1)*Math.max(.1,Math.min(6,t.parallaxLinearDotSizeMul??1.8))*(Number.isFinite(e.ie)?e.ie:1)*p),e.x=h,e.y=f,e.vx=0,e.vy=0}function Ot(e){const t=y(),a=t.canvas;if(!a)return;const o=.5*a.height;let n=0,i=0;t.mouseInCanvas&&(n=Math.max(-1,Math.min(1,(t.mouseX-.5*a.width)/(.5*a.width))),i=Math.max(-1,Math.min(1,(t.mouseY-o)/(.5*a.height))));const r=1-Math.exp(-Math.max(.5,Math.min(20,t.parallaxFloatMouseEasing??t.parallaxLinearMouseEasing??4))*e);Rr?(Br+=(n-Br)*r,Ar+=(i-Ar)*r):(Br=n,Ar=i,Rr=!0)}function Bt(e,t){if(!e.ne)return;const a=y(),o=a.canvas;if(!o)return;const n=e.ne;n.phaseX+=n.freqX*t*Math.PI*2,n.phaseY+=n.freqY*t*Math.PI*2;const i=n.x+Math.sin(n.phaseX)*n.ampX,r=n.y+Math.sin(n.phaseY)*n.ampY,l=n.z,s=.5*o.width,c=.5*o.height,d=Br,u=Ar,p=Math.max(100,a.parallaxFloatFocalLength??a.parallaxLinearFocalLength??400),h=Math.max(0,a.parallaxFloatParallaxStrength??a.parallaxLinearParallaxStrength??120),f=p/(p+l),m=s+(i+d*h)*f,g=c+(r+u*h)*f;e.r=We(a,.768*(a.R_MED||20)*(a.DPR||1)*Math.max(.1,Math.min(6,a.parallaxFloatDotSizeMul??a.parallaxLinearDotSizeMul??1.8))*(Number.isFinite(e.ie)?e.ie:1)*f),e.x=m,e.y=g,e.vx=0,e.vy=0}function At(e,t){const a=y(),o=a.canvas,n=a.sphere3dState;if(!(o&&n&&e&&e.re))return;const i=a.sphere3dIdleSpeed??.15,r=a.sphere3dTumbleSpeed??2.5,l=Math.max(0,Math.min(.999,a.sphere3dTumbleDamping??.94)),s=Math.max(.1,a.sphere3dDotSizeMul??1.5);if(e===a.balls[0]){const e=.5*o.width,s=.5*o.height;if(a.mouseInCanvas){const t=a.mouseY-(n.prevMouseY??a.mouseY),o=100*(a.DPR||1),i=Math.max(-o,Math.min(o,a.mouseX-(n.prevMouseX??a.mouseX))),l=Math.max(-o,Math.min(o,t));n.prevMouseX=a.mouseX,n.prevMouseY=a.mouseY;const c=a.mouseX-e,d=a.mouseY-s;if(n.radiusPx*n.dotSizeMul*1.5>Math.sqrt(c*c+d*d)){const e=.02*r;n.tumbleY+=i*e,n.tumbleX+=-l*e}}else n.prevMouseX=void 0,n.prevMouseY=void 0;n.tumbleX*=l,n.tumbleY*=l,n.rotY+=(i+n.tumbleY)*t,n.rotX+=(.6*i+n.tumbleX)*t,n.rotZ+=.2*i*t}const{theta:c,phi:d}=e.re,u=n.radiusPx,p=((e,t,a,o,n,i)=>{const r=Math.cos(n),l=Math.sin(n),s=e*r-a*l,c=e*l+a*r,d=Math.cos(o),u=Math.sin(o),p=t*d-c*u,h=t*u+c*d,f=Math.cos(i),m=Math.sin(i);return{x:s*f-p*m,y:s*m+p*f,z:h}})(u*Math.sin(d)*Math.cos(c),u*Math.cos(d),u*Math.sin(d)*Math.sin(c),n.rotX,n.rotY,n.rotZ),h=Math.max(80,a.sphere3dFocalLength??600),f=h/(h+(p.z+u)),m=n.cx+p.x*f,g=n.cy+p.y*f;e.r=We(a,e.le*s*f),e.x=m,e.y=g,e.vx=0,e.vy=0,e.omega=0,e.isSleeping=!1}function Rt(e){return Math.max(-1,Math.min(1,e))}function Wt(e,t,a){return e+(t-e)*a}function zt(e,t){const a=y(),o=a.canvas,n=a.cube3dState;if(!(o&&n&&e&&e.se))return;const i=a.cube3dIdleSpeed??.2,r=a.cube3dCursorInfluence??1.5,l=a.cube3dTumbleSpeed??3,s=Math.max(0,Math.min(.999,a.cube3dTumbleDamping??.95)),c=Math.max(.1,a.cube3dDotSizeMul??1.5);if(e===a.balls[0]){const e=.5*o.height,c=a.mouseInCanvas?Rt((a.mouseX-.5*o.width)/(.5*o.width)):0,d=a.mouseInCanvas?Rt((a.mouseY-e)/(.5*o.height)):0,u=c-(n.prevNx??0),p=d-(n.prevNy??0);n.prevNx=c,n.prevNy=d,n.tumbleX+=-p*l,n.tumbleY+=u*l,n.tumbleX*=s,n.tumbleY*=s,n.rotY+=(i+c*r+n.tumbleY)*t,n.rotX+=(.6*i+d*r+n.tumbleX)*t,n.rotZ+=.2*i*t}const{x:d,y:u,z:p}=e.se,h=((e,t,a,o,n,i)=>{const r=Math.cos(n),l=Math.sin(n),s=e*r-a*l,c=e*l+a*r,d=Math.cos(o),u=Math.sin(o),p=t*d-c*u,h=t*u+c*d,f=Math.cos(i),m=Math.sin(i);return{x:s*f-p*m,y:s*m+p*f,z:h}})(d,u,p,n.rotX,n.rotY,n.rotZ),f=Math.max(80,a.cube3dFocalLength??500),m=f/(f+(h.z+(n.sizePx||1))),g=n.cx+h.x*m,b=n.cy+h.y*m,M=e.le*c*m,v=(h.z+.5*n.sizePx)/n.sizePx,x=Math.max(0,Math.min(1,a.cube3dFogStart??.5));let w=0;if(v>x){const e=(v-x)/(1-x);w=e*e}e.alpha=1-w*(1-Math.max(0,Math.min(1,a.cube3dFogMin??.1))),e.r=We(a,M),e.x=g,e.y=b,e.vx=0,e.vy=0,e.omega=0,e.isSleeping=!1}function $t(e,t,a,o,n,i){return{x:(2*Math.random()-1)*e*n*.5,y:(2*Math.random()-1)*t*i*.5,z:a+Math.random()*(o-a),color:J(),alpha:0,fadeState:"fadingIn"}}function Gt(e){const t=y(),a=t.canvas;if(!a||0===Wr.length)return;const o=performance.now(),n=Math.min(.1,(o-zr)/1e3);zr=o;const i=a.width,r=a.height,l=.5*i,s=.5*r,c=4*Math.max(.5,Math.min(4,t.starfieldSpanX??1.5)),d=4*Math.max(.5,Math.min(4,t.starfieldSpanY??1.2)),u=Math.max(20,t.starfieldZNear??100),p=Math.max(u+200,t.starfieldZFar??2e3),h=Math.max(100,t.starfieldFocalLength??500),f=Math.max(10,t.starfieldSpeed??400),m=(t.R_MED||20)*Math.max(.2,Math.min(4,t.starfieldDotSizeMul??1))*2,g=Math.max(0,t.starfieldParallaxStrength??320);let b=0,M=0;t.mouseInCanvas&&(b=Math.max(-1,Math.min(1,(t.mouseX-l)/(.5*i))),M=Math.max(-1,Math.min(1,(t.mouseY-s)/(.5*r))));const v=1-Math.exp(-8*n);Vr?($r+=(b-$r)*v,Gr+=(M-Gr)*v):($r=b,Gr=M,Vr=!0);const x=Math.max(0,t.starfieldFadeDuration??.5);for(let y=0;Wr.length>y;y++){const t=Wr[y];t.z-=f*n,u>t.z&&(t.z=p+Math.random()*(p-u)*.3,t.x=(2*Math.random()-1)*i*c*.5,t.y=(2*Math.random()-1)*r*d*.5,t.color=J(),t.alpha=0,t.fadeState="fadingIn",t.fadeTimer=0),x>0?(t.fadeState||(t.fadeState="fadingIn",t.fadeTimer=0),void 0===t.fadeTimer&&(t.fadeTimer=0),"fadingIn"===t.fadeState?(t.fadeTimer+=n,x>t.fadeTimer?t.alpha=t.fadeTimer/x:(t.alpha=1,t.fadeState="visible",t.fadeTimer=0)):"visible"===t.fadeState?u+.1*(p-u)>t.z?(t.fadeState="fadingOut",t.fadeTimer=0):t.alpha=1:"fadingOut"===t.fadeState&&(t.fadeTimer+=n,x>t.fadeTimer?t.alpha=1-t.fadeTimer/x:(t.alpha=0,t.fadeTimer=0))):t.alpha=1;const a=h/(h+t.z),o=l+(t.x+$r*g*a)*a,b=s+(t.y+Gr*g*a)*a,M=m;t.alpha>0&&(e.globalAlpha=t.alpha,e.beginPath(),e.arc(o,b,M,0,2*Math.PI),e.fillStyle=t.color,e.fill(),e.globalAlpha=1)}}function Vt(){}function Nt(){}function _t(e,t){const a=y();if(a.currentMode!==Bn.ELASTIC_CENTER)return;if(!e.isElasticCenter)return;const o=(a.elasticCenterElasticStrength??2e3)*a.DPR,n=Nr+e.ce-e.x,i=_r+e.de-e.y,r=Math.max(.1,Math.sqrt(n*n+i*i)),l=o*r*t,s=i/r;if(e.vx+=n/r*l,e.vy+=s*l,a.mouseInCanvas){const o=(a.elasticCenterMouseRepelStrength??12e3)*a.DPR,n=(a.elasticCenterMouseRadius??200)*a.DPR,i=e.x-a.mouseX,r=e.y-a.mouseY,l=Math.sqrt(i*i+r*r);if(n>l&&l>.1){const a=1-l/n,s=o*a*a*t,c=r/l;e.vx+=i/l*s,e.vy+=c*s}}const c=a.elasticCenterDamping??.94;e.vx*=c,e.vy*=c}function Ht(){const e=y();if(e.currentMode!==Bn.ELASTIC_CENTER)return;const t=e.canvas;t&&(Nr=.5*t.width,_r=.5*t.height)}function jt(){}function qt(e){const t=y();if(t.currentMode!==Bn.DVD_LOGO)return;const a=t.canvas;if(!a)return;const o=a.width,n=a.height,i=t.DPR||1,r=t.balls;if(0===r.length)return;const l=Math.max(0,(t.wallThickness??0)*i)+Math.max(0,(t.wallInset??3)*i);let s=1/0,c=-1/0,d=1/0,u=-1/0;for(let y=0;r.length>y;y++){const e=r[y];if(!e.isDvdLogo)continue;const t=e.x-e.r,a=e.x+e.r,o=e.y-e.r,n=e.y+e.r;s>t&&(s=t),a>c&&(c=a),d>o&&(d=o),n>u&&(u=n)}let p=!1,h=null;const f=.5773502691896257;if(s>l||0>qr&&(qr=Math.abs(qr),Hr+=l-s,p=!0,Math.abs(Yr)*f>Math.abs(qr)&&(qr=Math.abs(Yr)*f*Math.sign(qr||1))),o-l>c||qr>0&&(qr=-Math.abs(qr),Hr-=c-(o-l),p=!0,Math.abs(Yr)*f>Math.abs(qr)&&(qr=-Math.abs(Yr)*f)),d>l||0>Yr&&(Yr=Math.abs(Yr),jr+=l-d,p=!0,Math.abs(qr)*f>Math.abs(Yr)&&(Yr=Math.abs(qr)*f*Math.sign(Yr||1))),n-l>u||Yr>0&&(Yr=-Math.abs(Yr),jr-=u-(n-l),p=!0,Math.abs(qr)*f>Math.abs(Yr)&&(Yr=-Math.abs(qr)*f)),p){const e=["#ff4013","#0d5cb6","#ffa000","#00695c","#ffffff","#b5b7b6","#000000"];Zr=(Zr+1)%e.length,h=e[Zr]}const m=(t.dvdLogoSpeed||200)*i,g=Math.sqrt(qr*qr+Yr*Yr);if(g>.1){const e=m/g;qr*=e,Yr*=e}Hr+=qr*e,jr+=Yr*e;for(let y=0;r.length>y;y++){const e=r[y];e.isDvdLogo&&(e.x=Hr+e.ue,e.y=jr+e.pe,e.vx=qr,e.vy=Yr,e.omega=0,e.squashAmount=0,h&&(e.color=h))}}function Yt(){const e=y(),t=e.canvas;if(!t)return null;const a=e.DPR||1,o=t.width,n=t.height,i=ze(e,Bn.PARTICLE_FOUNTAIN),r=o/2,l=n-(Math.max(0,(e.wallThickness??0)*a)+Math.max(0,(e.wallInset??3)*a))-.5*i,{color:s,distributionIndex:c}=U(),d=new Vi(r,l,i,s);d.distributionIndex=c,d.isParticleFountain=!0,d.alpha=1,d.age=0,d.fading=!1,d.fadeProgress=0,d.originalRadius=i;const u=Xt(e,t,l)*(.9+.2*Math.random()),p=(e.particleFountainSpreadAngle??50)*Math.PI/180,h=(Math.random()-.5)*p;return d.vy=-u*Math.cos(h),d.vx=u*Math.sin(h),e.balls.push(d),d}function Zt(e){const t=y(),a=t.canvas;if(!a)return;const o=t.DPR||1,n=a.width,i=a.height,r=ze(t,Bn.PARTICLE_FOUNTAIN),l=i-(Math.max(0,(t.wallThickness??0)*o)+Math.max(0,(t.wallInset??3)*o))-.5*r;e.x=n/2,e.y=l,e.alpha=1,e.r=r,e.rBase=r,e.age=0,e.fading=!1,e.fadeProgress=0,e.originalRadius=r;const s=Xt(t,a,l)*(.9+.2*Math.random()),c=(t.particleFountainSpreadAngle??50)*Math.PI/180,d=(Math.random()-.5)*c;if(e.vy=-s*Math.cos(d),e.vx=s*Math.sin(d),.3>Math.random()){const{color:t,distributionIndex:a}=U();e.color=t,e.distributionIndex=a}}function Xt(e,t,a){const o=(e.particleFountainInitialVelocity||600)*(e.DPR||1);if(!e.isMobile&&!e.isMobileViewport)return o;const n=Math.max(0,a-.6*t.height);return Math.min(o,Math.sqrt(2*Math.max(.01,Math.abs(e.G||e.GE*(e.gravityMultiplier||1)))*n))}function Ut(e,t){const a=y();if(a.currentMode!==Bn.PARTICLE_FOUNTAIN)return;if(!e.isParticleFountain)return;const o=a.particleFountainLifetime??8;if(e.fading||(e.age+=t,o>e.age||(e.fading=!0,e.fadeProgress=0,e.originalRadius||(e.originalRadius=e.rBase||e.r))),e.fading){e.fadeProgress+=t;const a=Math.min(1,e.fadeProgress/2);return e.alpha=Math.max(0,1-(1-Math.sqrt(1-a*a))),void(1>a||(e.alpha=0))}if(a.mouseInCanvas){const o=(a.particleFountainMouseRepelStrength??15e3)*a.DPR,n=(a.particleFountainMouseRepelRadius??0)*a.DPR,i=e.x-a.mouseX,r=e.y-a.mouseY,l=Math.sqrt(i*i+r*r);if(n>l&&l>.1){const a=o*(1-l/n)*t,s=r/l;e.vx+=i/l*a,e.vy+=s*a}}const n=a.particleFountainWaterDrag??.02;e.vx*=1-n,e.vy*=1-n,e.omega*=1-.5*n;const i=a.particleFountainUpwardForce||0;i>0&&(e.vy-=i*a.DPR*t)}function Jt(e){const t=y();if(t.currentMode!==Bn.PARTICLE_FOUNTAIN)return;const a=t.canvas;if(!a)return;const o=t.DPR||1,n=a.height-Math.max(0,(t.wallThickness??0)*o)-Math.max(0,(t.wallInset??3)*o),i=20*o;for(let f=t.balls.length-1;f>=0;f--){const e=t.balls[f];e.isParticleFountain&&(!e.fading||e.alpha>0?e.fading||n>e.y||-i>e.vy||Zt(e):t.balls.splice(f,1))}const r=t.particleFountainEmissionRate||30,l=Math.max(1,Math.round(r*((t.particleFountainLifetime??8)+2))),s=b(t.isMobile||t.isMobileViewport?l:t.particleFountainMaxParticles||l);Xr+=e;const c=1/r;let d=0,u=null,p=null,h=-1/0;for(let f=0;t.balls.length>f;f++){const e=t.balls[f];if(e.isParticleFountain){d+=1,u||(e.fading||e.y>=n&&e.vy>=-i)&&(u=e);const t=e.age??0;t>h&&(h=t,p=e)}}for(;Xr>=c;){if(s>d)Yt(),d+=1;else{const e=u||p;e&&Zt(e)}Xr-=c}Xr>2*c&&(Xr=0)}function Qt(e,t,a){const{minSpeed:o=400,maxSpeed:n=1200,minSize:i=.5,maxSize:r=1.5,angle:l=-45,trailLength:s=5}=a,c=l*Math.PI/180,d=Math.cos(c),u=Math.sin(c),p=Math.random()*e*1.2-.1*e,h=.1*-t,f=1.5*Math.sqrt(e*e+t*t),m=o+Math.random()*(n-o);return{x:p,y:h,vx:d*m,vy:u*m,size:i+Math.random()*(r-i),color:J(),alpha:0,age:0,maxAge:f/m,fadeInDuration:.1,fadeOutDuration:.5,trailLength:Math.round(s),trail:[],active:!0}}function ea(e){const t=y(),a=t.canvas;if(!a)return;const o=performance.now(),n=Math.min(.1,(o-Jr)/1e3);Jr=o;const i=a.width,r=a.height,l=t.R_MED||20,s=Math.max(100,t.shootingStarsMinSpeed??400),c=Math.max(s,t.shootingStarsMaxSpeed??1200),d=Math.max(.2,Math.min(2,t.shootingStarsMinSize??.5)),u=Math.max(d,Math.min(4,t.shootingStarsMaxSize??1.5)),p=t.shootingStarsAngle??-45,h=Math.max(0,Math.min(20,t.shootingStarsTrailLength??5)),f=Math.max(.5,t.shootingStarsSpawnInterval??3),m=Math.max(1,Math.min(10,t.shootingStarsBurstSize??1)),g={minSpeed:s,maxSpeed:c,minSize:d,maxSize:u,angle:p,trailLength:h};if(Qr-=n,0>=Qr){for(let e=0;m>e;e++){const t=Qt(i,r,g);t.age=.05*-e,Ur.push(t)}Qr=f*(.7+.6*Math.random())}for(let y=Ur.length-1;y>=0;y--){const t=Ur[y];if(t.age+=n,t.age>=0){t.x+=t.vx*n,t.y+=t.vy*n,t.age>0&&(t.trail.push({x:t.x,y:t.y,alpha:1}),t.trail.length>t.trailLength&&t.trail.shift()),t.alpha=t.fadeInDuration>t.age?t.age/t.fadeInDuration:t.age>t.maxAge-t.fadeOutDuration?(t.maxAge-t.age)/t.fadeOutDuration:1;for(let a=0;t.trail.length>a;a++){const o=t.trail[a],n=a/t.trail.length,i=.6*n;if(i>.05){const a=l*t.size*n*.8;e.globalAlpha=t.alpha*i,e.beginPath(),e.arc(o.x,o.y,a,0,2*Math.PI),e.fillStyle=t.color,e.fill()}}if(t.alpha>0){const a=l*t.size;e.globalAlpha=t.alpha,e.beginPath(),e.arc(t.x,t.y,a,0,2*Math.PI),e.fillStyle=t.color,e.fill(),e.globalAlpha=1}(t.age>t.maxAge||t.y>1.2*r||.2*-i>t.x||t.x>1.2*i)&&Ur.splice(y,1)}}e.globalAlpha=1}function ta(){}function aa(){}function oa(e,{getForcesFn:t}={}){function a(n){if(!il)return void(rl=null);const i=n-nl;if(ll>i)return void(rl=requestAnimationFrame(a));nl=n-i%ll,(e=>{if(sl.push(e),sl.length>30&&sl.shift(),30===sl.length){const e=1e3/(sl.reduce((e,t)=>e+t,0)/30);30>e&&2>cl?(cl++,console.log(` Adaptive throttle increased to level ${cl} (avg FPS: ${e.toFixed(1)})`)):e>55&&cl>0&&(cl--,console.log(` Adaptive throttle decreased to level ${cl} (avg FPS: ${e.toFixed(1)})`))}})(i);const r=n/1e3;let l=Math.min(.033,r-ol);ol=r,t&&(o=t()),(2>cl||Math.random()>.5)&&_a(l,o??e),Ha(),(e=>{if(tl++,e-el>1e3){al=tl,tl=0,el=e;const t=document.getElementById("render-fps");t&&(t.textContent=al+"")}})(performance.now()),rl=requestAnimationFrame(a)}let o=null;document.addEventListener("visibilitychange",()=>{il=!document.hidden,il?(ol=performance.now()/1e3,nl=performance.now(),console.log(" Animation resumed"),rl||(rl=requestAnimationFrame(a))):(console.log(" Animation paused (tab hidden)"),rl&&(cancelAnimationFrame(rl),rl=null))},{passive:!0}),rl=requestAnimationFrame(a),console.log(" Render loop started (60fps throttle, visibility-aware)")}function na(e){const t=y(),a=t.currentMode;if($a(),sl=[],cl=0,t.currentMode===Bn.CRITTERS&&e!==Bn.CRITTERS&&(void 0!==t.he&&(t.REST=t.he,delete t.he),void 0!==t.fe&&(t.FRICTION=t.fe,delete t.fe),void 0!==t.me&&(t.ballSpacing=t.me,delete t.me)),v(e),e!==a)try{Z?.()}catch(n){}if(console.log("Switching to mode: "+e),(e=>{const t=document.getElementById("announcer");t&&(t.textContent="",setTimeout(()=>{t.textContent=e},10))})(`Switched to ${{pit:"Ball Pit",flies:"Flies to Light",weightless:"Zero Gravity",water:"Water Swimming",vortex:"Vortex Sheets",magnetic:"Magnetic",bubbles:"Carbonated Bubbles","kaleidoscope-3":"Kaleidoscope",critters:"Hive",neural:"Neural Network","parallax-linear":"Parallax (Linear)","parallax-float":"Parallax (Float)","3d-sphere":"3D Sphere","3d-cube":"3D Cube","starfield-3d":"3D Starfield","elastic-center":"Elastic Center","dvd-logo":"DVD Logo","particle-fountain":"Particle Fountain","shooting-stars":"Shooting Stars"}[e]||e} mode`),t.container){const a=t.container.classList.contains("dark-mode");t.container.className="",e===Bn.PIT&&t.container.classList.add("mode-pit"),(a||t.isDarkMode)&&t.container.classList.add("dark-mode")}if(Xe(),e===Bn.PIT?(t.gravityMultiplier=t.gravityMultiplierPit,t.G=t.GE*t.gravityMultiplier,t.repellerEnabled=!0,(()=>{const e=y();x(),((e,t)=>{const a=e.DPR,o=-.65*e.canvas.height,n=(e.wallThickness||20)*a,i=n,r=e.canvas.width-n,l=r-i,s=Math.max(1,.22*l),c=i+l*(2/3),d=Math.max(i,c-.5*s),u=Math.min(r,c+.5*s),p=Math.max(0,0|t),h=100*a,f=50*a;for(let m=0;p>m;m++){const e=_e(d+Math.random()*(u-d),o+Math.random()*(0-o));e.vx=(Math.random()-.5)*h,e.vy=Math.random()*f+f,e.driftAx=0,e.driftTime=0}})(e,b(e.maxBalls??300))})()):e===Bn.FLIES?(t.gravityMultiplier=0,t.G=0,t.repellerEnabled=!1,(()=>{const e=y();x();const t=b(e.fliesBallCount??60);if(0>=t)return;const a=.5*e.canvas.width,o=.5*e.canvas.height,n=150*e.DPR,i=300*e.DPR;for(let r=0;8>r;r++){const e=Math.random()*Math.PI*2,t=Math.random()*n,r=_e(a+Math.cos(e)*t,o+Math.sin(e)*t,J()),l=.5+.5*Math.random(),s=Math.random()*Math.PI*2,c=i*l;r.vx=Math.cos(s)*c,r.vy=Math.sin(s)*c,r.driftAx=0,r.driftTime=0}for(let r=8;t>r;r++){const e=Math.random()*Math.PI*2,t=Math.random()*n,r=_e(a+Math.cos(e)*t,o+Math.sin(e)*t),l=.5+.5*Math.random(),s=Math.random()*Math.PI*2,c=i*l;r.vx=Math.cos(s)*c,r.vy=Math.sin(s)*c,r.driftAx=0,r.driftTime=0}})()):e===Bn.WEIGHTLESS?(t.gravityMultiplier=0,t.G=0,t.repellerEnabled=!1,(()=>{const e=y();x();const t=b(e.weightlessCount);t>0&&((e,t)=>{const a=e.canvas;if(!a)return;const o=a.width,n=a.height,i=e.DPR||1,r=(e=>{let t=1;for(;e>t*(t+1)/2;)t++;return t})(t),l=Math.min(t,r*(r+1)/2),s=.5*((e.R_MIN||15)+(e.R_MAX||25))*i*2.1,c=(r-1)*s,d=.5*o-.5*c,u=.5*n-(r-1)*s*Math.sqrt(3)/2*.5;let p=0;for(let h=0;r>h&&l>p;h++){const e=h+1,t=d+.5*(c-(e-1)*s),a=u+h*s*Math.sqrt(3)/2;for(let o=0;e>o&&l>p;o++){const e=_e(t+o*s,a);e.vx=0,e.vy=0,e.omega=0,e.driftAx=0,e.driftTime=0,p++}}})(e,t)})()):e===Bn.WATER?(t.gravityMultiplier=0,t.G=0,t.repellerEnabled=!1,(()=>{const e=y();x(),_i.length=0;const t=e.canvas;if(!t)return;const a=t.width,o=t.height,n=b(e.waterBallCount||100);if(0>=n)return;const i=(e.waterInitialVelocity||120)*(e.DPR||1);for(let r=0;8>r&&n>r;r++){const t=Math.random()*a,n=Math.random()*o,r=ze(e,Bn.WATER),{color:l,distributionIndex:s}=U(),c=new Vi(t,n,r,l);c.distributionIndex=s,c.vx=(Math.random()-.5)*i,c.vy=(Math.random()-.5)*i,e.balls.push(c)}for(let r=8;n>r;r++){const t=Math.random()*a,n=Math.random()*o,r=ze(e,Bn.WATER),{color:l,distributionIndex:s}=U(),c=new Vi(t,n,r,l);c.distributionIndex=s,c.vx=(Math.random()-.5)*i,c.vy=(Math.random()-.5)*i,e.balls.push(c)}})()):e===Bn.VORTEX?(t.gravityMultiplier=0,t.G=0,t.repellerEnabled=!1,(()=>{const e=y();x();const t=e.canvas;if(!t)return;const a=t.width,o=t.height,n=b(Math.min(e.vortexBallCount||180,e.maxBalls||500));if(0>=n)return;const i=e.vortexSpeedMultiplier??1,r=void 0!==e.vortexRadius?e.vortexRadius:300;let l=0;for(let s=0;8>s&&n>s;s++){const t=Math.random()*a,n=Math.random()*o,s=ze(e,Bn.VORTEX),{color:c,distributionIndex:d}=U(),u=new Vi(t,n,s,c);u.distributionIndex=d,Qe(u,r,i,0,l%3),e.balls.push(u),l++}for(let s=l;n>s;s++){const t=Math.random()*a,n=Math.random()*o,l=ze(e,Bn.VORTEX),{color:c,distributionIndex:d}=U(),u=new Vi(t,n,l,c);u.distributionIndex=d,Qe(u,r,i,0,s%3),e.balls.push(u)}})()):e===Bn.MAGNETIC?(t.gravityMultiplier=0,t.G=0,t.repellerEnabled=!1,(()=>{const e=y();x();const t=e.canvas;if(!t)return;const a=t.width,o=t.height,n=b(Math.min(e.magneticBallCount||180,e.maxBalls||300));if(0>=n)return;const i=100*(e.DPR||1);for(let r=0;8>r&&n>r;r++){const t=Math.random()*a,n=Math.random()*o,r=ze(e,Bn.MAGNETIC),{color:l,distributionIndex:s}=U(),c=new Vi(t,n,r,l);c.distributionIndex=s,c.vx=(Math.random()-.5)*i,c.vy=(Math.random()-.5)*i,c.baseAlpha=1,e.balls.push(c)}for(let r=8;n>r;r++){const t=Math.random()*a,n=Math.random()*o,r=ze(e,Bn.MAGNETIC),{color:l,distributionIndex:s}=U(),c=new Vi(t,n,r,l);c.distributionIndex=s,c.vx=(Math.random()-.5)*i,c.vy=(Math.random()-.5)*i,c.baseAlpha=1,e.balls.push(c)}})()):e===Bn.BUBBLES?(t.gravityMultiplier=0,t.G=0,t.repellerEnabled=!1,(()=>{const e=y();e.balls.length=0;const t=e.canvas;if(!t)return;const a=t.width,o=t.height,n=b(e.bubblesMaxCount||200);if(n>0){for(let e=0;8>e&&n>e;e++){const e=Math.random()*a,t=Math.random()*o,{color:n,distributionIndex:i}=U();ot(e,t,n,i,!1,Math.random())}for(let e=8;n>e;e++){const e=Math.random()*a,t=Math.random()*o,{color:n,distributionIndex:i}=U();ot(e,t,n,i,!1,Math.random())}}})()):e===Bn.KALEIDOSCOPE?(t.gravityMultiplier=0,t.G=0,t.repellerEnabled=!1,(()=>{const e=y();((e,t)=>{function a(e){const t=Math.max(0,Math.min(1,e/Math.max(g,1))),a=.55>=t||.75>t&&.65>Math.random()?w:S,o=a[Math.floor(Math.random()*a.length)]??0;return{color:M[o]||M[0]||"#ffffff",distributionIndex:(e=>{const t=Math.max(0,Math.min(7,0|e));for(let a=0;v.length>a;a++){const e=v[a];if((0|e?.colorIndex)===t)return a}return 0})(o)}}function o(){const e=((e,t)=>{const a=e?.canvas,o=a?.height||0;if(!o)return ze(e,t);const n=Oe(+(e.kaleidoscope3DotSizeVh??e.kaleidoscopeDotSizeVh??1.05),.1,6),i=Oe(+(e.kaleidoscope3DotAreaMul??e.kaleidoscopeDotAreaMul??.75),.1,2),r=Math.max(1,.01*n*o*Math.sqrt(i)),l=Oe(.5*+(e.kaleidoscope3SizeVariance??e.kaleidoscopeSizeVariance??.5),0,Ni),s=Math.max(1,r*(1-l)),c=Math.max(1,r*(1+l));return We(e,1e-6>c-s?r:Be(s,c,Math.random()))})(n,t),o=1.2*g,i=s-o,r=s+o,l=c-o,u=c+o;for(let t=0;90>t;t++){const t=Math.random()*cr,o=m+Math.random()*(g-m),p=lt(s+Math.cos(t)*o,i,r),h=lt(c+Math.sin(t)*o,l,u),f=e*(1+(n.ballSpacing||0));if(!ct(b,p,h,f)){b.push({x:p,y:h,r:f});const{color:i,distributionIndex:r}=a(o),l=new Vi(p,h,e,i);l.distributionIndex=r,l.M=Math.random()*cr;const u=p-s,m=h-c;l.S=Math.sqrt(u*u+m*m);const g=(12+12*Math.random())*d;return l.vx=-Math.sin(t)*g,l.vy=Math.cos(t)*g,l.driftAx=0,l.driftTime=0,void n.balls.push(l)}}const p=Math.random()*cr,h=m+Math.random()*(g-m),f=s+Math.cos(p)*h,y=c+Math.sin(p)*h,{color:M,distributionIndex:v}=a(h),x=new Vi(f,y,e,M);x.distributionIndex=v,x.M=Math.random()*cr;const w=f-s,S=y-c;x.S=Math.sqrt(w*w+S*S);const C=(12+12*Math.random())*d;x.vx=-Math.sin(p)*C,x.vy=Math.cos(p)*C,x.driftAx=0,x.driftTime=0,n.balls.push(x)}const n=y();x();const i=n.canvas;if(!i)return;const r=i.width,l=i.height,s=.5*r,c=.5*l,d=st(n),u=n.maxBalls||300,p=lt(Math.max(0,0|e),0,u);if(0>=p)return;const h=lt(pt(n).spawnAreaMul??1,.2,2),f=Math.min(r,l),m=.05*f,g=2.8*f*h,b=[],M=Array.isArray(n.currentColors)?n.currentColors:[],v=Array.isArray(n.colorDistribution)?n.colorDistribution:[],w=[5,6,7,3,0],S=[0,1,2,4];for(let y=0;p>y;y++)o()})(b(e.kaleidoscope3BallCount??e.kaleidoscopeBallCount??150),Bn.KALEIDOSCOPE)})()):e===Bn.SPHERE_3D?(t.gravityMultiplier=0,t.G=0,t.repellerEnabled=!1,(()=>{const e=y(),t=e.canvas;if(!t)return;x();const a=b(Math.max(10,Math.round(e.sphere3dDensity??140)));if(0>=a)return;const o=Math.max(10,(e.sphere3dRadiusVw??18)/100*t.width),n=Math.max(.1,e.sphere3dDotSizeMul??1.5),i=.6*(e.R_MED||20)*(e.DPR||1);e.sphere3dState={cx:.5*t.width,cy:.5*t.height,radiusPx:o,rotX:0,rotY:0,rotZ:0,tumbleX:0,tumbleY:0,dotSizeMul:n};const r=(e=>{const t=[];for(let a=0;e>a;a++)t.push({theta:2*Math.PI*a/1.618033988749895,phi:Math.acos(1-2*(a+.5)/e)});return t})(a);for(let l=0;r.length>l;l++){const t=_e(0,0);t&&(t.vx=0,t.vy=0,t.omega=0,t.r=We(e,i*n),t.le=i,t.re={theta:r[l].theta,phi:r[l].phi},t.ge="sphere",t.isSleeping=!1)}})()):e===Bn.CUBE_3D?(t.gravityMultiplier=0,t.G=0,t.repellerEnabled=!1,(()=>{const e=y(),t=e.canvas;if(!t)return;x();const a=b(Math.max(2,Math.round(e.cube3dEdgeDensity??8))),o=Math.max(0,Math.round(e.cube3dFaceGrid??0)),n=o>0?b(o):0,i=Math.max(10,(e.cube3dSizeVw??25)/100*t.width),r=.6*(e.R_MED||20)*(e.DPR||1),l=Math.max(.1,e.cube3dDotSizeMul??1.5),s=((e,t,a)=>{const o=[],n=.5*e,i=Math.max(2,0|t),r=Math.max(0,0|a),l=[[-n,-n,-n],[n,-n,-n],[-n,n,-n],[n,n,-n],[-n,-n,n],[n,-n,n],[-n,n,n],[n,n,n]],s=[[0,1],[2,3],[4,5],[6,7],[0,2],[1,3],[4,6],[5,7],[0,4],[1,5],[2,6],[3,7]];for(const[c,d]of s)for(let e=0;i>=e;e++){const t=e/i;o.push({x:Wt(l[c][0],l[d][0],t),y:Wt(l[c][1],l[d][1],t),z:Wt(l[c][2],l[d][2],t)})}if(r>0){const t=r+1,a=e/t,i=[];for(let e=0;t>=e;e++)i.push(e*a-n);const l=[{axis:"z",value:-n},{axis:"z",value:n},{axis:"x",value:-n},{axis:"x",value:n},{axis:"y",value:-n},{axis:"y",value:n}];for(const e of l)for(let t=0;i.length>t;t++)for(let a=0;i.length>a;a++){let n=0,r=0,l=0;"z"===e.axis?(n=i[t],r=i[a],l=e.value):"x"===e.axis?(n=e.value,r=i[t],l=i[a]):(n=i[t],r=e.value,l=i[a]),o.push({x:n,y:r,z:l})}}return o})(i,a,n);e.cube3dState={cx:.5*t.width,cy:.5*t.height,sizePx:i,rotX:0,rotY:0,rotZ:0,idleSpeed:e.cube3dIdleSpeed??.2,cursorInfluence:e.cube3dCursorInfluence??1.5,tumbleX:0,tumbleY:0,tumbleDamping:Math.max(0,Math.min(.999,e.cube3dTumbleDamping??.95)),tumbleSpeed:e.cube3dTumbleSpeed??3,dotSizeMul:l};for(let c=0;s.length>c;c++){const t=_e(0,0);t&&(t.vx=0,t.vy=0,t.omega=0,t.r=We(e,r*l),t.le=r,t.se={x:s[c].x,y:s[c].y,z:s[c].z},t.ge="cube",t.isSleeping=!1)}})()):e===Bn.CRITTERS?(t.gravityMultiplier=0,t.G=0,t.repellerEnabled=!1,void 0===t.he&&(t.he=t.REST),void 0===t.fe&&(t.fe=t.FRICTION),t.REST=t.critterRestitution??t.REST,t.FRICTION=t.critterFriction??t.FRICTION,void 0===t.me&&(t.me=t.ballSpacing),t.ballSpacing=Math.min(t.ballSpacing||0,1),(()=>{const e=y();x();const t=e.canvas.width,a=e.canvas.height;kr=t,Fr=a,xt(),vt(),gt();const o=e.R_MIN||8,n=Math.max(1,(e.R_MAX||24)-o),i=b(Math.max(10,Math.min(260,0|e.critterCount)));if(i>0)for(let r=0;i>r;r++){const i=_e(Math.random()*t|0,Math.random()*a|0,Q(hr[Math.floor(Math.random()*hr.length)])),r=ze(e,Bn.CRITTERS);i.r=r,i.rBase=r,i.m=Math.max(1,r*r*.12);const l=Math.random()*Math.PI*2,s=20+30*Math.random();i.vx=Math.cos(l)*s,i.vy=Math.sin(l)*s,i.ye=!0,i.F=l,i.L=Math.random(),i.I=i.L,i.D=0,i.C=0;const c=e.critterNervousnessMin??.4,d=e.critterNervousnessMax??1;i.Z=c+Math.random()*(d-c),i.X=Math.random(),i.U=1.2*(Math.random()-.5),i.J=.1+.4*Math.random();const u=St((r-o)/n,0,1);i.k=1+.5*(1-u),i.K=Math.random()*Math.PI*2,i.T=0,i.P=0,i.O=0,i.B=2*Math.random(),i.A=0;const p=Mt(Math.floor(Math.random()*(e.hiveJourneyPointCount||4)));i.R=p.point.x,i.W=p.point.y,i.V=p.index,i.$=3+8*Math.random(),i.N=.5+.5*Math.random(),i._=.02+.03*Math.random(),i.H=Math.max(0,Math.min(1,(e.critterCuriosityBias??.5)+.6*(Math.random()-.5))),i.q=Math.random()*Math.PI*2,i.Y=0}})()):e===Bn.NEURAL?(t.gravityMultiplier=0,t.G=0,t.repellerEnabled=!0,(()=>{const e=y(),t=e.canvas;if(!t)return;x(),Kr=[],Tr=[];const a=b(Math.max(8,Math.min(e.neuralBallCount??180,400)));if(0>=a)return;const o=t.width,n=t.height,i=40*(e.DPR||1),r=Math.min(8,a);for(let l=0;r>l;l++){const t=_e(i+Math.random()*(o-2*i),i+Math.random()*(n-2*i),J()),a=ze(e,Bn.NEURAL);t.r=a,t.rBase=a,t.m=Math.max(1,a*a*.12),t.vx=0,t.vy=0,t.driftAx=0,t.driftTime=0,t.te=Math.random()*Math.PI*2,t.ae=.15+.15*Math.random(),t.oe=!0,Tr.push(t)}for(let l=r;a>l;l++){const t=_e(i+Math.random()*(o-2*i),i+Math.random()*(n-2*i),J()),a=ze(e,Bn.NEURAL);t.r=a,t.rBase=a,t.m=Math.max(1,a*a*.12),t.vx=0,t.vy=0,t.driftAx=0,t.driftTime=0,t.te=Math.random()*Math.PI*2,t.ae=.15+.15*Math.random(),t.oe=!0,Tr.push(t)}Dt()})()):e===Bn.PARALLAX_LINEAR?(t.gravityMultiplier=0,t.G=0,t.repellerEnabled=!1,(()=>{const e=y(),t=e.canvas;if(!t)return;Pr=0,Er=0,Or=!1,x();const a=t.width,o=t.height,n=b(Math.max(0,Math.min(40,Math.round(e.parallaxLinearGridX??14)))),i=b(Math.max(0,Math.min(40,Math.round(e.parallaxLinearGridY??10)))),r=b(Math.max(0,Math.min(20,Math.round(e.parallaxLinearGridZ??7))));if(0>=n||0>=i||0>=r)return;const l=Math.max(.2,Math.min(8,e.parallaxLinearSpanX??1.35)),s=Math.max(.2,Math.min(8,e.parallaxLinearSpanY??1.35)),c=-.5*a*l,d=-.5*o*s,u=a*l/Math.max(1,n-1),p=o*s/Math.max(1,i-1),h=Math.max(10,e.parallaxLinearZNear??50),f=(Math.max(h+100,e.parallaxLinearZFar??800)-h)/Math.max(1,r-1),m=Math.max(80,e.parallaxLinearFocalLength??420),g=.768*(e.R_MED||20)*(e.DPR||1)*Math.max(.1,Math.min(6,e.parallaxLinearDotSizeMul??1.8)),M=Re(e,Bn.PARALLAX_LINEAR),v=.5*a,w=.5*o;for(let y=r-1;y>=0;y--){const t=h+y*f,a=y/Math.max(1,r-1);for(let o=0;i>o;o++)for(let i=0;n>i;i++){const n=c+i*u,r=d+o*p,l=t,s=m/(m+l),h=g*s,f=.75,y=1-.85*(a>f?(a-f)/(1-f):0),b=_e(v+n*s,w+r*s,J());b.r=We(e,h),b.vx=0,b.vy=0,b.alpha=y,b.ne={x:n,y:r,z:l,baseScale:s},b.ie=M>1e-6?1+(2*Math.random()-1)*M:1,b.be=!0}}})()):e===Bn.PARALLAX_FLOAT?(t.gravityMultiplier=0,t.G=0,t.repellerEnabled=!1,(()=>{const e=y(),t=e.canvas;if(!t)return;Br=0,Ar=0,Rr=!1,x();const a=t.width,o=t.height,n=b(Math.max(0,Math.min(40,Math.round(e.parallaxFloatGridX??e.parallaxLinearGridX??14)))),i=b(Math.max(0,Math.min(40,Math.round(e.parallaxFloatGridY??e.parallaxLinearGridY??10)))),r=b(Math.max(0,Math.min(20,Math.round(e.parallaxFloatGridZ??e.parallaxLinearGridZ??7))));if(0>=n||0>=i||0>=r)return;const l=Math.max(0,Math.min(10,e.parallaxFloatSpanX??e.parallaxLinearSpanX??3)),s=Math.max(0,Math.min(10,e.parallaxFloatSpanY??e.parallaxLinearSpanY??3)),c=-.5*a*l,d=-.5*o*s,u=a*l/Math.max(1,n-1),p=o*s/Math.max(1,i-1),h=Math.max(10,e.parallaxFloatZNear??e.parallaxLinearZNear??50),f=(Math.max(h+100,e.parallaxFloatZFar??e.parallaxLinearZFar??800)-h)/Math.max(1,r-1),m=Math.max(80,e.parallaxFloatFocalLength??e.parallaxLinearFocalLength??420),g=.768*(e.R_MED||20)*(e.DPR||1)*Math.max(.1,Math.min(6,e.parallaxFloatDotSizeMul??e.parallaxLinearDotSizeMul??1.8)),M=Re(e,Bn.PARALLAX_FLOAT);let v=e.parallaxFloatRandomize??50;const w=Math.max(0,Math.min(1,v>1?v/100:v)),S=.5*a,C=.5*o;for(let y=r-1;y>=0;y--){const t=h+y*f,a=y/Math.max(1,r-1);for(let o=0;i>o;o++)for(let i=0;n>i;i++){const n=d+o*p,r=t,l=c+i*u+(Math.random()-.5)*u*w*2,s=n+(Math.random()-.5)*p*w*2,h=r+(Math.random()-.5)*f*w*2,y=m/(m+h),b=g*y,v=.75,x=1-.85*(a>v?(a-v)/(1-v):0),k=_e(S+l*y,C+s*y,J());k.r=We(e,b),k.vx=0,k.vy=0,k.alpha=x;const F=Math.max(0,e.parallaxFloatLevitationAmp??20),L=Math.max(.01,e.parallaxFloatLevitationSpeed??.2);k.ne={x:l,y:s,z:h,baseScale:y,phaseX:Math.random()*Math.PI*2,phaseY:Math.random()*Math.PI*2,freqX:L*(.75+.5*Math.random()),freqY:L*(.6+.4*Math.random()),ampX:F*(.4+.8*Math.random()),ampY:F*(.5+1*Math.random())},k.ie=M>1e-6?1+(2*Math.random()-1)*M:1,k.be=!0}}})()):e===Bn.STARFIELD_3D?(t.gravityMultiplier=0,t.G=0,t.repellerEnabled=!1,(()=>{const e=y(),t=e.canvas;if(!t)return;x();const a=t.width,o=t.height,n=Math.max(50,Math.min(500,Math.round(e.starfieldCount??200))),i=4*Math.max(.5,Math.min(4,e.starfieldSpanX??1.5)),r=4*Math.max(.5,Math.min(4,e.starfieldSpanY??1.2)),l=Math.max(20,e.starfieldZNear??100),s=Math.max(l+200,e.starfieldZFar??2e3);Wr=[];for(let c=0;n>c;c++){const e=$t(a,o,l,s,i,r);e.fadeTimer=0,Wr.push(e)}zr=performance.now(),$r=0,Gr=0,Vr=!1})()):e===Bn.ELASTIC_CENTER?(t.gravityMultiplier=0,t.G=0,t.repellerEnabled=!1,(()=>{const e=y();x();const t=e.canvas;if(!t)return;Nr=.5*t.width,_r=.5*t.height;const a=e.elasticCenterRingCount??10;a>0&&((e,t)=>{if(!e.canvas)return;const a=.5*(e.R_MIN+e.R_MAX)*(e.elasticCenterSpacingMultiplier||2.8),o=[];t>0&&o.push({x:0,y:0,layer:0,index:0});for(let n=1;t>n;n++){const e=n*a,t=Math.max(6,Math.floor(2*e*Math.PI/a));for(let a=0;t>a;a++){const i=a/t*Math.PI*2;o.push({x:Math.cos(i)*e,y:Math.sin(i)*e,layer:n,index:o.length})}}for(let n=0;Math.min(8,o.length)>n;n++){const t=o[n],a=ze(e,Bn.ELASTIC_CENTER),{color:i,distributionIndex:r}=U(),l=new Vi(Nr+t.x,_r+t.y,a,i);l.distributionIndex=r,l.isElasticCenter=!0,l.ce=t.x,l.de=t.y,l.Me=Math.sqrt(t.x*t.x+t.y*t.y),l.m=e.MASS_BASELINE_KG*(e.elasticCenterMassMultiplier||2),l.vx=0,l.vy=0,l.omega=0,e.balls.push(l)}for(let n=8;o.length>n;n++){const t=o[n],a=ze(e,Bn.ELASTIC_CENTER),{color:i,distributionIndex:r}=U(),l=new Vi(Nr+t.x,_r+t.y,a,i);l.distributionIndex=r,l.isElasticCenter=!0,l.ce=t.x,l.de=t.y,l.Me=Math.sqrt(t.x*t.x+t.y*t.y),l.m=e.MASS_BASELINE_KG*(e.elasticCenterMassMultiplier||2),l.vx=0,l.vy=0,l.omega=0,e.balls.push(l)}})(e,a)})()):e===Bn.DVD_LOGO?(t.gravityMultiplier=0,t.G=0,t.repellerEnabled=!1,(()=>{const e=y();x();const t=e.canvas;if(!t)return;const a=t.width,o=t.height,n=e.DPR||1,i=e.dvdLogoBallCount||60,r=e.dvdLogoSize||1,l=(e.dvdLogoSpeed||200)*n,s=e.dvdLogoBallSpacing||1.3,c=e.dvdLogoLetterSpacing||1,d=ze(e,Bn.DVD_LOGO)*r,u=((e,t,a,o)=>{const n=[],i=(()=>{const e=[];for(let t=0;5>t;t++)e.push({x:-1,y:-2+t});return e.push({x:0,y:-2}),e.push({x:.8,y:-2}),e.push({x:1.3,y:-1.5}),e.push({x:1.3,y:-1}),e.push({x:.8,y:0}),e.push({x:0,y:0}),e.push({x:1.3,y:.5}),e.push({x:1.3,y:1}),e.push({x:.8,y:2}),e.push({x:0,y:2}),e})(),r=(()=>{const e=[];for(let t=0;5>t;t++)e.push({x:-1,y:-2+t});return e.push({x:0,y:-2}),e.push({x:.8,y:-2}),e.push({x:1.5,y:-2}),e.push({x:0,y:0}),e.push({x:.8,y:0}),e.push({x:0,y:2}),e.push({x:.8,y:2}),e.push({x:1.5,y:2}),e})(),l=(()=>{const e=[];return e.push({x:0,y:-2}),e.push({x:1,y:-2}),e.push({x:-.8,y:-1.5}),e.push({x:-1.2,y:-.8}),e.push({x:-1.2,y:0}),e.push({x:-1.2,y:.8}),e.push({x:-.8,y:1.5}),e.push({x:0,y:2}),e.push({x:1,y:2}),e})(),s=(()=>{const e=[];for(let t=0;5>t;t++)e.push({x:-1,y:-2+t});return e.push({x:0,y:0}),e.push({x:.6,y:-1}),e.push({x:1.2,y:-2}),e.push({x:.3,y:.5}),e.push({x:.8,y:1.2}),e.push({x:1.3,y:2}),e})(),c=2*t*a,d=3*c*o,u=Math.floor(e/4),p=e%4;return[{shape:i,offset:-1.5*d,count:u+(p>0?1:0)},{shape:r,offset:-.5*d,count:u+(p>1?1:0)},{shape:l,offset:.5*d,count:u+(p>2?1:0)},{shape:s,offset:1.5*d,count:u}].forEach(e=>{const t=e.shape,a=t.length;for(let o=0;e.count>o;o++){const i=t[Math.floor(o/e.count*a)%a];n.push({x:i.x*c+e.offset,y:i.y*c})}}),n})(i,d,s,c),p=Math.max(0,(e.wallThickness??0)*n)+Math.max(0,(e.wallInset??3)*n)+10*d;Hr=p+Math.random()*(a-2*p),jr=p+Math.random()*(o-2*p);const h=Math.floor(4*Math.random())*(Math.PI/2)+.5235987755982988+.5235987755982989*Math.random();qr=Math.cos(h)*l,Yr=Math.sin(h)*l,Zr=0;const f=["#ff4013","#0d5cb6","#ffa000","#00695c","#ffffff","#b5b7b6","#000000"][Zr];u.forEach(t=>{const a=new Vi(Hr+t.x,jr+t.y,d,f);a.isDvdLogo=!0,a.ue=t.x,a.pe=t.y,a.m=e.MASS_BASELINE_KG,a.vx=qr,a.vy=Yr,a.omega=0,a.ye=!0,a.squashAmount=0,a.ve=!0,e.balls.push(a)})})()):e===Bn.PARTICLE_FOUNTAIN?(t.gravityMultiplier=t.particleFountainGravityMultiplier||1,t.G=t.GE*t.gravityMultiplier,t.repellerEnabled=!0,(()=>{const e=y(),t=e.canvas;if(e.balls.length=0,!t)return void(Xr=-.1);const a=b(e.particleFountainMaxParticles||100),o=Math.min(5,a);for(let n=0;o>n;n++)Yt();Xr=0})()):e===Bn.SHOOTING_STARS&&(t.gravityMultiplier=0,t.G=0,t.repellerEnabled=!1,(()=>{const e=y(),t=e.canvas;if(!t)return;x();const a=t.width,o=t.height,n=Math.max(100,e.shootingStarsMinSpeed??400),i=Math.max(n,e.shootingStarsMaxSpeed??1200),r=Math.max(.2,Math.min(2,e.shootingStarsMinSize??.5)),l={minSpeed:n,maxSpeed:i,minSize:r,maxSize:Math.max(r,Math.min(4,e.shootingStarsMaxSize??1.5)),angle:e.shootingStarsAngle??-45,trailLength:Math.max(0,Math.min(20,e.shootingStarsTrailLength??5))};Ur=[];for(let s=0;3>s;s++){const e=Qt(a,o,l);e.age=.3*s,e.x+=e.vx*e.age,e.y+=e.vy*e.age,Ur.push(e)}Jr=performance.now(),Qr=2})()),console.log(`Mode ${e} initialized with ${t.balls.length} balls`),"undefined"!=typeof window&&window.legendFilter&&window.legendFilter.syncAllBalls)try{window.legendFilter.syncAllBalls()}catch(n){console.warn("Legend filter sync failed:",n)}const o=Math.max(0,Math.round(((e,t)=>{switch(e){case Bn.PIT:return t.pitWarmupFrames??10;case Bn.FLIES:return t.fliesWarmupFrames??10;case Bn.WEIGHTLESS:return t.weightlessWarmupFrames??10;case Bn.WATER:return t.waterWarmupFrames??10;case Bn.VORTEX:return t.vortexWarmupFrames??10;case Bn.MAGNETIC:return t.magneticWarmupFrames??10;case Bn.BUBBLES:return t.bubblesWarmupFrames??10;case Bn.KALEIDOSCOPE:return t.kaleidoscope3WarmupFrames??t.kaleidoscopeWarmupFrames??10;case Bn.CRITTERS:return t.crittersWarmupFrames??10;case Bn.NEURAL:return t.neuralWarmupFrames??10;case Bn.SPHERE_3D:return t.sphere3dWarmupFrames??10;case Bn.CUBE_3D:return t.cube3dWarmupFrames??10;case Bn.PARALLAX_LINEAR:return t.parallaxLinearWarmupFrames??10;case Bn.PARALLAX_FLOAT:return t.parallaxFloatWarmupFrames??10;case Bn.STARFIELD_3D:return t.starfield3dWarmupFrames??10;case Bn.ELASTIC_CENTER:return t.elasticCenterWarmupFrames??10;case Bn.DVD_LOGO:return t.dvdLogoWarmupFrames??10;case Bn.PARTICLE_FOUNTAIN:return t.particleFountainWarmupFrames??0;case Bn.SHOOTING_STARS:return t.shootingStarsWarmupFrames??10;default:return 10}})(e,t)||0));if(t.warmupFramesRemaining=o,"undefined"!=typeof window&&e!==a)try{window.dispatchEvent(new CustomEvent("bb:modeChanged",{detail:{prevMode:a,mode:e}}))}catch(n){}}function ia(){const e=y();try{Z?.()}catch(t){}na(e.currentMode)}function ra(){const e=y();return e.currentMode===Bn.FLIES?He:e.currentMode===Bn.PIT?je:e.currentMode===Bn.WEIGHTLESS?qe:e.currentMode===Bn.WATER?$e:e.currentMode===Bn.VORTEX?et:e.currentMode===Bn.MAGNETIC?tt:e.currentMode===Bn.BUBBLES?it:e.currentMode===Bn.KALEIDOSCOPE?mt:e.currentMode===Bn.SPHERE_3D?At:e.currentMode===Bn.CUBE_3D?zt:e.currentMode===Bn.CRITTERS?Ft:e.currentMode===Bn.NEURAL?It:e.currentMode===Bn.PARALLAX_LINEAR?Et:e.currentMode===Bn.PARALLAX_FLOAT?Bt:e.currentMode===Bn.STARFIELD_3D?Vt:e.currentMode===Bn.ELASTIC_CENTER?_t:e.currentMode===Bn.DVD_LOGO?jt:e.currentMode===Bn.PARTICLE_FOUNTAIN?Ut:e.currentMode===Bn.SHOOTING_STARS?ta:null}function la(){const e=y();return e.currentMode===Bn.WATER?Ge:e.currentMode===Bn.MAGNETIC?at:e.currentMode===Bn.BUBBLES?rt:e.currentMode===Bn.STARFIELD_3D?Nt:e.currentMode===Bn.ELASTIC_CENTER?Ht:e.currentMode===Bn.DVD_LOGO?qt:e.currentMode===Bn.NEURAL?Kt:e.currentMode===Bn.PARTICLE_FOUNTAIN?Jt:e.currentMode===Bn.PARALLAX_FLOAT?Ot:e.currentMode===Bn.PARALLAX_LINEAR?Pt:e.currentMode===Bn.CRITTERS?kt:e.currentMode===Bn.SHOOTING_STARS?aa:null}function sa(){const e=y();return e.currentMode===Bn.NEURAL?{preRender:Tt}:e.currentMode===Bn.STARFIELD_3D?{preRender:Gt}:e.currentMode===Bn.CRITTERS?{preRender:Lt}:e.currentMode===Bn.SHOOTING_STARS?{preRender:ea}:null}function ca(){if(!pl)return null;if(hl&&hl.isConnected)return hl;let e=document.getElementById("modal-modal-host");return e||(e=document.createElement("div"),e.id="modal-modal-host",e.className="modal-modal-host",pl.appendChild(e)),hl=e,hl}function da(e){if(!pl||!e)return;const t=ca();t&&(gl.has(e)||gl.set(e,{parent:e.parentNode,nextSibling:e.nextSibling}),t.appendChild(e))}function ua(e){if(!e)return;const t=gl.get(e);if(t&&t.parent)try{t.nextSibling&&t.nextSibling.parentNode===t.parent?t.parent.insertBefore(e,t.nextSibling):t.parent.appendChild(e)}catch(a){}}function pa(){const t=e("--wall-thickness","");if(t&&!/calc\(|vw|vh|vmin|vmax|%/i.test(t)){const e=parseFloat(t);if(Number.isFinite(e)&&e>0)return e}const a=y();return a?.wallThickness||12}function ha(){if(ul&&!yl){const e=pa();ul.style.setProperty("--modal-overlay-blur",e/4+"px")}}function fa(e){if(ul=document.getElementById("modal-blur-layer"),pl=document.getElementById("modal-content-layer"),!ul||!pl)return void console.warn("Modal Overlay: #modal-blur-layer or #modal-content-layer not found");if((()=>{const e=navigator.userAgent||"",t=navigator.vendor||"",a=/Safari\//.test(e)&&/Apple/.test(t)&&!/Chrome\//.test(e)&&!/Chromium\//.test(e),o=/iPad|iPhone|iPod/.test(e)||"MacIntel"===navigator.platform&&navigator.maxTouchPoints>1;return a||o})()&&document.documentElement.classList.add("is-safari"),fl=!1!==e.modalOverlayEnabled,!fl)return console.log("Modal Overlay: Disabled by config"),ul.style.display="none",void(pl.style.display="none");ul.style.display="",pl.style.display="",ca();const n=e.modalOverlayOpacity??t("--modal-overlay-opacity",.01),i=e.modalOverlayTransitionMs??o("--modal-overlay-transition-duration",800),r=e.modalOverlayTransitionOutMs??o("--modal-overlay-transition-out-duration",600),l=e.modalOverlayContentDelayMs??o("--modal-content-delay",200),s=e.modalDepthScale??t("--modal-depth-scale",.96),c=e.modalDepthTranslateY??a("--modal-depth-translate-y",8),d=e.logoBlurInactive??a("--logo-blur-inactive",0),u=e.logoBlurActive??a("--logo-blur-active-target",12),p=document.documentElement;if(p.style.setProperty("--modal-depth-scale",s),p.style.setProperty("--modal-depth-translate-y",c+"px"),p.style.setProperty("--modal-depth-duration",i+"ms"),p.style.setProperty("--modal-depth-out-duration",r+"ms"),p.style.setProperty("--modal-content-delay",l+"ms"),p.style.setProperty("--logo-blur-inactive",d+"px"),p.style.setProperty("--logo-blur-active-target",u+"px"),p.style.setProperty("--logo-blur-active",d+"px"),void 0!==e.modalOverlayBlurPx?(yl=!0,ul.style.setProperty("--modal-overlay-blur",e.modalOverlayBlurPx+"px")):(yl=!1,ha()),ml)return;ml=!0,p.style.setProperty("--modal-overlay-opacity",n),p.style.setProperty("--modal-overlay-transition-duration",i+"ms"),p.style.setProperty("--modal-overlay-transition-out-duration",r+"ms"),ul.classList.remove("active"),pl.classList.remove("active"),ul.setAttribute("aria-hidden","true"),pl.setAttribute("aria-hidden","true"),ga(!1),pl.addEventListener("click",ma,{capture:!0}),window.addEventListener("resize",()=>ha()),document.addEventListener("layout-updated",()=>ha());const h=pa()/2;console.log(`Modal Overlay: Initialized (two-layer architecture, blur: ${h}px, transition: ${i}ms)`)}function ma(e){if(!fl||!pl.classList.contains("active"))return;const t=e.target?.closest?e.target:e.target?.parentElement;if(!t?.closest)return;if(t.closest("button"))return;if(t.closest("input"))return;if(t.closest("a"))return;if(t.closest("select"))return;if(t.closest("textarea"))return;const a="cv-modal"===t.id||"portfolio-modal"===t.id||"contact-modal"===t.id||t.classList.contains("modal-label")||t.classList.contains("modal-description");(t===pl||"modal-modal-host"===t?.id||a)&&document.dispatchEvent(new CustomEvent("modal-overlay-dismiss",{detail:{instant:!1}}))}function ga(e){const t=document.documentElement,a=document.getElementById("abs-scene");if(e){const e=getComputedStyle(t).getPropertyValue("--modal-depth-scale").trim()||"0.96",o=getComputedStyle(t).getPropertyValue("--modal-depth-translate-y").trim()||"8px",n=getComputedStyle(t).getPropertyValue("--logo-blur-active-target").trim()||t.style.getPropertyValue("--logo-blur-active-target")||"12px";t.style.setProperty("--modal-depth-scale-active",e),t.style.setProperty("--modal-depth-ty-active",o),t.style.setProperty("--logo-blur-active",n),a&&a.classList.add("gate-depth-active")}else{const e=getComputedStyle(t).getPropertyValue("--logo-blur-inactive").trim()||"0px";t.style.setProperty("--modal-depth-scale-active","1"),t.style.setProperty("--modal-depth-ty-active","0px"),t.style.setProperty("--logo-blur-active",e),a&&a.classList.remove("gate-depth-active")}}function ya(){if(!ul||!pl||!fl)return;ha(),document.documentElement.classList.add("modal-active"),ul.setAttribute("aria-hidden","false"),pl.setAttribute("aria-hidden","false"),ul.classList.add("active"),pl.classList.add("active");const e=document.getElementById("custom-cursor");if(e){let a=!1;try{a=!(!window.matchMedia||!window.matchMedia("(max-width: 600px)").matches)}catch(t){}a?(e.classList.remove("modal-active"),e.style.display="none"):(e.classList.add("modal-active"),e.style.display="block")}ga(!0)}function ba(){if(!ul||!pl||!fl)return;ul.classList.remove("active"),pl.classList.remove("active"),document.documentElement.classList.remove("modal-active"),ul.setAttribute("aria-hidden","true"),pl.setAttribute("aria-hidden","true");const e=document.getElementById("custom-cursor");e&&e.classList.remove("modal-active"),ga(!1)}function Ma(){return!!pl&&pl.classList.contains("active")}function va(){try{return!!window.matchMedia?.("(prefers-reduced-motion: reduce)")?.matches}catch(e){return!1}}function xa(e,t,a){return t>e?t:e>a?a:e}function wa(e,t=.15){try{const a=parseInt(e.slice(1,3),16),o=parseInt(e.slice(3,5),16),n=parseInt(e.slice(5,7),16),i=Math.round(xa(a+(Math.random()-.5)*t*255,0,255)),r=Math.round(xa(o+(Math.random()-.5)*t*255,0,255)),l=Math.round(xa(n+(Math.random()-.5)*t*255,0,255));return`#${i.toString(16).padStart(2,"0")}${r.toString(16).padStart(2,"0")}${l.toString(16).padStart(2,"0")}`}catch(a){return e}}function Sa(e){const t=+e?.sceneImpactMul,a=Number.isFinite(t)?t:0,o=+e?.sceneImpactMobileMulFactor,n=Number.isFinite(o)&&o>0?o:1;return a*((e=>{if(e?.isMobile||e?.isMobileViewport)return!0;try{return!(!window.matchMedia||!window.matchMedia("(max-width: 600px)").matches)}catch(t){return!1}})(e)?n:1)}function Ca(){if(!Bl)return;let e=null;try{e=y()}catch(o){}if(!e)return;const t=Sa(e);Bl.style.setProperty("--abs-scene-impact-mul",t+"");const a=+e.sceneImpactLogoCompMul;Number.isFinite(a)&&a>0&&Bl.style.setProperty("--abs-scene-impact-logo-comp-mul",a+"")}function ka(){Wl&&(window.clearTimeout(Wl),Wl=0),zl&&(window.clearTimeout(zl),zl=0)}function Fa(){if("undefined"!=typeof window&&"undefined"!=typeof document&&(Bl=document.querySelector("#abs-scene")||null,Bl&&(Bl.style.setProperty(Pl,"0"),Bl.style.setProperty(El,"100ms"),Bl.style.setProperty(Ol,"1"),Ca(),!(()=>{try{return!(!window.matchMedia||!window.matchMedia("(prefers-reduced-motion: reduce)").matches)}catch(e){return!1}})()))){Al=!0,Bl.classList.add("abs-scene--impact");try{window.addEventListener("resize",Ca,{passive:!0})}catch(e){}window.addEventListener("bb:modeChanged",e=>{const t=y();if(!1===t?.sceneImpactEnabled)return;if($l)return void($l=!1);const a=e?.detail||{};((e=1,t={})=>{if(!Al||!Bl)return;const a=y();if(!1===a?.sceneImpactEnabled)return;const o=Math.max(0,Math.min(1,+e||0)),n=++Rl;ka(),Bl.classList.add("abs-scene--animating"),t?.armManual&&($l=!0);const i=a?.sceneImpactPressMs??75,r=a?.sceneImpactReleaseMs??220,l=Math.max(1,Math.round(.8*(+i||0))),s=Math.max(1,Math.round(1.2*(+r||0))),c=Math.round(Math.min(80,Math.max(0,.4*(+l||0))));Bl.style.setProperty(El,Math.round(l)+"ms"),window.requestAnimationFrame(()=>{Al&&Bl&&n===Rl&&(Bl.style.setProperty(Pl,o+""),Bl.style.setProperty(Ol,((e,t)=>{const a=Sa(t),o=Math.max(0,+e||0)*a,n=1/Math.max(.001,1-o),i=+t?.sceneImpactLogoCompMul;return Math.max(.5,Math.min(4,n*(1+((Number.isFinite(i)&&i>0?i:1)-1)*o)))})(o,a)+""))}),Wl=window.setTimeout(()=>{(({token:e,releaseMs:t})=>{ka(),Al&&Bl&&e===Rl&&(Bl.style.setProperty(El,Math.round(t)+"ms"),window.requestAnimationFrame(()=>{Al&&Bl&&e===Rl&&(Bl.style.setProperty(Pl,"0"),Bl.style.setProperty(Ol,"1"))}),zl=window.setTimeout(()=>{zl=0,Bl&&Bl.classList.remove("abs-scene--animating")},Math.max(0,Math.round(t)+80)))})({token:n,releaseMs:s})},Math.max(0,Math.round(l)+c)),zl=window.setTimeout(()=>{zl=0,Bl&&Bl.classList.remove("abs-scene--animating")},Math.max(0,Math.round(l)+c+Math.round(s)+80))})(a.prevMode&&a.mode&&a.prevMode!==a.mode?1:.75,{armManual:!1})},{passive:!0})}}function La(){function e(e){return!(!e||!e.closest||!(e.closest("#panelDock")||e.closest("#masterPanel")||e.closest("#dockToggle")||e.closest(".panel-dock")||e.closest(".panel")||e.closest("#expertise-legend")||e.closest(".legend__item")))}function t(e,t){const a=n.getBoundingClientRect();return{x:n.width/(a.width||1)*(e-a.left),y:n.height/(a.height||1)*(t-a.top),inBounds:!(a.left>e||e>a.right||a.top>t||t>a.bottom)}}function a(a,n,i,{isMouseLike:r}={isMouseLike:!0}){const l=t(a,n),s=performance.now(),c=s-Nl;if(c>0&&Nl>0){const e=l.x-Gl,t=l.y-Vl,a=Math.sqrt(e*e+t*t);_l=a/c,a>.1&&(Hl=e/a,jl=t/a)}if(r?Ta(a,n):Pa(),e(i))return;if(Ma())return;o.mouseX=l.x,o.mouseY=l.y,o.mouseInCanvas=l.inBounds,"undefined"!=typeof window&&(window.mouseInCanvas=l.inBounds);const d=Math.hypot(l.x-(o.lastPointerMoveX??l.x),l.y-(o.lastPointerMoveY??l.y));d>.5&&(o.lastPointerMoveMs=s,o.lastPointerMoveX=l.x,o.lastPointerMoveY=l.y),r&&d>.5&&((e,t,a,o)=>{if(Oa())return;const n=y();if(!n?.mouseTrailEnabled)return;if(!o)return;if(Ba())return;if((e=>{const t=Math.max(0,0|e);t>0&&(ss===t&&cs&&ds&&us||(ss=t,cs=new Float32Array(ss),ds=new Float32Array(ss),us=new Float64Array(ss),ps=0,hs=0))})(Aa(0|(n.mouseTrailLength??18),4,96)),!ss)return;const i=n.DPR||1,r=Aa(+(n.mouseTrailSize??1.3),.5,10)*i,l=Math.max(.35,.55*r),s=l*l;if(hs>0){const o=(ps-1+ss)%ss;if(((e,t,a,o)=>{const n=e-a,i=t-o;return n*n+i*i})(e,t,cs[o],ds[o])<s)return void(us[o]=a)}cs[ps]=e,ds[ps]=t,us[ps]=a,ps=(ps+1)%ss,ss>hs&&hs++})(l.x,l.y,s,l.inBounds),o.currentMode===Bn.WATER&&l.inBounds&&_l>.3&&s-Yl>80&&(Ve(l.x,l.y,Math.min(2*_l,3)),Yl=s),Gl=l.x,Vl=l.y,Nl=s}const o=y(),n=o.canvas;void 0===o.clickCycleEnabled&&(o.clickCycleEnabled=!1),n?(document.addEventListener("mousemove",e=>{window.PointerEvent||a(e.clientX,e.clientY,e.target,{isMouseLike:!0})},{passive:!0}),document.addEventListener("pointermove",e=>{a(e.clientX,e.clientY,e.target,{isMouseLike:"mouse"===e.pointerType||"pen"===e.pointerType})},{passive:!0}),document.addEventListener("click",a=>{if(!o.clickCycleEnabled)return;if(e(a.target))return;if((e=>!(!e||!e.closest||!(e.closest("a")||e.closest("button")||e.closest("input")||e.closest("select")||e.closest("textarea")||e.closest('[role="button"]')||e.closest(".legend__item--interactive"))))(a.target))return;if(Ma())return;if(!t(a.clientX,a.clientY).inBounds)return;const n=performance.now();150>n-ql||(ql=n,0===(void 0!==a.button?a.button:3===a.which?2:2===a.which?1:0)&&(()=>{const e=y(),t=Wn,a=t.indexOf(e.currentMode),o=t[((0>a?0:a)+1)%t.length];Promise.resolve().then(()=>dl).then(({setMode:e})=>{e(o)}),import("./controls.js").then(({updateModeButtonsUI:e})=>{e(o)})})())},{passive:!0}),document.addEventListener("touchmove",e=>{if(!Ma()&&e.touches&&e.touches[0]){const a=t(e.touches[0].clientX,e.touches[0].clientY);o.mouseX=a.x,o.mouseY=a.y,o.mouseInCanvas=a.inBounds;const n=performance.now();Math.hypot(a.x-(o.lastPointerMoveX??a.x),a.y-(o.lastPointerMoveY??a.y))>.5&&(o.lastPointerMoveMs=n,o.lastPointerMoveX=a.x,o.lastPointerMoveY=a.y),o.currentMode===Bn.WATER&&a.inBounds&&n-Yl>80&&(Ve(a.x,a.y,2),Yl=n)}},{passive:!0}),document.addEventListener("touchstart",t=>{window.PointerEvent||e(t.target)||Ma()||Pa()},{passive:!0}),document.addEventListener("mouseleave",()=>{o.mouseX=Gn.OFFSCREEN_MOUSE,o.mouseY=Gn.OFFSCREEN_MOUSE,o.mouseInCanvas=!1,_l=0,Hl=0,jl=0,"undefined"!=typeof window&&(window.mouseInCanvas=!1),Pa()},{passive:!0}),document.addEventListener("mouseenter",()=>{Ea()},{passive:!0}),document.addEventListener("touchend",()=>{o.mouseX=Gn.OFFSCREEN_MOUSE,o.mouseY=Gn.OFFSCREEN_MOUSE,o.mouseInCanvas=!1},{passive:!0}),console.log(" Unified pointer system configured (document-level)"),o.xe=!0,"undefined"!=typeof window&&(window.xe=!0)):console.error("Canvas not available for pointer setup")}function Ia(){const e=y();return e?.cursorColorHex&&"string"==typeof e.cursorColorHex?e.cursorColorHex:"#000000"}function Da(){if(Xl)return;Zl=document.createElement("div"),Zl.id="custom-cursor",Zl.setAttribute("aria-hidden","true");const e=document.getElementById("bravia-balls");e?e.appendChild(Zl):document.body.appendChild(Zl),Zl.style.display="none",Zl.style.opacity="0",Xl=!0,Ka(),(()=>{if(ts||!Zl)return;ts=!0;const e=y(),t=(e.entranceWallTransitionDelay??300)+.3*(e.entranceWallTransitionDuration??800)+(e.entranceElementDuration??500)+600,a="cubic-bezier(0.16, 1, 0.3, 1)";window.matchMedia?.("(prefers-reduced-motion: reduce)")?.matches?setTimeout(()=>{Zl&&(Zl.style.opacity="1")},t):setTimeout(()=>{Zl&&requestAnimationFrame(()=>{requestAnimationFrame(()=>{if(Zl){if("function"!=typeof Zl.animate)return Zl.style.opacity="1",void(Zl.style.transition="opacity 800ms "+a);Ul&&(Zl.style.display="block"),as=Zl.animate([{opacity:0},{opacity:1}],{duration:800,easing:a,fill:"forwards"}),as?.addEventListener?.("finish",()=>{Zl&&(Zl.style.opacity="1")}),as?.addEventListener?.("cancel",()=>{Zl&&(Zl.style.opacity="1")})}})})},t)})()}function Ka(){if(!Zl)return;const e=y(),t=.5*(e.R_MIN+e.R_MAX)*e.cursorSize*2;Zl.style.width=t+"px",Zl.style.height=t+"px",Zl.style.borderRadius="50%",Zl.style.marginLeft="0",Zl.style.marginTop="0",Ul||(Zl.style.transform=ns)}function Ta(e,t){if(!Zl)return;const a=(()=>{try{return!!document?.body?.classList?.contains?.("abs-link-hovering")}catch(e){return!1}})();if(a&&!os){const a=((e,t)=>{const a=y(),o=a?.canvas;if(!o)return null;const n=o.getBoundingClientRect();return{x:o.width/(n.width||1)*(e-n.left),y:o.height/(n.height||1)*(t-n.top),inBounds:!(n.left>e||e>n.right||n.top>t||t>n.bottom)}})(e,t);if(a){const e=y(),t=e?.canvas;let o=a.x,n=a.y;if(!a.inBounds&&t&&(o=Math.max(0,Math.min(t.width,o)),n=Math.max(0,Math.min(t.height,n))),t&&o>=0&&n>=0&&t.width>=o&&t.height>=n){const e=Ia(),t=_l||0,a={x:Hl||0,y:jl||0};((e,t,a,o=0)=>{const n=y();if(!n?.cursorExplosionEnabled)return;if(va())return;if(!n.canvas||!n.ctx)return;const i=n.DPR||1,r=(n.cursorExplosionSpeed??400)*i,l=Math.floor(n.cursorExplosionParticleCount??16),s=n.cursorExplosionSpreadDeg??360,c=n.cursorExplosionLifetime??.8,d=n.cursorExplosionImpactMinFactor??.5,u=xa(d+o/(n.cursorExplosionImpactSensitivity??400),d,n.cursorExplosionImpactMaxFactor??4),p=Math.floor(l*u),h=r*u,f=Math.min(s*(.6+.4*u),360),m=n.cursorExplosionLifetimeImpactMin??.7,g=c*xa(m+o/(n.cursorExplosionLifetimeImpactSensitivity??600),m,n.cursorExplosionLifetimeImpactMax??1.8);let b=Math.random()*Math.PI*2;if(0!==Kl||0!==Tl){const e=Math.atan2(Tl,Kl),t=xa(o/500,.3,.8);b=e+(Math.random()-.5)*(1-t)*Math.PI*2}const M=f*Math.PI/180,v=Math.min(p,Ml-vl);for(let y=0;v>y;y++){const o=vl+y;if(o>=Ml)break;const r=b+(Math.random()-.5)*M,l=h*(.8+.4*Math.random()),s=(n.cursorSize??1.15)*(n.R_MIN??5)*.3*i,c=Math.random()*Math.PI*2;xl[o]=e+Math.cos(c)*s*Math.random(),wl[o]=t+Math.sin(c)*s*Math.random(),Sl[o]=Math.cos(r)*l,Cl[o]=Math.sin(r)*l,Fl[o]=g*(.9+.2*Math.random()),kl[o]=0,Ll[o]=1;const d=xa(3*(n.cursorSize??1.15)*i,2*i,6*i);Il[o]=d*(.8+.4*Math.random()),Dl[o]=.7>Math.random()?a:wa(a,.12)}vl+=v})(o,n,e,t),!a||0===a.x&&0===a.y||((e,t,a)=>{if(e>0){const e=Math.sqrt(t*t+a*a);e>.01&&(Kl=t/e,Tl=a/e)}})(t,a.x,a.y)}}}if(os=a,a)return void(Zl.style.display="none");const o=Ul;Ul=((e,t)=>{const a=document.getElementById("bravia-balls");if(!a)return!1;const o=performance.now();return Jl&&es>=o-Ql||(Jl=a.getBoundingClientRect(),Ql=o),!(Jl.left>e||e>Jl.right||Jl.top>t||t>Jl.bottom)})(e,t);const n=Ma(),i=document.getElementById("bravia-balls");if(n)i&&i.contains(Zl)&&(document.body.appendChild(Zl),Zl.style.position="fixed",Zl.style.zIndex="20000"),Zl.style.left=e+"px",Zl.style.top=t+"px";else if(i&&!i.contains(Zl)&&(i.appendChild(Zl),Zl.style.position="absolute",Zl.style.zIndex="3"),i){const a=i.getBoundingClientRect();Zl.style.left=e-a.left+"px",Zl.style.top=t-a.top+"px"}else Zl.style.left=e+"px",Zl.style.top=t+"px";if(document.body.style.cursor="none",n)return Zl.style.display="block",void(Zl.style.transform=rs);Ul?(Zl.style.display="block",o?Zl.style.transform!==is&&(Zl.style.transform=is):(Zl.style.transform=ns,requestAnimationFrame(()=>{Zl.style.transform=is}))):(Zl.style.display="none",o&&(Zl.style.transform=ns,Zl.style.backgroundColor="",Zl.style.filter=""))}function Pa(){Zl&&(Zl.style.display="none",document.body.style.cursor="none",Ul=!1)}function Ea(){Zl&&(Ul=!1)}function Oa(){const e=(()=>{try{return!!document?.body?.classList?.contains?.("abs-link-hovering")}catch(e){return!1}})();return e&&!fs&&(ps=0,hs=0),fs=e,e}function Ba(){try{return!!window.matchMedia?.("(prefers-reduced-motion: reduce)")?.matches}catch(e){return!1}}function Aa(e,t,a){return t>e?t:e>a?a:e}function Ra(){return ms}function Wa(e){ms=e}function za(e){ms-=e}function $a(){ms=0}function Ga(){if(Cs.arrays.length>Cs.arrayIndex){const e=Cs.arrays[Cs.arrayIndex++];return e.length=0,e}const e=[];return Cs.arrays.push(e),Cs.arrayIndex++,e}function Va(e,t,a,o,n=!1){const i=bs+e.r,r=i*i;let l=e.x-bs,s=e.y-bs,c=l*l+s*s;if(r>c&&c>0){const t=Math.sqrt(c),a=(i-t)/i*Ms,n=1/t;e.vx+=l*n*a*o,e.vy+=s*n*a*o}if(l=e.x-(t-bs),s=e.y-bs,c=l*l+s*s,r>c&&c>0){const t=Math.sqrt(c),a=(i-t)/i*Ms,n=1/t;e.vx+=l*n*a*o,e.vy+=s*n*a*o}if(!n){if(l=e.x-bs,s=e.y-(a-bs),c=l*l+s*s,r>c&&c>0){const t=Math.sqrt(c),a=(i-t)/i*Ms,n=1/t;e.vx+=l*n*a*o,e.vy+=s*n*a*o}if(l=e.x-(t-bs),s=e.y-(a-bs),c=l*l+s*s,r>c&&c>0){const t=Math.sqrt(c),a=(i-t)/i*Ms,n=1/t;e.vx+=l*n*a*o,e.vy+=s*n*a*o}}}function Na(e,t){const a=y(),o=a.balls,n=a.canvas;if(!n)return;if(0===o.length)return;const i=a.isMobile||a.isMobileViewport?ys:gs;if(a.currentMode===Bn.KALEIDOSCOPE){const i=Math.min(.033,Math.max(0,e)),r=o.length;for(let e=0;r>e;e++)o[e].step(i,t);Ss.maxCorrectionPx=1.25*(a.DPR||1),(({iterations:e=4,positionalCorrectionPercent:t=.25,positionalCorrectionSlopPx:a=null,maxCorrectionPx:o=null,enableSound:n=!0}={})=>{const i=y(),r=i.balls,l=De(),s=i.REST,c=t,d=a??.5*i.DPR,u=i.ballSpacing||0,p=o??2*(i.DPR||1);for(let h=0;e>h;h++)for(let e=0;l.length>e;e++){const{i:t,j:a}=l[e],o=r[t],f=r[a];if(o.isSleeping&&f.isSleeping)continue;o.isSleeping&&o.wake(),f.isSleeping&&f.wake();const m=f.x-o.x,g=f.y-o.y,y=o.r+f.r+(o.r+f.r)/2*u,b=m*m+g*g;if(0===b||b>y*y)continue;const M=Math.sqrt(b),v=m/M,x=g/M,w=y-M,S=1/Math.max(o.m,.001),C=1/Math.max(f.m,.001);let k=c*Math.max(w-d,0)/(S+C);k>p&&(k=p);const F=k*v,L=k*x;o.x-=F*S,o.y-=L*S,f.x+=F*C,f.y+=L*C;const I=(f.vx-o.vx)*v+(f.vy-o.vy)*x;if(0>I){const e=-(1+(30>Math.abs(I)?0:s))*I/(S+C),r=e*v,l=e*x;if(o.vx-=r*S,o.vy-=l*S,f.vx+=r*C,f.vy+=l*C,n&&0===h){const e=(o.r+f.r)/2,n=(o.x+f.x)/2/(i.canvas?.width||1);Me(e,Math.min(1,Math.abs(I)/(50*(o.r+f.r))),n,`${t}-${a}`)}}}})(Ss);for(let e=0;r>e;e++)ut(o[e],n.width,n.height,i);return void Wa(0)}ms+=e;let r=0;for(;Ra()>=i&&Gn.MAX_PHYSICS_STEPS>r;){const e=o.length;for(let a=0;e>a;a++)o[a].step(i,t);const l=Math.max(1,Math.min(20,Math.round(+(a.physicsCollisionIterations??10)||10)));a.currentMode===Bn.KALEIDOSCOPE?Ke(6):a.currentMode!==Bn.FLIES&&a.currentMode!==Bn.SPHERE_3D&&a.currentMode!==Bn.CUBE_3D&&a.currentMode!==Bn.PARALLAX_LINEAR&&a.currentMode!==Bn.PARALLAX_FLOAT&&a.currentMode!==Bn.STARFIELD_3D&&a.currentMode!==Bn.DVD_LOGO&&Ke(l);const s=a.currentMode;if(s!==Bn.SPHERE_3D&&s!==Bn.CUBE_3D&&s!==Bn.PARALLAX_LINEAR&&s!==Bn.PARALLAX_FLOAT&&s!==Bn.STARFIELD_3D){const e=s===Bn.WEIGHTLESS?a.weightlessBounce:a.REST,t=s===Bn.PIT,r=o.length,l=xs,c=a.isMobile||a.isMobileViewport,d=n.width,u=n.height;for(let a=0;r>a;a++){const n=o[a];n.isDvdLogo||(t||Va(n,d,u,i,c),n.walls(d,u,i,e,l))}}if(s===Bn.PIT){Ke(3);const e=a.REST,t=o.length,r=n.width,l=n.height;for(let a=0;t>a;a++)o[a].walls(r,l,i,e,ws);const s=a.DPR||1,c=(Number.isFinite(a.sleepVelocityThreshold)?a.sleepVelocityThreshold:12)*s,d=c*c,u=4*s*s,p=Number.isFinite(a.sleepAngularThreshold)?a.sleepAngularThreshold:.18,h=a.timeToSleep??.25;for(let a=0;t>a;a++){const e=o[a];if(!e||e.isSleeping)continue;const t=e.vx*e.vx+e.vy*e.vy,n=Math.abs(e.omega);(e.isGrounded||e.hasSupport)&&d>t&&p>n?(e.vx*=.5,e.vy*=.5,e.omega*=.5,u>t&&(e.vx=0,e.vy=0),.02>n&&(e.omega=0),e.sleepTimer+=i,h>e.sleepTimer||(e.vx=0,e.vy=0,e.omega=0,e.isSleeping=!0)):e.sleepTimer=0}}if(!1!==a.physicsSkipSleepingSteps&&s!==Bn.FLIES&&s!==Bn.SPHERE_3D&&s!==Bn.CUBE_3D&&s!==Bn.PARALLAX_LINEAR&&s!==Bn.PARALLAX_FLOAT&&s!==Bn.KALEIDOSCOPE&&s!==Bn.PIT){const e=a.DPR||1,t=Math.max(0,+(a.physicsSleepThreshold??12)||0)*e,n=t*t,r=Math.max(0,+(a.physicsSleepTime??.25)||0),l=Number.isFinite(a.sleepAngularThreshold)?a.sleepAngularThreshold:.18;if(t>0&&r>0){const e=o.length;for(let t=0;e>t;t++){const e=o[t];e&&!e.isSleeping&&(!0!==e.isMeteor&&n>e.vx*e.vx+e.vy*e.vy&&l>Math.abs(e.omega)?(e.sleepTimer+=i,r>e.sleepTimer||(e.vx=0,e.vy=0,e.omega=0,e.isSleeping=!0)):e.sleepTimer=0)}}}za(i),r++}const l=la();l&&l(e),Ra()>i*Gn.ACCUMULATOR_RESET_THRESHOLD&&Wa(0)}async function _a(e,t){const a=y(),o=a.balls;if(!a.canvas)return;if(!o||0===o.length)return;const n=Math.max(0,Math.round(a.warmupFramesRemaining||0));if(n>0){a.warmupFramesRemaining=0,Wa(0);for(let e=0;n>e;e++)Na(vs,t)}else Na(e,t),(e=>{const t=y();if(!t?.cursorExplosionEnabled)return;if(!vl)return;const a=t.cursorExplosionDrag??.95,o=t.cursorExplosionFadeStartRatio??.6;let n=0;for(let i=0;vl>i;i++){const r=kl[i]+e,l=Fl[i];if(r>=l)continue;kl[i]=r,Sl[i]*=a,Cl[i]*=a,xl[i]+=Sl[i]*e,wl[i]+=Cl[i]*e;const s=r/l;let c=1;if(s>=o){const e=(s-o)/(1-o);c=1-e*e*e}Ll[i]=Math.max(0,c),!1!==t.cursorExplosionShrinkEnabled&&(Il[i]=Il[i]*(1-.3*s)),i!==n&&(xl[n]=xl[i],wl[n]=wl[i],Sl[n]=Sl[i],Cl[n]=Cl[i],kl[n]=kl[i],Fl[n]=Fl[i],Ll[n]=Ll[i],Il[n]=Il[i],Dl[n]=Dl[i]),n++}vl=n})(e)}function Ha(){const e=y(),t=e.ctx,a=e.balls,o=e.canvas;if(!t||!o)return;t.clearRect(0,0,o.width,o.height);const n=e.canvasClipPath,i=n&&(e.cornerRadius??e.wallRadius??0)>0;if(i){t.save();try{t.clip(n)}catch(l){}}const r=sa();if(r&&r.preRender&&r.preRender(t),e.currentMode===Bn.KALEIDOSCOPE)(e=>{const t=y();if(!ht(t.currentMode))return;const a=t.canvas;if(!a)return;const o=(()=>{const e=performance.now(),t=ur||e;return ur=e,lt((e-t)/1e3,0,.05)})(),n=t.balls,i=a.width,r=a.height,l=st(t),s=t.isMobile||t.isMobileViewport?t.kaleidoscope3WedgesMobile??6:pt(t).wedges??12,c=lt(Math.round(s),3,24),d=!!(t.kaleidoscopeMirror??1),u=(e=>.5*e.width)(a),p=(e=>.5*e.height)(a),h=cr/c,f=Math.max(1e-5,1e-4*h),m=t.mouseInCanvas?t.mouseX:u,g=t.mouseInCanvas?t.mouseY:p,b=m-u,M=g-p,v=Math.atan2(M,b),x=lt(Math.hypot(b,M)/Math.max(1,.5*Math.min(i,r)),0,1);t.we||(t.we={phase:{x:0,v:0},panX:{x:0,v:0},panY:{x:0,v:0},lastMouseX:m,lastMouseY:g,lastInCanvas:!!t.mouseInCanvas});const w=t.we,S=!!t.mouseInCanvas,C=Math.hypot(m-w.lastMouseX,g-w.lastMouseY)>.5||S!==w.lastInCanvas,k=lt(pt(t).speed??1,.2,2),F=ft(t),L=.65*k*F,I=b*L*(t.mouseInCanvas?1:0),D=M*L*(t.mouseInCanvas?1:0),K=.7*v*F*(t.mouseInCanvas?1:0),T=(t.kaleidoscopeIdleSpeed??.08)*F*(t.prefersReducedMotion?0:1);if(C)w.lastMouseX=m,w.lastMouseY=g,w.lastInCanvas=S,dt(w.phase,K,o,4.5),dt(w.panX,I,o,5),dt(w.panY,D,o,5);else{if(T>0){w.phase.x+=T*o;const e=2*Math.PI;w.phase.x>e&&(w.phase.x-=e),-e>w.phase.x&&(w.phase.x+=e)}w.phase.v=0,w.panX.v=0,w.panY.v=0}const P=w.phase.x,E=w.panX.x,O=w.panY.x,B=.22+.18*lt((k-.2)/1.8,0,1),A=1-B+2*B*(1-x),R=new Float32Array(c),W=new Float32Array(c);for(let y=0;c>y;y++){const e=y*h;R[y]=Math.cos(e),W[y]=Math.sin(e)}for(let y=0;n.length>y;y++){const t=n[y],a=t.x-u+E,o=t.y-p+O,i=3.5*l,r=Math.hypot(a,o)*i*A;if(dr>r)continue;const s=d?2*h:h;let m=Math.atan2(o,a)+P;m=(m%s+s)%s,d&&m>h&&(m=s-m),m=lt(m,f,h-f);const g=Math.cos(m),b=Math.sin(m);for(let n=0;c>n;n++){const a=R[n],o=W[n],i=u+(a*g-o*b)*r,l=p+(o*g+a*b)*r;1>t.alpha&&(e.globalAlpha=t.alpha),e.fillStyle=t.color,e.beginPath(),e.arc(i,l,t.r,0,cr),e.fill(),1>t.alpha&&(e.globalAlpha=1)}}})(t);else{Cs.map.clear(),Cs.arrayIndex=0;const e=Cs.map;for(let t=0;a.length>t;t++){const o=a[t],n=o.color;e.has(n)||e.set(n,Ga()),e.get(n).push(o)}for(const[a,o]of e){t.fillStyle=a;for(let e=0;o.length>e;e++){const a=o[e];a.squashAmount>.01||1>a.alpha*(a.filterOpacity??1)?a.draw(t):(t.beginPath(),t.arc(a.x,a.y,a.getDisplayRadius(),0,2*Math.PI),t.fill())}}}r&&r.postRender&&r.postRender(t),i&&t.restore(),(e=>{if(Oa())return;const t=y();if(!t?.mouseTrailEnabled)return;if(Ba())return;if(!e||!hs||!ss)return;const a=performance.now(),o=Aa(+(t.mouseTrailFadeMs??220),40,2e3),n=Aa(+(t.mouseTrailOpacity??.35),0,1);if(0>=n)return;const i=t.DPR||1,r=Aa(+(t.mouseTrailSize??1.3),.5,10)*i;for(;hs>0&&a-us[(ps-hs+ss)%ss]>o;)hs--;if(!hs)return;if(2>hs)return;const l=Ia(),s=e.globalAlpha,c=e.globalCompositeOperation,d=e.lineCap,u=e.lineJoin,p=e.strokeStyle,h=e.lineWidth;e.globalCompositeOperation="source-over",e.lineCap="round",e.lineJoin="round",e.strokeStyle=l,e.lineWidth=r,e.globalAlpha=n;const f=hs,m=(ps-f+ss)%ss;if(e.beginPath(),e.moveTo(cs[m],ds[m]),2===f)e.lineTo(cs[(m+1)%ss],ds[(m+1)%ss]);else{for(let a=1;f-1>a;a++){const t=(m+a)%ss,o=(m+a+1)%ss,n=cs[t],i=ds[t];e.quadraticCurveTo(n,i,.5*(n+cs[o]),.5*(i+ds[o]))}const t=(m+f-1)%ss;e.lineTo(cs[t],ds[t])}e.stroke(),e.globalAlpha=s,e.globalCompositeOperation=c,e.lineCap=d,e.lineJoin=u,e.strokeStyle=p,e.lineWidth=h})(t),(e=>{const t=y();if(!t?.cursorExplosionEnabled)return;if(va())return;if(!vl||!e)return;const a=new Map;for(let i=0;vl>i;i++){const e=Dl[i];a.has(e)||a.set(e,[]),a.get(e).push(i)}const o=e.globalAlpha,n=e.globalCompositeOperation;e.globalCompositeOperation="source-over";for(const[i,r]of a){e.fillStyle=i;for(const t of r){const a=Ll[t];if(0>=a)continue;const o=Math.max(.5,Il[t]);e.globalAlpha=a,e.beginPath(),e.arc(xl[t],wl[t],o,0,2*Math.PI),e.fill()}}e.globalAlpha=o,e.globalCompositeOperation=n})(t),((e,t,a)=>{const o=y(),n=o.isDarkMode||!1,i="number"==typeof o.depthWashOpacity?o.depthWashOpacity:.65;if(0>=i)return;const r=((e,t,a,o)=>`${e}|${t}|${o}|${a.depthWashCenterY}|${a.depthWashRadiusScale}|${a.depthWashCenterColorLight}|${a.depthWashEdgeColorLight}|${a.depthWashCenterAlphaLight}|${a.depthWashEdgeAlphaLight}|${a.depthWashCenterColorDark}|${a.depthWashEdgeColorDark}|${a.depthWashCenterAlphaDark}|${a.depthWashEdgeAlphaDark}`)(t,a,o,n);null!==qi&&Yi===r||(qi=((e,t,a,o,n)=>{const i="number"==typeof o.depthWashRadiusScale?o.depthWashRadiusScale:1,r=t/2,l=a*("number"==typeof o.depthWashCenterY?o.depthWashCenterY:.3),s=e.createRadialGradient(r,l,0,r,l,Math.max(t,a)*i),c=n?o.depthWashEdgeColorDark||"#05020f":o.depthWashEdgeColorLight||"#142b48",d=n?"number"==typeof o.depthWashCenterAlphaDark?o.depthWashCenterAlphaDark:0:"number"==typeof o.depthWashCenterAlphaLight?o.depthWashCenterAlphaLight:.3,u=n?"number"==typeof o.depthWashEdgeAlphaDark?o.depthWashEdgeAlphaDark:.8:"number"==typeof o.depthWashEdgeAlphaLight?o.depthWashEdgeAlphaLight:.4,p=Ne(n?o.depthWashCenterColorDark||"#1a1e23":o.depthWashCenterColorLight||"#ffffff"),h=Ne(c);return s.addColorStop(0,`rgba(${p.r}, ${p.g}, ${p.b}, ${d})`),s.addColorStop(1,`rgba(${h.r}, ${h.g}, ${h.b}, ${u})`),s})(e,t,a,o,n),Yi=r),e.save(),e.globalCompositeOperation=n?o.depthWashBlendModeDark||"multiply":o.depthWashBlendModeLight||"color-dodge",e.globalAlpha=i,e.fillStyle=qi,e.fillRect(0,0,t,a),e.restore()})(t,o.width,o.height),Te(t,o.width,o.height)}function ja(){$i=Ee()}function qa(){return null===Ls&&(Ls=(()=>{try{return!1}catch(e){}try{if("8001"==(globalThis?.location?.port??"")+"")return!0}catch(e){}try{if(Array.from(document.scripts||[]).some(e=>{if("module"!==(e.getAttribute("type")||"").toLowerCase())return!1;const t=e.getAttribute("src")||"";return/(^|\/)main\.js(\?|#|$)/.test(t)}))return!0}catch(e){}return!1})()),Ls}function Ya(e){const t=Math.random();let a=0;for(let o=0;8>o;o++)if(a+=Ps[o],a>=t)return e[o];return e[0]}function Za({sentence:e="Curious mind detected. Design meets engineering at 60fps.",ascii:t=["        ","                   ","             ","                   ","        "],silence:a=!1}={}){if(!Ks){Ks=!0;try{Fs.log("%c"+e,"color: #888; font-style: italic;"),Fs.log("");try{const e=((e,t=3)=>{const{colorAssignments:a}=((e,t=3)=>{let a;try{a=(()=>{try{const e=y(),t=e?.currentColors;if(Array.isArray(t)&&t.length>=8)return t.slice(0,8)}catch(e){}return Ts})(),Array.isArray(a)&&a.length>=8||(a=Ts)}catch(l){a=Ts}const o=[];for(let s=0;e.length>s;s++){const a=e[s];for(let e=0;a.length>e;e+=t){const n=a.slice(e,e+t);o.push({row:s,col:e,visible:n.trim().length>0})}}const n=o.map((e,t)=>e.visible?t:-1).filter(e=>e>=0),i=Array(o.length).fill(null),r=(e=>{for(let t=e.length-1;t>0;t--){const a=Math.floor(Math.random()*(t+1));[e[t],e[a]]=[e[a],e[t]]}return e})([...n]);for(let s=0;Math.min(8,r.length)>s;s++){const e=Math.min(s,a.length-1);i[r[s]]=a[e]||Ts[e]}for(const s of n)null===i[s]&&(i[s]=Ya(a));for(let s=0;o.length>s;s++)null===i[s]&&(i[s]="transparent");return{clusters:o,colorAssignments:i}})(e,t),o=[];let n=0;for(const i of e){let e="";const r=[];for(let o=0;i.length>o;o+=t)e+="%c"+i.slice(o,o+t),r.push(`color: ${a[n]}; font-family: monospace; font-weight: bold; font-size: 12px; letter-spacing: 0;`),n++;o.push([e,...r])}return o})(t,3);for(const t of e)Fs.log(...t)}catch(o){for(const e of t)Fs.log(e)}Fs.log("");const a=(new Date).getFullYear();Fs.log("%c "+a+" Alexander Beck Studio. All rights reserved. Unauthorized reproduction prohibited.","color: #555; font-size: 10px;")}catch(n){}if(a)try{console.log=()=>{},console.info=()=>{},console.warn=()=>{},console.debug=()=>{},console.table=()=>{},console.group=()=>{},console.groupCollapsed=()=>{},console.groupEnd=()=>{}}catch(n){}}}function Xa({sentence:e="Curious mind detected. Design meets engineering at 60fps.",ascii:t=["        ","                   ","             ","                   ","        "]}={}){qa()||Za({sentence:e,ascii:t,silence:!0})}function Ua(e){qa()&&Fs.groupCollapsed(e)}function Ja(){qa()&&Fs.groupEnd()}function Qa(e){if(!qa())return;const t=("undefined"!=typeof performance&&performance.now?performance.now():Date.now())-Ds;Is+=1,Fs.log(`[${(Is+"").padStart(2,"0")}] +${t.toFixed(1)}ms ${e}`)}function eo(e){if(qa())try{performance.mark(e)}catch(t){}}function to(e,t,a){if(!qa())return null;try{performance.measure(e,t,a);const o=performance.getEntriesByName(e),n=o&&o.length?o[o.length-1]:null;return n?n.duration:null}catch(o){return null}}function ao(e){if(qa())try{Fs.table(e)}catch(t){}}function oo(){const e=navigator.userAgent||"",t=/Android/.test(e),a=/iPhone|iPad|iPod/.test(e)||/Mac/.test(e)&&navigator.maxTouchPoints>1,o=t||a,n=window.matchMedia&&window.matchMedia("(display-mode: standalone)").matches||window.matchMedia&&window.matchMedia("(display-mode: minimal-ui)").matches||!0===navigator.standalone;return o||n}function no(){if(Es&&Os){const e=document.documentElement;return e.style.setProperty("--frame-color-light",Es),void e.style.setProperty("--frame-color-dark",Os)}const t=y(),a=document.documentElement,o=t?.frameColorLight||t?.frameColor||e("--frame-color-light","#0a0a0a"),n=t?.frameColorDark||t?.frameColor||e("--frame-color-dark","#0a0a0a");a.style.setProperty("--frame-color-light",o),a.style.setProperty("--frame-color-dark",n)}function io(t){(()=>{if(Es&&Os)return;const t=y();Es=t?.frameColorLight||t?.frameColor||e("--frame-color-light","#0a0a0a"),Os=t?.frameColorDark||t?.frameColor||e("--frame-color-dark","#0a0a0a")})(),(e=>{const t=document.documentElement;t.style.setProperty("--frame-color-light",e),t.style.setProperty("--frame-color-dark",e)})(e(t?"--wall-color-browser-dark":"--wall-color-browser-light",t?"#202124":"#f1f3f4"))}function ro(e){const t={};if(!e||"object"!=typeof e)return t;for(const a of js)({}).hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t}function lo(e,t,a,o){const n="number"==typeof e?e:+e;return Number.isFinite(n)?Math.min(a,Math.max(t,n)):o}function so(e,t,a,o){const n="number"==typeof e?e:+e;return Number.isFinite(n)?Math.min(a,Math.max(t,Math.round(n))):o}function co(e,t=0){return lo(e,0,1,t)}function uo(e,t,a){return t.includes(e)?e:a}function po(e,t){try{const a=getComputedStyle(document.documentElement).getPropertyValue(e).trim(),o=Number.parseFloat(a);return Number.isFinite(o)?o:t}catch{return t}}function ho(e){let t=e>>>0;return()=>{t+=1831565813;let e=t;return e=Math.imul(e^e>>>15,1|e),e^=e+Math.imul(e^e>>>7,61|e),((e^e>>>14)>>>0)/4294967296}}function fo(e){const t=(e()+e()+e())/3;return Math.max(0,Math.min(1,.5+1.15*(t-.5)))}function mo(e){const t=document.documentElement;t.style.setProperty("--abs-noise-enabled",e.noiseEnabled?"1":"0");const a=e.noiseMotion,o="drift"===a?"linear":"steps(1, end)";t.style.setProperty("--abs-noise-keyframes","static"===a?"none":"drift"===a?"abs-noise-drift":"abs-noise-jitter"),t.style.setProperty("--abs-noise-timing",o);const n=lo(e.noiseSpeedMs??1100,0,1e4,1100),i=lo(e.noiseSpeedVariance??0,0,1,0),r=ho((2134518556^e.noiseSeed)>>>0),l=i>0?(2*r()-1)*i:0;t.style.setProperty("--abs-noise-speed",Math.max(0,Math.round(n*(1+l)))+"ms"),t.style.setProperty("--abs-noise-speed-variance",i+""),t.style.setProperty("--abs-noise-motion-amount",e.noiseMotionAmount+""),t.style.setProperty("--abs-noise-flicker",e.noiseFlicker+""),t.style.setProperty("--abs-noise-flicker-speed",Math.max(0,Math.round(e.noiseFlickerSpeedMs))+"ms");const s=lo(e.noiseBlurPx,0,6,0);t.style.setProperty("--abs-noise-blur",s.toFixed(2)+"px"),t.style.setProperty("--abs-noise-filter",s>0?`blur(${s.toFixed(2)}px)`:"none");const c=lo(e.noiseMotionAmount,0,2.5,1),d="static"!==e.noiseMotion&&c>0,u=lo(e.noiseSize??85,20,600,85),p=lo(.55*u,24,120,82),h=d?p*c:0;t.style.setProperty("--abs-noise-overscan",`-${Math.ceil(h+(s>0?6*s:0)+32)}px`);const f=ho((2772082231^e.noiseSeed)>>>0);for(let M=1;40>=M;M++){const e=.9*(2*f()-1)*h,a=.9*(2*f()-1)*h;t.style.setProperty(`--abs-noise-j${M}-x`,Math.round(e)+"px"),t.style.setProperty(`--abs-noise-j${M}-y`,Math.round(a)+"px")}const m=f()*Math.PI*2;t.style.setProperty("--abs-noise-drift-x",Math.round(Math.cos(m)*h)+"px"),t.style.setProperty("--abs-noise-drift-y",Math.round(Math.sin(m)*h)+"px"),t.style.setProperty("--noise-size",Math.round(u)+"px");const g=lo(e.noiseOpacityLight??e.noiseOpacity??.08,0,1,.08),y=lo(e.noiseOpacityDark??e.noiseOpacity??.12,0,1,.12);t.style.setProperty("--noise-opacity-light",g+""),t.style.setProperty("--noise-opacity-dark",y+""),t.style.setProperty("--noise-blend-mode",e.noiseBlendMode??"overlay");const b=e.noiseColorDark??"#ffffff";t.style.setProperty("--noise-color-light",e.noiseColorLight??"#ffffff"),t.style.setProperty("--noise-color-dark",b),t.style.setProperty("--detail-noise-opacity",(e.detailNoiseOpacity??1)+"")}function go(e={}){const t=po("--noise-size",85),a=po("--noise-opacity-light",.08),o=po("--noise-opacity-dark",.12),n={noiseSeed:so(e.noiseSeed,0,999999,1337),noiseTextureSize:so(e.noiseTextureSize,64,512,256),noiseDistribution:uo(e.noiseDistribution,["uniform","gaussian"],"gaussian"),noiseMonochrome:void 0!==e.noiseMonochrome&&!!e.noiseMonochrome,noiseChroma:co(e.noiseChroma,.9),noiseEnabled:void 0===e.noiseEnabled||!!e.noiseEnabled,noiseMotion:uo(e.noiseMotion,["jitter","drift","static"],"jitter"),noiseMotionAmount:lo(e.noiseMotionAmount,0,2.5,1),noiseSpeedMs:so(e.noiseSpeedMs,0,1e4,1100),noiseSpeedVariance:lo(e.noiseSpeedVariance,0,1,0),noiseFlicker:lo(e.noiseFlicker,0,1,.12),noiseFlickerSpeedMs:so(e.noiseFlickerSpeedMs,0,5e3,220),noiseBlurPx:lo(e.noiseBlurPx,0,6,0),noiseContrast:lo(e.noiseContrast,.25,5,1.35),noiseBrightness:lo(e.noiseBrightness,.25,3,1),noiseSaturation:lo(e.noiseSaturation,0,3,1),noiseHue:lo(e.noiseHue,0,360,0),noiseSize:lo(e.noiseSize,20,600,t),noiseOpacity:lo(e.noiseOpacity,0,1,.08),noiseOpacityLight:lo(e.noiseOpacityLight,0,1,a),noiseOpacityDark:lo(e.noiseOpacityDark,0,1,o),noiseBlendModeLight:uo(e.noiseBlendModeLight,["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion"],"overlay"),noiseBlendModeDark:uo(e.noiseBlendModeDark,["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion"],"soft-light"),noiseColorLight:"string"==typeof e.noiseColorLight?e.noiseColorLight:"#ffffff",noiseColorDark:"string"==typeof e.noiseColorDark?e.noiseColorDark:"#ffffff",detailNoiseOpacity:lo(e.detailNoiseOpacity,0,1,1)};return n.noiseMonochrome&&(n.noiseChroma=co(n.noiseChroma,.9)),n}function yo(e,{force:t=!1}={}){const a=JSON.stringify({seed:e.noiseSeed,size:e.noiseTextureSize,distribution:e.noiseDistribution,monochrome:e.noiseMonochrome,chroma:e.noiseChroma,contrast:(+e.noiseContrast).toFixed(3),brightness:(+e.noiseBrightness).toFixed(3),saturation:(+e.noiseSaturation).toFixed(3),hue:(+e.noiseHue).toFixed(1)});if(e.noiseEnabled)t||a!==Hs?(Hs=a,_s&&window.clearTimeout(_s),_s=window.setTimeout(async()=>{_s=null;const t=++Ns,a=await(async({size:e,seed:t,distribution:a,monochrome:o,chroma:n,contrast:i,brightness:r,saturation:l,hue:s})=>{const c=(e=>(Rs||(Rs=document.createElement("canvas"),Ws=Rs.getContext("2d",{willReadFrequently:!0})),Ws?(Rs.width!==e&&(Rs.width=e),Rs.height!==e&&(Rs.height=e),Gs!==e&&(Gs=e,zs=null,$s=null),Ws):null))(e);if(!c)return null;zs||(zs=c.createImageData(e,e),$s=new Uint32Array(zs.data.buffer));const d=$s,u=ho(t),p="gaussian"===a,h=co(n,0),f=1-h,m=lo(i,.25,5,1),g=lo(r,.25,3,1),y=lo(l,0,3,1),b=lo(s,0,360,0),M=1!==m||1!==g,v=1!==y,x=0!==b,w=.213,S=.715,C=.072;let k=1,F=0,L=0,I=0,D=1,K=0,T=0,P=0,E=1;if(x){const e=b*Math.PI/180,t=Math.cos(e),a=Math.sin(e);k=w+.787*t-a*w,F=S-t*S-a*S,L=C-t*C+.928*a,I=w-t*w+.143*a,D=S+t*(1-S)+.14*a,K=C-t*C-.283*a,T=w-t*w-.787*a,P=S-t*S+a*S,E=C+.928*t+a*C}for(let B=0;d.length>B;B++){const e=p?fo(u):u();let t=e,a=e,n=e;if(o||(t=e*f+(p?fo(u):u())*h,a=e*f+(p?fo(u):u())*h,n=e*f+(p?fo(u):u())*h),M&&(t=(t-.5)*m+.5,a=(a-.5)*m+.5,n=(n-.5)*m+.5,t*=g,a*=g,n*=g),v){const e=t*w+a*S+n*C;t=e*(1-y)+t*y,a=e*(1-y)+a*y,n=e*(1-y)+n*y}if(x){const e=t*I+a*D+n*K,o=t*T+a*P+n*E;t=t*k+a*F+n*L,a=e,n=o}const i=Math.max(0,Math.min(255,Math.round(255*t))),r=Math.max(0,Math.min(255,Math.round(255*a)));d[B]=255<<24|Math.max(0,Math.min(255,Math.round(255*n)))<<16|r<<8|i}c.putImageData(zs,0,0);const O=await(async e=>await new Promise(t=>{try{e.toBlob(e=>t(e),"image/png")}catch(a){t(null)}}))(Rs);return O?URL.createObjectURL(O):null})({size:e.noiseTextureSize,seed:e.noiseSeed,distribution:e.noiseDistribution,monochrome:e.noiseMonochrome,chroma:e.noiseChroma,contrast:e.noiseContrast,brightness:e.noiseBrightness,saturation:e.noiseSaturation,hue:e.noiseHue});if(t===Ns){if(a)try{document.documentElement.style.setProperty("--abs-noise-texture",`url("${a}")`),Vs&&URL.revokeObjectURL(Vs),Vs=a,document.body?.classList.add("noise-ready")}catch(o){URL.revokeObjectURL(a)}}else a&&URL.revokeObjectURL(a)},140)):Vs&&e.noiseEnabled&&document.body?.classList.add("noise-ready");else{_s&&window.clearTimeout(_s),_s=null,Ns++,Hs="";try{document.documentElement.style.setProperty("--abs-noise-texture","none"),document.body?.classList.remove("noise-ready")}catch(o){}if(Vs)try{URL.revokeObjectURL(Vs)}catch(o){}Vs=null}}function bo(e={}){const t=As||go({});return go({...t,...ro(e)})}function Mo(e={}){As=bo(e),Bs=!0,mo(As),yo(As,{force:!0}),As.noiseEnabled&&Vs&&document.body?.classList.add("noise-ready")}function vo(e={}){Bs||Mo(e),As=bo(e),mo(As),yo(As)}async function xo(){return(async()=>{if(!qs){const e=await Promise.resolve().then(()=>ic);qs=e.updateWallElements}return qs})()}function wo(e){const{r:t,g:a,b:o}=(e=>{3===(e=e.replace(/^#/,"")).length&&(e=e[0]+e[0]+e[1]+e[1]+e[2]+e[2]);const t=parseInt(e,16);return{r:t>>16&255,g:t>>8&255,b:255&t}})(e);return`${t}, ${a}, ${o}`}function So(e){const t=document.getElementById("bravia-balls");if(!t)return;const a=document.body.classList.contains("dark-mode"),o=a?e.wallShadowEdgeTopOpacityDark??0:e.wallShadowEdgeTopOpacityLight??0,n=a?e.wallShadowEdgeLeftOpacityDark??0:e.wallShadowEdgeLeftOpacityLight??0,i=a?e.wallShadowEdgeBottomOpacityDark??0:e.wallShadowEdgeBottomOpacityLight??0,r=a?e.wallShadowEdgeRightOpacityDark??0:e.wallShadowEdgeRightOpacityLight??0,l=e.wallShadowAmbientBlur??20,s=a?e.wallShadowAmbientOpacityDark??.12:e.wallShadowAmbientOpacityLight??.04,c=a?e.wallShadowStrokeOpacityDark??0:e.wallShadowStrokeOpacityLight??0,d=[];if(o>0&&d.push(`inset 0 1px 0 rgba(0,0,0, ${o.toFixed(3)})`),n>0&&d.push(`inset 1px 0 0 rgba(0,0,0, ${n.toFixed(3)})`),i>0&&d.push(`inset 0 -1px 0 rgba(255,255,255, ${i.toFixed(3)})`),r>0&&d.push(`inset -1px 0 0 rgba(255,255,255, ${r.toFixed(3)})`),s>0&&d.push(`inset 2px 3px ${l}px rgba(0,0,0, ${s.toFixed(3)})`),e.wallInnerShadowEnabled??1){const t=a?e.wallInnerShadowOpacityDark??.25:e.wallInnerShadowOpacityLight??.08;if(t>0){const a=e.wallInnerShadowOffsetY??2,o=e.wallInnerShadowBlur2??8,n=e.wallInnerShadowBlur3??20,i=.6*t,r=.3*t;d.push(`inset 0 ${a}px ${e.wallInnerShadowBlur1??3}px rgba(0,0,0, ${(1*t).toFixed(3)})`),d.push(`inset 0 ${1.5*a}px ${o}px rgba(0,0,0, ${i.toFixed(3)})`),d.push(`inset 0 ${2*a}px ${n}px rgba(0,0,0, ${r.toFixed(3)})`)}}const u=document.documentElement,p=getComputedStyle(u).getPropertyValue("--inner-wall-outward-shadow-offset").trim()||"2px",h=getComputedStyle(u).getPropertyValue("--inner-wall-outward-shadow-blur").trim()||"8px",f=getComputedStyle(u).getPropertyValue("--inner-wall-outward-shadow-spread").trim()||"2px",m=getComputedStyle(u).getPropertyValue("--inner-wall-outward-shadow-opacity").trim()||"0.2";d.unshift(`0 ${p} ${h} ${f} rgba(0, 0, 0, ${m})`);const g=d.length>0?d.join(", "):"none";t.style.setProperty("--wall-shadow-override",g),t.style.setProperty("--wall-stroke-opacity",c.toFixed(3));let y=document.getElementById("wall-shadow-override-style");y||(y=document.createElement("style"),y.id="wall-shadow-override-style",y.textContent="\n      #bravia-balls::before {\n        box-shadow: var(--wall-shadow-override) !important;\n      }\n    ",document.head.appendChild(y))}function Co(e){return!1!==Ys[e]}function ko(e){return{id:e,label:"Warmup Frames",stateKey:e,type:"range",min:0,max:240,step:1,default:10,format:e=>Math.round(e)+"",parse:e=>parseInt(e,10),reinitMode:!0,hint:"Pre-runs physics before first render to avoid visible settling on mode start."}}function Fo(e,t){try{if("function"==typeof e?.format)return e.format(t)}catch(a){}return(t??"")+""}function Lo(){const e=[];for(const t of Object.values(Xs))for(const a of t.controls)e.push({...a,section:t.title});return e}function Io(e){if("divider"===e.type)return`<div class="control-divider"><span class="control-divider-label">${e.label||""}</span></div>`;if(!Co(e.id))return"";const t=e.id+"Slider",a=e.id+"Val",o=e.id+"Picker",n=e.hint?` title="${i=e.hint,((i??"")+"").replaceAll("&","&amp;").replaceAll('"',"&quot;").replaceAll("'","&#39;").replaceAll("<","&lt;").replaceAll(">","&gt;")}"`:"";var i;const r=e.isHero?"control-row control-row--hero":"control-row";if("colorDistribution"===e.type){const t=(Array.isArray(e.labels)?e.labels:[]).map((e,t)=>{const a=((e||"")+"").trim();return`\n        <div class="color-dist-row" data-color-dist-row="${t}">\n          <div class="color-dist-row-label">${a}</div>\n          <div class="color-dist-row-controls">\n            <span class="color-dist-swatch" id="${"colorDistSwatch"+t}" aria-hidden="true"></span>\n            <select id="${"colorDistColor"+t}" class="control-select color-dist-select" aria-label="${a} color"></select>\n            <input type="range" id="${"colorDistWeight"+t}" min="0" max="100" step="1" value="0" aria-label="${a} weight">\n            <span class="color-dist-weight" id="${"colorDistWeightVal"+t}">0%</span>\n          </div>\n        </div>`}).join("");return`\n      <div class="${r}" data-control-id="${e.id}">\n        <div class="control-row-header">\n          <span class="control-label">${e.label}</span>\n          <span class="control-value" id="colorDistTotalVal">100%</span>\n        </div>\n        <div class="color-dist-grid" id="colorDistGrid">\n          ${t}\n        </div>\n        <div class="color-dist-actions">\n          <button type="button" class="secondary" id="colorDistResetBtn" aria-label="Reset color distribution to defaults">Reset Defaults</button>\n        </div>\n      </div>\n      ${e.hint?`<p class="control-hint">${e.hint}</p>`:""}`}if("color"===e.type)return`\n      <label class="${r}" data-control-id="${e.id}">\n        <div class="control-row-header">\n          <span class="control-label"${n}>${e.label}</span>\n          <span class="control-value" id="${a}">${e.default}</span>\n        </div>\n        <input type="color" id="${o}" value="${e.default}" aria-label="${e.label}" />\n      </label>\n      ${e.hint?`<p class="control-hint">${e.hint}</p>`:""}`;if("select"===e.type){const o=(Array.isArray(e.options)?e.options:[]).map(t=>{const a=t.value+"";return`<option value="${a}" ${e.default+""===a?"selected":""}>${(t.label??t.value)+""}</option>`}).join(""),i=e.hint?`<p class="control-hint">${e.hint}</p>`:"";return`\n      <label class="${r}" data-control-id="${e.id}">\n        <div class="control-row-header">\n          <span class="control-label"${n}>${e.label}</span>\n          <span class="control-value" id="${a}">${Fo(e,e.default)}</span>\n        </div>\n        <select id="${t}" class="control-select" aria-label="${e.label}">\n          ${o}\n        </select>\n      </label>\n      ${i}`}if("checkbox"===e.type||"toggle"===e.type)return`\n      <label class="${r}" data-control-id="${e.id}">\n        <div class="control-row-header">\n          <span class="control-label"${n}>${e.label}</span>\n          <span class="control-value" id="${a}">${e.default?"On":"Off"}</span>\n        </div>\n        <input type="checkbox" id="${t}" ${e.default?"checked":""} aria-label="${e.label}">\n      </label>\n      ${e.hint?`<p class="control-hint">${e.hint}</p>`:""}`;const l=e.hint?`<p class="control-hint">${e.hint}</p>`:"";return`\n      <label class="${r}" data-control-id="${e.id}">\n        <div class="control-row-header">\n          <span class="control-label"${n}>${e.label}</span>\n          <span class="control-value" id="${a}">${Fo(e,e.default)}</span>\n        </div>\n        <input type="range" id="${t}" min="${e.min}" max="${e.max}" step="${e.step}" value="${e.default}">\n      </label>\n      ${l}`}function Do(e,t){const a=t.controls.filter(e=>Co(e.id));if(0===a.length)return"";let o=null,n="";for(const s of a)s.group&&s.group!==o?(null!==o&&(n+="</div>"),n+=`<div class="section-title" style="margin-top: 12px;">${s.group}</div><div class="group ${s.groupLayout||""}">`,o=s.group):s.group||null===o||(n+="</div>",o=null),n+=Io(s);null!==o&&(n+="</div>");const i=t.defaultOpen?"open":"",r=`\n    <summary class="panel-section-header">\n      ${t.icon?`<span class="section-icon">${t.icon}</span>`:""}\n      <span class="section-label">${t.title}</span>\n    </summary>`,l=`<div class="panel-section-content">${n}</div>`;return t.mode?`\n      <div id="${t.mode}Controls" class="mode-controls">\n        <details class="panel-section-accordion" ${i}>\n          ${r}\n          ${l}\n        </details>\n      </div>`:`\n    <details class="panel-section-accordion" ${i}>\n      ${r}\n      ${l}\n    </details>`}function Ko({open:e=!0}={}){return`\n    <details class="panel-section-accordion" ${e?"open":""}>\n      <summary class="panel-section-header">\n        <span class="section-icon"></span>\n        <span class="section-label">Theme</span>\n      </summary>\n      <div class="panel-section-content">\n        <div class="theme-segment-control" role="group" aria-label="Theme selector">\n          <button id="themeAuto" class="theme-segment-btn" aria-label="Auto theme">Auto</button>\n          <button id="themeLight" class="theme-segment-btn active" aria-label="Light theme">Light</button>\n          <button id="themeDark" class="theme-segment-btn" aria-label="Dark theme">Dark</button>\n        </div>\n        <div id="themeStatus" class="panel-status"> Light Mode</div>\n      </div>\n    </details>`}function To({open:e=!1}={}){return`\n    <details class="panel-section-accordion" ${e?"open":""}>\n      <summary class="panel-section-header">\n        <span class="section-icon"></span>\n        <span class="section-label">Palette</span>\n      </summary>\n      <div class="panel-section-content">\n        <label class="control-row">\n          <div class="control-row-header">\n            <span class="control-label">Color Template</span>\n            <span class="control-value"></span>\n          </div>\n          <select id="colorSelect"></select>\n        </label>\n        <label class="control-row">\n          <div class="control-row-header">\n            <span class="control-label">Rotate on Reload</span>\n            <span class="control-value"></span>\n          </div>\n          <input id="paletteRotateOnReload" type="checkbox" />\n        </label>\n      </div>\n    </details>`}function Po(e={}){const{prepend:t={},append:a={},replace:o={}}=e;let n="";for(const i of Zs){if(o[i.id]){n+=`\n      <details class="panel-master-group">\n        <summary class="panel-master-group-header">\n          ${i.icon?`<span class="panel-master-group-icon">${i.icon}</span>`:""}\n          <span class="panel-master-group-title">${i.title}</span>\n        </summary>\n        <div class="panel-master-group-content">\n          ${o[i.id]}\n        </div>\n      </details>`;continue}let e="";t[i.id]&&(e+=t[i.id]);for(const t of i.sections)Xs[t]&&(e+=Do(0,Xs[t]));a[i.id]&&(e+=a[i.id]),e&&(n+=`\n      <details class="panel-master-group">\n        <summary class="panel-master-group-header">\n          ${i.icon?`<span class="panel-master-group-icon">${i.icon}</span>`:""}\n          <span class="panel-master-group-title">${i.title}</span>\n        </summary>\n        <div class="panel-master-group-content">\n          ${e}\n        </div>\n      </details>`)}return n}function Eo(){const e={pit:"",bubbles:"",critters:"",flies:"",water:"",vortex:"",magnetic:"","dvd-logo":"",weightless:"","kaleidoscope-3":"",neural:"","parallax-linear":"","3d-sphere":"","3d-cube":"","starfield-3d":"","elastic-center":""},t={pit:"Pit",bubbles:"Bubbles",critters:"Hive",flies:"Flies",water:"Water",vortex:"Electrons",magnetic:"Magnet","dvd-logo":"DVD",weightless:"Zero-G","kaleidoscope-3":"Kalei",neural:"Neural","parallax-linear":"Parallax Lin","3d-sphere":"Sphere 3D","3d-cube":"Cube 3D","starfield-3d":"Starfield 3D","shooting-stars":"Shooting Stars","elastic-center":"Elastic Center"};let a="";return Wn.forEach((o,n)=>{const i=e[o]||"",r=t[o]||o,l=(n+1+"").padStart(2,"0");a+=`<button class="mode-button" data-mode="${o}" aria-label="${l}  ${zn[o]||r} mode"><span class="mode-button-number">${l}</span><span class="mode-button-label">${i} ${r}</span></button>`}),`\n    <details class="panel-section-accordion" id="modeSwitcherSection" open>\n      <summary class="panel-section-header">\n        <span class="section-icon"></span>\n        <span class="section-label">Mode</span>\n      </summary>\n      <div class="panel-section-content">\n        <div class="mode-switcher" role="group" aria-label="Simulation mode selector">\n          ${a}\n        </div>\n      </div>\n    </details>`}function Oo(){let e="";for(const[t,a]of Object.entries(Xs))a?.mode&&(e+=Do(0,a));return e}function Bo(){const e=y();for(const[a,o]of Object.entries(Xs))for(const n of o.controls){const i=document.getElementById(n.id+"Val");if("colorDistribution"===n.type){const l=Array.isArray(n.labels)?n.labels:[],s=document.getElementById("colorDistResetBtn");function c(e){return((e||"")+"").trim().toLowerCase()}function d(e,t,a,o=t){const n=+e;if(!Number.isFinite(n))return o;const i=Math.floor(n);return t>i?t:i>a?a:i}function u(e){const t=[];for(let a=0;8>a;a++)t.push({value:a+"",label:`Ball ${a+1}${e[a]?"  "+e[a]:""}`});return t}function p(t){const a=Array.isArray(e.colorDistribution)?e.colorDistribution:[],o=new Map;for(const e of a)o.set(c(e?.label),e);const n=new Map([["art & visual direction","frontend craft"]]),i=Array.isArray(t)?t:a,r=[],s=new Set;for(let e=0;l.length>e;e++){const t=((l[e]||"")+"").trim(),a=c(t),u=n.get(a),p=i.find(e=>c(e?.label)===a)||(u?i.find(e=>c(e?.label)===u):null)||o.get(a)||(u?o.get(u):null)||{};let h=d(p?.colorIndex,0,7,d(o.get(a)?.colorIndex,0,7,0));if(s.has(h))for(let e=0;8>e;e++)if(!s.has(e)){h=e;break}s.add(h);const f=d(p?.weight,0,100,d(o.get(a)?.weight,0,100,0));r.push({label:t,colorIndex:h,weight:f})}return r}function h(e,t=0){const a=e.map(e=>d(e,0,100,0));let o=0;for(let l=0;a.length>l;l++)o+=a[l];if(100===o)return a;if(0===o)return a[t]=100,a;const n=Array(a.length).fill(0);let i=0;for(let l=0;a.length>l;l++){const e=Math.round(a[l]/o*100);n[l]=e,i+=e}let r=100-i;for(;0!==r;)if(r>0){let e=0;for(let t=1;n.length>t;t++)n[t]>n[e]&&(e=t);n[e]+=1,r-=1}else{let e=-1;for(let t=0;n.length>t;t++)n[t]>0&&(-1===e||n[t]>n[e])&&(e=t);if(-1===e)break;n[e]-=1,r+=1}return n.map(e=>d(e,0,100,0))}function f(e,t,a){const o=e.map(e=>d(e?.weight,0,100,0));return o[t]=d(a,0,100,o[t]),100===o.reduce((e,t)=>e+t,0)?o:h(o,t)}function m(){const t={pit:null,flies:e.fliesBallCount,weightless:e.weightlessCount,water:e.waterBallCount,vortex:e.vortexBallCount,magnetic:e.magneticBallCount,bubbles:e.bubblesMaxCount,"kaleidoscope-3":e.kaleidoscope3BallCount,critters:e.critterCount,neural:e.neuralBallCount}[e.currentMode];return Number.isFinite(+t)?+t:null}function g(){import("./legend-colors.js").then(({applyExpertiseLegendColors:e})=>e?.()).catch(()=>{}),Promise.resolve().then(()=>oi).then(({pickRandomColor:t})=>{if("function"!=typeof t)return;const a=e.balls||[];for(let e=0;a.length>e;e++)a[e].color=t()}).catch(()=>{})}function b(){const t=p(e.colorDistribution),a=h(t.map(e=>e.weight),0);for(let e=0;t.length>e;e++)t[e].weight=a[e];e.colorDistribution=t;const o={};for(let e=0;t.length>e;e++)o[t[e].colorIndex]=t[e].label;const n=u(o),i=m();for(let e=0;l.length>e;e++){const a=t[e]||{colorIndex:0,weight:0},r=document.getElementById("colorDistSwatch"+e),l=document.getElementById("colorDistColor"+e),s=document.getElementById("colorDistWeight"+e),c=document.getElementById("colorDistWeightVal"+e);if(l){l.innerHTML="";for(const e of n){const t=document.createElement("option");t.value=e.value,t.textContent=e.label;const n=d(e.value,0,7,0);o[n]&&!(n===a.colorIndex)&&(t.disabled=!0),l.appendChild(t)}l.value=a.colorIndex+""}if(s&&(s.value=d(a.weight,0,100,0)+""),c){const e=d(a.weight,0,100,0),t=null!=i?Math.round(e/100*i):null;c.textContent=null!=t?`${e}% (${t})`:e+"%"}if(r){const e=d(a.colorIndex,0,7,0);r.style.backgroundColor=`var(--ball-${e+1})`}}const r=document.getElementById("colorDistTotalVal");if(r){let e=0;for(let a=0;t.length>a;a++)e+=t[a].weight;r.textContent=e+"%"}}try{b()}catch(t){}s&&s.addEventListener("click",()=>{const t=e?.config?.colorDistribution;e.colorDistribution=p(t);const a=h(e.colorDistribution.map(e=>e.weight),0);for(let o=0;e.colorDistribution.length>o;o++)e.colorDistribution[o].weight=a[o];b(),g()});for(let M=0;l.length>M;M++){const v=document.getElementById("colorDistColor"+M),x=document.getElementById("colorDistWeight"+M);v&&v.addEventListener("change",()=>{const t=d(v.value,0,7,0),a=p(e.colorDistribution);a[M].colorIndex=t,e.colorDistribution=a,b(),g()}),x&&x.addEventListener("input",()=>{const t=d(x.value,0,100,0),a=p(e.colorDistribution),o=f(a,M,t);for(let e=0;a.length>e;e++)a[e].weight=o[e];e.colorDistribution=a,b(),g()})}continue}if("color"===n.type){const w=document.getElementById(n.id+"Picker");if(!w)continue;w.addEventListener("input",()=>{const t=w.value;n.stateKey&&(e[n.stateKey]=t),n.onChange&&n.onChange(e,t),i&&(i.textContent=t)});continue}if("select"===n.type){const S=document.getElementById(n.id+"Slider");if(!S)continue;S.addEventListener("change",()=>{const t=n.parse?n.parse(S.value):S.value;if(n.stateKey&&(e[n.stateKey]=t),n.onChange&&n.onChange(e,t),i){const a=n.stateKey?e[n.stateKey]:t;i.textContent=n.format?n.format(a):a+""}});continue}if("checkbox"===n.type||"toggle"===n.type){const C=document.getElementById(n.id+"Slider");if(!C)continue;C.addEventListener("change",()=>{const t=!!C.checked;n.stateKey&&(e[n.stateKey]=t),n.onChange&&n.onChange(e,t),i&&(i.textContent=t?"On":"Off"),n.reinitMode&&e.currentMode===o.mode&&Promise.resolve().then(()=>dl).then(({resetCurrentMode:e})=>e?.()).catch(()=>{})});continue}const r=document.getElementById(n.id+"Slider");r&&r.addEventListener("input",()=>{const t="function"==typeof n?.parse?n.parse(r.value):Number.parseFloat(r.value);n.stateKey&&(e[n.stateKey]=t),n.onChange&&n.onChange(e,t),i&&(i.textContent=n.format(n.stateKey?e[n.stateKey]:t)),n.reinitMode&&e.currentMode===o.mode&&Promise.resolve().then(()=>dl).then(({resetCurrentMode:e})=>e?.()).catch(()=>{})})}}function Ao(){if(nc)return;const e=document.getElementById("bravia-balls");e?(Us=document.createElement("div"),Us.className="outer-wall",Us.setAttribute("aria-hidden","true"),e.insertBefore(Us,e.firstChild),oc=document.createElement("div"),oc.className="outer-wall__edge outer-wall__edge--top",oc.setAttribute("aria-hidden","true"),Us.appendChild(oc),ac=document.createElement("div"),ac.className="outer-wall__edge outer-wall__edge--bottom",ac.setAttribute("aria-hidden","true"),Us.appendChild(ac),Js=document.createElement("div"),Js.className="inner-wall",Js.setAttribute("aria-hidden","true"),e.insertBefore(Js,e.firstChild.nextSibling),tc=document.createElement("div"),tc.className="inner-wall__glow",tc.setAttribute("aria-hidden","true"),tc.style.position="absolute",tc.style.top="0",tc.style.left="0",tc.style.right="0",tc.style.pointerEvents="none",Js.appendChild(tc),Qs=document.createElement("div"),Qs.className="inner-wall__edge inner-wall__edge--top",Qs.setAttribute("aria-hidden","true"),Js.appendChild(Qs),ec=document.createElement("div"),ec.className="inner-wall__edge inner-wall__edge--bottom",ec.setAttribute("aria-hidden","true"),Js.appendChild(ec),nc=!0,Ro()):console.warn(" #bravia-balls not found, cannot create wall elements")}function Ro(){if(!Us||!Js)return;const e=y(),t=document.body.classList.contains("dark-mode"),a=document.documentElement,o=getComputedStyle(a).getPropertyValue("--wall-thickness").trim()||"9px",n=getComputedStyle(a).getPropertyValue("--wall-radius").trim()||"24px",i=parseFloat(o)||9,r=parseFloat(n)||24,l=parseFloat(getComputedStyle(a).getPropertyValue("--outer-wall-radius-adjust").trim())||2;Us.style.borderRadius=r+.5*i+l+"px",Js.style.inset=o,Js.style.borderRadius=n,((e,t)=>{const a=e.innerWallGradientRadius??70,o=e.outerWallGradientRadius??70;if(tc){const a=t?e.innerWallInnerGlowOpacityDark??.08:e.innerWallInnerGlowOpacityLight??0;if(a>.01){tc.style.display="block";const t=e.innerWallInnerGlowBlur??30,o=e.innerWallInnerGlowSpread??-5,n=e.innerWallInnerGlowOffsetY??0,i=Wo(e.innerWallInnerGlowColor??"#ffffff");tc.style.inset="0",tc.style.boxShadow=`inset 0 ${n}px ${t}px ${o}px rgba(${i.r}, ${i.g}, ${i.b}, ${a})`}else tc.style.display="none",tc.style.boxShadow="none"}if(Qs&&ec){const o=t?e.innerWallTopLightOpacityDark??.4:e.innerWallTopLightOpacityLight??.3,n=t?e.innerWallTopBevelOpacityDark??.25:e.innerWallTopBevelOpacityLight??.18,i=e.innerWallBottomShadowColor??"#000000",r=e.innerWallTopBevelWidth??2,l=Wo(e.innerWallTopLightColor??"#ffffff"),s=Wo(i);o>.01?(Qs.style.display="block",Qs.style.background=`radial-gradient(\n        ellipse ${a}% 200% at 50% 0%,\n        rgba(${l.r}, ${l.g}, ${l.b}, ${o}) 0%,\n        rgba(${l.r}, ${l.g}, ${l.b}, ${.8*o}) 20%,\n        rgba(${l.r}, ${l.g}, ${l.b}, ${.4*o}) 50%,\n        rgba(${l.r}, ${l.g}, ${l.b}, 0) 100%\n      )`,Qs.style.height=r+"px"):(Qs.style.display="none",Qs.style.background="none",Qs.style.height="0px"),n>.01?(ec.style.display="block",ec.style.background=`radial-gradient(\n        ellipse ${a}% 200% at 50% 100%,\n        rgba(${s.r}, ${s.g}, ${s.b}, ${n}) 0%,\n        rgba(${s.r}, ${s.g}, ${s.b}, ${.8*n}) 20%,\n        rgba(${s.r}, ${s.g}, ${s.b}, ${.4*n}) 50%,\n        rgba(${s.r}, ${s.g}, ${s.b}, 0) 100%\n      )`,ec.style.height=r+"px"):(ec.style.display="none",ec.style.background="none",ec.style.height="0px")}if(oc&&ac){const a=t?e.outerWallTopDarkOpacityDark??.5:e.outerWallTopDarkOpacityLight??.5,n=t?e.outerWallBottomLightOpacityDark??.5:e.outerWallBottomLightOpacityLight??.5,i=e.outerWallBottomLightColor??"#ffffff",r=e.outerWallEdgeWidth??2,l=Wo(e.outerWallTopDarkColor??"#000000"),s=Wo(i);a>.01?(oc.style.display="block",oc.style.background=`radial-gradient(\n        ellipse ${o}% 200% at 50% 0%,\n        rgba(${l.r}, ${l.g}, ${l.b}, ${a}) 0%,\n        rgba(${l.r}, ${l.g}, ${l.b}, ${.8*a}) 20%,\n        rgba(${l.r}, ${l.g}, ${l.b}, ${.4*a}) 50%,\n        rgba(${l.r}, ${l.g}, ${l.b}, 0) 100%\n      )`,oc.style.height=r+"px"):(oc.style.display="none",oc.style.background="none",oc.style.height="0px"),n>.01?(ac.style.display="block",ac.style.background=`radial-gradient(\n        ellipse ${o}% 200% at 50% 100%,\n        rgba(${s.r}, ${s.g}, ${s.b}, ${n}) 0%,\n        rgba(${s.r}, ${s.g}, ${s.b}, ${.8*n}) 20%,\n        rgba(${s.r}, ${s.g}, ${s.b}, ${.4*n}) 50%,\n        rgba(${s.r}, ${s.g}, ${s.b}, 0) 100%\n      )`,ac.style.height=r+"px"):(ac.style.display="none",ac.style.background="none",ac.style.height="0px")}})(e,t)}function Wo(e){3===(e=e.replace(/^#/,"")).length&&(e=e[0]+e[0]+e[1]+e[1]+e[2]+e[2]);const t=parseInt(e,16);return{r:t>>16&255,g:t>>8&255,b:255&t}}function zo(t){sc=t;let a=!1;a="auto"===t?"dark"===cc||(()=>{const e=y();if(!e.autoDarkModeEnabled)return!1;const t=Number.isFinite(e.autoDarkNightStartHour)?e.autoDarkNightStartHour:18,a=Number.isFinite(e.autoDarkNightEndHour)?e.autoDarkNightEndHour:6,o=(new Date).getHours();return t!==a&&(a>t?o>=t&&a>o:o>=t||a>o)})():"dark"===t,(t=>{const a=y();a.isDarkMode=t,document.documentElement.style.colorScheme=t?"dark":"light",t?(a.container?.classList.add("dark-mode"),document.body.classList.add("dark-mode"),document.documentElement.classList.add("dark-mode")):(a.container?.classList.remove("dark-mode"),document.body.classList.remove("dark-mode"),document.documentElement.classList.remove("dark-mode")),(e=>{const t=(y().chromeHarmonyMode||"auto")+"",a=(()=>{const e=navigator.userAgent||"",t=navigator.vendor||"";return{isFirefox:/Firefox\//.test(e),isSafari:/Safari\//.test(e)&&/Apple/.test(t)&&!/Chrome\//.test(e)&&!/Chromium\//.test(e),isChromium:/Chrome\//.test(e)||/Chromium\//.test(e)||/Edg\//.test(e),ua:e}})();if("site"===t)return no(),{mode:t,family:a,themeColorLikelyApplied:oo()};if("browser"===t)return io(e),{mode:t,family:a,themeColorLikelyApplied:oo()};const o=oo();a.isSafari?no():a.isChromium&&!o?io(e):no()})(t),(()=>{const t=y(),a=t?.frameColor||t?.frameColorLight||t?.frameColorDark||e("--wall-color","#242529");let o=document.querySelector('meta[name="theme-color"]:not([media])');o||(o=document.createElement("meta"),o.name="theme-color",document.head.appendChild(o)),o.content=a;let n=document.querySelector('meta[name="theme-color"][media="(prefers-color-scheme: light)"]');n||(n=document.createElement("meta"),n.name="theme-color",n.media="(prefers-color-scheme: light)",document.head.appendChild(n)),n.content=a;let i=document.querySelector('meta[name="theme-color"][media="(prefers-color-scheme: dark)"]');i||(i=document.createElement("meta"),i.name="theme-color",i.media="(prefers-color-scheme: dark)",document.head.appendChild(i)),i.content=a;let r=document.querySelector('meta[name="apple-mobile-web-app-status-bar-style"]');r||(r=document.createElement("meta"),r.name="apple-mobile-web-app-status-bar-style",document.head.appendChild(r)),r.content="black-translucent"})(),ja(),qi=null,Yi="",ee(a.currentTemplate),So(a),((e,t)=>{const a=document.documentElement;a.style.setProperty("--outer-wall-top-dark-opacity",(e?t.outerWallTopDarkOpacityDark??.4:t.outerWallTopDarkOpacityLight??.6)+""),a.style.setProperty("--outer-wall-bottom-light-opacity",(e?t.outerWallBottomLightOpacityDark??.3:t.outerWallBottomLightOpacityLight??.5)+""),a.style.setProperty("--outer-wall-cast-shadow-opacity",(e?t.outerWallCastShadowOpacityDark??.25:t.outerWallCastShadowOpacityLight??.15)+""),a.style.setProperty("--inner-wall-outward-shadow-opacity",(e?t.innerWallOutwardShadowOpacityDark??.35:t.innerWallOutwardShadowOpacityLight??.2)+""),a.style.setProperty("--inner-wall-inner-glow-opacity",(e?t.innerWallInnerGlowOpacityDark??.08:t.innerWallInnerGlowOpacityLight??0)+""),a.style.setProperty("--outer-wall-top-bevel-opacity",(e?t.outerWallTopBevelOpacityDark??.35:t.outerWallTopBevelOpacityLight??.25)+""),a.style.setProperty("--inner-wall-top-bevel-opacity",(e?t.innerWallTopBevelOpacityDark??.25:t.innerWallTopBevelOpacityLight??.18)+""),a.style.setProperty("--inner-wall-top-light-opacity",(e?t.innerWallTopLightOpacityDark??.4:t.innerWallTopLightOpacityLight??.3)+"")})(t,a),Ro(),(()=>{const e=document.getElementById("themeAuto"),t=document.getElementById("themeLight"),a=document.getElementById("themeDark");if(!e||!t||!a)return;[e,t,a].forEach(e=>e.classList.remove("active")),"auto"===sc?e.classList.add("active"):"light"===sc?t.classList.add("active"):a.classList.add("active");const o=document.getElementById("themeStatus");if(o){const e=y();o.textContent="auto"===sc?e.isDarkMode?" Auto (Dark)":" Auto (Light)":"light"===sc?" Light Mode":" Dark Mode"}})()})(a),(e=>{try{localStorage.setItem(rc,e),localStorage.removeItem(lc)}catch(t){}})(t),Qa(` Theme set to: ${t} (rendering: ${a?"dark":"light"})`)}function $o(){if(dc)return;dc=!0,(()=>{try{localStorage.removeItem(rc),localStorage.removeItem(lc),localStorage.removeItem("abs_palette_chapter"),Qa(" Cleared color-related localStorage cache")}catch(e){}})(),(()=>{const e=y(),t=document.documentElement;e?.bgLight&&t.style.setProperty("--bg-light",e.bgLight),e?.bgDark&&t.style.setProperty("--bg-dark",e.bgDark);const a=e?.frameColor||e?.frameColorLight||e?.frameColorDark||"#242529";t.style.setProperty("--frame-color",a),t.style.setProperty("--wall-color",a),t.style.setProperty("--chrome-bg",a),t.style.setProperty("--frame-color-light",a),t.style.setProperty("--frame-color-dark",a),t.style.setProperty("--wall-color-light",a),t.style.setProperty("--wall-color-dark",a),t.style.setProperty("--chrome-bg-light",a),t.style.setProperty("--chrome-bg-dark",a);const o=document.querySelector('meta[name="theme-color"]');o&&(o.content=a),e?.textColorLight&&t.style.setProperty("--text-color-light",e.textColorLight),e?.textColorLightMuted&&t.style.setProperty("--text-color-light-muted",e.textColorLightMuted),e?.textColorDark&&t.style.setProperty("--text-color-dark",e.textColorDark),e?.textColorDarkMuted&&t.style.setProperty("--text-color-dark-muted",e.textColorDarkMuted),Number.isFinite(e?.edgeLabelInsetAdjustPx)&&t.style.setProperty("--edge-label-inset-adjust",e.edgeLabelInsetAdjustPx+"px"),e?.linkHoverColor&&t.style.setProperty("--link-hover-color",e.linkHoverColor)})(),cc=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light",Qa(" System prefers: "+cc),zo((()=>{try{const e=localStorage.getItem(rc);if("auto"===e||"light"===e||"dark"===e)return e;const t=localStorage.getItem(lc);"auto"!==t&&"light"!==t&&"dark"!==t||(localStorage.removeItem(lc),localStorage.setItem(rc,"auto"))}catch(e){}return"auto"})());const e=document.getElementById("themeAuto"),t=document.getElementById("themeLight"),a=document.getElementById("themeDark");e&&e.addEventListener("click",()=>zo("auto")),t&&t.addEventListener("click",()=>zo("light")),a&&a.addEventListener("click",()=>zo("dark")),window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",e=>{cc=e.matches?"dark":"light",Qa(" System preference changed to: "+cc),"auto"===sc&&zo("auto")}),window.setInterval(()=>{"auto"===sc&&zo("auto")},6e4),Qa(" Modern dark mode initialized")}function Go(){zo("light"===sc?"dark":"light")}function Vo(){console.log(" localStorage is disabled")}function No(){return console.log(" localStorage is disabled - using defaults"),!1}function _o(){clearTimeout(window.settingsSaveTimeout),window.settingsSaveTimeout=setTimeout(Vo,500)}function Ho(e){return!!e&&"object"==typeof e&&!Array.isArray(e)}function jo(){try{const e="undefined"!=typeof window?window.__TEXT__:null;return Ho(e)?e:null}catch(e){return null}}async function qo(){if(pc)return pc;const e=jo();if(e)return pc=e,pc;const t=await(async()=>{const e=["config/contents-home.json","js/contents-home.json","../dist/js/contents-home.json"];for(const a of e)try{const e=await fetch(a,{cache:"no-cache"});if(!e.ok)continue;const t=await e.json();if(Ho(t))return t}catch(t){}throw Error("No contents-home.json found")})();pc=t;try{"undefined"!=typeof window&&(window.__TEXT__=t)}catch(a){}return pc}function Yo(e,t=""){const a=pc||jo();if(!a)return t;if(!e)return t;const o=(e+"").split(".").filter(Boolean);let n=a;for(const i of o){if(!Ho(n)&&!Array.isArray(n))return t;if(n=n?.[i],null==n)return t}return n}function Zo(){return"function"==typeof document.startViewTransition}function Xo(){document.querySelectorAll(".modal.active, [data-modal].active").forEach(e=>{e.classList.remove("active"),e.setAttribute("aria-hidden","true")});const e=document.getElementById("modal-overlay");e?.classList.contains("active")&&e.classList.remove("active");const t=document.getElementById("master-panel");t?.classList.contains("open")&&t.classList.remove("open"),document.documentElement.classList.remove("modal-active")}function Uo(e=mc.INTERNAL){try{sessionStorage.setItem(hc,e),sessionStorage.setItem(fc,Date.now()+"")}catch(t){}}function Jo(){try{const e=sessionStorage.getItem(hc),t=parseInt(sessionStorage.getItem(fc)||"0",10),a=5e3>Date.now()-t;if(sessionStorage.removeItem(hc),sessionStorage.removeItem(fc),sessionStorage.removeItem("abs_open_cv_modal"),sessionStorage.removeItem("abs_open_cv_gate"),sessionStorage.removeItem("abs_open_portfolio_modal"),sessionStorage.removeItem("abs_open_contact_modal"),sessionStorage.removeItem("abs_internal_nav"),e&&a)return e}catch(e){}return null}function Qo(){try{const e=performance.getEntriesByType("navigation");if(e.length>0)return"back_forward"===e[0].type}catch(e){}return!1}async function en(e,t=mc.INTERNAL){if(yc)return;yc=!0,Uo(t);const a=!!window.matchMedia?.("(prefers-reduced-motion: reduce)")?.matches;if(Zo())window.location.href=e;else{document.body.classList.add("page-transitioning");try{const{animateDeparture:e}=await Promise.resolve().then(()=>Ic);await e({duration:a?150:300})}catch(o){await new Promise(e=>setTimeout(e,a?150:300))}window.location.href=e}}function tn(){yc=!1,document.body.classList.remove("page-transitioning")}function an(e){if(document.querySelector(`link[rel="prefetch"][href="${e}"]`))return;const t=document.createElement("link");t.rel="prefetch",t.href=e,document.head.appendChild(t)}function on(e,t){e&&e.addEventListener("mouseenter",()=>an(t),{once:!0})}function nn(){const e=document.getElementById("cv-modal-trigger"),t=document.getElementById("brand-logo"),a=document.getElementById("cv-modal"),o=document.getElementById("portfolio-modal"),n=document.getElementById("contact-modal"),i=Array.from(document.querySelectorAll(".cv-digit")),r=document.getElementById("cv-modal-label");if(!e||!a||0===i.length)return void console.warn("CV Gate: Missing required elements");if("true"===a.dataset.modalInitialized)return;a.dataset.modalInitialized="true";const l=Yo("gates.common.backText","BACK"),s=Yo("gates.common.backAriaLabel","Back"),c=Yo("gates.cv.title","Bio/CV"),d=Yo("gates.cv.description","Because spam bots don't deserve nice things. This keeps my inbox a little more civilised. Need access? Get in touch for the code.");r&&(r.innerHTML=`\n            <div class="modal-nav">\n                <button type="button" class="gate-back abs-icon-btn" data-modal-back aria-label="${s}">\n                    <i class="ti ti-arrow-left" aria-hidden="true"></i>\n                    <span>${l}</span>\n                </button>\n            </div>\n            <h2 class="modal-title">${c}</h2>\n            <p class="modal-description">${d}</p>\n        `);let u=!1;const p=()=>a&&a.classList.contains("active")||o&&o.classList.contains("active")||n&&n.classList.contains("active"),h=e=>{e?.preventDefault?.();const r=p();o&&o.classList.contains("active")&&(o.classList.remove("active"),o.setAttribute("aria-hidden","true"),setTimeout(()=>{o.classList.add("hidden"),ua(o)},400)),n&&n.classList.contains("active")&&(n.classList.remove("active"),n.setAttribute("aria-hidden","true"),setTimeout(()=>{n.classList.add("hidden"),ua(n)},400)),u=!0,r||ya(),t&&t.classList.add("fade-out-up");const l=document.querySelector(".cv-scroll-container");l&&l.classList.add("fade-out-up"),requestAnimationFrame(()=>{da(a),a.classList.remove("hidden"),a.setAttribute("aria-hidden","false"),a.classList.add("active"),i[0].focus()})},f=(e=!1)=>{if(u=!1,i.forEach(e=>e.value=""),e){a.style.transition="none",t&&(t.style.transition="none"),a.classList.remove("active"),a.setAttribute("aria-hidden","true"),a.classList.add("hidden"),ua(a),t&&t.classList.remove("fade-out-up");const e=document.querySelector(".cv-scroll-container");e&&e.classList.remove("fade-out-up"),p()||ba(),requestAnimationFrame(()=>{a.style.removeProperty("transition"),t&&t.style.removeProperty("transition")})}else{a.classList.remove("active"),a.setAttribute("aria-hidden","true"),t&&t.classList.remove("fade-out-up");const e=document.querySelector(".cv-scroll-container");e&&e.classList.remove("fade-out-up"),p()||ba(),setTimeout(()=>{u||(a.classList.add("hidden"),ua(a))},1700)}};try{const e=r?.querySelector?.("[data-modal-back]");e&&e.addEventListener("click",()=>f(!1))}catch(g){}a.addEventListener("click",e=>{(e.target===a||e.target.classList.contains("modal-label")||e.target.classList.contains("modal-description")||"H2"===e.target.tagName||"P"===e.target.tagName)&&f(!1)});const m=()=>{const e=i.map(e=>e.value).join("");if(4===e.length)if("1111"===e){const e=document.querySelector(".cv-modal-inputs");e&&(e.classList.remove("pulse-energy"),e.classList.add("pulse-energy")),setTimeout(()=>{"function"==typeof a.animate?a.animate([{transform:"scale(1)",opacity:1,filter:"blur(0)"},{transform:"scale(1.03)",opacity:0,filter:"blur(4px)"}],{duration:250,easing:"cubic-bezier(0.16, 1, 0.3, 1)",fill:"forwards"}):(a.style.transition="transform 250ms ease-out, opacity 250ms ease-out, filter 250ms ease-out",a.style.transform="scale(1.03)",a.style.opacity="0",a.style.filter="blur(4px)")},200),setTimeout(()=>{en("cv.html",mc.INTERNAL)},450)}else setTimeout(()=>{i.forEach(e=>e.value=""),i[0].focus()},150)};e.addEventListener("click",h);try{sessionStorage.getItem("abs_open_cv_modal")&&(sessionStorage.removeItem("abs_open_cv_modal"),setTimeout(()=>h(),300))}catch(g){}document.addEventListener("keydown",e=>{"Escape"===e.key&&u&&f()}),document.addEventListener("modal-overlay-dismiss",e=>{u&&f(e.detail?.instant||!1)}),i.forEach((e,t)=>{e.addEventListener("keydown",a=>{"Backspace"===a.key&&""===e.value&&(t>0?i[t-1].focus():f())}),e.addEventListener("input",e=>{const a=e.target.value;if(/^\d*$/.test(a)){if(1===a.length)i.length-1>t?i[t+1].focus():m();else if(a.length>1){const o=a.split("");e.target.value=o[0];let n=t+1;for(let e=1;o.length>e&&i.length>n;e++)i[n].value=o[e],n++;i.length>n?i[n].focus():m()}}else e.target.value=a.replace(/\D/g,"")}),e.addEventListener("focus",()=>{e.select()})})}function rn(){const e=document.getElementById("portfolio-modal-trigger"),t=document.getElementById("portfolio-modal"),a=document.getElementById("brand-logo"),o=document.getElementById("cv-modal"),n=document.getElementById("contact-modal"),i=Array.from(document.querySelectorAll(".portfolio-digit")),r=document.getElementById("portfolio-modal-label");if(!e||!t||0===i.length)return void console.warn("Portfolio Gate: Missing required elements");if("true"===t.dataset.modalInitialized)return;t.dataset.modalInitialized="true";const l=Yo("gates.common.backText","BACK"),s=Yo("gates.common.backAriaLabel","Back"),c=Yo("gates.portfolio.title","View Portfolio"),d=Yo("gates.portfolio.description","Good work deserves good context. Many of my projects across finance, automotive, and digital innovation startups are NDA-protected, so access is code-gated.");r&&(r.innerHTML=`\n            <div class="modal-nav">\n                <button type="button" class="gate-back abs-icon-btn" data-modal-back aria-label="${s}">\n                    <i class="ti ti-arrow-left" aria-hidden="true"></i>\n                    <span>${l}</span>\n                </button>\n            </div>\n            <h2 class="modal-title">${c}</h2>\n            <p class="modal-description">${d}</p>\n        `);let u=!1;const p=()=>t&&t.classList.contains("active")||o&&o.classList.contains("active")||n&&n.classList.contains("active"),h=e=>{e&&e.preventDefault();const r=p(),l=(()=>{try{const e=window.PORTFOLIO_BASE||"";return e&&!e.endsWith("/")?e+"/":e}catch(e){return""}})(),s=qa()?"modules/portfolio/app.js":"js/portfolio-bundle.js",c=document.createElement("link");c.rel="prefetch",c.href=`${l}${s}`,document.head.appendChild(c);const d=document.createElement("link");d.rel="prefetch",d.href=l+"images/portfolio/pages/chapter-1-1.webp",document.head.appendChild(d),o&&o.classList.contains("active")&&(o.classList.remove("active"),o.setAttribute("aria-hidden","true"),setTimeout(()=>{o.classList.add("hidden"),ua(o)},400)),n&&n.classList.contains("active")&&(n.classList.remove("active"),n.setAttribute("aria-hidden","true"),setTimeout(()=>{n.classList.add("hidden"),ua(n)},400)),u=!0,r||ya(),a&&a.classList.add("fade-out-up");const h=document.querySelector(".cv-scroll-container");h&&h.classList.add("fade-out-up"),requestAnimationFrame(()=>{da(t),t.classList.remove("hidden"),t.setAttribute("aria-hidden","false"),t.classList.add("active"),i[0].focus()})},f=(e=!1)=>{if(u=!1,i.forEach(e=>e.value=""),e){t.style.transition="none",a&&(a.style.transition="none"),t.classList.remove("active"),t.setAttribute("aria-hidden","true"),t.classList.add("hidden"),ua(t),a&&a.classList.remove("fade-out-up");const e=document.querySelector(".cv-scroll-container");e&&e.classList.remove("fade-out-up"),p()||ba(),requestAnimationFrame(()=>{t.style.removeProperty("transition"),a&&a.style.removeProperty("transition")})}else{t.classList.remove("active"),t.setAttribute("aria-hidden","true"),a&&a.classList.remove("fade-out-up");const e=document.querySelector(".cv-scroll-container");e&&e.classList.remove("fade-out-up"),p()||ba(),setTimeout(()=>{u||(t.classList.add("hidden"),ua(t))},1700)}};try{const e=r?.querySelector?.("[data-modal-back]");e&&e.addEventListener("click",()=>f(!1))}catch(g){}t.addEventListener("click",e=>{(e.target===t||e.target.classList.contains("modal-label")||e.target.classList.contains("modal-description")||"H2"===e.target.tagName||"P"===e.target.tagName)&&f(!1)});const m=()=>{const e=i.map(e=>e.value).join("");if(4===e.length)if("1234"===e){const e=document.querySelector(".portfolio-modal-inputs");e&&(e.classList.remove("pulse-energy"),e.classList.add("pulse-energy")),sessionStorage.setItem("abs_portfolio_ok",Date.now()),setTimeout(()=>{"function"==typeof t.animate?t.animate([{transform:"scale(1)",opacity:1,filter:"blur(0)"},{transform:"scale(1.03)",opacity:0,filter:"blur(4px)"}],{duration:250,easing:"cubic-bezier(0.16, 1, 0.3, 1)",fill:"forwards"}):(t.style.transition="transform 250ms ease-out, opacity 250ms ease-out, filter 250ms ease-out",t.style.transform="scale(1.03)",t.style.opacity="0",t.style.filter="blur(4px)")},200),setTimeout(()=>{en("portfolio.html",mc.INTERNAL)},450)}else setTimeout(()=>{i.forEach(e=>e.value=""),i[0].focus()},150)};sessionStorage.getItem("abs_open_portfolio_modal")&&(sessionStorage.removeItem("abs_open_portfolio_modal"),setTimeout(()=>h(),300)),e.addEventListener("click",h),document.addEventListener("keydown",e=>{"Escape"===e.key&&u&&f()}),document.addEventListener("modal-overlay-dismiss",e=>{u&&f(e.detail?.instant||!1)}),i.forEach((e,t)=>{e.addEventListener("keydown",a=>{"Backspace"===a.key&&""===e.value&&(t>0?i[t-1].focus():f())}),e.addEventListener("input",e=>{const a=e.target.value;if(/^\d*$/.test(a)){if(1===a.length)i.length-1>t?i[t+1].focus():m();else if(a.length>1){const o=a.split("");e.target.value=o[0];let n=t+1;for(let e=1;o.length>e&&i.length>n;e++)i[n].value=o[e],n++;i.length>n?i[n].focus():m()}}else e.target.value=a.replace(/\D/g,"")}),e.addEventListener("focus",()=>{e.select()})})}function ln(){const e=Yo("contact.email","alexander@beck.fyi"),t=Yo("gates.common.backText","BACK"),a=Yo("gates.common.backAriaLabel","Back"),o=Yo("gates.contact.title","Contact"),n=Yo("gates.contact.description","For collaborations, product design work, AI prototyping, or anything that needs a crisp creative + technical brain. For job opportunities, drop me a note."),i=Yo("contact.copy.buttonAriaLabel","Copy email address"),r=Yo("contact.copy.statusCopied","Copied"),l=Yo("contact.copy.statusError","Copy failed"),s=[document.getElementById("contact-email"),document.getElementById("contact-email-inline"),document.querySelector(".decorative-script")].filter(Boolean),c=document.getElementById("brand-logo"),d=document.getElementById("contact-modal"),u=document.getElementById("contact-modal-label"),p=document.getElementById("contact-modal-inputs"),h=document.getElementById("cv-modal"),f=document.getElementById("portfolio-modal");if(!(s.length&&d&&u&&p))return void console.warn("Contact Gate: Missing required elements");if("true"===d.dataset.modalInitialized)return;d.dataset.modalInitialized="true",u.innerHTML=`\n    <div class="modal-nav">\n      <button type="button" class="gate-back abs-icon-btn" data-modal-back aria-label="${a}">\n        <i class="ti ti-arrow-left" aria-hidden="true"></i>\n        <span>${t}</span>\n      </button>\n    </div>\n    <h2 class="modal-title">${o}</h2>\n    <p class="modal-description">\n      ${n}\n    </p>\n  `,p.innerHTML=`\n    <button type="button" class="contact-email-row" data-copy-email aria-label="${i}">\n      <span class="contact-email-text">${e}</span>\n      <span class="contact-email-copy" data-copy-icon-container>\n        <i class="ti ti-copy" aria-hidden="true"></i>\n      </span>\n    </button>\n    <div class="contact-copy-status" data-copy-status aria-live="polite"></div>\n  `;const m=u.querySelector("[data-modal-back]"),g=p.querySelector("[data-copy-email]");p.querySelector("[data-copy-icon-container]");const y=p.querySelector("[data-copy-status]"),b=p.querySelector(".contact-email-copy i");let M=!1,v=null;const x=()=>d&&d.classList.contains("active")||h&&h.classList.contains("active")||f&&f.classList.contains("active"),w=e=>{if(g&&y){if(v&&window.clearTimeout(v),"copied"===e)return g.classList.add("is-copied"),g.classList.remove("is-error"),y.textContent=r,b&&(b.className="ti ti-check",b.parentElement.classList.add("is-active")),void(v=window.setTimeout(()=>w("idle"),3e3));if("error"===e)return g.classList.add("is-error"),g.classList.remove("is-copied"),y.textContent=l,b&&(b.className="ti ti-alert-triangle",b.parentElement.classList.add("is-active")),void(v=window.setTimeout(()=>w("idle"),3e3));g.classList.remove("is-copied","is-error"),y.textContent="",b&&(b.className="ti ti-copy",b.parentElement.classList.remove("is-active"))}},S=e=>{e?.preventDefault?.();const t=x();h&&h.classList.contains("active")&&(h.classList.remove("active"),h.setAttribute("aria-hidden","true"),setTimeout(()=>{h.classList.add("hidden"),ua(h)},Mc)),f&&f.classList.contains("active")&&(f.classList.remove("active"),f.setAttribute("aria-hidden","true"),setTimeout(()=>{f.classList.add("hidden"),ua(f)},Mc)),M=!0,t||ya(),w("idle"),c&&c.classList.add("fade-out-up");const a=document.querySelector(".cv-scroll-container");a&&a.classList.add("fade-out-up"),requestAnimationFrame(()=>{da(d),d.classList.remove("hidden"),d.setAttribute("aria-hidden","false"),d.classList.add("active"),g?.focus?.()})},C=(e=!1)=>{if(M=!1,w("idle"),e){d.style.transition="none",c&&(c.style.transition="none"),d.classList.remove("active"),d.setAttribute("aria-hidden","true"),d.classList.add("hidden"),ua(d),c&&c.classList.remove("fade-out-up");const e=document.querySelector(".cv-scroll-container");e&&e.classList.remove("fade-out-up"),x()||ba(),requestAnimationFrame(()=>{d.style.removeProperty("transition"),c&&c.style.removeProperty("transition")})}else{d.classList.remove("active"),d.setAttribute("aria-hidden","true"),c&&c.classList.remove("fade-out-up");const e=document.querySelector(".cv-scroll-container");e&&e.classList.remove("fade-out-up"),x()||ba(),setTimeout(()=>{M||(d.classList.add("hidden"),ua(d))},Mc)}};s.forEach(e=>e.addEventListener("click",S,{capture:!0})),m?.addEventListener("click",()=>C(!1)),d.addEventListener("click",e=>{(e.target===d||e.target.classList.contains("modal-label")||e.target.classList.contains("modal-description")||"H2"===e.target.tagName||"P"===e.target.tagName)&&C(!1)}),g?.addEventListener("click",async()=>{const t=await(async e=>{try{if(navigator?.clipboard?.writeText)return await navigator.clipboard.writeText(e),!0}catch(t){}try{const t=document.createElement("textarea");t.value=e,t.setAttribute("readonly","true"),t.style.position="fixed",t.style.left="-9999px",t.style.top="0",document.body.appendChild(t),t.select();const a=!0===document.execCommand?.("copy");return document.body.removeChild(t),a}catch(t){return!1}})(e);t&&(g.classList.remove("pulse-energy"),g.classList.add("pulse-energy"),setTimeout(()=>{g.classList.remove("pulse-energy")},800)),w(t?"copied":"error")}),document.addEventListener("keydown",e=>{"Escape"===e.key&&M&&C()}),document.addEventListener("modal-overlay-dismiss",e=>{M&&C(e.detail?.instant||!1)});try{sessionStorage.getItem("abs_open_contact_modal")&&(sessionStorage.removeItem("abs_open_contact_modal"),requestAnimationFrame(()=>S()))}catch(k){}}function sn(){if(re(),"undefined"!=typeof window&&window.matchMedia&&window.matchMedia("(prefers-reduced-motion: reduce)").matches)return console.log(" Sound toggle hidden (prefers-reduced-motion)"),null;xc=document.createElement("button"),xc.className="sound-toggle abs-icon-btn",xc.id="sound-toggle",xc.type="button",xc.setAttribute("aria-label","Toggle collision sounds"),xc.setAttribute("aria-pressed","false"),xc.setAttribute("data-enabled","false"),xc.innerHTML=vc,xc.addEventListener("click",cn);const e=document.getElementById("app-frame"),t=document.getElementById("sound-toggle-slot"),a=document.getElementById("top-elements-soundRow"),o=document.getElementById("social-links"),n=document.querySelector(".ui-meta-right"),i=!!t,r=o&&(!e||e.contains(o)),l="undefined"!=typeof window&&"function"==typeof window.matchMedia&&window.matchMedia("(max-width: 600px)").matches,s=e=>{if(!e)return!1;try{xc.parentElement&&xc.parentElement!==e&&xc.parentElement.removeChild(xc)}catch(t){}if(e.classList.contains("ui-meta-right")){const t=e.querySelector("time");if(t)return e.insertBefore(xc,t),!0}return e.appendChild(xc),!0};if(l&&a)xc.classList.add("sound-toggle--top"),xc.classList.add("sound-toggle--topwide"),s(a);else if(i)xc.classList.add("sound-toggle--top"),s(t);else if(n)s(n);else if(r){const e=document.createElement("li");e.className="margin-bottom_none sound-toggle-item",xc.classList.add("sound-toggle--social"),e.appendChild(xc),o.appendChild(e)}else e?e.appendChild(xc):document.body.appendChild(xc);try{if("undefined"!=typeof window&&"function"==typeof window.matchMedia){const e=window.matchMedia("(max-width: 600px)"),t=()=>{const t=document.getElementById("top-elements-soundRow"),a=document.getElementById("sound-toggle-slot"),o=e.matches&&!!t;xc.classList.toggle("sound-toggle--topwide",o),o?s(t):a&&s(a)};"function"==typeof e.addEventListener?e.addEventListener("change",t):"function"==typeof e.addListener&&e.addListener(t)}}catch(c){}console.log(" Sound toggle created");try{const e=Ce();dn(!(!e.isUnlocked||!e.isEnabled))}catch(c){}return"undefined"!=typeof window&&window.addEventListener&&window.addEventListener(vi,e=>{const t=e&&e.detail?e.detail:null;t&&dn(!(!t.isUnlocked||!t.isEnabled))}),xc}async function cn(){Ce().isUnlocked?dn(Se()):await se()?dn(!0):(xc&&(xc.innerHTML=vc,xc.setAttribute("aria-label","Audio unavailable")),setTimeout(()=>{dn(!1)},2e3))}function dn(e){xc&&(xc.setAttribute("data-enabled",e?"true":"false"),xc.setAttribute("aria-pressed",e?"true":"false"),xc.setAttribute("aria-label",e?"Sound on":"Sound off"),xc.innerHTML=e?'<i class="ti ti-volume-2" aria-hidden="true"></i>':vc)}function un(){const e=document.getElementById("social-links");if(!e)return;if(e.querySelector("i.ti"))return;const t=Array.from(e.querySelectorAll(".footer_icon-link[aria-label]"));for(const a of t){const e=(a.getAttribute("aria-label")||"").trim().toLowerCase(),t=wc.get(e);if(!t)continue;const o=a.querySelector("svg");o?(a.insertAdjacentHTML("afterbegin",t),o.remove()):a.insertAdjacentHTML("afterbegin",t)}}function pn(){function e(){t.textContent=o.format(new Date).toUpperCase()}const t=document.getElementById("time-display"),a=document.getElementById("site-year");if(!t)return;const o=new Intl.DateTimeFormat("en-GB",{timeZone:"Europe/London",hour:"numeric",minute:"2-digit",second:"2-digit",hour12:!0});e(),setInterval(e,1e3),a&&a.addEventListener("click",Go)}function hn(e){if(!e||!e.closest)return null;const t=e.closest('a, button, [role="button"]');if(!t)return null;try{if(t.classList?.contains?.("slide"))return null;if(t.closest?.(".slide"))return null}catch(a){}return t}function fn(e){const t=hn(e.target);var a;if(t&&!((a=t)&&a.closest&&(a.closest("#panelDock")||a.closest("#masterPanel")||a.closest("#dockToggle")||a.closest(".panel-dock")||a.closest(".panel"))))try{document.body.classList.add(Cc),be()}catch(e){}}function mn(e){const t=hn(e.target);if(!t)return;const a=e.relatedTarget;if(!a||!t.contains(a))try{document.body.classList.remove(Cc)}catch(e){}}function gn(){if(!Sc){Sc=!0;try{document.body.classList.remove(Cc)}catch(e){}document.addEventListener("pointerover",fn,!0),document.addEventListener("pointerout",mn,!0),window.PointerEvent||(document.addEventListener("mouseover",fn,!0),document.addEventListener("mouseout",mn,!0)),window.addEventListener("blur",()=>{try{document.body.classList.remove(Cc)}catch(e){}},{passive:!0}),window.addEventListener("mouseout",t=>{if(!t.relatedTarget&&!t.toElement)try{document.body.classList.remove(Cc)}catch(e){}},{passive:!0})}}function yn(e,t,a){if(e&&null!=a)try{e.setAttribute(t,a+"")}catch(o){}}function bn(){try{(()=>{const e=Yo("meta.title","");e&&(document.title=e);const t=Yo("meta.description","");if(t){const e=document.querySelector('meta[name="description"]');e&&e.setAttribute("content",t)}})(),((e,t)=>{e&&(e.textContent=(t??"")+"")})(document.getElementById("edge-caption-tagline"),Yo("edge.tagline",Yo("edge.copyright",""))),(()=>{const e=document.getElementById("expertise-legend");yn(e,"aria-label",Yo("legend.ariaLabel",""));const t=Yo("legend.items",null);if(!Array.isArray(t)||!e)return;const a=e.querySelectorAll(".legend__item");for(let o=0;a.length>o&&t.length>o;o++){const e=a[o],n=t?.[o]?.label,i=t?.[o]?.tooltip,r=t?.[o]?.colorClass,l=e.querySelector("span");if(n&&l&&(l.textContent=n),i&&e.setAttribute("data-tooltip",i),r){const t=e.querySelector(".circle");if(t){const e=[];for(const a of((t.className||"")+"").split(/\s+/).filter(Boolean))a.startsWith("bg-ball-")||e.push(a);e.push(r),t.className=e.join(" ")}}}})(),(()=>{const e=document.querySelector(".decorative-script p");if(!e)return;const t=Yo("philosophy.textBeforeLink",""),a=Yo("philosophy.link.id","contact-email-inline")||"contact-email-inline",o=Yo("philosophy.link.href","#")||"#",n=Yo("philosophy.link.text","")||"";let i=document.getElementById(a);if(i||(i=e.querySelector("a")),!i)return;i.id=a,i.setAttribute("href",o),i.textContent=n;const r=i.previousSibling;r&&r.nodeType===Node.TEXT_NODE?r.nodeValue=t:e.insertBefore(document.createTextNode(t),i);const l=i.nextSibling;l&&l.nodeType===Node.TEXT_NODE&&(l.nodeValue="")})(),(()=>{yn(document.getElementById("main-links"),"aria-label",Yo("footer.navAriaLabel",""));const e=Yo("footer.links",null);if(e&&"object"==typeof e)for(const t of["contact","portfolio","cv"]){const a=e?.[t];if(!a)continue;const o=document.getElementById(a.id||"");o&&(a.href&&o.setAttribute("href",a.href),a.text&&(o.textContent=a.text))}})(),(()=>{const e=document.getElementById("social-links");yn(e,"aria-label",Yo("socials.ariaLabel",""));const t=Yo("socials.items",null);if(!e||!t||"object"!=typeof t)return;const a=["appleMusic","x","linkedin"],o=e.querySelectorAll(".footer_icon-link");for(let n=0;o.length>n&&3>n;n++){const e=o[n],i=t?.[a[n]];if(!i)continue;i.url&&("A"===e.tagName?e.setAttribute("href",i.url):e.onclick=()=>window.open(i.url,"_blank","noopener,noreferrer")),i.ariaLabel&&e.setAttribute("aria-label",i.ariaLabel);const r=e.querySelector(".screen-reader");r&&i.screenReaderText&&(r.textContent=i.screenReaderText)}})(),(()=>{const e=document.getElementById("header-cv-link");if(!e)return;const t=Yo("footer.links.cv",null);t&&"object"==typeof t&&(t.href&&e.setAttribute("href",t.href),t.text&&(e.textContent=t.text))})(),(()=>{const e=document.querySelector("[data-portfolio-ui] .decorative-script p");if(!e)return;const t=Yo("portfolio.blurb","");t&&(e.textContent=t)})()}catch(e){}}async function Mn(){try{try{if("undefined"!=typeof window&&window.__RUNTIME_CONFIG__&&"object"==typeof window.__RUNTIME_CONFIG__)return window.__RUNTIME_CONFIG__}catch(e){}const t=["config/default-config.json","../config/default-config.json","js/config.json","../js/config.json","../dist/js/config.json"];for(const a of t)try{const e=await fetch(a,{cache:"no-cache"});if(e.ok)return await e.json()}catch(e){}throw Error("No config found")}catch(e){return console.warn("Config load failed, using defaults"),{gravityMultiplier:1.05,ballMass:91,maxBalls:300}}}async function vn({timeoutMs:e=4e3,fontFaces:t=kc}={}){const a=document.documentElement;if(a&&a.classList.add("fonts-loading"),!document.fonts||!document.fonts.ready)return a&&a.classList.remove("fonts-loading"),!1;let o;const n=new Promise(t=>{o=window.setTimeout(()=>t(!1),e)}),i=Promise.all(t.map(e=>document.fonts.load(e).catch(()=>null))).then(()=>document.fonts.ready).then(()=>!0).catch(()=>!1),r=await Promise.race([i,n]);return o&&window.clearTimeout(o),a&&a.classList.remove("fonts-loading"),r}function xn(e){const t=document.documentElement;void 0!==e.topLogoWidthVw&&t.style.setProperty("--top-logo-width-vw",e.topLogoWidthVw+""),e.bgLight&&(t.style.setProperty("--bg-light",e.bgLight),t.style.setProperty("--chrome-bg-light",e.bgLight)),e.bgDark&&(t.style.setProperty("--bg-dark",e.bgDark),t.style.setProperty("--chrome-bg-dark",e.bgDark));const a=e.frameColorLight||e.frameColor,o=e.frameColorDark||e.frameColor;a&&t.style.setProperty("--frame-color-light",a),o&&t.style.setProperty("--frame-color-dark",o)}function wn(e){e&&(m(e),xn(e),Sn())}function Sn(){try{w()}catch(e){}try{h()}catch(e){}try{f()}catch(e){}}function Cn(e={}){const{contactModal:t=!1,cvModal:a=!1,portfolioModal:o=!1,cursorHiding:n=!0,modalOverlayConfig:i={}}=e;if(t||a||o)try{fa(i)}catch(r){console.warn("Failed to initialize modal overlay:",r)}if(t)try{ln()}catch(r){console.warn("Failed to initialize contact modal:",r)}if(a)try{nn()}catch(r){console.warn("Failed to initialize CV modal:",r)}if(o)try{rn()}catch(r){console.warn("Failed to initialize portfolio modal:",r)}if(n)try{gn()}catch(r){console.warn("Failed to initialize cursor hiding:",r)}}function kn(){const e=window.innerWidth/window.innerHeight;return e>1.1?"landscape":.9>e?"portrait":"square"}function Fn(){const e=kn();let t;document.documentElement.classList.remove("aspect-landscape","aspect-square","aspect-portrait"),document.documentElement.classList.add("aspect-"+e),window.addEventListener("resize",()=>{clearTimeout(t),t=setTimeout(()=>{const t=kn();t!==e&&(document.documentElement.classList.remove("aspect-landscape","aspect-square","aspect-portrait"),document.documentElement.classList.add("aspect-"+t))},150)})}function Ln(){const e=(()=>{const e=y();switch(kn()){case"landscape":return e.entrancePerspectiveLandscape||1200;case"portrait":return e.entrancePerspectivePortrait||800;default:return e.entrancePerspectiveSquare||1e3}})();document.documentElement.style.setProperty("--entrance-perspective",e+"px")}function In(){document.documentElement.classList.add("entrance-pre-transition")}function Dn(e={}){const t=y(),a=document.documentElement,o=t.entranceWallTransitionDelay||300,n=t.entranceWallTransitionDuration||800,i=e.wallContent||[],r=document.getElementById("bravia-balls");if(!r)return console.warn(" #bravia-balls not found, falling back to simple transition"),void setTimeout(()=>{a.classList.remove("entrance-pre-transition"),a.classList.add("entrance-transitioning"),setTimeout(()=>{a.classList.remove("entrance-transitioning"),a.classList.add("entrance-complete")},n)},o);const l=document.body.classList.contains("portfolio-page")?t.wallRadius&&"number"==typeof t.wallRadius&&t.wallRadius>0?t.wallRadius+"px":"42px":"0px",s=t.entranceWallInitialScale||1.1,c=t.entranceWallEasing||"cubic-bezier(0.16, 1, 0.3, 1)",d=r.style.transition,u=[];for(const p of i){const e="string"==typeof p?document.querySelector(p):p;e&&u.push(e)}setTimeout(()=>{if(a.classList.remove("entrance-pre-transition"),a.classList.add("entrance-transitioning"),r.style.transition="none",r.style.transform=`scale(${s})`,r.style.transformOrigin="center center",r.style.borderRadius="0px",r.style.opacity="1",r.style.visibility="visible",u.forEach(e=>{e.style.transition="none",e.style.opacity="0",e.style.visibility="visible",e.style.willChange="opacity"}),"function"==typeof r.animate){const e=r.animate([{transform:`scale(${s})`},{transform:"scale(1)"}],{duration:n,easing:c,fill:"forwards"}),t=r.animate([{borderRadius:"0px"},{borderRadius:l}],{duration:n,easing:c,fill:"forwards"}),o=.2*n,i=.8*n,p=u.map(e=>e.animate([{opacity:0},{opacity:1}],{duration:i,delay:o,easing:c,fill:"forwards"}));let h=!1,f=!1,m=0===u.length;const g=()=>{h&&f&&m&&(r.style.transform="scale(1)",r.style.borderRadius=l,r.style.opacity="1",u.forEach(e=>{e.style.opacity="1",e.style.willChange="auto"}),setTimeout(()=>{r.style.transition=d||"",a.classList.remove("entrance-transitioning"),a.classList.add("entrance-complete")},50))};if(e.addEventListener("finish",()=>{h=!0,g()}),e.addEventListener("cancel",()=>{h=!0,g()}),t.addEventListener("finish",()=>{f=!0,g()}),t.addEventListener("cancel",()=>{f=!0,g()}),p.length>0){let e=0;p.forEach(t=>{const a=()=>{e++,p.length>e||(m=!0,g())};t.addEventListener("finish",a),t.addEventListener("cancel",a)})}}else{requestAnimationFrame(()=>{r.style.transition=`transform ${n}ms ${c}, border-radius ${n}ms ${c}`,requestAnimationFrame(()=>{r.style.transform="scale(1)",r.style.borderRadius=l})});const e=.8*n;setTimeout(()=>{u.forEach(t=>{t.style.transition=`opacity ${e}ms ${c}`,requestAnimationFrame(()=>{t.style.opacity="1"})})},.2*n),setTimeout(()=>{r.style.transition=d||"",u.forEach(e=>{e.style.opacity="1",e.style.willChange="auto",e.style.removeProperty("transition")}),a.classList.remove("entrance-transitioning"),a.classList.add("entrance-complete")},n+50)}},o)}function Kn(e,t={}){return new Promise(a=>{if(!e)return void a();const o=y(),n=2*(t.duration??o.entranceLateElementDuration??600),i=t.easing??"cubic-bezier(0.16, 1, 0.3, 1)",r=t.scaleFrom??o.entranceLateElementScaleFrom??.92,l=t.scaleTo??1;setTimeout(()=>{e.style.transition="none",e.style.visibility="visible",e.style.willChange="opacity, transform",e.style.transform=`scale(${r})`,e.style.transformOrigin="center center",e.style.opacity="0",e.animate([{opacity:0,transform:`scale(${r})`},{opacity:1,transform:`scale(${l})`}],{duration:n,easing:i,fill:"forwards"}).finished.then(()=>{e.style.opacity="1",e.style.transform=`scale(${l})`,e.style.willChange="auto",requestAnimationFrame(()=>{requestAnimationFrame(()=>{e.style.removeProperty("transition"),e.style.removeProperty("transform"),e.style.removeProperty("transformOrigin"),document.documentElement.classList.add("entrance-complete")})})}).catch(()=>{}),a()},t.delay??0)})}function Tn(){const e=document.documentElement,t=document.getElementById("brand-logo"),a=document.getElementById("main-links");t&&(t.style.removeProperty("opacity"),t.style.visibility="visible"),a&&(a.style.removeProperty("opacity"),a.style.visibility="visible"),e.classList.add("ui-entered");const o=document.getElementById("fade-blocking");o&&o.remove()}function Pn(){let e="";for(const[t,a]of Object.entries(Lc)){e+='<div class="sound-dock__section">',e+=`<div class="sound-dock__section-title">${a.title}</div>`,e+='<div class="sound-dock__group">';for(const t of a.controls)e+=`\n        <label class="sound-dock__row">\n          <span class="sound-dock__label">${t.label}</span>\n          <input type="range" \n            id="sound_${t.id}" \n            class="sound-dock__slider" \n            min="${t.min}" \n            max="${t.max}" \n            step="${t.step}">\n          <span class="sound-dock__val" id="sound_${t.id}_val">${t.format(t.fromConfig(0))}</span>\n        </label>`;e+="</div></div>"}return e}function En(e,t,a){for(const o of Object.values(Lc))for(const t of o.controls){const o=e.querySelector("#sound_"+t.id),n=e.querySelector(`#sound_${t.id}_val`);if(!o)continue;const i=e=>{const i=(r=e,l=parseFloat(o.min),s=parseFloat(o.max),l>r?l:r>s?s:r);var r,l,s;o.value=i+"";const c=t.toConfig(i);n&&(n.textContent=t.format(i)),a({[t.id]:c})};o.addEventListener("input",()=>{i(parseFloat(o.value))}),o.addEventListener("wheel",e=>{if(e.ctrlKey)return;const t=(parseFloat(o.step)||1)*(e.altKey?.1:e.shiftKey?.2:1),a=0>e.deltaY?1:-1,n=parseFloat(o.value);e.preventDefault(),i(n+a*t)},{passive:!1}),n&&n.addEventListener("wheel",e=>{if(e.ctrlKey)return;const t=(parseFloat(o.step)||1)*(e.altKey?.1:e.shiftKey?.2:1),a=0>e.deltaY?1:-1,n=parseFloat(o.value);e.preventDefault(),i(n+a*t)},{passive:!1})}}function On(e,t){const a=t();for(const o of Object.values(Lc))for(const t of o.controls){const o=e.querySelector("#sound_"+t.id),n=e.querySelector(`#sound_${t.id}_val`);if(!o||void 0===a[t.id])continue;const i=t.fromConfig(a[t.id]);o.value=i,n&&(n.textContent=t.format(i))}}const Bn={PIT:"pit",FLIES:"flies",WEIGHTLESS:"weightless",WATER:"water",VORTEX:"vortex",DVD_LOGO:"dvd-logo",MAGNETIC:"magnetic",BUBBLES:"bubbles",KALEIDOSCOPE:"kaleidoscope-3",CRITTERS:"critters",NEURAL:"neural",PARALLAX_LINEAR:"parallax-linear",PARALLAX_FLOAT:"parallax-float",SPHERE_3D:"3d-sphere",CUBE_3D:"3d-cube",STARFIELD_3D:"starfield-3d",ELASTIC_CENTER:"elastic-center",PARTICLE_FOUNTAIN:"particle-fountain",SHOOTING_STARS:"shooting-stars"},An=[Bn.PIT,Bn.FLIES,Bn.CUBE_3D,Bn.WATER,Bn.SPHERE_3D,Bn.PARALLAX_LINEAR,Bn.ELASTIC_CENTER,Bn.KALEIDOSCOPE],Rn=[Bn.BUBBLES,Bn.MAGNETIC,Bn.DVD_LOGO,Bn.NEURAL,Bn.WEIGHTLESS,Bn.CRITTERS,Bn.VORTEX,Bn.STARFIELD_3D,Bn.SHOOTING_STARS,Bn.PARALLAX_FLOAT,Bn.PARTICLE_FOUNTAIN],Wn=[...An,...Rn],zn={[Bn.PIT]:"SOURCE MATERIAL",[Bn.FLIES]:"IDEA SPARK",[Bn.BUBBLES]:"NOISE SIGNAL",[Bn.MAGNETIC]:"DESIGN FORCES",[Bn.WATER]:"USER FLOW",[Bn.DVD_LOGO]:"DVD SCREENSAVER",[Bn.NEURAL]:"CONNECTION MAP",[Bn.VORTEX]:"ATOMIC STRUCTURE",[Bn.WEIGHTLESS]:"OPEN SPACE",[Bn.PARALLAX_LINEAR]:"PERSPECTIVE SHIFT",[Bn.CRITTERS]:"BEHAVIOR MODEL",[Bn.ELASTIC_CENTER]:"ELASTIC CENTER",[Bn.SPHERE_3D]:"3D SHELL",[Bn.CUBE_3D]:"3D FRAME",[Bn.KALEIDOSCOPE]:"VOCAB BLOOM",[Bn.STARFIELD_3D]:"DEPTH FIELD",[Bn.SHOOTING_STARS]:"COSMIC WISH",[Bn.PARALLAX_FLOAT]:"ORGANIC DRIFT",[Bn.PARTICLE_FOUNTAIN]:"PARTICLE FLOW"},$n={[Bn.PIT]:{quote:"The details are not the details. They make the design.",author:"Charles Eames"},[Bn.FLIES]:{quote:"No man ever steps in the same river twice.",author:"Heraclitus"},[Bn.CUBE_3D]:{quote:"Less, but better.",author:"Dieter Rams"},[Bn.BUBBLES]:{quote:"In the middle of difficulty lies opportunity.",author:"Albert Einstein"},[Bn.MAGNETIC]:{quote:"Order is never observed; it is disorder that attracts attention.",author:"Henri Bergson"},[Bn.WATER]:{quote:"Be like water making its way through cracks.",author:"Bruce Lee"},[Bn.DVD_LOGO]:{quote:"Do not fear mistakes. There are none.",author:"Miles Davis"},[Bn.NEURAL]:{quote:"The best design is invisible.",author:"Tobias van Schneider"},[Bn.SPHERE_3D]:{quote:"Nature uses only the longest threads to weave her patterns.",author:"Richard Feynman"},[Bn.WEIGHTLESS]:{quote:"An empty space is never empty.",author:"John Cage"},[Bn.PARALLAX_LINEAR]:{quote:"We don't see things as they are, we see them as we are.",author:"Anas Nin"},[Bn.CRITTERS]:{quote:"The whole is other than the sum of the parts.",author:"Kurt Koffka"},[Bn.ELASTIC_CENTER]:{quote:"Having guts always works out for me.",author:"Stefan Sagmeister"},[Bn.VORTEX]:{quote:"In all chaos there is a cosmos, in all disorder a secret order.",author:"Carl Jung"},[Bn.KALEIDOSCOPE]:{quote:"Creativity takes courage.",author:"Henri Matisse"},[Bn.STARFIELD_3D]:{quote:"The cosmos is within us. We are made of star-stuff.",author:"Carl Sagan"},[Bn.SHOOTING_STARS]:{quote:"When you realize you want to spend the rest of your life with somebody, you want the rest of your life to start as soon as possible.",author:"Nora Ephron"},[Bn.PARALLAX_FLOAT]:{quote:"Nature does not hurry, yet everything is accomplished.",author:"Lao Tzu"},[Bn.PARTICLE_FOUNTAIN]:{quote:"You can't use up creativity. The more you use, the more you have.",author:"Maya Angelou"}},Gn={DPR:Math.max(1,Math.min(2,window.devicePixelRatio||1)),OFFSCREEN_MOUSE:-1e9,MIN_DISTANCE_EPSILON:1e-6,ACCUMULATOR_RESET_THRESHOLD:3,MAX_PHYSICS_STEPS:4,SPIN_DAMP_PER_S:3,SPIN_GAIN:.25,SPIN_GAIN_TANGENT:.18,ROLL_FRICTION_PER_S:2.5,SQUASH_MAX_BASE:.2,SQUASH_DECAY_PER_S:18,GROUND_COUPLING_PER_S:12,SLEEP_VELOCITY_THRESHOLD:12,SLEEP_ANGULAR_THRESHOLD:.18,TIME_TO_SLEEP:.25,PHYSICS_DT:1/120,PHYSICS_DT_MOBILE:1/60},Vn={default:{label:"Default (Full View Grid)",parallaxLinearDotSizeMul:1.8,sizeVariationParallaxLinear:0,parallaxLinearGridX:14,parallaxLinearGridY:10,parallaxLinearGridZ:7,parallaxLinearSpanX:1.35,parallaxLinearSpanY:1.35,parallaxLinearZNear:50,parallaxLinearZFar:900,parallaxLinearFocalLength:420,parallaxLinearParallaxStrength:260},dense:{label:"Dense (More Vertices)",parallaxLinearDotSizeMul:1.6,sizeVariationParallaxLinear:.1,parallaxLinearGridX:18,parallaxLinearGridY:13,parallaxLinearGridZ:9,parallaxLinearSpanX:1.25,parallaxLinearSpanY:1.25,parallaxLinearZNear:45,parallaxLinearZFar:1e3,parallaxLinearFocalLength:420,parallaxLinearParallaxStrength:240},deep:{label:"Deep Field (Stronger Depth)",parallaxLinearDotSizeMul:1.7,sizeVariationParallaxLinear:.08,parallaxLinearGridX:14,parallaxLinearGridY:10,parallaxLinearGridZ:10,parallaxLinearSpanX:2.2,parallaxLinearSpanY:2.2,parallaxLinearZNear:30,parallaxLinearZFar:1500,parallaxLinearFocalLength:520,parallaxLinearParallaxStrength:320},calm:{label:"Calm (Slow Camera)",parallaxLinearDotSizeMul:1.8,sizeVariationParallaxLinear:.05,parallaxLinearGridX:12,parallaxLinearGridY:9,parallaxLinearGridZ:6,parallaxLinearSpanX:2,parallaxLinearSpanY:2,parallaxLinearZNear:60,parallaxLinearZFar:900,parallaxLinearFocalLength:420,parallaxLinearParallaxStrength:160},minimal:{label:"Minimal (Big Dots)",parallaxLinearDotSizeMul:2.4,sizeVariationParallaxLinear:.15,parallaxLinearGridX:10,parallaxLinearGridY:7,parallaxLinearGridZ:4,parallaxLinearSpanX:2.6,parallaxLinearSpanY:2.6,parallaxLinearZNear:70,parallaxLinearZFar:800,parallaxLinearFocalLength:380,parallaxLinearParallaxStrength:220}};let Nn=Math.max(1,Math.min(2,window.devicePixelRatio||1));const _n={config:{},currentMode:Bn.PIT,warmupFramesRemaining:0,balls:[],canvas:null,ctx:null,container:null,mouseX:Gn.OFFSCREEN_MOUSE,mouseY:Gn.OFFSCREEN_MOUSE,mouseInCanvas:!1,lastPointerMoveMs:0,lastPointerMoveX:Gn.OFFSCREEN_MOUSE,lastPointerMoveY:Gn.OFFSCREEN_MOUSE,GE:1960,G:0,gravityScale:1,gravityMultiplier:0,gravityMultiplierPit:1.1,REST:.31,FRICTION:.011,ballMassKg:240,MASS_BASELINE_KG:240,MASS_REST_EXP:.15,MASS_GRAVITY_EXP:.35,get DPR(){return Nn},sizeScale:1.2,sizeVariationGlobalMul:1,sizeVariationCap:.12,sizeVariationPit:0,sizeVariationFlies:0,sizeVariationWeightless:0,sizeVariationWater:0,sizeVariationVortex:.2,sizeVariationMagnetic:0,sizeVariationBubbles:.2,sizeVariationKaleidoscope:0,sizeVariationCritters:.2,sizeVariationNeural:.05,sizeVariationParallaxLinear:0,sizeVariationParallaxFloat:0,pitWarmupFrames:10,fliesWarmupFrames:10,weightlessWarmupFrames:10,waterWarmupFrames:10,vortexWarmupFrames:10,magneticWarmupFrames:10,bubblesWarmupFrames:10,kaleidoscope3WarmupFrames:10,crittersWarmupFrames:10,neuralWarmupFrames:10,parallaxLinearWarmupFrames:10,parallaxFloatWarmupFrames:10,sphere3dRadiusVw:18,sphere3dDensity:140,sphere3dFocalLength:600,sphere3dDotSizeMul:1.5,sphere3dIdleSpeed:.15,sphere3dCursorInfluence:1.2,sphere3dTumbleSpeed:2.5,sphere3dTumbleDamping:.94,sphere3dWarmupFrames:10,cube3dSizeVw:50,cube3dEdgeDensity:8,cube3dFaceGrid:0,cube3dIdleSpeed:.2,cube3dCursorInfluence:1.5,cube3dTumbleSpeed:3,cube3dTumbleDamping:.95,cube3dFocalLength:500,cube3dDotSizeMul:1.5,cube3dFogStart:.5,cube3dFogMin:.1,cube3dWarmupFrames:10,starfieldCount:200,starfieldSpanX:1.5,starfieldSpanY:1.2,starfieldZNear:100,starfieldZFar:2e3,starfieldFocalLength:500,starfieldParallaxStrength:320,starfieldSpeed:400,starfieldDotSizeMul:1,starfieldIdleJitter:0,starfieldFadeDuration:.5,starfield3dWarmupFrames:10,sizeVariation:0,ballSizeMin:22,ballSizeMax:30,ballSizeBreakpointMin:320,ballSizeBreakpointMax:1920,ballSizeCurve:2.5,isMobile:!1,isMobileViewport:!1,mobileObjectReductionFactor:.5,mobileObjectReductionThreshold:200,liteModeEnabled:!1,liteModeObjectReductionFactor:.6,R_MED:18,R_MIN:18,R_MAX:18,cursorSize:1,cursorColorMode:"auto",cursorColorIndex:5,cursorColorHex:"#ff4013",cursorColorLumaMax:.62,cursorColorAllowIndices:[],cursorColorDenyIndices:[],mouseTrailEnabled:!0,mouseTrailLength:18,mouseTrailSize:1.3,mouseTrailFadeMs:220,mouseTrailOpacity:.35,cursorExplosionEnabled:!0,cursorExplosionParticleCount:6,cursorExplosionSpeed:180,cursorExplosionSpreadDeg:360,cursorExplosionLifetime:.5,cursorExplosionFadeStartRatio:.4,cursorExplosionDrag:.88,cursorExplosionShrinkEnabled:!0,cursorExplosionImpactMinFactor:.5,cursorExplosionImpactMaxFactor:4,cursorExplosionImpactSensitivity:400,cursorExplosionLifetimeImpactMin:.7,cursorExplosionLifetimeImpactMax:1.8,cursorExplosionLifetimeImpactSensitivity:600,ballSoftness:20,ballSpacing:.08,sleepVelocityThreshold:12,sleepAngularThreshold:.18,timeToSleep:.25,physicsCollisionIterations:10,physicsSkipSleepingCollisions:!0,physicsSleepThreshold:12,physicsSleepTime:.25,physicsSkipSleepingSteps:!0,physicsSpatialGridOptimization:!0,wallPhysicsSamples:48,wallPhysicsSkipInactive:!0,wallPhysicsUpdateHz:30,wallPhysicsMaxSubstepHz:60,wallPhysicsInterpolation:!0,wallPhysicsAdaptiveSamples:!0,wallPhysicsMinSamples:24,wallVisualDeformMul:1,wallRenderDecimation:2,critterCount:90,critterSpeed:680,critterMaxSpeed:1400,critterStepHz:5,critterStepSharpness:2.4,critterTurnNoise:2.2,critterTurnDamp:10,critterTurnSeek:10,critterAvoidRadius:90,critterAvoidForce:9500,critterEdgeAvoid:1,critterMousePull:1,critterMouseRadiusVw:30,critterRestitution:.18,critterFriction:.018,critterHiveStirInterval:5,critterHiveStirStrength:2.5,critterHiveWaveSpeed:.4,critterNervousnessMin:.4,critterNervousnessMax:1,critterCuriosityBias:.5,hiveJourneyPointCount:4,hiveJourneyPointMargin:.05,hiveGoalAttractionStrength:.25,hiveGoalSwitchMinS:4,hiveGoalSwitchMaxS:14,hiveGoalReachedRadius:50,hivePathAdherence:.5,cornerRadius:42,layoutViewportWidthPx:0,containerBorderVw:0,simulationPaddingVw:0,contentPaddingRatio:.03,contentPaddingHorizontalRatio:1,contentPaddingBottomRatio:1.3,mobileWallThicknessXFactor:1.4,desktopWallThicknessFactor:1,mobileEdgeLabelsVisible:!0,wallRadiusVw:0,wallThicknessVw:0,wallThicknessAreaMultiplier:1,wallThicknessMinPx:6,wallThicknessMaxPx:25,noiseEnabled:!0,noiseSeed:1337,noiseTextureSize:256,noiseDistribution:"gaussian",noiseMonochrome:!1,noiseChroma:.9,noiseMotion:"jitter",noiseMotionAmount:1.2,noiseSpeedMs:1100,noiseSpeedVariance:.3,noiseFlicker:.08,noiseFlickerSpeedMs:180,noiseBlurPx:0,noiseContrast:1.2,noiseBrightness:1.15,noiseSaturation:1,noiseHue:0,noiseSize:85,noiseOpacity:.2,noiseOpacityLight:.2,noiseOpacityDark:.18,noiseBlendMode:"overlay",noiseColorLight:"#ffffff",noiseColorDark:"#ffffff",detailNoiseOpacity:1,layoutMinWallRadiusPx:28,wallInset:3,vortexSwirlStrength:450,vortexBallCount:90,vortexSpeedMultiplier:2.6,vortexRadius:100,vortexRotationDirection:1,vortexDepthVariation:.95,vortexSpiralTightness:.15,magneticBallCount:180,magneticStrength:65e3,magneticMaxVelocity:2800,magneticRadius:0,magneticExplosionInterval:5,bubblesSpawnRate:16,bubblesRiseSpeed:650,bubblesWobble:65,bubblesMaxCount:200,bubblesDeflectRadius:0,currentColors:["#b5b7b6","#bbbdbd","#ffffff","#00695c","#000000","#ff4013","#0d5cb6","#ffa000"],currentTemplate:"industrialTeal",paletteRotateOnReload:!1,colorDistribution:[{label:"Product Systems",colorIndex:0,weight:30},{label:"Interaction Design",colorIndex:4,weight:18},{label:"Creative Tech",colorIndex:3,weight:15},{label:"AI Design",colorIndex:2,weight:12},{label:"Design Direction",colorIndex:5,weight:10},{label:"Art Direction",colorIndex:6,weight:10},{label:"Prototyping",colorIndex:7,weight:5}],fliesBallCount:60,attractionPower:5e3,orbitRadius:180,swarmSpeed:.4,fliesSeparation:15e3,weightlessCount:66,weightlessInitialSpeed:250,weightlessBounce:.7,weightlessRepelRadius:220,weightlessRepelPower:5e4,dvdLogoSpeed:200,dvdLogoSize:.7,dvdLogoBallCount:60,dvdLogoBallSpacing:1.5,dvdLogoLetterSpacing:1.5,dvdLogoMassMultiplier:2,dvdLogoWarmupFrames:10,elasticCenterRingCount:10,elasticCenterMassMultiplier:2,elasticCenterSpacingMultiplier:2.8,elasticCenterElasticStrength:2e3,elasticCenterMouseRepelStrength:12e3,elasticCenterMouseRadius:200,elasticCenterDamping:.94,elasticCenterWarmupFrames:10,particleFountainEmissionRate:29,particleFountainInitialVelocity:4700,particleFountainSpreadAngle:20,particleFountainWaterDrag:.02,particleFountainGravityMultiplier:1.7,particleFountainUpwardForce:300,particleFountainMaxParticles:230,particleFountainLifetime:8,particleFountainWarmupFrames:120,particleFountainMouseRepelStrength:5e4,particleFountainMouseRepelRadiusVw:5,particleFountainMouseRepelRadius:0,weightlessRepelSoft:5.4,kaleidoscopeMirror:1,kaleidoscopeIdleDrift:.012,kaleidoscope3BallCount:150,kaleidoscope3Wedges:10,kaleidoscope3WedgesMobile:6,kaleidoscope3Speed:1.2,kaleidoscope3DotSizeVh:1.05,kaleidoscope3DotAreaMul:.75,kaleidoscope3SpawnAreaMul:1.05,kaleidoscope3SizeVariance:.5,kaleidoscope3WarmupFrames:65,neuralBallCount:311,neuralLinkDistanceVw:5,neuralLineOpacity:.06,neuralConnectorDensity:3,neuralWanderStrength:1e3,neuralMouseStrength:15e4,neuralSeparationRadius:100,neuralSeparationStrength:11e3,neuralMaxLinksPerBall:6,neuralDamping:.9,parallaxLinearDotCount:95,parallaxLinearRowPattern:"thirds",parallaxLinearSpacingPattern:"even",parallaxLinearFarPct:.42,parallaxLinearMidPct:.32,parallaxLinearFarSpeed:.15,parallaxLinearMidSpeed:.5,parallaxLinearNearSpeed:1,parallaxLinearFollowStrength:16,parallaxLinearDamping:12,parallaxLinearGridX:14,parallaxLinearGridY:10,parallaxLinearGridZ:7,parallaxLinearSpanX:5,parallaxLinearSpanY:2.6,parallaxLinearZNear:50,parallaxLinearZFar:900,parallaxLinearFocalLength:420,parallaxLinearParallaxStrength:260,parallaxLinearDotSizeMul:1.8,waterBallCount:300,waterDrag:.015,waterRippleSpeed:300,waterRippleStrength:18e3,waterDriftStrength:40,waterInitialVelocity:200,vortexDrag:.005,magneticDamping:.998,repelRadius:120,repelPower:274e3,repelSoft:3.4,repellerEnabled:!1,cursorInfluenceRadiusVw:14,cursorInfluenceRadiusPx:140,emitterTimer:0,autoDarkModeEnabled:!0,isDarkMode:!1,chromeHarmonyMode:"site",autoDarkNightStartHour:18,autoDarkNightEndHour:6,clickCycleEnabled:!0,sceneImpactEnabled:!0,sceneImpactMul:.005,sceneImpactMobileMulFactor:1,sceneImpactLogoCompMul:1.8,sceneImpactOvershoot:.22,sceneImpactAnticipation:0,sceneImpactPressMs:0,sceneImpactReleaseMs:620,sceneChangeSoundEnabled:!0,sceneChangeSoundIntensity:.35,sceneChangeSoundRadius:18,brandLogoImpactMul:.014,brandLogoSquashMul:1,brandLogoOvershoot:.22,brandLogoAnticipation:0,brandLogoTiltDeg:0,brandLogoSkewDeg:0,brandLogoPressMs:75,brandLogoHoldMs:55,brandLogoReleaseMs:220,containerBorder:20,containerBorderX:20,simulationPadding:0,contentPadding:40,contentPaddingX:40,contentPaddingY:40,bgLight:"#f5f5f5",bgDark:"#0a0a0a",frameColor:"#242529",frameColorLight:"#242529",frameColorDark:"#242529",textColorLight:"#161616",textColorLightMuted:"#2f2f2f",textColorDark:"#7a8fa3",textColorDarkMuted:"#9db0c4",edgeLabelInsetAdjustPx:0,edgeCaptionDistanceMinPx:8,edgeCaptionDistanceMaxPx:48,simulationOverlayIntensity:1,depthWashOpacity:.65,depthWashBlendModeLight:"color-dodge",depthWashBlendModeDark:"multiply",depthWashCenterY:.3,depthWashRadiusScale:1,depthWashCenterColorLight:"#ffffff",depthWashEdgeColorLight:"#142b48",depthWashCenterAlphaLight:.3,depthWashEdgeAlphaLight:.4,depthWashCenterColorDark:"#1a1e23",depthWashEdgeColorDark:"#05020f",depthWashCenterAlphaDark:0,depthWashEdgeAlphaDark:.8,linkHoverColor:"#ff4013",topLogoWidthVw:35,homeMainLinksBelowLogoPx:40,footerNavBarTopVh:50,footerNavBarGapVw:2.5,wallThickness:12,wallRadius:42,wallInset:3,wallShadowEdgeTopOpacityLight:.08,wallShadowEdgeTopOpacityDark:.25,wallShadowEdgeLeftOpacityLight:.06,wallShadowEdgeLeftOpacityDark:.18,wallShadowEdgeBottomOpacityLight:.06,wallShadowEdgeBottomOpacityDark:.03,wallShadowEdgeRightOpacityLight:.04,wallShadowEdgeRightOpacityDark:.02,wallShadowAmbientBlur:20,wallShadowAmbientOpacityLight:.04,wallShadowAmbientOpacityDark:.12,wallShadowStrokeOpacityLight:.06,wallShadowStrokeOpacityDark:.04,wallInnerShadowEnabled:!0,wallInnerShadowOpacityLight:.08,wallInnerShadowOpacityDark:.25,wallInnerShadowOffsetY:2,wallInnerShadowBlur1:3,wallInnerShadowBlur2:8,wallInnerShadowBlur3:20,wallGradientStrokeEnabled:!0,wallGradientStrokeWidth:.33,wallGradientStrokeBottomEnabled:!0,wallGradientStrokeBottomRadius:1,wallGradientStrokeBottomOpacity:1,wallGradientStrokeBottomColor:"#ffffff",wallGradientStrokeTopEnabled:!0,wallGradientStrokeTopRadius:1,wallGradientStrokeTopOpacity:.5,wallGradientStrokeTopColor:"#ffffff",outerWallEdgeEnabled:!0,outerWallRadiusAdjust:2,outerWallTopDarkOffset:1,outerWallTopDarkBlur:3,outerWallTopDarkSpread:0,outerWallTopDarkOpacityLight:.6,outerWallTopDarkOpacityDark:.4,outerWallBottomLightOffset:.5,outerWallBottomLightBlur:0,outerWallBottomLightSpread:0,outerWallBottomLightOpacityLight:.5,outerWallBottomLightOpacityDark:.3,outerWallCastShadowOffset:3,outerWallCastShadowBlur:12,outerWallCastShadowSpread:0,outerWallCastShadowOpacityLight:.15,outerWallCastShadowOpacityDark:.25,innerWallOutwardShadowOffset:2,innerWallOutwardShadowBlur:8,innerWallOutwardShadowSpread:2,innerWallOutwardShadowOpacityLight:.2,innerWallOutwardShadowOpacityDark:.35,outerWallTopBevelWidth:3,outerWallTopBevelOpacityLight:.25,outerWallTopBevelOpacityDark:.35,innerWallTopBevelWidth:2,innerWallTopLightOpacityLight:.3,innerWallTopLightOpacityDark:.4,innerWallBottomBevelWidth:2,innerWallTopBevelOpacityLight:.18,innerWallTopBevelOpacityDark:.25,modalOverlayEnabled:!0,modalOverlayOpacity:.01,modalOverlayBlurPx:8,modalOverlayTransitionMs:800,modalOverlayTransitionOutMs:600,modalOverlayContentDelayMs:200,modalDepthScale:.96,modalDepthTranslateY:8,logoBlurInactive:0,logoBlurActive:12,grungeVideoEnabled:!0,grungeVideoOpacity:.8,grungeVideoBlendModeLight:"overlay",grungeVideoBlendModeDark:"screen",entranceEnabled:!0,entranceWallTransitionDelay:300,entranceWallTransitionDuration:800,entranceWallInitialScale:1.1,entranceWallEasing:"cubic-bezier(0.16, 1, 0.3, 1)",entranceElementDuration:800,entranceElementScaleStart:.95,entranceElementTranslateZStart:-20,contentFadeInDelay:500,contentFadeInDuration:1e3,entranceElementEasing:"cubic-bezier(0.16, 1, 0.3, 1)",entranceLateElementDuration:600,entranceLateElementStagger:250,entranceLateElementScaleFrom:.92,entrancePerspectiveLandscape:1200,entrancePerspectiveSquare:1e3,entrancePerspectivePortrait:800,uiHitAreaMul:1,uiIconCornerRadiusMul:.5,uiIconFramePx:0,uiIconGlyphPx:0,uiIconGroupMarginPx:0,linkTextPadding:30,linkIconPadding:24,linkColorInfluence:1,linkImpactScale:.95,linkImpactBlur:10,linkImpactDuration:150,linkHoverNudge:1,linkHoverIntensityLight:.2,linkHoverIntensityDark:.24,linkHoverIntensityActive:.18,hoverSnapEnabled:!0,hoverSnapDuration:450,hoverSnapOvershoot:1.08,hoverSnapUndershoot:.98,hoverEdgeEnabled:!0,hoverEdgeWidth:1,hoverEdgeInset:0,hoverEdgeBottomEnabled:!0,hoverEdgeBottomRadius:1.2,hoverEdgeBottomOpacity:.6,hoverEdgeBottomColorMix:70,hoverEdgeTopEnabled:!0,hoverEdgeTopRadius:1,hoverEdgeTopOpacity:.3,hoverEdgeTopColorMix:50,getSquashMax(){return 0===this.ballSoftness?0:Gn.SQUASH_MAX_BASE*(this.ballSoftness/40)},getCanvasCornerRadius(){return Math.max(0,this.cornerRadius-this.simulationPadding)}};var Hn=Object.freeze({__proto__:null,applyLayoutCSSVars:f,applyLayoutFromVwToPx:h,clearBalls:x,detectResponsiveScale:w,getBalls:()=>_n.balls,getConfig:()=>_n.config,getEffectiveDPR:()=>Nn,getGlobals:y,getLayoutViewportHeightPx:s,getLayoutViewportWidthPx:l,getMobileAdjustedCount:b,getNormalizedScreenArea:d,getScreenAreaPx:c,getState:g,initState:m,pxToVw:u,setCanvas:M,setEffectiveDPR:n,setMode:v,updateBallSizes:S,vwToPx:p});const jn=.85,qn=["#b5b7b6","#bbbdbd","#ffffff","#00695c","#000000","#ff4013","#0d5cb6","#ffa000"],Yn=["#5b8378","#345d51","#8a928a","#00e6c3","#d5d5d5","#ff6b47","#5b9aff","#ffb84d"],Zn=1.35,Xn={satMul:.1,valMul:.03},Un={satMul:.14,valMul:.07},Jn={industrialTeal:{label:"Industrial Teal",light:R(qn,.2),dark:R(Yn,.2)},industrialRust:{label:"Industrial Rust",light:R(A(O(qn,B(qn,["#b5b7b6","#bbbdbd","#ffffff","#a33a22","#000000","#00695c","#1f4bb8","#ff8a1f"],Zn),jn),Xn),.2),dark:R(A(O(Yn,B(Yn,["#7f6f64","#54433a","#b6b1aa","#ff6a3d","#d5d5d5","#00e6c3","#6aa0ff","#ffb15a"],Zn),jn),Un),.2)},industrialSlate:{label:"Industrial Slate",light:R(A(O(qn,B(qn,["#b5b7b6","#bbbdbd","#ffffff","#1f2937","#000000","#00a8cc","#7c3aed","#ff5d2e"],Zn),jn),Xn),.2),dark:R(A(O(Yn,B(Yn,["#6f7780","#3f4851","#98a2b3","#7dd3fc","#d5d5d5","#22d3ee","#c084fc","#ff7a45"],Zn),jn),Un),.2)},industrialAmber:{label:"Industrial Amber",light:R(A(O(qn,B(qn,["#b5b7b6","#bbbdbd","#ffffff","#d97706","#000000","#00695c","#6b46c1","#ff4013"],Zn),jn),Xn),.2),dark:R(A(O(Yn,B(Yn,["#82745d","#5a4b35","#a9a193","#fbbf24","#d5d5d5","#00e6c3","#c4b5fd","#ff6b47"],Zn),jn),Un),.2)},industrialViolet:{label:"Industrial Violet",light:R(A(O(qn,B(qn,["#b5b7b6","#bbbdbd","#ffffff","#6b46c1","#000000","#00695c","#7fbf2a","#d94666"],Zn),jn),Xn),.2),dark:R(A(O(Yn,B(Yn,["#7a6f83","#52475b","#a7a0b0","#c084fc","#d5d5d5","#00e6c3","#bef264","#fb7185"],Zn),jn),Un),.2)},industrialForest:{label:"Industrial Forest",light:R(A(O(qn,B(qn,["#b5b7b6","#bbbdbd","#ffffff","#166534","#000000","#00695c","#f59e0b","#7c3aed"],Zn),jn),Xn),.2),dark:R(A(O(Yn,B(Yn,["#637563","#3d4f3f","#98a593","#4ade80","#d5d5d5","#00e6c3","#fcd34d","#c4b5fd"],Zn),jn),Un),.2)},industrialSteel:{label:"Industrial Steel",light:R(A(O(qn,B(qn,["#b5b7b6","#bbbdbd","#ffffff","#334155","#000000","#0ea5e9","#c2410c","#65a30d"],Zn),jn),Xn),.2),dark:R(A(O(Yn,B(Yn,["#6f737a","#464a52","#98a2ab","#94a3b8","#d5d5d5","#38bdf8","#fb923c","#a3e635"],Zn),jn),Un),.2)}},Qn=["industrialTeal","industrialRust","industrialSlate","industrialAmber","industrialViolet","industrialForest","industrialSteel"],ei="abs_palette_chapter",ti=[.5,.25,.12,.06,.03,.02,.01,.01],ai=[3,5,6,7];var oi=Object.freeze({__proto__:null,COLOR_TEMPLATES:Jn,PALETTE_CHAPTER_ORDER:Qn,applyColorTemplate:ee,applyCursorColorIndex:Y,getColorByIndex:Q,getCurrentPalette:X,getCursorCandidateIndices:q,maybeAutoPickCursorColor:Z,pickRandomColor:J,pickRandomColorWithIndex:U,populateColorSelect:te,rotatePaletteChapterOnReload:ae});const ni={attackTime:.003,decayTime:.12,harmonicGain:.02,filterBaseFreq:580,filterVelocityRange:400,filterQ:.18,filterMinHz:350,filterMaxHz:2800,pitchMinHz:220,pitchMaxHz:880,pitchCurve:1.2,reverbDecay:.25,reverbWetMix:.18,reverbHighDamp:.55,minGain:.001,maxGain:.0125,masterGain:.28,voiceGainMax:.02,minTimeBetweenSounds:.012,maxPan:.15,noiseTransientEnabled:!0,noiseTransientGain:.018,noiseTransientDecay:.004,noiseTransientFilterMin:800,noiseTransientFilterMax:2400,noiseTransientQ:.8,sparkleGain:.035,sparkleRatioMin:2,sparkleRatioMax:5,sparkleDecayMul:.85,variancePitch:.06,varianceDecay:.2,varianceGain:.15,varianceFilter:.18,varianceNoise:.25,velocityNoiseScale:1.8,velocityBrightnessScale:1.4,velocityDecayScale:.65,intensityExponent:1.5,toneSafetyMinHz:130,toneSafetyMaxHz:480,toneSafetyExponent:2.2,toneSafetyHighGainAtten:.25,toneSafetyLowGainAtten:.06,toneSafetyHighBrightAtten:.45,collisionMinImpact:.58,highShelfFreq:2200,highShelfGain:-6};let ii={continuousEnabled:!1,tickGainMul:1,swishGainMul:1,tickBaseGain:.05,tickMinVelocity:50,tickMaxVelocity:1600,tickMinRate:.6,tickMaxRate:9,swishBaseGain:.04,swishMinVelocity:220,swishMaxVelocity:2200,swishMinHz:600,swishMaxHz:2200,centerGain:.08,centerFilterHz:1600,snapGain:.12,openGain:.12,openFilterHz:1800,closeGain:.1,closeFilterHz:1600,snapDebounceMs:300,stopDelayMs:60},ri=null;const li={organicImpact:{label:"Organic Impact",description:"Warm, natural thuds with intensity dynamics",...ni},glassMarbles:{label:"Glass Marbles",description:"Clear, glassy impacts with more presence",...ni,pitchMinHz:260,pitchMaxHz:780,pitchCurve:1.05,filterBaseFreq:850,filterVelocityRange:600,noiseTransientGain:.065,noiseTransientFilterMin:650,noiseTransientFilterMax:2200,noiseTransientQ:1.6,decayTime:.055,intensityExponent:1.3,highShelfGain:-4.5},crystalPebbles:{label:"Crystal Pebbles ",description:"Crisp, close, soothing micro-chimes (non-repetitive)",...ni,pitchMinHz:420,pitchMaxHz:1600,pitchCurve:1.15,filterBaseFreq:1300,filterVelocityRange:1700,filterQ:.22,filterMaxHz:6200,decayTime:.04,intensityExponent:1.65,collisionMinImpact:.7,minTimeBetweenSounds:.018,noiseTransientGain:.02,noiseTransientDecay:.006,noiseTransientFilterMin:1200,noiseTransientFilterMax:7e3,noiseTransientQ:2.8,sparkleGain:.12,sparkleRatioMin:2.6,sparkleRatioMax:4.4,sparkleDecayMul:.55,reverbWetMix:.04,reverbDecay:.1,highShelfGain:-4,masterGain:.24},woodenBeads:{label:"Wooden Beads ",description:"Ultra-soft, muted thuds (recommended)",...ni,filterBaseFreq:420,filterVelocityRange:200,noiseTransientGain:.025,noiseTransientFilterMin:380,noiseTransientFilterMax:1400,noiseTransientQ:1.1,decayTime:.095,intensityExponent:1.7,collisionMinImpact:.62,highShelfGain:-7.5,reverbWetMix:.12},rubberBalls:{label:"Rubber Balls",description:"Bouncy, playful with longer decay",...ni,pitchMinHz:160,pitchMaxHz:360,filterBaseFreq:520,filterVelocityRange:350,noiseTransientGain:.035,noiseTransientFilterMin:450,noiseTransientFilterMax:1600,noiseTransientQ:1.2,decayTime:.12,intensityExponent:1.4,reverbWetMix:.14,highShelfGain:-5},metallicClick:{label:"Metallic Click",description:"Crisp, percussive impacts",...ni,pitchMinHz:220,pitchMaxHz:620,pitchCurve:1.1,filterBaseFreq:720,filterVelocityRange:550,noiseTransientGain:.08,noiseTransientFilterMin:700,noiseTransientFilterMax:2400,noiseTransientQ:1.8,noiseTransientDecay:.006,decayTime:.045,intensityExponent:1.2,highShelfGain:-3.5,collisionMinImpact:.5}};let si="crystalPebbles";ri={...li[si]},delete ri.label,delete ri.description;let ci=null,di=null,ui=null,pi=null,hi=null,fi=null,mi=null,gi=null,yi=null,bi=!1,Mi=!1;const vi="bravia-balls:sound-state",xi=8;let wi=[],Si=0,Ci=new Map,ki=!1,Fi=null,Li=null,Ii=null,Di=null,Ki=null,Ti=null,Pi=null,Ei=null,Oi=null,Bi=null,Ai=!1;const Ri=new Map,Wi=[],zi=[];let $i=null,Gi=0;class Vi{constructor(e,t,a,o){const n=y();this.x=e,this.y=t,this.vx=200*(2*Math.random()-1),this.vy=200*-Math.random(),this.r=a,this.rBase=a,this.m=n.ballMassKg,this.color=o,this.t=0,this.age=0,this.driftAx=0,this.driftTime=0,this.omega=0,this.squash=1,this.squashDirX=1,this.squashDirY=0,this.theta=0,this.squashAmount=0,this.squashNormalAngle=0,this.alpha=1,this.isSleeping=!1,this.sleepTimer=0,this.isGrounded=!1,this.hasSupport=!1,this.Se="ball-"+Gi++}step(e,t){const a=y(),{currentMode:o,G:n,gravityScale:i,FRICTION:r,MASS_BASELINE_KG:l}=a;if(this.t+=e,this.age+=e,this.isSleeping){const e=(a.repelRadius||710)*a.DPR*1.2,t=this.x-a.mouseX,o=this.y-a.mouseY;e*e>t*t+o*o&&this.wake()}if(this.isSleeping&&!1!==a.physicsSkipSleepingSteps)return;const s=a.DPR||1,c=this.isGrounded,d=this.hasSupport;this.isGrounded=!1,this.hasSupport=!1,o!==Bn.WEIGHTLESS&&(!c&&!d||-8*s>this.vy)&&(this.vy+=n*i*e);const u=Math.max(.25,this.m/l),p=Math.max(0,1-(o===Bn.WEIGHTLESS?0:r)*(1+1*Math.max(0,Math.min(1,1-Math.sqrt(this.vx*this.vx+this.vy*this.vy)/(100*s))))/u);this.vx*=p,this.vy*=p;const h=2*s;h>Math.abs(this.vx)&&(this.vx=0),h>Math.abs(this.vy)&&o===Bn.WEIGHTLESS&&(this.vy=0),0!==this.driftAx&&this.driftTime>this.age?this.vx+=this.driftAx*e/u:0!==this.driftAx&&(this.driftAx=0),t&&t(this,e),this.x+=this.vx*e,this.y+=this.vy*e,this.omega*=Math.max(0,1-Gn.SPIN_DAMP_PER_S*(1+.5*Math.max(0,Math.min(1,1-Math.abs(this.omega)/2)))*e),this.theta+=this.omega*e,.01>Math.abs(this.omega)&&(this.omega=0),this.ve?(this.squashAmount=0,this.squash=1):(this.squashAmount+=(0-this.squashAmount)*Math.min(1,Gn.SQUASH_DECAY_PER_S*e),this.squash=1-this.squashAmount)}updateSleepState(e,t){const a=Math.sqrt(this.vx*this.vx+this.vy*this.vy),o=Math.abs(this.omega),n=t.DPR||1,i=(Number.isFinite(t.sleepVelocityThreshold)?t.sleepVelocityThreshold:Gn.SLEEP_VELOCITY_THRESHOLD)*n,r=Number.isFinite(t.sleepAngularThreshold)?t.sleepAngularThreshold:Gn.SLEEP_ANGULAR_THRESHOLD,l=Number.isFinite(t.timeToSleep)?t.timeToSleep:Gn.TIME_TO_SLEEP;(this.isGrounded||this.hasSupport)&&i>a&&r>o?(this.sleepTimer+=e,l>this.sleepTimer||(this.vx=0,this.vy=0,this.omega=0,this.isSleeping=!0)):this.sleepTimer=0}wake(){this.isSleeping=!1,this.sleepTimer=0}walls(e,t,a,o,n={}){const i=!1!==n.registerEffects&&!this.ye,r=y(),{REST:l,MASS_BASELINE_KG:s,currentMode:c,DPR:d}=r,u=void 0!==o?o:l,p=this.r*(1+(r.ballSpacing||0)),h="function"==typeof r.getCanvasCornerRadius?r.getCanvasCornerRadius():r.cornerRadius??r.wallRadius??0,f=Math.max(0,+h||0)*(d||1),m=Math.max(0,(r.wallThickness??0)*(d||1)),g=Math.max(0,r.wallInset??3)*(d||1),b=Math.max(1,e-2*m),M=Math.max(1,t-2*m);let v=!1;const x=c===Bn.PIT,w=.5*b,S=.5*M,C=Math.max(0,Math.min(f,.5*b,.5*M)),k=this.x-(m+w),F=this.y-(m+S),L=Math.abs(k)-(w-C),I=Math.abs(F)-(S-C),D=Math.hypot(Math.max(L,0),Math.max(I,0))+Math.min(Math.max(L,I),0)-C;let K=0,T=0;if(L>0&&I>0){const e=Math.hypot(L,I);e>1e-6&&(K=L/e,T=I/e)}else L>I?(K=1,T=0):(K=0,T=1);K*=0>k?-1:1,T*=0>F?-1:1;const P=D+(p+g);if(!(0>=P||x&&-.5>T||c===Bn.BUBBLES&&-.5>T)){v=!0;const t=this.vx*K+this.vy*T;this.x-=K*P,this.y-=T*P,t>0&&(this.vx-=(1+u)*t*K,this.vy-=(1+u)*t*T);const o=T>.7,n=Math.min(1,Math.abs(t)/(80*this.r));if(o){this.isGrounded=!0;const e=Math.max(.25,this.m/s);this.vx*=Math.max(0,1-Gn.ROLL_FRICTION_PER_S*(1+Math.max(0,Math.min(1,1-Math.abs(this.vx)/(80*d))))*a/e),3*d>Math.abs(this.vx)&&(this.vx=0),this.omega+=(this.vx-this.omega*this.r)/this.r*Gn.SPIN_GAIN/e,this.omega+=(this.vx/this.r-this.omega)*Math.min(1,Gn.GROUND_COUPLING_PER_S*a),.05>Math.abs(this.omega)&&(this.omega=0)}this.ve||(this.squashAmount=Math.min(r.getSquashMax(),.8*n),this.squashNormalAngle=Math.atan2(-T,-K)),i&&Me(this.r,.65*n,this.x/Math.max(1,e),this.Se)}v&&(this.isSleeping||!0===this.isMeteor)&&this.wake()}getDisplayRadius(){return this.r*(this.filterSizeMultiplier??1)}draw(e){const t=this.squashAmount>.01,a=this.alpha*(this.filterOpacity??1),o=1>a,n=this.getDisplayRadius();t||o?(e.save(),(t||o)&&(e.translate(this.x,this.y),t?(e.rotate(this.theta+this.squashNormalAngle),e.scale(1-.3*this.squashAmount,1+.3*this.squashAmount),e.rotate(-this.squashNormalAngle)):e.rotate(this.theta),o&&(e.globalAlpha=a),e.beginPath(),e.arc(0,0,n,0,2*Math.PI),e.fillStyle=this.color,e.fill()),e.restore()):(e.fillStyle=this.color,e.beginPath(),e.arc(this.x,this.y,n,0,2*Math.PI),e.fill())}}const Ni=.2,_i=[];let Hi,ji,qi=null,Yi="",Zi=Gn.DPR,Xi=0,Ui=0,Ji=null,Qi=null,er=0,tr=0,ar=0;var or=Object.freeze({__proto__:null,getCanvas:Ue,getContext:Je,resize:Xe,setForceRenderCallback:Ye,setupRenderer:Ze});const nr=new WeakMap,ir=new WeakMap,rr=new WeakMap,lr=new WeakMap,sr=new WeakMap,cr=2*Math.PI,dr=1e-6;let ur=0;const pr=[3,5,6,7],hr=[0,1];let fr=[],mr=.5,gr=0,yr=0,br=.5,Mr=.5,vr=0,xr=!1,wr=[];const Sr=32;let Cr=new Float32Array(1024),kr=0,Fr=0,Lr=[],Ir=0,Dr=null,Kr=[],Tr=[],Pr=0,Er=0,Or=!1,Br=0,Ar=0,Rr=!1,Wr=[],zr=0,$r=0,Gr=0,Vr=!1,Nr=0,_r=0,Hr=0,jr=0,qr=0,Yr=0,Zr=0,Xr=0,Ur=[],Jr=0,Qr=0,el=0,tl=0,al=0,ol=performance.now()/1e3,nl=0,il=!0,rl=null;const ll=1e3/60;let sl=[],cl=0;var dl=Object.freeze({__proto__:null,MODES:Bn,getForceApplicator:ra,getModeRenderer:sa,getModeUpdater:la,resetCurrentMode:ia,setMode:na});let ul=null,pl=null,hl=null,fl=!0,ml=!1;const gl=new WeakMap;let yl=!1;var bl=Object.freeze({__proto__:null,hideOverlay:ba,initModalOverlay:fa,isOverlayActive:Ma,mountModalIntoOverlay:da,showOverlay:ya,unmountModalFromOverlay:ua,updateBlurFromWallThickness:ha,updateGateContentDelay(e){document.documentElement.style.setProperty("--modal-content-delay",e+"ms")},updateGateDepthScale(e){document.documentElement.style.setProperty("--modal-depth-scale",e),ga(Ma())},updateGateDepthTranslateY(e){document.documentElement.style.setProperty("--modal-depth-translate-y",e+"px"),ga(Ma())},updateLogoBlurActive(e){const t=document.documentElement;t.style.setProperty("--logo-blur-active-target",e+"px"),Ma()&&t.style.setProperty("--logo-blur-active",e+"px"),ga(Ma())},updateLogoBlurInactive(e){const t=document.documentElement;t.style.setProperty("--logo-blur-inactive",e+"px"),Ma()||t.style.setProperty("--logo-blur-active",e+"px"),ga(Ma())},updateOverlayBlur(e){ul&&(void 0!==e?(yl=!0,ul.style.setProperty("--modal-overlay-blur",e+"px")):ha())},updateOverlayOpacity(e){ul&&ul.style.setProperty("--modal-overlay-opacity",e)},updateOverlayTransition(e){ul&&(ul.style.setProperty("--modal-overlay-transition-duration",e+"ms"),document.documentElement.style.setProperty("--modal-depth-duration",e+"ms"),ga(Ma()))},updateOverlayTransitionOut(e){ul&&(ul.style.setProperty("--modal-overlay-transition-out-duration",e+"ms"),document.documentElement.style.setProperty("--modal-depth-out-duration",e+"ms"),ga(Ma()))}});const Ml=64;let vl=0;const xl=new Float32Array(Ml),wl=new Float32Array(Ml),Sl=new Float32Array(Ml),Cl=new Float32Array(Ml),kl=new Float32Array(Ml),Fl=new Float32Array(Ml),Ll=new Float32Array(Ml),Il=new Float32Array(Ml),Dl=Array(Ml);let Kl=0,Tl=0;const Pl="--abs-scene-impact",El="--abs-scene-impact-dur",Ol="--abs-scene-impact-logo-scale";let Bl=null,Al=!1,Rl=0,Wl=0,zl=0,$l=!1,Gl=0,Vl=0,Nl=0,_l=0,Hl=0,jl=0,ql=0,Yl=0,Zl=null,Xl=!1,Ul=!1,Jl=null,Ql=0;const es=100;let ts=!1,as=null,os=!1;const ns="translate(-50%, -50%) scale(0)",is="translate(-50%, -50%) scale(0.25)",rs="translate(-50%, -50%) scale(1)";var ls=Object.freeze({__proto__:null,getCursorColor:Ia,hideCursor:Pa,setupCustomCursor:Da,showCursor:Ea,updateCursorPosition:Ta,updateCursorSize:Ka});let ss=0,cs=null,ds=null,us=null,ps=0,hs=0,fs=!1,ms=0;const gs=Gn.PHYSICS_DT,ys=Gn.PHYSICS_DT_MOBILE,bs=42,Ms=1800,vs=1/60,xs={},ws=Object.freeze({registerEffects:!1}),Ss={iterations:3,positionalCorrectionPercent:.22,maxCorrectionPx:1.25,enableSound:!1},Cs={map:new Map,arrays:[],arrayIndex:0};var ks=Object.freeze({__proto__:null,getBalls:()=>y().balls||[],render:Ha,resetPhysicsAccumulator:$a,syncChromeColor:ja,updatePhysics:_a});const Fs=(()=>{try{return{log:console.log?.bind(console)??(()=>{}),info:console.info?.bind(console)??(()=>{}),warn:console.warn?.bind(console)??(()=>{}),error:console.error?.bind(console)??(()=>{}),debug:console.debug?.bind(console)??(()=>{}),groupCollapsed:console.groupCollapsed?.bind(console)??(()=>{}),groupEnd:console.groupEnd?.bind(console)??(()=>{}),table:console.table?.bind(console)??(()=>{})}}catch(e){return{log(){},info(){},warn(){},error(){},debug(){},groupCollapsed(){},groupEnd(){},table(){}}}})();let Ls=null,Is=0,Ds="undefined"!=typeof performance&&performance.now?performance.now():Date.now(),Ks=!1;const Ts=["#b7bcb7","#d0d0d0","#ffffff","#00695c","#1a1a1a","#ff4013","#0d5cb6","#ffa000"],Ps=[.5,.25,.12,.06,.03,.02,.01,.01];let Es=null,Os=null,Bs=!1,As=null,Rs=null,Ws=null,zs=null,$s=null,Gs=0,Vs=null,Ns=0,_s=null,Hs="";const js=["noiseEnabled","noiseSeed","noiseTextureSize","noiseDistribution","noiseMonochrome","noiseChroma","noiseMotion","noiseMotionAmount","noiseSpeedMs","noiseSpeedVariance","noiseFlicker","noiseFlickerSpeedMs","noiseBlurPx","noiseContrast","noiseBrightness","noiseSaturation","noiseHue","noiseSize","noiseOpacity","noiseOpacityLight","noiseOpacityDark","noiseBlendMode","noiseColorLight","noiseColorDark","detailNoiseOpacity"];let qs=null,Ys={};(()=>{try{const e=localStorage.getItem("panel_control_visibility");e&&(Ys=JSON.parse(e))}catch(e){Ys={}}})();const Zs=[{id:"appearance",title:"Appearance",icon:"",sections:["colors","colorDistribution","noise","videoOverlay"]},{id:"frame",title:"Frame",icon:"",sections:["wallGeometry","layers","uiSpacing"]},{id:"effects",title:"Effects",icon:"",sections:["outerWall","innerWall","simulationOverlay","overlay"]},{id:"interaction",title:"Interaction",icon:"",sections:["cursor","trail","cursorExplosionImpact","links"]},{id:"simulation",title:"Simulation",icon:"",sections:["liteMode","physics","balls"]},{id:"motion",title:"Motion",icon:"",sections:["scene","entrance","environment"]}];Zs.flatMap(e=>e.sections);const Xs={liteMode:{title:"Lite Mode",icon:"",defaultOpen:!0,controls:[{id:"liteModeEnabled",label:"Lite Mode",stateKey:"liteModeEnabled",type:"toggle",default:!1,format:e=>e?"On":"Off",parse:e=>!!e,hint:"Reduces simulation density for smoother 90fps targets.",isHero:!0,onChange(e){Promise.resolve().then(()=>dl).then(({setMode:t})=>{t(e.currentMode)}).catch(()=>{})}}]},environment:{title:"Browser",icon:"",defaultOpen:!1,controls:[{id:"chromeHarmonyMode",label:"Chrome Harmony",stateKey:"chromeHarmonyMode",type:"select",options:[{value:"auto",label:"Auto (adapt only when needed)"},{value:"site",label:"Site (benchmark)"},{value:"browser",label:"Browser (force adapt)"}],default:"site",format:e=>e+"",parse:e=>e+"",hint:"If desktop browsers ignore theme-color, the wall adapts to match the browser UI palette.",onChange(){Promise.resolve().then(()=>uc).then(({getCurrentTheme:e,setTheme:t})=>{t(e())}).catch(()=>{})}},{id:"autoDarkModeEnabled",label:"Auto Dark (Night)",stateKey:"autoDarkModeEnabled",type:"checkbox",default:!0,format:e=>e?"On":"Off",parse:e=>!!e,hint:"In Auto theme, prefer Dark during the night window (privacy-first: local clock only).",onChange(){Promise.resolve().then(()=>uc).then(({getCurrentTheme:e,setTheme:t})=>{"auto"===e()&&t("auto")}).catch(()=>{})}},{id:"autoDarkNightStartHour",label:"Night Starts",stateKey:"autoDarkNightStartHour",type:"range",min:0,max:23,step:1,default:18,format:e=>Math.round(e)+":00",parse:e=>parseInt(e,10),onChange(){Promise.resolve().then(()=>uc).then(({getCurrentTheme:e,setTheme:t})=>{"auto"===e()&&t("auto")}).catch(()=>{})}},{id:"autoDarkNightEndHour",label:"Night Ends",stateKey:"autoDarkNightEndHour",type:"range",min:0,max:23,step:1,default:6,format:e=>Math.round(e)+":00",parse:e=>parseInt(e,10),onChange(){Promise.resolve().then(()=>uc).then(({getCurrentTheme:e,setTheme:t})=>{"auto"===e()&&t("auto")}).catch(()=>{})}}]},physics:{title:"Material World",icon:"",defaultOpen:!1,controls:[{id:"ballMassKg",label:"Ball Mass",stateKey:"ballMassKg",type:"range",min:20,max:400,step:1,default:91,format:e=>Math.round(e)+" kg",parse:e=>parseInt(e,10),hint:"Heavier = snooker feel (more inertia, less jitter).",onChange(e,t){const a=+t;if(Number.isFinite(a)&&Array.isArray(e.balls))for(let o=0;e.balls.length>o;o++){const t=e.balls[o];t&&(t.m=a)}}},{id:"REST",label:"Restitution",stateKey:"REST",type:"range",min:0,max:.95,step:.01,default:.42,format:e=>e.toFixed(2),parse:parseFloat,hint:"Global bounciness for collisions (modes may override)."},{id:"FRICTION",label:"Friction",stateKey:"FRICTION",type:"range",min:0,max:.06,step:.001,default:.018,format:e=>e.toFixed(3),parse:parseFloat,hint:"Global drag/energy loss (modes may override)."},{id:"physicsCollisionIterations",label:"Collision Iterations",stateKey:"physicsCollisionIterations",type:"range",min:3,max:20,step:1,default:10,format:e=>Math.round(e)+"",parse:e=>parseInt(e,10),group:"Performance",groupCollapsed:!0,hint:"How many times per frame we resolve collisions. Lower = faster, higher = tighter stacks."},{id:"physicsSkipSleepingCollisions",label:"Skip Sleeping Pairs",stateKey:"physicsSkipSleepingCollisions",type:"toggle",default:!0,group:"Performance",hint:"When enabled, collisions between two sleeping balls are skipped until something wakes them. Big CPU win with piles."},{id:"physicsSpatialGridOptimization",label:"Grid Reuse",stateKey:"physicsSpatialGridOptimization",type:"toggle",default:!0,group:"Performance",hint:"Reuses the spatial grid data structures to reduce allocations/GC. Keep on unless debugging."},{id:"physicsSleepThreshold",label:"Sleep Threshold",stateKey:"physicsSleepThreshold",type:"range",min:0,max:30,step:1,default:12,format:e=>Math.round(e)+" px/s",parse:e=>parseInt(e,10),group:"Performance",hint:"Velocity below which a ball is considered at rest (nonPit modes). 0 disables sleeping."},{id:"physicsSleepTime",label:"Sleep Time",stateKey:"physicsSleepTime",type:"range",min:0,max:1,step:.05,default:.25,format:e=>e.toFixed(2)+"s",parse:parseFloat,group:"Performance",hint:"How long a ball must stay under the Sleep Threshold before it sleeps. Higher = more stability + more performance."},{id:"physicsSkipSleepingSteps",label:"Skip Sleeping Steps",stateKey:"physicsSkipSleepingSteps",type:"toggle",default:!0,group:"Performance",hint:"When enabled, sleeping balls dont run physics integration each tick. Improves performance; tiny motions may be delayed until wake."}]},balls:{title:"Balls",icon:"",defaultOpen:!1,controls:[{id:"ballSizeMin",label:"Size Min",stateKey:"ballSizeMin",type:"range",min:8,max:40,step:1,default:22,format:e=>e+"px",parse:parseFloat,hint:"Ball radius at smallest viewport (320px)",onChange(e,t){e.ballSizeMin=t,Promise.resolve().then(()=>Hn).then(({updateBallSizes:t})=>{t();const a=e.R_MED;e.balls&&e.balls.length&&e.balls.forEach(e=>{e.r=a,e.rBase=a})}),Promise.resolve().then(()=>ls).then(({updateCursorSize:e})=>{e()})}},{id:"ballSizeMax",label:"Size Max",stateKey:"ballSizeMax",type:"range",min:10,max:60,step:1,default:30,format:e=>e+"px",parse:parseFloat,hint:"Ball radius at largest viewport (1920px)",onChange(e,t){e.ballSizeMax=t,Promise.resolve().then(()=>Hn).then(({updateBallSizes:t})=>{t();const a=e.R_MED;e.balls&&e.balls.length&&e.balls.forEach(e=>{e.r=a,e.rBase=a})}),Promise.resolve().then(()=>ls).then(({updateCursorSize:e})=>{e()})}},{id:"ballSizeCurve",label:"Size Curve",stateKey:"ballSizeCurve",type:"range",min:.2,max:5,step:.1,default:2.5,format:e=>e.toFixed(1),parse:parseFloat,hint:"Easing curve (1=linear, >1=smaller longer, <1=grows faster)",onChange(e,t){e.ballSizeCurve=t,Promise.resolve().then(()=>Hn).then(({updateBallSizes:t})=>{t();const a=e.R_MED;e.balls&&e.balls.length&&e.balls.forEach(e=>{e.r=a,e.rBase=a})}),Promise.resolve().then(()=>ls).then(({updateCursorSize:e})=>{e()})}},{id:"mobileObjectReductionFactor",label:"Mobile Density",stateKey:"mobileObjectReductionFactor",type:"range",min:0,max:1,step:.05,default:.7,format:e=>Math.round(100*e)+"%",parse:parseFloat,hint:"Scales object counts on mobile (0% = none). Resets the current mode.",onChange(e){Promise.resolve().then(()=>dl).then(({setMode:t})=>{t(e.currentMode)}).catch(()=>{})}},{id:"ballSoftnessGlobal",label:"Softness",stateKey:"ballSoftness",type:"range",min:0,max:100,step:1,default:20,format:e=>e+"",parse:e=>parseInt(e,10)},{id:"ballSpacing",label:"Spacing",stateKey:"ballSpacing",type:"range",min:0,max:.5,step:.01,default:.08,format:e=>Math.round(100*e)+"%",parse:parseFloat,hint:"Collision gap as % of ball radius (affects physics)"},{id:"sizeVariationGlobalMul",label:"Variation Scale",stateKey:"sizeVariationGlobalMul",type:"range",min:0,max:2,step:.05,default:1,format:e=>e.toFixed(2)+"x",parse:parseFloat,hint:"Global multiplier for per-mode size variation",onChange(){Promise.resolve().then(()=>Hn).then(({updateBallSizes:e})=>{e()})}},{id:"sizeVariationCap",label:"Variation Cap",stateKey:"sizeVariationCap",type:"range",min:0,max:.2,step:.01,default:.2,format:e=>Math.round(100*e)+"%",parse:parseFloat,hint:"Max radius deviation from medium (20% = 20%)",onChange(){Promise.resolve().then(()=>Hn).then(({updateBallSizes:e})=>{e()})}}]},cursor:{title:"Hand",icon:"",defaultOpen:!1,controls:[{id:"cursorInfluenceRadiusVw",label:"Influence Radius",stateKey:"cursorInfluenceRadiusVw",type:"range",min:0,max:80,step:.5,default:14,format:e=>e.toFixed(1)+"vw",parse:parseFloat,hint:"Universal cursor interaction zone (scales with viewport width)."}]},trail:{title:"Mouse & Trail",icon:"",defaultOpen:!1,controls:[{id:"cursorSize",label:"Cursor Size",stateKey:"cursorSize",type:"range",min:.1,max:3,step:.05,default:1,format:e=>e.toFixed(2),parse:parseFloat,onChange(){Promise.resolve().then(()=>ls).then(({updateCursorSize:e})=>{e()})}},{id:"mouseTrailEnabled",label:"Trail Enabled",stateKey:"mouseTrailEnabled",type:"checkbox",default:!0},{id:"mouseTrailLength",label:"Trail Length",stateKey:"mouseTrailLength",type:"range",min:4,max:96,step:1,default:18,format:e=>Math.round(e)+"",parse:e=>parseInt(e,10),hint:"Max samples kept (higher = smoother, slightly more work)"},{id:"mouseTrailSize",label:"Trail Size",stateKey:"mouseTrailSize",type:"range",min:.5,max:10,step:.1,default:1.3,format:e=>e.toFixed(1)+"px",parse:parseFloat},{id:"mouseTrailFadeMs",label:"Trail Fade",stateKey:"mouseTrailFadeMs",type:"range",min:40,max:1200,step:10,default:220,format:e=>Math.round(e)+"ms",parse:e=>parseInt(e,10)},{id:"mouseTrailOpacity",label:"Trail Opacity",stateKey:"mouseTrailOpacity",type:"range",min:0,max:1,step:.01,default:.35,format:e=>e.toFixed(2),parse:parseFloat},{type:"divider",label:"Cursor Explosion"},{id:"cursorExplosionEnabled",label:"Explosion Enabled",stateKey:"cursorExplosionEnabled",type:"checkbox",default:!0,hint:"Particle dispersion when cursor enters button areas"},{id:"cursorExplosionParticleCount",label:"Particle Count",stateKey:"cursorExplosionParticleCount",type:"range",min:4,max:32,step:1,default:16,format:e=>Math.round(e)+"",parse:e=>parseInt(e,10),hint:"Base particle count (scales with velocity)"},{id:"cursorExplosionSpeed",label:"Particle Speed",stateKey:"cursorExplosionSpeed",type:"range",min:100,max:1e3,step:50,default:400,format:e=>Math.round(e)+"px/s",parse:e=>parseInt(e,10),hint:"Base particle velocity (scales with impact)"},{id:"cursorExplosionSpreadDeg",label:"Spread Angle",stateKey:"cursorExplosionSpreadDeg",type:"range",min:180,max:360,step:10,default:360,format:e=>Math.round(e)+"",parse:e=>parseInt(e,10),hint:"Particle dispersion angle (360 = full circle)"},{id:"cursorExplosionLifetime",label:"Lifetime",stateKey:"cursorExplosionLifetime",type:"range",min:.3,max:1.5,step:.1,default:.8,format:e=>e.toFixed(1)+"s",parse:parseFloat,hint:"How long particles live before fading"},{id:"cursorExplosionFadeStartRatio",label:"Fade Start",stateKey:"cursorExplosionFadeStartRatio",type:"range",min:.3,max:.9,step:.05,default:.6,format:e=>Math.round(100*e)+"%",parse:parseFloat,hint:"When to start fading (0.6 = fade at 60% lifetime)"},{id:"cursorExplosionDrag",label:"Drag",stateKey:"cursorExplosionDrag",type:"range",min:.85,max:.99,step:.01,default:.95,format:e=>e.toFixed(2),parse:parseFloat,hint:"Velocity decay per frame (lower = faster slowdown)"},{id:"cursorExplosionShrinkEnabled",label:"Shrink Over Time",stateKey:"cursorExplosionShrinkEnabled",type:"checkbox",default:!0,hint:"Particles shrink as they age (cartoony character)"}]},cursorExplosionImpact:{title:"Cursor Explosion Impact",controls:[{id:"cursorExplosionImpactMinFactor",label:"Min Impact",stateKey:"cursorExplosionImpactMinFactor",type:"range",min:.1,max:2,step:.1,default:.5,format:e=>e.toFixed(1)+"x",parse:parseFloat,hint:"Impact multiplier for slow hover (0.5 = half intensity)"},{id:"cursorExplosionImpactMaxFactor",label:"Max Impact",stateKey:"cursorExplosionImpactMaxFactor",type:"range",min:1,max:8,step:.5,default:4,format:e=>e.toFixed(1)+"x",parse:parseFloat,hint:"Impact multiplier for fast impact (4.0 = 4x intensity)"},{id:"cursorExplosionImpactSensitivity",label:"Impact Sensitivity",stateKey:"cursorExplosionImpactSensitivity",type:"range",min:100,max:1e3,step:50,default:400,format:e=>Math.round(e)+"px/ms",parse:e=>parseInt(e,10),hint:"Velocity threshold for scaling (higher = less sensitive)"},{type:"divider",label:"Lifetime Impact"},{id:"cursorExplosionLifetimeImpactMin",label:"Min Lifetime Scale",stateKey:"cursorExplosionLifetimeImpactMin",type:"range",min:.3,max:1.5,step:.1,default:.7,format:e=>e.toFixed(1)+"x",parse:parseFloat,hint:"Lifetime multiplier for slow hover (particles fade quickly)"},{id:"cursorExplosionLifetimeImpactMax",label:"Max Lifetime Scale",stateKey:"cursorExplosionLifetimeImpactMax",type:"range",min:1,max:3,step:.1,default:1.8,format:e=>e.toFixed(1)+"x",parse:parseFloat,hint:"Lifetime multiplier for fast impact (particles travel farther)"},{id:"cursorExplosionLifetimeImpactSensitivity",label:"Lifetime Sensitivity",stateKey:"cursorExplosionLifetimeImpactSensitivity",type:"range",min:200,max:1500,step:50,default:600,format:e=>Math.round(e)+"px/ms",parse:e=>parseInt(e,10),hint:"Velocity threshold for lifetime scaling (higher = less sensitive)"}]},uiSpacing:{title:"UI Spacing",icon:"",defaultOpen:!1,controls:[{type:"divider",label:"Content"},{id:"contentPaddingRatio",label:"Padding Additive",stateKey:"contentPaddingRatio",type:"range",min:-.05,max:.1,step:.001,default:0,format:e=>(100*+e).toFixed(1)+"%",parse:parseFloat,hint:"Additive padding as a fraction of viewport size (sqrt(w*h)). Back-compat: old px values are auto-converted.",onChange(e,t){const a=void 0!==t?t:void 0!==e.contentPaddingRatio?e.contentPaddingRatio:0;Promise.resolve().then(()=>Hn).then(({applyLayoutFromVwToPx:t,applyLayoutCSSVars:o})=>{t(),o();try{const t=document.getElementById("contentPaddingRatioVal");if(t){const o=+a||0,n=(()=>{try{const e=getComputedStyle(document.documentElement).getPropertyValue("--layout-viewport-size-px").trim(),t=parseFloat(e);return Number.isFinite(t)?t:0}catch(e){return 0}})(),i=Math.round(n*o),r=Math.round(e.contentPadding||0);t.textContent=`${0>o?"":"+"}${(100*o).toFixed(1)}% (${0>i?"":"+"}${i}px)  ${r}px`}}catch(n){}try{document.dispatchEvent(new CustomEvent("layout-updated"))}catch(n){}}).catch(()=>{}),Promise.resolve().then(()=>or).then(({resize:e})=>{try{e()}catch(t){}}).catch(()=>{})}},{id:"contentPaddingHorizontalRatio",label:"Horizontal Ratio",stateKey:"contentPaddingHorizontalRatio",type:"range",min:.5,max:2.5,step:.05,default:1,format:e=>(+e).toFixed(2)+"",parse:parseFloat,hint:"Horizontal padding = base  ratio.",onChange(e){Promise.resolve().then(()=>Hn).then(({applyLayoutFromVwToPx:t,applyLayoutCSSVars:a})=>{t(),a();try{const t=document.getElementById("contentPaddingHorizontalRatioVal");t&&(t.textContent=`${(+(e.contentPaddingHorizontalRatio||1)).toFixed(2)}  ${Math.round(e.contentPaddingX||e.contentPadding)}px`)}catch(o){}}).catch(()=>{})}},{id:"contentPaddingBottomRatio",label:"Bottom Padding Ratio",stateKey:"contentPaddingBottomRatio",type:"range",min:.5,max:2.5,step:.05,default:1.3,format:e=>(+e).toFixed(2)+"",parse:parseFloat,hint:"Bottom padding multiplier (applied to vertical padding).",onChange(e,t){document.documentElement.style.setProperty("--abs-content-pad-mul-bottom",(+t||1.3)+"")}},{type:"divider",label:"Hit Areas"},{id:"uiHitAreaMul",label:"Hit Area Mul",stateKey:"uiHitAreaMul",type:"range",min:.5,max:2.5,step:.05,default:.7,format:e=>(+e).toFixed(2)+"",parse:parseFloat,hint:"Scales most UI button/link hit areas (drives --ui-hit-area-mul).",onChange(e,t){document.documentElement.style.setProperty("--ui-hit-area-mul",t+"")}},{type:"divider",label:"Icon Buttons"},{id:"uiIconFramePx",label:"Icon Frame Size",stateKey:"uiIconFramePx",type:"range",min:0,max:120,step:1,default:0,format:e=>+e>0?Math.round(e)+"px":"Auto",parse:e=>parseInt(e,10),hint:"Square icon button frame size (height/width). 0 = auto (derived from icon padding tokens).",onChange(e,t){const a=document.documentElement;+t>0?a.style.setProperty("--ui-icon-frame-size",Math.round(t)+"px"):a.style.removeProperty("--ui-icon-frame-size")}},{id:"uiIconGlyphPx",label:"Icon Glyph Size",stateKey:"uiIconGlyphPx",type:"range",min:0,max:64,step:1,default:0,format:e=>+e>0?Math.round(e)+"px":"Auto",parse:e=>parseInt(e,10),hint:"Icon glyph size inside the square frame. 0 = auto (uses token defaults).",onChange(e,t){const a=document.documentElement;+t>0?a.style.setProperty("--ui-icon-glyph-size",Math.round(t)+"px"):a.style.removeProperty("--ui-icon-glyph-size")}},{id:"uiIconGroupMarginPx",label:"Icon Group Margin",stateKey:"uiIconGroupMarginPx",type:"range",min:-60,max:60,step:1,default:0,format:e=>Math.round(e)+"px",parse:e=>parseInt(e,10),hint:"Margin applied to the social icon group. Use negative values to push icons outward.",onChange(e,t){const a=document.documentElement;0===+t?a.style.removeProperty("--ui-icon-group-margin"):a.style.setProperty("--ui-icon-group-margin",Math.round(t)+"px")}},{id:"uiIconCornerRadiusMul",label:"Corner Radius",stateKey:"uiIconCornerRadiusMul",type:"range",min:0,max:1,step:.01,default:.4,format:e=>Math.round(100*+e)+"% of wall",parse:parseFloat,hint:"Icon button corner radius as a fraction of wall radius (drives --ui-icon-corner-radius-mul).",onChange(e,t){document.documentElement.style.setProperty("--ui-icon-corner-radius-mul",t+"")}},{id:"uiIconFramePx",label:"Frame Size",stateKey:"uiIconFramePx",type:"range",min:0,max:140,step:1,default:0,format:e=>Math.round(+e)>0?Math.round(+e)+"px":"Auto",parse:e=>parseInt(e,10),hint:"Square icon button frame size (px). 0 = use token-derived default (--ui-icon-frame-size).",onChange(e,t){try{const e=document.documentElement,a=Math.round(+(t||0));a>0?e.style.setProperty("--ui-icon-frame-size",a+"px"):e.style.removeProperty("--ui-icon-frame-size")}catch(a){}}},{id:"uiIconGlyphPx",label:"Glyph Size",stateKey:"uiIconGlyphPx",type:"range",min:0,max:80,step:1,default:0,format:e=>Math.round(+e)>0?Math.round(+e)+"px":"Auto",parse:e=>parseInt(e,10),hint:"Icon glyph size (px). 0 = use token-derived default (--ui-icon-glyph-size).",onChange(e,t){try{const e=document.documentElement,a=Math.round(+(t||0));a>0?e.style.setProperty("--ui-icon-glyph-size",a+"px"):e.style.removeProperty("--ui-icon-glyph-size")}catch(a){}}},{type:"divider",label:"Links"},{id:"linkTextPadding",label:"Text Link Padding",stateKey:"linkTextPadding",type:"range",min:4,max:40,step:1,default:30,format:e=>Math.round(e)+"px",parse:e=>parseInt(e,10),hint:"Padding for text links (main links, CV links).",onChange(e,t){document.documentElement.style.setProperty("--link-text-padding",t+"px"),document.documentElement.style.setProperty("--link-text-margin",-t+"px")}},{id:"linkIconPadding",label:"Icon Link Padding",stateKey:"linkIconPadding",type:"range",min:4,max:40,step:1,default:24,format:e=>Math.round(e)+"px",parse:e=>parseInt(e,10),hint:"Legacy: used to derive auto icon button sizing when Icon Frame Size is set to Auto.",onChange(e,t){document.documentElement.style.setProperty("--link-icon-padding",t+"px"),document.documentElement.style.setProperty("--link-icon-margin",-t+"px")}},{type:"divider",label:"Main Links + Labels"},{id:"footerNavBarTopVh",label:"Nav Bar Position",stateKey:"footerNavBarTopVh",type:"range",min:0,max:100,step:.5,default:50,format:e=>(+e).toFixed(1)+"vh",parse:e=>parseFloat(e),hint:"Vertical position of main links nav bar from top of viewport.",onChange(e,t){const a=document.documentElement;a.style.setProperty("--footer-nav-bar-top",t+"vh"),a.style.setProperty("--footer-nav-bar-top-svh",t+"svh"),a.style.setProperty("--footer-nav-bar-top-dvh",t+"dvh")}},{id:"footerNavBarGapVw",label:"Nav Link Gap",stateKey:"footerNavBarGapVw",type:"range",min:0,max:10,step:.1,default:2.5,format:e=>(+e).toFixed(1)+"vw",parse:e=>parseFloat(e),hint:"Horizontal gap between nav bar links (vw  clamp).",onChange(e,t){const a=+t;if(!Number.isFinite(a))return;const o=Math.round(9.6*a);document.documentElement.style.setProperty("--footer-nav-bar-gap",`clamp(${o}px, ${a}vw, ${Math.round(1.67*o)}px)`)}},{id:"homeMainLinksBelowLogoPx",label:"Links Offset",stateKey:"homeMainLinksBelowLogoPx",type:"range",min:-120,max:240,step:1,default:40,format:e=>Math.round(e)+"px",parse:e=>parseInt(e,10),hint:"Index: move the main links up/down below the logo.",onChange(e,t){document.documentElement.style.setProperty("--home-main-links-below-logo-px",t+"")}},{id:"edgeLabelInsetAdjustPx",label:"Edge Label Inset",stateKey:"edgeLabelInsetAdjustPx",type:"range",min:-120,max:240,step:1,default:0,format:e=>Math.round(e)+"px",parse:e=>parseInt(e,10),hint:"Adjusts edge label inset relative to wall. Higher = inward; lower = outward.",onChange(){Promise.resolve().then(()=>Hn).then(e=>{e.applyLayoutCSSVars()}).catch(()=>{})}},{id:"edgeCaptionDistanceMinPx",label:"Caption Distance Min",stateKey:"edgeCaptionDistanceMinPx",type:"range",min:0,max:80,step:2,default:8,format:e=>Math.round(e)+"px",parse:e=>parseInt(e,10),hint:"Padding from bottom inner edge of wall (0 = flush). Index, portfolio, cv.",onChange(){Promise.resolve().then(()=>Hn).then(e=>{e.applyLayoutCSSVars()}).catch(()=>{})}},{id:"edgeCaptionDistanceMaxPx",label:"Caption Distance Max",stateKey:"edgeCaptionDistanceMaxPx",type:"range",min:16,max:200,step:2,default:48,format:e=>Math.round(e)+"px",parse:e=>parseInt(e,10),hint:"Maximum distance; at largest breakpoint does not grow further.",onChange(){Promise.resolve().then(()=>Hn).then(e=>{e.applyLayoutCSSVars()}).catch(()=>{})}}]},simulationOverlay:{title:"Simulation Overlay",icon:"",defaultOpen:!1,controls:[{id:"simulationOverlayIntensity",label:"CSS Gradient",stateKey:"simulationOverlayIntensity",type:"range",min:0,max:1,step:.05,default:1,format:e=>e.toFixed(2),parse:parseFloat,hint:"Intensity of the soft gradient overlay on the simulation (viewport ::before).",onChange(){Promise.resolve().then(()=>Hn).then(e=>{e.applyLayoutCSSVars()}).catch(()=>{})}},{type:"divider",label:"Depth Wash (Canvas)"},{id:"depthWashOpacity",label:"Opacity",stateKey:"depthWashOpacity",type:"range",min:0,max:1,step:.05,default:.65,format:e=>Math.round(100*e)+"%",parse:parseFloat,hint:"Master opacity of the radial depth overlay"},{id:"depthWashCenterY",label:"Center Y",stateKey:"depthWashCenterY",type:"range",min:0,max:1,step:.05,default:.3,format:e=>Math.round(100*e)+"%",parse:parseFloat,hint:"Vertical center of gradient (0=top, 100%=bottom)"},{id:"depthWashRadiusScale",label:"Radius",stateKey:"depthWashRadiusScale",type:"range",min:.2,max:3,step:.1,default:1,format:e=>e.toFixed(1)+"",parse:parseFloat,hint:"Size of the gradient"},{type:"divider",label:"Light Mode"},{id:"depthWashBlendModeLight",label:"Blend Mode",stateKey:"depthWashBlendModeLight",type:"select",options:[{value:"source-over",label:"Normal"},{value:"multiply",label:"Multiply"},{value:"screen",label:"Screen"},{value:"overlay",label:"Overlay"},{value:"darken",label:"Darken"},{value:"lighten",label:"Lighten"},{value:"color-dodge",label:"Color Dodge"},{value:"color-burn",label:"Color Burn"},{value:"hard-light",label:"Hard Light"},{value:"soft-light",label:"Soft Light"},{value:"difference",label:"Difference"},{value:"exclusion",label:"Exclusion"}],default:"color-dodge",format:e=>e+"",parse:e=>e+""},{id:"depthWashCenterColorLight",label:"Center Color",stateKey:"depthWashCenterColorLight",type:"color",default:"#ffffff",format:e=>e+"",parse:e=>e+""},{id:"depthWashCenterAlphaLight",label:"Center Alpha",stateKey:"depthWashCenterAlphaLight",type:"range",min:0,max:1,step:.05,default:.3,format:e=>Math.round(100*e)+"%",parse:parseFloat},{id:"depthWashEdgeColorLight",label:"Edge Color",stateKey:"depthWashEdgeColorLight",type:"color",default:"#142b48",format:e=>e+"",parse:e=>e+""},{id:"depthWashEdgeAlphaLight",label:"Edge Alpha",stateKey:"depthWashEdgeAlphaLight",type:"range",min:0,max:1,step:.05,default:.4,format:e=>Math.round(100*e)+"%",parse:parseFloat},{type:"divider",label:"Dark Mode"},{id:"depthWashBlendModeDark",label:"Blend Mode",stateKey:"depthWashBlendModeDark",type:"select",options:[{value:"source-over",label:"Normal"},{value:"multiply",label:"Multiply"},{value:"screen",label:"Screen"},{value:"overlay",label:"Overlay"},{value:"darken",label:"Darken"},{value:"lighten",label:"Lighten"},{value:"color-dodge",label:"Color Dodge"},{value:"color-burn",label:"Color Burn"},{value:"hard-light",label:"Hard Light"},{value:"soft-light",label:"Soft Light"},{value:"difference",label:"Difference"},{value:"exclusion",label:"Exclusion"}],default:"multiply",format:e=>e+"",parse:e=>e+""},{id:"depthWashCenterColorDark",label:"Center Color",stateKey:"depthWashCenterColorDark",type:"color",default:"#1a1e23",format:e=>e+"",parse:e=>e+""},{id:"depthWashCenterAlphaDark",label:"Center Alpha",stateKey:"depthWashCenterAlphaDark",type:"range",min:0,max:1,step:.05,default:0,format:e=>Math.round(100*e)+"%",parse:parseFloat},{id:"depthWashEdgeColorDark",label:"Edge Color",stateKey:"depthWashEdgeColorDark",type:"color",default:"#05020f",format:e=>e+"",parse:e=>e+""},{id:"depthWashEdgeAlphaDark",label:"Edge Alpha",stateKey:"depthWashEdgeAlphaDark",type:"range",min:0,max:1,step:.05,default:.8,format:e=>Math.round(100*e)+"%",parse:parseFloat}]},links:{title:"Links",icon:"",defaultOpen:!1,controls:[{id:"linkColorInfluence",label:"Color Influence",stateKey:"linkColorInfluence",type:"range",min:0,max:1,step:.01,default:1,format:e=>e.toFixed(2),parse:parseFloat,hint:"How much cursor color affects link colors (0 = none, 1 = full)",onChange(e,t){document.documentElement.style.setProperty("--link-color-influence",t+"")}},{id:"linkImpactScale",label:"Impact Scale",stateKey:"linkImpactScale",type:"range",min:.7,max:1,step:.01,default:.95,format:e=>e.toFixed(2),parse:parseFloat,hint:"Scale when link is pressed (lower = more dramatic press)",onChange(e,t){document.documentElement.style.setProperty("--link-impact-scale",t+"")}},{id:"linkImpactBlur",label:"Impact Blur",stateKey:"linkImpactBlur",type:"range",min:0,max:20,step:.5,default:10,format:e=>e.toFixed(1)+"px",parse:parseFloat,hint:"Blur amount when link is pressed (creates depth effect)",onChange(e,t){document.documentElement.style.setProperty("--link-impact-blur",t+"px")}},{id:"linkImpactDuration",label:"Impact Duration",stateKey:"linkImpactDuration",type:"range",min:50,max:300,step:10,default:150,format:e=>Math.round(e)+"ms",parse:e=>parseInt(e,10),hint:"Duration of press animation (fast and subtle)",onChange(e,t){document.documentElement.style.setProperty("--link-impact-duration",t+"ms")}},{type:"divider",label:"Hover Motion",group:"Motion"},{id:"hoverSnapEnabled",label:"Hover Snap",stateKey:"hoverSnapEnabled",type:"checkbox",default:!0,hint:"Hover targets: a tiny snap onto bounce on hover entry (scale-only; color stays instant).",onChange(e,t){document.documentElement.style.setProperty("--abs-hover-snap-enabled",t?"1":"0")}},{id:"hoverSnapDuration",label:"Snap Duration",stateKey:"hoverSnapDuration",type:"range",min:0,max:1200,step:10,default:450,format:e=>Math.round(e)+"ms",parse:e=>parseInt(e,10),hint:"Total duration of the hover snap bounce (ms).",onChange(e,t){document.documentElement.style.setProperty("--abs-hover-snap-duration",Math.max(0,Math.round(t))+"ms")}},{id:"hoverSnapOvershoot",label:"Snap Overshoot",stateKey:"hoverSnapOvershoot",type:"range",min:1,max:1.25,step:.005,default:1.08,format:e=>e.toFixed(3),parse:parseFloat,hint:"Peak scale during hover snap (>= 1.0).",onChange(e,t){document.documentElement.style.setProperty("--abs-hover-snap-overshoot",t+"")}},{id:"hoverSnapUndershoot",label:"Snap Recoil",stateKey:"hoverSnapUndershoot",type:"range",min:.8,max:1,step:.005,default:.98,format:e=>e.toFixed(3),parse:parseFloat,hint:"Small recoil scale before settling back to 1.0 (<= 1.0).",onChange(e,t){document.documentElement.style.setProperty("--abs-hover-snap-undershoot",t+"")}},{id:"linkHoverNudge",label:"Hover Nudge",stateKey:"linkHoverNudge",type:"range",min:0,max:4,step:.25,default:1,format:e=>e.toFixed(2)+"px",parse:parseFloat,hint:"Vertical translation applied to hover/focus/active states for corner links.",onChange(e,t){document.documentElement.style.setProperty("--link-nudge",t+"px")}},{type:"divider",label:"Hover Background Bounce",group:"Motion"},{id:"hoverBgBounceEnabled",label:"BG Bounce",stateKey:"hoverBgBounceEnabled",type:"checkbox",default:!0,hint:"Enable bouncy fade-in animation for hover pseudoelement backgrounds.",onChange(e,t){document.documentElement.style.setProperty("--abs-hover-bg-bounce-enabled",t?"1":"0")}},{id:"hoverBgBounceDuration",label:"BG Duration",stateKey:"hoverBgBounceDuration",type:"range",min:0,max:1200,step:10,default:450,format:e=>Math.round(e)+"ms",parse:parseFloat,hint:"Total duration of the hover background bounce (ms).",onChange(e,t){document.documentElement.style.setProperty("--abs-hover-bg-bounce-duration",Math.max(0,Math.round(t))+"ms")}},{id:"hoverBgBounceOvershoot",label:"BG Overshoot",stateKey:"hoverBgBounceOvershoot",type:"range",min:1,max:1.5,step:.005,default:1.12,format:e=>e.toFixed(3),parse:parseFloat,hint:"Peak scale during hover background bounce (>= 1.0).",onChange(e,t){document.documentElement.style.setProperty("--abs-hover-bg-bounce-overshoot",t+"")}},{id:"hoverBgBounceEndSize",label:"BG End Size",stateKey:"hoverBgBounceEndSize",type:"range",min:.8,max:1.2,step:.005,default:1,format:e=>e.toFixed(3),parse:parseFloat,hint:"Final settled scale for hover background (typically 1.0).",onChange(e,t){document.documentElement.style.setProperty("--abs-hover-bg-bounce-end-size",t+"")}},{type:"divider",label:"Hover Color",group:"Color"},{id:"linkHoverIntensityLight",label:"Tint (Light)",stateKey:"linkHoverIntensityLight",type:"range",min:0,max:.6,step:.01,default:.2,format:e=>(100*e).toFixed(1)+"%",parse:parseFloat,hint:"Cursor color mix percentage for hover backgrounds in light mode.",onChange(e,t){document.documentElement.style.setProperty("--abs-hover-intensity-light",(100*Math.max(0,Math.min(1,t))).toFixed(1)+"%")}},{id:"linkHoverIntensityDark",label:"Tint (Dark)",stateKey:"linkHoverIntensityDark",type:"range",min:0,max:.6,step:.01,default:.24,format:e=>(100*e).toFixed(1)+"%",parse:parseFloat,hint:"Cursor color mix percentage for hover backgrounds in dark mode.",onChange(e,t){document.documentElement.style.setProperty("--abs-hover-intensity-dark",(100*Math.max(0,Math.min(1,t))).toFixed(1)+"%")}},{id:"linkHoverIntensityActive",label:"Tint (Active)",stateKey:"linkHoverIntensityActive",type:"range",min:0,max:.4,step:.01,default:.18,format:e=>(100*e).toFixed(1)+"%",parse:parseFloat,hint:"Cursor color mix percentage while a link/button is active.",onChange(e,t){document.documentElement.style.setProperty("--abs-hover-intensity-active",(100*Math.max(0,Math.min(1,t))).toFixed(1)+"%")}},{type:"divider",label:"Edge Lighting",group:"Edge Lighting"},{id:"hoverEdgeEnabled",label:"Enabled",stateKey:"hoverEdgeEnabled",type:"checkbox",default:!0,format:e=>e?"On":"Off",parse:e=>!!e,group:"Edge Lighting",hint:"Master toggle for hover edge lighting effect",onChange(e,t){document.documentElement.style.setProperty("--hover-edge-enabled",t?"1":"0")}},{id:"hoverEdgeWidth",label:"Stroke Width",stateKey:"hoverEdgeWidth",type:"range",min:.1,max:3,step:.1,default:1,format:e=>e.toFixed(1)+"px",parse:parseFloat,group:"Edge Lighting",hint:"Width of the edge lighting stroke",onChange(e,t){document.documentElement.style.setProperty("--hover-edge-width",t+"px")}},{id:"hoverEdgeInset",label:"Inset",stateKey:"hoverEdgeInset",type:"range",min:0,max:4,step:.5,default:0,format:e=>e.toFixed(1)+"px",parse:parseFloat,group:"Edge Lighting",hint:"How far inside the element edge to draw",onChange(e,t){document.documentElement.style.setProperty("--hover-edge-inset",t+"px")}},{type:"divider",label:"Bottom Light",group:"Edge Lighting"},{id:"hoverEdgeBottomEnabled",label:"Enabled",stateKey:"hoverEdgeBottomEnabled",type:"checkbox",default:!0,format:e=>e?"On":"Off",parse:e=>!!e,group:"Edge Lighting",hint:"Primary upward light source",onChange(e,t){document.documentElement.style.setProperty("--hover-edge-bottom-enabled",t?"1":"0")}},{id:"hoverEdgeBottomRadius",label:"Size",stateKey:"hoverEdgeBottomRadius",type:"range",min:.5,max:3,step:.05,default:1.2,format:e=>e.toFixed(2)+"",parse:parseFloat,group:"Edge Lighting",hint:"Gradient radius (1.0 = element height)",onChange(e,t){document.documentElement.style.setProperty("--hover-edge-bottom-radius",t+"")}},{id:"hoverEdgeBottomOpacity",label:"Opacity",stateKey:"hoverEdgeBottomOpacity",type:"range",min:0,max:1,step:.02,default:.6,format:e=>Math.round(100*e)+"%",parse:parseFloat,group:"Edge Lighting",hint:"Light intensity at center",onChange(e,t){document.documentElement.style.setProperty("--hover-edge-bottom-opacity",t+"")}},{id:"hoverEdgeBottomColorMix",label:"Color Mix",stateKey:"hoverEdgeBottomColorMix",type:"range",min:0,max:100,step:5,default:70,format:e=>Math.round(e)+"%",parse:parseFloat,group:"Edge Lighting",hint:"How much cursor color vs white",onChange(e,t){document.documentElement.style.setProperty("--hover-edge-bottom-color-mix",t+"%")}},{type:"divider",label:"Top Light",group:"Edge Lighting"},{id:"hoverEdgeTopEnabled",label:"Enabled",stateKey:"hoverEdgeTopEnabled",type:"checkbox",default:!0,format:e=>e?"On":"Off",parse:e=>!!e,group:"Edge Lighting",hint:"Ambient downward light source",onChange(e,t){document.documentElement.style.setProperty("--hover-edge-top-enabled",t?"1":"0")}},{id:"hoverEdgeTopRadius",label:"Size",stateKey:"hoverEdgeTopRadius",type:"range",min:.5,max:3,step:.05,default:1,format:e=>e.toFixed(2)+"",parse:parseFloat,group:"Edge Lighting",hint:"Gradient radius (1.0 = element height)",onChange(e,t){document.documentElement.style.setProperty("--hover-edge-top-radius",t+"")}},{id:"hoverEdgeTopOpacity",label:"Opacity",stateKey:"hoverEdgeTopOpacity",type:"range",min:0,max:1,step:.02,default:.3,format:e=>Math.round(100*e)+"%",parse:parseFloat,group:"Edge Lighting",hint:"Light intensity at center",onChange(e,t){document.documentElement.style.setProperty("--hover-edge-top-opacity",t+"")}},{id:"hoverEdgeTopColorMix",label:"Color Mix",stateKey:"hoverEdgeTopColorMix",type:"range",min:0,max:100,step:5,default:50,format:e=>Math.round(e)+"%",parse:parseFloat,group:"Edge Lighting",hint:"How much cursor color vs white",onChange(e,t){document.documentElement.style.setProperty("--hover-edge-top-color-mix",t+"%")}}]},scene:{title:"Scene Impact",icon:"",defaultOpen:!1,controls:[{id:"sceneImpactEnabled",label:"Enabled",stateKey:"sceneImpactEnabled",type:"checkbox",default:!0,hint:"If disabled, mode changes will not animate the scene."},{id:"sceneImpactMul",label:"Click Depth",stateKey:"sceneImpactMul",type:"range",min:0,max:.05,step:.001,default:.01,format:e=>e.toFixed(3),parse:parseFloat,hint:"How far the entire scene presses in on simulation change.",onChange(e,t){const a=document.getElementById("abs-scene");if(!a)return;const o=e||{},n=+o.sceneImpactMobileMulFactor;a.style.setProperty("--abs-scene-impact-mul",+t*((o.isMobile||o.isMobileViewport)&&Number.isFinite(n)&&n>0?n:1)+"")}},{id:"sceneImpactLogoCompMul",label:"Logo Comp",stateKey:"sceneImpactLogoCompMul",type:"range",min:.25,max:6,step:.05,default:3.6,format:e=>e.toFixed(2)+"x",parse:parseFloat,hint:'How strongly the logo counter-scales against the scene press (higher = logo feels more "anchored").',onChange(e,t){const a=document.getElementById("abs-scene");if(!a)return;const o=+t;a.style.setProperty("--abs-scene-impact-logo-comp-mul",(Number.isFinite(o)&&o>0?o:1)+"")}},{id:"sceneImpactMobileMulFactor",label:"Mobile Depth ",stateKey:"sceneImpactMobileMulFactor",type:"range",min:.25,max:3,step:.05,default:1,format:e=>e.toFixed(2)+"x",parse:parseFloat,hint:"Multiplier applied to Click Depth on mobile-sized viewports.",onChange(e,t){const a=document.getElementById("abs-scene");if(!a)return;const o=e||{},n=+o.sceneImpactMul,i=+t;a.style.setProperty("--abs-scene-impact-mul",(Number.isFinite(n)?n:0)*((o.isMobile||o.isMobileViewport)&&Number.isFinite(i)&&i>0?i:1)+"")}},{id:"sceneImpactPressMs",label:"Press",stateKey:"sceneImpactPressMs",type:"range",min:20,max:300,step:5,default:90,format:e=>Math.round(e)+"ms",parse:e=>parseInt(e,10),hint:"Press-in duration."},{id:"sceneImpactReleaseMs",label:"Release",stateKey:"sceneImpactReleaseMs",type:"range",min:40,max:1200,step:10,default:310,format:e=>Math.round(e)+"ms",parse:e=>parseInt(e,10),hint:"Release duration (bounce out length)."},{id:"sceneImpactAnticipation",label:"Anticipation",stateKey:"sceneImpactAnticipation",type:"range",min:0,max:.6,step:.01,default:0,format:e=>e.toFixed(2),parse:parseFloat,hint:"Micro pre-pop before the click-in (0 = off)."},{id:"sceneChangeSoundEnabled",label:"Scene Sound",stateKey:"sceneChangeSoundEnabled",type:"checkbox",default:!0,hint:"Plays a soft pebble-like tick when switching simulations (only if sound is enabled)."},{id:"sceneChangeSoundIntensity",label:"Scene Sound Intensity",stateKey:"sceneChangeSoundIntensity",type:"range",min:0,max:1,step:.01,default:.35,format:e=>e.toFixed(2),parse:parseFloat},{id:"sceneChangeSoundRadius",label:"Scene Sound Pitch",stateKey:"sceneChangeSoundRadius",type:"range",min:6,max:60,step:1,default:18,format:e=>""+Math.round(e),parse:e=>parseInt(e,10),hint:"Higher = lower pitch (maps like ball size)."}]},overlay:{title:"Depth & Blur",icon:"",defaultOpen:!1,controls:[{id:"modalOverlayEnabled",label:"Enabled",stateKey:"modalOverlayEnabled",type:"checkbox",default:!0},{id:"modalOverlayOpacity",label:"White Wash",stateKey:"modalOverlayOpacity",type:"range",min:0,max:.1,step:.001,default:.01,format:e=>e.toFixed(3),parse:parseFloat,onChange(e,t){Promise.resolve().then(()=>bl).then(({updateOverlayOpacity:e})=>{e(t)})}},{id:"modalOverlayBlurPx",label:"Blur Amount",stateKey:"modalOverlayBlurPx",type:"range",min:0,max:30,step:.5,default:8,format:e=>e.toFixed(1)+"px",parse:parseFloat,hint:"Backdrop blur strength (0 = off)",onChange(e,t){Promise.resolve().then(()=>bl).then(({updateOverlayBlur:e})=>{e(t)})}},{id:"modalOverlayTransitionMs",label:"Anim In Speed",stateKey:"modalOverlayTransitionMs",type:"range",min:200,max:1500,step:50,default:800,format:e=>Math.round(e)+"ms",parse:e=>parseInt(e,10),hint:"Duration for blur & depth zoom when opening",onChange(e,t){Promise.resolve().then(()=>bl).then(({updateOverlayTransition:e})=>{e(t)})}},{id:"modalOverlayTransitionOutMs",label:"Anim Out Speed",stateKey:"modalOverlayTransitionOutMs",type:"range",min:200,max:1200,step:50,default:600,format:e=>Math.round(e)+"ms",parse:e=>parseInt(e,10),hint:"Duration for blur & depth zoom when closing",onChange(e,t){Promise.resolve().then(()=>bl).then(({updateOverlayTransitionOut:e})=>{e(t)})}},{id:"modalOverlayContentDelayMs",label:"Content Delay",stateKey:"modalOverlayContentDelayMs",type:"range",min:0,max:1e3,step:50,default:200,format:e=>Math.round(e)+"ms",parse:e=>parseInt(e,10),hint:"Wait before showing dialog content",onChange(e,t){Promise.resolve().then(()=>bl).then(({updateGateContentDelay:e})=>{e(t)})}},{id:"modalDepthScale",label:"Depth Scale",stateKey:"modalDepthScale",type:"range",min:.9,max:1,step:.001,default:.96,format:e=>e.toFixed(3),parse:parseFloat,hint:"Scene scale when gate opens (0.9-1.0)",onChange(e,t){Promise.resolve().then(()=>bl).then(({updateGateDepthScale:e})=>{e(t)})}},{id:"gateDepthTranslateY",label:"Depth Shift",stateKey:"modalDepthTranslateY",type:"range",min:0,max:30,step:1,default:8,format:e=>Math.round(e)+"px",parse:parseInt,hint:"Vertical shift when gate opens",onChange(e,t){Promise.resolve().then(()=>bl).then(({updateGateDepthTranslateY:e})=>{e(t)})}},{id:"logoBlurInactive",label:"Logo Blur Closed",stateKey:"logoBlurInactive",type:"range",min:0,max:20,step:.5,default:0,format:e=>e.toFixed(1)+"px",parse:parseFloat,hint:"Logo blur when gate is closed (0 = sharp)",onChange(e,t){Promise.resolve().then(()=>bl).then(({updateLogoBlurInactive:e})=>{e(t)})}},{id:"logoBlurActive",label:"Logo Blur Open",stateKey:"logoBlurActive",type:"range",min:0,max:30,step:.5,default:12,format:e=>e.toFixed(1)+"px",parse:parseFloat,hint:"Logo blur when gate is active (12px = soft blur)",onChange(e,t){Promise.resolve().then(()=>bl).then(({updateLogoBlurActive:e})=>{e(t)})}}]},videoOverlay:{title:"Video Overlay",icon:"",defaultOpen:!1,controls:[{id:"grungeVideoEnabled",label:"Enabled",stateKey:"grungeVideoEnabled",type:"checkbox",default:!0,hint:"Enable/disable the grunge video overlay effect",onChange(e,t){document.querySelectorAll(".grunge-video-overlay").forEach(e=>{e.style.display=t?"":"none"})}},{id:"grungeVideoOpacityLight",label:"Opacity (Light)",stateKey:"grungeVideoOpacityLight",type:"range",min:0,max:1,step:.01,default:.8,format:e=>e.toFixed(2),parse:parseFloat,hint:"Video overlay opacity in light mode (0 = invisible, 1 = full)",onChange(e,t){document.documentElement.style.setProperty("--grunge-video-opacity-light",t+"")}},{id:"grungeVideoOpacityDark",label:"Opacity (Dark)",stateKey:"grungeVideoOpacityDark",type:"range",min:0,max:1,step:.01,default:.12,format:e=>e.toFixed(2),parse:parseFloat,hint:"Video overlay opacity in dark mode (0 = invisible, 1 = full)",onChange(e,t){document.documentElement.style.setProperty("--grunge-video-opacity-dark",t+"")}},{id:"grungeVideoBlendModeLight",label:"Blend (Light)",stateKey:"grungeVideoBlendModeLight",type:"select",options:[{value:"overlay",label:"Overlay (Contrast)"},{value:"screen",label:"Screen (Lighten)"},{value:"multiply",label:"Multiply (Darken)"},{value:"soft-light",label:"Soft Light (Subtle)"},{value:"hard-light",label:"Hard Light (Intense)"},{value:"lighten",label:"Lighten (Pick Lighter)"},{value:"darken",label:"Darken (Pick Darker)"},{value:"plus-lighter",label:"Plus Lighter (Additive)"},{value:"color-dodge",label:"Color Dodge (Bright)"},{value:"color-burn",label:"Color Burn (Dark)"}],default:"overlay",hint:"Blend mode for light mode video",onChange(e,t){document.documentElement.style.setProperty("--grunge-video-blend-mode-light",t)}},{id:"grungeVideoBlendModeDark",label:"Blend (Dark)",stateKey:"grungeVideoBlendModeDark",type:"select",options:[{value:"screen",label:"Screen (Lighten)"},{value:"overlay",label:"Overlay (Contrast)"},{value:"multiply",label:"Multiply (Darken)"},{value:"soft-light",label:"Soft Light (Subtle)"},{value:"hard-light",label:"Hard Light (Intense)"},{value:"lighten",label:"Lighten (Pick Lighter)"},{value:"darken",label:"Darken (Pick Darker)"},{value:"plus-lighter",label:"Plus Lighter (Additive)"},{value:"color-dodge",label:"Color Dodge (Bright)"},{value:"color-burn",label:"Color Burn (Dark)"}],default:"screen",hint:"Blend mode for dark mode video",onChange(e,t){document.documentElement.style.setProperty("--grunge-video-blend-mode-dark",t)}},{id:"grungeVideoContrast",label:"Contrast",stateKey:"grungeVideoContrast",type:"range",min:.5,max:2,step:.05,default:1,precision:2,hint:"Video contrast (1 = normal, >1 = more contrast)",onChange(e,t){document.documentElement.style.setProperty("--grunge-video-contrast",t+"")}},{id:"grungeVideoBrightness",label:"Brightness",stateKey:"grungeVideoBrightness",type:"range",min:.5,max:2,step:.05,default:1,precision:2,hint:"Video brightness/exposure (1 = normal, >1 = brighter)",onChange(e,t){document.documentElement.style.setProperty("--grunge-video-brightness",t+"")}},{id:"grungeVideoSaturate",label:"Saturation",stateKey:"grungeVideoSaturate",type:"range",min:0,max:2,step:.05,default:1,precision:2,hint:"Video saturation (0 = grayscale, 1 = normal, >1 = vivid)",onChange(e,t){document.documentElement.style.setProperty("--grunge-video-saturate",t+"")}},{id:"grungeVideoHueRotate",label:"Hue Rotate",stateKey:"grungeVideoHueRotate",type:"range",min:0,max:360,step:1,default:0,precision:0,hint:"Rotate colors around the color wheel (0-360 degrees)",onChange(e,t){document.documentElement.style.setProperty("--grunge-video-hue-rotate",t+"deg")}},{id:"grungeVideoInvert",label:"Invert",stateKey:"grungeVideoInvert",type:"range",min:0,max:1,step:.05,default:0,precision:2,hint:"Invert colors (0 = normal, 1 = fully inverted)",onChange(e,t){document.documentElement.style.setProperty("--grunge-video-invert",t+"")}},{id:"grungeVideoSepia",label:"Sepia",stateKey:"grungeVideoSepia",type:"range",min:0,max:1,step:.05,default:0,precision:2,hint:"Sepia tone effect (0 = none, 1 = full sepia)",onChange(e,t){document.documentElement.style.setProperty("--grunge-video-sepia",t+"")}},{id:"grungeVideoGrayscale",label:"Grayscale",stateKey:"grungeVideoGrayscale",type:"range",min:0,max:1,step:.05,default:0,precision:2,hint:"Convert to grayscale (0 = color, 1 = black & white)",onChange(e,t){document.documentElement.style.setProperty("--grunge-video-grayscale",t+"")}},{id:"grungeVideoBlur",label:"Blur",stateKey:"grungeVideoBlur",type:"range",min:0,max:20,step:.5,default:0,precision:1,hint:"Blur effect in pixels (0 = sharp)",onChange(e,t){document.documentElement.style.setProperty("--grunge-video-blur",t+"px")}}]},layers:{title:"Layers & Edges",icon:"",defaultOpen:!1,controls:[{type:"divider",label:"Vertical Offset"},{id:"noiseOffsetY",label:"Noise Y Offset",stateKey:"noiseOffsetY",type:"range",min:-50,max:50,step:1,default:0,format:e=>e+"px",parse:parseFloat,hint:"Move noise layer up (negative) or down (positive)",onChange(e,t){document.documentElement.style.setProperty("--abs-noise-offset-y",t+"px")}},{id:"videoOffsetY",label:"Video Y Offset",stateKey:"videoOffsetY",type:"range",min:-50,max:50,step:1,default:0,format:e=>e+"px",parse:parseFloat,hint:"Move video layer up (negative) or down (positive)",onChange(e,t){document.documentElement.style.setProperty("--grunge-video-offset-y",t+"px")}},{type:"divider",label:"Wall Frame"},{id:"safariTintInset",label:"Outer Inset",stateKey:"safariTintInset",type:"range",min:0,max:40,step:1,default:20,format:e=>e+"px",parse:parseFloat,hint:"Distance from viewport edge to wall outer edge (px)",onChange(e,t){document.documentElement.style.setProperty("--safari-tint-inset",t+"px")}}]},colors:{title:"Color & Surface",icon:"",defaultOpen:!1,controls:[{type:"divider",label:"Backgrounds"},{id:"bgLight",label:"Light Mode",stateKey:"bgLight",type:"color",default:"#f5f5f5",hint:"Background color for light mode",onChange(e,t){document.documentElement.style.setProperty("--bg-light",t)}},{id:"bgDark",label:"Dark Mode",stateKey:"bgDark",type:"color",default:"#0a0a0a",hint:"Background color for dark mode",onChange(e,t){document.documentElement.style.setProperty("--bg-dark",t)}},{type:"divider",label:"Text  Light Mode"},{id:"textColorLight",label:"Primary",stateKey:"textColorLight",type:"color",default:"#161616",hint:"Main text color in light mode",onChange(e,t){document.documentElement.style.setProperty("--text-color-light",t)}},{id:"textColorLightMuted",label:"Muted",stateKey:"textColorLightMuted",type:"color",default:"#2f2f2f",hint:"Secondary/muted text in light mode",onChange(e,t){document.documentElement.style.setProperty("--text-color-light-muted",t)}},{type:"divider",label:"Text  Dark Mode"},{id:"textColorDark",label:"Primary",stateKey:"textColorDark",type:"color",default:"#b3b3b3",hint:"Main text color in dark mode",onChange(e,t){document.documentElement.style.setProperty("--text-color-dark",t)}},{id:"textColorDarkMuted",label:"Muted",stateKey:"textColorDarkMuted",type:"color",default:"#808080",hint:"Secondary/muted text in dark mode",onChange(e,t){document.documentElement.style.setProperty("--text-color-dark-muted",t)}},{type:"divider",label:"Links"},{id:"linkHoverColor",label:"Hover Accent",stateKey:"linkHoverColor",type:"color",default:"#ff4013",hint:"Link hover color (accent)",onChange(e,t){document.documentElement.style.setProperty("--link-hover-color",t)}},{type:"divider",label:"Logo"},{id:"topLogoWidthVw",label:"Logo Size",stateKey:"topLogoWidthVw",type:"range",min:15,max:45,step:.25,default:35,format:e=>parseFloat(e).toFixed(2)+"vw",parse:parseFloat,hint:"Top-center logo width (clamped by min/max tokens).",onChange(e,t){document.documentElement.style.setProperty("--top-logo-width-vw",t+"")}}]},colorDistribution:{title:"Palette Mix",icon:"",defaultOpen:!1,controls:[{id:"colorDistribution",label:"Disciplines",stateKey:"colorDistribution",type:"colorDistribution",labels:["Product Systems","Interaction Design","Creative Tech","AI Design","Design Direction","Art Direction","Prototyping"],hint:"Assign each discipline to a palette color, then set weights that sum to 100%. Used for all ball spawns across modes."}]},wallGeometry:{title:"Wall  Frame",icon:"",defaultOpen:!1,controls:[{id:"frameColorLight",label:"Color  Light Mode",stateKey:"frameColorLight",type:"color",default:"#242529",hint:"Wall color (unified across all modes, also used for browser chrome)",onChange(e,t){const a=document.documentElement;a.style.setProperty("--frame-color",t),a.style.setProperty("--frame-color-light",t),a.style.setProperty("--frame-color-dark",t),a.style.setProperty("--wall-color",t),a.style.setProperty("--wall-color-light",t),a.style.setProperty("--wall-color-dark",t),a.style.setProperty("--chrome-bg",t),a.style.setProperty("--chrome-bg-light",t),a.style.setProperty("--chrome-bg-dark",t),e.frameColor=t,e.frameColorLight=t,e.frameColorDark=t;const o=document.querySelector('meta[name="theme-color"]:not([media])');o&&(o.content=t);const n=document.querySelector('meta[name="theme-color"][media="(prefers-color-scheme: light)"]');n&&(n.content=t);const i=document.querySelector('meta[name="theme-color"][media="(prefers-color-scheme: dark)"]');i&&(i.content=t),Promise.resolve().then(()=>ks).then(e=>{e.syncChromeColor()})}},{id:"frameColorDark",label:"Color  Dark Mode",stateKey:"frameColorDark",type:"color",default:"#242529",hint:"Wall color (unified across all modes, also used for browser chrome)",onChange(e,t){const a=document.documentElement;a.style.setProperty("--frame-color",t),a.style.setProperty("--frame-color-light",t),a.style.setProperty("--frame-color-dark",t),a.style.setProperty("--wall-color",t),a.style.setProperty("--wall-color-light",t),a.style.setProperty("--wall-color-dark",t),a.style.setProperty("--chrome-bg",t),a.style.setProperty("--chrome-bg-light",t),a.style.setProperty("--chrome-bg-dark",t),e.frameColor=t,e.frameColorLight=t,e.frameColorDark=t;const o=document.querySelector('meta[name="theme-color"]:not([media])');o&&(o.content=t);const n=document.querySelector('meta[name="theme-color"][media="(prefers-color-scheme: light)"]');n&&(n.content=t);const i=document.querySelector('meta[name="theme-color"][media="(prefers-color-scheme: dark)"]');i&&(i.content=t),Promise.resolve().then(()=>ks).then(e=>{e.syncChromeColor()})}},{id:"wallThicknessVw",label:"Wall Thickness",stateKey:"wallThicknessVw",type:"range",min:0,max:8,step:.1,default:1.3,format:e=>e.toFixed(1)+"vw",parse:parseFloat,hint:"Wall tube thickness (content padding is layout-only)",onChange(){Promise.resolve().then(()=>Hn).then(e=>{e.applyLayoutFromVwToPx(),e.applyLayoutCSSVars(),Promise.resolve().then(()=>bl).then(({updateBlurFromWallThickness:e})=>{e()})})}},{id:"wallThicknessAreaMultiplier",label:"Area Scaling",stateKey:"wallThicknessAreaMultiplier",type:"range",min:0,max:2,step:.01,default:0,format:e=>e.toFixed(2)+"",parse:parseFloat,hint:"Area-based scaling multiplier (0.0 = vw-only, 1.0 = full area scaling, >1.0 = exaggerated)",onChange(){Promise.resolve().then(()=>Hn).then(e=>{e.applyLayoutFromVwToPx(),e.applyLayoutCSSVars(),Promise.resolve().then(()=>bl).then(({updateBlurFromWallThickness:e})=>{e()})})}},{id:"wallThicknessMinPx",label:"Thickness Min",stateKey:"wallThicknessMinPx",type:"range",min:0,max:100,step:1,default:12,format:e=>e+"px",parse:e=>parseInt(e,10),hint:"Minimum wall thickness clamp (for small viewports)",onChange(){Promise.resolve().then(()=>Hn).then(e=>{e.applyLayoutFromVwToPx(),e.applyLayoutCSSVars(),Promise.resolve().then(()=>bl).then(({updateBlurFromWallThickness:e})=>{e()})})}},{id:"wallThicknessMaxPx",label:"Thickness Max",stateKey:"wallThicknessMaxPx",type:"range",min:0,max:100,step:1,default:50,format:e=>e+"px",parse:e=>parseInt(e,10),hint:"Maximum wall thickness clamp (for large viewports)",onChange(){Promise.resolve().then(()=>Hn).then(e=>{e.applyLayoutFromVwToPx(),e.applyLayoutCSSVars(),Promise.resolve().then(()=>bl).then(({updateBlurFromWallThickness:e})=>{e()})})}},{id:"wallRadiusVw",label:"Corner Radius",stateKey:"wallRadiusVw",type:"range",min:0,max:12,step:.1,default:3.7,format:e=>e.toFixed(1)+"vw",parse:parseFloat,onChange(){Promise.resolve().then(()=>Hn).then(e=>{e.applyLayoutFromVwToPx(),e.applyLayoutCSSVars()})}},{id:"wallInset",label:"Collision Inset",stateKey:"wallInset",type:"range",min:0,max:20,step:1,default:2,format:e=>e+"px",parse:e=>parseInt(e,10),hint:"Physics padding inside the visual wall"},{id:"mobileWallThicknessXFactor",label:"Mobile L/R Thickness",stateKey:"mobileWallThicknessXFactor",type:"range",min:.5,max:3,step:.05,default:1.4,format:e=>e.toFixed(2)+"",parse:parseFloat,hint:"Wall thickness multiplier for LEFT/RIGHT sides on mobile",onChange(){Promise.resolve().then(()=>Hn).then(e=>{e.applyLayoutFromVwToPx(),e.applyLayoutCSSVars()})}},{id:"mobileEdgeLabelsVisible",label:"Mobile Edge Labels",stateKey:"mobileEdgeLabelsVisible",type:"toggle",default:!0,hint:"Show side edge labels on mobile (chapter/copyright)",onChange(){Promise.resolve().then(()=>Hn).then(e=>{e.applyLayoutCSSVars()})}},{id:"mobileEdgeLabelSizeFactor",label:"Mobile Label Size",stateKey:"mobileEdgeLabelSizeFactor",type:"range",min:.3,max:2,step:.05,default:.85,format:e=>e.toFixed(2)+"",parse:parseFloat,hint:"Font size multiplier for edge labels on mobile",onChange(){Promise.resolve().then(()=>Hn).then(e=>{e.applyLayoutCSSVars()})}},{id:"mobileEdgeLabelOpacity",label:"Mobile Label Opacity",stateKey:"mobileEdgeLabelOpacity",type:"range",min:0,max:1,step:.05,default:.5,format:e=>(100*e).toFixed(0)+"%",parse:parseFloat,hint:"Opacity for edge labels on mobile",onChange(){Promise.resolve().then(()=>Hn).then(e=>{e.applyLayoutCSSVars()})}},{id:"restitution",label:"Bounce",stateKey:"restitution",type:"range",min:.3,max:.95,step:.05,default:.7,format:e=>Math.round(100*e)+"%",parse:parseFloat,group:"Wall Material",hint:"Energy kept on bounce. 100% = elastic, 30% = soft"}]},outerWall:{title:"Outer Wall",icon:"",defaultOpen:!1,controls:[{id:"outerWallEdgeEnabled",label:"Enable Outer Wall",stateKey:"outerWallEdgeEnabled",type:"checkbox",default:!0,format:e=>e?"On":"Off",parse:e=>!!e,hint:"Show outer wall (creates depth between walls)",onChange(e,t){const a=document.getElementById("bravia-balls");a&&a.classList.toggle("outer-wall-edge-disabled",!t)}},{type:"divider",label:" Edge Lighting"},{id:"outerWallEdgeWidth",label:"Edge Width",stateKey:"outerWallEdgeWidth",type:"range",min:.1,max:8,step:.1,default:3,format:e=>e.toFixed(1)+"px",parse:parseFloat,hint:"Thickness of edge gradient strips",onChange(e,t){document.documentElement.style.setProperty("--outer-wall-edge-width",t+"px"),xo().then(e=>e?.())}},{id:"outerWallGradientRadius",label:"Gradient Spread",stateKey:"outerWallGradientRadius",type:"range",min:30,max:100,step:5,default:70,format:e=>e+"%",parse:parseFloat,hint:"How far the radial gradient spreads",onChange(){xo().then(e=>e?.())}},{id:"outerWallTopDarkOpacityLight",label:"Top Shadow ",stateKey:"outerWallTopDarkOpacityLight",type:"range",min:0,max:1,step:.02,default:.5,format:e=>Math.round(100*e)+"%",parse:parseFloat,hint:"Top edge shadow opacity (light mode)",onChange(e,t){document.body.classList.contains("dark-mode")||document.documentElement.style.setProperty("--outer-wall-top-dark-opacity",t+""),xo().then(e=>e?.())}},{id:"outerWallTopDarkOpacityDark",label:"Top Shadow ",stateKey:"outerWallTopDarkOpacityDark",type:"range",min:0,max:1,step:.02,default:.4,format:e=>Math.round(100*e)+"%",parse:parseFloat,hint:"Top edge shadow opacity (dark mode)",onChange(e,t){document.body.classList.contains("dark-mode")&&document.documentElement.style.setProperty("--outer-wall-top-dark-opacity",t+""),xo().then(e=>e?.())}},{id:"outerWallBottomLightOpacityLight",label:"Bottom Light ",stateKey:"outerWallBottomLightOpacityLight",type:"range",min:0,max:1,step:.02,default:.8,format:e=>Math.round(100*e)+"%",parse:parseFloat,hint:"Bottom edge shine opacity (light mode)",onChange(e,t){document.body.classList.contains("dark-mode")||document.documentElement.style.setProperty("--outer-wall-bottom-light-opacity",t+""),xo().then(e=>e?.())}},{id:"outerWallBottomLightOpacityDark",label:"Bottom Light ",stateKey:"outerWallBottomLightOpacityDark",type:"range",min:0,max:1,step:.02,default:.6,format:e=>Math.round(100*e)+"%",parse:parseFloat,hint:"Bottom edge shine opacity (dark mode)",onChange(e,t){document.body.classList.contains("dark-mode")&&document.documentElement.style.setProperty("--outer-wall-bottom-light-opacity",t+""),xo().then(e=>e?.())}},{id:"outerWallTopDarkColor",label:"Top Shadow Color",stateKey:"outerWallTopDarkColor",type:"color",default:"#000000",hint:"Color of top edge shadow gradient",onChange(e,t){const a=wo(t);document.documentElement.style.setProperty("--outer-wall-top-dark-rgb",a),xo().then(e=>e?.())}},{id:"outerWallBottomLightColor",label:"Bottom Light Color",stateKey:"outerWallBottomLightColor",type:"color",default:"#ffffff",hint:"Color of bottom edge light gradient",onChange(e,t){const a=wo(t);document.documentElement.style.setProperty("--outer-wall-bottom-light-rgb",a),xo().then(e=>e?.())}},{type:"divider",label:" Depth Shadow"},{id:"outerWallCastShadowOpacityLight",label:"Shadow ",stateKey:"outerWallCastShadowOpacityLight",type:"range",min:0,max:.5,step:.01,default:.15,format:e=>Math.round(100*e)+"%",parse:parseFloat,hint:"Inward shadow opacity (light mode)",onChange(e,t){document.body.classList.contains("dark-mode")||document.documentElement.style.setProperty("--outer-wall-cast-shadow-opacity",t+"")}},{id:"outerWallCastShadowOpacityDark",label:"Shadow ",stateKey:"outerWallCastShadowOpacityDark",type:"range",min:0,max:.5,step:.01,default:.25,format:e=>Math.round(100*e)+"%",parse:parseFloat,hint:"Inward shadow opacity (dark mode)",onChange(e,t){document.body.classList.contains("dark-mode")&&document.documentElement.style.setProperty("--outer-wall-cast-shadow-opacity",t+"")}},{id:"outerWallCastShadowBlur",label:"Shadow Blur",stateKey:"outerWallCastShadowBlur",type:"range",min:0,max:40,step:1,default:12,format:e=>e+"px",parse:parseFloat,hint:"Softness of inward shadow",onChange(e,t){document.documentElement.style.setProperty("--outer-wall-cast-shadow-blur",t+"px")}},{id:"outerWallCastShadowOffset",label:"Shadow Offset",stateKey:"outerWallCastShadowOffset",type:"range",min:0,max:15,step:1,default:3,format:e=>e+"px",parse:parseFloat,hint:"Vertical offset of shadow",onChange(e,t){document.documentElement.style.setProperty("--outer-wall-cast-shadow-offset",t+"px")}},{type:"divider",label:" Geometry"},{id:"outerWallRadiusAdjust",label:"Corner Adjust",stateKey:"outerWallRadiusAdjust",type:"range",min:-5,max:10,step:1,default:2,format:e=>e+"px",parse:parseFloat,hint:"Fine-tune outer wall corner roundness",onChange(e,t){document.documentElement.style.setProperty("--outer-wall-radius-adjust",t+"px")}}]},innerWall:{title:"Inner Wall",icon:"",defaultOpen:!1,controls:[{type:"divider",label:" Edge Lighting"},{id:"innerWallTopBevelWidth",label:"Edge Width",stateKey:"innerWallTopBevelWidth",type:"range",min:.1,max:6,step:.1,default:2,format:e=>e.toFixed(1)+"px",parse:parseFloat,hint:"Thickness of edge gradient strips",onChange(e,t){document.documentElement.style.setProperty("--inner-wall-gradient-edge-width",t+"px"),xo().then(e=>e?.())}},{id:"innerWallGradientRadius",label:"Gradient Spread",stateKey:"innerWallGradientRadius",type:"range",min:30,max:100,step:5,default:70,format:e=>e+"%",parse:parseFloat,hint:"How far the radial gradient spreads",onChange(e,t){document.documentElement.style.setProperty("--inner-wall-gradient-radius",t+""),xo().then(e=>e?.())}},{id:"innerWallTopLightOpacityLight",label:"Top Light ",stateKey:"innerWallTopLightOpacityLight",type:"range",min:0,max:1,step:.02,default:.3,format:e=>Math.round(100*e)+"%",parse:parseFloat,hint:"Top edge light opacity (light mode)",onChange(e,t){document.body.classList.contains("dark-mode")||document.documentElement.style.setProperty("--inner-wall-top-light-opacity",t+""),xo().then(e=>e?.())}},{id:"innerWallTopLightOpacityDark",label:"Top Light ",stateKey:"innerWallTopLightOpacityDark",type:"range",min:0,max:1,step:.02,default:.4,format:e=>Math.round(100*e)+"%",parse:parseFloat,hint:"Top edge light opacity (dark mode)",onChange(e,t){document.body.classList.contains("dark-mode")&&document.documentElement.style.setProperty("--inner-wall-top-light-opacity",t+""),xo().then(e=>e?.())}},{id:"innerWallTopBevelOpacityLight",label:"Bottom Shadow ",stateKey:"innerWallTopBevelOpacityLight",type:"range",min:0,max:.5,step:.02,default:.18,format:e=>Math.round(100*e)+"%",parse:parseFloat,hint:"Bottom edge shadow opacity (light mode)",onChange(e,t){document.body.classList.contains("dark-mode")||document.documentElement.style.setProperty("--inner-wall-bottom-shadow-opacity",t+""),xo().then(e=>e?.())}},{id:"innerWallTopBevelOpacityDark",label:"Bottom Shadow ",stateKey:"innerWallTopBevelOpacityDark",type:"range",min:0,max:.5,step:.02,default:.25,format:e=>Math.round(100*e)+"%",parse:parseFloat,hint:"Bottom edge shadow opacity (dark mode)",onChange(e,t){document.body.classList.contains("dark-mode")&&document.documentElement.style.setProperty("--inner-wall-bottom-shadow-opacity",t+""),xo().then(e=>e?.())}},{id:"innerWallTopLightColor",label:"Top Light Color",stateKey:"innerWallTopLightColor",type:"color",default:"#ffffff",hint:"Color of top edge light gradient",onChange(e,t){const a=wo(t);document.documentElement.style.setProperty("--inner-wall-top-light-rgb",a),xo().then(e=>e?.())}},{id:"innerWallBottomShadowColor",label:"Bottom Shadow Color",stateKey:"innerWallBottomShadowColor",type:"color",default:"#000000",hint:"Color of bottom edge shadow gradient",onChange(e,t){const a=wo(t);document.documentElement.style.setProperty("--inner-wall-bottom-shadow-rgb",a),xo().then(e=>e?.())}},{type:"divider",label:" Outward Shadow"},{id:"innerWallOutwardShadowOpacityLight",label:"Shadow ",stateKey:"innerWallOutwardShadowOpacityLight",type:"range",min:0,max:.8,step:.02,default:.2,format:e=>Math.round(100*e)+"%",parse:parseFloat,hint:"Outward shadow opacity (light mode)",onChange(e,t){document.body.classList.contains("dark-mode")||document.documentElement.style.setProperty("--inner-wall-outward-shadow-opacity",t+"")}},{id:"innerWallOutwardShadowOpacityDark",label:"Shadow ",stateKey:"innerWallOutwardShadowOpacityDark",type:"range",min:0,max:.8,step:.02,default:.35,format:e=>Math.round(100*e)+"%",parse:parseFloat,hint:"Outward shadow opacity (dark mode)",onChange(e,t){document.documentElement.style.setProperty("--inner-wall-outward-shadow-opacity-dark",t+""),document.body.classList.contains("dark-mode")&&document.documentElement.style.setProperty("--inner-wall-outward-shadow-opacity",t+"")}},{id:"innerWallOutwardShadowBlur",label:"Shadow Blur",stateKey:"innerWallOutwardShadowBlur",type:"range",min:0,max:30,step:1,default:8,format:e=>e+"px",parse:parseFloat,hint:"Softness of outward shadow",onChange(e,t){document.documentElement.style.setProperty("--inner-wall-outward-shadow-blur",t+"px")}},{id:"innerWallOutwardShadowOffset",label:"Shadow Offset",stateKey:"innerWallOutwardShadowOffset",type:"range",min:-5,max:10,step:1,default:2,format:e=>e+"px",parse:parseFloat,hint:"Vertical offset of shadow",onChange(e,t){document.documentElement.style.setProperty("--inner-wall-outward-shadow-offset",t+"px")}},{type:"divider",label:" Inner Glow"},{id:"innerWallInnerGlowOpacityLight",label:"Glow ",stateKey:"innerWallInnerGlowOpacityLight",type:"range",min:0,max:.5,step:.01,default:0,format:e=>Math.round(100*e)+"%",parse:parseFloat,hint:"Soft white inner glow opacity (light mode)",onChange(e,t){document.body.classList.contains("dark-mode")||document.documentElement.style.setProperty("--inner-wall-inner-glow-opacity",t+""),xo().then(e=>e?.())}},{id:"innerWallInnerGlowOpacityDark",label:"Glow ",stateKey:"innerWallInnerGlowOpacityDark",type:"range",min:0,max:.5,step:.01,default:.08,format:e=>Math.round(100*e)+"%",parse:parseFloat,hint:"Soft white inner glow opacity (dark mode)",onChange(e,t){document.documentElement.style.setProperty("--inner-wall-inner-glow-opacity-dark",t+""),document.body.classList.contains("dark-mode")&&document.documentElement.style.setProperty("--inner-wall-inner-glow-opacity",t+""),xo().then(e=>e?.())}},{id:"innerWallInnerGlowBlur",label:"Glow Blur",stateKey:"innerWallInnerGlowBlur",type:"range",min:0,max:100,step:1,default:30,format:e=>e+"px",parse:parseFloat,hint:"Blur/softness of the glow",onChange(e,t){document.documentElement.style.setProperty("--inner-wall-inner-glow-blur",t+"px"),xo().then(e=>e?.())}},{id:"innerWallInnerGlowSpread",label:"Glow Spread",stateKey:"innerWallInnerGlowSpread",type:"range",min:-20,max:20,step:1,default:-5,format:e=>e+"px",parse:parseFloat,hint:"Spread (negative tightens to edges)",onChange(){xo().then(e=>e?.())}},{id:"innerWallInnerGlowOffsetY",label:"Glow Offset Y",stateKey:"innerWallInnerGlowOffsetY",type:"range",min:-50,max:50,step:1,default:0,format:e=>e+"px",parse:parseFloat,hint:"Vertical bias (+ = top brighter, - = bottom brighter)",onChange(){xo().then(e=>e?.())}},{id:"innerWallInnerGlowColor",label:"Glow Color",stateKey:"innerWallInnerGlowColor",type:"color",default:"#ffffff",hint:"Color of the inner glow",onChange(e,t){const a=wo(t);document.documentElement.style.setProperty("--inner-wall-inner-glow-rgb",a),xo().then(e=>e?.())}}]},noise:{title:"Grain",icon:"",defaultOpen:!1,controls:[{id:"noiseEnabled",label:"Enabled",stateKey:"noiseEnabled",type:"checkbox",default:!0,format:e=>e?"On":"Off",parse:e=>!!e,group:"Render",hint:"Procedural noise texture (no GIF).",onChange:(e,t)=>vo({noiseEnabled:t})},{id:"noiseSeed",label:"Seed",stateKey:"noiseSeed",type:"range",min:0,max:999999,step:1,default:1337,format:e=>Math.round(e)+"",parse:e=>parseInt(e,10),group:"Texture",hint:"Changes the generated grain pattern.",onChange:(e,t)=>vo({noiseSeed:t})},{id:"noiseTextureSize",label:"Tile Size",stateKey:"noiseTextureSize",type:"range",min:64,max:512,step:32,default:256,format:e=>Math.round(e)+" px",parse:e=>parseInt(e,10),group:"Texture",hint:"Bigger tiles reduce repetition but cost more memory.",onChange:(e,t)=>vo({noiseTextureSize:t})},{id:"noiseDistribution",label:"Distribution",stateKey:"noiseDistribution",type:"select",options:[{value:"gaussian",label:"Gaussian (filmic)"},{value:"uniform",label:"Uniform (flat)"}],default:"gaussian",format:e=>e+"",parse:e=>e+"",group:"Texture",onChange:(e,t)=>vo({noiseDistribution:t})},{id:"noiseMonochrome",label:"Monochrome",stateKey:"noiseMonochrome",type:"checkbox",default:!0,format:e=>e?"On":"Off",parse:e=>!!e,group:"Texture",hint:"Off = subtle RGB grain.",onChange:(e,t)=>vo({noiseMonochrome:t})},{id:"noiseChroma",label:"Chroma",stateKey:"noiseChroma",type:"range",min:0,max:1,step:.01,default:.9,format:e=>Math.round(100*e)+"%",parse:parseFloat,group:"Texture",hint:"How different R/G/B channels are (ignored when Monochrome is on).",onChange:(e,t)=>vo({noiseChroma:t})},{id:"noiseSize",label:"Grain Size",stateKey:"noiseSize",type:"range",min:20,max:600,step:5,default:85,format:e=>Math.round(e)+" px",parse:e=>parseInt(e,10),group:"Layer",onChange:(e,t)=>vo({noiseSize:t})},{id:"noiseOpacityLight",label:"Opacity (Light)",stateKey:"noiseOpacityLight",type:"range",min:0,max:1,step:.01,default:.08,format:e=>Math.round(100*e)+"%",parse:parseFloat,group:"Layer",onChange:(e,t)=>vo({noiseOpacityLight:t})},{id:"noiseOpacityDark",label:"Opacity (Dark)",stateKey:"noiseOpacityDark",type:"range",min:0,max:1,step:.01,default:.12,format:e=>Math.round(100*e)+"%",parse:parseFloat,group:"Layer",onChange:(e,t)=>vo({noiseOpacityDark:t})},{id:"noiseBlendMode",label:"Blend Mode",stateKey:"noiseBlendMode",type:"select",options:[{value:"normal",label:"Normal (Off)"},{value:"multiply",label:"Multiply"},{value:"screen",label:"Screen"},{value:"overlay",label:"Overlay"},{value:"darken",label:"Darken"},{value:"lighten",label:"Lighten"},{value:"color-dodge",label:"Color Dodge"},{value:"color-burn",label:"Color Burn"},{value:"hard-light",label:"Hard Light"},{value:"soft-light",label:"Soft Light"},{value:"difference",label:"Difference"},{value:"exclusion",label:"Exclusion"}],default:"overlay",format:e=>e+"",parse:e=>e+"",group:"Layer",onChange:(e,t)=>vo({noiseBlendMode:t})},{id:"noiseColorLight",label:"Color (Light)",stateKey:"noiseColorLight",type:"color",default:"#ffffff",format:e=>e+"",parse:e=>e+"",group:"Layer",onChange:(e,t)=>vo({noiseColorLight:t})},{id:"noiseColorDark",label:"Color (Dark)",stateKey:"noiseColorDark",type:"color",default:"#ffffff",format:e=>e+"",parse:e=>e+"",group:"Layer",onChange:(e,t)=>vo({noiseColorDark:t})},{id:"noiseMotion",label:"Motion",stateKey:"noiseMotion",type:"select",options:[{value:"jitter",label:"Jitter (film grain)"},{value:"drift",label:"Drift (slow pan)"},{value:"static",label:"Static"}],default:"jitter",format:e=>e+"",parse:e=>e+"",group:"Motion",onChange:(e,t)=>vo({noiseMotion:t})},{id:"noiseMotionAmount",label:"Motion Amount",stateKey:"noiseMotionAmount",type:"range",min:0,max:2.5,step:.01,default:1,format:e=>e.toFixed(2)+"x",parse:parseFloat,group:"Motion",onChange:(e,t)=>vo({noiseMotionAmount:t})},{id:"noiseSpeedMs",label:"Speed",stateKey:"noiseSpeedMs",type:"range",min:0,max:1e4,step:50,default:1100,format:e=>Math.round(e)+" ms",parse:e=>parseInt(e,10),group:"Motion",onChange:(e,t)=>vo({noiseSpeedMs:t})},{id:"noiseSpeedVariance",label:"Timing Variance",stateKey:"noiseSpeedVariance",type:"range",min:0,max:1,step:.01,default:0,format:e=>Math.round(100*e)+"%",parse:parseFloat,group:"Motion",hint:"Adds randomness to animation timing (0 = no variance, 1 = max variance)",onChange:(e,t)=>vo({noiseSpeedVariance:t})},{id:"noiseFlicker",label:"Flicker",stateKey:"noiseFlicker",type:"range",min:0,max:1,step:.01,default:.12,format:e=>Math.round(100*e)+"%",parse:parseFloat,group:"Motion",onChange:(e,t)=>vo({noiseFlicker:t})},{id:"noiseFlickerSpeedMs",label:"Flicker Speed",stateKey:"noiseFlickerSpeedMs",type:"range",min:0,max:5e3,step:20,default:220,format:e=>Math.round(e)+" ms",parse:e=>parseInt(e,10),group:"Motion",onChange:(e,t)=>vo({noiseFlickerSpeedMs:t})},{id:"noiseBlurPx",label:"Blur",stateKey:"noiseBlurPx",type:"range",min:0,max:6,step:.05,default:0,format:e=>e.toFixed(2)+" px",parse:parseFloat,group:"Look",onChange:(e,t)=>vo({noiseBlurPx:t})},{id:"noiseContrast",label:"Contrast",stateKey:"noiseContrast",type:"range",min:.25,max:3,step:.05,default:1.35,format:e=>e.toFixed(2)+"x",parse:parseFloat,group:"Look",onChange:(e,t)=>vo({noiseContrast:t})},{id:"noiseBrightness",label:"Brightness",stateKey:"noiseBrightness",type:"range",min:.25,max:2,step:.01,default:1,format:e=>e.toFixed(2)+"x",parse:parseFloat,group:"Look",onChange:(e,t)=>vo({noiseBrightness:t})},{id:"noiseSaturation",label:"Saturation",stateKey:"noiseSaturation",type:"range",min:0,max:3,step:.01,default:1,format:e=>e.toFixed(2)+"x",parse:parseFloat,group:"Look",onChange:(e,t)=>vo({noiseSaturation:t})},{id:"noiseHue",label:"Hue Rotate",stateKey:"noiseHue",type:"range",min:0,max:360,step:1,default:0,format:e=>Math.round(e)+"",parse:e=>parseInt(e,10),group:"Look",onChange:(e,t)=>vo({noiseHue:t})}]},critters:{title:"Hive",icon:"",mode:"critters",defaultOpen:!1,controls:[{type:"divider",label:"Population"},{id:"critterCount",label:"Count",stateKey:"critterCount",type:"range",min:10,max:260,step:5,default:90,format:e=>Math.round(e)+"",parse:e=>parseInt(e,10),reinitMode:!0},{type:"divider",label:"Movement"},{id:"critterSpeed",label:"Speed",stateKey:"critterSpeed",type:"range",min:0,max:1800,step:10,default:680,format:e=>""+Math.round(e),parse:parseFloat},{id:"critterMaxSpeed",label:"Max Speed",stateKey:"critterMaxSpeed",type:"range",min:200,max:4e3,step:25,default:1400,format:e=>""+Math.round(e),parse:parseFloat},{id:"critterStepHz",label:"Step Rate",stateKey:"critterStepHz",type:"range",min:0,max:16,step:.1,default:5,format:e=>e.toFixed(1)+" Hz",parse:parseFloat},{id:"critterStepSharpness",label:"Step Sharpness",stateKey:"critterStepSharpness",type:"range",min:.5,max:6,step:.1,default:2.4,format:e=>e.toFixed(1),parse:parseFloat},{id:"critterTurnNoise",label:"Wander",stateKey:"critterTurnNoise",type:"range",min:0,max:8,step:.1,default:2.2,format:e=>e.toFixed(1),parse:parseFloat},{id:"critterTurnDamp",label:"Turn Inertia",stateKey:"critterTurnDamp",type:"range",min:.5,max:30,step:.5,default:10,format:e=>e.toFixed(1),parse:parseFloat},{id:"critterTurnSeek",label:"Steering",stateKey:"critterTurnSeek",type:"range",min:0,max:30,step:.5,default:10,format:e=>e.toFixed(1),parse:parseFloat},{type:"divider",label:"Avoidance"},{id:"critterAvoidRadius",label:"Avoid Radius",stateKey:"critterAvoidRadius",type:"range",min:0,max:260,step:5,default:90,format:e=>Math.round(e)+"px",parse:parseFloat},{id:"critterAvoidForce",label:"Avoid Force",stateKey:"critterAvoidForce",type:"range",min:0,max:25e3,step:250,default:9500,format:e=>Math.round(e)+"",parse:parseFloat},{id:"critterEdgeAvoid",label:"Edge Avoid",stateKey:"critterEdgeAvoid",type:"range",min:0,max:3,step:.05,default:1,format:e=>e.toFixed(2)+"x",parse:parseFloat},{type:"divider",label:"Mouse Interaction"},{id:"critterMousePull",label:"Mouse Fear",stateKey:"critterMousePull",type:"range",min:0,max:4,step:.05,default:1,format:e=>e.toFixed(2)+"x",parse:parseFloat,hint:"Flee strength inside the mouse zone"},{id:"critterMouseRadiusVw",label:"Mouse Zone",stateKey:"critterMouseRadiusVw",type:"range",min:0,max:80,step:1,default:30,format:e=>Math.round(e)+"vw",parse:parseFloat},{type:"divider",label:"Physics"},{id:"critterRestitution",label:"Bounciness",stateKey:"critterRestitution",type:"range",min:0,max:.6,step:.01,default:.18,format:e=>e.toFixed(2),parse:parseFloat,hint:"Mode-only override",onChange(e,t){"critters"===e.currentMode&&(e.REST=t)}},{id:"critterFriction",label:"Friction",stateKey:"critterFriction",type:"range",min:0,max:.06,step:.001,default:.018,format:e=>e.toFixed(3),parse:parseFloat,hint:"Mode-only override",onChange(e,t){"critters"===e.currentMode&&(e.FRICTION=t)}},{type:"divider",label:"Hive Behavior"},{id:"critterHiveStirInterval",label:"Hive Stir Interval",stateKey:"critterHiveStirInterval",type:"range",min:1,max:15,step:.5,default:5,format:e=>e.toFixed(1)+"s",parse:parseFloat,hint:"Seconds between activity waves"},{id:"critterHiveStirStrength",label:"Hive Stir Strength",stateKey:"critterHiveStirStrength",type:"range",min:0,max:6,step:.1,default:2.5,format:e=>e.toFixed(1)+"x",parse:parseFloat,hint:"Force of activity waves"},{id:"critterHiveWaveSpeed",label:"Hive Wave Speed",stateKey:"critterHiveWaveSpeed",type:"range",min:.1,max:1,step:.05,default:.4,format:e=>e.toFixed(2),parse:parseFloat,hint:"How fast stir wave expands"},{type:"divider",label:"Character Traits"},{id:"critterNervousnessMin",label:"Nervousness (Min)",stateKey:"critterNervousnessMin",type:"range",min:0,max:1,step:.05,default:.4,format:e=>e.toFixed(2),parse:parseFloat,hint:"Minimum startle sensitivity",reinitMode:!0},{id:"critterNervousnessMax",label:"Nervousness (Max)",stateKey:"critterNervousnessMax",type:"range",min:0,max:1,step:.05,default:1,format:e=>e.toFixed(2),parse:parseFloat,hint:"Maximum startle sensitivity",reinitMode:!0},{id:"critterCuriosityBias",label:"Curiosity Bias",stateKey:"critterCuriosityBias",type:"range",min:0,max:1,step:.05,default:.5,format:e=>e.toFixed(2),parse:parseFloat,hint:"0=stay put, 1=explore edges",reinitMode:!0},{type:"divider",label:"Journey Points"},{id:"hiveJourneyPointCount",label:"Point Count",stateKey:"hiveJourneyPointCount",type:"range",min:1,max:8,step:1,default:4,format:e=>Math.round(e)+"",parse:e=>parseInt(e,10),hint:"Number of goal destinations scattered across viewport",reinitMode:!0},{id:"hiveJourneyPointMargin",label:"Point Margin",stateKey:"hiveJourneyPointMargin",type:"range",min:0,max:.2,step:.01,default:.05,format:e=>Math.round(100*e)+"%",parse:parseFloat,hint:"Margin from edges for journey point placement",reinitMode:!0},{id:"hiveGoalAttractionStrength",label:"Goal Attraction",stateKey:"hiveGoalAttractionStrength",type:"range",min:0,max:1,step:.05,default:.25,format:e=>e.toFixed(2),parse:parseFloat,hint:"How strongly critters steer toward goals"},{id:"hiveGoalSwitchMinS",label:"Goal Switch (Min)",stateKey:"hiveGoalSwitchMinS",type:"range",min:1,max:20,step:.5,default:4,format:e=>e.toFixed(1)+"s",parse:parseFloat,hint:"Minimum seconds before switching to new goal"},{id:"hiveGoalSwitchMaxS",label:"Goal Switch (Max)",stateKey:"hiveGoalSwitchMaxS",type:"range",min:5,max:30,step:.5,default:14,format:e=>e.toFixed(1)+"s",parse:parseFloat,hint:"Maximum seconds before switching to new goal"},{id:"hiveGoalReachedRadius",label:"Goal Reached Radius",stateKey:"hiveGoalReachedRadius",type:"range",min:10,max:200,step:5,default:50,format:e=>Math.round(e)+"px",parse:parseFloat,hint:"Distance threshold to consider goal reached"},{id:"hivePathAdherence",label:"Path Adherence",stateKey:"hivePathAdherence",type:"range",min:0,max:1,step:.05,default:.5,format:e=>Math.round(100*e)+"%",parse:parseFloat,hint:"Probability to pick next sequential point vs random"},{type:"divider",label:"Waypoint Appearance"},{id:"hiveWaypointVisible",label:"Show Waypoints",stateKey:"hiveWaypointVisible",type:"checkbox",default:!0,hint:"Display colored balls at journey point locations"},{id:"hiveWaypointSizeMul",label:"Waypoint Size",stateKey:"hiveWaypointSizeMul",type:"range",min:.5,max:3,step:.1,default:1.5,format:e=>e.toFixed(1)+"",parse:parseFloat,hint:"Size multiplier for waypoint balls (relative to base ball size)"},{id:"hiveWaypointOpacity",label:"Waypoint Opacity",stateKey:"hiveWaypointOpacity",type:"range",min:.1,max:1,step:.05,default:.9,format:e=>Math.round(100*e)+"%",parse:parseFloat,hint:"Opacity of waypoint balls"},{id:"hiveCritterSaturation",label:"Critter Saturation",stateKey:"hiveCritterSaturation",type:"range",min:0,max:1,step:.05,default:.3,format:e=>Math.round(100*e)+"%",parse:parseFloat,hint:"Color saturation for critters (low = faint, high = vibrant)",reinitMode:!0},ko("crittersWarmupFrames")]},pit:{title:"Ball Pit",icon:"",mode:"pit",defaultOpen:!1,controls:[{id:"gravityPit",label:"Gravity",stateKey:"gravityMultiplierPit",type:"range",min:0,max:2,step:.05,default:1.1,format:e=>e.toFixed(2),parse:parseFloat,onChange(e,t){"pit"===e.currentMode&&(e.G=e.GE*t)}},{id:"repelPower",label:"Repel Power",stateKey:"repelPower",type:"range",min:0,max:1e4,step:100,default:8500,format:e=>""+Math.round(e),parse:parseFloat,onChange(e,t){e.repelPower=24e3*Math.pow(2,12*(Math.max(0,Math.min(1e4,t))/1e4-.5))}},{id:"sleepVelocityThreshold",label:"Sleep Speed",stateKey:"sleepVelocityThreshold",type:"range",min:0,max:40,step:.5,default:12,format:e=>(+e).toFixed(1)+" px/s",parse:parseFloat,hint:"Pit modes only. Higher = settles sooner."},{id:"sleepAngularThreshold",label:"Sleep Spin",stateKey:"sleepAngularThreshold",type:"range",min:0,max:1,step:.01,default:.18,format:e=>(+e).toFixed(2)+" rad/s",parse:parseFloat,hint:"Pit modes only. Higher = stops spinning sooner."},{id:"timeToSleep",label:"Sleep Time",stateKey:"timeToSleep",type:"range",min:.05,max:2,step:.05,default:.25,format:e=>(+e).toFixed(2)+"s",parse:parseFloat,hint:"Pit modes only. Lower = sleeps faster."},ko("pitWarmupFrames")]},flies:{title:"Flies",icon:"",mode:"flies",defaultOpen:!1,controls:[{id:"fliesBallCount",label:"Ball Count",stateKey:"fliesBallCount",type:"range",min:20,max:150,step:5,default:60,format:e=>e+"",parse:e=>parseInt(e,10),reinitMode:!0},{id:"attractPower",label:"Attraction",stateKey:"attractionPower",type:"range",min:100,max:8e3,step:50,default:5e3,format:e=>""+Math.round(e),parse:parseFloat},{id:"swarmSpeed",label:"Swarm Speed",stateKey:"swarmSpeed",type:"range",min:.2,max:5,step:.1,default:.4,format:e=>e.toFixed(1),parse:parseFloat},{id:"fliesSeparation",label:"Separation",stateKey:"fliesSeparation",type:"range",min:5e3,max:3e4,step:1e3,default:15e3,format:e=>""+Math.round(e),parse:parseFloat},ko("fliesWarmupFrames")]},weightless:{title:"Zero-G",icon:"",mode:"weightless",defaultOpen:!1,controls:[{id:"weightlessCount",label:"Ball Count",stateKey:"weightlessCount",type:"range",min:20,max:200,step:10,default:66,format:e=>e+"",parse:e=>parseInt(e,10),reinitMode:!0},{id:"weightlessSpeed",label:"Initial Speed",stateKey:"weightlessInitialSpeed",type:"range",min:100,max:600,step:25,default:250,format:e=>e.toFixed(0),parse:parseFloat,reinitMode:!0},{id:"weightlessBounce",label:"Bounce",stateKey:"weightlessBounce",type:"range",min:.5,max:1,step:.05,default:.7,format:e=>e.toFixed(2),parse:parseFloat},{id:"weightlessRepelPower",label:"Cursor Blast Power",stateKey:"weightlessRepelPower",type:"range",min:0,max:6e5,step:1e4,default:5e4,format:e=>""+Math.round(e),parse:parseFloat},{id:"weightlessRepelSoft",label:"Cursor Blast Falloff",stateKey:"weightlessRepelSoft",type:"range",min:.5,max:6,step:.1,default:5.4,format:e=>e.toFixed(1),parse:parseFloat},ko("weightlessWarmupFrames")]},water:{title:"Water",icon:"",mode:"water",defaultOpen:!1,controls:[{id:"waterBallCount",label:"Ball Count",stateKey:"waterBallCount",type:"range",min:200,max:1800,step:10,default:1e3,format:e=>e+"",parse:e=>parseInt(e,10),reinitMode:!0},{id:"waterDrag",label:"Water Resistance",stateKey:"waterDrag",type:"range",min:.001,max:.15,step:.001,default:.12,format:e=>e.toFixed(3),parse:parseFloat},{id:"waterRippleStrength",label:"Ripple Strength",stateKey:"waterRippleStrength",type:"range",min:1e3,max:15e3,step:500,default:6e3,format:e=>e.toFixed(0),parse:parseFloat},{id:"waterMotion",label:"Drift Strength",stateKey:"waterDriftStrength",type:"range",min:0,max:80,step:1,default:40,format:e=>e.toFixed(0),parse:parseFloat,onChange(e,t){e.waterInitialVelocity=5*t},reinitMode:!0},ko("waterWarmupFrames")]},vortex:{title:"Electrons",icon:"",mode:"vortex",defaultOpen:!1,controls:[{id:"vortexBallCount",label:"Ball Count",stateKey:"vortexBallCount",type:"range",min:50,max:500,step:10,default:180,format:e=>e+"",parse:e=>parseInt(e,10),reinitMode:!0},{id:"vortexSwirl",label:"Orbital Strength",stateKey:"vortexSwirlStrength",type:"range",min:100,max:3e3,step:50,default:420,format:e=>e.toFixed(0),parse:parseFloat,tooltip:"Electromagnetic force strength binding electrons to nucleus"},{id:"vortexRadius",label:"Shell Radius",stateKey:"vortexRadius",type:"range",min:0,max:800,step:20,default:300,format:e=>0===e?"Auto-scale":e.toFixed(0)+"px",parse:parseFloat,tooltip:"Base radius for electron orbital shells (like atomic energy levels)"},{id:"vortexSpeedMultiplier",label:"Speed Multiplier",stateKey:"vortexSpeedMultiplier",type:"range",min:.1,max:3,step:.1,default:1,format:e=>e.toFixed(1),parse:parseFloat},{id:"vortexDepthVariation",label:"Depth Variation",stateKey:"vortexDepthVariation",type:"range",min:0,max:1,step:.05,default:.6,format:e=>(100*e).toFixed(0)+"%",parse:parseFloat,tooltip:"How much ball size changes with 3D depth (0 = no change, 1 = max variation)"},{id:"vortexSpiralTightness",label:"Spiral Tightness",stateKey:"vortexSpiralTightness",type:"range",min:0,max:1,step:.05,default:.5,format:e=>(100*e).toFixed(0)+"%",parse:parseFloat,tooltip:"How tightly balls spiral in 3D space (0 = flat orbit, 1 = tight spiral)"},{id:"vortexRotationDirection",label:"Rotation Direction",stateKey:"vortexRotationDirection",type:"range",min:-1,max:1,step:2,default:1,format:e=>1===e?"Counterclockwise":"Clockwise",parse:parseFloat},{id:"vortexDrag",label:"Drag",stateKey:"vortexDrag",type:"range",min:.001,max:.05,step:.001,default:.01,format:e=>e.toFixed(3),parse:parseFloat,tooltip:"Damping to stabilize orbital motion"},ko("vortexWarmupFrames")]},magnetic:{title:"Magnetic",icon:"",mode:"magnetic",defaultOpen:!1,controls:[{id:"magneticBallCount",label:"Ball Count",stateKey:"magneticBallCount",type:"range",min:50,max:300,step:10,default:180,format:e=>e+"",parse:e=>parseInt(e,10),reinitMode:!0},{id:"magneticStrength",label:"Strength",stateKey:"magneticStrength",type:"range",min:1e4,max:1e5,step:5e3,default:65e3,format:e=>e.toFixed(0),parse:parseFloat,hint:"Magnetic attraction strength to cursor"},{id:"magneticRadius",label:"Magnetic Radius",stateKey:"magneticRadius",type:"range",min:0,max:600,step:20,default:0,format:e=>0===e?"Unlimited":Math.round(e)+"px",parse:parseFloat,hint:"Maximum distance for magnetic effect (0 = unlimited)"},{id:"magneticVelocity",label:"Max Velocity",stateKey:"magneticMaxVelocity",type:"range",min:500,max:4e3,step:100,default:2800,format:e=>e.toFixed(0),parse:parseFloat},{id:"magneticDamping",label:"Damping",stateKey:"magneticDamping",type:"range",min:.8,max:.999,step:.001,default:.998,format:e=>e.toFixed(3),parse:parseFloat},ko("magneticWarmupFrames")]},bubbles:{title:"Bubbles",icon:"",mode:"bubbles",defaultOpen:!1,controls:[{id:"bubblesRate",label:"Bubble Rate",stateKey:"bubblesSpawnRate",type:"range",min:1,max:20,step:1,default:16,format:e=>e+"",parse:e=>parseInt(e,10)},{id:"bubblesSpeed",label:"Rise Speed",stateKey:"bubblesRiseSpeed",type:"range",min:50,max:900,step:25,default:650,format:e=>e.toFixed(0),parse:parseFloat},{id:"bubblesWobble",label:"Wobble",stateKey:"bubblesWobble",type:"range",min:0,max:100,step:5,default:65,format:e=>e.toFixed(0),parse:parseFloat},{id:"bubblesMax",label:"Max Bubbles",stateKey:"bubblesMaxCount",type:"range",min:50,max:300,step:10,default:150,format:e=>e+"",parse:e=>parseInt(e,10)},ko("bubblesWarmupFrames")]},tilt:{title:"Tilt",icon:"",mode:"tilt",defaultOpen:!1,controls:[{id:"tiltBallCount",label:"Particle Count",stateKey:"tiltBallCount",type:"range",min:100,max:500,step:10,default:300,format:e=>e+"",parse:e=>parseInt(e,10),reinitMode:!0},{id:"tiltMaxAngle",label:"Max Angle",stateKey:"tiltMaxAngle",type:"range",min:.5,max:10,step:.5,default:2,format:e=>e.toFixed(1)+"",parse:parseFloat},{id:"tiltLerpSpeed",label:"Smoothness",stateKey:"tiltLerpSpeed",type:"range",min:.01,max:.5,step:.01,default:.08,format:e=>e.toFixed(2),parse:parseFloat},{id:"tiltGlassMass",label:"Particle Mass",stateKey:"tiltGlassBallMass",type:"range",min:.02,max:.3,step:.01,default:.08,format:e=>e.toFixed(2)+"x",parse:parseFloat,reinitMode:!0},{id:"tiltFriction",label:"Friction",stateKey:"tiltFriction",type:"range",min:.002,max:.02,step:.001,default:.008,format:e=>e.toFixed(3),parse:parseFloat}]},kaleidoscope:{title:"Kaleidoscope",icon:"",mode:"kaleidoscope-3",defaultOpen:!1,controls:[{id:"kaleiBallCount",label:"Ball Count",stateKey:"kaleidoscope3BallCount",type:"range",min:12,max:300,step:3,default:150,format:e=>Math.round(e)+"",parse:e=>parseInt(e,10),reinitMode:!0},{id:"kaleiWedges",label:"Wedges",stateKey:"kaleidoscope3Wedges",type:"range",min:3,max:24,step:1,default:10,format:e=>Math.round(e)+"",parse:e=>parseInt(e,10)},{id:"kaleiMirror",label:"Mirror",type:"range",min:0,max:1,step:1,default:1,format:e=>e?"On":"Off",parse:e=>parseInt(e,10)},{id:"kaleiSpeed",label:"Speed",stateKey:"kaleidoscope3Speed",type:"range",min:.2,max:2,step:.05,default:1.2,format:e=>e.toFixed(2),parse:parseFloat},{id:"kaleiIdleDrift",label:"Idle Drift",stateKey:"kaleidoscopeIdleDrift",type:"range",min:0,max:.05,step:.002,default:.012,format:e=>(1e3*e).toFixed(0)+"",parse:parseFloat,hint:"Subtle movement when idle; respects prefers-reduced-motion."},{id:"kaleiDotSizeVh",label:"Dot Size (vh)",stateKey:"kaleidoscope3DotSizeVh",type:"range",min:.2,max:2.5,step:.05,default:1.05,format:e=>e.toFixed(2)+"vh",parse:parseFloat,reinitMode:!0},{id:"kaleiDotAreaMul",label:"Dot Area",stateKey:"kaleidoscope3DotAreaMul",type:"range",min:.3,max:1.5,step:.05,default:.75,format:e=>e.toFixed(2)+"",parse:parseFloat,reinitMode:!0},{id:"kaleiSpawnArea",label:"Spawn Density",stateKey:"kaleidoscope3SpawnAreaMul",type:"range",min:.2,max:2,step:.05,default:1.05,format:e=>e.toFixed(2)+"",parse:parseFloat,reinitMode:!0},{id:"kaleiSizeVar",label:"Size Variance",stateKey:"kaleidoscope3SizeVariance",type:"range",min:0,max:1,step:.05,default:.5,format:e=>(100*e).toFixed(0)+"%",parse:parseFloat,reinitMode:!0},ko("kaleidoscope3WarmupFrames")]},neural:{title:"Neural Network",icon:"",mode:"neural",defaultOpen:!1,controls:[{id:"neuralBallCount",label:"Ball Count",stateKey:"neuralBallCount",type:"range",min:8,max:400,step:1,default:311,format:e=>Math.round(e)+"",parse:e=>parseInt(e,10),reinitMode:!0},{id:"neuralLinkDistanceVw",label:"Link Distance",stateKey:"neuralLinkDistanceVw",type:"range",min:5,max:40,step:.5,default:5,format:e=>e.toFixed(1)+"vw",parse:parseFloat,tooltip:"Maximum distance for connections between nodes"},{id:"neuralLineOpacity",label:"Link Opacity",stateKey:"neuralLineOpacity",type:"range",min:0,max:.8,step:.02,default:.06,format:e=>e.toFixed(2),parse:parseFloat,tooltip:"Opacity of connector balls (legacy - now using connector density)"},{id:"neuralConnectorDensity",label:"Connector Density",stateKey:"neuralConnectorDensity",type:"range",min:0,max:10,step:1,default:3,format:e=>Math.round(e)+" balls",parse:e=>parseInt(e,10),tooltip:"Number of connector balls per connection (0 = no connectors)"},{id:"sizeVariationNeural",label:"Size Variation",stateKey:"sizeVariationNeural",type:"range",min:0,max:1,step:.05,default:.05,format:e=>e.toFixed(2),parse:parseFloat,reinitMode:!0},{id:"neuralWanderStrength",label:"Wander Strength",stateKey:"neuralWanderStrength",type:"range",min:0,max:2e3,step:10,default:1e3,format:e=>Math.round(e)+"",parse:parseFloat},{id:"neuralMouseStrength",label:"Mouse Attraction",stateKey:"neuralMouseStrength",type:"range",min:0,max:15e4,step:5e3,default:15e4,format:e=>Math.round(e/1e3)+"k",parse:parseFloat},{id:"neuralSeparationStrength",label:"Separation",stateKey:"neuralSeparationStrength",type:"range",min:0,max:3e4,step:500,default:11e3,format:e=>Math.round(e/1e3)+"k",parse:parseFloat,tooltip:"How strongly balls avoid each other (subtle spacing)"},{id:"neuralDamping",label:"Damping",stateKey:"neuralDamping",type:"range",min:.9,max:1,step:.002,default:.9,format:e=>e.toFixed(3),parse:parseFloat},ko("neuralWarmupFrames")]},parallaxLinear:{title:"Parallax (Linear)",icon:"",mode:"parallax-linear",defaultOpen:!1,controls:[{id:"parallaxLinearPreset",label:"Preset",stateKey:"parallaxLinearPreset",type:"select",options:Object.keys(Vn).map(e=>({value:e,label:Vn[e].label})),default:"default",format:e=>Vn[e]?.label||e,onChange(e){((e,t=!0)=>{const a=Vn[e];if(!a)return;const o=y();for(const[i,r]of Object.entries(a))"label"!==i&&void 0!==o[i]&&(o[i]=r);o.parallaxLinearPreset=e,t&&Promise.resolve().then(()=>dl).then(({resetCurrentMode:e})=>e());try{((e={})=>{const t=y(),a=!1!==e.runOnChange;for(const o of Object.values(Xs))for(const e of o.controls){if("colorDistribution"===e.type)continue;const o=e.id+"Val",n=document.getElementById("color"===e.type?e.id+"Picker":e.id+"Slider"),i=document.getElementById(o);if(!n||!e.stateKey)continue;const r=t[e.stateKey];void 0!==r&&("checkbox"===e.type||"toggle"===e.type?(n.checked=!!r,i&&(i.textContent=r?"On":"Off")):"color"===e.type?(n.value=r,i&&(i.textContent=r)):(n.value=r,i&&(i.textContent=e.format?e.format(r):r+"")),a&&e.onChange&&"wallPreset"!==e.id&&e.onChange(t,r))}})()}catch(n){}console.log("Applied parallax linear preset: "+a.label)})(e,!0)}},{id:"parallaxLinearDotSizeMul",label:"Dot Size",stateKey:"parallaxLinearDotSizeMul",type:"range",min:.2,max:6,step:.1,default:1.8,format:e=>e.toFixed(1)+"",parse:parseFloat,reinitMode:!0},{id:"sizeVariationParallaxLinear",label:"Size Variation",stateKey:"sizeVariationParallaxLinear",type:"range",min:0,max:1,step:.05,default:0,format:e=>e.toFixed(2),parse:parseFloat,reinitMode:!0},{id:"parallaxLinearGridX",label:"Grid X (Cols)",stateKey:"parallaxLinearGridX",type:"range",min:3,max:40,step:1,default:14,format:e=>Math.round(e)+"",parse:e=>parseInt(e,10),reinitMode:!0},{id:"parallaxLinearGridY",label:"Grid Y (Rows)",stateKey:"parallaxLinearGridY",type:"range",min:3,max:40,step:1,default:10,format:e=>Math.round(e)+"",parse:e=>parseInt(e,10),reinitMode:!0},{id:"parallaxLinearGridZ",label:"Grid Z (Layers)",stateKey:"parallaxLinearGridZ",type:"range",min:2,max:20,step:1,default:7,format:e=>Math.round(e)+"",parse:e=>parseInt(e,10),reinitMode:!0},{id:"parallaxLinearSpanX",label:"Span X",stateKey:"parallaxLinearSpanX",type:"range",min:.2,max:8,step:.05,default:5,format:e=>e.toFixed(2)+"",parse:parseFloat,reinitMode:!0,hint:"World-space width as a multiple of the viewport width. Use >1 to fill edge-to-edge."},{id:"parallaxLinearSpanY",label:"Span Y",stateKey:"parallaxLinearSpanY",type:"range",min:.2,max:3,step:.05,default:2.6,format:e=>e.toFixed(2)+"",parse:parseFloat,reinitMode:!0,hint:"World-space height as a multiple of the viewport height."},{id:"parallaxLinearZNear",label:"Z Near",stateKey:"parallaxLinearZNear",type:"range",min:10,max:1200,step:10,default:50,format:e=>Math.round(e)+"",parse:e=>parseInt(e,10),reinitMode:!0},{id:"parallaxLinearZFar",label:"Z Far",stateKey:"parallaxLinearZFar",type:"range",min:50,max:3e3,step:25,default:900,format:e=>Math.round(e)+"",parse:e=>parseInt(e,10),reinitMode:!0},{id:"parallaxLinearFocalLength",label:"Focal Length",stateKey:"parallaxLinearFocalLength",type:"range",min:80,max:2e3,step:10,default:420,format:e=>Math.round(e)+"px",parse:e=>parseInt(e,10)},{id:"parallaxLinearParallaxStrength",label:"Parallax Strength",stateKey:"parallaxLinearParallaxStrength",type:"range",min:0,max:2e3,step:10,default:260,format:e=>Math.round(e)+"",parse:e=>parseInt(e,10)},{id:"parallaxLinearMouseEasing",label:"Mouse Smoothing",stateKey:"parallaxLinearMouseEasing",type:"range",min:.5,max:50,step:.5,default:20,format:e=>e.toFixed(1),parse:parseFloat,hint:"Higher = snappier, lower = smoother camera pan (20 = near-instant)"},ko("parallaxLinearWarmupFrames")]},parallaxFloat:{title:"Parallax (Float)",icon:"",mode:"parallax-float",defaultOpen:!1,controls:[{id:"parallaxFloatRandomize",label:"Randomness",stateKey:"parallaxFloatRandomize",type:"range",min:0,max:100,step:1,default:50,format:e=>Math.round(e)+"%",parse:e=>parseInt(e,10),reinitMode:!0,hint:"0% = perfect grid, 100% = fully random positions"},{id:"parallaxFloatLevitationAmp",label:"Levitation Amplitude",stateKey:"parallaxFloatLevitationAmp",type:"range",min:0,max:100,step:1,default:25,format:e=>Math.round(e)+"px",parse:e=>parseInt(e,10),reinitMode:!0,hint:"How far particles drift during levitation"},{id:"parallaxFloatLevitationSpeed",label:"Levitation Speed",stateKey:"parallaxFloatLevitationSpeed",type:"range",min:.01,max:1,step:.01,default:.25,format:e=>e.toFixed(2),parse:parseFloat,reinitMode:!0,hint:"How fast particles oscillate"},{id:"parallaxFloatMouseEasing",label:"Mouse Smoothing",stateKey:"parallaxFloatMouseEasing",type:"range",min:.5,max:20,step:.5,default:5,format:e=>e.toFixed(1),parse:parseFloat,hint:"Higher = snappier, lower = smoother camera pan"},{id:"parallaxFloatDotSizeMul",label:"Dot Size",stateKey:"parallaxFloatDotSizeMul",type:"range",min:.2,max:6,step:.1,default:1.4,format:e=>e.toFixed(1)+"",parse:parseFloat,reinitMode:!0},{id:"sizeVariationParallaxFloat",label:"Size Variation",stateKey:"sizeVariationParallaxFloat",type:"range",min:0,max:1,step:.05,default:0,format:e=>e.toFixed(2),parse:parseFloat,reinitMode:!0},{id:"parallaxFloatGridX",label:"Grid X (Cols)",stateKey:"parallaxFloatGridX",type:"range",min:3,max:40,step:1,default:15,format:e=>Math.round(e)+"",parse:e=>parseInt(e,10),reinitMode:!0},{id:"parallaxFloatGridY",label:"Grid Y (Rows)",stateKey:"parallaxFloatGridY",type:"range",min:3,max:40,step:1,default:10,format:e=>Math.round(e)+"",parse:e=>parseInt(e,10),reinitMode:!0},{id:"parallaxFloatGridZ",label:"Grid Z (Layers)",stateKey:"parallaxFloatGridZ",type:"range",min:2,max:20,step:1,default:12,format:e=>Math.round(e)+"",parse:e=>parseInt(e,10),reinitMode:!0},{id:"parallaxFloatSpanX",label:"Span X",stateKey:"parallaxFloatSpanX",type:"range",min:.2,max:10,step:.1,default:4,format:e=>e.toFixed(1)+"",parse:parseFloat,reinitMode:!0,hint:"World-space width as a multiple of the viewport width"},{id:"parallaxFloatSpanY",label:"Span Y",stateKey:"parallaxFloatSpanY",type:"range",min:.2,max:10,step:.1,default:3,format:e=>e.toFixed(1)+"",parse:parseFloat,reinitMode:!0,hint:"World-space height as a multiple of the viewport height"},{id:"parallaxFloatZNear",label:"Z Near",stateKey:"parallaxFloatZNear",type:"range",min:10,max:1200,step:10,default:100,format:e=>Math.round(e)+"",parse:e=>parseInt(e,10),reinitMode:!0},{id:"parallaxFloatZFar",label:"Z Far",stateKey:"parallaxFloatZFar",type:"range",min:200,max:4e3,step:50,default:2500,format:e=>Math.round(e)+"",parse:e=>parseInt(e,10),reinitMode:!0},{id:"parallaxFloatFocalLength",label:"Focal Length",stateKey:"parallaxFloatFocalLength",type:"range",min:80,max:2e3,step:10,default:500,format:e=>Math.round(e)+"px",parse:e=>parseInt(e,10)},{id:"parallaxFloatParallaxStrength",label:"Parallax Strength",stateKey:"parallaxFloatParallaxStrength",type:"range",min:0,max:2e3,step:10,default:350,format:e=>Math.round(e)+"",parse:e=>parseInt(e,10)},ko("parallaxFloatWarmupFrames")]},starfield3d:{title:"3D Starfield",icon:"",mode:"starfield-3d",defaultOpen:!1,controls:[{id:"starfieldCount",label:"Star Count",stateKey:"starfieldCount",type:"range",min:20,max:320,step:2,default:150,format:e=>Math.round(e)+"",parse:e=>parseInt(e,10),reinitMode:!0},{id:"starfieldSpanX",label:"Span X",stateKey:"starfieldSpanX",type:"range",min:.4,max:3.5,step:.05,default:2.45,format:e=>e.toFixed(2)+"",parse:parseFloat,reinitMode:!0},{id:"starfieldSpanY",label:"Span Y",stateKey:"starfieldSpanY",type:"range",min:.4,max:3.5,step:.05,default:2.05,format:e=>e.toFixed(2)+"",parse:parseFloat,reinitMode:!0},{id:"starfieldZNear",label:"Z Near",stateKey:"starfieldZNear",type:"range",min:40,max:800,step:10,default:70,format:e=>Math.round(e)+"",parse:e=>parseInt(e,10),reinitMode:!0},{id:"starfieldZFar",label:"Z Far",stateKey:"starfieldZFar",type:"range",min:400,max:4e3,step:50,default:4e3,format:e=>Math.round(e)+"",parse:e=>parseInt(e,10),reinitMode:!0},{id:"starfieldFocalLength",label:"Focal Length",stateKey:"starfieldFocalLength",type:"range",min:120,max:2e3,step:10,default:310,format:e=>Math.round(e)+"px",parse:e=>parseInt(e,10)},{id:"starfieldParallaxStrength",label:"Parallax Strength",stateKey:"starfieldParallaxStrength",type:"range",min:0,max:1200,step:10,default:320,format:e=>Math.round(e)+"",parse:e=>parseInt(e,10)},{id:"starfieldSpeed",label:"Flow Speed",stateKey:"starfieldSpeed",type:"range",min:60,max:1600,step:10,default:390,format:e=>Math.round(e)+"px/s",parse:e=>parseInt(e,10)},{id:"starfieldDotSizeMul",label:"Dot Size",stateKey:"starfieldDotSizeMul",type:"range",min:.2,max:4,step:.05,default:.35,format:e=>e.toFixed(2)+"",parse:parseFloat},{id:"starfieldIdleJitter",label:"Idle Drift",stateKey:"starfieldIdleJitter",type:"range",min:0,max:20,step:.5,default:20,format:e=>e.toFixed(1)+"px",parse:parseFloat,hint:"Subtle twinkle when idle; disabled for reduced-motion."},{id:"starfieldFadeDuration",label:"Fade Duration",stateKey:"starfieldFadeDuration",type:"range",min:0,max:3,step:.1,default:.5,format:e=>e.toFixed(1)+"s",parse:parseFloat,hint:"Duration of fade in/out when stars appear and disappear."},ko("starfield3dWarmupFrames")]},shootingStars:{title:"Shooting Stars",icon:"",mode:"shooting-stars",defaultOpen:!1,controls:[{id:"shootingStarsSpawnInterval",label:"Spawn Interval",stateKey:"shootingStarsSpawnInterval",type:"range",min:.5,max:10,step:.5,default:3,format:e=>e.toFixed(1)+"s",parse:parseFloat,hint:"Time between shooting star bursts (lower = more frequent)"},{id:"shootingStarsBurstSize",label:"Burst Size",stateKey:"shootingStarsBurstSize",type:"range",min:1,max:10,step:1,default:1,format:e=>Math.round(e)+"",parse:e=>parseInt(e,10),hint:"Number of stars spawned per burst"},{id:"shootingStarsMinSpeed",label:"Min Speed",stateKey:"shootingStarsMinSpeed",type:"range",min:100,max:1e3,step:50,default:400,format:e=>Math.round(e)+"px/s",parse:e=>parseInt(e,10)},{id:"shootingStarsMaxSpeed",label:"Max Speed",stateKey:"shootingStarsMaxSpeed",type:"range",min:500,max:2e3,step:50,default:1200,format:e=>Math.round(e)+"px/s",parse:e=>parseInt(e,10)},{id:"shootingStarsAngle",label:"Angle",stateKey:"shootingStarsAngle",type:"range",min:-180,max:180,step:5,default:-45,format:e=>Math.round(e)+"",parse:e=>parseInt(e,10),hint:"Direction of travel (0 = right, -90 = up, 90 = down)"},{id:"shootingStarsTrailLength",label:"Trail Length",stateKey:"shootingStarsTrailLength",type:"range",min:0,max:20,step:1,default:5,format:e=>Math.round(e)+"",parse:e=>parseInt(e,10),hint:"Number of trail points (0 = no trail)"},{id:"shootingStarsMinSize",label:"Min Size",stateKey:"shootingStarsMinSize",type:"range",min:.2,max:2,step:.1,default:.5,format:e=>e.toFixed(1)+"",parse:parseFloat},{id:"shootingStarsMaxSize",label:"Max Size",stateKey:"shootingStarsMaxSize",type:"range",min:1,max:4,step:.1,default:1.5,format:e=>e.toFixed(1)+"",parse:parseFloat},ko("shootingStarsWarmupFrames")]},elasticCenter:{title:"Elastic Center",icon:"",mode:"elastic-center",defaultOpen:!1,controls:[{id:"elasticCenterRingCount",label:"Ring Count",stateKey:"elasticCenterRingCount",type:"range",min:2,max:20,step:1,default:10,format:e=>e+"",parse:e=>parseInt(e,10),reinitMode:!0,hint:"Number of concentric rings (more rings = more balls)"},{id:"elasticCenterMassMultiplier",label:"Mass Multiplier",stateKey:"elasticCenterMassMultiplier",type:"range",min:.5,max:5,step:.1,default:2,format:e=>e.toFixed(1)+"",parse:parseFloat,hint:"Mass of individual dots"},{id:"elasticCenterElasticStrength",label:"Elastic Strength",stateKey:"elasticCenterElasticStrength",type:"range",min:0,max:15e3,step:250,default:2e3,format:e=>e.toFixed(0)+"px/s",parse:parseFloat,hint:"Force pulling dots back to center position (0 = no elastic force, circle moves freely)"},{id:"elasticCenterMouseRepelStrength",label:"Mouse Repel Strength",stateKey:"elasticCenterMouseRepelStrength",type:"range",min:3e3,max:25e3,step:500,default:12e3,format:e=>e.toFixed(0)+"px/s",parse:parseFloat,hint:"Force pushing dots away from mouse cursor"},{id:"elasticCenterMouseRadius",label:"Mouse Influence Radius",stateKey:"elasticCenterMouseRadius",type:"range",min:50,max:400,step:10,default:200,format:e=>e.toFixed(0)+"px",parse:parseFloat,hint:"Distance from cursor where mouse affects dots"},{id:"elasticCenterDamping",label:"Damping",stateKey:"elasticCenterDamping",type:"range",min:.85,max:.99,step:.01,default:.94,format:e=>e.toFixed(2),parse:parseFloat,hint:"Velocity damping for stability (higher = less damping)"},ko("elasticCenterWarmupFrames")]},dvdLogo:{title:"DVD Logo",icon:"",mode:"dvd-logo",defaultOpen:!1,controls:[{id:"dvdLogoSpeed",label:"Speed",stateKey:"dvdLogoSpeed",type:"range",min:200,max:800,step:50,default:200,format:e=>e.toFixed(0)+"px/s",parse:parseFloat,hint:"Movement speed of the DVD logo"},{id:"dvdLogoSize",label:"Logo Size",stateKey:"dvdLogoSize",type:"range",min:.5,max:2,step:.1,default:1,format:e=>e.toFixed(1)+"",parse:parseFloat,hint:"Scale multiplier for logo size",reinitMode:!0},{id:"dvdLogoBallCount",label:"Ball Count",stateKey:"dvdLogoBallCount",type:"range",min:30,max:120,step:5,default:60,format:e=>e.toFixed(0)+" balls",parse:parseFloat,hint:"Total balls forming the DVD letters",reinitMode:!0},{id:"dvdLogoBallSpacing",label:"Ball Spacing",stateKey:"dvdLogoBallSpacing",type:"range",min:1,max:2,step:.1,default:1.3,format:e=>e.toFixed(1)+"",parse:parseFloat,hint:"Spacing between balls (higher = larger gaps)",reinitMode:!0},{id:"dvdLogoLetterSpacing",label:"Letter Spacing",stateKey:"dvdLogoLetterSpacing",type:"range",min:.5,max:2,step:.1,default:1,format:e=>e.toFixed(1)+"",parse:parseFloat,hint:"Spacing between D-V-D letters",reinitMode:!0},ko("dvdLogoWarmupFrames")]},particleFountain:{title:"Particle Fountain",icon:"",mode:"particle-fountain",defaultOpen:!1,controls:[{id:"particleFountainEmissionRate",label:"Emission Rate",stateKey:"particleFountainEmissionRate",type:"range",min:5,max:100,step:1,default:29,format:e=>e.toFixed(0)+" particles/s",parse:e=>parseInt(e,10),hint:"Number of particles emitted per second"},{id:"particleFountainInitialVelocity",label:"Initial Velocity",stateKey:"particleFountainInitialVelocity",type:"range",min:200,max:1e4,step:100,default:4700,format:e=>e.toFixed(0)+"px/s",parse:e=>parseInt(e,10),hint:"Initial upward velocity of particles"},{id:"particleFountainSpreadAngle",label:"Spread Angle",stateKey:"particleFountainSpreadAngle",type:"range",min:10,max:120,step:5,default:20,format:e=>e.toFixed(0)+"",parse:e=>parseInt(e,10),hint:"How wide the fountain spreads (degrees)"},{id:"particleFountainWaterDrag",label:"Water Drag",stateKey:"particleFountainWaterDrag",type:"range",min:.01,max:.2,step:.01,default:.02,format:e=>e.toFixed(2),parse:parseFloat,hint:"Water-like drag for smooth fluid motion (lower = more natural water, higher = more resistance)"},{id:"particleFountainGravityMultiplier",label:"Gravity",stateKey:"particleFountainGravityMultiplier",type:"range",min:0,max:2,step:.1,default:1.7,format:e=>e.toFixed(1)+"",parse:parseFloat,hint:"Gravity strength (particles fall after rising, 0 = no gravity)"},{id:"particleFountainUpwardForce",label:"Upward Force",stateKey:"particleFountainUpwardForce",type:"range",min:0,max:800,step:50,default:300,format:e=>e.toFixed(0)+"px/s",parse:e=>parseInt(e,10),hint:"Optional upward force (buoyancy), 0 = disabled"},{id:"particleFountainMaxParticles",label:"Max Particles",stateKey:"particleFountainMaxParticles",type:"range",min:20,max:300,step:10,default:230,format:e=>e.toFixed(0)+" particles",parse:e=>parseInt(e,10),hint:"Maximum active particles"},{id:"particleFountainLifetime",label:"Lifetime",stateKey:"particleFountainLifetime",type:"range",min:1,max:30,step:.5,default:8,format:e=>e.toFixed(1)+"s",parse:parseFloat,hint:"How long particles live before fading out (2s fade animation)"},{id:"particleFountainMouseRepelStrength",label:"Mouse Repel Strength",stateKey:"particleFountainMouseRepelStrength",type:"range",min:1e4,max:1e5,step:5e3,default:5e4,format:e=>e.toFixed(0)+"px/s",parse:e=>parseInt(e,10),hint:"Force pushing particles away from mouse cursor"},{id:"particleFountainMouseRepelRadiusVw",label:"Mouse Repel Radius",stateKey:"particleFountainMouseRepelRadiusVw",type:"range",min:1,max:20,step:.5,default:5,format:e=>e.toFixed(1)+"vw",parse:parseFloat,hint:"Radius of mouse repulsion (viewport width percentage)",onChange(){Promise.resolve().then(()=>Hn).then(({applyLayoutFromVwToPx:e})=>{e()}).catch(()=>{})}}]},sphere3d:{title:"3D Sphere",icon:"",mode:"3d-sphere",defaultOpen:!1,controls:[{id:"sphere3dRadiusVw",label:"Radius",stateKey:"sphere3dRadiusVw",type:"range",min:5,max:40,step:.5,default:18,format:e=>e.toFixed(1)+"vw",parse:parseFloat,reinitMode:!0},{id:"sphere3dDensity",label:"Point Count",stateKey:"sphere3dDensity",type:"range",min:30,max:600,step:10,default:140,format:e=>Math.round(e)+"",parse:e=>parseInt(e,10),reinitMode:!0},{id:"sphere3dFocalLength",label:"Focal Length",stateKey:"sphere3dFocalLength",type:"range",min:80,max:2e3,step:10,default:600,format:e=>Math.round(e)+"px",parse:e=>parseInt(e,10)},{id:"sphere3dDotSizeMul",label:"Dot Size",stateKey:"sphere3dDotSizeMul",type:"range",min:.2,max:4,step:.05,default:1.5,format:e=>e.toFixed(2)+"",parse:parseFloat},{id:"sphere3dIdleSpeed",label:"Idle Rotation",stateKey:"sphere3dIdleSpeed",type:"range",min:0,max:1,step:.02,default:.15,format:e=>e.toFixed(2)+" rad/s",parse:parseFloat},{id:"sphere3dTumbleSpeed",label:"Spin Sensitivity",stateKey:"sphere3dTumbleSpeed",type:"range",min:0,max:10,step:.1,default:2.5,format:e=>e.toFixed(1),parse:parseFloat,hint:"How much dragging the mouse over the sphere spins it. Higher = more sensitive."},{id:"sphere3dTumbleDamping",label:"Tumble Damping",stateKey:"sphere3dTumbleDamping",type:"range",min:.8,max:.99,step:.005,default:.94,format:e=>e.toFixed(3),parse:parseFloat},ko("sphere3dWarmupFrames")]},cube3d:{title:"3D Cube",icon:"",mode:"3d-cube",defaultOpen:!1,controls:[{id:"cube3dSizeVw",label:"Size",stateKey:"cube3dSizeVw",type:"range",min:10,max:50,step:.5,default:50,format:e=>e.toFixed(1)+"vw",parse:parseFloat,reinitMode:!0},{id:"cube3dEdgeDensity",label:"Edge Density",stateKey:"cube3dEdgeDensity",type:"range",min:2,max:30,step:1,default:8,format:e=>Math.round(e)+"",parse:e=>parseInt(e,10),reinitMode:!0},{id:"cube3dFaceGrid",label:"Face Grid",stateKey:"cube3dFaceGrid",type:"range",min:0,max:10,step:1,default:0,format:e=>Math.round(e)+"",parse:e=>parseInt(e,10),reinitMode:!0,hint:"0 = edges only. >0 adds face lattice points."},{id:"cube3dIdleSpeed",label:"Idle Rotation",stateKey:"cube3dIdleSpeed",type:"range",min:0,max:1,step:.02,default:.2,format:e=>e.toFixed(2)+" rad/s",parse:parseFloat},{id:"cube3dCursorInfluence",label:"Cursor Influence",stateKey:"cube3dCursorInfluence",type:"range",min:0,max:4,step:.05,default:1.5,format:e=>e.toFixed(2),parse:parseFloat},{id:"cube3dTumbleSpeed",label:"Tumble Speed",stateKey:"cube3dTumbleSpeed",type:"range",min:0,max:10,step:.1,default:3,format:e=>e.toFixed(1),parse:parseFloat},{id:"cube3dTumbleDamping",label:"Tumble Damping",stateKey:"cube3dTumbleDamping",type:"range",min:.8,max:.99,step:.005,default:.95,format:e=>e.toFixed(3),parse:parseFloat},{id:"cube3dFocalLength",label:"Focal Length",stateKey:"cube3dFocalLength",type:"range",min:80,max:2e3,step:10,default:500,format:e=>Math.round(e)+"px",parse:e=>parseInt(e,10)},{id:"cube3dDotSizeMul",label:"Dot Size",stateKey:"cube3dDotSizeMul",type:"range",min:.2,max:4,step:.05,default:1.5,format:e=>e.toFixed(2)+"",parse:parseFloat},{id:"cube3dFogStart",label:"Fog Start",stateKey:"cube3dFogStart",type:"range",min:0,max:1,step:.05,default:.5,format:e=>Math.round(100*e)+"%",parse:parseFloat},{id:"cube3dFogMin",label:"Fog Min Opacity",stateKey:"cube3dFogMin",type:"range",min:0,max:1,step:.05,default:.1,format:e=>Math.round(100*e)+"%",parse:parseFloat},ko("cube3dWarmupFrames")]},parallaxLinear:{title:"Parallax (Linear)",icon:"",mode:"parallax-linear",defaultOpen:!1,controls:[{id:"parallaxLinearGridX",label:"Grid X",stateKey:"parallaxLinearGridX",type:"range",min:4,max:30,step:1,default:14,format:e=>Math.round(e)+"",parse:e=>parseInt(e,10),reinitMode:!0},{id:"parallaxLinearGridY",label:"Grid Y",stateKey:"parallaxLinearGridY",type:"range",min:4,max:30,step:1,default:10,format:e=>Math.round(e)+"",parse:e=>parseInt(e,10),reinitMode:!0},{id:"parallaxLinearGridZ",label:"Grid Z (Depth)",stateKey:"parallaxLinearGridZ",type:"range",min:2,max:15,step:1,default:7,format:e=>Math.round(e)+"",parse:e=>parseInt(e,10),reinitMode:!0},{type:"divider",label:"Spread & Depth"},{id:"parallaxLinearSpanX",label:"Span X",stateKey:"parallaxLinearSpanX",type:"range",min:1,max:12,step:.1,default:5.4,format:e=>e.toFixed(1)+"",parse:parseFloat,reinitMode:!0,hint:"How far the grid extends horizontally"},{id:"parallaxLinearSpanY",label:"Span Y",stateKey:"parallaxLinearSpanY",type:"range",min:1,max:12,step:.1,default:5.4,format:e=>e.toFixed(1)+"",parse:parseFloat,reinitMode:!0,hint:"How far the grid extends vertically"},{id:"parallaxLinearZNear",label:"Z Near",stateKey:"parallaxLinearZNear",type:"range",min:10,max:200,step:5,default:50,format:e=>Math.round(e)+"px",parse:e=>parseInt(e,10),reinitMode:!0},{id:"parallaxLinearZFar",label:"Z Far",stateKey:"parallaxLinearZFar",type:"range",min:200,max:2e3,step:50,default:800,format:e=>Math.round(e)+"px",parse:e=>parseInt(e,10),reinitMode:!0},{type:"divider",label:"Camera & Mouse"},{id:"parallaxLinearFocalLength",label:"Focal Length",stateKey:"parallaxLinearFocalLength",type:"range",min:100,max:1e3,step:10,default:420,format:e=>Math.round(e)+"px",parse:e=>parseInt(e,10)},{id:"parallaxLinearParallaxStrength",label:"Parallax Strength",stateKey:"parallaxLinearParallaxStrength",type:"range",min:0,max:500,step:10,default:120,format:e=>Math.round(e)+"px",parse:e=>parseInt(e,10),hint:"How much the view shifts with mouse movement"},{id:"parallaxLinearMouseEasing",label:"Mouse Smoothing",stateKey:"parallaxLinearMouseEasing",type:"range",min:.5,max:15,step:.5,default:4,format:e=>e.toFixed(1),parse:parseFloat,hint:"Lower = smoother/slower, higher = snappier"},{type:"divider",label:"Appearance"},{id:"parallaxLinearDotSizeMul",label:"Dot Size",stateKey:"parallaxLinearDotSizeMul",type:"range",min:.5,max:4,step:.1,default:1.8,format:e=>e.toFixed(1)+"",parse:parseFloat},ko("parallaxLinearWarmupFrames")]},parallaxFloat:{title:"Parallax (Float)",icon:"",mode:"parallax-float",defaultOpen:!1,controls:[{id:"parallaxFloatRandomize",label:"Randomize",stateKey:"parallaxFloatRandomize",type:"range",min:0,max:1,step:.05,default:.5,format:e=>Math.round(100*e)+"%",parse:parseFloat,reinitMode:!0,hint:"0 = perfect grid, 1 = fully scattered"},{type:"divider",label:"Levitation"},{id:"parallaxFloatLevitationAmp",label:"Amplitude",stateKey:"parallaxFloatLevitationAmp",type:"range",min:0,max:60,step:2,default:20,format:e=>Math.round(e)+"px",parse:e=>parseInt(e,10),hint:"How far particles drift"},{id:"parallaxFloatLevitationSpeed",label:"Speed",stateKey:"parallaxFloatLevitationSpeed",type:"range",min:.05,max:.5,step:.02,default:.2,format:e=>e.toFixed(2)+" Hz",parse:parseFloat,hint:"How fast particles drift"},{type:"divider",label:"Mouse"},{id:"parallaxFloatParallaxStrength",label:"Parallax Strength",stateKey:"parallaxFloatParallaxStrength",type:"range",min:0,max:500,step:10,default:120,format:e=>Math.round(e)+"px",parse:e=>parseInt(e,10),hint:"How much the view shifts with mouse"},{id:"parallaxFloatMouseEasing",label:"Mouse Smoothing",stateKey:"parallaxFloatMouseEasing",type:"range",min:.5,max:15,step:.5,default:4,format:e=>e.toFixed(1),parse:parseFloat,hint:"Lower = smoother/slower, higher = snappier"},{type:"divider",label:"Appearance"},{id:"parallaxFloatDotSizeMul",label:"Dot Size",stateKey:"parallaxFloatDotSizeMul",type:"range",min:.5,max:4,step:.1,default:1.8,format:e=>e.toFixed(1)+"",parse:parseFloat},ko("parallaxFloatWarmupFrames")]},entrance:{title:"Entrance",icon:"",defaultOpen:!1,controls:[{id:"entranceEnabled",label:"Enabled",stateKey:"entranceEnabled",type:"checkbox",default:!0,format:e=>e?"On":"Off",parse:e=>!!e,hint:"Enable dramatic entrance animation (browser default  wall-state)",onChange(){"undefined"!=typeof window&&setTimeout(()=>window.location.reload(),300)}},{id:"entranceWallTransitionDelay",label:"Wall Transition Delay",stateKey:"entranceWallTransitionDelay",type:"range",min:0,max:2e3,step:50,default:300,format:e=>Math.round(e)+"ms",parse:e=>parseInt(e,10),hint:"Delay before wall background transition starts"},{id:"entranceWallTransitionDuration",label:"Wall Growth Duration",stateKey:"entranceWallTransitionDuration",type:"range",min:200,max:2e3,step:50,default:800,format:e=>Math.round(e)+"ms",parse:e=>parseInt(e,10),hint:"Duration of wall scaling down into viewport animation"},{id:"entranceWallInitialScale",label:"Initial Scale",stateKey:"entranceWallInitialScale",type:"range",min:1.05,max:1.5,step:.05,default:1.1,format:e=>e.toFixed(2),parse:e=>parseFloat(e),hint:"Starting scale (wall starts slightly larger, scales down to 1.0)"},{id:"entranceWallEasing",label:"Wall Growth Easing",stateKey:"entranceWallEasing",type:"select",options:[{value:"cubic-bezier(0.16, 1, 0.3, 1)",label:"Organic (default)"},{value:"ease-out",label:"Ease Out"},{value:"ease-in-out",label:"Ease In Out"},{value:"cubic-bezier(0.34, 1.56, 0.64, 1)",label:"Bounce"},{value:"cubic-bezier(0.68, -0.55, 0.265, 1.55)",label:"Overshoot"}],default:"cubic-bezier(0.16, 1, 0.3, 1)",format:e=>e+"",parse:e=>e+"",hint:"Easing function for wall growth animation"},{id:"entranceElementDuration",label:"Element Duration",stateKey:"entranceElementDuration",type:"range",min:100,max:1e3,step:50,default:800,format:e=>Math.round(e)+"ms",parse:e=>parseInt(e,10),hint:"Duration for individual element animations"},{id:"entranceElementScaleStart",label:"Element Scale Start",stateKey:"entranceElementScaleStart",type:"range",min:.5,max:1,step:.01,default:.95,format:e=>e.toFixed(2),parse:e=>parseFloat(e),hint:"Initial scale for elements (0-1)"},{id:"entranceElementTranslateZStart",label:"Element Z Start",stateKey:"entranceElementTranslateZStart",type:"range",min:-100,max:0,step:5,default:-20,format:e=>Math.round(e)+"px",parse:e=>parseInt(e,10),hint:"Initial z-axis position (negative = back in 3D space)"},{id:"entrancePerspectiveLandscape",label:"Perspective (Landscape)",stateKey:"entrancePerspectiveLandscape",type:"range",min:500,max:3e3,step:50,default:1200,format:e=>Math.round(e)+"px",parse:e=>parseInt(e,10),hint:"3D perspective for landscape aspect ratio",onChange(){Promise.resolve().then(()=>Fc).then(({applyPerspectiveCSS:e})=>{e()}).catch(()=>{})}},{id:"entrancePerspectiveSquare",label:"Perspective (Square)",stateKey:"entrancePerspectiveSquare",type:"range",min:500,max:3e3,step:50,default:1e3,format:e=>Math.round(e)+"px",parse:e=>parseInt(e,10),hint:"3D perspective for square aspect ratio",onChange(){Promise.resolve().then(()=>Fc).then(({applyPerspectiveCSS:e})=>{e()}).catch(()=>{})}},{id:"entrancePerspectivePortrait",label:"Perspective (Portrait)",stateKey:"entrancePerspectivePortrait",type:"range",min:500,max:3e3,step:50,default:800,format:e=>Math.round(e)+"px",parse:e=>parseInt(e,10),hint:"3D perspective for portrait aspect ratio",onChange(){Promise.resolve().then(()=>Fc).then(({applyPerspectiveCSS:e})=>{e()}).catch(()=>{})}},{id:"contentFadeInDelay",label:"Content Fade-In Delay",stateKey:"contentFadeInDelay",type:"range",min:0,max:2e3,step:50,default:500,format:e=>Math.round(e)+"ms",parse:e=>parseInt(e,10),hint:"Delay before content fade-in animation starts (excludes background/wall color)",onChange(){"undefined"!=typeof window&&setTimeout(()=>window.location.reload(),300)}},{id:"contentFadeInDuration",label:"Content Fade-In Duration",stateKey:"contentFadeInDuration",type:"range",min:100,max:3e3,step:50,default:1e3,format:e=>Math.round(e)+"ms",parse:e=>parseInt(e,10),hint:"Duration of content fade-in animation (excludes background/wall color)",onChange(){"undefined"!=typeof window&&setTimeout(()=>window.location.reload(),300)}}]}};let Us=null,Js=null,Qs=null,ec=null,tc=null,ac=null,oc=null,nc=!1;var ic=Object.freeze({__proto__:null,initWallElements:Ao,updateWallElements:Ro});const rc="theme-preference-v2",lc="theme-preference";let sc="auto",cc="light",dc=!1;var uc=Object.freeze({__proto__:null,getCurrentTheme:()=>sc,initializeDarkMode:$o,setTheme:zo,toggleDarkMode:Go});let pc=null;const hc="abs_nav_state",fc="abs_nav_ts";"undefined"!=typeof window&&(window.addEventListener("pagereveal",e=>{e.viewTransition&&(gc=!0,console.log(" View Transition detected on pagereveal"),document.documentElement.classList.remove("entrance-pre-transition","entrance-transitioning"),document.documentElement.classList.add("entrance-complete"),["#app-frame","#abs-scene","#brand-logo","#main-links"].forEach(e=>{const t=document.querySelector(e);t&&(t.style.opacity="1",t.style.visibility="visible")}),document.querySelectorAll("#main-links .footer_link").forEach(e=>{e.style.opacity="1",e.style.transform="translateY(0) scale(1)",e.style.filter="blur(0)"}))}),window.addEventListener("pageswap",()=>{Xo()}),window.addEventListener("pagehide",()=>{Xo()}));const mc={INTERNAL:"internal",OPEN_CV_MODAL:"open_cv",OPEN_PORTFOLIO_MODAL:"open_portfolio",OPEN_CONTACT_MODAL:"open_contact"};let gc=!1;try{const e=sessionStorage.getItem(hc),t=parseInt(sessionStorage.getItem(fc)||"0",10),a=5e3>Date.now()-t,o="function"==typeof document.startViewTransition;e&&a&&o&&(gc=!0,console.log(" View Transition detected at module load"))}catch(Dc){}let yc=!1;var bc=Object.freeze({__proto__:null,NAV_STATES:mc,didViewTransitionRun:()=>gc,getModalToAutoOpen(){try{const e=sessionStorage.getItem(hc);if(e===mc.OPEN_CV_MODAL)return"cv";if(e===mc.OPEN_PORTFOLIO_MODAL)return"portfolio";if(e===mc.OPEN_CONTACT_MODAL)return"contact"}catch(Dc){}return null},getNavigationState:Jo,initSpeculativePrefetch(){function e(e){const a=e.href||e.dataset.href;if(!a||t.has(a))return;if(!a.endsWith(".html")&&!a.includes("/"))return;const o=setTimeout(()=>{an(a),t.add(a)},100),n=()=>{clearTimeout(o),e.removeEventListener("mouseleave",n),e.removeEventListener("touchend",n),e.removeEventListener("blur",n)};e.addEventListener("mouseleave",n,{once:!0}),e.addEventListener("touchend",n,{once:!0}),e.addEventListener("blur",n,{once:!0})}const t=new Set,a=navigator.connection;a?.saveData?console.log(" Data saver enabled, skipping speculative prefetch"):(document.addEventListener("mouseenter",t=>{try{if(!t.target||"function"!=typeof t.target.closest)return;const a=t.target.closest("a[href], [data-href], [data-transition]");a&&e(a)}catch(a){console.error("Prefetch mouseenter error:",a)}},{capture:!0}),document.addEventListener("focusin",t=>{try{if(!t.target||"function"!=typeof t.target.closest)return;const a=t.target.closest("a[href], [data-href], [data-transition]");a&&e(a)}catch(a){console.error("Prefetch focusin error:",a)}}),document.addEventListener("touchstart",e=>{try{if(!e.target||"function"!=typeof e.target.closest)return;const a=e.target.closest("a[href], [data-href], [data-transition]");if(a){const e=a.href||a.dataset.href;e&&!t.has(e)&&(an(e),t.add(e))}}catch(a){console.error("Prefetch touchstart error:",a)}},{passive:!0}),console.log(" Speculative prefetch initialized"))},isBackForwardNavigation:Qo,navigateWithTransition:en,prefetchPage:an,resetTransitionState:tn,setNavigationState:Uo,setupPrefetchOnHover:on,shouldSkipWallAnimation:()=>null!==Jo()||Qo(),supportsViewTransitions:Zo});const Mc=1700,vc='<i class="ti ti-volume-off" aria-hidden="true"></i>';let xc=null;const wc=new Map([["apple music",'<i class="ti ti-brand-apple" aria-hidden="true"></i>'],["instagram",'<i class="ti ti-brand-instagram" aria-hidden="true"></i>'],["linkedin",'<i class="ti ti-brand-linkedin" aria-hidden="true"></i>'],["x",'<i class="ti ti-brand-x" aria-hidden="true"></i>']]);let Sc=!1;const Cc="abs-link-hovering",kc=['1em "Geist"','1em "Geist Mono"','1em "Sarina"','1em "tabler-icons"'];var Fc=Object.freeze({__proto__:null,applyAspectRatioClass:Fn,applyPerspectiveCSS:Ln,detectAspectRatioCategory:kn,async orchestrateEntrance(e={}){const t=y(),a=!!e.skipWallAnimation,o=!!e.skipEntranceAnimation,n=e.wallContent||[],i=e.centralContent||[],r=e.reducedMotion??!!window.matchMedia?.("(prefers-reduced-motion: reduce)")?.matches;if(Fn(),Ln(),e.waitForFonts&&await e.waitForFonts(),o)return document.documentElement.classList.remove("entrance-pre-transition","entrance-transitioning"),document.documentElement.classList.add("entrance-complete"),Tn(),void console.log(" Entrance skipped (View Transition handled animation)");if(r)return void(()=>{const e=document.getElementById("app-frame"),t=document.getElementById("brand-logo"),a=document.getElementById("main-links"),o=a?Array.from(a.querySelectorAll(".footer_link")):[],n=document.documentElement;n.classList.remove("entrance-pre-transition","entrance-transitioning"),n.classList.add("entrance-complete");const i=[e,t,a,...o].filter(Boolean);i.forEach(e=>{e.style.transition="opacity 200ms ease-out",e.style.opacity="0",e.style.visibility="visible"}),requestAnimationFrame(()=>{i.forEach(e=>{e.style.opacity="1"}),setTimeout(()=>{i.forEach(e=>{e.style.removeProperty("transition"),e.style.removeProperty("opacity"),e.style.removeProperty("filter"),e.style.removeProperty("transform")});const e=document.getElementById("fade-blocking");e&&e.remove()},250)})})();a?(document.documentElement.classList.remove("entrance-pre-transition","entrance-transitioning"),document.documentElement.classList.add("entrance-complete")):In(),a||Dn({wallContent:n});const l=t.entranceElementEasing??"cubic-bezier(0.16, 1, 0.3, 1)",s=t.contentFadeInDelay??500,c=t.contentFadeInDuration??1e3,d=t.entranceLateElementDuration??500,u=document.getElementById("abs-scene");if(u){const e=document.getElementById("fade-blocking");e&&e.remove(),u.style.opacity="0",u.style.visibility="visible",u.style.willChange="opacity",setTimeout(()=>{if("function"==typeof u.animate){const e=u.animate([{opacity:0},{opacity:1}],{duration:c,easing:l,fill:"forwards"});e.addEventListener("finish",()=>{u.style.opacity="1",u.style.willChange="auto"}),e.addEventListener("cancel",()=>{u.style.opacity="1",u.style.willChange="auto"})}else u.style.transition=`opacity ${c}ms ${l}`,requestAnimationFrame(()=>{u.style.opacity="1"})},s)}const p=s+.6*c,h=document.getElementById("brand-logo");h&&setTimeout(()=>{((e,t={})=>{new Promise(a=>{if(!e)return void a();const o=y(),n=t.delay??0,i=t.duration??o.entranceLateElementDuration??600,r=t.easing??"cubic-bezier(0.16, 1, 0.3, 1)",l=e.classList.contains("brand-logo-in-grid");setTimeout(()=>{let t;if(e.style.transition="none",e.style.visibility="visible",l)t=e.animate([{opacity:0,filter:"blur(8px)"},{opacity:1,filter:"blur(0px)"}],{duration:i,easing:r,fill:"forwards"});else{const a="calc(var(--abs-scene-impact-logo-scale, 1) * var(--brand-logo-user-scale, 1))";t=e.animate([{opacity:0,transform:`translateY(calc(var(--brand-logo-offset-y) - var(--gap-xs))) scale(calc(${a} * 0.96))`,filter:"blur(calc(var(--link-impact-blur) * 0.6))"},{opacity:1,transform:`translateY(var(--brand-logo-offset-y)) scale(${a})`,filter:"blur(0px)"}],{duration:i,easing:r,fill:"forwards"})}t.finished.then(()=>{e.style.opacity="1",e.style.filter="blur(0px)",requestAnimationFrame(()=>{requestAnimationFrame(()=>{e.style.removeProperty("transition"),e.style.removeProperty("transform"),e.style.removeProperty("filter"),a()})})}).catch(()=>{a()})},n)})})(h,{delay:0,duration:d,easing:l})},p);const f=[];for(const y of i){const e="string"==typeof y?document.querySelector(y):y;e&&f.push(e)}const m=p+.5*d;for(let y=0;f.length>y;y++){const e=f[y];setTimeout(()=>{Kn(e,{delay:0,duration:d,easing:l,scaleFrom:t.entranceLateElementScaleFrom??.92})},m+150*y)}const g=p+.35*d,b=document.getElementById("main-links");b&&(b.classList.add("main-links--staggered"),setTimeout(()=>{b.style.transition="none",b.style.visibility="visible",b.style.opacity="1",b.classList.add("main-links--staggered-in"),requestAnimationFrame(()=>{b.style.removeProperty("transition")}),setTimeout(()=>{b.querySelectorAll(".footer_link").forEach(e=>{e.style.opacity="1",e.style.transform="translateY(0) scale(1)",e.style.filter="blur(0)"}),b.classList.remove("main-links--staggered","main-links--staggered-in")},1300)},g))},revealAllLateElements:Tn,revealLateElement:Kn,setInitialBrowserDefaultState:In,transitionToWallState:Dn});const Lc={core:{title:"Core",controls:[{id:"masterGain",label:"Master Volume",min:10,max:100,step:1,format:e=>Math.round(e)+"%",toConfig:e=>e/100,fromConfig:e=>100*e},{id:"collisionMinImpact",label:"Silence Threshold",min:20,max:85,step:1,format:e=>Math.round(e)+"%",toConfig:e=>e/100,fromConfig:e=>100*e}]},envelope:{title:"Envelope",controls:[{id:"decayTime",label:"Click Length",min:20,max:180,step:1,format:e=>Math.round(e)+"ms",toConfig:e=>e/1e3,fromConfig:e=>1e3*e}]},tone:{title:"Tone",controls:[{id:"filterBaseFreq",label:"Brightness",min:300,max:6e3,step:50,format:e=>Math.round(e)+"Hz",toConfig:e=>e,fromConfig:e=>e},{id:"harmonicGain",label:"Warmth",min:0,max:50,step:1,format:e=>Math.round(e)+"%",toConfig:e=>e/100,fromConfig:e=>100*e},{id:"filterQ",label:"Resonance",min:10,max:200,step:5,format:e=>""+(e/100).toFixed(2),toConfig:e=>e/100,fromConfig:e=>100*e}]},crystal:{title:"Crystal",controls:[{id:"pitchMinHz",label:"Pitch Low",min:80,max:1200,step:10,format:e=>Math.round(e)+"Hz",toConfig:e=>e,fromConfig:e=>e},{id:"pitchMaxHz",label:"Pitch High",min:200,max:4e3,step:20,format:e=>Math.round(e)+"Hz",toConfig:e=>e,fromConfig:e=>e},{id:"pitchCurve",label:"Pitch Curve",min:70,max:160,step:1,format:e=>(e/100).toFixed(2)+"",toConfig:e=>e/100,fromConfig:e=>100*e},{id:"sparkleGain",label:"Sparkle",min:0,max:35,step:1,format:e=>Math.round(e)+"%",toConfig:e=>e/100,fromConfig:e=>100*e},{id:"sparkleRatioMin",label:"Sparkle Min",min:120,max:600,step:10,format:e=>(e/100).toFixed(2)+"",toConfig:e=>e/100,fromConfig:e=>100*e},{id:"sparkleRatioMax",label:"Sparkle Max",min:160,max:800,step:10,format:e=>(e/100).toFixed(2)+"",toConfig:e=>e/100,fromConfig:e=>100*e},{id:"sparkleDecayMul",label:"Sparkle Decay",min:20,max:95,step:1,format:e=>Math.round(e)+"%",toConfig:e=>e/100,fromConfig:e=>100*e},{id:"noiseTransientQ",label:"Sparkle Q",min:60,max:600,step:5,format:e=>""+(e/100).toFixed(2),toConfig:e=>e/100,fromConfig:e=>100*e}]},space:{title:"Space",controls:[{id:"reverbWetMix",label:"Reverb Mix",min:0,max:50,step:1,format:e=>Math.round(e)+"%",toConfig:e=>e/100,fromConfig:e=>100*e},{id:"reverbDecay",label:"Room Size",min:5,max:80,step:1,format:e=>(e/100).toFixed(2)+"s",toConfig:e=>e/100,fromConfig:e=>100*e}]},dynamics:{title:"Dynamics",controls:[{id:"minGain",label:"Min Hit Volume",min:0,max:20,step:1,format:e=>Math.round(e)+"%",toConfig:e=>e/100,fromConfig:e=>100*e},{id:"maxGain",label:"Max Hit Volume",min:5,max:50,step:1,format:e=>Math.round(e)+"%",toConfig:e=>e/100,fromConfig:e=>100*e}]},realism:{title:"Realism",controls:[{id:"noiseTransientGain",label:"Impact Snap",min:0,max:80,step:1,format:e=>Math.round(e)+"%",toConfig:e=>e/100,fromConfig:e=>100*e},{id:"varianceGain",label:"Volume Variance",min:0,max:50,step:1,format:e=>`${Math.round(e)}%`,toConfig:e=>e/100,fromConfig:e=>100*e},{id:"variancePitch",label:"Pitch Variance",min:0,max:25,step:1,format:e=>`${Math.round(e)}%`,toConfig:e=>e/100,fromConfig:e=>100*e},{id:"velocityNoiseScale",label:"Hard Hit Crack",min:100,max:500,step:10,format:e=>(e/100).toFixed(1)+"",toConfig:e=>e/100,fromConfig:e=>100*e}]}};var Ic=Object.freeze({__proto__:null,async animateDeparture(e={}){const t=e.duration??300,a=e.easing??"cubic-bezier(0.16, 1, 0.3, 1)";if(window.matchMedia?.("(prefers-reduced-motion: reduce)")?.matches)return Promise.resolve();const o=["#expertise-legend",".decorative-script",".portfolio-stage","#portfolioMeta",".cv-scroll-container","#bravia-balls canvas",".ui-top",".ui-bottom","#main-links"].map(e=>document.querySelector(e)).filter(Boolean);if(0===o.length)return Promise.resolve();const n=o.map(e=>e.animate([{opacity:1,transform:"scale(1) translateZ(0)",filter:"blur(0)"},{opacity:0,transform:"scale(0.95) translateZ(-30px)",filter:"blur(4px)"}],{duration:t,easing:a,fill:"forwards"}));await Promise.all(n.map(e=>e.finished))}});export{wn as $,ae as A,re as B,le as C,$o as D,fa as E,nn as F,rn as G,ln as H,un as I,pn as J,sn as K,Z as L,Bn as M,Wn as N,oa as O,to as P,ao as Q,Ja as R,Za as S,Xa as T,vn as U,Je as V,Yo as W,An as X,Ye as Y,ra as Z,Ha as _,g as a,Sn as a0,Cn as a1,xn as a2,en as a3,mc as a4,tn as a5,on as a6,ne as a7,fe as a8,me as a9,vi as aA,To as aB,h as aC,l as aD,be as aE,Ko as aF,Bo as aG,te as aH,_o as aI,dl as aJ,bc as aK,Fc as aL,ge as aa,ye as ab,he as ac,n as ad,Te as ae,ee as af,x as ag,We as ah,_e as ai,Lo as aj,Ie as ak,ke as al,So as am,Pn as an,Po as ao,Eo as ap,Oo as aq,ve as ar,Le as as,li as at,On as au,Fe as av,Ce as aw,se as ax,Se as ay,En as az,$n as b,bn as c,Ua as d,Qa as e,Mn as f,y as g,m as h,qa as i,f as j,Mo as k,qo as l,eo as m,Ze as n,Ue as o,Me as p,M as q,ia as r,na as s,Xe as t,La as u,Da as v,Ao as w,gn as x,Fa as y,No as z};