/* Portfolio carousel styles (shared chrome with index) */
:root {
  /* --- Studio Wall / Frame (index-parity) ---
     IMPORTANT: `source/portfolio.html` loads `css/main.css` first in dev.
     We do NOT override shared chrome tokens here, otherwise sizes drift vs index. */
  
  /* Restore corner radius for portfolio page (simulation page uses 0) */
  --abs-radius-wall-min: 32px;
  --abs-wall-radius-vw: 3.7;

  /* --- Wheel Layout --- */
  --slider-max-height: 100dvh;
  --wheel-radius-x: 36vw;
  --wheel-radius-y: 14vh;
  /* Card spacing as ratio of card width (prevents overlap on small screens) */
  --wheel-spacing-ratio: 0.22;
  --wheel-spacing: max(calc(var(--card-width) * var(--wheel-spacing-ratio)), 7vw);
  --wheel-center-x: 0vw;
  --wheel-center-y: -6vh;
  --wheel-rotate: 12deg;
  --wheel-tilt: 60deg;
  --wheel-depth: 1;
  --wheel-active-lift: 2.5vh;
  --wheel-scale-min: 0.82;
  --wheel-scale-max: 1;
  --wheel-blur-max: 1.6vmin;
  --wheel-opacity-min: 0.2;
  --wheel-opacity-max: 1;
  --wheel-opacity-curve: 1.15;
  --wheel-scroll-speed: 0.65;
  --wheel-drag-speed: 0.9;
  --wheel-friction: 3;
  --wheel-snap-speed: 0.14;
  --wheel-snap-strength: 4;
  --wheel-bounce-strength: 16;
  --wheel-bounce-damping: 10;
  --wheel-bounce-impulse: 2.6vmin;

  /* --- Mouse Tilt --- */
  --mouse-tilt-pivot-z: 0vmin;

  /* --- Card Dimensions --- */
  /* Card width is derived from height + a locked aspect ratio (no vw-based resizing). */
  --card-aspect-w: 5;
  --card-aspect-h: 4;
  /* Absolute floor so cards never get too small (keeps carousel spacing/readability). */
  --card-height-floor: 216px;
  --card-height-min: 27vh;
  --card-height-ideal: 45vh;
  --card-height-max: 55vh;
  --card-height: max(var(--card-height-floor), clamp(var(--card-height-min), var(--card-height-ideal), var(--card-height-max)));
  --card-width: calc(var(--card-height) * var(--card-aspect-w) / var(--card-aspect-h));
  --corner-radius: 1.9vmin;
  --border-width: 0.6vmin;
  --card-content-inset: clamp(6px, 1vw, 12px);

  /* --- Appearance --- */
  --active-shadow-intensity: 0.2;
  --img-saturation: 100%;
  /* Light mode: dark borders on light background */
  --border-color: rgba(var(--abs-rgb-black), 0.2);
  --border-color-hover: rgba(var(--abs-rgb-black), 0.7);
  --card-hover-scale: 1.025; /* Scale increase on hover (2.5%) */
  --card-hover-lift: 0.6vmin; /* Z-axis movement towards user on hover (reduced by 92.5% total) */
  --card-press-lift: -0.6vmin; /* Z-axis movement away from user on press (opposite of hover) */
  --card-hover-shadow-intensity: 0.28;
  /* Map legacy background token to studio background for a matching inner surface. */
  --bg-color: var(--bg-light);
  --accent-color: var(--text-color-light);
  --cursor-color: var(--accent-color);
  --cursor-color-card-hover: rgba(var(--abs-rgb-white), 0.4);

  /* --- Typography --- */
  --text-client-size: 1.1vw;
  --text-title-size: 2.5vw;
  --text-tags-size: 0.9vw;
  --text-client-min: 12px;
  --text-client-max: 18px;
  --text-title-min: 22px;
  --text-title-max: 56px;
  --text-tags-min: 14px;
  --text-tags-max: 18px;
  /* Position meta in the bottom third of the viewport, centered in white space below cards */
  --content-offset: 8vh;
  --meta-lift: 0vh;
  --meta-padding: 0vmin;       /* Inner padding for the meta text block */
  --text-align: center;
  --meta-transition-speed: 360ms;

  /* --- Motion --- */
  --transition-speed: 600ms;
  --transition-ease: var(--ease-organic);
  --perspective: 1000px;
  --detail-max-width: 720px;
  --detail-transition-ms: 700ms;
  --detail-transition-fade-ms: 240ms;
  --detail-transition-fade-delay: 60ms;
  --detail-transition-blur: 8px;
  --detail-transition-cross-blur: 0.9vmin;
  --detail-transition-ease: var(--ease-gate);
  --detail-transition-ease-in: var(--ease-hesitant);
  --detail-transition-ease-out: var(--ease-gate);
  --detail-transition-shadow-opacity: 0.18;
  --detail-surface: var(--abs-surface-contrast);
  /* Detail content motion (scale + fade, no overshoot). */
  --detail-content-pop-duration: 360ms;
  --detail-content-pop-delay: 80ms;
  --detail-content-pop-delay-hero: 60ms;
  --detail-content-pop-delay-body: 90ms;
  --detail-content-pop-start-scale: 0.96;
  --detail-content-pop-overshoot-scale: 1;
  --detail-content-pop-ease: var(--ease-bounce);
  --detail-overlay-start-scale: 0.98;
  --detail-hero-height: 75vh;
  --detail-hero-width: 100%;
  --detail-hero-offset: 0%;
  --detail-hero-top-pad: 0px;
  --close-button-top: 0px;
  --close-button-left: 0px;
  --close-button-width: 100%;
  --close-button-height: 60px;
  --close-button-font-size: 14px;
  --close-button-icon-size: clamp(14px, 1.5vw, 16px);
}

/* Icons + base UI chrome are inherited from `css/main.css` (index parity). */

@keyframes braviaDotBounceIn {
  0% { transform: translate3d(-50%, 0, 0) scaleY(0); }
  60% { transform: translate3d(-50%, 0, 0) scaleY(1.2); }
  100% { transform: translate3d(-50%, 0, 0) scaleY(1); }
}

*, *::before, *::after {
  box-sizing: border-box;
  margin: 0;
  padding: 0;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

html {
  width: 100%;
  height: 100%;
  overflow: hidden;
  /* Single source of truth: wall/frame uses the same token in all themes. */
  background: var(--wall-color);
  background-color: var(--wall-color);
}

body {
  width: 100%;
  height: 100%;
  overflow: hidden;
  margin: 0;
  box-sizing: border-box;
  position: relative;
  /* Prevent iOS Safari from flashing browser-white during viewport UI changes. */
  background: var(--wall-color);
  background-color: var(--wall-color);
  font-family: var(--abs-font-sans);
  color: var(--accent-color);
  transition: background-color 0.3s var(--ease-settle);
  cursor: none;
  -webkit-user-select: none;
  user-select: none;
}

body.dark-mode {
  --bg-color: var(--bg-dark);
  --accent-color: var(--abs-neutral-100);
  /* Dark mode: light borders on dark background (inverted from light mode) */
  --border-color: rgba(var(--abs-rgb-white), 0.3);
  --border-color-hover: rgba(var(--abs-rgb-white), 1);
  --text-color-light-muted: var(--text-color-dark-muted);
  --text-color-light-base: var(--text-color-dark);
  --cursor-color-card-hover: rgba(var(--abs-rgb-white), 0.35);
}

/* Dark mode borders inherit from CSS variable (no !important needed) */
body.dark-mode .slide-image-container {
  border-color: var(--border-color);
}

body.dark-mode .slide:hover .slide-image-container {
  border-color: var(--border-color-hover);
}

body.dark-mode .slide:hover .slide-image-container::before {
  background: var(--border-color-hover);
  box-shadow: 0 0 0 var(--border-width) var(--border-color-hover), 0 0 calc(var(--border-width) * 2) rgba(var(--abs-rgb-white), 0.9);
}

/* Portfolio-specific logo colors and blur control (separate from index) */
body.portfolio-page #brand-logo {
  color: var(--portfolio-logo-color-light);
  /* Portfolio-specific logo blur control */
  filter: blur(var(--portfolio-logo-blur, 0px));
  /* Add filter transition to existing logo transitions */
  transition: 
    transform var(--abs-scene-impact-dur, 100ms) var(--abs-scene-impact-ease, var(--ease-gate)),
    opacity var(--gate-depth-out-duration, 250ms) var(--ease-gate),
    filter var(--gate-depth-out-duration, 250ms) var(--ease-gate);
}

body.portfolio-page.dark-mode #brand-logo {
  color: var(--portfolio-logo-color-dark);
}

/* Portfolio background text (edge-chapter, edge-copyright) - 20% transparent (80% opacity) */
body.portfolio-page .edge-chapter__text,
body.portfolio-page .edge-copyright__text {
  opacity: 0.8;
}

/* ═══════════════════════════════════════════════════════════════════════════════
   TOP NAVIGATION BAR
   Alexander Beck branding header with social icons, CV link, and title
   ═══════════════════════════════════════════════════════════════════════════════ */

.top-nav {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  z-index: 9000;
  background: transparent;
  padding: clamp(14px, 2.4vmin, 28px) clamp(18px, 3.6vmin, 36px);
  display: flex;
  align-items: center;
  justify-content: space-between;
  column-gap: clamp(18px, 3.2vw, 36px);
  pointer-events: none;
}

.top-nav * {
  pointer-events: auto;
}

.top-nav__left {
  display: flex;
  align-items: center;
  gap: clamp(8px, 1.5vw, 16px);
}

.top-nav__link {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  width: clamp(32px, 5vw, 44px);
  height: clamp(32px, 5vw, 44px);
  color: var(--accent-color);
  opacity: 0.7;
  transition: opacity 0.2s var(--ease-organic), 
              transform 0.2s var(--ease-organic),
              filter 0.15s var(--ease-organic),
              color 0.2s var(--ease-organic);
  text-decoration: none;
  position: relative;
  overflow: visible;
}

/* Light-up effect with gradient overlay */
.top-nav__link::before {
  content: '';
  position: absolute;
  inset: 0;
  border-radius: 50%;
  background: radial-gradient(
    circle at center,
    transparent 0%,
    transparent 50%,
    color-mix(in srgb, var(--cursor-color, var(--link-hover-color)) 20%, transparent 80%) 70%,
    color-mix(in srgb, var(--cursor-color, var(--link-hover-color)) 35%, transparent 65%) 100%
  );
  opacity: 0;
  transition: opacity 0.2s var(--ease-organic);
  pointer-events: none;
  z-index: 0;
}

body.dark-mode .top-nav__link::before {
  background: radial-gradient(
    circle at center,
    transparent 0%,
    transparent 50%,
    color-mix(in srgb, var(--cursor-color, var(--link-hover-color)) 15%, transparent 85%) 70%,
    color-mix(in srgb, var(--cursor-color, var(--link-hover-color)) 30%, transparent 70%) 100%
  );
}

.top-nav__link:hover {
  opacity: 1;
  transform: scale(1.05);
  color: var(--cursor-color, var(--link-hover-color));
}

.top-nav__link:hover::before {
  opacity: 1;
}

.top-nav__link:active {
  transform: scale(0.95);
  filter: blur(10px);
}

/* Keep icon above gradient */
.top-nav__link .top-nav__icon,
.top-nav__link svg {
  position: relative;
  z-index: 1;
}

.top-nav__icon {
  width: 100%;
  height: 100%;
  display: flex;
  align-items: center;
  justify-content: center;
}

.top-nav__icon svg {
  width: 60%;
  height: 60%;
}

.top-nav__cv {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  padding: clamp(8px, 1.5vw, 12px) clamp(16px, 3vw, 24px);
  font-family: 'Geist', sans-serif;
  font-size: clamp(13px, 1.8vw, 15px);
  font-weight: 600;
  letter-spacing: var(--letter-spacing-normal);
  text-transform: uppercase;
  color: var(--accent-color);
  text-decoration: none;
  border: 1.5px solid var(--abs-stroke-subtle);
  border-radius: var(--abs-radius-pill);
  background: var(--abs-surface-glass-balanced);
  -webkit-backdrop-filter: blur(20px);
  backdrop-filter: blur(20px);
  opacity: 0.85;
  transition: opacity 0.2s var(--ease-organic), 
              transform 0.2s var(--ease-organic), 
              background-color 0.2s var(--ease-settle),
              filter 0.15s var(--ease-organic);
}

.top-nav__cv:hover {
  opacity: 1;
  transform: scale(1.02);
  background: var(--abs-surface-glass-strong);
}

.top-nav__cv:active {
  transform: scale(0.95);
  filter: blur(10px);
}

body.dark-mode .top-nav__cv {
  border-color: var(--abs-stroke-medium-inverse);
  background: var(--abs-surface-glass-ghost);
}

body.dark-mode .top-nav__cv:hover {
  background: var(--abs-surface-glass-soft);
}

/* ═══════════════════════════════════════════════════════════════════════════════
   HEADING WRAPPER (Alexander Beck logo/title)
   Max 250px desktop, clamps down to 120px mobile, clickable to return to index
   ═══════════════════════════════════════════════════════════════════════════════ */

.heading-wrapper {
  display: none;
}

/* ═══════════════════════════════════════════════════════════════════════════════
   TEXT ANIMATIONS (40% faster with light overshoot)
   Original: 600-700ms → New: 360-420ms with overshoot easing
   ═══════════════════════════════════════════════════════════════════════════════ */

@keyframes heading-pop-in {
  0% {
    opacity: 0;
    transform: translateY(-8px) scale(0.96);
  }
  60% {
    opacity: 1;
    transform: translateY(0) scale(1.03);
  }
  100% {
    opacity: 1;
    transform: translateY(0) scale(1);
  }
}

@keyframes divider-grow {
  0% {
    opacity: 0;
    transform: scaleX(0);
  }
  60% {
    opacity: 1;
    transform: scaleX(1.06);
  }
  100% {
    opacity: 1;
    transform: scaleX(1);
  }
}

/* Cursor override: portfolio page uses custom cursor */
body.portfolio-page * {
  cursor: none;
  -webkit-user-select: none;
  user-select: none;
}

.screen-reader {
  position: absolute;
  width: 1px;
  height: 1px;
  padding: 0;
  margin: -1px;
  overflow: hidden;
  clip: rect(0, 0, 0, 0);
  white-space: nowrap;
  border: 0;
}

/* Frame container that mimics the index page wall inset. */
.wall-frame {
  position: fixed;
  top: var(--container-border-y, var(--container-border));
  left: var(--container-border-x, var(--container-border));
  right: var(--container-border-x, var(--container-border));
  bottom: var(--container-border-y, var(--container-border));
  border-radius: var(--container-radius);
  background-color: var(--bg-color, var(--bg-light, #f5f5f5));
  background: var(--bg-color, var(--bg-light, #f5f5f5));
  overflow: hidden;
  box-sizing: border-box;
  z-index: 0;
  isolation: isolate;
  touch-action: none;
  opacity: 1;
  visibility: visible;
}

body.dark-mode .wall-frame {
  background-color: var(--bg-color, var(--bg-dark, #0a0a0a));
  background: var(--bg-color, var(--bg-dark, #0a0a0a));
}

body.detail-open .wall-frame {
  touch-action: pan-y;
}

/* --- Slider Stage --- */
.portfolio-stage {
  position: absolute;
  /* Fill the padded interior of #fade-content, centered vertically */
  left: 0;
  right: 0;
  top: 0;
  bottom: 0;
  padding: 0;
  display: flex;
  align-items: center;
  justify-content: center;
  height: 100%;
  width: 100%;
  z-index: 5; /* Above the centered brand logo (background), below UI (#fade-content). */
  opacity: 1;
  visibility: visible;
}

/* --- Viewport & Track --- */
.portfolio-viewport {
  /* Fill the stage container */
  position: relative;
  width: 100%;
  height: 100%;
  max-height: var(--slider-max-height, 100dvh);
  padding-bottom: clamp(96px, 12vh, 160px);
  display: flex;
  align-items: center;
  perspective: var(--perspective);
  background-color: transparent;
  border-radius: var(--container-radius); /* clip to wall shape so walls sit in front */
  overflow: hidden; /* keep carousel behind the wall edges */
  z-index: 1;
  cursor: grab;
  touch-action: none;
  overscroll-behavior: none;
  pointer-events: auto;
}

.portfolio-viewport.is-dragging {
  cursor: grabbing;
  -webkit-user-select: none;
  user-select: none;
}


.slider-track {
  position: relative;
  width: 100%;
  height: 100%;
  will-change: transform;
  transform-style: preserve-3d;
}

/* Centered 3D rig: this is the actual carousel "object" that we tilt. */
.slider-rig {
  position: absolute;
  left: 50%;
  top: 50%;
  width: 1px;
  height: 1px;
  overflow: visible;
  transform-style: preserve-3d;
  will-change: transform;
}

/* Cylinder dots container - shares same 3D space as carousel */
.cylinder-dots-container {
  position: absolute;
  left: 50%;
  top: 50%;
  width: 1px;
  height: 1px;
  overflow: visible;
  transform-style: preserve-3d;
  pointer-events: none;
}

/* Individual cylinder dot */
.cylinder-dot {
  position: absolute;
  left: 0;
  top: 0;
  transform-style: preserve-3d;
  backface-visibility: hidden;
}

/* --- Slides --- */
.slide {
  --slide-x: 0vw;
  --slide-y: 0vh;
  --slide-z: 0vmin;
  --slide-scale: 1;
  --slide-rotate: 0deg;
  --slide-blur: 0vmin;
  --slide-opacity: 1;
  position: absolute;
  left: 0;
  top: 0;
  width: var(--card-width);
  height: var(--card-height);
  aspect-ratio: var(--card-aspect-w) / var(--card-aspect-h);
  cursor: pointer;
  transform-origin: center;
  opacity: var(--slide-opacity);
  transform:
    translate3d(var(--slide-x), var(--slide-y), var(--slide-z))
    translate(-50%, -50%)
    rotate(var(--slide-rotate))
    scale(var(--slide-scale));
  filter: blur(var(--slide-blur));
  will-change: transform, filter, opacity;
  /* Smooth transition for hover scale effect - only when not actively animating */
  transition: transform 0.3s var(--ease-organic);
}

/* Base transition for card press effect (same as links) - only when not active */
.slide:not(:active) {
  transition: transform var(--link-impact-duration) var(--ease-organic),
              filter var(--link-impact-duration) var(--ease-organic);
}

/* Card press effect: scale down, blur, and move backward (opposite direction of hover) */
/* Preserves all transform values but adds backward Z movement and applies scale/blur */
.slide:active {
  transform: 
    translate3d(var(--slide-x), var(--slide-y), calc(var(--slide-z) + var(--card-press-lift, -0.6vmin)))
    translate(-50%, -50%)
    rotate(var(--slide-rotate))
    scale(calc(var(--slide-scale) * var(--link-impact-scale)));
  filter: blur(var(--link-impact-blur));
  transition: transform var(--link-impact-duration) var(--ease-organic),
              filter var(--link-impact-duration) var(--ease-organic);
}

.slide:focus-visible {
  outline: 0.3vmin solid var(--accent-color);
  outline-offset: 0.6vmin;
}

.slide.active {
  z-index: 10;
}

/* Slide scales up when clicked (before detail overlay fully covers it) */
/* Only animates Z-axis forward and scale - X/Y are frozen by JS */
.slide.is-expanding {
  z-index: 11;
  pointer-events: auto; /* Ensure card remains clickable during expansion */
  transition:
    transform var(--detail-transition-ms) var(--detail-transition-ease),
    opacity var(--detail-transition-ms) var(--detail-transition-ease),
    filter var(--detail-transition-ms) var(--detail-transition-ease);
}

.slide.is-collapsing {
  z-index: 11;
  transition:
    transform var(--detail-transition-ms) var(--detail-transition-ease),
    opacity var(--detail-transition-ms) var(--detail-transition-ease),
    filter var(--detail-transition-ms) var(--detail-transition-ease);
}

.slide-image-container {
  box-sizing: border-box;
  padding: 0;
  width: 100%;
  height: 100%;
  border-radius: var(--corner-radius);
  border: var(--border-width) solid var(--border-color);
  overflow: hidden;
  position: relative;
  background: var(--bg-color);
  box-shadow: none;
  transition: 
    border-width var(--transition-speed) var(--transition-ease), 
    border-color 0.35s var(--ease-organic), 
    border-radius 0.3s var(--ease-organic), 
    opacity 140ms var(--ease-settle);
  opacity: 1;
  transform-origin: center;
  will-change: transform, opacity, filter;
  isolation: isolate;
}

/* Glowing border on hover using pseudo-element - transparent light effect */
.slide-image-container::before {
  content: '';
  position: absolute;
  inset: calc(-1 * var(--border-width));
  border-radius: var(--corner-radius);
  background: var(--border-color-hover);
  opacity: 0;
  z-index: 0;
  transition: opacity 0.35s var(--ease-organic);
  pointer-events: none;
  /* Add subtle glow effect */
  box-shadow: 0 0 0 var(--border-width) var(--border-color-hover), 0 0 calc(var(--border-width) * 2) var(--border-color-hover);
}

.slide-image-container .slide-image {
  position: relative;
  z-index: 1;
}

.slide:hover .slide-image-container::before {
  opacity: 1;
}

@keyframes slide-gradient-move {
  0% {
    background-position: 0% 0%;
  }
  100% {
    background-position: 200% 0%;
  }
}

/* Card hover effect: pull towards user with accent border */
.slide:hover {
  z-index: 12;
  /* Override any blur effect when hovering - always show sharp on hover */
  --slide-blur: 0vmin;
  filter: blur(0);
}

.slide:hover .slide-image-container {
  border-color: var(--border-color-hover);
  box-shadow: none;
}

.slide:hover .slide-image {
  filter: saturate(calc(var(--img-saturation) * 1.08));
}

/* Noise removed from cards - noise only appears on wall-frame background (behind and in front of cards) */
.slide-image-container::after {
  display: none;
}

.slide-image {
  width: 100%;
  height: 100%;
  object-fit: cover;
  object-position: center;
  transition: filter var(--transition-speed) var(--transition-ease);
  filter: saturate(var(--img-saturation));
}

/* --- Fixed Metadata --- 
   Positioned in the white space below the carousel, above the footer.
   Uses absolute positioning within wall-frame. */
.portfolio-meta {
  position: absolute;
  left: 50%;
  top: auto;
  /* Position from bottom of wall-frame: above footer content */
  bottom: 80px;
  --meta-shift: 0vh;
  transform: translateX(-50%) translateY(var(--meta-shift));
  width: 100%;
  max-width: clamp(280px, 82vw, 720px);
  text-align: var(--text-align);
  opacity: 1;
  filter: blur(0);
  transition: opacity var(--meta-transition-speed) var(--transition-ease),
    transform var(--meta-transition-speed) var(--transition-ease),
    filter var(--meta-transition-speed) var(--transition-ease);
  pointer-events: none;
  z-index: 15;
}

.portfolio-meta__inner {
  display: grid;
  gap: 12px;
  padding: var(--meta-padding);
}

.portfolio-meta.is-switching {
  opacity: 0;
  --meta-shift: 2vh;
  filter: blur(1.2vmin);
}

.meta-client {
  display: block;
  font-family: 'Geist', sans-serif;
  font-weight: 500;
  font-size: 13px;
  text-transform: uppercase;
  letter-spacing: var(--letter-spacing-loose);
  color: var(--text-muted);
}

.meta-title {
  display: block;
  font-family: 'Geist', sans-serif;
  font-weight: 400;
  font-size: var(--text-xl);
  line-height: var(--line-height-title);
  letter-spacing: var(--letter-spacing-tight);
  text-transform: none;
  color: var(--text-primary);
}

.meta-summary {
  display: block;
  font-family: 'Geist', sans-serif;
  font-size: clamp(var(--text-tags-min), var(--text-tags-size), var(--text-tags-max));
  line-height: var(--line-height-summary);
  letter-spacing: var(--letter-spacing-normal);
  opacity: 0.9;
  color: var(--text-primary);
}

/* --- Project Detail --- */
.project-detail {
  position: absolute;
  inset: 0;
  z-index: 50; /* Force above everything including 3D carousel */
  opacity: 0;
  pointer-events: none;
  background: var(--bg-light);
  will-change: opacity, transform;
  transform: scale(var(--detail-overlay-start-scale));
  transition:
    opacity var(--detail-transition-ms) var(--detail-transition-ease),
    transform var(--detail-transition-ms) var(--detail-transition-ease);
}

body.dark-mode .project-detail {
  background: var(--bg-dark);
}

.project-detail.is-open {
  opacity: 1;
  transform: scale(1);
  pointer-events: auto;
}

.project-detail__card {
  position: absolute;
  inset: 0;
  background: transparent;
  border-radius: 0;
  box-shadow: none;
  overflow: hidden;
}

.project-detail__close {
  position: fixed;
  top: clamp(16px, 2vw, 24px);
  left: 50%;
  transform: translateX(-50%);
  width: clamp(52px, 5vw, 72px);
  height: clamp(52px, 5vw, 72px);
  z-index: 15;
  background: rgba(var(--abs-rgb-white), 0.1);
  -webkit-backdrop-filter: blur(20px);
  backdrop-filter: blur(20px);
  border: none;
  border-radius: 50%;
  color: var(--text-soft);
  padding: clamp(18px, 2.2vw, 28px);
  font-weight: 500;
  cursor: pointer;
  display: none;
  align-items: center;
  justify-content: center;
  transition:
    opacity 200ms var(--ease-settle),
    color 200ms var(--ease-settle),
    transform var(--link-impact-duration) var(--ease-organic),
    filter var(--link-impact-duration) var(--ease-organic);
}

/* Prevent `link-cursor-hop` (abs-hover-mode-ui) from overriding fixed positioning.
   Without this, hovering the close/back button can switch it to `position:relative`,
   forcing layout reflow and creating a visible “gap” at the top. */
body.abs-hover-mode-ui .project-detail__close.abs-hover-target--ui {
  position: fixed;
  z-index: 15;
}

/* Match other icon controls: circular cursor-color background on hover (UI mode). */
body.abs-hover-mode-ui .project-detail__close.abs-hover-target--ui::before {
  border-radius: 50%;
  opacity: 1;
}

/* Press effect (must preserve translateX(-50%)).
   Use higher specificity to override global button:active styles. */
body.portfolio-page .project-detail__close:active {
  transform: translateX(-50%) scale(var(--link-impact-scale));
  filter: blur(var(--link-impact-blur));
}

/* Keep press effect consistent even while hovered in UI hover-mode. */
body.portfolio-page.abs-hover-mode-ui .project-detail__close.abs-hover-target--ui:active {
  transform: translateX(-50%) scale(var(--link-impact-scale));
  filter: blur(var(--link-impact-blur));
}

.close-icon {
  font-size: var(--icon-size-base);
  width: 1em;
  height: 1em;
  display: inline-flex;
  align-items: center;
  justify-content: center;
}

.project-detail.is-open .project-detail__close {
  display: flex;
}

.project-detail__close:hover {
  color: var(--text-strong);
}

/* Dark-mode close button colors are token-driven via `--text-*` variables. */

.project-detail__scroller {
  height: 100%;
  overflow-y: auto;
  overflow-x: hidden;
  touch-action: pan-y;
}

.project-detail__inner {
  width: 100%;
  padding: 0 0 120px;
  display: flex;
  flex-direction: column;
  gap: 32px;
  transform-origin: center top;
  will-change: transform, opacity;
  opacity: 0;
  transform: scale(var(--detail-content-pop-start-scale));
  transition:
    opacity var(--detail-content-pop-duration) var(--detail-content-pop-ease) var(--detail-content-pop-delay),
    transform var(--detail-content-pop-duration) var(--detail-content-pop-ease) var(--detail-content-pop-delay);
}

.project-detail.is-open .project-detail__inner {
  opacity: 1;
  transform: scale(1);
}

.project-detail__content {
  width: 100%;
  max-width: var(--detail-max-width);
  margin: 0 auto;
  padding: 0 24px;
  display: flex;
  flex-direction: column;
  gap: 32px;
}

.project-detail__content--hero {
  padding-top: 0;
  max-width: min(92vw, 1100px);
}

.project-detail__content--body {
  padding-top: 24px;
}

.project-detail__hero {
  display: grid;
  gap: clamp(20px, 4vw, 36px);
  padding-top: var(--detail-hero-top-pad);
  opacity: 1;
  transform: none;
}

.project-detail__media {
  width: var(--detail-hero-width);
  margin-left: var(--detail-hero-offset);
  max-width: none;
  border-radius: 0;
  border: none;
  overflow: hidden;
  background: transparent;
  position: relative;
  height: var(--detail-hero-height);
  box-shadow: none;
}

.project-detail__media::after {
  /* Match slide/transition noise treatment to avoid a perceptual "brightening pulse"
     when the transition layer fades out and the detail hero becomes visible. */
  content: none;
  position: absolute;
  inset: var(--abs-noise-overscan);
  background-image: var(--abs-noise-texture);
  background-repeat: repeat;
  background-attachment: scroll;
  background-size: calc(var(--noise-size-top) * var(--noise-size-scale)) calc(var(--noise-size-top) * var(--noise-size-scale));
  /* Detail view already has back/front noise layers. Keeping this hero-only layer at 0
     prevents stacking noise (too dark/prominent) and matches index/portfolio exactly. */
  opacity: calc(var(--noise-front-opacity-light) * var(--abs-noise-enabled) * var(--detail-media-noise-opacity, 0));
  mix-blend-mode: multiply;
  pointer-events: none;
  will-change: transform, opacity;
  transform: translate3d(0, 0, 0);
  filter: var(--abs-noise-filter);
  animation-name: var(--abs-noise-keyframes), abs-noise-flicker;
  animation-duration: var(--abs-noise-speed-front), var(--abs-noise-flicker-speed);
  animation-timing-function: var(--abs-noise-timing), steps(2);
  animation-iteration-count: infinite, infinite;
}

body.dark-mode .project-detail__media::after {
  opacity: calc(var(--noise-front-opacity-dark) * var(--abs-noise-enabled) * var(--detail-media-noise-opacity, 0));
  mix-blend-mode: overlay;
}

/* Detail noise layers (background → content → front) */
.project-detail__noise {
  position: absolute;
  inset: 0;
  pointer-events: none;
  overflow: hidden;
  z-index: 1; /* Behind content */
}

.project-detail__noise--back {
  z-index: 1;
  opacity: calc(var(--noise-back-opacity-light) * var(--abs-noise-enabled) * var(--detail-noise-opacity, 1));
  mix-blend-mode: multiply;
}

.project-detail__noise--front {
  z-index: 51; /* Above content (z:50) */
  opacity: calc(var(--noise-front-opacity-light) * var(--abs-noise-enabled) * var(--detail-noise-opacity, 1));
  mix-blend-mode: multiply;
}

body.dark-mode .project-detail__noise--back {
  opacity: calc(var(--noise-back-opacity-dark) * var(--abs-noise-enabled) * var(--detail-noise-opacity, 1));
  mix-blend-mode: overlay;
}

body.dark-mode .project-detail__noise--front {
  opacity: calc(var(--noise-front-opacity-dark) * var(--abs-noise-enabled) * var(--detail-noise-opacity, 1));
  mix-blend-mode: overlay;
}

.project-detail__noise::before {
  content: '';
  position: absolute;
  inset: var(--abs-noise-overscan);
  background-image: var(--abs-noise-texture);
  background-repeat: repeat;
  background-attachment: scroll;
  pointer-events: none;
  will-change: transform, opacity;
  transform: translate3d(0, 0, 0);
  filter: var(--abs-noise-filter);
  animation-name: var(--abs-noise-keyframes), abs-noise-flicker;
  animation-duration: var(--abs-noise-speed-back), var(--abs-noise-flicker-speed);
  animation-timing-function: var(--abs-noise-timing), steps(1, end);
  animation-iteration-count: infinite, infinite;
}

.project-detail__noise--back::before {
  background-size: calc(var(--noise-size-base) * var(--noise-size-scale)) calc(var(--noise-size-base) * var(--noise-size-scale));
  animation-duration: var(--abs-noise-speed-back), var(--abs-noise-flicker-speed);
}

.project-detail__noise--front::before {
  background-size: calc(var(--noise-size-top) * var(--noise-size-scale)) calc(var(--noise-size-top) * var(--noise-size-scale));
  animation-duration: var(--abs-noise-speed-front), var(--abs-noise-flicker-speed);
}

.project-detail__image {
  width: 100%;
  height: 100%;
  object-fit: cover;
  object-position: center;
  display: block;
  filter: saturate(var(--img-saturation));
}

.project-detail__media video {
  width: 100%;
  height: 100%;
  object-fit: cover;
  display: block;
}

.project-detail__intro {
  display: flex;
  flex-direction: column;
  gap: 16px;
  padding-top: 40px;
  padding-bottom: 40px;
}

.project-detail__eyebrow {
  font-size: clamp(11px, 1vw, 13px);
  letter-spacing: var(--letter-spacing-loose);
  text-transform: uppercase;
  opacity: 1;
  color: var(--text-primary);
  text-align: center;
}

.project-detail__title {
  font-size: 80px;
  line-height: var(--line-height-display);
  font-weight: 400;
  letter-spacing: var(--letter-spacing-tight);
  vertical-align: middle;
  text-align: center;
  color: var(--text-primary);
}

.project-detail__summary {
  font-size: clamp(16px, 1.7vw, 20px);
  line-height: var(--line-height-body-relaxed);
  opacity: 0.75;
  max-width: 62ch;
  color: var(--text-primary);
}

.project-detail__meta {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
  gap: 16px;
  margin-top: 6px;
  text-align: center;
}

.project-detail__meta-item dt {
  font-size: 10px;
  letter-spacing: var(--letter-spacing-loose);
  text-transform: uppercase;
  opacity: 1;
  color: var(--text-muted);
  font-weight: 500;
  margin-bottom: 6px;
}

.project-detail__meta-item dd {
  font-size: 14px;
  font-weight: 400;
  color: var(--text-primary);
}

.project-detail__body {
  opacity: 1;
  transform: none;
}


.project-detail__overview h2,
.project-detail__takeaways h2 {
  font-size: 18px;
  text-transform: uppercase;
  letter-spacing: var(--letter-spacing-loose);
  margin-bottom: 12px;
  color: var(--text-primary);
}

.project-detail__overview p {
  font-size: 16px;
  line-height: var(--line-height-body-relaxed);
  opacity: 0.8;
  color: var(--text-primary);
}

.project-detail__links {
  display: flex;
  flex-wrap: wrap;
  gap: 12px;
}

.project-detail__links a {
  padding: 8px 16px;
  border-radius: var(--abs-radius-pill);
  border: 1px solid var(--abs-stroke-hairline);
  text-decoration: none;
  color: var(--accent-color);
  font-size: 12px;
  font-weight: 600;
  text-transform: uppercase;
  letter-spacing: var(--letter-spacing-loose);
  background: rgba(var(--abs-rgb-white), 0.8);
}

.project-detail__stack {
  display: grid;
  gap: 28px;
}

.project-detail__block {
  margin: 0;
  display: grid;
  gap: 10px;
}

.project-detail__media-block,
.project-detail__video {
  width: 100%;
  border-radius: 22px;
  display: block;
  background: transparent;
  box-shadow: none;
}

.project-detail__caption {
  font-size: 13px;
  opacity: 0.6;
  color: var(--text-muted);
}

.project-detail__takeaways ul {
  list-style: disc;
  padding-left: 20px;
  display: grid;
  gap: 10px;
  font-size: 16px;
  line-height: var(--line-height-body);
  opacity: 0.8;
  color: var(--text-primary);
}

/* Keep index-style chrome visible while a project detail is open.
   (Index never hides header/footer; portfolio should match that UX.) */
body.detail-open .ui-top,
body.detail-open .portfolio-footer {
  opacity: 1;
  pointer-events: auto;
}

.portfolio-header__actions {
  display: inline-flex;
  align-items: center;
  gap: var(--gap-lg);
  pointer-events: auto;
  flex-wrap: wrap;
}

.portfolio-sound-slot {
  display: inline-flex;
  align-items: center;
}

/* ─────────────────────────────────────────────────────────────────────────────
   PORTFOLIO CHROME
   Portfolio uses the SAME header/footer chrome as index (inherited from main.css).
   Only portfolio-specific positioning tweaks are defined here.
   ───────────────────────────────────────────────────────────────────────────── */

/* Portfolio #fade-content: flex container for header/footer with content area */
body.portfolio-page #fade-content {
  display: flex;
  flex-direction: column;
  justify-content: space-between;
  position: absolute;
  inset: 0;
  width: 100%;
  height: 100%;
  box-sizing: border-box;
  padding: var(--content-padding);
  pointer-events: none;
  z-index: 20;
}

/* Re-enable pointer events on interactive elements */
body.portfolio-page #fade-content a,
body.portfolio-page #fade-content button,
body.portfolio-page #fade-content [role="button"] {
  pointer-events: auto;
}

/* Portfolio header: back arrow on left, Bio/CV + sound on right */
body.portfolio-page .ui-top-left {
  display: flex;
  flex-direction: row;
  align-items: flex-start;
  gap: var(--gap-sm);
}

/* Blurb: same styling as index decorative-script */
#portfolio-blurb {
  padding-top: 0;
  padding-bottom: 0;
}

/* Portfolio footer inherits index footer styles via main.css */

/* Bio/CV link next to sound icon (portfolio header) */
.portfolio-cv-link {
  position: relative;
  display: inline-block;
  padding-block: var(--hit-area-lg);
  padding-inline: var(--hit-area-lg);
  margin-block: calc(var(--hit-area-lg) * -1);
  margin-inline: calc(var(--hit-area-lg) * -1);
  margin: 0;
  font-family: 'Geist', sans-serif;
  font-size: var(--footer-links-font-size);
  font-weight: 400;
  letter-spacing: var(--footer-links-letter-spacing);
  text-decoration: none;
  color: var(--text-primary);
  opacity: var(--text-opacity-base);
  pointer-events: auto;
  cursor: none;
  transition: transform 0.15s var(--ease-organic),
              filter 0.15s var(--ease-organic);
}

.gate-back {
  appearance: none;
  border: 0;
  background: transparent;
  /* Match the primary icon-link hit-area sizing (e.g. footer socials). */
  width: var(--footer-icon-size);
  height: var(--footer-icon-size);
  padding: var(--link-icon-padding);
  margin: 0;
  display: inline-flex;
  justify-content: center;
  align-items: center;
  position: relative;
  cursor: pointer;
  -webkit-user-select: none;
  user-select: none;
  color: var(--text-quiet);
  pointer-events: auto;
  flex: 0 0 var(--footer-icon-size);
  text-decoration: none;
  overflow: visible;
}

.gate-back::after {
  content: '';
  position: absolute;
  bottom: calc(var(--dot-indicator-offset) * -1);
  left: 50%;
  transform: translate3d(-50%, 0, 0) scaleY(0);
  transform-origin: 50% 50%;
  width: var(--abs-cursor-hop-dot-size, var(--dot-indicator-size));
  height: var(--abs-cursor-hop-dot-size, var(--dot-indicator-size));
  border-radius: 50%;
  background: var(--cursor-color, var(--link-hover-color));
  opacity: 0;
  will-change: transform, opacity;
}

.gate-back:hover::after {
  opacity: 1;
  animation: braviaDotBounceIn var(--dot-bounce-duration) var(--ease-bounce) both;
}

.gate-back span {
  display: none;
}

.gate-back i.ti {
  font-weight: 500;
  font-size: var(--icon-size-base);
}

.gate-back:focus-visible {
  outline: 0.2vmin solid rgba(var(--abs-rgb-black), 0.35);
  outline-offset: 0.4vmin;
  border-radius: 0.6vmin;
}

body.dark-mode .gate-back:focus-visible {
  outline-color: rgba(var(--abs-rgb-white), 0.35);
}

.footer_link {
  position: relative;
  transform: none;
  padding-block: var(--hit-area-lg);
  padding-inline: var(--hit-area-lg);
  margin-block: calc(var(--hit-area-lg) * -1);
  margin-inline: calc(var(--hit-area-lg) * -1);
  display: inline-block;
  color: var(--text-muted);
  font-size: var(--footer-links-font-size);
  font-weight: 400;
  letter-spacing: var(--footer-links-letter-spacing);
  text-decoration: none;
  opacity: var(--text-opacity-base);
  transition: transform 0.15s var(--ease-organic),
              filter 0.15s var(--ease-organic);
  cursor: none;
  pointer-events: auto;
}

.footer_link::after {
  content: '';
  position: absolute;
  bottom: var(--footer-link-dot-offset);
  left: 50%;
  transform: translate3d(-50%, 0, 0) scaleY(0);
  transform-origin: 50% 50%;
  width: var(--abs-cursor-hop-dot-size, var(--footer-link-dot-size));
  height: var(--abs-cursor-hop-dot-size, var(--footer-link-dot-size));
  border-radius: 50%;
  background: var(--cursor-color, var(--link-hover-color));
  opacity: 0;
  will-change: transform, opacity;
}

.footer_link:hover {
  /* No color change - keep colors as-is */
  opacity: 1;
}

.footer_link:hover::after {
  opacity: 1;
  animation: braviaDotBounceIn var(--dot-bounce-duration) var(--ease-bounce) both;
}

.sound-toggle {
  position: relative;
  top: auto;
  left: auto;
  transform: none;
  margin: 0;
  padding: var(--hit-area-sm);
  color: var(--text-quiet);
  font-family: 'Geist', sans-serif;
  cursor: none;
  background: none;
  border: none;
  pointer-events: auto;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  font-size: var(--icon-size-base);
}

.sound-toggle::after {
  content: none;
}

.sound-toggle[data-enabled="true"] {
  color: var(--link-hover-color);
}

body.dark-mode .sound-toggle[data-enabled="true"] {
  color: var(--link-hover-color);
}

/* Footer chrome is inherited from `css/main.css` (index parity).
   Keep only the portfolio-specific hide behavior when detail is open. */

.pill-nav {
  position: absolute;
  left: 50%;
  transform: translateX(-50%);
  background: rgba(var(--abs-rgb-black), 0.05);
  padding: 5px;
  border-radius: var(--abs-radius-pill);
  display: flex;
  gap: 5px;
  pointer-events: auto;
  -webkit-backdrop-filter: blur(5px);
  backdrop-filter: blur(5px);
}

.pill-link {
  padding: 8px 24px;
  border-radius: 100px;
  text-decoration: none;
  font-size: 14px;
  font-weight: 600;
  color: var(--accent-color);
  opacity: 0.5;
  transition: all 0.2s var(--ease-organic);
}

.pill-link.active {
  background: var(--abs-surface-contrast);
  opacity: 1;
  box-shadow: none;
}

/* ═══════════════════════════════════════════════════════════════════════════════
   MOBILE RESPONSIVE — Portfolio
   Minimal overrides for card sizing and layout on smaller screens.
   Header/footer chrome inherits from main.css (index parity).
   ═══════════════════════════════════════════════════════════════════════════════ */
@media (max-width: 768px) {
  :root {
    /* Mobile: smaller cards to fit on screen */
    --card-height-floor: 180px;
    --card-height-min: 28vh;
    --card-height-ideal: 38vh;
    --card-height-max: 45vh;
    --wheel-radius-x: 44vw;
    --wheel-radius-y: 16vh;
    --wheel-spacing-ratio: 0.18;
    --wheel-center-y: -3vh;
    --wheel-tilt: 52deg;
    --detail-hero-width: 100%;
    --detail-hero-offset: 0%;
    --detail-hero-top-pad: 0px;
  }

  .project-detail__inner {
    padding: 0 0 100px;
  }

  .project-detail__content {
    padding: 0 18px;
  }

  .project-detail__content--hero {
    padding-top: 0;
  }

  .project-detail__content--body {
    padding-top: 18px;
  }

  .project-detail__meta {
    grid-template-columns: repeat(2, minmax(0, 1fr));
  }
}

/* Small phones: hide blurb, keep layout minimal */
@media (max-width: 480px) {
  :root {
    --card-height-floor: 150px;
    --card-height-min: 24vh;
    --card-height-ideal: 32vh;
    --card-height-max: 38vh;
    --wheel-radius-x: 40vw;
    --wheel-radius-y: 14vh;
    --wheel-tilt: 48deg;
    --wheel-center-y: -2vh;
  }

  /* Hide blurb on very small phones */
  body.portfolio-page .decorative-script {
    display: none;
  }
}

@media (prefers-reduced-motion: reduce) {
  .slide,
.portfolio-meta,
.project-detail,
/* Disable transitions/animations during detail transitions for performance */
body.detail-transitioning .project-detail__card,
body.detail-transitioning .project-detail__inner,
body.detail-transitioning .project-detail__hero,
body.detail-transitioning .project-detail__body,
body.detail-transitioning .project-transition,
body.detail-transitioning .slide-image-container {
  transition: none;
}

body.detail-transitioning .project-detail__hero,
body.detail-transitioning .project-detail__body,
body.detail-transitioning .project-detail__inner {
  animation: none;
}
}

/* Custom Cursor (portfolio uses dialog cursor from index) */
#custom-cursor {
  position: fixed;
  pointer-events: none;
  z-index: 30000;
  border: none;
  background: var(--cursor-color);
  transform-origin: center center;
  transform:
    translate(-50%, -50%)
    translate(var(--cursor-jitter-x, 0px), var(--cursor-jitter-y, 0px))
    scale(var(--cursor-scale, 1))
    scaleX(var(--cursor-stretch-x, 1))
    scaleY(var(--cursor-stretch-y, 1));
  opacity: 0.85;
  transition: transform 0.35s var(--ease-hesitant),
              opacity 0.35s var(--ease-hesitant),
              width 0.35s var(--ease-hesitant),
              height 0.35s var(--ease-hesitant),
              background 0.35s var(--ease-hesitant);
  will-change: transform, opacity, width, height, background;
  width: 20px;
  height: 20px;
  border-radius: 50%;
}

/* Gate active cursor: larger, glassy appearance */
body.portfolio-page #custom-cursor.gate-active {
  display: block;
  width: 48px;
  height: 48px;
  background: var(--abs-surface-glass-balanced);
  border: 1.5px solid var(--abs-stroke-highlight-inverse);
  transform:
    translate(-50%, -50%)
    translate(var(--cursor-jitter-x, 0px), var(--cursor-jitter-y, 0px))
    scale(var(--cursor-scale, 1))
    scaleX(var(--cursor-stretch-x, 1))
    scaleY(var(--cursor-stretch-y, 1));
  opacity: 1;
}

/* Subtle cursor change when hovering portfolio cards - transparency only, no orange */
body.portfolio-page.portfolio-card-hovering #custom-cursor {
  background: var(--cursor-color-card-hover);
  width: 24px;
  height: 24px;
  opacity: 0.6;
}

/* Link hover behavior is centralized in `css/main.css` and toggled by
   `body.abs-hover-mode-index` / `body.abs-hover-mode-ui` (set by JS). */
