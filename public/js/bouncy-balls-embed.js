(()=>{const t=-1e9,e=.25,n=.2,a=document.getElementById("c"),o=a.getContext("2d",{alpha:!0}),i=document.getElementById("controlPanel"),s=Math.max(1,Math.min(2,window.devicePixelRatio||1));let l=50,r=-50,h=100,d=50;function c(){const t=1.5*window.innerHeight;a.width=Math.floor(window.innerWidth*s),a.height=Math.floor(t*s)}c(),window.addEventListener("resize",()=>{c(),T(),A(),nt()});let u=.88,m=.003,f=.03,p=400;const g=.5*s,y=6,x=24;let v=2,M=.15,E=1,b=null,C=11.2;const I=.15;let S=1;function w(){S=Math.max(.5,Math.min(3,Math.pow(C/1,.35)))}w();let B=y*v,L=x*v;function T(){E=(a.clientWidth||window.innerWidth)<=768?.4:1;const t=v*E;if(null===b)return b=t,B=y*t,void(L=x*t);const e=t/b;if(1!==e){for(let t=0;t<At.length;t++)At[t].r*=e;b=t}B=y*t,L=x*t}function A(){it=[];const t=document.querySelector(ot);if(!t)return;const e=t.getBoundingClientRect(),n=a.getBoundingClientRect(),o=function(t){const e=document.createElement("span");e.style.cssText=window.getComputedStyle(t).cssText,e.style.position="absolute",e.style.visibility="hidden",e.style.whiteSpace="nowrap",e.textContent="ABCDEFGHIJKLMNOPQRSTUVWXYZ",document.body.appendChild(e);const n=e.getBoundingClientRect().height;return document.body.removeChild(e),n}(t),i=.5*(e.height-o),l={x:(e.left-n.left)*s,y:(e.top-n.top+i)*s,width:e.width*s,height:o*s};l.width>0&&l.height>0&&l.x<a.width&&l.y<a.height&&l.x+l.width>0&&l.y+l.height>0&&it.push(l)}let F=0,V=1;const q={industrialTeal:{label:"Industrial Teal",colors:["#b7bcb7","#e4e9e4","#ffffff","#00695c","#000000","#ff4013","#0d5cb6","#ffa000"]},modern:{label:"Modern European",colors:["#9ca3af","#d1d5db","#ffffff","#ff3b30","#000000","#00e5ff","#1976d2","#ffc107"]},corporate:{label:"Corporate Modern",colors:["#a0a8b1","#d2d8de","#ffffff","#1a73e8","#000000","#ff5722","#7b1fa2","#ffa000"]},minimal:{label:"Helvetica Minimal",colors:["#bdbdbd","#e0e0e0","#ffffff","#6b7280","#000000","#40e0d0","#303f9f","#ff9800"]},euroBlue:{label:"European Blue",colors:["#9aa6b2","#d4dde5","#ffffff","#0a66c2","#000000","#ff4081","#388e3c","#ffb300"]},scandi:{label:"Scandinavian Bright",colors:["#aab2b7","#e6eaee","#ffffff","#74b9ff","#000000","#e91e63","#1976d2","#4caf50"]},neonCyan:{label:"Graphite Neon Cyan",colors:["#9aa0a6","#d5d9dd","#ffffff","#00e5ff","#000000","#ff9800","#9c27b0","#4caf50"]},coralTech:{label:"Coral Tech",colors:["#9da3a9","#d8dde2","#ffffff","#ff6b6b","#000000","#00e676","#3f51b5","#ff5722"]},violetMidnight:{label:"Violet Midnight",colors:["#9fa3b1","#d9dce3","#ffffff","#7c3aed","#000000","#e91e63","#388e3c","#ffb300"]},mintSage:{label:"Mint Sage",colors:["#a0a7a2","#dbe0dd","#ffffff","#00c896","#000000","#ff1744","#3f51b5","#ff9800"]},slateAzure:{label:"Slate Azure",colors:["#9aa3ad","#d8dee6","#ffffff","#3b82f6","#000000","#ff4081","#388e3c","#ffc107"]},vaporPop:{label:"Vapor Pop",colors:["#9ea0a8","#d6d7dc","#ffffff","#ff00e5","#000000","#00bcd4","#673ab7","#ff5722"]},cyberMagenta:{label:"Cyber Magenta",colors:["#9c9fad","#d6d9e3","#ffffff","#ff007a","#000000","#40e0d0","#1976d2","#ff9800"]},streetLime:{label:"Street Lime",colors:["#9aa19a","#d6dbd6","#ffffff","#baff00","#000000","#e91e63","#3f51b5","#ff6f00"]},cmykPop:{label:"CMYK Pop",colors:["#9f9f9f","#d9d9d9","#ffffff","#ffd400","#000000","#ff1744","#7b1fa2","#4caf50"]}};let R="industrialTeal",k=["#b7bcb7","#e4e9e4","#ffffff","#00695c","#000000","#ff4013","#0d5cb6","#ffa000"],P=5,U=k[P]||"#ff4013";function N(t=k){try{const e=document.documentElement,n=(t&&t.length?t:k).slice(0,8);for(let t=0;t<8;t++){const a=n[t]||"#ffffff";e.style.setProperty(`--ball-${t+1}`,a)}}catch(t){}}const z=[.5,.25,.12,.06,.03,.02,.01,.01];function O(){try{if(!k||0===k.length)return console.warn("No colors available, using fallback"),"#ffffff";const t=Math.random();let e=0;for(let n=0;n<Math.min(k.length,z.length);n++)if(e+=z[n],t<=e)return k[n];return k[Math.min(k.length-1,7)]}catch(t){return console.error("Error picking random color:",t),"#ffffff"}}let W=255,_=274e3,Y=4.4,D=t,G=t,H=!1,j=!0,X=60,J=200;const $="PointerEvent"in window;let K=!1,Q=null,Z="mouse";function tt(t,e){const n=a.getBoundingClientRect();D=(t-n.left)*s,G=(e-n.top)*s}const et=1e3;function nt(){j&&(W=function(){const t=Vt(((a.clientWidth||window.innerWidth)-375)/753,0,1),e=Math.min(X,J);return e+(Math.max(X,J)-e)*t}());const t=document.getElementById("repelSizeVal");t&&(t.textContent=Math.round(W).toString())}let at=0;const ot="#hero-text";let it=[];const st={pit:"pit",flies:"flies",print:"print"};let lt=st.pit,rt=3.4,ht=1910,dt=360,ct=120,ut=3,mt=490,ft=1,pt=!1,gt=400,yt=40,xt=0,vt=0,Mt=.025,Et=1.8,bt=0,Ct=0,It=0,St=0,wt=0;const Bt=document.getElementById("render-fps"),Lt=document.getElementById("physics-fps");class Tt{constructor(t,e,n,a){this.x=t,this.y=e,this.vx=200*(2*Math.random()-1),this.vy=200*-Math.random(),this.r=n,this.m=C,this.color=a,this.t=0,this.age=0,this.driftAx=0,this.driftTime=0,this.omega=0,this.squash=1,this.squashDirX=1,this.squashDirY=0,this.theta=0,this.squashAmount=0,this.squashNormalAngle=0,this.wanderAngle=Math.random()*Math.PI*2,this.wanderTimer=0,this.prevX=t,this.prevY=e}step(e){if(this.t+=e,this.age+=e,lt===st.flies)return void function(e,n){const a=Math.max(.25,e.m/1),o=Math.max(0,1-.2*m/a);e.vx*=o,e.vy*=o,e.wanderTimer+=n,e.wanderTimer>.08&&(e.wanderTimer=0,e.wanderAngle+=.9*(Math.random()-.5));let i=Math.cos(e.wanderAngle)*(ct*rt),l=Math.sin(e.wanderAngle)*(ct*rt);if(pt&&D!==t&&G!==t){void 0===e._scatterPhase&&(e._scatterPhase=Math.random()*Math.PI*2),void 0===e._scatterFactor&&(e._scatterFactor=1+(2*Math.random()-1)*ft);const t=Math.max(0,mt*e._scatterFactor)*s;e._scatterPhase+=n*(.6+.8*Math.random())*rt;let a=D+Math.cos(e._scatterPhase)*t,o=G+Math.sin(e._scatterPhase)*t;a+=(Math.random()-.5)*ut*20*s,o+=(Math.random()-.5)*ut*20*s;const r=a-e.x,h=o-e.y,d=.8*dt*rt,c=1.8*Math.sqrt(d);i+=d*r-c*e.vx,l+=d*h-c*e.vy}e.vx+=i*n/a,e.vy+=l*n/a;const r=Math.max(200,ht*rt),h=Math.hypot(e.vx,e.vy);if(h>r){const t=r/h;e.vx*=t,e.vy*=t}e.x+=e.vx*n,e.y+=e.vy*n;const d=Math.min(1,18*n);e.squashAmount+=(0-e.squashAmount)*d,e.squash=1-e.squashAmount}(this,e);this.vy+=2156*S*e;const n=Math.max(.25,this.m/1),a=Math.max(0,1-m/n);this.vx*=a,this.vy*=a,0!==this.driftAx&&this.age<this.driftTime?this.vx+=this.driftAx*e/n:0!==this.driftAx&&(this.driftAx=0),lt===st.pit&&function(t,e){if(!H)return;if(_<=0||W<=0)return;const n=W*s,a=t.x-D,o=t.y-G,i=a*a+o*o;if(i>n*n)return;const l=Math.max(Math.sqrt(i),1e-4),r=a/l,h=o/l,d=Math.max(0,1-l/n),c=20*_*Math.pow(d,Y),u=Math.max(.25,t.m/1);t.vx+=r*c*e/u,t.vy+=h*c*e/u}(this,e),this.x+=this.vx*e,this.y+=this.vy*e;const o=Math.max(0,1-2*e);this.omega*=o,this.theta+=this.omega*e,this.theta>Math.PI?this.theta-=2*Math.PI:this.theta<-Math.PI&&(this.theta+=2*Math.PI);const i=Math.min(1,18*e);this.squashAmount+=(0-this.squashAmount)*i,this.squash=1-this.squashAmount}walls(t,a,o){if(0===at){if(this.y+this.r>a){this.y=a-this.r;const t=this.vy,i=this.vx-this.omega*this.r,s=Math.max(.25,this.m/1);this.omega+=i/this.r*e/s;const l=Math.max(0,1-1.5*o/s);this.vx*=l;const r=Math.abs(t)<70?0:u;this.vy=-this.vy*(r*Math.pow(1/this.m,I));const h=Math.min(1,Math.abs(t)/(90*this.r));this.squashAmount=Math.min(n,.8*h),this.squash=1-this.squashAmount,this.squashNormalAngle=-Math.PI/2;const d=this.vx/this.r;this.omega+=(d-this.omega)*Math.min(1,8*o)}if(this.vy>0&&this.y-this.r<0){this.y=this.r;const t=this.vy;this.vy=-this.vy*u;const e=Math.min(1,Math.abs(t)/(90*this.r));this.squashAmount=Math.min(n,.8*e),this.squash=1-this.squashAmount,this.squashNormalAngle=Math.PI/2}if(this.x+this.r>t){this.x=t-this.r;{const t=this.vy-this.omega*this.r,e=Math.max(.25,this.m/1);this.omega+=t/this.r*.125/e}this.vx=-this.vx*u;const e=Math.min(1,Math.abs(this.vx)/(90*this.r));this.squashAmount=Math.min(n,.8*e),this.squash=1-this.squashAmount,this.squashNormalAngle=Math.PI}if(this.x-this.r<0){this.x=this.r;{const t=this.vy-this.omega*this.r,e=Math.max(.25,this.m/1);this.omega+=t/this.r*.125/e}this.vx=-this.vx*u;const t=Math.min(1,Math.abs(this.vx)/(90*this.r));this.squashAmount=Math.min(n,.8*t),this.squash=1-this.squashAmount,this.squashNormalAngle=0}}else this.handleRoundedWallCollision(t,a);this.checkTextCollisions(o)}checkTextCollisions(t){for(let t=0;t<it.length;t++){const e=it[t],a=Math.max(e.x,Math.min(this.x,e.x+e.width)),o=Math.max(e.y,Math.min(this.y,e.y+e.height)),i=this.x-a,s=this.y-o,l=Math.sqrt(i*i+s*s);if(l<this.r)if(0===l){const t=this.x-e.x,n=e.x+e.width-this.x,a=this.y-e.y,o=e.y+e.height-this.y,i=Math.min(t,n,a,o);i===t?(this.x=e.x-this.r,this.vx=-Math.abs(this.vx)*u):i===n?(this.x=e.x+e.width+this.r,this.vx=Math.abs(this.vx)*u):i===a?(this.y=e.y-this.r,this.vy=-Math.abs(this.vy)*u):(this.y=e.y+e.height+this.r,this.vy=Math.abs(this.vy)*u)}else{const t=this.r-l,e=i/l,a=s/l;this.x+=e*t,this.y+=a*t;const o=this.vx*e+this.vy*a;if(o<0){this.vx-=2*o*e*u,this.vy-=2*o*a*u;const t=Math.min(1,Math.abs(o)/(70*this.r));this.squash=1-n*t,this.squashDirX=Math.abs(e)>Math.abs(a)?1:0,this.squashDirY=Math.abs(a)>Math.abs(e)?1:0}}}}handleRoundedWallCollision(t,e){const a=at,o=[{x:a,y:a},{x:t-a,y:a},{x:t-a,y:e-a},{x:a,y:e-a}];for(let i=0;i<o.length;i++){const s=o[i],l=this.x-s.x,r=this.y-s.y,h=Math.sqrt(l*l+r*r);if(this.isInCornerRegion(s,t,e,a)&&h+this.r>a){const t=a-(h-this.r);if(t>0&&h>0){const e=l/h,a=r/h;this.x+=e*t,this.y+=a*t;const o=this.vx*e+this.vy*a;this.vx-=2*o*e*u,this.vy-=2*o*a*u;const i=Math.min(1,Math.abs(o)/(90*this.r));this.squashAmount=Math.min(n,.8*i),this.squash=1-this.squashAmount,this.squashNormalAngle=Math.atan2(a,e)}}}if(this.y+this.r>e&&(this.x<a||this.x>t-a)&&(this.y=e-this.r,this.vy=-this.vy*(u*Math.pow(1/this.m,I))),this.y-this.r<0&&(this.x<a||this.x>t-a)&&(this.y=this.r,this.vy=-this.vy*u),this.x+this.r>t&&(this.y<a||this.y>e-a)){this.x=t-this.r;{const t=this.vy-this.omega*this.r,e=Math.max(.25,this.m/1);this.omega+=t/this.r*.125/e}this.vx=-this.vx*(u*Math.pow(1/this.m,I));const e=Math.min(1,Math.abs(this.vx)/(70*this.r));this.squashAmount=Math.min(n,e),this.squash=1-this.squashAmount,this.squashNormalAngle=Math.PI}if(this.x-this.r<0&&(this.y<a||this.y>e-a)){this.x=this.r;{const t=this.vy-this.omega*this.r,e=Math.max(.25,this.m/1);this.omega+=t/this.r*.125/e}this.vx=-this.vx*(u*Math.pow(1/this.m,I));const t=Math.min(1,Math.abs(this.vx)/(70*this.r));this.squashAmount=Math.min(n,t),this.squash=1-this.squashAmount,this.squashNormalAngle=0}this.y+this.r>e&&this.x>=a&&this.x<=t-a&&(this.y=e-this.r,this.vy=-this.vy*(u*Math.pow(1/this.m,I))),this.y-this.r<0&&this.x>=a&&this.x<=t-a&&(this.y=this.r,this.vy=-this.vy*(u*Math.pow(1/this.m,I))),this.x+this.r>t&&this.y>=a&&this.y<=e-a&&(this.x=t-this.r,this.vx=-this.vx*(u*Math.pow(1/this.m,I))),this.x-this.r<0&&this.y>=a&&this.y<=e-a&&(this.x=this.r,this.vx=-this.vx*(u*Math.pow(1/this.m,I)))}isInCornerRegion(t,e,n,a){return t.x===a&&t.y===a?this.x<=a&&this.y<=a:t.x===e-a&&t.y===a?this.x>=e-a&&this.y<=a:t.x===e-a&&t.y===n-a?this.x>=e-a&&this.y>=n-a:t.x===a&&t.y===n-a&&this.x<=a&&this.y>=n-a}draw(t){t.save(),t.translate(this.x,this.y);const e=Math.min(n,Math.max(0,this.squashAmount));if(e>.001){const n=1+e,a=1/n;t.rotate(this.squashNormalAngle),t.scale(n,a),t.rotate(-this.squashNormalAngle)}t.beginPath(),t.arc(0,0,this.r,0,2*Math.PI),t.fillStyle=this.color,t.fill(),t.restore()}}const At=[];function Ft(e,n){if(n-xt>=gt&&D!==t&&G!==t){At.length>=yt&&At.shift();const t=(B+L)/2,e=k[vt%k.length],a=new Tt(D,G,t,e);a.vx=100*(Math.random()-.5),a.vy=100*(Math.random()-.5),At.push(a),vt=(vt+1)%k.length,xt=n}}function Vt(t,e,n){return Math.max(e,Math.min(n,t))}function qt(t,e){return t+Math.random()*(e-t)}function Rt(t,e,n=O()){const o=(B+L)/2;let i;if(0===M)i=o;else{const t=(L-B)/2*M;i=qt(Math.max(1,o-t),o+t)}const s=new Tt(t,e,i,n),l=(a.width,V>=0?1:-1),r=Vt(i/(.5*(B+L)),.6,1.4),h=140*r,d=180*r;return s.vx=l*(h+Math.random()*d),s.vy=120*-Math.random(),s.driftAx=l*(360+420*Math.random())*r,s.driftTime=.22+.28*Math.random(),At.push(s),s}let kt=0;function Pt(){const t=a.clientWidth,e=a.clientHeight,n=Vt(h/100*t,0,t);let o=Vt(l/100*t,0,t);{const e=.2*t,n=o;o=Vt(o+Math.sin(F)*e,0,t),V=o>=n?1:-1}const i=Math.min(40,.1*n),c=Vt(o-n/2-i,-i,t),u=Vt(o+n/2+i,-i,t),m=r/100*e,f=m+d/100*e,p=Math.random();return{x:(c+(u-c)*(V>0?Math.pow(p,.7):1-Math.pow(1-p,.7)))*s,y:qt(m*s,f*s)-(L+2+qt(0,10*s))}}const Ut=new Map;function Nt(t=6){const e=function(){const t=At.length;if(t<2)return[];const e=Math.max(1,2*L),n=Math.ceil(a.width/e)+1;Ut.clear();for(let a=0;a<t;a++){const t=At[a],o=t.x/e|0,i=(t.y/e|0)*n+o;let s=Ut.get(i);s||(s=[],Ut.set(i,s)),s.push(a)}const o=[];for(const[t,e]of Ut){const a=t/n|0,i=t%n;for(let t=-1;t<=1;t++)for(let s=-1;s<=1;s++){const l=(a+t)*n+(i+s),r=Ut.get(l);if(r)for(let t=0;t<e.length;t++){const n=e[t];for(let t=0;t<r.length;t++){const e=r[t];if(e<=n)continue;const a=At[n],i=At[e],s=i.x-a.x,l=i.y-a.y,h=a.r+i.r,d=s*s+l*l;if(d<h*h){const t=h-Math.sqrt(Math.max(d,1e-6));o.push({i:n,j:e,overlap:t})}}}}}return o.sort((t,e)=>e.overlap-t.overlap),o}();for(let a=0;a<t;a++)for(let t=0;t<e.length;t++){const{i:a,j:o}=e[t],i=At[a],s=At[o],l=s.x-i.x,r=s.y-i.y,h=i.r+s.r,d=l*l+r*r;if(0===d||d>h*h)continue;const c=Math.sqrt(d),m=l/c,f=r/c,p=h-c,y=1/Math.max(i.m,.001),x=1/Math.max(s.m,.001),v=.8*Math.max(p-g,0)/(y+x),M=v*m,E=v*f;i.x-=M*y,i.y-=E*y,s.x+=M*x,s.y+=E*x;const b=s.vx-i.vx,C=s.vy-i.vy,I=b*m+C*f;if(I<0){const t=-(1+(Math.abs(I)<30?0:u))*I/(y+x),e=t*m,a=t*f;i.vx-=e*y,i.vy-=a*y,s.vx+=e*x,s.vy+=a*x;const o=b-I*m,l=C-I*f,r=Math.hypot(o,l);if(r>.001){const t=o*-f+l*m>=0?1:-1,e=.18;i.omega-=t*e*r/Math.max(i.r,1),s.omega+=t*e*r/Math.max(s.r,1)}const h=Math.min(1,Math.abs(I)/(50*(i.r+s.r))),d=Math.min(n,.8*h);i.squashAmount=Math.max(i.squashAmount,.8*d),i.squashNormalAngle=Math.atan2(-f,-m),s.squashAmount=Math.max(s.squashAmount,.8*d),s.squashNormalAngle=Math.atan2(f,m)}}}let zt=performance.now()/1e3,Ot=0;const Wt=1/120;if(console.log("High refresh mode enabled - using requestAnimationFrame"),requestAnimationFrame(function e(n){const i=n/1e3;let s=Math.min(.008,i-zt);zt=i,Ot+=s,bt++,(Bt||Lt)&&i-It>=1&&(Bt&&bt!==St&&(St=bt,Bt.textContent=St.toString()),Lt&&Ct!==wt&&(wt=Ct,Lt.textContent=wt.toString()),bt=0,Ct=0,It=i),lt!==st.print&&function(t){for(kt+=t;kt>=f;){const t=(Math.random()-.5)*f*.5;kt-=f+t,F+=2*Math.PI*.12*(f+t);const e=Pt(),n=Math.random()<.35?3:1;for(let t=0;t<n;t++)if(At.length<p){const n=8*t*(Math.random()<.5?1:-1);Rt(e.x+n,e.y-12*t)}}}(s),bt%60==0&&A();let l=0;for(;Ot>=Wt&&l<2;){if(lt===st.print)Ft(0,1e3*i);else{for(let t=0;t<At.length;t++)At[t].step(Wt);Nt(3);for(let t=0;t<At.length;t++)At[t].walls(a.width,a.height,Wt)}Ot-=Wt,l++,Ct++}if(Ot>3*Wt&&(Ot=0),Mt>0&&Et>0){const t=1.5,e=3,n=.35;let i=1+(n+(.0015-n)*Math.max(0,Math.min(1,Mt/t))-1)*Math.max(0,Math.min(1,Et/e));i=Math.max(.001,Math.min(1,i)),o.fillStyle=`rgba(0,0,0,${i})`,o.globalCompositeOperation="destination-out",o.fillRect(0,0,a.width,a.height),o.globalCompositeOperation="source-over"}else o.clearRect(0,0,a.width,a.height);at>0&&function(t,e,n){const a=at;t.strokeStyle="rgba(255, 255, 255, 0.1)",t.lineWidth=2,t.beginPath(),t.moveTo(a,0),t.lineTo(e-a,0),t.arcTo(e,0,e,a,a),t.lineTo(e,n-a),t.arcTo(e,n,e-a,n,a),t.lineTo(a,n),t.arcTo(0,n,0,n-a,a),t.lineTo(0,a),t.arcTo(0,0,a,0,a),t.closePath(),t.stroke()}(o,a.width,a.height);for(let t=0;t<At.length;t++)At[t].draw(o);!function(e){if(function(){try{const t=window.matchMedia&&window.matchMedia("(pointer: coarse)").matches,e=window.matchMedia&&window.matchMedia("(hover: none)").matches;return t||e||E<1}catch(t){return E<1}}())return;if(K&&"touch"===Z)return;if(D===t||G===t)return;const n=D,a=G,o=(B+L)/2,i=U;e.beginPath(),e.arc(n,a,o,0,2*Math.PI),e.fillStyle=i,e.fill()}(o),requestAnimationFrame(e)}),window.addEventListener("keydown",t=>{const e=t.key.toLowerCase();"r"===e&&(function(){for(let t=0;t<At.length;t++){const e=At[t],n=Pt();e.x=n.x,e.y=n.y,a.width;const o=V>=0?1:-1,i=Vt(e.r/(.5*(B+L)),.6,1.4),s=140*i,l=180*i,r=120;e.vx=o*(s+Math.random()*l),e.vy=-Math.random()*r,e.age=0,e.driftAx=o*(360+420*Math.random())*i,e.driftTime=.22+.28*Math.random()}}(),t.preventDefault()),"/"===e&&i&&(t.preventDefault(),i.classList.toggle("hidden"))}),function(t=160){for(let e=0;e<t&&At.length<p;e++){const t=Pt();Rt(t.x,t.y)}}(200),$){a.addEventListener("pointerdown",t=>{if(Z=t.pointerType||"mouse","touch"===t.pointerType){K=!0,Q=t.pointerId,tt(t.clientX,t.clientY),_>0&&W>0&&(H=!0),pt=!0;try{a.setPointerCapture(t.pointerId)}catch(t){}}else tt(t.clientX,t.clientY),_>0&&W>0&&(H=!0),pt=!0},{passive:!0}),a.addEventListener("pointermove",t=>{Z=t.pointerType||Z,"touch"===t.pointerType?K&&t.pointerId===Q&&tt(t.clientX,t.clientY):"mouse"!==t.pointerType&&"pen"!==t.pointerType||(tt(t.clientX,t.clientY),_>0&&W>0&&(H=!0),pt=!0)},{passive:!0});const e=()=>{K=!1,Q=null,D=t,G=t};a.addEventListener("pointerup",t=>{"touch"===t.pointerType&&(e(),pt=!1)},{passive:!0}),a.addEventListener("pointercancel",t=>{"touch"===t.pointerType&&(e(),pt=!1)},{passive:!0}),a.addEventListener("pointerleave",e=>{"mouse"!==e.pointerType&&"pen"!==e.pointerType||(D=t,G=t,pt=!1)},{passive:!0})}else{a.addEventListener("mousemove",t=>{const e=a.getBoundingClientRect();D=(t.clientX-e.left)*s,G=(t.clientY-e.top)*s,_>0&&W>0&&(H=!0),pt=!0}),a.addEventListener("mouseleave",()=>{D=t,G=t,pt=!1}),a.addEventListener("touchstart",t=>{if(!t.touches||0===t.touches.length)return;K=!0;const e=t.touches[0];tt(e.clientX,e.clientY),_>0&&W>0&&(H=!0),pt=!0},{passive:!0}),a.addEventListener("touchmove",t=>{if(!K||!t.touches||0===t.touches.length)return;const e=t.touches[0];tt(e.clientX,e.clientY),"function"==typeof t.preventDefault&&t.preventDefault()},{passive:!1});const e=()=>{K=!1,D=t,G=t,pt=!1};a.addEventListener("touchend",e,{passive:!0}),a.addEventListener("touchcancel",e,{passive:!0})}const _t=document.getElementById("restitutionSlider"),Yt=document.getElementById("frictionSlider"),Dt=document.getElementById("emitterSlider"),Gt=document.getElementById("sizeSlider"),Ht=document.getElementById("maxBallsSlider"),jt=document.getElementById("sizeVariationSlider"),Xt=document.getElementById("weightSlider"),Jt=document.getElementById("spawnYSlider"),$t=document.getElementById("spawnWidthSlider"),Kt=document.getElementById("spawnCenterSlider"),Qt=document.getElementById("spawnHeightSlider"),Zt=document.getElementById("repelSizeSlider"),te=document.getElementById("repelPowerSlider"),ee=document.getElementById("repelSoftSlider"),ne=document.getElementById("colorSelect"),ae=document.getElementById("color1"),oe=document.getElementById("color2"),ie=document.getElementById("color3"),se=document.getElementById("color4"),le=document.getElementById("color5"),re=document.getElementById("color6"),he=document.getElementById("color7"),de=document.getElementById("color8"),ce=document.getElementById("cursorColorSelect"),ue=document.getElementById("color1Val"),me=document.getElementById("color2Val"),fe=document.getElementById("color3Val"),pe=document.getElementById("color4Val"),ge=document.getElementById("color5Val"),ye=document.getElementById("color6Val"),xe=document.getElementById("color7Val"),ve=document.getElementById("color8Val");[ue,me,fe,pe,ge,ye,xe,ve].forEach(t=>{t&&t.setAttribute("title","Click to copy")});const Me=document.getElementById("cornerRadiusSlider"),Ee=document.getElementById("cornerRadiusVal"),be=document.getElementById("trailFadeSlider"),Ce=document.getElementById("trailFadeVal"),Ie=document.getElementById("trailSubtletySlider"),Se=document.getElementById("trailSubtletyVal"),we=(document.getElementById("behaviorSelect"),document.getElementById("fliesMaxSpeedSlider")),Be=document.getElementById("fliesSeekGainSlider"),Le=document.getElementById("fliesWanderSlider"),Te=document.getElementById("fliesJitterSlider"),Ae=document.getElementById("fliesSpeedMulSlider"),Fe=document.getElementById("fliesScatterRadiusSlider"),Ve=document.getElementById("fliesScatterVarSlider"),qe=document.getElementById("fliesMaxSpeedVal"),Re=document.getElementById("fliesSeekGainVal"),ke=document.getElementById("fliesWanderVal"),Pe=document.getElementById("fliesJitterVal"),Ue=document.getElementById("fliesSpeedMulVal"),Ne=document.getElementById("fliesScatterRadiusVal"),ze=document.getElementById("fliesScatterVarVal"),Oe=(document.getElementById("snakeSegmentsSlider"),document.getElementById("snakeSpacingSlider"),document.getElementById("snakeSpeedMulSlider"),document.getElementById("snakeSegmentsVal"),document.getElementById("snakeSpacingVal"),document.getElementById("snakeSpeedMulVal"),document.getElementById("snakeSwayAmpSlider"),document.getElementById("snakeSwayFreqSlider"),document.getElementById("snakeIdleWanderSlider"),document.getElementById("snakeSwayAmpVal"),document.getElementById("snakeSwayFreqVal"),document.getElementById("snakeIdleWanderVal"),document.getElementById("restitutionVal")),We=document.getElementById("frictionVal"),_e=document.getElementById("emitterVal"),Ye=document.getElementById("sizeVal"),De=document.getElementById("maxBallsVal"),Ge=document.getElementById("sizeVariationVal"),He=document.getElementById("weightVal"),je=document.getElementById("spawnYVal"),Xe=document.getElementById("spawnWidthVal"),Je=document.getElementById("spawnCenterVal"),$e=document.getElementById("spawnHeightVal"),Ke=document.getElementById("repelSizeVal"),Qe=document.getElementById("repelPowerVal"),Ze=document.getElementById("repelSoftVal");function tn(){return{gravityMultiplier:1.1,restitution:u,friction:m,ballMass:C,emitRate:f,maxBalls:p,ballScale:v,ballVariation:M,spawnX:l,spawnY:r,spawnWidth:h,spawnHeight:d,sweepEnabled:true,repelRadius:W,repelPower:_,repelSoftness:Y,repelResponsive:j,repelMinSize:X,repelMaxSize:J,trailFade:Mt,trailSubtlety:Et,behaviorMode:lt,fliesSpeedMul:rt,fliesMaxSpeed:ht,fliesSeekGain:dt,fliesWanderStrength:ct,fliesJitter:ut,fliesScatterRadius:mt,fliesScatterVarPct:ft,printInterval:gt,printMaxBalls:yt,colors:k.slice(),colorWeights:z.slice(),currentTemplate:R,cursorColorIndex:P}}const en=document.getElementById("saveConfigBtn"),nn=document.getElementById("buildBtn"),an=document.getElementById("configOutput");function on(t,e){t&&t.addEventListener("click",async()=>{const n="function"==typeof e?e():String(e||"").trim();try{await navigator.clipboard.writeText(n);const e=t.textContent;t.textContent="COPIED",t.style.color="#3ddc84",setTimeout(()=>{t.textContent=e,t.style.color="#888"},900)}catch(t){console.warn("Clipboard unavailable")}})}function sn(){const t=(B+L)/2;for(let e=0;e<At.length;e++){const n=At[e];if(0===M)n.r=t;else{const e=(L-B)/2*M,a=Math.max(1,t-e),o=t+e;n.r=qt(a,o)}n.m=C}}en&&nn&&an&&(en.addEventListener("click",()=>{const t=tn(),e=JSON.stringify(t,null,2);an.style.display="block",an.innerHTML=`\n<strong>💾 Configuration Export</strong><br><br>\n<strong>Option 1: Auto-save to file</strong><br>\nCopy this command and run in terminal:<br>\n<code style="background: #f0f0f0; padding: 2px 4px; border-radius: 2px; font-size: 9px; display: block; margin: 4px 0; word-break: break-all;">echo '${e.replace(/'/g,"\\'")}' | npm run save-config</code><br>\n<strong>Option 2: Manual download</strong><br>\n<button id="downloadConfigBtn" style="background: #FF9800; color: white; border: none; padding: 4px 8px; border-radius: 2px; cursor: pointer; font-size: 10px; margin: 4px 0;">📥 Download JSON</button><br><br>\n<strong>Current Configuration:</strong><br>\n<pre style="background: #f8f8f8; padding: 6px; border-radius: 3px; font-size: 8px; max-height: 100px; overflow-y: auto; margin: 4px 0;">${e}</pre>`;const n=document.getElementById("downloadConfigBtn");n&&n.addEventListener("click",()=>{const t=new Blob([e],{type:"application/json"}),a=URL.createObjectURL(t),o=document.createElement("a");o.href=a,o.download="current-config.json",o.click(),URL.revokeObjectURL(a),n.textContent="✅ Downloaded!",setTimeout(()=>{n.textContent="📥 Download JSON"},1200)});const a=`echo '${e.replace(/'/g,"\\'")}' | npm run save-config`;navigator.clipboard.writeText(a).then(()=>{const t=en.textContent;en.textContent="✅ Command Copied!",setTimeout(()=>{en.textContent=t},2e3)}).catch(()=>{console.warn("Clipboard copy failed");const t=en.textContent;en.textContent="⚠️ Copy failed",setTimeout(()=>{en.textContent=t},1200)})}),nn.addEventListener("click",()=>{const t=tn();an.style.display="block",an.innerHTML="\n<strong>🚀 Build Instructions:</strong><br>\n1. Run: <code>npm run build</code><br>\n2. Your current config will be baked into <code>public/js/bouncy-balls-embed.js</code>";const e=new Blob([JSON.stringify(t,null,2)],{type:"application/json"}),n=URL.createObjectURL(e),a=document.createElement("a");a.href=n,a.download="current-config.json",a.click(),URL.revokeObjectURL(n)})),_t&&_t.addEventListener("input",()=>{u=parseFloat(_t.value),Oe&&(Oe.textContent=u.toFixed(2))}),Yt&&Yt.addEventListener("input",()=>{m=parseFloat(Yt.value),We&&(We.textContent=m.toFixed(4))}),Dt&&Dt.addEventListener("input",()=>{f=parseFloat(Dt.value),_e&&(_e.textContent=f.toFixed(3))}),Gt&&Gt.addEventListener("input",()=>{const t=parseFloat(Gt.value);Ye&&(Ye.textContent=t.toFixed(1)),v=t,T();for(let t=0;t<At.length;t++)At[t].m=C}),Ht&&Ht.addEventListener("input",()=>{p=parseInt(Ht.value,10),De&&(De.textContent=p.toString()),At.length>p&&(At.length=p)}),jt&&jt.addEventListener("input",()=>{M=parseFloat(jt.value),Ge&&(Ge.textContent=M.toFixed(1)),sn()}),Xt&&Xt.addEventListener("input",()=>{C=parseFloat(Xt.value),He&&(He.textContent=C.toFixed(2));for(let t=0;t<At.length;t++)At[t].m=C;w()}),Jt&&Jt.addEventListener("input",()=>{r=parseFloat(Jt.value),je&&(je.textContent=r.toFixed(0)),c()}),$t&&$t.addEventListener("input",()=>{h=parseFloat($t.value),Xe&&(Xe.textContent=h.toFixed(0))}),Kt&&Kt.addEventListener("input",()=>{l=parseFloat(Kt.value),Je&&(Je.textContent=l.toFixed(0))}),Qt&&Qt.addEventListener("input",()=>{d=parseFloat(Qt.value),$e&&($e.textContent=d.toFixed(0))}),Zt&&Zt.addEventListener("input",()=>{const t=parseFloat(Zt.value);j=!1,W=t,Ke&&(Ke.textContent=W.toFixed(0)),H=H||_>0&&W>0});const ln=document.getElementById("repelResponsiveToggle"),rn=document.getElementById("repelMinSizeSlider"),hn=document.getElementById("repelMaxSizeSlider"),dn=document.getElementById("repelMinSizeVal"),cn=document.getElementById("repelMaxSizeVal");function un(){for(let t=0;t<At.length;t++)At[t].color=O()}ln&&ln.addEventListener("change",()=>{j=!!ln.checked,j&&nt()}),rn&&rn.addEventListener("input",()=>{X=parseFloat(rn.value),dn&&(dn.textContent=Math.round(X).toString()),j&&nt()}),hn&&hn.addEventListener("input",()=>{J=parseFloat(hn.value),cn&&(cn.textContent=Math.round(J).toString()),j&&nt()}),te&&te.addEventListener("input",()=>{_=function(t){const e=Math.max(0,Math.min(et,Number(t)))/et;return 2*Math.pow(2,12*(e-.5))*12e3}(te.value),Qe&&(Qe.textContent=Math.round(_).toString()),In&&"off"!==In.value&&(H=_>0&&W>0)}),ee&&ee.addEventListener("input",()=>{Y=parseFloat(ee.value),Ze&&(Ze.textContent=Y.toFixed(1))}),ne&&ne.addEventListener("change",()=>{const t=q[ne.value];t&&(R=ne.value,k=t.colors.slice(),U=k[P]||U,ae&&ue&&(ae.value=k[0],ue.textContent=k[0].toUpperCase()),oe&&me&&(oe.value=k[1],me.textContent=k[1].toUpperCase()),ie&&fe&&(ie.value=k[2],fe.textContent=k[2].toUpperCase()),se&&pe&&(se.value=k[3],pe.textContent=k[3].toUpperCase()),le&&ge&&(le.value=k[4],ge.textContent=k[4].toUpperCase()),re&&ye&&(re.value=k[5],ye.textContent=k[5].toUpperCase()),he&&xe&&(he.value=k[6],xe.textContent=k[6].toUpperCase()),de&&ve&&(de.value=k[7],ve.textContent=k[7].toUpperCase()),un(),N())}),ae&&ae.addEventListener("input",()=>{k[0]=ae.value,ue&&(ue.textContent=ae.value.toUpperCase()),un(),N()}),oe&&oe.addEventListener("input",()=>{k[1]=oe.value,me&&(me.textContent=oe.value.toUpperCase()),un(),N()}),ie&&ie.addEventListener("input",()=>{k[2]=ie.value,fe&&(fe.textContent=ie.value.toUpperCase()),un(),N()}),se&&se.addEventListener("input",()=>{k[3]=se.value,pe&&(pe.textContent=se.value.toUpperCase()),un(),N()}),le&&le.addEventListener("input",()=>{k[4]=le.value,ge&&(ge.textContent=le.value.toUpperCase()),un(),N()}),re&&re.addEventListener("input",()=>{k[5]=re.value,ye&&(ye.textContent=re.value.toUpperCase()),un(),N()}),he&&he.addEventListener("input",()=>{k[6]=he.value,xe&&(xe.textContent=he.value.toUpperCase()),un(),N()}),de&&de.addEventListener("input",()=>{k[7]=de.value,ve&&(ve.textContent=de.value.toUpperCase()),un(),N()}),ce&&ce.addEventListener("change",()=>{const t=Math.max(1,Math.min(8,parseInt(ce.value,10)))-1;P=t,U=k[P]||U}),on(ue,()=>ae.value.toUpperCase()),on(me,()=>oe.value.toUpperCase()),on(fe,()=>ie.value.toUpperCase()),on(pe,()=>se.value.toUpperCase()),on(ge,()=>le.value.toUpperCase()),on(ye,()=>re.value.toUpperCase()),on(xe,()=>he.value.toUpperCase()),on(ve,()=>de.value.toUpperCase()),Me&&Me.addEventListener("input",()=>{at=parseFloat(Me.value),Ee&&(Ee.textContent=at.toFixed(0))}),be&&be.addEventListener("input",()=>{Mt=parseFloat(be.value),Ce&&(Ce.textContent=Mt.toFixed(3))}),Ie&&Ie.addEventListener("input",()=>{Et=parseFloat(Ie.value),Se&&(Se.textContent=Et.toFixed(2)+"×")});const mn=document.querySelectorAll(".segment-button");mn.forEach(t=>{t.addEventListener("click",()=>{mn.forEach(t=>t.classList.remove("active")),t.classList.add("active");const e=t.getAttribute("data-behavior");lt=st[e]||st.pit,lt===st.print&&(At.length=0,vt=0,xt=0)})}),Ae&&Ae.addEventListener("input",()=>{rt=parseFloat(Ae.value)/100,Ue&&(Ue.textContent=Math.round(parseFloat(Ae.value))+"%")}),we&&we.addEventListener("input",()=>{ht=parseFloat(we.value),qe&&(qe.textContent=Math.round(ht).toString())}),Be&&Be.addEventListener("input",()=>{dt=parseFloat(Be.value),Re&&(Re.textContent=Math.round(dt).toString())}),Le&&Le.addEventListener("input",()=>{ct=parseFloat(Le.value),ke&&(ke.textContent=Math.round(ct).toString())}),Te&&Te.addEventListener("input",()=>{ut=parseFloat(Te.value),Pe&&(Pe.textContent=ut.toFixed(1))}),Fe&&Fe.addEventListener("input",()=>{mt=parseFloat(Fe.value),Ne&&(Ne.textContent=Math.round(mt).toString())}),Ve&&Ve.addEventListener("input",()=>{ft=parseFloat(Ve.value)/100,ze&&(ze.textContent=Math.round(parseFloat(Ve.value))+"%")});const fn=document.getElementById("printIntervalSlider"),pn=document.getElementById("printIntervalVal"),gn=document.getElementById("printMaxBallsSlider"),yn=document.getElementById("printMaxBallsVal");fn&&fn.addEventListener("input",()=>{gt=parseInt(fn.value,10),pn&&(pn.textContent=gt.toString())}),gn&&gn.addEventListener("input",()=>{yt=parseInt(gn.value,10),yn&&(yn.textContent=yt.toString())});const xn={rubberPlayground:{label:"Rubber – Playground",G:1960,REST:.9,FRICTION:.0025,sizeScale:1.8,maxBalls:450,sizeVariation:.2},rubberRacquet:{label:"Rubber – Racquetball",G:3320,REST:.97,FRICTION:.0035,sizeScale:2.1,maxBalls:350,sizeVariation:.3},rubberSuperball:{label:"Rubber – Superball",G:1960,REST:.95,FRICTION:.0015,sizeScale:1.2,maxBalls:450,sizeVariation:.05},rubberSoft:{label:"Rubber – Soft",G:1960,REST:.86,FRICTION:.0035,sizeScale:2.2,maxBalls:350,sizeVariation:.25},rubberHeavy:{label:"Rubber – Heavy",G:1960,REST:.88,FRICTION:.003,sizeScale:2,maxBalls:400,sizeVariation:.15}},vn={fullRain:{label:"Full Rain (top-half)",EMIT_INTERVAL:.03,xCenter:50,y:-50,w:100,h:50},narrowStrip:{label:"Narrow Strip Top",EMIT_INTERVAL:.05,xCenter:50,y:-40,w:20,h:10},leftGutter:{label:"Left Gutter",EMIT_INTERVAL:.045,xCenter:10,y:-60,w:18,h:20},rightGutter:{label:"Right Gutter",EMIT_INTERVAL:.045,xCenter:90,y:-60,w:18,h:20},centerFountain:{label:"Center Fountain",EMIT_INTERVAL:.02,xCenter:50,y:-30,w:30,h:20},stormBurst:{label:"Storm Burst",EMIT_INTERVAL:.005,xCenter:50,y:-80,w:100,h:30},slowSnow:{label:"Slow Snow",EMIT_INTERVAL:.2,xCenter:50,y:-30,w:100,h:20},edgeDrizzle:{label:"Edge Drizzle",EMIT_INTERVAL:.08,xCenter:15,y:-40,w:30,h:15},twinColumns:{label:"Twin Columns",EMIT_INTERVAL:.03,xCenter:30,y:-50,w:10,h:40},focusedBeam:{label:"Focused Beam",EMIT_INTERVAL:.015,xCenter:50,y:-70,w:6,h:12}},Mn={off:{label:"Off",r:710,p:274e3,s:4.4},gentle:{label:"Gentle Breeze",r:120,p:2500,s:2.5},pushField:{label:"Push Field",r:240,p:8e4,s:2},tractor:{label:"Tractor Push",r:320,p:14e4,s:1.6},magnet:{label:"Magnet Repel",r:200,p:18e4,s:3},pulse:{label:"Pulse Strong",r:280,p:22e4,s:1.2},wideSoft:{label:"Wide Soft",r:500,p:8e4,s:4.5},needle:{label:"Needle Point",r:80,p:26e4,s:.8},wall:{label:"Invisible Wall",r:700,p:16e4,s:5},singularity:{label:"Singularity",r:600,p:3e5,s:.5}};function En(t,e,n){t.innerHTML="";for(const[a,o]of Object.entries(e)){const e=document.createElement("option");e.value=a,e.textContent=o.label||a,a===n&&(e.selected=!0),t.appendChild(e)}}const bn=document.getElementById("physicsSelect"),Cn=document.getElementById("spawnSelect"),In=document.getElementById("repellerSelect");function Sn(t,e,n,a=0){t&&(t.value=String(n)),e&&(e.textContent=a>0?n.toFixed(a):n.toString())}function wn(t){const e=xn[t];if(!e)return;u=e.REST,m=e.FRICTION,p=e.maxBalls,M=e.sizeVariation;const n=e.sizeScale;v=n,T();for(let t=0;t<At.length;t++)At[t].m=C;At.length>p&&(At.length=p),Sn(_t,Oe,u,2),Sn(Yt,We,m,4),Sn(Gt,Ye,v,1),Sn(Ht,De,p,0),Sn(jt,Ge,M,1),sn()}function Bn(t){const e=vn[t];e&&(f=e.EMIT_INTERVAL,l=e.xCenter,r=e.y,h=e.w,d=e.h,Sn(Dt,_e,f,3),Sn(Kt,Je,l,0),Sn(Jt,je,r,0),Sn($t,Xe,h,0),Sn(Qt,$e,d,0))}function Ln(t){const e=Mn[t];if(!e)return;W=e.r,_=1*e.p,H="off"!==t,Sn(Zt,Ke,W,0);const n=function(t){const e=Math.max(1,Number(t))/24e3,n=.5+Math.log2(e)/12;return Math.round(Math.max(0,Math.min(1,n))*et)}(_);te&&(te.value=String(n)),Qe&&(Qe.textContent=Math.round(_).toString()),Sn(ee,Ze,Y,1),j&&nt()}bn&&En(bn,xn,"rubberHeavy"),Cn&&En(Cn,vn,"fullRain"),In&&En(In,Mn,"off"),ne&&En(ne,q,"industrialTeal"),wn("rubberHeavy"),Bn("fullRain"),Ln("off"),nt();const Tn=q[R];ae&&ue&&(ae.value=Tn.colors[0],ue.textContent=Tn.colors[0].toUpperCase()),oe&&me&&(oe.value=Tn.colors[1],me.textContent=Tn.colors[1].toUpperCase()),ie&&fe&&(ie.value=Tn.colors[2],fe.textContent=Tn.colors[2].toUpperCase()),se&&pe&&(se.value=Tn.colors[3],pe.textContent=Tn.colors[3].toUpperCase()),le&&ge&&(le.value=Tn.colors[4],ge.textContent=Tn.colors[4].toUpperCase()),re&&ye&&(re.value=Tn.colors[5],ye.textContent=Tn.colors[5].toUpperCase()),he&&xe&&(he.value=Tn.colors[6],xe.textContent=Tn.colors[6].toUpperCase()),de&&ve&&(de.value=Tn.colors[7],ve.textContent=Tn.colors[7].toUpperCase()),N(Tn.colors),bn&&bn.addEventListener("change",()=>wn(bn.value)),Cn&&Cn.addEventListener("change",()=>Bn(Cn.value)),In&&In.addEventListener("change",()=>Ln(In.value)),T(),A()})();