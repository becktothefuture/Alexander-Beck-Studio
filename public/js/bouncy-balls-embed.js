(()=>{const t="pit",e="flies",n="trail",i="weightless",o="rainbow",a={[t]:{desktop:!0,mobile:!0},[e]:{desktop:!0,mobile:!0},[n]:{desktop:!0,mobile:!1},[i]:{desktop:!0,mobile:!0},[o]:{desktop:!0,mobile:!0}};let s=t,l=40,r=1.1,d=!0,h=1e3,c=150,u=1,m=3,f=1.5,g=100,p=50,y=.6,x=[],v=400,E=.98,M=300,b=800,I=120,w=1,C=.15,S=1.2,B=.3;const V=-1e9,L=1e-4,R=.25;function F(){return 0===l?0:l/40*.2}const T=document.getElementById("c"),P=T.getContext("2d",{alpha:!0}),A=document.getElementById("controlPanel"),q=Math.max(1,Math.min(2,window.devicePixelRatio||1));let z=50,k=-50,N=100,U=50;function G(){const t=1.5*window.innerHeight;T.width=Math.floor(window.innerWidth*q),T.height=Math.floor(t*q)}G(),window.addEventListener("resize",()=>{G(),lt(),rt()});const D=1960;let O=1.1,W=D*O,H=.88,_=.003,j=.03,Y=400;const Z=.5*q,J=6,K=24;let X=2,$=.15,Q=1,tt=null,et=11.2;const nt=.15;let it=1;function ot(){it=Math.max(.5,Math.min(3,Math.pow(et/1,.35)))}ot();let at=J*X,st=K*X;function lt(){Q=(T.clientWidth||window.innerWidth)<=768?.4:1;const t=X*Q;if(null===tt)return tt=t,at=J*t,void(st=K*t);const e=t/tt;if(1!==e){for(let t=0;t<Ht.length;t++)s!==o&&(Ht[t].r*=e);tt=t}at=J*t,st=K*t}function rt(){Pt=[];const t=document.querySelector(Tt);if(!t)return;const e=t.getBoundingClientRect(),n=T.getBoundingClientRect(),i=function(t){const e=document.createElement("span");e.style.cssText=window.getComputedStyle(t).cssText,e.style.position="absolute",e.style.visibility="hidden",e.style.whiteSpace="nowrap",e.textContent="ABCDEFGHIJKLMNOPQRSTUVWXYZ",document.body.appendChild(e);const n=e.getBoundingClientRect().height;return document.body.removeChild(e),n}(t),o=.5*(e.height-i),a={x:(e.left-n.left)*q,y:(e.top-n.top+o)*q,width:e.width*q,height:i*q};a.width>0&&a.height>0&&a.x<T.width&&a.y<T.height&&a.x+a.width>0&&a.y+a.height>0&&Pt.push(a)}let dt=!0,ht=0,ct=1;const ut={industrialTeal:{label:"Industrial Teal",colors:["#b7bcb7","#e4e9e4","#ffffff","#00695c","#000000","#ff4013","#0d5cb6","#ffa000"]},modern:{label:"Modern European",colors:["#9ca3af","#d1d5db","#ffffff","#ff3b30","#000000","#00e5ff","#1976d2","#ffc107"]},corporate:{label:"Corporate Modern",colors:["#a0a8b1","#d2d8de","#ffffff","#1a73e8","#000000","#ff5722","#7b1fa2","#ffa000"]},minimal:{label:"Helvetica Minimal",colors:["#bdbdbd","#e0e0e0","#ffffff","#6b7280","#000000","#40e0d0","#303f9f","#ff9800"]},euroBlue:{label:"European Blue",colors:["#9aa6b2","#d4dde5","#ffffff","#0a66c2","#000000","#ff4081","#388e3c","#ffb300"]},scandi:{label:"Scandinavian Bright",colors:["#aab2b7","#e6eaee","#ffffff","#74b9ff","#000000","#e91e63","#1976d2","#4caf50"]},neonCyan:{label:"Graphite Neon Cyan",colors:["#9aa0a6","#d5d9dd","#ffffff","#00e5ff","#000000","#ff9800","#9c27b0","#4caf50"]},coralTech:{label:"Coral Tech",colors:["#9da3a9","#d8dde2","#ffffff","#ff6b6b","#000000","#00e676","#3f51b5","#ff5722"]},violetMidnight:{label:"Violet Midnight",colors:["#9fa3b1","#d9dce3","#ffffff","#7c3aed","#000000","#e91e63","#388e3c","#ffb300"]},mintSage:{label:"Mint Sage",colors:["#a0a7a2","#dbe0dd","#ffffff","#00c896","#000000","#ff1744","#3f51b5","#ff9800"]},slateAzure:{label:"Slate Azure",colors:["#9aa3ad","#d8dee6","#ffffff","#3b82f6","#000000","#ff4081","#388e3c","#ffc107"]},vaporPop:{label:"Vapor Pop",colors:["#9ea0a8","#d6d7dc","#ffffff","#ff00e5","#000000","#00bcd4","#673ab7","#ff5722"]},cyberMagenta:{label:"Cyber Magenta",colors:["#9c9fad","#d6d9e3","#ffffff","#ff007a","#000000","#40e0d0","#1976d2","#ff9800"]},streetLime:{label:"Street Lime",colors:["#9aa19a","#d6dbd6","#ffffff","#baff00","#000000","#e91e63","#3f51b5","#ff6f00"]},cmykPop:{label:"CMYK Pop",colors:["#9f9f9f","#d9d9d9","#ffffff","#ffd400","#000000","#ff1744","#7b1fa2","#4caf50"]}};let mt="industrialTeal",ft=["#b7bcb7","#e4e9e4","#ffffff","#00695c","#000000","#ff4013","#0d5cb6","#ffa000"],gt=5,pt=ft[gt]||"#ff4013";function yt(t=ft){try{const e=document.documentElement,n=(t&&t.length?t:ft).slice(0,8);for(let t=0;t<8;t++){const i=n[t]||"#ffffff";e.style.setProperty(`--ball-${t+1}`,i)}}catch(t){}}const xt=[.5,.25,.12,.06,.03,.02,.01,.01];function vt(){try{if(!ft||0===ft.length)return console.warn("No colors available, using fallback"),"#ffffff";const t=Math.random();let e=0;for(let n=0;n<Math.min(ft.length,xt.length);n++)if(e+=xt[n],t<=e)return ft[n];return ft[Math.min(ft.length-1,7)]}catch(t){return console.error("Error picking random color:",t),"#ffffff"}}let Et=255,Mt=274e3,bt=4.4,It=V,wt=V,Ct=!1,St=!1;("ontouchstart"in window||navigator.maxTouchPoints>0)&&(St=!0);const Bt="bouncyBallsSettings";function Vt(){const t={currentMode:s,gravityMultiplierPit:r,repellerEnabledPit:d,attractionPower:h,orbitRadius:c,swarmSpeed:u,sparkleEmissionRate:m,sparkleLifetime:f,sparkleVelocitySpread:g,sparkleDriftStrength:p,sparkleParticleScale:y,weightlessInitialSpeed:v,weightlessBounce:E,weightlessMaxBalls:M,weightlessRepellerPower:b,weightlessRepellerRadius:I,restitution:H,friction:_,sizeScale:X,sizeVariation:$,ballMassKg:et,ballSoftness:l,repelPower:Mt,repelRadius:Et,repelSoft:bt,cornerRadius:Ft,motionBlur:At,trailSubtlety:qt,currentTemplate:mt,cursorBallColor:pt};try{localStorage.setItem(Bt,JSON.stringify(t)),console.log("âœ“ Settings saved")}catch(t){console.warn("Could not save settings:",t)}}function Lt(){clearTimeout(window.settingsSaveTimeout),window.settingsSaveTimeout=setTimeout(Vt,500)}const Rt=1e3;let Ft=0;const Tt="#hero-text";let Pt=[],At=.025,qt=1.8,zt=0,kt=0,Nt=0,Ut=0,Gt=0;const Dt=document.getElementById("render-fps"),Ot=document.getElementById("physics-fps");class Wt{constructor(t,e,n,i){this.x=t,this.y=e,this.vx=200*(2*Math.random()-1),this.vy=200*-Math.random(),this.r=n,this.rBase=n,this.m=et,this.color=i,this.t=0,this.age=0,this.driftAx=0,this.driftTime=0,this.omega=0,this.squash=1,this.squashDirX=1,this.squashDirY=0,this.theta=0,this.squashAmount=0,this.squashNormalAngle=0,this.alpha=1}step(o){this.t+=o,this.age+=o,this.vy+=W*it*o;const a=Math.max(.25,this.m/1),l=Math.max(0,1-_/a);this.vx*=l,this.vy*=l,0!==this.driftAx&&this.age<this.driftTime?this.vx+=this.driftAx*o/a:0!==this.driftAx&&(this.driftAx=0),function(o,a){s!==t?s!==e?s!==n?s===i&&function(t,e){if(It===V||wt===V)return;if(b<=0||I<=0)return;const n=I*q,i=t.x-It,o=t.y-wt,a=i*i+o*o;if(a>n*n)return;const s=Math.max(Math.sqrt(a),L),l=i/s,r=o/s,d=Math.max(0,1-s/n),h=b*d;t.vx+=l*h*e,t.vy+=r*h*e}(o,a):function(t,e){p>0&&(t.vx+=(Math.random()-.5)*p*e,t.vy+=(Math.random()-.5)*p*e),t.vx*=.98,t.vy*=.98;const n=(performance.now()/1e3-t.spawnTime)/t.lifetime,i=Math.max(0,1-n);t.r=t.rBase*i*y}(o,a):function(t,e){if(It===V||wt===V)return;const n=It-t.x,i=wt-t.y,o=n*n+i*i,a=Math.sqrt(o+1),s=n/a,l=i/a,r=4*h;t.vx+=s*r*e,t.vy+=l*r*e;const d=80*q;let c=0,m=0,f=0;for(let e=0;e<Ht.length;e++){const n=Ht[e];if(n===t)continue;const i=t.x-n.x,o=t.y-n.y,a=i*i+o*o;if(a<d*d&&a>0){const t=Math.sqrt(a),e=1-t/d;c+=i/t*e,m+=o/t*e,f++}}if(f>0){const n=15e3;t.vx+=c/f*n*e,t.vy+=m/f*n*e}if(Math.random()<.05){const e=Math.random()*Math.PI*2,n=800;t.vx+=Math.cos(e)*n,t.vy+=Math.sin(e)*n}t.vx+=1200*(Math.random()-.5)*e,t.vy+=1200*(Math.random()-.5)*e;const g=.5+1.5*Math.random(),p=1200*u*g*e;t.vx+=-l*p,t.vy+=s*p;const y=1400,x=Math.sqrt(t.vx*t.vx+t.vy*t.vy);x>y&&(t.vx=t.vx/x*y,t.vy=t.vy/x*y),t.vx*=.99,t.vy*=.99}(o,a):function(t,e){if(!Ct)return;if(Mt<=0||Et<=0)return;const n=Et*q,i=t.x-It,o=t.y-wt,a=i*i+o*o;if(a>n*n)return;const s=Math.max(Math.sqrt(a),L),l=i/s,r=o/s,d=Math.max(0,1-s/n),h=20*Mt*Math.pow(d,bt),c=Math.max(.25,t.m/1);t.vx+=l*h*e/c,t.vy+=r*h*e/c;t.vx+=10*(Math.random()-.5)*e,t.vy+=10*(Math.random()-.5)*e}(o,a)}(this,o),this.x+=this.vx*o,this.y+=this.vy*o;const r=Math.max(0,1-2*o);this.omega*=r,this.theta+=this.omega*o,this.theta>Math.PI?this.theta-=2*Math.PI:this.theta<-Math.PI&&(this.theta+=2*Math.PI);const d=Math.min(1,18*o);this.squashAmount+=(0-this.squashAmount)*d,this.squash=1-this.squashAmount}walls(t,e,n,i=H){const o=i;if(0===Ft){if(this.y+this.r>e){this.y=e-this.r;const t=this.vy,i=this.vx-this.omega*this.r,a=Math.max(.25,this.m/1);this.omega+=i/this.r*R/a;const s=Math.max(0,1-1.5*n/a);this.vx*=s;const l=Math.abs(t)<70?0:o;this.vy=-this.vy*(l*Math.pow(1/this.m,nt));const r=Math.min(1,Math.abs(t)/(90*this.r));this.squashAmount=Math.min(F(),.8*r),this.squash=1-this.squashAmount,this.squashNormalAngle=-Math.PI/2;const d=this.vx/this.r;this.omega+=(d-this.omega)*Math.min(1,8*n)}const i=e/3;if(this.y-this.r<i){this.y=i+this.r;const t=this.vy;this.vy=-this.vy*o;const e=Math.min(1,Math.abs(t)/(90*this.r));this.squashAmount=Math.min(F(),.8*e),this.squash=1-this.squashAmount,this.squashNormalAngle=Math.PI/2}if(this.x+this.r>t){this.x=t-this.r;{const t=this.vy-this.omega*this.r,e=Math.max(.25,this.m/1);this.omega+=t/this.r*.125/e}this.vx=-this.vx*o;const e=Math.min(1,Math.abs(this.vx)/(90*this.r));this.squashAmount=Math.min(F(),.8*e),this.squash=1-this.squashAmount,this.squashNormalAngle=Math.PI}if(this.x-this.r<0){this.x=this.r;{const t=this.vy-this.omega*this.r,e=Math.max(.25,this.m/1);this.omega+=t/this.r*.125/e}this.vx=-this.vx*o;const t=Math.min(1,Math.abs(this.vx)/(90*this.r));this.squashAmount=Math.min(F(),.8*t),this.squash=1-this.squashAmount,this.squashNormalAngle=0}}else this.handleRoundedWallCollision(t,e);this.checkTextCollisions(n)}checkTextCollisions(t){for(let t=0;t<Pt.length;t++){const e=Pt[t],n=Math.max(e.x,Math.min(this.x,e.x+e.width)),i=Math.max(e.y,Math.min(this.y,e.y+e.height)),o=this.x-n,a=this.y-i,s=Math.sqrt(o*o+a*a);if(s<this.r)if(0===s){const t=this.x-e.x,n=e.x+e.width-this.x,i=this.y-e.y,o=e.y+e.height-this.y,a=Math.min(t,n,i,o);a===t?(this.x=e.x-this.r,this.vx=-Math.abs(this.vx)*H):a===n?(this.x=e.x+e.width+this.r,this.vx=Math.abs(this.vx)*H):a===i?(this.y=e.y-this.r,this.vy=-Math.abs(this.vy)*H):(this.y=e.y+e.height+this.r,this.vy=Math.abs(this.vy)*H)}else{const t=this.r-s,e=o/s,n=a/s;this.x+=e*t,this.y+=n*t;const i=this.vx*e+this.vy*n;if(i<0){this.vx-=2*i*e*H,this.vy-=2*i*n*H;const t=Math.min(1,Math.abs(i)/(70*this.r));this.squash=1-F()*t,this.squashDirX=Math.abs(e)>Math.abs(n)?1:0,this.squashDirY=Math.abs(n)>Math.abs(e)?1:0}}}}handleRoundedWallCollision(t,e){const n=Ft,i=[{x:n,y:n},{x:t-n,y:n},{x:t-n,y:e-n},{x:n,y:e-n}];for(let o=0;o<i.length;o++){const a=i[o],s=this.x-a.x,l=this.y-a.y,r=Math.sqrt(s*s+l*l);if(this.isInCornerRegion(a,t,e,n)&&r+this.r>n){const t=n-(r-this.r);if(t>0&&r>0){const e=s/r,n=l/r;this.x+=e*t,this.y+=n*t;const i=this.vx*e+this.vy*n;this.vx-=2*i*e*H,this.vy-=2*i*n*H;const o=Math.min(1,Math.abs(i)/(90*this.r));this.squashAmount=Math.min(F(),.8*o),this.squash=1-this.squashAmount,this.squashNormalAngle=Math.atan2(n,e)}}}if(this.y+this.r>e&&(this.x<n||this.x>t-n)&&(this.y=e-this.r,this.vy=-this.vy*(H*Math.pow(1/this.m,nt))),this.y-this.r<0&&(this.x<n||this.x>t-n)&&(this.y=this.r,this.vy=-this.vy*H),this.x+this.r>t&&(this.y<n||this.y>e-n)){this.x=t-this.r;{const t=this.vy-this.omega*this.r,e=Math.max(.25,this.m/1);this.omega+=t/this.r*.125/e}this.vx=-this.vx*(H*Math.pow(1/this.m,nt));const e=Math.min(1,Math.abs(this.vx)/(70*this.r));this.squashAmount=Math.min(F(),e),this.squash=1-this.squashAmount,this.squashNormalAngle=Math.PI}if(this.x-this.r<0&&(this.y<n||this.y>e-n)){this.x=this.r;{const t=this.vy-this.omega*this.r,e=Math.max(.25,this.m/1);this.omega+=t/this.r*.125/e}this.vx=-this.vx*(H*Math.pow(1/this.m,nt));const t=Math.min(1,Math.abs(this.vx)/(70*this.r));this.squashAmount=Math.min(F(),t),this.squash=1-this.squashAmount,this.squashNormalAngle=0}this.y+this.r>e&&this.x>=n&&this.x<=t-n&&(this.y=e-this.r,this.vy=-this.vy*(H*Math.pow(1/this.m,nt))),this.y-this.r<0&&this.x>=n&&this.x<=t-n&&(this.y=this.r,this.vy=-this.vy*(H*Math.pow(1/this.m,nt))),this.x+this.r>t&&this.y>=n&&this.y<=e-n&&(this.x=t-this.r,this.vx=-this.vx*(H*Math.pow(1/this.m,nt))),this.x-this.r<0&&this.y>=n&&this.y<=e-n&&(this.x=this.r,this.vx=-this.vx*(H*Math.pow(1/this.m,nt)))}isInCornerRegion(t,e,n,i){return t.x===i&&t.y===i?this.x<=i&&this.y<=i:t.x===e-i&&t.y===i?this.x>=e-i&&this.y<=i:t.x===e-i&&t.y===n-i?this.x>=e-i&&this.y>=n-i:t.x===i&&t.y===n-i&&this.x<=i&&this.y>=n-i}draw(t){t.save(),t.translate(this.x,this.y);const e=Math.min(F(),Math.max(0,this.squashAmount));if(e>.001){const n=1+e,i=1/n;t.rotate(this.squashNormalAngle),t.scale(n,i),t.rotate(-this.squashNormalAngle)}t.beginPath(),t.arc(0,0,this.r,0,2*Math.PI),t.fillStyle=this.color,t.fill(),t.restore()}}const Ht=[];function _t(t,e,n){return Math.max(e,Math.min(n,t))}function jt(t,e){return t+Math.random()*(e-t)}function Yt(t,e,n=vt()){const i=(at+st)/2;let o;if(0===$)o=i;else{const t=(st-at)/2*$;o=jt(Math.max(1,i-t),i+t)}const a=new Wt(t,e,o,n),s=.5*T.width,l=dt?ct>=0?1:-1:t<s?1:-1,r=_t(o/(.5*(at+st)),.6,1.4),d=140*r,h=180*r;return a.vx=l*(d+Math.random()*h),a.vy=120*-Math.random(),a.driftAx=l*(360+420*Math.random())*r,a.driftTime=.22+.28*Math.random(),Ht.push(a),a}const Zt=new class{constructor(){this.dropQueue=[],this.currentIndex=0,this.lastDropTime=0,this.isActive=!1,this.dropPositions=[],this.preCalculatedSizes=[]}initialize(){this.clear(),this.preCalculateDropProperties(),this.generateDropPositions(),this.isActive=!0,this.lastDropTime=performance.now()/1e3}preCalculateDropProperties(){const t=Math.min(.15*T.height,.15*T.width),e=10*q,n=ft.length;this.preCalculatedSizes=[];for(let i=0;i<n;i++){let o;if(0===w)o=t-i/(n-1)*(t-e);else{const a=i/(n-1)+(Math.random()-.5)*w*.3;o=t-Math.max(0,Math.min(1,a))*(t-e)}this.preCalculatedSizes.push(o)}this.preCalculatedSizes.sort((t,e)=>e-t)}generateDropPositions(){const t=ft.length;this.dropPositions=[];for(let e=0;e<t;e++){const n=T.width/t*e+T.width/t*.5,i=(Math.random()-.5)*(T.width/t)*.6;this.dropPositions.push(Math.max(20,Math.min(T.width-20,n+i)))}}dropNext(){if(this.currentIndex>=ft.length||!this.isActive)return!1;const t=this.preCalculatedSizes[this.currentIndex],e=this.dropPositions[this.currentIndex],n=new Wt(e,-t-50,t,ft[this.currentIndex]);return n.vx=80*(Math.random()-.5),n.vy=0,Ht.push(n),this.currentIndex++,this.lastDropTime=performance.now()/1e3,!0}shouldDrop(){return!(!this.isActive||this.currentIndex>=ft.length)&&performance.now()/1e3-this.lastDropTime>=C}clear(){Ht.length=0,this.currentIndex=0,this.isActive=!1,this.lastDropTime=0,this.dropQueue=[],this.dropPositions=[],this.preCalculatedSizes=[]}getStatus(){return{isActive:this.isActive,currentIndex:this.currentIndex,totalColors:ft.length,progress:this.currentIndex/ft.length,remaining:ft.length-this.currentIndex}}};let Jt=0;function Kt(){const t=T.clientWidth,e=T.clientHeight,n=_t(N/100*t,0,t);let i=_t(z/100*t,0,t);if(dt){const e=.2*t,n=i;i=_t(i+Math.sin(ht)*e,0,t),ct=i>=n?1:-1}const o=Math.min(40,.1*n),a=_t(i-n/2-o,-o,t),s=_t(i+n/2+o,-o,t),l=k/100*e,r=l+U/100*e,d=Math.random();return{x:(a+(s-a)*(ct>0?Math.pow(d,.7):1-Math.pow(1-d,.7)))*q,y:jt(l*q,r*q)-(st+2+jt(0,10*q))}}const Xt=[];let $t=0;function Qt(){if($t<Xt.length)return Xt[$t++];{const t=new Wt(0,0,0,"#ffffff");return t.isSparkle=!0,t.active=!1,Xt.push(t),t}}function te(){$t=0;for(let t=0;t<Xt.length;t++)Xt[t].active=!1}const ee=new Map;function ne(t=6){const e=function(){const t=Ht.length;if(t<2)return[];const e=Math.max(1,2*st),n=Math.ceil(T.width/e)+1;ee.clear();for(let i=0;i<t;i++){const t=Ht[i],o=t.x/e|0,a=(t.y/e|0)*n+o;let s=ee.get(a);s||(s=[],ee.set(a,s)),s.push(i)}const i=[];for(const[t,e]of ee){const o=t/n|0,a=t%n;for(let t=-1;t<=1;t++)for(let s=-1;s<=1;s++){const l=(o+t)*n+(a+s),r=ee.get(l);if(r)for(let t=0;t<e.length;t++){const n=e[t];for(let t=0;t<r.length;t++){const e=r[t];if(e<=n)continue;const o=Ht[n],a=Ht[e],s=a.x-o.x,l=a.y-o.y,d=o.r+a.r,h=s*s+l*l;if(h<d*d){const t=d-Math.sqrt(Math.max(h,1e-6));i.push({i:n,j:e,overlap:t})}}}}}return i.sort((t,e)=>e.overlap-t.overlap),i}();for(let n=0;n<t;n++)for(let t=0;t<e.length;t++){const{i:n,j:i}=e[t],o=Ht[n],a=Ht[i],s=a.x-o.x,l=a.y-o.y,r=o.r+a.r,d=s*s+l*l;if(0===d||d>r*r)continue;const h=Math.sqrt(d),c=s/h,u=l/h,m=r-h,f=1/Math.max(o.m,.001),g=1/Math.max(a.m,.001),p=.8*Math.max(m-Z,0)/(f+g),y=p*c,x=p*u;o.x-=y*f,o.y-=x*f,a.x+=y*g,a.y+=x*g;const v=a.vx-o.vx,E=a.vy-o.vy,M=v*c+E*u;if(M<0){const t=-(1+(Math.abs(M)<30?0:H))*M/(f+g),e=t*c,n=t*u;o.vx-=e*f,o.vy-=n*f,a.vx+=e*g,a.vy+=n*g;const i=v-M*c,s=E-M*u,l=Math.hypot(i,s);if(l>.001){const t=i*-u+s*c>=0?1:-1,e=.18;o.omega-=t*e*l/Math.max(o.r,1),a.omega+=t*e*l/Math.max(a.r,1)}const r=Math.min(1,Math.abs(M)/(50*(o.r+a.r))),d=Math.min(F(),.8*r);o.squashAmount=Math.max(o.squashAmount,.8*d),o.squashNormalAngle=Math.atan2(-u,-c),a.squashAmount=Math.max(a.squashAmount,.8*d),a.squashNormalAngle=Math.atan2(u,c)}}}let ie=performance.now()/1e3,oe=0;const ae=1/120;console.log("High refresh mode enabled - using requestAnimationFrame"),requestAnimationFrame(function t(a){const l=a/1e3;let r=Math.min(.008,l-ie);ie=l,oe+=r,zt++,(Dt||Ot)&&l-Nt>=1&&(Dt&&zt!==Ut&&(Ut=zt,Dt.textContent=Ut.toString()),Ot&&kt!==Gt&&(Gt=kt,Ot.textContent=Gt.toString()),zt=0,kt=0,Nt=l),function(t){if(s!==n)if(s!==o)for(Jt+=t;Jt>=j;){const t=(Math.random()-.5)*j*.5;Jt-=j+t,ht+=2*Math.PI*.12*(j+t);const e=Kt(),n=Math.random()<.35?3:1;for(let t=0;t<n;t++)if(Ht.length<Y){const n=8*t*(Math.random()<.5?1:-1);Yt(e.x+n,e.y-12*t)}}else Zt.shouldDrop()&&Zt.dropNext();else!function(){if(It===V||wt===V)return;let t=0,e=0;if(x.length>=2){const n=x[x.length-1],i=x[x.length-2],o=Math.max(.001,n.time-i.time);t=(n.x-i.x)/o,e=(n.y-i.y)/o}if(Math.sqrt(t*t+e*e)<50)return;const n=m;for(let t=0;t<n;t++){const t=Qt();t.x=It,t.y=wt,t.isSparkle=!0,t.spawnTime=performance.now()/1e3,t.lifetime=f,t.active=!0,t.color=vt();const e=Math.random()*Math.PI*2,n=g*(.5+.5*Math.random());t.vx=Math.cos(e)*n,t.vy=Math.sin(e)*n,t.r=(at+st)/2*y,t.rBase=t.r,Ht.push(t)}}()}(r),zt%60==0&&rt();let d=0;for(;oe>=ae&&d<2;){for(let t=0;t<Ht.length;t++)Ht[t].step(ae);if(s!==e&&s!==n&&ne(3),s!==n){const t=s===i?E:s===o?B:H;for(let e=0;e<Ht.length;e++)Ht[e].walls(T.width,T.height,ae,t)}oe-=ae,d++,kt++}if(s===n)for(let t=Ht.length-1;t>=0;t--){const e=Ht[t];e.isSparkle&&e.r<=.5&&(e.active=!1,Ht.splice(t,1))}if(oe>3*ae&&(oe=0),At>0&&qt>0){const t=1.5,e=3,n=.35;let i=1+(n+(.0015-n)*Math.max(0,Math.min(1,At/t))-1)*Math.max(0,Math.min(1,qt/e));i=Math.max(.001,Math.min(1,i)),P.fillStyle=`rgba(0,0,0,${i})`,P.globalCompositeOperation="destination-out",P.fillRect(0,0,T.width,T.height),P.globalCompositeOperation="source-over"}else P.clearRect(0,0,T.width,T.height);Ft>0&&function(t,e,n){const i=Ft;t.strokeStyle="rgba(255, 255, 255, 0.1)",t.lineWidth=2,t.beginPath(),t.moveTo(i,0),t.lineTo(e-i,0),t.arcTo(e,0,e,i,i),t.lineTo(e,n-i),t.arcTo(e,n,e-i,n,i),t.lineTo(i,n),t.arcTo(0,n,0,n-i,i),t.lineTo(0,i),t.arcTo(0,0,i,0,i),t.closePath(),t.stroke()}(P,T.width,T.height);for(let t=0;t<Ht.length;t++)Ht[t].draw(P);if(function(t){if(St)return;if(It===V||wt===V)return;if(s===n)return;const e=It,i=wt,o=(at+st)/2;t.beginPath(),t.arc(e,i,o,0,2*Math.PI),t.fillStyle="rgba(255, 255, 255, 0.9)",t.fill(),t.strokeStyle="rgba(255, 255, 255, 0.6)",t.lineWidth=2,t.stroke()}(P),!St){P.save(),P.font="14px system-ui, -apple-system, sans-serif",P.fillStyle="rgba(255, 255, 255, 0.3)",P.textAlign="left",P.textBaseline="bottom";const t=s.charAt(0).toUpperCase()+s.slice(1);P.fillText(t+" Mode",10,T.height-10),P.restore()}requestAnimationFrame(t)}),window.addEventListener("keydown",a=>{const l=a.key.toLowerCase();"r"===l&&(function(){if(s===o)Zt.initialize();else if(s===i)On();else for(let t=0;t<Ht.length;t++){const e=Ht[t],n=Kt();e.x=n.x,e.y=n.y;const i=.5*T.width,o=dt?ct>=0?1:-1:e.x<i?1:-1,a=_t(e.r/(.5*(at+st)),.6,1.4),s=140*a,l=180*a,r=120;e.vx=o*(s+Math.random()*l),e.vy=-Math.random()*r,e.age=0,e.driftAx=o*(360+420*Math.random())*a,e.driftTime=.22+.28*Math.random()}}(),a.preventDefault()),"/"===l&&A&&(a.preventDefault(),A.classList.toggle("hidden")),"1"===l&&Wn(t),"2"===l&&Wn(e),"3"===l&&Wn(n),"4"===l&&Wn(i),"5"===l&&Wn(o)}),function(t=160){for(let e=0;e<t&&Ht.length<Y;e++){const t=Kt();Yt(t.x,t.y)}}(200),T.addEventListener("mousemove",e=>{const i=T.getBoundingClientRect();if(It=(e.clientX-i.left)*q,wt=(e.clientY-i.top)*q,s===t&&Mt>0&&Et>0&&(Ct=!0),s===n){const t=performance.now()/1e3;x.push({x:It,y:wt,time:t}),x.length>6&&x.shift()}}),T.addEventListener("mouseleave",()=>{It=V,wt=V,s===n&&(x=[],te())});const se=document.getElementById("restitutionSlider"),le=document.getElementById("frictionSlider"),re=document.getElementById("emitterSlider"),de=document.getElementById("sizeSliderGlobal"),he=document.getElementById("sizeVariationSliderGlobal"),ce=(document.getElementById("weightSliderGlobal"),document.getElementById("ballSoftnessSliderGlobal")),ue=document.getElementById("sizeValGlobal"),me=document.getElementById("sizeVariationValGlobal"),fe=(document.getElementById("weightValGlobal"),document.getElementById("ballSoftnessValGlobal")),ge=(document.getElementById("sizeSliderPit"),document.getElementById("sizeVariationSliderPit"),document.getElementById("weightSliderPit"),document.getElementById("ballSoftnessSliderPit"),document.getElementById("sizeValPit"),document.getElementById("sizeVariationValPit"),document.getElementById("weightValPit"),document.getElementById("ballSoftnessValPit"),document.getElementById("sizeSliderFlies"),document.getElementById("sizeVariationSliderFlies"),document.getElementById("weightSliderFlies"),document.getElementById("ballSoftnessSliderFlies"),document.getElementById("sizeValFlies"),document.getElementById("sizeVariationValFlies"),document.getElementById("weightValFlies"),document.getElementById("ballSoftnessValFlies"),document.getElementById("sizeSliderZeroG"),document.getElementById("sizeVariationSliderZeroG"),document.getElementById("weightSliderZeroG"),document.getElementById("ballSoftnessSliderZeroG"),document.getElementById("sizeValZeroG"),document.getElementById("sizeVariationValZeroG"),document.getElementById("weightValZeroG"),document.getElementById("ballSoftnessValZeroG"),document.getElementById("maxBallsSlider")),pe=document.getElementById("spawnYSlider"),ye=document.getElementById("spawnWidthSlider"),xe=document.getElementById("spawnCenterSlider"),ve=document.getElementById("spawnHeightSlider"),Ee=document.getElementById("repelSizeSlider"),Me=document.getElementById("repelPowerSlider"),be=document.getElementById("repelSoftSlider"),Ie=document.getElementById("colorSelect"),we=document.getElementById("color1"),Ce=document.getElementById("color2"),Se=document.getElementById("color3"),Be=document.getElementById("color4"),Ve=document.getElementById("color5"),Le=document.getElementById("color6"),Re=document.getElementById("color7"),Fe=document.getElementById("color8"),Te=document.getElementById("cursorColorSelect"),Pe=document.getElementById("color1Val"),Ae=document.getElementById("color2Val"),qe=document.getElementById("color3Val"),ze=document.getElementById("color4Val"),ke=document.getElementById("color5Val"),Ne=document.getElementById("color6Val"),Ue=document.getElementById("color7Val"),Ge=document.getElementById("color8Val");[Pe,Ae,qe,ze,ke,Ne,Ue,Ge].forEach(t=>{t&&t.setAttribute("title","Click to copy")});const De=document.getElementById("cornerRadiusSlider"),Oe=document.getElementById("cornerRadiusVal"),We=document.getElementById("trailFadeSlider"),He=document.getElementById("trailFadeVal"),_e=document.getElementById("trailSubtletySlider"),je=document.getElementById("trailSubtletyVal"),Ye=document.getElementById("restitutionVal"),Ze=document.getElementById("frictionVal"),Je=document.getElementById("emitterVal"),Ke=document.getElementById("maxBallsVal"),Xe=document.getElementById("spawnYVal"),$e=document.getElementById("spawnWidthVal"),Qe=document.getElementById("spawnCenterVal"),tn=document.getElementById("spawnHeightVal"),en=document.getElementById("repelSizeVal"),nn=document.getElementById("repelPowerVal"),on=document.getElementById("repelSoftVal");function an(){return{gravityMultiplier:O,restitution:H,friction:_,ballMass:et,emitRate:j,maxBalls:Y,ballScale:X,ballVariation:$,spawnX:z,spawnY:k,spawnWidth:N,spawnHeight:U,sweepEnabled:dt,repelRadius:Et,repelPower:Mt,repelSoftness:bt,trailFade:At,trailSubtlety:qt,colors:ft.slice(),colorWeights:xt.slice(),currentTemplate:mt,cursorColorIndex:gt}}const sn=document.getElementById("saveConfigBtn"),ln=document.getElementById("buildBtn"),rn=document.getElementById("configOutput");function dn(t,e){t&&t.addEventListener("click",async()=>{const n="function"==typeof e?e():String(e||"").trim();try{await navigator.clipboard.writeText(n);const e=t.textContent;t.textContent="COPIED",t.style.color="#3ddc84",setTimeout(()=>{t.textContent=e,t.style.color="#888"},900)}catch(t){console.warn("Clipboard unavailable")}})}sn&&ln&&rn&&(sn.addEventListener("click",()=>{const t=(e=an(),`// Generated configuration from frontend\nconst CONFIG = ${JSON.stringify(e,null,2)};`);var e;rn.style.display="block",rn.textContent=t,navigator.clipboard.writeText(t).then(()=>{const t=sn.textContent;sn.textContent="âœ… Copied!",setTimeout(()=>{sn.textContent=t},1200)}).catch(()=>{console.warn("Clipboard copy failed");const t=sn.textContent;sn.textContent="âš ï¸ Copy failed",setTimeout(()=>{sn.textContent=t},1200)})}),ln.addEventListener("click",()=>{const t=an();rn.style.display="block",rn.innerHTML="\n<strong>ðŸš€ Build Instructions:</strong><br>\n1. Run: <code>npm run build</code><br>\n2. Your current config will be baked into <code>public/js/bouncy-balls-embed.js</code>";const e=new Blob([JSON.stringify(t,null,2)],{type:"application/json"}),n=URL.createObjectURL(e),i=document.createElement("a");i.href=n,i.download="current-config.json",i.click(),URL.revokeObjectURL(n)})),se&&se.addEventListener("input",()=>{H=parseFloat(se.value),Ye&&(Ye.textContent=H.toFixed(2)),Lt()}),le&&le.addEventListener("input",()=>{_=parseFloat(le.value),Ze&&(Ze.textContent=_.toFixed(4)),Lt()}),re&&re.addEventListener("input",()=>{j=parseFloat(re.value),Je&&(Je.textContent=j.toFixed(3)),Lt()}),function(t){if(!t)return;const{size:e,sizeVal:n,sizeVar:i,sizeVarVal:o,soft:a,softVal:s}=t;e&&e.addEventListener("input",()=>{const t=parseFloat(e.value);n&&(n.textContent=t.toFixed(1)),X=t,lt();for(let t=0;t<Ht.length;t++)Ht[t].m=et;Lt()}),i&&i.addEventListener("input",()=>{const t=parseFloat(i.value);o&&(o.textContent=t.toFixed(1)),$=t,Lt()}),a&&a.addEventListener("input",()=>{const t=parseInt(a.value,10);s&&(s.textContent=String(t)),l=t,Lt()})}({size:de,sizeVal:ue,sizeVar:he,sizeVarVal:me,soft:ce,softVal:fe}),ge&&ge.addEventListener("input",()=>{Y=parseInt(ge.value,10),Ke&&(Ke.textContent=Y.toString()),Ht.length>Y&&(Ht.length=Y)}),he&&he.addEventListener("input",()=>{$=parseFloat(he.value),me&&(me.textContent=$.toFixed(1)),pn()});const hn=document.getElementById("weightPitSlider"),cn=document.getElementById("weightPitVal"),un=document.getElementById("weightWeightlessSlider"),mn=document.getElementById("weightWeightlessVal"),fn=document.getElementById("weightRainbowSlider"),gn=document.getElementById("weightRainbowVal");function pn(){const t=(at+st)/2;for(let e=0;e<Ht.length;e++){const n=Ht[e];if(0===$)n.r=t;else{const e=(st-at)/2*$,i=Math.max(1,t-e),o=t+e;n.r=jt(i,o)}n.m=et}}pe&&pe.addEventListener("input",()=>{k=parseFloat(pe.value),Xe&&(Xe.textContent=k.toFixed(0)),G()}),ye&&ye.addEventListener("input",()=>{N=parseFloat(ye.value),$e&&($e.textContent=N.toFixed(0))}),xe&&xe.addEventListener("input",()=>{z=parseFloat(xe.value),Qe&&(Qe.textContent=z.toFixed(0))}),ve&&ve.addEventListener("input",()=>{U=parseFloat(ve.value),tn&&(tn.textContent=U.toFixed(0))}),Ee&&Ee.addEventListener("input",()=>{Et=parseFloat(Ee.value),en&&(en.textContent=Et.toFixed(0)),Ct=Ct||Mt>0&&Et>0}),Me&&Me.addEventListener("input",()=>{Mt=function(t){const e=Math.max(0,Math.min(Rt,Number(t)))/Rt;return 2*Math.pow(2,12*(e-.5))*12e3}(Me.value),nn&&(nn.textContent=Math.round(Mt).toString()),gi&&"off"!==gi.value&&(Ct=Mt>0&&Et>0)}),be&&be.addEventListener("input",()=>{bt=parseFloat(be.value),on&&(on.textContent=bt.toFixed(1))}),Ie&&Ie.addEventListener("change",()=>{const t=ut[Ie.value];t&&(mt=Ie.value,ft=t.colors.slice(),pt=ft[gt]||pt,we&&Pe&&(we.value=ft[0],Pe.textContent=ft[0].toUpperCase()),Ce&&Ae&&(Ce.value=ft[1],Ae.textContent=ft[1].toUpperCase()),Se&&qe&&(Se.value=ft[2],qe.textContent=ft[2].toUpperCase()),Be&&ze&&(Be.value=ft[3],ze.textContent=ft[3].toUpperCase()),Ve&&ke&&(Ve.value=ft[4],ke.textContent=ft[4].toUpperCase()),Le&&Ne&&(Le.value=ft[5],Ne.textContent=ft[5].toUpperCase()),Re&&Ue&&(Re.value=ft[6],Ue.textContent=ft[6].toUpperCase()),Fe&&Ge&&(Fe.value=ft[7],Ge.textContent=ft[7].toUpperCase()),ri(),yt())});const yn=Array.from(document.querySelectorAll(".mode-button")),xn=document.getElementById("pitControls"),vn=document.getElementById("fliesControls"),En=document.getElementById("trailControls"),Mn=document.getElementById("weightlessControls"),bn=document.getElementById("rainbowControls"),In=document.getElementById("gravityPitSlider"),wn=document.getElementById("gravityPitVal"),Cn=document.getElementById("repellerEnabledPit"),Sn=document.getElementById("attractPowerSlider"),Bn=document.getElementById("attractPowerVal"),Vn=document.getElementById("orbitRadiusSlider"),Ln=document.getElementById("orbitRadiusVal"),Rn=document.getElementById("swarmSpeedSlider"),Fn=document.getElementById("swarmSpeedVal"),Tn=document.getElementById("sparkleEmissionSlider"),Pn=document.getElementById("sparkleEmissionVal"),An=document.getElementById("sparkleLifetimeSlider"),qn=document.getElementById("sparkleLifetimeVal"),zn=document.getElementById("sparkleSpreadSlider"),kn=document.getElementById("sparkleSpreadVal"),Nn=document.getElementById("sparkleDriftSlider"),Un=document.getElementById("sparkleDriftVal"),Gn=document.getElementById("sparkleScaleSlider"),Dn=document.getElementById("sparkleScaleVal");function On(){Ht.length=0;const t=M,e=T.width,n=T.height,i=e/n,o=Math.ceil(Math.sqrt(t*i)),a=Math.ceil(t/o),s=(e-80)/(o-1),l=(n-80)/(a-1),r=[];for(let i=0;i<a;i++)for(let a=0;a<o&&!(r.length>=t);a++){const t=40+a*s,o=40+i*l,d=(Math.random()-.5)*s*.3,h=(Math.random()-.5)*l*.3;r.push({x:Math.max(20,Math.min(e-20,t+d)),y:Math.max(20,Math.min(n-20,o+h))})}for(let t=0;t<r.length;t++){const e=r[t],n=Yt(e.x,e.y),i=Math.random()*Math.PI*2,o=v*(.5+.5*Math.random());n.vx=Math.cos(i)*o,n.vy=Math.sin(i)*o,n.driftAx=0,n.driftTime=0}console.log(`Weightless scene initialized: ${Ht.length} balls distributed evenly across viewport`)}function Wn(a){s=a,s===t?(O=r,W=D*O,Ct=d&&Mt>0&&Et>0,dt=!0):s===e?(O=0,W=D*O,Ct=!1,dt=!1):s===n?(O=0,W=D*O,Ct=!1,dt=!1,x=[],Ht.length=0,te()):s===i?(O=0,W=D*O,Ct=!1,dt=!1,On()):s===o&&(O=S,W=D*O,Ct=!1,dt=!1,Zt.initialize()),xn&&xn.classList.toggle("active",s===t),vn&&vn.classList.toggle("active",s===e),En&&En.classList.toggle("active",s===n),Mn&&Mn.classList.toggle("active",s===i),bn&&bn.classList.toggle("active",s===o),yn.forEach(t=>t.classList.toggle("active",t.getAttribute("data-mode")===s))}yn.forEach(t=>t.addEventListener("click",()=>{Wn(t.getAttribute("data-mode")),Lt()})),In&&In.addEventListener("input",()=>{r=parseFloat(In.value),wn&&(wn.textContent=r.toFixed(1)),Lt(),s===t&&(O=r,W=D*O)}),hn&&hn.addEventListener("input",()=>{et=parseFloat(hn.value),cn&&(cn.textContent=et.toFixed(2));for(let t=0;t<Ht.length;t++)Ht[t].m=et;ot(),Lt()}),Cn&&Cn.addEventListener("change",()=>{d=!!Cn.checked,s===t&&(Ct=d&&Mt>0&&Et>0)}),Sn&&Sn.addEventListener("input",()=>{h=parseFloat(Sn.value),Bn&&(Bn.textContent=Math.round(h).toString())}),Vn&&Vn.addEventListener("input",()=>{c=parseFloat(Vn.value),Ln&&(Ln.textContent=Math.round(c).toString())}),Rn&&Rn.addEventListener("input",()=>{u=parseFloat(Rn.value),Fn&&(Fn.textContent=u.toFixed(1))}),Tn&&Tn.addEventListener("input",()=>{m=parseInt(Tn.value,10),Pn&&(Pn.textContent=m.toString()),Lt()}),An&&An.addEventListener("input",()=>{f=parseFloat(An.value),qn&&(qn.textContent=f.toFixed(1)),Lt()}),zn&&zn.addEventListener("input",()=>{g=parseInt(zn.value,10),kn&&(kn.textContent=g.toString()),Lt()}),Nn&&Nn.addEventListener("input",()=>{p=parseInt(Nn.value,10),Un&&(Un.textContent=p.toString()),Lt()}),Gn&&Gn.addEventListener("input",()=>{y=parseFloat(Gn.value),Dn&&(Dn.textContent=y.toFixed(2)),Lt()});const Hn=document.getElementById("weightlessSpeedSlider"),_n=document.getElementById("weightlessSpeedVal"),jn=document.getElementById("weightlessBounceSlider"),Yn=document.getElementById("weightlessBounceVal"),Zn=document.getElementById("weightlessMaxBallsSlider"),Jn=document.getElementById("weightlessMaxBallsVal"),Kn=document.getElementById("weightlessRepelPowerSlider"),Xn=document.getElementById("weightlessRepelPowerVal"),$n=document.getElementById("weightlessRepelRadiusSlider"),Qn=document.getElementById("weightlessRepelRadiusVal");Hn&&Hn.addEventListener("input",()=>{v=parseFloat(Hn.value),_n&&(_n.textContent=Math.round(v).toString())}),un&&un.addEventListener("input",()=>{et=parseFloat(un.value),mn&&(mn.textContent=et.toFixed(2));for(let t=0;t<Ht.length;t++)Ht[t].m=et;ot(),Lt()}),jn&&jn.addEventListener("input",()=>{E=parseFloat(jn.value),Yn&&(Yn.textContent=E.toFixed(2))}),Zn&&Zn.addEventListener("input",()=>{M=parseInt(Zn.value,10),Jn&&(Jn.textContent=M.toString()),s===i&&On()}),Kn&&Kn.addEventListener("input",()=>{b=parseFloat(Kn.value),Xn&&(Xn.textContent=Math.round(b).toString())}),$n&&$n.addEventListener("input",()=>{I=parseFloat($n.value),Qn&&(Qn.textContent=Math.round(I).toString())});const ti=document.getElementById("rainbowRandomnessSlider"),ei=document.getElementById("rainbowRandomnessVal"),ni=document.getElementById("rainbowDropDelaySlider"),ii=document.getElementById("rainbowDropDelayVal"),oi=document.getElementById("rainbowGravitySlider"),ai=document.getElementById("rainbowGravityVal"),si=document.getElementById("rainbowBounceSlider"),li=document.getElementById("rainbowBounceVal");function ri(){for(let t=0;t<Ht.length;t++)Ht[t].color=vt()}ti&&ti.addEventListener("input",()=>{w=parseFloat(ti.value),ei&&(ei.textContent=w.toFixed(1))}),fn&&fn.addEventListener("input",()=>{et=parseFloat(fn.value),gn&&(gn.textContent=et.toFixed(2));for(let t=0;t<Ht.length;t++)Ht[t].m=et;ot(),Lt()}),ni&&ni.addEventListener("input",()=>{C=parseFloat(ni.value),ii&&(ii.textContent=C.toFixed(2))}),oi&&oi.addEventListener("input",()=>{S=parseFloat(oi.value),ai&&(ai.textContent=S.toFixed(1)),s===o&&(O=S,W=D*O)}),si&&si.addEventListener("input",()=>{B=parseFloat(si.value),li&&(li.textContent=B.toFixed(2))}),we&&we.addEventListener("input",()=>{ft[0]=we.value,Pe&&(Pe.textContent=we.value.toUpperCase()),ri(),yt()}),Ce&&Ce.addEventListener("input",()=>{ft[1]=Ce.value,Ae&&(Ae.textContent=Ce.value.toUpperCase()),ri(),yt()}),Se&&Se.addEventListener("input",()=>{ft[2]=Se.value,qe&&(qe.textContent=Se.value.toUpperCase()),ri(),yt()}),Be&&Be.addEventListener("input",()=>{ft[3]=Be.value,ze&&(ze.textContent=Be.value.toUpperCase()),ri(),yt()}),Ve&&Ve.addEventListener("input",()=>{ft[4]=Ve.value,ke&&(ke.textContent=Ve.value.toUpperCase()),ri(),yt()}),Le&&Le.addEventListener("input",()=>{ft[5]=Le.value,Ne&&(Ne.textContent=Le.value.toUpperCase()),ri(),yt()}),Re&&Re.addEventListener("input",()=>{ft[6]=Re.value,Ue&&(Ue.textContent=Re.value.toUpperCase()),ri(),yt()}),Fe&&Fe.addEventListener("input",()=>{ft[7]=Fe.value,Ge&&(Ge.textContent=Fe.value.toUpperCase()),ri(),yt()}),Te&&Te.addEventListener("change",()=>{const t=Math.max(1,Math.min(8,parseInt(Te.value,10)))-1;gt=t,pt=ft[gt]||pt}),dn(Pe,()=>we.value.toUpperCase()),dn(Ae,()=>Ce.value.toUpperCase()),dn(qe,()=>Se.value.toUpperCase()),dn(ze,()=>Be.value.toUpperCase()),dn(ke,()=>Ve.value.toUpperCase()),dn(Ne,()=>Le.value.toUpperCase()),dn(Ue,()=>Re.value.toUpperCase()),dn(Ge,()=>Fe.value.toUpperCase()),De&&De.addEventListener("input",()=>{Ft=parseFloat(De.value),Oe&&(Oe.textContent=Ft.toFixed(0))}),We&&We.addEventListener("input",()=>{At=parseFloat(We.value),He&&(He.textContent=At.toFixed(3))}),_e&&_e.addEventListener("input",()=>{qt=parseFloat(_e.value),je&&(je.textContent=qt.toFixed(2)+"Ã—")});const di={rubberPlayground:{label:"Rubber â€“ Playground",G:1960,REST:.9,FRICTION:.0025,sizeScale:1.8,maxBalls:450,sizeVariation:.2},rubberRacquet:{label:"Rubber â€“ Racquetball",G:3320,REST:.97,FRICTION:.0035,sizeScale:2.1,maxBalls:350,sizeVariation:.3},rubberSuperball:{label:"Rubber â€“ Superball",G:1960,REST:.95,FRICTION:.0015,sizeScale:1.2,maxBalls:450,sizeVariation:.05},rubberSoft:{label:"Rubber â€“ Soft",G:1960,REST:.86,FRICTION:.0035,sizeScale:2.2,maxBalls:350,sizeVariation:.25},rubberHeavy:{label:"Rubber â€“ Heavy",G:1960,REST:.88,FRICTION:.003,sizeScale:2,maxBalls:400,sizeVariation:.15}},hi={fullRain:{label:"Full Rain (top-half)",EMIT_INTERVAL:.03,xCenter:50,y:-50,w:100,h:50},narrowStrip:{label:"Narrow Strip Top",EMIT_INTERVAL:.05,xCenter:50,y:-40,w:20,h:10},leftGutter:{label:"Left Gutter",EMIT_INTERVAL:.045,xCenter:10,y:-60,w:18,h:20},rightGutter:{label:"Right Gutter",EMIT_INTERVAL:.045,xCenter:90,y:-60,w:18,h:20},centerFountain:{label:"Center Fountain",EMIT_INTERVAL:.02,xCenter:50,y:-30,w:30,h:20},stormBurst:{label:"Storm Burst",EMIT_INTERVAL:.005,xCenter:50,y:-80,w:100,h:30},slowSnow:{label:"Slow Snow",EMIT_INTERVAL:.2,xCenter:50,y:-30,w:100,h:20},edgeDrizzle:{label:"Edge Drizzle",EMIT_INTERVAL:.08,xCenter:15,y:-40,w:30,h:15},twinColumns:{label:"Twin Columns",EMIT_INTERVAL:.03,xCenter:30,y:-50,w:10,h:40},focusedBeam:{label:"Focused Beam",EMIT_INTERVAL:.015,xCenter:50,y:-70,w:6,h:12}},ci={off:{label:"Off",r:710,p:274e3,s:4.4},gentle:{label:"Gentle Breeze",r:120,p:2500,s:2.5},pushField:{label:"Push Field",r:240,p:8e4,s:2},tractor:{label:"Tractor Push",r:320,p:14e4,s:1.6},magnet:{label:"Magnet Repel",r:200,p:18e4,s:3},pulse:{label:"Pulse Strong",r:280,p:22e4,s:1.2},wideSoft:{label:"Wide Soft",r:500,p:8e4,s:4.5},needle:{label:"Needle Point",r:80,p:26e4,s:.8},wall:{label:"Invisible Wall",r:700,p:16e4,s:5},singularity:{label:"Singularity",r:600,p:3e5,s:.5}};function ui(t,e,n){t.innerHTML="";for(const[i,o]of Object.entries(e)){const e=document.createElement("option");e.value=i,e.textContent=o.label||i,i===n&&(e.selected=!0),t.appendChild(e)}}const mi=document.getElementById("physicsSelect"),fi=document.getElementById("spawnSelect"),gi=document.getElementById("repellerSelect");function pi(t,e,n,i=0){t&&(t.value=String(n)),e&&(e.textContent=i>0?n.toFixed(i):n.toString())}function yi(t){const e=di[t];if(!e)return;H=e.REST,_=e.FRICTION,Y=e.maxBalls,$=e.sizeVariation;const n=e.sizeScale;X=n,lt();for(let t=0;t<Ht.length;t++)Ht[t].m=et;Ht.length>Y&&(Ht.length=Y),pi(se,Ye,H,2),pi(le,Ze,_,4),pi(de,ue,X,1),pi(ge,Ke,Y,0),pi(he,me,$,1),pn()}function xi(t){const e=hi[t];e&&(j=e.EMIT_INTERVAL,z=e.xCenter,k=e.y,N=e.w,U=e.h,pi(re,Je,j,3),pi(xe,Qe,z,0),pi(pe,Xe,k,0),pi(ye,$e,N,0),pi(ve,tn,U,0))}function vi(t){const e=ci[t];if(!e)return;Et=e.r,Mt=1*e.p,Ct="off"!==t,pi(Ee,en,Et,0);const n=function(t){const e=Math.max(1,Number(t))/24e3,n=.5+Math.log2(e)/12;return Math.round(Math.max(0,Math.min(1,n))*Rt)}(Mt);Me&&(Me.value=String(n)),nn&&(nn.textContent=Math.round(Mt).toString()),pi(be,on,bt,1)}mi&&ui(mi,di,"rubberRacquet"),fi&&ui(fi,hi,"fullRain"),gi&&ui(gi,ci,"off"),Ie&&ui(Ie,ut,"industrialTeal"),yi("rubberRacquet"),xi("fullRain"),vi("off");const Ei=ut[mt];we&&Pe&&(we.value=Ei.colors[0],Pe.textContent=Ei.colors[0].toUpperCase()),Ce&&Ae&&(Ce.value=Ei.colors[1],Ae.textContent=Ei.colors[1].toUpperCase()),Se&&qe&&(Se.value=Ei.colors[2],qe.textContent=Ei.colors[2].toUpperCase()),Be&&ze&&(Be.value=Ei.colors[3],ze.textContent=Ei.colors[3].toUpperCase()),Ve&&ke&&(Ve.value=Ei.colors[4],ke.textContent=Ei.colors[4].toUpperCase()),Le&&Ne&&(Le.value=Ei.colors[5],Ne.textContent=Ei.colors[5].toUpperCase()),Re&&Ue&&(Re.value=Ei.colors[6],Ue.textContent=Ei.colors[6].toUpperCase()),Fe&&Ge&&(Fe.value=Ei.colors[7],Ge.textContent=Ei.colors[7].toUpperCase()),yt(Ei.colors),mi&&mi.addEventListener("change",()=>yi(mi.value)),fi&&fi.addEventListener("change",()=>xi(fi.value)),gi&&gi.addEventListener("change",()=>vi(gi.value)),lt(),rt(),function(){try{const t=localStorage.getItem(Bt);if(t){const e=JSON.parse(t);return e.currentMode&&(s=e.currentMode),void 0!==e.gravityMultiplierPit&&(r=e.gravityMultiplierPit),void 0!==e.repellerEnabledPit&&(d=e.repellerEnabledPit),e.attractionPower&&(h=e.attractionPower),e.orbitRadius&&(c=e.orbitRadius),e.swarmSpeed&&(u=e.swarmSpeed),void 0!==e.sparkleEmissionRate&&(m=e.sparkleEmissionRate),void 0!==e.sparkleLifetime&&(f=e.sparkleLifetime),void 0!==e.sparkleVelocitySpread&&(g=e.sparkleVelocitySpread),void 0!==e.sparkleDriftStrength&&(p=e.sparkleDriftStrength),void 0!==e.sparkleParticleScale&&(y=e.sparkleParticleScale),e.weightlessInitialSpeed&&(v=e.weightlessInitialSpeed),e.weightlessBounce&&(E=e.weightlessBounce),e.weightlessMaxBalls&&(M=e.weightlessMaxBalls),void 0!==e.weightlessRepellerPower&&(b=e.weightlessRepellerPower),void 0!==e.weightlessRepellerRadius&&(I=e.weightlessRepellerRadius),e.restitution&&(H=e.restitution),void 0!==e.friction&&(_=e.friction),e.sizeScale&&(X=e.sizeScale),void 0!==e.sizeVariation&&($=e.sizeVariation),e.ballMassKg&&(et=e.ballMassKg),e.repelPower&&(Mt=e.repelPower),e.repelRadius&&(Et=e.repelRadius),e.repelSoft&&(bt=e.repelSoft),void 0!==e.cornerRadius&&(Ft=e.cornerRadius),void 0!==e.motionBlur&&(At=e.motionBlur),e.trailSubtlety&&(qt=e.trailSubtlety),e.currentTemplate&&(mt=e.currentTemplate),e.cursorBallColor&&(pt=e.cursorBallColor),console.log("âœ“ Settings loaded"),!0}}catch(t){console.warn("Could not load settings:",t)}}(),function(){const t=St?"mobile":"desktop",e=document.getElementById("trailModeButton");e&&!a[n][t]&&(e.style.display="none")}(),Wn(s),window.addEventListener("beforeunload",Vt)})();