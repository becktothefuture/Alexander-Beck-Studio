(()=>{const t="pit",e="flies",n="trail";let a=t,o=1.1,i=!0,s=15e3,l=150,r=1,h=50,d=20,c=.95,u=[];const m=-1e9,f=.25,x=.2,g=document.getElementById("c"),y=g.getContext("2d",{alpha:!0}),p=document.getElementById("controlPanel"),v=Math.max(1,Math.min(2,window.devicePixelRatio||1));let M=50,b=-50,E=100,C=50;function I(){const t=1.5*window.innerHeight;g.width=Math.floor(window.innerWidth*v),g.height=Math.floor(t*v)}I(),window.addEventListener("resize",()=>{I(),D(),j()});const w=1960;let B=1.1,S=w*B,L=.88,T=.003,q=.03,A=400;const R=.5*v,F=6,V=24;let P=2,N=.15,U=1,z=null,k=11.2;const O=.15;let G=1;function W(){G=Math.max(.5,Math.min(3,Math.pow(k/1,.35)))}W();let H=F*P,_=V*P;function D(){U=(g.clientWidth||window.innerWidth)<=768?.4:1;const t=P*U;if(null===z)return z=t,H=F*t,void(_=V*t);const e=t/z;if(1!==e){for(let t=0;t<It.length;t++)It[t].r*=e;z=t}H=F*t,_=V*t}function j(){mt=[];const t=document.querySelector(ut);if(!t)return;const e=t.getBoundingClientRect(),n=g.getBoundingClientRect(),a=function(t){const e=document.createElement("span");e.style.cssText=window.getComputedStyle(t).cssText,e.style.position="absolute",e.style.visibility="hidden",e.style.whiteSpace="nowrap",e.textContent="ABCDEFGHIJKLMNOPQRSTUVWXYZ",document.body.appendChild(e);const n=e.getBoundingClientRect().height;return document.body.removeChild(e),n}(t),o=.5*(e.height-a),i={x:(e.left-n.left)*v,y:(e.top-n.top+o)*v,width:e.width*v,height:a*v};i.width>0&&i.height>0&&i.x<g.width&&i.y<g.height&&i.x+i.width>0&&i.y+i.height>0&&mt.push(i)}let Y=!0,X=0,$=1;const J={industrialTeal:{label:"Industrial Teal",colors:["#b7bcb7","#e4e9e4","#ffffff","#00695c","#000000","#ff4013","#0d5cb6","#ffa000"]},modern:{label:"Modern European",colors:["#9ca3af","#d1d5db","#ffffff","#ff3b30","#000000","#00e5ff","#1976d2","#ffc107"]},corporate:{label:"Corporate Modern",colors:["#a0a8b1","#d2d8de","#ffffff","#1a73e8","#000000","#ff5722","#7b1fa2","#ffa000"]},minimal:{label:"Helvetica Minimal",colors:["#bdbdbd","#e0e0e0","#ffffff","#6b7280","#000000","#40e0d0","#303f9f","#ff9800"]},euroBlue:{label:"European Blue",colors:["#9aa6b2","#d4dde5","#ffffff","#0a66c2","#000000","#ff4081","#388e3c","#ffb300"]},scandi:{label:"Scandinavian Bright",colors:["#aab2b7","#e6eaee","#ffffff","#74b9ff","#000000","#e91e63","#1976d2","#4caf50"]},neonCyan:{label:"Graphite Neon Cyan",colors:["#9aa0a6","#d5d9dd","#ffffff","#00e5ff","#000000","#ff9800","#9c27b0","#4caf50"]},coralTech:{label:"Coral Tech",colors:["#9da3a9","#d8dde2","#ffffff","#ff6b6b","#000000","#00e676","#3f51b5","#ff5722"]},violetMidnight:{label:"Violet Midnight",colors:["#9fa3b1","#d9dce3","#ffffff","#7c3aed","#000000","#e91e63","#388e3c","#ffb300"]},mintSage:{label:"Mint Sage",colors:["#a0a7a2","#dbe0dd","#ffffff","#00c896","#000000","#ff1744","#3f51b5","#ff9800"]},slateAzure:{label:"Slate Azure",colors:["#9aa3ad","#d8dee6","#ffffff","#3b82f6","#000000","#ff4081","#388e3c","#ffc107"]},vaporPop:{label:"Vapor Pop",colors:["#9ea0a8","#d6d7dc","#ffffff","#ff00e5","#000000","#00bcd4","#673ab7","#ff5722"]},cyberMagenta:{label:"Cyber Magenta",colors:["#9c9fad","#d6d9e3","#ffffff","#ff007a","#000000","#40e0d0","#1976d2","#ff9800"]},streetLime:{label:"Street Lime",colors:["#9aa19a","#d6dbd6","#ffffff","#baff00","#000000","#e91e63","#3f51b5","#ff6f00"]},cmykPop:{label:"CMYK Pop",colors:["#9f9f9f","#d9d9d9","#ffffff","#ffd400","#000000","#ff1744","#7b1fa2","#4caf50"]}};let K="industrialTeal",Q=["#b7bcb7","#e4e9e4","#ffffff","#00695c","#000000","#ff4013","#0d5cb6","#ffa000"],Z=5,tt=Q[Z]||"#ff4013";function et(t=Q){try{const e=document.documentElement,n=(t&&t.length?t:Q).slice(0,8);for(let t=0;t<8;t++){const a=n[t]||"#ffffff";e.style.setProperty(`--ball-${t+1}`,a)}}catch(t){}}const nt=[.5,.25,.12,.06,.03,.02,.01,.01];function at(){try{if(!Q||0===Q.length)return console.warn("No colors available, using fallback"),"#ffffff";const t=Math.random();let e=0;for(let n=0;n<Math.min(Q.length,nt.length);n++)if(e+=nt[n],t<=e)return Q[n];return Q[Math.min(Q.length-1,7)]}catch(t){return console.error("Error picking random color:",t),"#ffffff"}}let ot=255,it=274e3,st=4.4,lt=m,rt=m,ht=!1;const dt=1e3;let ct=0;const ut="#hero-text";let mt=[],ft=.025,xt=1.8,gt=0,yt=0,pt=0,vt=0,Mt=0;const bt=document.getElementById("render-fps"),Et=document.getElementById("physics-fps");class Ct{constructor(t,e,n,a){this.x=t,this.y=e,this.vx=200*(2*Math.random()-1),this.vy=200*-Math.random(),this.r=n,this.m=k,this.color=a,this.t=0,this.age=0,this.driftAx=0,this.driftTime=0,this.omega=0,this.squash=1,this.squashDirX=1,this.squashDirY=0,this.theta=0,this.squashAmount=0,this.squashNormalAngle=0}step(o){this.t+=o,this.age+=o,this.vy+=S*G*o;const i=Math.max(.25,this.m/1),h=Math.max(0,1-T/i);this.vx*=h,this.vy*=h,0!==this.driftAx&&this.age<this.driftTime?this.vx+=this.driftAx*o/i:0!==this.driftAx&&(this.driftAx=0),function(o,i){a!==t?a!==e?a===n&&function(t,e){if(!u.length)return;let n=-1,a=1/0;for(let e=0;e<u.length;e++){const o=u[e],i=o.x-t.x,s=o.y-t.y,l=i*i+s*s;l<a&&(a=l,n=e)}if(-1===n)return;const o=u[n],i=Math.sqrt(a)||1,l=(o.x-t.x)/i,r=(o.y-t.y)/i,h=.5*s/Math.max(160,i);t.vx+=h*l*e,t.vy+=h*r*e}(o,i):function(t,e){if(lt===m||rt===m)return;const n=lt-t.x,a=rt-t.y,o=n*n+a*a+1,i=Math.sqrt(o),h=n/(i||1),d=a/(i||1),c=s/Math.max(120,i)*e;t.vx+=c*h,t.vy+=c*d;const u=-d,f=h,x=Math.max(0,1-Math.min(1,Math.abs(i-l)/Math.max(l,1))),g=r*x*e*60;t.vx+=g*u,t.vy+=g*f}(o,i):function(t,e){if(!ht)return;if(it<=0||ot<=0)return;const n=ot*v,a=t.x-lt,o=t.y-rt,i=a*a+o*o;if(i>n*n)return;const s=Math.max(Math.sqrt(i),1e-4),l=a/s,r=o/s,h=Math.max(0,1-s/n),d=20*it*Math.pow(h,st),c=Math.max(.25,t.m/1);t.vx+=l*d*e/c,t.vy+=r*d*e/c}(o,i)}(this,o),this.x+=this.vx*o,this.y+=this.vy*o;const d=Math.max(0,1-2*o);this.omega*=d,this.theta+=this.omega*o,this.theta>Math.PI?this.theta-=2*Math.PI:this.theta<-Math.PI&&(this.theta+=2*Math.PI);const c=Math.min(1,18*o);this.squashAmount+=(0-this.squashAmount)*c,this.squash=1-this.squashAmount}walls(t,e,n){if(0===ct){if(this.y+this.r>e){this.y=e-this.r;const t=this.vy,a=this.vx-this.omega*this.r,o=Math.max(.25,this.m/1);this.omega+=a/this.r*f/o;const i=Math.max(0,1-1.5*n/o);this.vx*=i;const s=Math.abs(t)<70?0:L;this.vy=-this.vy*(s*Math.pow(1/this.m,O));const l=Math.min(1,Math.abs(t)/(90*this.r));this.squashAmount=Math.min(x,.8*l),this.squash=1-this.squashAmount,this.squashNormalAngle=-Math.PI/2;const r=this.vx/this.r;this.omega+=(r-this.omega)*Math.min(1,8*n)}if(this.vy>0&&this.y-this.r<0){this.y=this.r;const t=this.vy;this.vy=-this.vy*L;const e=Math.min(1,Math.abs(t)/(90*this.r));this.squashAmount=Math.min(x,.8*e),this.squash=1-this.squashAmount,this.squashNormalAngle=Math.PI/2}if(this.x+this.r>t){this.x=t-this.r;{const t=this.vy-this.omega*this.r,e=Math.max(.25,this.m/1);this.omega+=t/this.r*.125/e}this.vx=-this.vx*L;const e=Math.min(1,Math.abs(this.vx)/(90*this.r));this.squashAmount=Math.min(x,.8*e),this.squash=1-this.squashAmount,this.squashNormalAngle=Math.PI}if(this.x-this.r<0){this.x=this.r;{const t=this.vy-this.omega*this.r,e=Math.max(.25,this.m/1);this.omega+=t/this.r*.125/e}this.vx=-this.vx*L;const t=Math.min(1,Math.abs(this.vx)/(90*this.r));this.squashAmount=Math.min(x,.8*t),this.squash=1-this.squashAmount,this.squashNormalAngle=0}}else this.handleRoundedWallCollision(t,e);this.checkTextCollisions(n)}checkTextCollisions(t){for(let t=0;t<mt.length;t++){const e=mt[t],n=Math.max(e.x,Math.min(this.x,e.x+e.width)),a=Math.max(e.y,Math.min(this.y,e.y+e.height)),o=this.x-n,i=this.y-a,s=Math.sqrt(o*o+i*i);if(s<this.r)if(0===s){const t=this.x-e.x,n=e.x+e.width-this.x,a=this.y-e.y,o=e.y+e.height-this.y,i=Math.min(t,n,a,o);i===t?(this.x=e.x-this.r,this.vx=-Math.abs(this.vx)*L):i===n?(this.x=e.x+e.width+this.r,this.vx=Math.abs(this.vx)*L):i===a?(this.y=e.y-this.r,this.vy=-Math.abs(this.vy)*L):(this.y=e.y+e.height+this.r,this.vy=Math.abs(this.vy)*L)}else{const t=this.r-s,e=o/s,n=i/s;this.x+=e*t,this.y+=n*t;const a=this.vx*e+this.vy*n;if(a<0){this.vx-=2*a*e*L,this.vy-=2*a*n*L;const t=Math.min(1,Math.abs(a)/(70*this.r));this.squash=1-x*t,this.squashDirX=Math.abs(e)>Math.abs(n)?1:0,this.squashDirY=Math.abs(n)>Math.abs(e)?1:0}}}}handleRoundedWallCollision(t,e){const n=ct,a=[{x:n,y:n},{x:t-n,y:n},{x:t-n,y:e-n},{x:n,y:e-n}];for(let o=0;o<a.length;o++){const i=a[o],s=this.x-i.x,l=this.y-i.y,r=Math.sqrt(s*s+l*l);if(this.isInCornerRegion(i,t,e,n)&&r+this.r>n){const t=n-(r-this.r);if(t>0&&r>0){const e=s/r,n=l/r;this.x+=e*t,this.y+=n*t;const a=this.vx*e+this.vy*n;this.vx-=2*a*e*L,this.vy-=2*a*n*L;const o=Math.min(1,Math.abs(a)/(90*this.r));this.squashAmount=Math.min(x,.8*o),this.squash=1-this.squashAmount,this.squashNormalAngle=Math.atan2(n,e)}}}if(this.y+this.r>e&&(this.x<n||this.x>t-n)&&(this.y=e-this.r,this.vy=-this.vy*(L*Math.pow(1/this.m,O))),this.y-this.r<0&&(this.x<n||this.x>t-n)&&(this.y=this.r,this.vy=-this.vy*L),this.x+this.r>t&&(this.y<n||this.y>e-n)){this.x=t-this.r;{const t=this.vy-this.omega*this.r,e=Math.max(.25,this.m/1);this.omega+=t/this.r*.125/e}this.vx=-this.vx*(L*Math.pow(1/this.m,O));const e=Math.min(1,Math.abs(this.vx)/(70*this.r));this.squashAmount=Math.min(x,e),this.squash=1-this.squashAmount,this.squashNormalAngle=Math.PI}if(this.x-this.r<0&&(this.y<n||this.y>e-n)){this.x=this.r;{const t=this.vy-this.omega*this.r,e=Math.max(.25,this.m/1);this.omega+=t/this.r*.125/e}this.vx=-this.vx*(L*Math.pow(1/this.m,O));const t=Math.min(1,Math.abs(this.vx)/(70*this.r));this.squashAmount=Math.min(x,t),this.squash=1-this.squashAmount,this.squashNormalAngle=0}this.y+this.r>e&&this.x>=n&&this.x<=t-n&&(this.y=e-this.r,this.vy=-this.vy*(L*Math.pow(1/this.m,O))),this.y-this.r<0&&this.x>=n&&this.x<=t-n&&(this.y=this.r,this.vy=-this.vy*(L*Math.pow(1/this.m,O))),this.x+this.r>t&&this.y>=n&&this.y<=e-n&&(this.x=t-this.r,this.vx=-this.vx*(L*Math.pow(1/this.m,O))),this.x-this.r<0&&this.y>=n&&this.y<=e-n&&(this.x=this.r,this.vx=-this.vx*(L*Math.pow(1/this.m,O)))}isInCornerRegion(t,e,n,a){return t.x===a&&t.y===a?this.x<=a&&this.y<=a:t.x===e-a&&t.y===a?this.x>=e-a&&this.y<=a:t.x===e-a&&t.y===n-a?this.x>=e-a&&this.y>=n-a:t.x===a&&t.y===n-a&&this.x<=a&&this.y>=n-a}draw(t){t.save(),t.translate(this.x,this.y);const e=Math.min(x,Math.max(0,this.squashAmount));if(e>.001){const n=1+e,a=1/n;t.rotate(this.squashNormalAngle),t.scale(n,a),t.rotate(-this.squashNormalAngle)}t.beginPath(),t.arc(0,0,this.r,0,2*Math.PI),t.fillStyle=this.color,t.fill(),t.restore()}}const It=[];function wt(t,e,n){return Math.max(e,Math.min(n,t))}function Bt(t,e){return t+Math.random()*(e-t)}function St(t,e,n=at()){const a=(H+_)/2;let o;if(0===N)o=a;else{const t=(_-H)/2*N;o=Bt(Math.max(1,a-t),a+t)}const i=new Ct(t,e,o,n),s=.5*g.width,l=Y?$>=0?1:-1:t<s?1:-1,r=wt(o/(.5*(H+_)),.6,1.4),h=140*r,d=180*r;return i.vx=l*(h+Math.random()*d),i.vy=120*-Math.random(),i.driftAx=l*(360+420*Math.random())*r,i.driftTime=.22+.28*Math.random(),It.push(i),i}let Lt=0;function Tt(){const t=g.clientWidth,e=g.clientHeight,n=wt(E/100*t,0,t);let a=wt(M/100*t,0,t);if(Y){const e=.2*t,n=a;a=wt(a+Math.sin(X)*e,0,t),$=a>=n?1:-1}const o=Math.min(40,.1*n),i=wt(a-n/2-o,-o,t),s=wt(a+n/2+o,-o,t),l=b/100*e,r=l+C/100*e,h=Math.random();return{x:(i+(s-i)*($>0?Math.pow(h,.7):1-Math.pow(1-h,.7)))*v,y:Bt(l*v,r*v)-(_+2+Bt(0,10*v))}}const qt=new Map;function At(t=6){const e=function(){const t=It.length;if(t<2)return[];const e=Math.max(1,2*_),n=Math.ceil(g.width/e)+1;qt.clear();for(let a=0;a<t;a++){const t=It[a],o=t.x/e|0,i=(t.y/e|0)*n+o;let s=qt.get(i);s||(s=[],qt.set(i,s)),s.push(a)}const a=[];for(const[t,e]of qt){const o=t/n|0,i=t%n;for(let t=-1;t<=1;t++)for(let s=-1;s<=1;s++){const l=(o+t)*n+(i+s),r=qt.get(l);if(r)for(let t=0;t<e.length;t++){const n=e[t];for(let t=0;t<r.length;t++){const e=r[t];if(e<=n)continue;const o=It[n],i=It[e],s=i.x-o.x,l=i.y-o.y,h=o.r+i.r,d=s*s+l*l;if(d<h*h){const t=h-Math.sqrt(Math.max(d,1e-6));a.push({i:n,j:e,overlap:t})}}}}}return a.sort((t,e)=>e.overlap-t.overlap),a}();for(let n=0;n<t;n++)for(let t=0;t<e.length;t++){const{i:n,j:a}=e[t],o=It[n],i=It[a],s=i.x-o.x,l=i.y-o.y,r=o.r+i.r,h=s*s+l*l;if(0===h||h>r*r)continue;const d=Math.sqrt(h),c=s/d,u=l/d,m=r-d,f=1/Math.max(o.m,.001),g=1/Math.max(i.m,.001),y=.8*Math.max(m-R,0)/(f+g),p=y*c,v=y*u;o.x-=p*f,o.y-=v*f,i.x+=p*g,i.y+=v*g;const M=i.vx-o.vx,b=i.vy-o.vy,E=M*c+b*u;if(E<0){const t=-(1+(Math.abs(E)<30?0:L))*E/(f+g),e=t*c,n=t*u;o.vx-=e*f,o.vy-=n*f,i.vx+=e*g,i.vy+=n*g;const a=M-E*c,s=b-E*u,l=Math.hypot(a,s);if(l>.001){const t=a*-u+s*c>=0?1:-1,e=.18;o.omega-=t*e*l/Math.max(o.r,1),i.omega+=t*e*l/Math.max(i.r,1)}const r=Math.min(1,Math.abs(E)/(50*(o.r+i.r))),h=Math.min(x,.8*r);o.squashAmount=Math.max(o.squashAmount,.8*h),o.squashNormalAngle=Math.atan2(-u,-c),i.squashAmount=Math.max(i.squashAmount,.8*h),i.squashNormalAngle=Math.atan2(u,c)}}}let Rt=performance.now()/1e3,Ft=0;const Vt=1/120;console.log("High refresh mode enabled - using requestAnimationFrame"),requestAnimationFrame(function t(e){const o=e/1e3;let i=Math.min(.008,o-Rt);Rt=o,Ft+=i,gt++,(bt||Et)&&o-pt>=1&&(bt&&gt!==vt&&(vt=gt,bt.textContent=vt.toString()),Et&&yt!==Mt&&(Mt=yt,Et.textContent=Mt.toString()),gt=0,yt=0,pt=o),function(t){for(Lt+=t;Lt>=q;){const t=(Math.random()-.5)*q*.5;Lt-=q+t,X+=2*Math.PI*.12*(q+t);const e=Tt(),n=Math.random()<.35?3:1;for(let t=0;t<n;t++)if(It.length<A){const n=8*t*(Math.random()<.5?1:-1);St(e.x+n,e.y-12*t)}}}(i),gt%60==0&&j();let s=0;for(;Ft>=Vt&&s<2;){for(let t=0;t<It.length;t++)It[t].step(Vt);At(3);for(let t=0;t<It.length;t++)It[t].walls(g.width,g.height,Vt);Ft-=Vt,s++,yt++}if(Ft>3*Vt&&(Ft=0),ft>0&&xt>0){const t=1.5,e=3,n=.35;let a=1+(n+(.0015-n)*Math.max(0,Math.min(1,ft/t))-1)*Math.max(0,Math.min(1,xt/e));a=Math.max(.001,Math.min(1,a)),y.fillStyle=`rgba(0,0,0,${a})`,y.globalCompositeOperation="destination-out",y.fillRect(0,0,g.width,g.height),y.globalCompositeOperation="source-over"}else y.clearRect(0,0,g.width,g.height);ct>0&&function(t,e,n){const a=ct;t.strokeStyle="rgba(255, 255, 255, 0.1)",t.lineWidth=2,t.beginPath(),t.moveTo(a,0),t.lineTo(e-a,0),t.arcTo(e,0,e,a,a),t.lineTo(e,n-a),t.arcTo(e,n,e-a,n,a),t.lineTo(a,n),t.arcTo(0,n,0,n-a,a),t.lineTo(0,a),t.arcTo(0,0,a,0,a),t.closePath(),t.stroke()}(y,g.width,g.height);for(let t=0;t<It.length;t++)It[t].draw(y);!function(t){if(lt===m||rt===m)return;if(a===n&&u.length>1){const e=(H+_)/2;for(let n=0;n<u.length;n++){const a=n/u.length*.6;t.beginPath(),t.arc(u[n].x,u[n].y,.8*e,0,2*Math.PI),t.fillStyle=tt.replace("rgb","rgba").replace(")",`, ${a})`),t.fill()}}const e=lt,o=rt,i=(H+_)/2,s=tt;t.beginPath(),t.arc(e,o,i,0,2*Math.PI),t.fillStyle=s,t.fill()}(y),requestAnimationFrame(t)}),window.addEventListener("keydown",a=>{const o=a.key.toLowerCase();"r"===o&&(function(){for(let t=0;t<It.length;t++){const e=It[t],n=Tt();e.x=n.x,e.y=n.y;const a=.5*g.width,o=Y?$>=0?1:-1:e.x<a?1:-1,i=wt(e.r/(.5*(H+_)),.6,1.4),s=140*i,l=180*i,r=120;e.vx=o*(s+Math.random()*l),e.vy=-Math.random()*r,e.age=0,e.driftAx=o*(360+420*Math.random())*i,e.driftTime=.22+.28*Math.random()}}(),a.preventDefault()),"/"===o&&p&&(a.preventDefault(),p.classList.toggle("hidden")),"1"===o&&sn(t),"2"===o&&sn(e),"3"===o&&sn(n)}),function(t=160){for(let e=0;e<t&&It.length<A;e++){const t=Tt();St(t.x,t.y)}}(200);let Pt=0;g.addEventListener("mousemove",e=>{const o=g.getBoundingClientRect();if(lt=(e.clientX-o.left)*v,rt=(e.clientY-o.top)*v,a===t&&it>0&&ot>0&&(ht=!0),a===n){const t=performance.now();if(!u.length||t-Pt>100)u.push({x:lt,y:rt}),u.length>h&&u.shift(),Pt=t;else{const e=u[u.length-1],n=lt-e.x,a=rt-e.y;n*n+a*a>d*v*(d*v)&&(u.push({x:lt,y:rt}),u.length>h&&u.shift(),Pt=t)}}}),g.addEventListener("mouseleave",()=>{lt=m,rt=m,a===n&&(u=[])});const Nt=document.getElementById("restitutionSlider"),Ut=document.getElementById("frictionSlider"),zt=document.getElementById("emitterSlider"),kt=document.getElementById("sizeSlider"),Ot=document.getElementById("maxBallsSlider"),Gt=document.getElementById("sizeVariationSlider"),Wt=document.getElementById("weightSlider"),Ht=document.getElementById("spawnYSlider"),_t=document.getElementById("spawnWidthSlider"),Dt=document.getElementById("spawnCenterSlider"),jt=document.getElementById("spawnHeightSlider"),Yt=document.getElementById("repelSizeSlider"),Xt=document.getElementById("repelPowerSlider"),$t=document.getElementById("repelSoftSlider"),Jt=document.getElementById("colorSelect"),Kt=document.getElementById("color1"),Qt=document.getElementById("color2"),Zt=document.getElementById("color3"),te=document.getElementById("color4"),ee=document.getElementById("color5"),ne=document.getElementById("color6"),ae=document.getElementById("color7"),oe=document.getElementById("color8"),ie=document.getElementById("cursorColorSelect"),se=document.getElementById("color1Val"),le=document.getElementById("color2Val"),re=document.getElementById("color3Val"),he=document.getElementById("color4Val"),de=document.getElementById("color5Val"),ce=document.getElementById("color6Val"),ue=document.getElementById("color7Val"),me=document.getElementById("color8Val");[se,le,re,he,de,ce,ue,me].forEach(t=>{t&&t.setAttribute("title","Click to copy")});const fe=document.getElementById("cornerRadiusSlider"),xe=document.getElementById("cornerRadiusVal"),ge=document.getElementById("trailFadeSlider"),ye=document.getElementById("trailFadeVal"),pe=document.getElementById("trailSubtletySlider"),ve=document.getElementById("trailSubtletyVal"),Me=document.getElementById("restitutionVal"),be=document.getElementById("frictionVal"),Ee=document.getElementById("emitterVal"),Ce=document.getElementById("sizeVal"),Ie=document.getElementById("maxBallsVal"),we=document.getElementById("sizeVariationVal"),Be=document.getElementById("weightVal"),Se=document.getElementById("spawnYVal"),Le=document.getElementById("spawnWidthVal"),Te=document.getElementById("spawnCenterVal"),qe=document.getElementById("spawnHeightVal"),Ae=document.getElementById("repelSizeVal"),Re=document.getElementById("repelPowerVal"),Fe=document.getElementById("repelSoftVal");function Ve(){return{gravityMultiplier:B,restitution:L,friction:T,ballMass:k,emitRate:q,maxBalls:A,ballScale:P,ballVariation:N,spawnX:M,spawnY:b,spawnWidth:E,spawnHeight:C,sweepEnabled:Y,repelRadius:ot,repelPower:it,repelSoftness:st,trailFade:ft,trailSubtlety:xt,colors:Q.slice(),colorWeights:nt.slice(),currentTemplate:K,cursorColorIndex:Z}}const Pe=document.getElementById("saveConfigBtn"),Ne=document.getElementById("buildBtn"),Ue=document.getElementById("configOutput");function ze(t,e){t&&t.addEventListener("click",async()=>{const n="function"==typeof e?e():String(e||"").trim();try{await navigator.clipboard.writeText(n);const e=t.textContent;t.textContent="COPIED",t.style.color="#3ddc84",setTimeout(()=>{t.textContent=e,t.style.color="#888"},900)}catch(t){console.warn("Clipboard unavailable")}})}function ke(){const t=(H+_)/2;for(let e=0;e<It.length;e++){const n=It[e];if(0===N)n.r=t;else{const e=(_-H)/2*N,a=Math.max(1,t-e),o=t+e;n.r=Bt(a,o)}n.m=k}}Pe&&Ne&&Ue&&(Pe.addEventListener("click",()=>{const t=(e=Ve(),`// Generated configuration from frontend\nconst CONFIG = ${JSON.stringify(e,null,2)};`);var e;Ue.style.display="block",Ue.textContent=t,navigator.clipboard.writeText(t).then(()=>{const t=Pe.textContent;Pe.textContent="✅ Copied!",setTimeout(()=>{Pe.textContent=t},1200)}).catch(()=>{console.warn("Clipboard copy failed");const t=Pe.textContent;Pe.textContent="⚠️ Copy failed",setTimeout(()=>{Pe.textContent=t},1200)})}),Ne.addEventListener("click",()=>{const t=Ve();Ue.style.display="block",Ue.innerHTML="\n<strong>🚀 Build Instructions:</strong><br>\n1. Run: <code>npm run build</code><br>\n2. Your current config will be baked into <code>public/js/bouncy-balls-embed.js</code>";const e=new Blob([JSON.stringify(t,null,2)],{type:"application/json"}),n=URL.createObjectURL(e),a=document.createElement("a");a.href=n,a.download="current-config.json",a.click(),URL.revokeObjectURL(n)})),Nt&&Nt.addEventListener("input",()=>{L=parseFloat(Nt.value),Me&&(Me.textContent=L.toFixed(2))}),Ut&&Ut.addEventListener("input",()=>{T=parseFloat(Ut.value),be&&(be.textContent=T.toFixed(4))}),zt&&zt.addEventListener("input",()=>{q=parseFloat(zt.value),Ee&&(Ee.textContent=q.toFixed(3))}),kt&&kt.addEventListener("input",()=>{const t=parseFloat(kt.value);Ce&&(Ce.textContent=t.toFixed(1)),P=t,D();for(let t=0;t<It.length;t++)It[t].m=k}),Ot&&Ot.addEventListener("input",()=>{A=parseInt(Ot.value,10),Ie&&(Ie.textContent=A.toString()),It.length>A&&(It.length=A)}),Gt&&Gt.addEventListener("input",()=>{N=parseFloat(Gt.value),we&&(we.textContent=N.toFixed(1)),ke()}),Wt&&Wt.addEventListener("input",()=>{k=parseFloat(Wt.value),Be&&(Be.textContent=k.toFixed(2));for(let t=0;t<It.length;t++)It[t].m=k;W()}),Ht&&Ht.addEventListener("input",()=>{b=parseFloat(Ht.value),Se&&(Se.textContent=b.toFixed(0)),I()}),_t&&_t.addEventListener("input",()=>{E=parseFloat(_t.value),Le&&(Le.textContent=E.toFixed(0))}),Dt&&Dt.addEventListener("input",()=>{M=parseFloat(Dt.value),Te&&(Te.textContent=M.toFixed(0))}),jt&&jt.addEventListener("input",()=>{C=parseFloat(jt.value),qe&&(qe.textContent=C.toFixed(0))}),Yt&&Yt.addEventListener("input",()=>{ot=parseFloat(Yt.value),Ae&&(Ae.textContent=ot.toFixed(0)),ht=ht||it>0&&ot>0}),Xt&&Xt.addEventListener("input",()=>{it=function(t){const e=Math.max(0,Math.min(dt,Number(t)))/dt;return 2*Math.pow(2,12*(e-.5))*12e3}(Xt.value),Re&&(Re.textContent=Math.round(it).toString()),fn&&"off"!==fn.value&&(ht=it>0&&ot>0)}),$t&&$t.addEventListener("input",()=>{st=parseFloat($t.value),Fe&&(Fe.textContent=st.toFixed(1))}),Jt&&Jt.addEventListener("change",()=>{const t=J[Jt.value];t&&(K=Jt.value,Q=t.colors.slice(),tt=Q[Z]||tt,Kt&&se&&(Kt.value=Q[0],se.textContent=Q[0].toUpperCase()),Qt&&le&&(Qt.value=Q[1],le.textContent=Q[1].toUpperCase()),Zt&&re&&(Zt.value=Q[2],re.textContent=Q[2].toUpperCase()),te&&he&&(te.value=Q[3],he.textContent=Q[3].toUpperCase()),ee&&de&&(ee.value=Q[4],de.textContent=Q[4].toUpperCase()),ne&&ce&&(ne.value=Q[5],ce.textContent=Q[5].toUpperCase()),ae&&ue&&(ae.value=Q[6],ue.textContent=Q[6].toUpperCase()),oe&&me&&(oe.value=Q[7],me.textContent=Q[7].toUpperCase()),ln(),et())});const Oe=Array.from(document.querySelectorAll(".mode-button")),Ge=document.getElementById("pitControls"),We=document.getElementById("fliesControls"),He=document.getElementById("trailControls"),_e=document.getElementById("gravityPitSlider"),De=document.getElementById("gravityPitVal"),je=document.getElementById("repellerEnabledPit"),Ye=document.getElementById("attractPowerSlider"),Xe=document.getElementById("attractPowerVal"),$e=document.getElementById("orbitRadiusSlider"),Je=document.getElementById("orbitRadiusVal"),Ke=document.getElementById("swarmSpeedSlider"),Qe=document.getElementById("swarmSpeedVal"),Ze=document.getElementById("trailLengthSlider"),tn=document.getElementById("trailLengthVal"),en=document.getElementById("particleSpacingSlider"),nn=document.getElementById("particleSpacingVal"),an=document.getElementById("fadeSpeedSlider"),on=document.getElementById("fadeSpeedVal");function sn(s){a=s,a===t?(B=o,S=w*B,ht=i&&it>0&&ot>0,Y=!0):a===e?(B=0,S=w*B,ht=!1,Y=!1):a===n&&(B=0,S=w*B,ht=!1,Y=!1,u=[]),Ge&&Ge.classList.toggle("active",a===t),We&&We.classList.toggle("active",a===e),He&&He.classList.toggle("active",a===n),Oe.forEach(t=>t.classList.toggle("active",t.getAttribute("data-mode")===a))}function ln(){for(let t=0;t<It.length;t++)It[t].color=at()}Oe.forEach(t=>t.addEventListener("click",()=>sn(t.getAttribute("data-mode")))),_e&&_e.addEventListener("input",()=>{o=parseFloat(_e.value),De&&(De.textContent=o.toFixed(1)),a===t&&(B=o,S=w*B)}),je&&je.addEventListener("change",()=>{i=!!je.checked,a===t&&(ht=i&&it>0&&ot>0)}),Ye&&Ye.addEventListener("input",()=>{s=parseFloat(Ye.value),Xe&&(Xe.textContent=Math.round(s).toString())}),$e&&$e.addEventListener("input",()=>{l=parseFloat($e.value),Je&&(Je.textContent=Math.round(l).toString())}),Ke&&Ke.addEventListener("input",()=>{r=parseFloat(Ke.value),Qe&&(Qe.textContent=r.toFixed(1))}),Ze&&Ze.addEventListener("input",()=>{h=parseInt(Ze.value,10),tn&&(tn.textContent=h.toString()),u.length>h&&(u.length=h)}),en&&en.addEventListener("input",()=>{d=parseInt(en.value,10),nn&&(nn.textContent=d.toString())}),an&&an.addEventListener("input",()=>{c=parseFloat(an.value),on&&(on.textContent=c.toFixed(2))}),Kt&&Kt.addEventListener("input",()=>{Q[0]=Kt.value,se&&(se.textContent=Kt.value.toUpperCase()),ln(),et()}),Qt&&Qt.addEventListener("input",()=>{Q[1]=Qt.value,le&&(le.textContent=Qt.value.toUpperCase()),ln(),et()}),Zt&&Zt.addEventListener("input",()=>{Q[2]=Zt.value,re&&(re.textContent=Zt.value.toUpperCase()),ln(),et()}),te&&te.addEventListener("input",()=>{Q[3]=te.value,he&&(he.textContent=te.value.toUpperCase()),ln(),et()}),ee&&ee.addEventListener("input",()=>{Q[4]=ee.value,de&&(de.textContent=ee.value.toUpperCase()),ln(),et()}),ne&&ne.addEventListener("input",()=>{Q[5]=ne.value,ce&&(ce.textContent=ne.value.toUpperCase()),ln(),et()}),ae&&ae.addEventListener("input",()=>{Q[6]=ae.value,ue&&(ue.textContent=ae.value.toUpperCase()),ln(),et()}),oe&&oe.addEventListener("input",()=>{Q[7]=oe.value,me&&(me.textContent=oe.value.toUpperCase()),ln(),et()}),ie&&ie.addEventListener("change",()=>{const t=Math.max(1,Math.min(8,parseInt(ie.value,10)))-1;Z=t,tt=Q[Z]||tt}),ze(se,()=>Kt.value.toUpperCase()),ze(le,()=>Qt.value.toUpperCase()),ze(re,()=>Zt.value.toUpperCase()),ze(he,()=>te.value.toUpperCase()),ze(de,()=>ee.value.toUpperCase()),ze(ce,()=>ne.value.toUpperCase()),ze(ue,()=>ae.value.toUpperCase()),ze(me,()=>oe.value.toUpperCase()),fe&&fe.addEventListener("input",()=>{ct=parseFloat(fe.value),xe&&(xe.textContent=ct.toFixed(0))}),ge&&ge.addEventListener("input",()=>{ft=parseFloat(ge.value),ye&&(ye.textContent=ft.toFixed(3))}),pe&&pe.addEventListener("input",()=>{xt=parseFloat(pe.value),ve&&(ve.textContent=xt.toFixed(2)+"×")});const rn={rubberPlayground:{label:"Rubber – Playground",G:1960,REST:.9,FRICTION:.0025,sizeScale:1.8,maxBalls:450,sizeVariation:.2},rubberRacquet:{label:"Rubber – Racquetball",G:3320,REST:.97,FRICTION:.0035,sizeScale:2.1,maxBalls:350,sizeVariation:.3},rubberSuperball:{label:"Rubber – Superball",G:1960,REST:.95,FRICTION:.0015,sizeScale:1.2,maxBalls:450,sizeVariation:.05},rubberSoft:{label:"Rubber – Soft",G:1960,REST:.86,FRICTION:.0035,sizeScale:2.2,maxBalls:350,sizeVariation:.25},rubberHeavy:{label:"Rubber – Heavy",G:1960,REST:.88,FRICTION:.003,sizeScale:2,maxBalls:400,sizeVariation:.15}},hn={fullRain:{label:"Full Rain (top-half)",EMIT_INTERVAL:.03,xCenter:50,y:-50,w:100,h:50},narrowStrip:{label:"Narrow Strip Top",EMIT_INTERVAL:.05,xCenter:50,y:-40,w:20,h:10},leftGutter:{label:"Left Gutter",EMIT_INTERVAL:.045,xCenter:10,y:-60,w:18,h:20},rightGutter:{label:"Right Gutter",EMIT_INTERVAL:.045,xCenter:90,y:-60,w:18,h:20},centerFountain:{label:"Center Fountain",EMIT_INTERVAL:.02,xCenter:50,y:-30,w:30,h:20},stormBurst:{label:"Storm Burst",EMIT_INTERVAL:.005,xCenter:50,y:-80,w:100,h:30},slowSnow:{label:"Slow Snow",EMIT_INTERVAL:.2,xCenter:50,y:-30,w:100,h:20},edgeDrizzle:{label:"Edge Drizzle",EMIT_INTERVAL:.08,xCenter:15,y:-40,w:30,h:15},twinColumns:{label:"Twin Columns",EMIT_INTERVAL:.03,xCenter:30,y:-50,w:10,h:40},focusedBeam:{label:"Focused Beam",EMIT_INTERVAL:.015,xCenter:50,y:-70,w:6,h:12}},dn={off:{label:"Off",r:710,p:274e3,s:4.4},gentle:{label:"Gentle Breeze",r:120,p:2500,s:2.5},pushField:{label:"Push Field",r:240,p:8e4,s:2},tractor:{label:"Tractor Push",r:320,p:14e4,s:1.6},magnet:{label:"Magnet Repel",r:200,p:18e4,s:3},pulse:{label:"Pulse Strong",r:280,p:22e4,s:1.2},wideSoft:{label:"Wide Soft",r:500,p:8e4,s:4.5},needle:{label:"Needle Point",r:80,p:26e4,s:.8},wall:{label:"Invisible Wall",r:700,p:16e4,s:5},singularity:{label:"Singularity",r:600,p:3e5,s:.5}};function cn(t,e,n){t.innerHTML="";for(const[a,o]of Object.entries(e)){const e=document.createElement("option");e.value=a,e.textContent=o.label||a,a===n&&(e.selected=!0),t.appendChild(e)}}const un=document.getElementById("physicsSelect"),mn=document.getElementById("spawnSelect"),fn=document.getElementById("repellerSelect");function xn(t,e,n,a=0){t&&(t.value=String(n)),e&&(e.textContent=a>0?n.toFixed(a):n.toString())}function gn(t){const e=rn[t];if(!e)return;L=e.REST,T=e.FRICTION,A=e.maxBalls,N=e.sizeVariation;const n=e.sizeScale;P=n,D();for(let t=0;t<It.length;t++)It[t].m=k;It.length>A&&(It.length=A),xn(Nt,Me,L,2),xn(Ut,be,T,4),xn(kt,Ce,P,1),xn(Ot,Ie,A,0),xn(Gt,we,N,1),ke()}function yn(t){const e=hn[t];e&&(q=e.EMIT_INTERVAL,M=e.xCenter,b=e.y,E=e.w,C=e.h,xn(zt,Ee,q,3),xn(Dt,Te,M,0),xn(Ht,Se,b,0),xn(_t,Le,E,0),xn(jt,qe,C,0))}function pn(t){const e=dn[t];if(!e)return;ot=e.r,it=1*e.p,ht="off"!==t,xn(Yt,Ae,ot,0);const n=function(t){const e=Math.max(1,Number(t))/24e3,n=.5+Math.log2(e)/12;return Math.round(Math.max(0,Math.min(1,n))*dt)}(it);Xt&&(Xt.value=String(n)),Re&&(Re.textContent=Math.round(it).toString()),xn($t,Fe,st,1)}un&&cn(un,rn,"rubberRacquet"),mn&&cn(mn,hn,"fullRain"),fn&&cn(fn,dn,"off"),Jt&&cn(Jt,J,"industrialTeal"),gn("rubberRacquet"),yn("fullRain"),pn("off");const vn=J[K];Kt&&se&&(Kt.value=vn.colors[0],se.textContent=vn.colors[0].toUpperCase()),Qt&&le&&(Qt.value=vn.colors[1],le.textContent=vn.colors[1].toUpperCase()),Zt&&re&&(Zt.value=vn.colors[2],re.textContent=vn.colors[2].toUpperCase()),te&&he&&(te.value=vn.colors[3],he.textContent=vn.colors[3].toUpperCase()),ee&&de&&(ee.value=vn.colors[4],de.textContent=vn.colors[4].toUpperCase()),ne&&ce&&(ne.value=vn.colors[5],ce.textContent=vn.colors[5].toUpperCase()),ae&&ue&&(ae.value=vn.colors[6],ue.textContent=vn.colors[6].toUpperCase()),oe&&me&&(oe.value=vn.colors[7],me.textContent=vn.colors[7].toUpperCase()),et(vn.colors),un&&un.addEventListener("change",()=>gn(un.value)),mn&&mn.addEventListener("change",()=>yn(mn.value)),fn&&fn.addEventListener("change",()=>pn(fn.value)),D(),j(),sn(t)})();