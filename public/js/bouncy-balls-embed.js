(()=>{const t="pit",e="flies",n="trail",i="weightless",a="boulders",o={[t]:{desktop:!0,mobile:!0},[e]:{desktop:!0,mobile:!0},[n]:{desktop:!0,mobile:!1},[i]:{desktop:!0,mobile:!0},[a]:{desktop:!0,mobile:!0}};let s=t,l=40,r=1.1,h=!0,d=1e3,c=150,u=1,m=[],f=120,g=12,p=.025,y=80,x=200,v=.98,M=300,E=150,b=.8,I=1.5,S=.4;const C=-1e9,w=1e-4,B=.25;function V(){return 0===l?0:l/40*.2}const L=document.getElementById("c"),R=L.getContext("2d",{alpha:!0}),F=document.getElementById("controlPanel"),T=Math.max(1,Math.min(2,window.devicePixelRatio||1));let P=50,q=-50,A=100,k=50;function z(){const t=1.5*window.innerHeight;L.width=Math.floor(window.innerWidth*T),L.height=Math.floor(t*T)}z(),window.addEventListener("resize",()=>{z(),at(),ot()});const N=1960;let U=1.1,G=N*U,D=.88,O=.003,W=.03,H=400;const _=.5*T,$=6,j=24;let Y=1,Z=.15,J=1,K=null,X=11.2;const Q=.15;let tt=1;function et(){tt=Math.max(.5,Math.min(3,Math.pow(X/1,.35)))}et();let nt=$*Y,it=j*Y;function at(){J=(L.clientWidth||window.innerWidth)<=768?.4:1;const t=Y*J;if(null===K)return K=t,nt=$*t,void(it=j*t);const e=t/K;if(1!==e){for(let t=0;t<Dt.length;t++)s!==a&&(Dt[t].r*=e);K=t}nt=$*t,it=j*t}function ot(){Rt=[];const t=document.querySelector(Lt);if(!t)return;const e=t.getBoundingClientRect(),n=L.getBoundingClientRect(),i=function(t){const e=document.createElement("span");e.style.cssText=window.getComputedStyle(t).cssText,e.style.position="absolute",e.style.visibility="hidden",e.style.whiteSpace="nowrap",e.textContent="ABCDEFGHIJKLMNOPQRSTUVWXYZ",document.body.appendChild(e);const n=e.getBoundingClientRect().height;return document.body.removeChild(e),n}(t),a=.5*(e.height-i),o={x:(e.left-n.left)*T,y:(e.top-n.top+a)*T,width:e.width*T,height:i*T};o.width>0&&o.height>0&&o.x<L.width&&o.y<L.height&&o.x+o.width>0&&o.y+o.height>0&&Rt.push(o)}let st=!0,lt=0,rt=1;const ht={industrialTeal:{label:"Industrial Teal",colors:["#b7bcb7","#e4e9e4","#ffffff","#00695c","#000000","#ff4013","#0d5cb6","#ffa000"]},modern:{label:"Modern European",colors:["#9ca3af","#d1d5db","#ffffff","#ff3b30","#000000","#00e5ff","#1976d2","#ffc107"]},corporate:{label:"Corporate Modern",colors:["#a0a8b1","#d2d8de","#ffffff","#1a73e8","#000000","#ff5722","#7b1fa2","#ffa000"]},minimal:{label:"Helvetica Minimal",colors:["#bdbdbd","#e0e0e0","#ffffff","#6b7280","#000000","#40e0d0","#303f9f","#ff9800"]},euroBlue:{label:"European Blue",colors:["#9aa6b2","#d4dde5","#ffffff","#0a66c2","#000000","#ff4081","#388e3c","#ffb300"]},scandi:{label:"Scandinavian Bright",colors:["#aab2b7","#e6eaee","#ffffff","#74b9ff","#000000","#e91e63","#1976d2","#4caf50"]},neonCyan:{label:"Graphite Neon Cyan",colors:["#9aa0a6","#d5d9dd","#ffffff","#00e5ff","#000000","#ff9800","#9c27b0","#4caf50"]},coralTech:{label:"Coral Tech",colors:["#9da3a9","#d8dde2","#ffffff","#ff6b6b","#000000","#00e676","#3f51b5","#ff5722"]},violetMidnight:{label:"Violet Midnight",colors:["#9fa3b1","#d9dce3","#ffffff","#7c3aed","#000000","#e91e63","#388e3c","#ffb300"]},mintSage:{label:"Mint Sage",colors:["#a0a7a2","#dbe0dd","#ffffff","#00c896","#000000","#ff1744","#3f51b5","#ff9800"]},slateAzure:{label:"Slate Azure",colors:["#9aa3ad","#d8dee6","#ffffff","#3b82f6","#000000","#ff4081","#388e3c","#ffc107"]},vaporPop:{label:"Vapor Pop",colors:["#9ea0a8","#d6d7dc","#ffffff","#ff00e5","#000000","#00bcd4","#673ab7","#ff5722"]},cyberMagenta:{label:"Cyber Magenta",colors:["#9c9fad","#d6d9e3","#ffffff","#ff007a","#000000","#40e0d0","#1976d2","#ff9800"]},streetLime:{label:"Street Lime",colors:["#9aa19a","#d6dbd6","#ffffff","#baff00","#000000","#e91e63","#3f51b5","#ff6f00"]},cmykPop:{label:"CMYK Pop",colors:["#9f9f9f","#d9d9d9","#ffffff","#ffd400","#000000","#ff1744","#7b1fa2","#4caf50"]}};let dt="industrialTeal",ct=["#b7bcb7","#e4e9e4","#ffffff","#00695c","#000000","#ff4013","#0d5cb6","#ffa000"],ut=5,mt=ct[ut]||"#ff4013";function ft(t=ct){try{const e=document.documentElement,n=(t&&t.length?t:ct).slice(0,8);for(let t=0;t<8;t++){const i=n[t]||"#ffffff";e.style.setProperty(`--ball-${t+1}`,i)}}catch(t){}}const gt=[.5,.25,.12,.06,.03,.02,.01,.01];function pt(){try{if(!ct||0===ct.length)return console.warn("No colors available, using fallback"),"#ffffff";const t=Math.random();let e=0;for(let n=0;n<Math.min(ct.length,gt.length);n++)if(e+=gt[n],t<=e)return ct[n];return ct[Math.min(ct.length-1,7)]}catch(t){return console.error("Error picking random color:",t),"#ffffff"}}let yt=255,xt=274e3,vt=4.4,Mt=C,Et=C,bt=!1,It=!1;("ontouchstart"in window||navigator.maxTouchPoints>0)&&(It=!0);const St="bouncyBallsSettings";function Ct(){const t={currentMode:s,gravityMultiplierPit:r,repellerEnabledPit:h,attractionPower:d,orbitRadius:c,swarmSpeed:u,sparkleEmissionRate:sparkleEmissionRate,sparkleLifetime:sparkleLifetime,sparkleVelocitySpread:sparkleVelocitySpread,sparkleDriftStrength:sparkleDriftStrength,sparkleParticleScale:sparkleParticleScale,weightlessInitialSpeed:x,weightlessBounce:v,weightlessMaxBalls:weightlessMaxBalls,weightlessRepellerPower:M,weightlessRepellerRadius:E,restitution:D,friction:O,sizeScale:Y,sizeVariation:Z,ballMassKg:X,ballSoftness:l,repelPower:xt,repelRadius:yt,repelSoft:vt,cornerRadius:Vt,motionBlur:p,trailSubtlety:Tt,currentTemplate:dt,cursorBallColor:mt};try{localStorage.setItem(St,JSON.stringify(t)),console.log("âœ“ Settings saved")}catch(t){console.warn("Could not save settings:",t)}}function wt(){clearTimeout(window.settingsSaveTimeout),window.settingsSaveTimeout=setTimeout(Ct,500)}const Bt=1e3;let Vt=0;const Lt="#hero-text";let Rt=[],Ft=.025,Tt=1.8,Pt=0,qt=0,At=0,kt=0,zt=0;const Nt=document.getElementById("render-fps"),Ut=document.getElementById("physics-fps");class Gt{constructor(t,e,n,i){this.x=t,this.y=e,this.vx=200*(2*Math.random()-1),this.vy=200*-Math.random(),this.r=n,this.rBase=n,this.m=X,this.color=i,this.t=0,this.age=0,this.driftAx=0,this.driftTime=0,this.omega=0,this.squash=1,this.squashDirX=1,this.squashDirY=0,this.theta=0,this.squashAmount=0,this.squashNormalAngle=0,this.alpha=1}step(a){this.t+=a,this.age+=a,this.vy+=G*tt*a;const o=Math.max(.25,this.m/1),l=Math.max(0,1-O/o);this.vx*=l,this.vy*=l,0!==this.driftAx&&this.age<this.driftTime?this.vx+=this.driftAx*a/o:0!==this.driftAx&&(this.driftAx=0),function(a,o){s!==t?s!==e?s!==n?s===i&&function(t,e){if(Mt===C||Et===C)return;if(M<=0||E<=0)return;const n=E*T,i=t.x-Mt,a=t.y-Et,o=i*i+a*a;if(o>n*n)return;const s=Math.max(Math.sqrt(o),w),l=i/s,r=a/s,h=Math.max(0,1-s/n),d=M*h;t.vx+=l*d*e,t.vy+=r*d*e}(a,o):function(t,e){sparkleDriftStrength>0&&(t.vx+=(Math.random()-.5)*sparkleDriftStrength*e,t.vy+=(Math.random()-.5)*sparkleDriftStrength*e),t.vx*=.98,t.vy*=.98;const n=(performance.now()/1e3-t.spawnTime)/t.lifetime,i=Math.max(0,1-n);t.r=t.rBase*i*sparkleParticleScale}(a,o):function(t,e){if(Mt===C||Et===C)return;const n=Mt-t.x,i=Et-t.y,a=n*n+i*i,o=Math.sqrt(a+1),s=n/o,l=i/o,r=4*d;t.vx+=s*r*e,t.vy+=l*r*e;const h=80*T;let c=0,m=0,f=0;for(let e=0;e<Dt.length;e++){const n=Dt[e];if(n===t)continue;const i=t.x-n.x,a=t.y-n.y,o=i*i+a*a;if(o<h*h&&o>0){const t=Math.sqrt(o),e=1-t/h;c+=i/t*e,m+=a/t*e,f++}}if(f>0){const n=15e3;t.vx+=c/f*n*e,t.vy+=m/f*n*e}if(Math.random()<.05){const e=Math.random()*Math.PI*2,n=800;t.vx+=Math.cos(e)*n,t.vy+=Math.sin(e)*n}t.vx+=1200*(Math.random()-.5)*e,t.vy+=1200*(Math.random()-.5)*e;const g=.5+1.5*Math.random(),p=1200*u*g*e;t.vx+=-l*p,t.vy+=s*p;const y=1400,x=Math.sqrt(t.vx*t.vx+t.vy*t.vy);x>y&&(t.vx=t.vx/x*y,t.vy=t.vy/x*y),t.vx*=.99,t.vy*=.99}(a,o):function(t,e){if(!bt)return;if(xt<=0||yt<=0)return;const n=yt*T,i=t.x-Mt,a=t.y-Et,o=i*i+a*a;if(o>n*n)return;const s=Math.max(Math.sqrt(o),w),l=i/s,r=a/s,h=Math.max(0,1-s/n),d=20*xt*Math.pow(h,vt),c=Math.max(.25,t.m/1);t.vx+=l*d*e/c,t.vy+=r*d*e/c;t.vx+=10*(Math.random()-.5)*e,t.vy+=10*(Math.random()-.5)*e}(a,o)}(this,a),this.x+=this.vx*a,this.y+=this.vy*a;const r=Math.max(0,1-2*a);this.omega*=r,this.theta+=this.omega*a,this.theta>Math.PI?this.theta-=2*Math.PI:this.theta<-Math.PI&&(this.theta+=2*Math.PI);const h=Math.min(1,18*a);this.squashAmount+=(0-this.squashAmount)*h,this.squash=1-this.squashAmount}walls(t,e,n,i=D){const a=i;if(0===Vt){if(this.y+this.r>e){this.y=e-this.r;const t=this.vy,i=this.vx-this.omega*this.r,o=Math.max(.25,this.m/1);this.omega+=i/this.r*B/o;const s=Math.max(0,1-1.5*n/o);this.vx*=s;const l=Math.abs(t)<70?0:a;this.vy=-this.vy*(l*Math.pow(1/this.m,Q));const r=Math.min(1,Math.abs(t)/(90*this.r));this.squashAmount=Math.min(V(),.8*r),this.squash=1-this.squashAmount,this.squashNormalAngle=-Math.PI/2;const h=this.vx/this.r;this.omega+=(h-this.omega)*Math.min(1,8*n)}const i=Math.max(0,e-L.clientHeight*T);if(this.y-this.r<i){this.y=i+this.r;const t=this.vy;this.vy=-this.vy*a;const e=Math.min(1,Math.abs(t)/(90*this.r));this.squashAmount=Math.min(V(),.8*e),this.squash=1-this.squashAmount,this.squashNormalAngle=Math.PI/2}if(this.x+this.r>t){this.x=t-this.r;{const t=this.vy-this.omega*this.r,e=Math.max(.25,this.m/1);this.omega+=t/this.r*.125/e}this.vx=-this.vx*a;const e=Math.min(1,Math.abs(this.vx)/(90*this.r));this.squashAmount=Math.min(V(),.8*e),this.squash=1-this.squashAmount,this.squashNormalAngle=Math.PI}if(this.x-this.r<0){this.x=this.r;{const t=this.vy-this.omega*this.r,e=Math.max(.25,this.m/1);this.omega+=t/this.r*.125/e}this.vx=-this.vx*a;const t=Math.min(1,Math.abs(this.vx)/(90*this.r));this.squashAmount=Math.min(V(),.8*t),this.squash=1-this.squashAmount,this.squashNormalAngle=0}}else this.handleRoundedWallCollision(t,e);this.checkTextCollisions(n)}checkTextCollisions(t){for(let t=0;t<Rt.length;t++){const e=Rt[t],n=Math.max(e.x,Math.min(this.x,e.x+e.width)),i=Math.max(e.y,Math.min(this.y,e.y+e.height)),a=this.x-n,o=this.y-i,s=Math.sqrt(a*a+o*o);if(s<this.r)if(0===s){const t=this.x-e.x,n=e.x+e.width-this.x,i=this.y-e.y,a=e.y+e.height-this.y,o=Math.min(t,n,i,a);o===t?(this.x=e.x-this.r,this.vx=-Math.abs(this.vx)*D):o===n?(this.x=e.x+e.width+this.r,this.vx=Math.abs(this.vx)*D):o===i?(this.y=e.y-this.r,this.vy=-Math.abs(this.vy)*D):(this.y=e.y+e.height+this.r,this.vy=Math.abs(this.vy)*D)}else{const t=this.r-s,e=a/s,n=o/s;this.x+=e*t,this.y+=n*t;const i=this.vx*e+this.vy*n;if(i<0){this.vx-=2*i*e*D,this.vy-=2*i*n*D;const t=Math.min(1,Math.abs(i)/(70*this.r));this.squash=1-V()*t,this.squashDirX=Math.abs(e)>Math.abs(n)?1:0,this.squashDirY=Math.abs(n)>Math.abs(e)?1:0}}}}handleRoundedWallCollision(t,e){const n=Vt,i=[{x:n,y:n},{x:t-n,y:n},{x:t-n,y:e-n},{x:n,y:e-n}];for(let a=0;a<i.length;a++){const o=i[a],s=this.x-o.x,l=this.y-o.y,r=Math.sqrt(s*s+l*l);if(this.isInCornerRegion(o,t,e,n)&&r+this.r>n){const t=n-(r-this.r);if(t>0&&r>0){const e=s/r,n=l/r;this.x+=e*t,this.y+=n*t;const i=this.vx*e+this.vy*n;this.vx-=2*i*e*D,this.vy-=2*i*n*D;const a=Math.min(1,Math.abs(i)/(90*this.r));this.squashAmount=Math.min(V(),.8*a),this.squash=1-this.squashAmount,this.squashNormalAngle=Math.atan2(n,e)}}}if(this.y+this.r>e&&(this.x<n||this.x>t-n)&&(this.y=e-this.r,this.vy=-this.vy*(D*Math.pow(1/this.m,Q))),this.y-this.r<0&&(this.x<n||this.x>t-n)&&(this.y=this.r,this.vy=-this.vy*D),this.x+this.r>t&&(this.y<n||this.y>e-n)){this.x=t-this.r;{const t=this.vy-this.omega*this.r,e=Math.max(.25,this.m/1);this.omega+=t/this.r*.125/e}this.vx=-this.vx*(D*Math.pow(1/this.m,Q));const e=Math.min(1,Math.abs(this.vx)/(70*this.r));this.squashAmount=Math.min(V(),e),this.squash=1-this.squashAmount,this.squashNormalAngle=Math.PI}if(this.x-this.r<0&&(this.y<n||this.y>e-n)){this.x=this.r;{const t=this.vy-this.omega*this.r,e=Math.max(.25,this.m/1);this.omega+=t/this.r*.125/e}this.vx=-this.vx*(D*Math.pow(1/this.m,Q));const t=Math.min(1,Math.abs(this.vx)/(70*this.r));this.squashAmount=Math.min(V(),t),this.squash=1-this.squashAmount,this.squashNormalAngle=0}this.y+this.r>e&&this.x>=n&&this.x<=t-n&&(this.y=e-this.r,this.vy=-this.vy*(D*Math.pow(1/this.m,Q))),this.y-this.r<0&&this.x>=n&&this.x<=t-n&&(this.y=this.r,this.vy=-this.vy*(D*Math.pow(1/this.m,Q))),this.x+this.r>t&&this.y>=n&&this.y<=e-n&&(this.x=t-this.r,this.vx=-this.vx*(D*Math.pow(1/this.m,Q))),this.x-this.r<0&&this.y>=n&&this.y<=e-n&&(this.x=this.r,this.vx=-this.vx*(D*Math.pow(1/this.m,Q)))}isInCornerRegion(t,e,n,i){return t.x===i&&t.y===i?this.x<=i&&this.y<=i:t.x===e-i&&t.y===i?this.x>=e-i&&this.y<=i:t.x===e-i&&t.y===n-i?this.x>=e-i&&this.y>=n-i:t.x===i&&t.y===n-i&&this.x<=i&&this.y>=n-i}draw(t){if(t.save(),t.translate(this.x,this.y),this.isSparkle){const e=performance.now()/1e3-this.spawnTime,n=Math.min(1,e/this.lifetime),i=Math.max(0,1-n);if(trailIntensity>0){const e=this.r*(1.5+2*trailIntensity),n=i*trailIntensity*.3;t.beginPath(),t.arc(0,0,e,0,2*Math.PI);const a=t.createRadialGradient(0,0,0,0,0,e),o=this.color,s=o.replace(/[\d\.]+\)$/g,`${n})`),l=o.replace(/[\d\.]+\)$/g,.5*n+")");a.addColorStop(0,s),a.addColorStop(.7,l),a.addColorStop(1,o.replace(/[\d\.]+\)$/g,"0)")),t.fillStyle=a,t.fill()}t.beginPath(),t.arc(0,0,this.r,0,2*Math.PI),t.fillStyle=this.color.replace(/[\d\.]+\)$/g,`${i})`),t.fill(),trailIntensity>.2&&(t.beginPath(),t.arc(.3*this.r,.3*-this.r,.15*this.r,0,2*Math.PI),t.fillStyle=`rgba(255, 255, 255, ${i*trailIntensity*.8})`,t.fill())}else{const e=Math.min(V(),Math.max(0,this.squashAmount));if(e>.001){const n=1+e,i=1/n;t.rotate(this.squashNormalAngle),t.scale(n,i),t.rotate(-this.squashNormalAngle)}t.beginPath(),t.arc(0,0,this.r,0,2*Math.PI),t.fillStyle=this.color,t.fill()}t.restore()}}const Dt=[];function Ot(t,e,n){return Math.max(e,Math.min(n,t))}function Wt(t,e){return t+Math.random()*(e-t)}function Ht(t,e,n=pt()){const i=(nt+it)/2;let a;if(0===Z)a=i;else{const t=.1*i;a=Wt(Math.max(1,i-t),i+t)}const o=new Gt(t,e,a,n),s=.5*L.width,l=st?rt>=0?1:-1:t<s?1:-1,r=Ot(a/(.5*(nt+it)),.6,1.4),h=140*r,d=180*r;return o.vx=l*(h+Math.random()*d),o.vy=120*-Math.random(),o.driftAx=l*(360+420*Math.random())*r,o.driftTime=.22+.28*Math.random(),Dt.push(o),o}let _t=0,$t=0,jt=!1;function Yt(){Dt.length=0,_t=0,$t=0,jt=!0}let Zt=0;function Jt(){const t=L.clientWidth,e=L.clientHeight,n=Ot(A/100*t,0,t);let i=Ot(P/100*t,0,t);if(st){const e=.2*t,n=i;i=Ot(i+Math.sin(lt)*e,0,t),rt=i>=n?1:-1}const a=Math.min(40,.1*n),o=Ot(i-n/2-a,-a,t),s=Ot(i+n/2+a,-a,t),l=q/100*e,r=l+k/100*e,h=Math.random();return{x:(o+(s-o)*(rt>0?Math.pow(h,.7):1-Math.pow(1-h,.7)))*T,y:Wt(l*T,r*T)-(it+2+Wt(0,10*T))}}const Kt=[];let Xt=0;const Qt=new Map;function te(t=6){const e=function(){const t=Dt.length;if(t<2)return[];const e=Math.max(1,2*it),n=Math.ceil(L.width/e)+1;Qt.clear();for(let i=0;i<t;i++){const t=Dt[i],a=t.x/e|0,o=(t.y/e|0)*n+a;let s=Qt.get(o);s||(s=[],Qt.set(o,s)),s.push(i)}const i=[];for(const[t,e]of Qt){const a=t/n|0,o=t%n;for(let t=-1;t<=1;t++)for(let s=-1;s<=1;s++){const l=(a+t)*n+(o+s),r=Qt.get(l);if(r)for(let t=0;t<e.length;t++){const n=e[t];for(let t=0;t<r.length;t++){const e=r[t];if(e<=n)continue;const a=Dt[n],o=Dt[e],s=o.x-a.x,l=o.y-a.y,h=a.r+o.r,d=s*s+l*l;if(d<h*h){const t=h-Math.sqrt(Math.max(d,1e-6));i.push({i:n,j:e,overlap:t})}}}}}return i.sort((t,e)=>e.overlap-t.overlap),i}();for(let n=0;n<t;n++)for(let t=0;t<e.length;t++){const{i:n,j:i}=e[t],a=Dt[n],o=Dt[i],s=o.x-a.x,l=o.y-a.y,r=a.r+o.r,h=s*s+l*l;if(0===h||h>r*r)continue;const d=Math.sqrt(h),c=s/d,u=l/d,m=r-d,f=1/Math.max(a.m,.001),g=1/Math.max(o.m,.001),p=.8*Math.max(m-_,0)/(f+g),y=p*c,x=p*u;a.x-=y*f,a.y-=x*f,o.x+=y*g,o.y+=x*g;const v=o.vx-a.vx,M=o.vy-a.vy,E=v*c+M*u;if(E<0){const t=-(1+(Math.abs(E)<30?0:D))*E/(f+g),e=t*c,n=t*u;a.vx-=e*f,a.vy-=n*f,o.vx+=e*g,o.vy+=n*g;const i=v-E*c,s=M-E*u,l=Math.hypot(i,s);if(l>.001){const t=i*-u+s*c>=0?1:-1,e=.18;a.omega-=t*e*l/Math.max(a.r,1),o.omega+=t*e*l/Math.max(o.r,1)}const r=Math.min(1,Math.abs(E)/(50*(a.r+o.r))),h=Math.min(V(),.8*r);a.squashAmount=Math.max(a.squashAmount,.8*h),a.squashNormalAngle=Math.atan2(-u,-c),o.squashAmount=Math.max(o.squashAmount,.8*h),o.squashNormalAngle=Math.atan2(u,c)}}}let ee=performance.now()/1e3,ne=0;const ie=1/120;function ae(){const t=parseFloat(re.value);Y=t,at();const e=(nt+it)/2;for(let t=0;t<Dt.length;t++)if(s!==a)if(0===Z)Dt[t].r=e,Dt[t].rBase=e;else{const n=.1*e,i=Math.max(1,e-n),a=e+n;Dt[t].r=Wt(i,a),Dt[t].rBase=Dt[t].r}}console.log("High refresh mode enabled - using requestAnimationFrame"),requestAnimationFrame(function t(o){const l=o/1e3;let r=Math.min(.008,l-ee);ee=l,ne+=r,Pt++,(Nt||Ut)&&l-At>=1&&(Nt&&Pt!==kt&&(kt=Pt,Nt.textContent=kt.toString()),Ut&&qt!==zt&&(zt=qt,Ut.textContent=zt.toString()),Pt=0,qt=0,At=l),function(t){if(s!==n)if(s!==a){if(s!==i)for(Zt+=t;Zt>=W;){const t=(Math.random()-.5)*W*.5;Zt-=W+t,lt+=2*Math.PI*.12*(W+t);const e=Jt(),n=Math.random()<.35?3:1;for(let t=0;t<n;t++)if(Dt.length<H){const n=8*t*(Math.random()<.5?1:-1);Ht(e.x+n,e.y-12*t)}}}else jt&&performance.now()/1e3-$t>=b&&function(){if(!jt)return!1;if(_t>=ct.length)return _t=0,Dt.length=0,$t=performance.now()/1e3,!1;const t=Y*T*30,e=S,n=(Math.max(1,ct.length-1),t*(1+(Math.random()-.5)*e)),i=L.width/(ct.length+1),a=new Gt(i*(_t+1),-n-100,n,ct[_t]);a.vx=0,a.vy=0,Dt.push(a),_t++,$t=performance.now()/1e3}();else!function(){if(!(m.length<2))for(let t=0;t<Dt.length;t++){const e=Dt[t];let n=-1,i=1/0;for(let t=0;t<m.length;t++){const a=m[t],o=a.x-e.x,s=a.y-e.y,l=o*o+s*s;l<i&&(i=l,n=t)}if(n>=0){const t=m[n],i=4*ie;e.vx+=(t.x-e.x)*i,e.vy+=(t.y-e.y)*i}}}()}(r),Pt%60==0&&ot();let h=0;for(;ne>=ie&&h<2;){for(let t=0;t<Dt.length;t++)Dt[t].step(ie);if(s!==e&&s!==n&&te(3),s!==n){const t=s===i?v:D;for(let e=0;e<Dt.length;e++)Dt[e].walls(L.width,L.height,ie,t)}ne-=ie,h++,qt++}if(s===n)for(let t=Dt.length-1;t>=0;t--){const e=Dt[t];e.isSparkle&&e.r<=.5&&(e.active=!1,Dt.splice(t,1))}if(ne>3*ie&&(ne=0),s===n){const t=.28,e=t+(.002-t)*Math.max(0,Math.min(1,p));R.fillStyle=`rgba(0,0,0,${e})`,R.globalCompositeOperation="destination-out",R.fillRect(0,0,L.width,L.height),R.globalCompositeOperation="source-over"}else R.clearRect(0,0,L.width,L.height);Vt>0&&function(t,e,n){const i=Vt;t.strokeStyle="rgba(255, 255, 255, 0.1)",t.lineWidth=2,t.beginPath(),t.moveTo(i,0),t.lineTo(e-i,0),t.arcTo(e,0,e,i,i),t.lineTo(e,n-i),t.arcTo(e,n,e-i,n,i),t.lineTo(i,n),t.arcTo(0,n,0,n-i,i),t.lineTo(0,i),t.arcTo(0,0,i,0,i),t.closePath(),t.stroke()}(R,L.width,L.height);for(let t=0;t<Dt.length;t++)Dt[t].draw(R);if(function(t){if(It)return;if(Mt===C||Et===C)return;if(s===n)return;const e=Mt,i=Et,a=(nt+it)/2;t.beginPath(),t.arc(e,i,a,0,2*Math.PI),t.fillStyle="rgba(255, 255, 255, 0.9)",t.fill(),t.strokeStyle="rgba(255, 255, 255, 0.6)",t.lineWidth=2,t.stroke()}(R),!It){R.save(),R.font="14px system-ui, -apple-system, sans-serif",R.fillStyle="rgba(255, 255, 255, 0.3)",R.textAlign="left",R.textBaseline="bottom";const t=s.charAt(0).toUpperCase()+s.slice(1);R.fillText(t+" Mode",10,L.height-10),R.restore()}requestAnimationFrame(t)}),window.addEventListener("keydown",o=>{const l=o.key.toLowerCase();"r"===l&&(function(){if(s===a)Yt();else if(s===i)Zn();else for(let t=0;t<Dt.length;t++){const e=Dt[t],n=Jt();e.x=n.x,e.y=n.y;const i=.5*L.width,a=st?rt>=0?1:-1:e.x<i?1:-1,o=Ot(e.r/(.5*(nt+it)),.6,1.4),s=140*o,l=180*o,r=120;e.vx=a*(s+Math.random()*l),e.vy=-Math.random()*r,e.age=0,e.driftAx=a*(360+420*Math.random())*o,e.driftTime=.22+.28*Math.random()}}(),o.preventDefault()),"/"===l&&F&&(o.preventDefault(),F.classList.toggle("hidden")),"1"===l&&Jn(t),"2"===l&&Jn(e),"3"===l&&Jn(n),"4"===l&&Jn(i),"5"===l&&Jn(a)}),function(t=160){for(let e=0;e<t&&Dt.length<H;e++){const t=Jt();Ht(t.x,t.y)}}(200),L.addEventListener("mousemove",e=>{const i=L.getBoundingClientRect();if(Mt=(e.clientX-i.left)*T,Et=(e.clientY-i.top)*T,s===t&&xt>0&&yt>0&&(bt=!0),s===n)if(0===m.length)m.push({x:Mt,y:Et});else{const t=m[m.length-1],e=Mt-t.x,n=Et-t.y;e*e+n*n>=g*g&&(m.push({x:Mt,y:Et}),m.length>f&&m.shift())}}),L.addEventListener("mouseleave",()=>{Mt=C,Et=C,s===n&&(m=[])});const oe=document.getElementById("restitutionSlider"),se=document.getElementById("frictionSlider"),le=document.getElementById("emitterSlider"),re=document.getElementById("sizeSliderGlobal"),he=document.getElementById("sizeVariationSliderGlobal"),de=(document.getElementById("weightSliderGlobal"),document.getElementById("ballSoftnessSliderGlobal")),ce=document.getElementById("sizeValGlobal"),ue=document.getElementById("sizeVariationValGlobal"),me=(document.getElementById("weightValGlobal"),document.getElementById("ballSoftnessValGlobal")),fe=(document.getElementById("sizeSliderPit"),document.getElementById("sizeVariationSliderPit"),document.getElementById("weightSliderPit"),document.getElementById("ballSoftnessSliderPit"),document.getElementById("sizeValPit"),document.getElementById("sizeVariationValPit"),document.getElementById("weightValPit"),document.getElementById("ballSoftnessValPit"),document.getElementById("sizeSliderFlies"),document.getElementById("sizeVariationSliderFlies"),document.getElementById("weightSliderFlies"),document.getElementById("ballSoftnessSliderFlies"),document.getElementById("sizeValFlies"),document.getElementById("sizeVariationValFlies"),document.getElementById("weightValFlies"),document.getElementById("ballSoftnessValFlies"),document.getElementById("sizeSliderZeroG"),document.getElementById("sizeVariationSliderZeroG"),document.getElementById("weightSliderZeroG"),document.getElementById("ballSoftnessSliderZeroG"),document.getElementById("sizeValZeroG"),document.getElementById("sizeVariationValZeroG"),document.getElementById("weightValZeroG"),document.getElementById("ballSoftnessValZeroG"),document.getElementById("maxBallsSlider")),ge=document.getElementById("spawnYSlider"),pe=document.getElementById("spawnWidthSlider"),ye=document.getElementById("spawnCenterSlider"),xe=document.getElementById("spawnHeightSlider"),ve=document.getElementById("repelSizeSlider"),Me=document.getElementById("repelPowerSlider"),Ee=document.getElementById("repelSoftSlider"),be=document.getElementById("colorSelect"),Ie=document.getElementById("color1"),Se=document.getElementById("color2"),Ce=document.getElementById("color3"),we=document.getElementById("color4"),Be=document.getElementById("color5"),Ve=document.getElementById("color6"),Le=document.getElementById("color7"),Re=document.getElementById("color8"),Fe=document.getElementById("cursorColorSelect"),Te=document.getElementById("color1Val"),Pe=document.getElementById("color2Val"),qe=document.getElementById("color3Val"),Ae=document.getElementById("color4Val"),ke=document.getElementById("color5Val"),ze=document.getElementById("color6Val"),Ne=document.getElementById("color7Val"),Ue=document.getElementById("color8Val");[Te,Pe,qe,Ae,ke,ze,Ne,Ue].forEach(t=>{t&&t.setAttribute("title","Click to copy")});const Ge=document.getElementById("cornerRadiusSlider"),De=document.getElementById("cornerRadiusVal"),Oe=document.getElementById("trailFadeSlider"),We=document.getElementById("trailFadeVal"),He=document.getElementById("trailSubtletySlider"),_e=document.getElementById("trailSubtletyVal"),$e=document.getElementById("restitutionVal"),je=document.getElementById("frictionVal"),Ye=document.getElementById("emitterVal"),Ze=document.getElementById("maxBallsVal"),Je=document.getElementById("spawnYVal"),Ke=document.getElementById("spawnWidthVal"),Xe=document.getElementById("spawnCenterVal"),Qe=document.getElementById("spawnHeightVal"),tn=document.getElementById("repelSizeVal"),en=document.getElementById("repelPowerVal"),nn=document.getElementById("repelSoftVal");function an(){return{gravityMultiplier:U,restitution:D,friction:O,ballMass:X,emitRate:W,maxBalls:H,ballScale:Y,ballVariation:Z,spawnX:P,spawnY:q,spawnWidth:A,spawnHeight:k,sweepEnabled:st,repelRadius:yt,repelPower:xt,repelSoftness:vt,trailFade:p,trailSubtlety:Tt,colors:ct.slice(),colorWeights:gt.slice(),currentTemplate:dt,cursorColorIndex:ut}}const on=document.getElementById("saveConfigBtn"),sn=document.getElementById("buildBtn"),ln=document.getElementById("configOutput");function rn(t,e){t&&t.addEventListener("click",async()=>{const n="function"==typeof e?e():String(e||"").trim();try{await navigator.clipboard.writeText(n);const e=t.textContent;t.textContent="COPIED",t.style.color="#3ddc84",setTimeout(()=>{t.textContent=e,t.style.color="#888"},900)}catch(t){console.warn("Clipboard unavailable")}})}on&&sn&&ln&&(on.addEventListener("click",()=>{const t=(e=an(),`// Generated configuration from frontend\nconst CONFIG = ${JSON.stringify(e,null,2)};`);var e;ln.style.display="block",ln.textContent=t,navigator.clipboard.writeText(t).then(()=>{const t=on.textContent;on.textContent="âœ… Copied!",setTimeout(()=>{on.textContent=t},1200)}).catch(()=>{console.warn("Clipboard copy failed");const t=on.textContent;on.textContent="âš ï¸ Copy failed",setTimeout(()=>{on.textContent=t},1200)})}),sn.addEventListener("click",()=>{const t=an();ln.style.display="block",ln.innerHTML="\n<strong>ðŸš€ Build Instructions:</strong><br>\n1. Run: <code>npm run build</code><br>\n2. Your current config will be baked into <code>public/js/bouncy-balls-embed.js</code>";const e=new Blob([JSON.stringify(t,null,2)],{type:"application/json"}),n=URL.createObjectURL(e),i=document.createElement("a");i.href=n,i.download="current-config.json",i.click(),URL.revokeObjectURL(n)})),oe&&oe.addEventListener("input",()=>{D=parseFloat(oe.value),$e&&($e.textContent=D.toFixed(2)),wt()}),se&&se.addEventListener("input",()=>{O=parseFloat(se.value),je&&(je.textContent=O.toFixed(4)),wt()}),le&&le.addEventListener("input",()=>{W=parseFloat(le.value),Ye&&(Ye.textContent=W.toFixed(3)),wt()}),function(t){if(!t)return;const{size:e,sizeVal:n,sizeVar:i,sizeVarVal:o,soft:r,softVal:h}=t;e&&e.addEventListener("input",()=>{const t=parseFloat(e.value);n&&(n.textContent=t.toFixed(1)),Y=t,at();for(let t=0;t<Dt.length;t++)Dt[t].m=s===a?5*X:X;wt()}),i&&i.addEventListener("input",()=>{const t=parseFloat(i.value);o&&(o.textContent=t.toFixed(1)),Z=t,wt()}),r&&r.addEventListener("input",()=>{const t=parseInt(r.value,10);h&&(h.textContent=String(t)),l=t,wt()})}({size:re,sizeVal:ce,sizeVar:he,sizeVarVal:ue,soft:de,softVal:me}),fe&&fe.addEventListener("input",()=>{H=parseInt(fe.value,10),Ze&&(Ze.textContent=H.toString()),Dt.length>H&&(Dt.length=H)}),he&&he.addEventListener("input",()=>{Z=parseFloat(he.value),ue&&(ue.textContent=Z.toFixed(1)),cn()});const hn=document.getElementById("weightPitSlider"),dn=document.getElementById("weightPitVal");function cn(){const t=(nt+it)/2;for(let e=0;e<Dt.length;e++){const n=Dt[e];if(0===Z)n.r=t;else{const e=.1*t,i=Math.max(1,t-e),a=t+e;n.r=Wt(i,a)}n.m=X}}document.getElementById("weightWeightlessSlider"),document.getElementById("weightWeightlessVal"),ge&&ge.addEventListener("input",()=>{q=parseFloat(ge.value),Je&&(Je.textContent=q.toFixed(0)),z()}),pe&&pe.addEventListener("input",()=>{A=parseFloat(pe.value),Ke&&(Ke.textContent=A.toFixed(0))}),ye&&ye.addEventListener("input",()=>{P=parseFloat(ye.value),Xe&&(Xe.textContent=P.toFixed(0))}),xe&&xe.addEventListener("input",()=>{k=parseFloat(xe.value),Qe&&(Qe.textContent=k.toFixed(0))}),ve&&ve.addEventListener("input",()=>{yt=parseFloat(ve.value),tn&&(tn.textContent=yt.toFixed(0)),bt=bt||xt>0&&yt>0}),Me&&Me.addEventListener("input",()=>{xt=function(t){const e=Math.max(0,Math.min(Bt,Number(t)))/Bt;return 2*Math.pow(2,12*(e-.5))*12e3}(Me.value),en&&(en.textContent=Math.round(xt).toString()),ai&&"off"!==ai.value&&(bt=xt>0&&yt>0)}),Ee&&Ee.addEventListener("input",()=>{vt=parseFloat(Ee.value),nn&&(nn.textContent=vt.toFixed(1))}),be&&be.addEventListener("change",()=>{const t=ht[be.value];t&&(dt=be.value,ct=t.colors.slice(),mt=ct[ut]||mt,Ie&&Te&&(Ie.value=ct[0],Te.textContent=ct[0].toUpperCase()),Se&&Pe&&(Se.value=ct[1],Pe.textContent=ct[1].toUpperCase()),Ce&&qe&&(Ce.value=ct[2],qe.textContent=ct[2].toUpperCase()),we&&Ae&&(we.value=ct[3],Ae.textContent=ct[3].toUpperCase()),Be&&ke&&(Be.value=ct[4],ke.textContent=ct[4].toUpperCase()),Ve&&ze&&(Ve.value=ct[5],ze.textContent=ct[5].toUpperCase()),Le&&Ne&&(Le.value=ct[6],Ne.textContent=ct[6].toUpperCase()),Re&&Ue&&(Re.value=ct[7],Ue.textContent=ct[7].toUpperCase()),Kn(),ft())});const un=Array.from(document.querySelectorAll(".mode-button")),mn=document.getElementById("pitControls"),fn=document.getElementById("fliesControls"),gn=document.getElementById("trailControls"),pn=document.getElementById("weightlessControls"),yn=document.getElementById("boulderControls"),xn=document.getElementById("gravityPitSlider"),vn=document.getElementById("gravityPitVal"),Mn=document.getElementById("repellerEnabledPit"),En=document.getElementById("attractPowerSlider"),bn=document.getElementById("attractPowerVal"),In=document.getElementById("orbitRadiusSlider"),Sn=document.getElementById("orbitRadiusVal"),Cn=document.getElementById("swarmSpeedSlider"),wn=document.getElementById("swarmSpeedVal"),Bn=document.getElementById("trailLengthSlider"),Vn=document.getElementById("trailLengthVal"),Ln=document.getElementById("trailSpacingSlider"),Rn=document.getElementById("trailSpacingVal"),Fn=document.getElementById("trailModeFadeSlider"),Tn=document.getElementById("trailModeFadeVal"),Pn=document.getElementById("weightlessCountSlider"),qn=document.getElementById("weightlessCountVal"),An=document.getElementById("weightlessSpeedSlider"),kn=document.getElementById("weightlessSpeedVal"),zn=document.getElementById("weightlessBounceSlider"),Nn=document.getElementById("weightlessBounceVal"),Un=document.getElementById("weightlessRepelSlider"),Gn=document.getElementById("weightlessRepelVal"),Dn=document.getElementById("weightlessRepelRadiusSlider"),On=document.getElementById("weightlessRepelRadiusVal"),Wn=document.getElementById("bouldersDelaySlider"),Hn=document.getElementById("bouldersDelayVal"),_n=document.getElementById("bouldersGravitySlider"),$n=document.getElementById("bouldersGravityVal"),jn=document.getElementById("bouldersSizeVarietySlider"),Yn=document.getElementById("bouldersSizeVarietyVal");function Zn(){Dt.length=0;const t=y,e=L.width,n=L.height,i=e/n,a=Math.ceil(Math.sqrt(t*i)),o=Math.ceil(t/a),s=(e-80)/Math.max(1,a-1),l=(n-80)/Math.max(1,o-1),r=[];for(let i=0;i<o;i++)for(let o=0;o<a&&!(r.length>=t);o++){const t=40+o*s,a=40+i*l,h=(Math.random()-.5)*s*.25,d=(Math.random()-.5)*l*.25;r.push({x:Math.max(20,Math.min(e-20,t+h)),y:Math.max(20,Math.min(n-20,a+d))})}for(const t of r){const e=Ht(t.x,t.y),n=Math.random()*Math.PI*2,i=x*(.7+.3*Math.random());e.vx=Math.cos(n)*i,e.vy=Math.sin(n)*i,e.driftAx=0,e.driftTime=0}}function Jn(o){s=o,s===t?(U=r,G=N*U,bt=h&&xt>0&&yt>0,st=!0,Dt.length=0,Zt=0,ae()):s===e?(U=0,G=N*U,bt=!1,st=!1,Dt.length=0,ae()):s===n?(U=0,G=N*U,bt=!1,st=!1,mouseTrail=[],m=[],Dt.length=0,function(){Xt=0;for(let t=0;t<Kt.length;t++)Kt[t].active=!1}(),ae()):s===i?(U=0,G=N*U,bt=!1,st=!1,Zn(),ae()):s===a&&(U=I,G=N*U,bt=!1,st=!1,Yt()),mn&&mn.classList.toggle("active",s===t),fn&&fn.classList.toggle("active",s===e),gn&&gn.classList.toggle("active",s===n),pn&&pn.classList.toggle("active",s===i),yn&&yn.classList.toggle("active",s===a),un.forEach(t=>t.classList.toggle("active",t.getAttribute("data-mode")===s))}function Kn(){for(let t=0;t<Dt.length;t++)Dt[t].color=pt()}un.forEach(t=>t.addEventListener("click",()=>{Jn(t.getAttribute("data-mode")),wt()})),xn&&xn.addEventListener("input",()=>{r=parseFloat(xn.value),vn&&(vn.textContent=r.toFixed(1)),wt(),s===t&&(U=r,G=N*U)}),hn&&hn.addEventListener("input",()=>{X=parseFloat(hn.value),dn&&(dn.textContent=X.toFixed(2));for(let t=0;t<Dt.length;t++)Dt[t].m=s===a?5*X:X;et(),wt()}),Mn&&Mn.addEventListener("change",()=>{h=!!Mn.checked,s===t&&(bt=h&&xt>0&&yt>0)}),En&&En.addEventListener("input",()=>{d=parseFloat(En.value),bn&&(bn.textContent=Math.round(d).toString())}),In&&In.addEventListener("input",()=>{c=parseFloat(In.value),Sn&&(Sn.textContent=Math.round(c).toString())}),Cn&&Cn.addEventListener("input",()=>{u=parseFloat(Cn.value),wn&&(wn.textContent=u.toFixed(1))}),Bn&&Bn.addEventListener("input",()=>{f=parseInt(Bn.value,10),Vn&&(Vn.textContent=f.toString())}),Ln&&Ln.addEventListener("input",()=>{g=parseFloat(Ln.value),Rn&&(Rn.textContent=g.toFixed(0))}),Fn&&Fn.addEventListener("input",()=>{p=parseFloat(Fn.value),Tn&&(Tn.textContent=p.toFixed(2))}),Pn&&Pn.addEventListener("input",()=>{y=parseInt(Pn.value,10),qn&&(qn.textContent=y.toString()),s===i&&Zn()}),An&&An.addEventListener("input",()=>{x=parseFloat(An.value),kn&&(kn.textContent=Math.round(x).toString())}),zn&&zn.addEventListener("input",()=>{v=parseFloat(zn.value),Nn&&(Nn.textContent=v.toFixed(2))}),Un&&Un.addEventListener("input",()=>{M=parseFloat(Un.value),Gn&&(Gn.textContent=Math.round(M).toString())}),Dn&&Dn.addEventListener("input",()=>{E=parseFloat(Dn.value),On&&(On.textContent=Math.round(E).toString())}),Wn&&Wn.addEventListener("input",()=>{b=parseFloat(Wn.value),Hn&&(Hn.textContent=b.toFixed(1))}),_n&&_n.addEventListener("input",()=>{I=parseFloat(_n.value),$n&&($n.textContent=I.toFixed(1)),s===a&&(U=I,G=N*U)}),jn&&jn.addEventListener("input",()=>{S=parseFloat(jn.value),Yn&&(Yn.textContent=S.toFixed(1))}),Ie&&Ie.addEventListener("input",()=>{ct[0]=Ie.value,Te&&(Te.textContent=Ie.value.toUpperCase()),Kn(),ft()}),Se&&Se.addEventListener("input",()=>{ct[1]=Se.value,Pe&&(Pe.textContent=Se.value.toUpperCase()),Kn(),ft()}),Ce&&Ce.addEventListener("input",()=>{ct[2]=Ce.value,qe&&(qe.textContent=Ce.value.toUpperCase()),Kn(),ft()}),we&&we.addEventListener("input",()=>{ct[3]=we.value,Ae&&(Ae.textContent=we.value.toUpperCase()),Kn(),ft()}),Be&&Be.addEventListener("input",()=>{ct[4]=Be.value,ke&&(ke.textContent=Be.value.toUpperCase()),Kn(),ft()}),Ve&&Ve.addEventListener("input",()=>{ct[5]=Ve.value,ze&&(ze.textContent=Ve.value.toUpperCase()),Kn(),ft()}),Le&&Le.addEventListener("input",()=>{ct[6]=Le.value,Ne&&(Ne.textContent=Le.value.toUpperCase()),Kn(),ft()}),Re&&Re.addEventListener("input",()=>{ct[7]=Re.value,Ue&&(Ue.textContent=Re.value.toUpperCase()),Kn(),ft()}),Fe&&Fe.addEventListener("change",()=>{const t=Math.max(1,Math.min(8,parseInt(Fe.value,10)))-1;ut=t,mt=ct[ut]||mt}),rn(Te,()=>Ie.value.toUpperCase()),rn(Pe,()=>Se.value.toUpperCase()),rn(qe,()=>Ce.value.toUpperCase()),rn(Ae,()=>we.value.toUpperCase()),rn(ke,()=>Be.value.toUpperCase()),rn(ze,()=>Ve.value.toUpperCase()),rn(Ne,()=>Le.value.toUpperCase()),rn(Ue,()=>Re.value.toUpperCase()),Ge&&Ge.addEventListener("input",()=>{Vt=parseFloat(Ge.value),De&&(De.textContent=Vt.toFixed(0))}),Oe&&Oe.addEventListener("input",()=>{Ft=parseFloat(Oe.value),We&&(We.textContent=Ft.toFixed(3))}),He&&He.addEventListener("input",()=>{Tt=parseFloat(He.value),_e&&(_e.textContent=Tt.toFixed(2)+"Ã—")});const Xn={rubberPlayground:{label:"Rubber â€“ Playground",G:1960,REST:.9,FRICTION:.0025,sizeScale:1.8,maxBalls:450,sizeVariation:.2},rubberRacquet:{label:"Rubber â€“ Racquetball",G:3320,REST:.97,FRICTION:.0035,sizeScale:.7,maxBalls:350,sizeVariation:.3},rubberSuperball:{label:"Rubber â€“ Superball",G:1960,REST:.95,FRICTION:.0015,sizeScale:1.2,maxBalls:450,sizeVariation:.05},rubberSoft:{label:"Rubber â€“ Soft",G:1960,REST:.86,FRICTION:.0035,sizeScale:2.2,maxBalls:350,sizeVariation:.25},rubberHeavy:{label:"Rubber â€“ Heavy",G:1960,REST:.88,FRICTION:.003,sizeScale:2,maxBalls:400,sizeVariation:.15}},Qn={fullRain:{label:"Full Rain (top-half)",EMIT_INTERVAL:.03,xCenter:50,y:-50,w:100,h:50},narrowStrip:{label:"Narrow Strip Top",EMIT_INTERVAL:.05,xCenter:50,y:-40,w:20,h:10},leftGutter:{label:"Left Gutter",EMIT_INTERVAL:.045,xCenter:10,y:-60,w:18,h:20},rightGutter:{label:"Right Gutter",EMIT_INTERVAL:.045,xCenter:90,y:-60,w:18,h:20},centerFountain:{label:"Center Fountain",EMIT_INTERVAL:.02,xCenter:50,y:-30,w:30,h:20},stormBurst:{label:"Storm Burst",EMIT_INTERVAL:.005,xCenter:50,y:-80,w:100,h:30},slowSnow:{label:"Slow Snow",EMIT_INTERVAL:.2,xCenter:50,y:-30,w:100,h:20},edgeDrizzle:{label:"Edge Drizzle",EMIT_INTERVAL:.08,xCenter:15,y:-40,w:30,h:15},twinColumns:{label:"Twin Columns",EMIT_INTERVAL:.03,xCenter:30,y:-50,w:10,h:40},focusedBeam:{label:"Focused Beam",EMIT_INTERVAL:.015,xCenter:50,y:-70,w:6,h:12}},ti={off:{label:"Off",r:710,p:274e3,s:4.4},gentle:{label:"Gentle Breeze",r:120,p:2500,s:2.5},pushField:{label:"Push Field",r:240,p:8e4,s:2},tractor:{label:"Tractor Push",r:320,p:14e4,s:1.6},magnet:{label:"Magnet Repel",r:200,p:18e4,s:3},pulse:{label:"Pulse Strong",r:280,p:22e4,s:1.2},wideSoft:{label:"Wide Soft",r:500,p:8e4,s:4.5},needle:{label:"Needle Point",r:80,p:26e4,s:.8},wall:{label:"Invisible Wall",r:700,p:16e4,s:5},singularity:{label:"Singularity",r:600,p:3e5,s:.5}};function ei(t,e,n){t.innerHTML="";for(const[i,a]of Object.entries(e)){const e=document.createElement("option");e.value=i,e.textContent=a.label||i,i===n&&(e.selected=!0),t.appendChild(e)}}const ni=document.getElementById("physicsSelect"),ii=document.getElementById("spawnSelect"),ai=document.getElementById("repellerSelect");function oi(t,e,n,i=0){t&&(t.value=String(n)),e&&(e.textContent=i>0?n.toFixed(i):n.toString())}function si(t){const e=Xn[t];if(!e)return;D=e.REST,O=e.FRICTION,H=e.maxBalls,Z=e.sizeVariation;const n=e.sizeScale;Y=n,at();for(let t=0;t<Dt.length;t++)Dt[t].m=s===a?5*X:X;Dt.length>H&&(Dt.length=H),oi(oe,$e,D,2),oi(se,je,O,4),oi(re,ce,Y,1),oi(fe,Ze,H,0),oi(he,ue,Z,1),cn()}function li(t){const e=Qn[t];e&&(W=e.EMIT_INTERVAL,P=e.xCenter,q=e.y,A=e.w,k=e.h,oi(le,Ye,W,3),oi(ye,Xe,P,0),oi(ge,Je,q,0),oi(pe,Ke,A,0),oi(xe,Qe,k,0))}function ri(t){const e=ti[t];if(!e)return;yt=e.r,xt=1*e.p,bt="off"!==t,oi(ve,tn,yt,0);const n=function(t){const e=Math.max(1,Number(t))/24e3,n=.5+Math.log2(e)/12;return Math.round(Math.max(0,Math.min(1,n))*Bt)}(xt);Me&&(Me.value=String(n)),en&&(en.textContent=Math.round(xt).toString()),oi(Ee,nn,vt,1)}ni&&ei(ni,Xn,"rubberRacquet"),ii&&ei(ii,Qn,"fullRain"),ai&&ei(ai,ti,"off"),be&&ei(be,ht,"industrialTeal"),si("rubberRacquet"),li("fullRain"),ri("off");const hi=ht[dt];Ie&&Te&&(Ie.value=hi.colors[0],Te.textContent=hi.colors[0].toUpperCase()),Se&&Pe&&(Se.value=hi.colors[1],Pe.textContent=hi.colors[1].toUpperCase()),Ce&&qe&&(Ce.value=hi.colors[2],qe.textContent=hi.colors[2].toUpperCase()),we&&Ae&&(we.value=hi.colors[3],Ae.textContent=hi.colors[3].toUpperCase()),Be&&ke&&(Be.value=hi.colors[4],ke.textContent=hi.colors[4].toUpperCase()),Ve&&ze&&(Ve.value=hi.colors[5],ze.textContent=hi.colors[5].toUpperCase()),Le&&Ne&&(Le.value=hi.colors[6],Ne.textContent=hi.colors[6].toUpperCase()),Re&&Ue&&(Re.value=hi.colors[7],Ue.textContent=hi.colors[7].toUpperCase()),ft(hi.colors),ni&&ni.addEventListener("change",()=>si(ni.value)),ii&&ii.addEventListener("change",()=>li(ii.value)),ai&&ai.addEventListener("change",()=>ri(ai.value)),at(),ot(),function(){try{const t=localStorage.getItem(St);if(t){const e=JSON.parse(t);return e.currentMode&&(s=e.currentMode),void 0!==e.gravityMultiplierPit&&(r=e.gravityMultiplierPit),void 0!==e.repellerEnabledPit&&(h=e.repellerEnabledPit),e.attractionPower&&(d=e.attractionPower),e.orbitRadius&&(c=e.orbitRadius),e.swarmSpeed&&(u=e.swarmSpeed),void 0!==e.sparkleEmissionRate&&(sparkleEmissionRate=e.sparkleEmissionRate),void 0!==e.sparkleLifetime&&(sparkleLifetime=e.sparkleLifetime),void 0!==e.sparkleVelocitySpread&&(sparkleVelocitySpread=e.sparkleVelocitySpread),void 0!==e.sparkleDriftStrength&&(sparkleDriftStrength=e.sparkleDriftStrength),void 0!==e.sparkleParticleScale&&(sparkleParticleScale=e.sparkleParticleScale),e.weightlessInitialSpeed&&(x=e.weightlessInitialSpeed),e.weightlessBounce&&(v=e.weightlessBounce),e.weightlessMaxBalls&&(weightlessMaxBalls=e.weightlessMaxBalls),void 0!==e.weightlessRepellerPower&&(M=e.weightlessRepellerPower),void 0!==e.weightlessRepellerRadius&&(E=e.weightlessRepellerRadius),e.restitution&&(D=e.restitution),void 0!==e.friction&&(O=e.friction),e.sizeScale&&(Y=e.sizeScale),void 0!==e.sizeVariation&&(Z=e.sizeVariation),e.ballMassKg&&(X=e.ballMassKg),e.repelPower&&(xt=e.repelPower),e.repelRadius&&(yt=e.repelRadius),e.repelSoft&&(vt=e.repelSoft),void 0!==e.cornerRadius&&(Vt=e.cornerRadius),void 0!==e.motionBlur&&(p=e.motionBlur),e.trailSubtlety&&(Tt=e.trailSubtlety),e.currentTemplate&&(dt=e.currentTemplate),e.cursorBallColor&&(mt=e.cursorBallColor),console.log("âœ“ Settings loaded"),!0}}catch(t){console.warn("Could not load settings:",t)}}(),function(){const t=It?"mobile":"desktop",e=document.getElementById("trailModeButton");e&&!o[n][t]&&(e.style.display="none")}(),Jn(s),window.addEventListener("beforeunload",Ct)})();