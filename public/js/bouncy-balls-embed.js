(()=>{const t=-1e9,e=.25,n=.2,a=document.getElementById("c"),s=a.getContext("2d",{alpha:!0}),i=document.getElementById("controlPanel"),o=Math.max(1,Math.min(2,window.devicePixelRatio||1));let l=50,h=-50,r=100,c=50;function d(){const t=1.5*window.innerHeight;a.width=Math.floor(window.innerWidth*o),a.height=Math.floor(t*o)}d(),window.addEventListener("resize",()=>{d(),q(),A()});let u=.88,f=.003,m=.03,x=400;const p=.5*o,y=6,g=24;let v=2,M=.15,b=1,C=null,E=11.2;const I=.15;let w=1;function B(){w=Math.max(.5,Math.min(3,Math.pow(E/1,.35)))}B();let S=y*v,T=g*v;function q(){b=(a.clientWidth||window.innerWidth)<=768?.4:1;const t=v*b;if(null===C)return C=t,S=y*t,void(T=g*t);const e=t/C;if(1!==e){for(let t=0;t<lt.length;t++)lt[t].r*=e;C=t}S=y*t,T=g*t}function A(){$=[];const t=document.querySelector(J);if(!t)return;const e=t.getBoundingClientRect(),n=a.getBoundingClientRect(),s=function(t){const e=document.createElement("span");e.style.cssText=window.getComputedStyle(t).cssText,e.style.position="absolute",e.style.visibility="hidden",e.style.whiteSpace="nowrap",e.textContent="ABCDEFGHIJKLMNOPQRSTUVWXYZ",document.body.appendChild(e);const n=e.getBoundingClientRect().height;return document.body.removeChild(e),n}(t),i=.5*(e.height-s),l={x:(e.left-n.left)*o,y:(e.top-n.top+i)*o,width:e.width*o,height:s*o};l.width>0&&l.height>0&&l.x<a.width&&l.y<a.height&&l.x+l.width>0&&l.y+l.height>0&&$.push(l)}let L=0,R=1;const F={industrialTeal:{label:"Industrial Teal",colors:["#b7bcb7","#e4e9e4","#ffffff","#00695c","#000000","#ff4013","#0d5cb6","#ffa000"]},modern:{label:"Modern European",colors:["#9ca3af","#d1d5db","#ffffff","#ff3b30","#000000","#00e5ff","#1976d2","#ffc107"]},corporate:{label:"Corporate Modern",colors:["#a0a8b1","#d2d8de","#ffffff","#1a73e8","#000000","#ff5722","#7b1fa2","#ffa000"]},minimal:{label:"Helvetica Minimal",colors:["#bdbdbd","#e0e0e0","#ffffff","#6b7280","#000000","#40e0d0","#303f9f","#ff9800"]},euroBlue:{label:"European Blue",colors:["#9aa6b2","#d4dde5","#ffffff","#0a66c2","#000000","#ff4081","#388e3c","#ffb300"]},scandi:{label:"Scandinavian Bright",colors:["#aab2b7","#e6eaee","#ffffff","#74b9ff","#000000","#e91e63","#1976d2","#4caf50"]},neonCyan:{label:"Graphite Neon Cyan",colors:["#9aa0a6","#d5d9dd","#ffffff","#00e5ff","#000000","#ff9800","#9c27b0","#4caf50"]},coralTech:{label:"Coral Tech",colors:["#9da3a9","#d8dde2","#ffffff","#ff6b6b","#000000","#00e676","#3f51b5","#ff5722"]},violetMidnight:{label:"Violet Midnight",colors:["#9fa3b1","#d9dce3","#ffffff","#7c3aed","#000000","#e91e63","#388e3c","#ffb300"]},mintSage:{label:"Mint Sage",colors:["#a0a7a2","#dbe0dd","#ffffff","#00c896","#000000","#ff1744","#3f51b5","#ff9800"]},slateAzure:{label:"Slate Azure",colors:["#9aa3ad","#d8dee6","#ffffff","#3b82f6","#000000","#ff4081","#388e3c","#ffc107"]},vaporPop:{label:"Vapor Pop",colors:["#9ea0a8","#d6d7dc","#ffffff","#ff00e5","#000000","#00bcd4","#673ab7","#ff5722"]},cyberMagenta:{label:"Cyber Magenta",colors:["#9c9fad","#d6d9e3","#ffffff","#ff007a","#000000","#40e0d0","#1976d2","#ff9800"]},streetLime:{label:"Street Lime",colors:["#9aa19a","#d6dbd6","#ffffff","#baff00","#000000","#e91e63","#3f51b5","#ff6f00"]},cmykPop:{label:"CMYK Pop",colors:["#9f9f9f","#d9d9d9","#ffffff","#ffd400","#000000","#ff1744","#7b1fa2","#4caf50"]}};let V="industrialTeal",N=["#b7bcb7","#e4e9e4","#ffffff","#00695c","#000000","#ff4013","#0d5cb6","#ffa000"],U=5,P=N[U]||"#ff4013";function z(t=N){try{const e=document.documentElement,n=(t&&t.length?t:N).slice(0,8);for(let t=0;t<8;t++){const a=n[t]||"#ffffff";e.style.setProperty(`--ball-${t+1}`,a)}}catch(t){}}const k=[.5,.25,.12,.06,.03,.02,.01,.01];function O(){try{if(!N||0===N.length)return console.warn("No colors available, using fallback"),"#ffffff";const t=Math.random();let e=0;for(let n=0;n<Math.min(N.length,k.length);n++)if(e+=k[n],t<=e)return N[n];return N[Math.min(N.length-1,7)]}catch(t){return console.error("Error picking random color:",t),"#ffffff"}}let G=255,W=274e3,H=4.4,_=t,D=t,Y=!1;const j=1e3;let X=0;const J="#hero-text";let $=[],K=.025,Q=1.8,Z=0,tt=0,et=0,nt=0,at=0;const st=document.getElementById("render-fps"),it=document.getElementById("physics-fps");class ot{constructor(t,e,n,a){this.x=t,this.y=e,this.vx=200*(2*Math.random()-1),this.vy=200*-Math.random(),this.r=n,this.m=E,this.color=a,this.t=0,this.age=0,this.driftAx=0,this.driftTime=0,this.omega=0,this.squash=1,this.squashDirX=1,this.squashDirY=0,this.theta=0,this.squashAmount=0,this.squashNormalAngle=0}step(t){this.t+=t,this.age+=t,this.vy+=2156*w*t;const e=Math.max(.25,this.m/1),n=Math.max(0,1-f/e);this.vx*=n,this.vy*=n,0!==this.driftAx&&this.age<this.driftTime?this.vx+=this.driftAx*t/e:0!==this.driftAx&&(this.driftAx=0),function(t,e){if(!Y)return;if(W<=0||G<=0)return;const n=G*o,a=t.x-_,s=t.y-D,i=a*a+s*s;if(i>n*n)return;const l=Math.max(Math.sqrt(i),1e-4),h=a/l,r=s/l,c=Math.max(0,1-l/n),d=20*W*Math.pow(c,H),u=Math.max(.25,t.m/1);t.vx+=h*d*e/u,t.vy+=r*d*e/u}(this,t),this.x+=this.vx*t,this.y+=this.vy*t;const a=Math.max(0,1-2*t);this.omega*=a,this.theta+=this.omega*t,this.theta>Math.PI?this.theta-=2*Math.PI:this.theta<-Math.PI&&(this.theta+=2*Math.PI);const s=Math.min(1,18*t);this.squashAmount+=(0-this.squashAmount)*s,this.squash=1-this.squashAmount}walls(t,a,s){if(0===X){if(this.y+this.r>a){this.y=a-this.r;const t=this.vy,i=this.vx-this.omega*this.r,o=Math.max(.25,this.m/1);this.omega+=i/this.r*e/o;const l=Math.max(0,1-1.5*s/o);this.vx*=l;const h=Math.abs(t)<70?0:u;this.vy=-this.vy*(h*Math.pow(1/this.m,I));const r=Math.min(1,Math.abs(t)/(90*this.r));this.squashAmount=Math.min(n,.8*r),this.squash=1-this.squashAmount,this.squashNormalAngle=-Math.PI/2;const c=this.vx/this.r;this.omega+=(c-this.omega)*Math.min(1,8*s)}if(this.vy>0&&this.y-this.r<0){this.y=this.r;const t=this.vy;this.vy=-this.vy*u;const e=Math.min(1,Math.abs(t)/(90*this.r));this.squashAmount=Math.min(n,.8*e),this.squash=1-this.squashAmount,this.squashNormalAngle=Math.PI/2}if(this.x+this.r>t){this.x=t-this.r;{const t=this.vy-this.omega*this.r,e=Math.max(.25,this.m/1);this.omega+=t/this.r*.125/e}this.vx=-this.vx*u;const e=Math.min(1,Math.abs(this.vx)/(90*this.r));this.squashAmount=Math.min(n,.8*e),this.squash=1-this.squashAmount,this.squashNormalAngle=Math.PI}if(this.x-this.r<0){this.x=this.r;{const t=this.vy-this.omega*this.r,e=Math.max(.25,this.m/1);this.omega+=t/this.r*.125/e}this.vx=-this.vx*u;const t=Math.min(1,Math.abs(this.vx)/(90*this.r));this.squashAmount=Math.min(n,.8*t),this.squash=1-this.squashAmount,this.squashNormalAngle=0}}else this.handleRoundedWallCollision(t,a);this.checkTextCollisions(s)}checkTextCollisions(t){for(let t=0;t<$.length;t++){const e=$[t],a=Math.max(e.x,Math.min(this.x,e.x+e.width)),s=Math.max(e.y,Math.min(this.y,e.y+e.height)),i=this.x-a,o=this.y-s,l=Math.sqrt(i*i+o*o);if(l<this.r)if(0===l){const t=this.x-e.x,n=e.x+e.width-this.x,a=this.y-e.y,s=e.y+e.height-this.y,i=Math.min(t,n,a,s);i===t?(this.x=e.x-this.r,this.vx=-Math.abs(this.vx)*u):i===n?(this.x=e.x+e.width+this.r,this.vx=Math.abs(this.vx)*u):i===a?(this.y=e.y-this.r,this.vy=-Math.abs(this.vy)*u):(this.y=e.y+e.height+this.r,this.vy=Math.abs(this.vy)*u)}else{const t=this.r-l,e=i/l,a=o/l;this.x+=e*t,this.y+=a*t;const s=this.vx*e+this.vy*a;if(s<0){this.vx-=2*s*e*u,this.vy-=2*s*a*u;const t=Math.min(1,Math.abs(s)/(70*this.r));this.squash=1-n*t,this.squashDirX=Math.abs(e)>Math.abs(a)?1:0,this.squashDirY=Math.abs(a)>Math.abs(e)?1:0}}}}handleRoundedWallCollision(t,e){const a=X,s=[{x:a,y:a},{x:t-a,y:a},{x:t-a,y:e-a},{x:a,y:e-a}];for(let i=0;i<s.length;i++){const o=s[i],l=this.x-o.x,h=this.y-o.y,r=Math.sqrt(l*l+h*h);if(this.isInCornerRegion(o,t,e,a)&&r+this.r>a){const t=a-(r-this.r);if(t>0&&r>0){const e=l/r,a=h/r;this.x+=e*t,this.y+=a*t;const s=this.vx*e+this.vy*a;this.vx-=2*s*e*u,this.vy-=2*s*a*u;const i=Math.min(1,Math.abs(s)/(90*this.r));this.squashAmount=Math.min(n,.8*i),this.squash=1-this.squashAmount,this.squashNormalAngle=Math.atan2(a,e)}}}if(this.y+this.r>e&&(this.x<a||this.x>t-a)&&(this.y=e-this.r,this.vy=-this.vy*(u*Math.pow(1/this.m,I))),this.y-this.r<0&&(this.x<a||this.x>t-a)&&(this.y=this.r,this.vy=-this.vy*u),this.x+this.r>t&&(this.y<a||this.y>e-a)){this.x=t-this.r;{const t=this.vy-this.omega*this.r,e=Math.max(.25,this.m/1);this.omega+=t/this.r*.125/e}this.vx=-this.vx*(u*Math.pow(1/this.m,I));const e=Math.min(1,Math.abs(this.vx)/(70*this.r));this.squashAmount=Math.min(n,e),this.squash=1-this.squashAmount,this.squashNormalAngle=Math.PI}if(this.x-this.r<0&&(this.y<a||this.y>e-a)){this.x=this.r;{const t=this.vy-this.omega*this.r,e=Math.max(.25,this.m/1);this.omega+=t/this.r*.125/e}this.vx=-this.vx*(u*Math.pow(1/this.m,I));const t=Math.min(1,Math.abs(this.vx)/(70*this.r));this.squashAmount=Math.min(n,t),this.squash=1-this.squashAmount,this.squashNormalAngle=0}this.y+this.r>e&&this.x>=a&&this.x<=t-a&&(this.y=e-this.r,this.vy=-this.vy*(u*Math.pow(1/this.m,I))),this.y-this.r<0&&this.x>=a&&this.x<=t-a&&(this.y=this.r,this.vy=-this.vy*(u*Math.pow(1/this.m,I))),this.x+this.r>t&&this.y>=a&&this.y<=e-a&&(this.x=t-this.r,this.vx=-this.vx*(u*Math.pow(1/this.m,I))),this.x-this.r<0&&this.y>=a&&this.y<=e-a&&(this.x=this.r,this.vx=-this.vx*(u*Math.pow(1/this.m,I)))}isInCornerRegion(t,e,n,a){return t.x===a&&t.y===a?this.x<=a&&this.y<=a:t.x===e-a&&t.y===a?this.x>=e-a&&this.y<=a:t.x===e-a&&t.y===n-a?this.x>=e-a&&this.y>=n-a:t.x===a&&t.y===n-a&&this.x<=a&&this.y>=n-a}draw(t){t.save(),t.translate(this.x,this.y);const e=Math.min(n,Math.max(0,this.squashAmount));if(e>.001){const n=1+e,a=1/n;t.rotate(this.squashNormalAngle),t.scale(n,a),t.rotate(-this.squashNormalAngle)}t.beginPath(),t.arc(0,0,this.r,0,2*Math.PI),t.fillStyle=this.color,t.fill(),t.restore()}}const lt=[];function ht(t,e,n){return Math.max(e,Math.min(n,t))}function rt(t,e){return t+Math.random()*(e-t)}function ct(t,e,n=O()){const s=(S+T)/2;let i;if(0===M)i=s;else{const t=(T-S)/2*M;i=rt(Math.max(1,s-t),s+t)}const o=new ot(t,e,i,n),l=(a.width,R>=0?1:-1),h=ht(i/(.5*(S+T)),.6,1.4),r=140*h,c=180*h;return o.vx=l*(r+Math.random()*c),o.vy=120*-Math.random(),o.driftAx=l*(360+420*Math.random())*h,o.driftTime=.22+.28*Math.random(),lt.push(o),o}let dt=0;function ut(){const t=a.clientWidth,e=a.clientHeight,n=ht(r/100*t,0,t);let s=ht(l/100*t,0,t);{const e=.2*t,n=s;s=ht(s+Math.sin(L)*e,0,t),R=s>=n?1:-1}const i=Math.min(40,.1*n),d=ht(s-n/2-i,-i,t),u=ht(s+n/2+i,-i,t),f=h/100*e,m=f+c/100*e,x=Math.random();return{x:(d+(u-d)*(R>0?Math.pow(x,.7):1-Math.pow(1-x,.7)))*o,y:rt(f*o,m*o)-(T+2+rt(0,10*o))}}const ft=new Map;function mt(t=6){const e=function(){const t=lt.length;if(t<2)return[];const e=Math.max(1,2*T),n=Math.ceil(a.width/e)+1;ft.clear();for(let a=0;a<t;a++){const t=lt[a],s=t.x/e|0,i=(t.y/e|0)*n+s;let o=ft.get(i);o||(o=[],ft.set(i,o)),o.push(a)}const s=[];for(const[t,e]of ft){const a=t/n|0,i=t%n;for(let t=-1;t<=1;t++)for(let o=-1;o<=1;o++){const l=(a+t)*n+(i+o),h=ft.get(l);if(h)for(let t=0;t<e.length;t++){const n=e[t];for(let t=0;t<h.length;t++){const e=h[t];if(e<=n)continue;const a=lt[n],i=lt[e],o=i.x-a.x,l=i.y-a.y,r=a.r+i.r,c=o*o+l*l;if(c<r*r){const t=r-Math.sqrt(Math.max(c,1e-6));s.push({i:n,j:e,overlap:t})}}}}}return s.sort((t,e)=>e.overlap-t.overlap),s}();for(let a=0;a<t;a++)for(let t=0;t<e.length;t++){const{i:a,j:s}=e[t],i=lt[a],o=lt[s],l=o.x-i.x,h=o.y-i.y,r=i.r+o.r,c=l*l+h*h;if(0===c||c>r*r)continue;const d=Math.sqrt(c),f=l/d,m=h/d,x=r-d,y=1/Math.max(i.m,.001),g=1/Math.max(o.m,.001),v=.8*Math.max(x-p,0)/(y+g),M=v*f,b=v*m;i.x-=M*y,i.y-=b*y,o.x+=M*g,o.y+=b*g;const C=o.vx-i.vx,E=o.vy-i.vy,I=C*f+E*m;if(I<0){const t=-(1+(Math.abs(I)<30?0:u))*I/(y+g),e=t*f,a=t*m;i.vx-=e*y,i.vy-=a*y,o.vx+=e*g,o.vy+=a*g;const s=C-I*f,l=E-I*m,h=Math.hypot(s,l);if(h>.001){const t=s*-m+l*f>=0?1:-1,e=.18;i.omega-=t*e*h/Math.max(i.r,1),o.omega+=t*e*h/Math.max(o.r,1)}const r=Math.min(1,Math.abs(I)/(50*(i.r+o.r))),c=Math.min(n,.8*r);i.squashAmount=Math.max(i.squashAmount,.8*c),i.squashNormalAngle=Math.atan2(-m,-f),o.squashAmount=Math.max(o.squashAmount,.8*c),o.squashNormalAngle=Math.atan2(m,f)}}}let xt=performance.now()/1e3,pt=0;const yt=1/120;console.log("High refresh mode enabled - using requestAnimationFrame"),requestAnimationFrame(function e(n){const i=n/1e3;let o=Math.min(.008,i-xt);xt=i,pt+=o,Z++,(st||it)&&i-et>=1&&(st&&Z!==nt&&(nt=Z,st.textContent=nt.toString()),it&&tt!==at&&(at=tt,it.textContent=at.toString()),Z=0,tt=0,et=i),function(t){for(dt+=t;dt>=m;){const t=(Math.random()-.5)*m*.5;dt-=m+t,L+=2*Math.PI*.12*(m+t);const e=ut(),n=Math.random()<.35?3:1;for(let t=0;t<n;t++)if(lt.length<x){const n=8*t*(Math.random()<.5?1:-1);ct(e.x+n,e.y-12*t)}}}(o),Z%60==0&&A();let l=0;for(;pt>=yt&&l<2;){for(let t=0;t<lt.length;t++)lt[t].step(yt);mt(3);for(let t=0;t<lt.length;t++)lt[t].walls(a.width,a.height,yt);pt-=yt,l++,tt++}if(pt>3*yt&&(pt=0),K>0&&Q>0){const t=1.5,e=3,n=.35;let i=1+(n+(.0015-n)*Math.max(0,Math.min(1,K/t))-1)*Math.max(0,Math.min(1,Q/e));i=Math.max(.001,Math.min(1,i)),s.fillStyle=`rgba(0,0,0,${i})`,s.globalCompositeOperation="destination-out",s.fillRect(0,0,a.width,a.height),s.globalCompositeOperation="source-over"}else s.clearRect(0,0,a.width,a.height);X>0&&function(t,e,n){const a=X;t.strokeStyle="rgba(255, 255, 255, 0.1)",t.lineWidth=2,t.beginPath(),t.moveTo(a,0),t.lineTo(e-a,0),t.arcTo(e,0,e,a,a),t.lineTo(e,n-a),t.arcTo(e,n,e-a,n,a),t.lineTo(a,n),t.arcTo(0,n,0,n-a,a),t.lineTo(0,a),t.arcTo(0,0,a,0,a),t.closePath(),t.stroke()}(s,a.width,a.height);for(let t=0;t<lt.length;t++)lt[t].draw(s);!function(e){if(_===t||D===t)return;const n=_,a=D,s=(S+T)/2,i=P;e.beginPath(),e.arc(n,a,s,0,2*Math.PI),e.fillStyle=i,e.fill()}(s),requestAnimationFrame(e)}),window.addEventListener("keydown",t=>{const e=t.key.toLowerCase();"r"===e&&(function(){for(let t=0;t<lt.length;t++){const e=lt[t],n=ut();e.x=n.x,e.y=n.y,a.width;const s=R>=0?1:-1,i=ht(e.r/(.5*(S+T)),.6,1.4),o=140*i,l=180*i,h=120;e.vx=s*(o+Math.random()*l),e.vy=-Math.random()*h,e.age=0,e.driftAx=s*(360+420*Math.random())*i,e.driftTime=.22+.28*Math.random()}}(),t.preventDefault()),"/"===e&&i&&(t.preventDefault(),i.classList.toggle("hidden"))}),function(t=160){for(let e=0;e<t&&lt.length<x;e++){const t=ut();ct(t.x,t.y)}}(200),a.addEventListener("mousemove",t=>{const e=a.getBoundingClientRect();_=(t.clientX-e.left)*o,D=(t.clientY-e.top)*o,W>0&&G>0&&(Y=!0)}),a.addEventListener("mouseleave",()=>{_=t,D=t});const gt=document.getElementById("restitutionSlider"),vt=document.getElementById("frictionSlider"),Mt=document.getElementById("emitterSlider"),bt=document.getElementById("sizeSlider"),Ct=document.getElementById("maxBallsSlider"),Et=document.getElementById("sizeVariationSlider"),It=document.getElementById("weightSlider"),wt=document.getElementById("spawnYSlider"),Bt=document.getElementById("spawnWidthSlider"),St=document.getElementById("spawnCenterSlider"),Tt=document.getElementById("spawnHeightSlider"),qt=document.getElementById("repelSizeSlider"),At=document.getElementById("repelPowerSlider"),Lt=document.getElementById("repelSoftSlider"),Rt=document.getElementById("colorSelect"),Ft=document.getElementById("color1"),Vt=document.getElementById("color2"),Nt=document.getElementById("color3"),Ut=document.getElementById("color4"),Pt=document.getElementById("color5"),zt=document.getElementById("color6"),kt=document.getElementById("color7"),Ot=document.getElementById("color8"),Gt=document.getElementById("cursorColorSelect"),Wt=document.getElementById("color1Val"),Ht=document.getElementById("color2Val"),_t=document.getElementById("color3Val"),Dt=document.getElementById("color4Val"),Yt=document.getElementById("color5Val"),jt=document.getElementById("color6Val"),Xt=document.getElementById("color7Val"),Jt=document.getElementById("color8Val");[Wt,Ht,_t,Dt,Yt,jt,Xt,Jt].forEach(t=>{t&&t.setAttribute("title","Click to copy")});const $t=document.getElementById("cornerRadiusSlider"),Kt=document.getElementById("cornerRadiusVal"),Qt=document.getElementById("trailFadeSlider"),Zt=document.getElementById("trailFadeVal"),te=document.getElementById("trailSubtletySlider"),ee=document.getElementById("trailSubtletyVal"),ne=document.getElementById("restitutionVal"),ae=document.getElementById("frictionVal"),se=document.getElementById("emitterVal"),ie=document.getElementById("sizeVal"),oe=document.getElementById("maxBallsVal"),le=document.getElementById("sizeVariationVal"),he=document.getElementById("weightVal"),re=document.getElementById("spawnYVal"),ce=document.getElementById("spawnWidthVal"),de=document.getElementById("spawnCenterVal"),ue=document.getElementById("spawnHeightVal"),fe=document.getElementById("repelSizeVal"),me=document.getElementById("repelPowerVal"),xe=document.getElementById("repelSoftVal");function pe(){return{gravityMultiplier:1.1,restitution:u,friction:f,ballMass:E,emitRate:m,maxBalls:x,ballScale:v,ballVariation:M,spawnX:l,spawnY:h,spawnWidth:r,spawnHeight:c,sweepEnabled:true,repelRadius:G,repelPower:W,repelSoftness:H,trailFade:K,trailSubtlety:Q,colors:N.slice(),colorWeights:k.slice(),currentTemplate:V,cursorColorIndex:U}}const ye=document.getElementById("saveConfigBtn"),ge=document.getElementById("buildBtn"),ve=document.getElementById("configOutput");function Me(t,e){t&&t.addEventListener("click",async()=>{const n="function"==typeof e?e():String(e||"").trim();try{await navigator.clipboard.writeText(n);const e=t.textContent;t.textContent="COPIED",t.style.color="#3ddc84",setTimeout(()=>{t.textContent=e,t.style.color="#888"},900)}catch(t){console.warn("Clipboard unavailable")}})}function be(){const t=(S+T)/2;for(let e=0;e<lt.length;e++){const n=lt[e];if(0===M)n.r=t;else{const e=(T-S)/2*M,a=Math.max(1,t-e),s=t+e;n.r=rt(a,s)}n.m=E}}function Ce(){for(let t=0;t<lt.length;t++)lt[t].color=O()}ye&&ge&&ve&&(ye.addEventListener("click",()=>{const t=(e=pe(),`// Generated configuration from frontend\nconst CONFIG = ${JSON.stringify(e,null,2)};`);var e;ve.style.display="block",ve.textContent=t,navigator.clipboard.writeText(t).then(()=>{const t=ye.textContent;ye.textContent="✅ Copied!",setTimeout(()=>{ye.textContent=t},1200)}).catch(()=>{console.warn("Clipboard copy failed");const t=ye.textContent;ye.textContent="⚠️ Copy failed",setTimeout(()=>{ye.textContent=t},1200)})}),ge.addEventListener("click",()=>{const t=pe();ve.style.display="block",ve.innerHTML="\n<strong>🚀 Build Instructions:</strong><br>\n1. Run: <code>npm run build</code><br>\n2. Your current config will be baked into balls-embed.min.html";const e=new Blob([JSON.stringify(t,null,2)],{type:"application/json"}),n=URL.createObjectURL(e),a=document.createElement("a");a.href=n,a.download="current-config.json",a.click(),URL.revokeObjectURL(n)})),gt&&gt.addEventListener("input",()=>{u=parseFloat(gt.value),ne&&(ne.textContent=u.toFixed(2))}),vt&&vt.addEventListener("input",()=>{f=parseFloat(vt.value),ae&&(ae.textContent=f.toFixed(4))}),Mt&&Mt.addEventListener("input",()=>{m=parseFloat(Mt.value),se&&(se.textContent=m.toFixed(3))}),bt&&bt.addEventListener("input",()=>{const t=parseFloat(bt.value);ie&&(ie.textContent=t.toFixed(1)),v=t,q();for(let t=0;t<lt.length;t++)lt[t].m=E}),Ct&&Ct.addEventListener("input",()=>{x=parseInt(Ct.value,10),oe&&(oe.textContent=x.toString()),lt.length>x&&(lt.length=x)}),Et&&Et.addEventListener("input",()=>{M=parseFloat(Et.value),le&&(le.textContent=M.toFixed(1)),be()}),It&&It.addEventListener("input",()=>{E=parseFloat(It.value),he&&(he.textContent=E.toFixed(2));for(let t=0;t<lt.length;t++)lt[t].m=E;B()}),wt&&wt.addEventListener("input",()=>{h=parseFloat(wt.value),re&&(re.textContent=h.toFixed(0)),d()}),Bt&&Bt.addEventListener("input",()=>{r=parseFloat(Bt.value),ce&&(ce.textContent=r.toFixed(0))}),St&&St.addEventListener("input",()=>{l=parseFloat(St.value),de&&(de.textContent=l.toFixed(0))}),Tt&&Tt.addEventListener("input",()=>{c=parseFloat(Tt.value),ue&&(ue.textContent=c.toFixed(0))}),qt&&qt.addEventListener("input",()=>{G=parseFloat(qt.value),fe&&(fe.textContent=G.toFixed(0)),Y=Y||W>0&&G>0}),At&&At.addEventListener("input",()=>{W=function(t){const e=Math.max(0,Math.min(j,Number(t)))/j;return 2*Math.pow(2,12*(e-.5))*12e3}(At.value),me&&(me.textContent=Math.round(W).toString()),qe&&"off"!==qe.value&&(Y=W>0&&G>0)}),Lt&&Lt.addEventListener("input",()=>{H=parseFloat(Lt.value),xe&&(xe.textContent=H.toFixed(1))}),Rt&&Rt.addEventListener("change",()=>{const t=F[Rt.value];t&&(V=Rt.value,N=t.colors.slice(),P=N[U]||P,Ft&&Wt&&(Ft.value=N[0],Wt.textContent=N[0].toUpperCase()),Vt&&Ht&&(Vt.value=N[1],Ht.textContent=N[1].toUpperCase()),Nt&&_t&&(Nt.value=N[2],_t.textContent=N[2].toUpperCase()),Ut&&Dt&&(Ut.value=N[3],Dt.textContent=N[3].toUpperCase()),Pt&&Yt&&(Pt.value=N[4],Yt.textContent=N[4].toUpperCase()),zt&&jt&&(zt.value=N[5],jt.textContent=N[5].toUpperCase()),kt&&Xt&&(kt.value=N[6],Xt.textContent=N[6].toUpperCase()),Ot&&Jt&&(Ot.value=N[7],Jt.textContent=N[7].toUpperCase()),Ce(),z())}),Ft&&Ft.addEventListener("input",()=>{N[0]=Ft.value,Wt&&(Wt.textContent=Ft.value.toUpperCase()),Ce(),z()}),Vt&&Vt.addEventListener("input",()=>{N[1]=Vt.value,Ht&&(Ht.textContent=Vt.value.toUpperCase()),Ce(),z()}),Nt&&Nt.addEventListener("input",()=>{N[2]=Nt.value,_t&&(_t.textContent=Nt.value.toUpperCase()),Ce(),z()}),Ut&&Ut.addEventListener("input",()=>{N[3]=Ut.value,Dt&&(Dt.textContent=Ut.value.toUpperCase()),Ce(),z()}),Pt&&Pt.addEventListener("input",()=>{N[4]=Pt.value,Yt&&(Yt.textContent=Pt.value.toUpperCase()),Ce(),z()}),zt&&zt.addEventListener("input",()=>{N[5]=zt.value,jt&&(jt.textContent=zt.value.toUpperCase()),Ce(),z()}),kt&&kt.addEventListener("input",()=>{N[6]=kt.value,Xt&&(Xt.textContent=kt.value.toUpperCase()),Ce(),z()}),Ot&&Ot.addEventListener("input",()=>{N[7]=Ot.value,Jt&&(Jt.textContent=Ot.value.toUpperCase()),Ce(),z()}),Gt&&Gt.addEventListener("change",()=>{const t=Math.max(1,Math.min(8,parseInt(Gt.value,10)))-1;U=t,P=N[U]||P}),Me(Wt,()=>Ft.value.toUpperCase()),Me(Ht,()=>Vt.value.toUpperCase()),Me(_t,()=>Nt.value.toUpperCase()),Me(Dt,()=>Ut.value.toUpperCase()),Me(Yt,()=>Pt.value.toUpperCase()),Me(jt,()=>zt.value.toUpperCase()),Me(Xt,()=>kt.value.toUpperCase()),Me(Jt,()=>Ot.value.toUpperCase()),$t&&$t.addEventListener("input",()=>{X=parseFloat($t.value),Kt&&(Kt.textContent=X.toFixed(0))}),Qt&&Qt.addEventListener("input",()=>{K=parseFloat(Qt.value),Zt&&(Zt.textContent=K.toFixed(3))}),te&&te.addEventListener("input",()=>{Q=parseFloat(te.value),ee&&(ee.textContent=Q.toFixed(2)+"×")});const Ee={rubberPlayground:{label:"Rubber – Playground",G:1960,REST:.9,FRICTION:.0025,sizeScale:1.8,maxBalls:450,sizeVariation:.2},rubberRacquet:{label:"Rubber – Racquetball",G:3320,REST:.97,FRICTION:.0035,sizeScale:2.1,maxBalls:350,sizeVariation:.3},rubberSuperball:{label:"Rubber – Superball",G:1960,REST:.95,FRICTION:.0015,sizeScale:1.2,maxBalls:450,sizeVariation:.05},rubberSoft:{label:"Rubber – Soft",G:1960,REST:.86,FRICTION:.0035,sizeScale:2.2,maxBalls:350,sizeVariation:.25},rubberHeavy:{label:"Rubber – Heavy",G:1960,REST:.88,FRICTION:.003,sizeScale:2,maxBalls:400,sizeVariation:.15}},Ie={fullRain:{label:"Full Rain (top-half)",EMIT_INTERVAL:.03,xCenter:50,y:-50,w:100,h:50},narrowStrip:{label:"Narrow Strip Top",EMIT_INTERVAL:.05,xCenter:50,y:-40,w:20,h:10},leftGutter:{label:"Left Gutter",EMIT_INTERVAL:.045,xCenter:10,y:-60,w:18,h:20},rightGutter:{label:"Right Gutter",EMIT_INTERVAL:.045,xCenter:90,y:-60,w:18,h:20},centerFountain:{label:"Center Fountain",EMIT_INTERVAL:.02,xCenter:50,y:-30,w:30,h:20},stormBurst:{label:"Storm Burst",EMIT_INTERVAL:.005,xCenter:50,y:-80,w:100,h:30},slowSnow:{label:"Slow Snow",EMIT_INTERVAL:.2,xCenter:50,y:-30,w:100,h:20},edgeDrizzle:{label:"Edge Drizzle",EMIT_INTERVAL:.08,xCenter:15,y:-40,w:30,h:15},twinColumns:{label:"Twin Columns",EMIT_INTERVAL:.03,xCenter:30,y:-50,w:10,h:40},focusedBeam:{label:"Focused Beam",EMIT_INTERVAL:.015,xCenter:50,y:-70,w:6,h:12}},we={off:{label:"Off",r:710,p:274e3,s:4.4},gentle:{label:"Gentle Breeze",r:120,p:2500,s:2.5},pushField:{label:"Push Field",r:240,p:8e4,s:2},tractor:{label:"Tractor Push",r:320,p:14e4,s:1.6},magnet:{label:"Magnet Repel",r:200,p:18e4,s:3},pulse:{label:"Pulse Strong",r:280,p:22e4,s:1.2},wideSoft:{label:"Wide Soft",r:500,p:8e4,s:4.5},needle:{label:"Needle Point",r:80,p:26e4,s:.8},wall:{label:"Invisible Wall",r:700,p:16e4,s:5},singularity:{label:"Singularity",r:600,p:3e5,s:.5}};function Be(t,e,n){t.innerHTML="";for(const[a,s]of Object.entries(e)){const e=document.createElement("option");e.value=a,e.textContent=s.label||a,a===n&&(e.selected=!0),t.appendChild(e)}}const Se=document.getElementById("physicsSelect"),Te=document.getElementById("spawnSelect"),qe=document.getElementById("repellerSelect");function Ae(t,e,n,a=0){t&&(t.value=String(n)),e&&(e.textContent=a>0?n.toFixed(a):n.toString())}function Le(t){const e=Ee[t];if(!e)return;u=e.REST,f=e.FRICTION,x=e.maxBalls,M=e.sizeVariation;const n=e.sizeScale;v=n,q();for(let t=0;t<lt.length;t++)lt[t].m=E;lt.length>x&&(lt.length=x),Ae(gt,ne,u,2),Ae(vt,ae,f,4),Ae(bt,ie,v,1),Ae(Ct,oe,x,0),Ae(Et,le,M,1),be()}function Re(t){const e=Ie[t];e&&(m=e.EMIT_INTERVAL,l=e.xCenter,h=e.y,r=e.w,c=e.h,Ae(Mt,se,m,3),Ae(St,de,l,0),Ae(wt,re,h,0),Ae(Bt,ce,r,0),Ae(Tt,ue,c,0))}function Fe(t){const e=we[t];if(!e)return;G=e.r,W=1*e.p,Y="off"!==t,Ae(qt,fe,G,0);const n=function(t){const e=Math.max(1,Number(t))/24e3,n=.5+Math.log2(e)/12;return Math.round(Math.max(0,Math.min(1,n))*j)}(W);At&&(At.value=String(n)),me&&(me.textContent=Math.round(W).toString()),Ae(Lt,xe,H,1)}Se&&Be(Se,Ee,"rubberRacquet"),Te&&Be(Te,Ie,"fullRain"),qe&&Be(qe,we,"off"),Rt&&Be(Rt,F,"industrialTeal"),Le("rubberRacquet"),Re("fullRain"),Fe("off");const Ve=F[V];Ft&&Wt&&(Ft.value=Ve.colors[0],Wt.textContent=Ve.colors[0].toUpperCase()),Vt&&Ht&&(Vt.value=Ve.colors[1],Ht.textContent=Ve.colors[1].toUpperCase()),Nt&&_t&&(Nt.value=Ve.colors[2],_t.textContent=Ve.colors[2].toUpperCase()),Ut&&Dt&&(Ut.value=Ve.colors[3],Dt.textContent=Ve.colors[3].toUpperCase()),Pt&&Yt&&(Pt.value=Ve.colors[4],Yt.textContent=Ve.colors[4].toUpperCase()),zt&&jt&&(zt.value=Ve.colors[5],jt.textContent=Ve.colors[5].toUpperCase()),kt&&Xt&&(kt.value=Ve.colors[6],Xt.textContent=Ve.colors[6].toUpperCase()),Ot&&Jt&&(Ot.value=Ve.colors[7],Jt.textContent=Ve.colors[7].toUpperCase()),z(Ve.colors),Se&&Se.addEventListener("change",()=>Le(Se.value)),Te&&Te.addEventListener("change",()=>Re(Te.value)),qe&&qe.addEventListener("change",()=>Fe(qe.value)),q(),A()})();