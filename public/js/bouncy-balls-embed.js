(()=>{const t="pit",e="flies",n="trail",o="weightless",i="boulders",a={[t]:{desktop:!0,mobile:!0},[e]:{desktop:!0,mobile:!0},[n]:{desktop:!0,mobile:!1},[o]:{desktop:!0,mobile:!0},[i]:{desktop:!0,mobile:!0}};let s=t,l=40,r=1.1,d=!0,h=1e3,c=150,u=1,m=3,f=1.5,g=100,p=50,y=.6,x=[],v=400,E=.98,M=300,b=800,I=120,w=1,B=.3,S=1.2,C=.3,V=.95;const L=-1e9,R=1e-4,F=.25;function T(){return 0===l?0:l/40*.2}const q=document.getElementById("c"),P=q.getContext("2d",{alpha:!0}),A=document.getElementById("controlPanel"),k=Math.max(1,Math.min(2,window.devicePixelRatio||1));let z=50,N=-50,U=100,G=50;function D(){const t=1.5*window.innerHeight;q.width=Math.floor(window.innerWidth*k),q.height=Math.floor(t*k)}D(),window.addEventListener("resize",()=>{D(),rt(),dt()});const O=1960;let W=1.1,H=O*W,_=.88,Y=.003,j=.03,Z=400;const X=.5*k,J=6,K=24;let $=1,Q=.15,tt=1,et=null,nt=11.2;const ot=.15;let it=1;function at(){it=Math.max(.5,Math.min(3,Math.pow(nt/1,.35)))}at();let st=J*$,lt=K*$;function rt(){tt=(q.clientWidth||window.innerWidth)<=768?.4:1;const t=$*tt;if(null===et)return et=t,st=J*t,void(lt=K*t);const e=t/et;if(1!==e){for(let t=0;t<_t.length;t++)s!==i&&(_t[t].r*=e);et=t}st=J*t,lt=K*t}function dt(){Pt=[];const t=document.querySelector(qt);if(!t)return;const e=t.getBoundingClientRect(),n=q.getBoundingClientRect(),o=function(t){const e=document.createElement("span");e.style.cssText=window.getComputedStyle(t).cssText,e.style.position="absolute",e.style.visibility="hidden",e.style.whiteSpace="nowrap",e.textContent="ABCDEFGHIJKLMNOPQRSTUVWXYZ",document.body.appendChild(e);const n=e.getBoundingClientRect().height;return document.body.removeChild(e),n}(t),i=.5*(e.height-o),a={x:(e.left-n.left)*k,y:(e.top-n.top+i)*k,width:e.width*k,height:o*k};a.width>0&&a.height>0&&a.x<q.width&&a.y<q.height&&a.x+a.width>0&&a.y+a.height>0&&Pt.push(a)}let ht=!0,ct=0,ut=1;const mt={industrialTeal:{label:"Industrial Teal",colors:["#b7bcb7","#e4e9e4","#ffffff","#00695c","#000000","#ff4013","#0d5cb6","#ffa000"]},modern:{label:"Modern European",colors:["#9ca3af","#d1d5db","#ffffff","#ff3b30","#000000","#00e5ff","#1976d2","#ffc107"]},corporate:{label:"Corporate Modern",colors:["#a0a8b1","#d2d8de","#ffffff","#1a73e8","#000000","#ff5722","#7b1fa2","#ffa000"]},minimal:{label:"Helvetica Minimal",colors:["#bdbdbd","#e0e0e0","#ffffff","#6b7280","#000000","#40e0d0","#303f9f","#ff9800"]},euroBlue:{label:"European Blue",colors:["#9aa6b2","#d4dde5","#ffffff","#0a66c2","#000000","#ff4081","#388e3c","#ffb300"]},scandi:{label:"Scandinavian Bright",colors:["#aab2b7","#e6eaee","#ffffff","#74b9ff","#000000","#e91e63","#1976d2","#4caf50"]},neonCyan:{label:"Graphite Neon Cyan",colors:["#9aa0a6","#d5d9dd","#ffffff","#00e5ff","#000000","#ff9800","#9c27b0","#4caf50"]},coralTech:{label:"Coral Tech",colors:["#9da3a9","#d8dde2","#ffffff","#ff6b6b","#000000","#00e676","#3f51b5","#ff5722"]},violetMidnight:{label:"Violet Midnight",colors:["#9fa3b1","#d9dce3","#ffffff","#7c3aed","#000000","#e91e63","#388e3c","#ffb300"]},mintSage:{label:"Mint Sage",colors:["#a0a7a2","#dbe0dd","#ffffff","#00c896","#000000","#ff1744","#3f51b5","#ff9800"]},slateAzure:{label:"Slate Azure",colors:["#9aa3ad","#d8dee6","#ffffff","#3b82f6","#000000","#ff4081","#388e3c","#ffc107"]},vaporPop:{label:"Vapor Pop",colors:["#9ea0a8","#d6d7dc","#ffffff","#ff00e5","#000000","#00bcd4","#673ab7","#ff5722"]},cyberMagenta:{label:"Cyber Magenta",colors:["#9c9fad","#d6d9e3","#ffffff","#ff007a","#000000","#40e0d0","#1976d2","#ff9800"]},streetLime:{label:"Street Lime",colors:["#9aa19a","#d6dbd6","#ffffff","#baff00","#000000","#e91e63","#3f51b5","#ff6f00"]},cmykPop:{label:"CMYK Pop",colors:["#9f9f9f","#d9d9d9","#ffffff","#ffd400","#000000","#ff1744","#7b1fa2","#4caf50"]}};let ft="industrialTeal",gt=["#b7bcb7","#e4e9e4","#ffffff","#00695c","#000000","#ff4013","#0d5cb6","#ffa000"],pt=5,yt=gt[pt]||"#ff4013";function xt(t=gt){try{const e=document.documentElement,n=(t&&t.length?t:gt).slice(0,8);for(let t=0;t<8;t++){const o=n[t]||"#ffffff";e.style.setProperty(`--ball-${t+1}`,o)}}catch(t){}}const vt=[.5,.25,.12,.06,.03,.02,.01,.01];function Et(){try{if(!gt||0===gt.length)return console.warn("No colors available, using fallback"),"#ffffff";const t=Math.random();let e=0;for(let n=0;n<Math.min(gt.length,vt.length);n++)if(e+=vt[n],t<=e)return gt[n];return gt[Math.min(gt.length-1,7)]}catch(t){return console.error("Error picking random color:",t),"#ffffff"}}let Mt=255,bt=274e3,It=4.4,wt=L,Bt=L,St=!1,Ct=!1;("ontouchstart"in window||navigator.maxTouchPoints>0)&&(Ct=!0);const Vt="bouncyBallsSettings";function Lt(){const t={currentMode:s,gravityMultiplierPit:r,repellerEnabledPit:d,attractionPower:h,orbitRadius:c,swarmSpeed:u,sparkleEmissionRate:m,sparkleLifetime:f,sparkleVelocitySpread:g,sparkleDriftStrength:p,sparkleParticleScale:y,weightlessInitialSpeed:v,weightlessBounce:E,weightlessMaxBalls:M,weightlessRepellerPower:b,weightlessRepellerRadius:I,restitution:_,friction:Y,sizeScale:$,sizeVariation:Q,ballMassKg:nt,ballSoftness:l,repelPower:bt,repelRadius:Mt,repelSoft:It,cornerRadius:Tt,motionBlur:At,trailSubtlety:kt,currentTemplate:ft,cursorBallColor:yt};try{localStorage.setItem(Vt,JSON.stringify(t)),console.log("âœ“ Settings saved")}catch(t){console.warn("Could not save settings:",t)}}function Rt(){clearTimeout(window.settingsSaveTimeout),window.settingsSaveTimeout=setTimeout(Lt,500)}const Ft=1e3;let Tt=0;const qt="#hero-text";let Pt=[],At=.025,kt=1.8,zt=0,Nt=0,Ut=0,Gt=0,Dt=0;const Ot=document.getElementById("render-fps"),Wt=document.getElementById("physics-fps");class Ht{constructor(t,e,n,o){this.x=t,this.y=e,this.vx=200*(2*Math.random()-1),this.vy=200*-Math.random(),this.r=n,this.rBase=n,this.m=nt,this.color=o,this.t=0,this.age=0,this.driftAx=0,this.driftTime=0,this.omega=0,this.squash=1,this.squashDirX=1,this.squashDirY=0,this.theta=0,this.squashAmount=0,this.squashNormalAngle=0,this.alpha=1}step(i){this.t+=i,this.age+=i,this.vy+=H*it*i;const a=Math.max(.25,this.m/1),l=Math.max(0,1-Y/a);this.vx*=l,this.vy*=l,0!==this.driftAx&&this.age<this.driftTime?this.vx+=this.driftAx*i/a:0!==this.driftAx&&(this.driftAx=0),function(i,a){s!==t?s!==e?s!==n?s===o&&function(t,e){if(wt===L||Bt===L)return;if(b<=0||I<=0)return;const n=I*k,o=t.x-wt,i=t.y-Bt,a=o*o+i*i;if(a>n*n)return;const s=Math.max(Math.sqrt(a),R),l=o/s,r=i/s,d=Math.max(0,1-s/n),h=b*d;t.vx+=l*h*e,t.vy+=r*h*e}(i,a):function(t,e){p>0&&(t.vx+=(Math.random()-.5)*p*e,t.vy+=(Math.random()-.5)*p*e),t.vx*=.98,t.vy*=.98;const n=(performance.now()/1e3-t.spawnTime)/t.lifetime,o=Math.max(0,1-n);t.r=t.rBase*o*y}(i,a):function(t,e){if(wt===L||Bt===L)return;const n=wt-t.x,o=Bt-t.y,i=n*n+o*o,a=Math.sqrt(i+1),s=n/a,l=o/a,r=4*h;t.vx+=s*r*e,t.vy+=l*r*e;const d=80*k;let c=0,m=0,f=0;for(let e=0;e<_t.length;e++){const n=_t[e];if(n===t)continue;const o=t.x-n.x,i=t.y-n.y,a=o*o+i*i;if(a<d*d&&a>0){const t=Math.sqrt(a),e=1-t/d;c+=o/t*e,m+=i/t*e,f++}}if(f>0){const n=15e3;t.vx+=c/f*n*e,t.vy+=m/f*n*e}if(Math.random()<.05){const e=Math.random()*Math.PI*2,n=800;t.vx+=Math.cos(e)*n,t.vy+=Math.sin(e)*n}t.vx+=1200*(Math.random()-.5)*e,t.vy+=1200*(Math.random()-.5)*e;const g=.5+1.5*Math.random(),p=1200*u*g*e;t.vx+=-l*p,t.vy+=s*p;const y=1400,x=Math.sqrt(t.vx*t.vx+t.vy*t.vy);x>y&&(t.vx=t.vx/x*y,t.vy=t.vy/x*y),t.vx*=.99,t.vy*=.99}(i,a):function(t,e){if(!St)return;if(bt<=0||Mt<=0)return;const n=Mt*k,o=t.x-wt,i=t.y-Bt,a=o*o+i*i;if(a>n*n)return;const s=Math.max(Math.sqrt(a),R),l=o/s,r=i/s,d=Math.max(0,1-s/n),h=20*bt*Math.pow(d,It),c=Math.max(.25,t.m/1);t.vx+=l*h*e/c,t.vy+=r*h*e/c;t.vx+=10*(Math.random()-.5)*e,t.vy+=10*(Math.random()-.5)*e}(i,a)}(this,i),this.x+=this.vx*i,this.y+=this.vy*i;const r=Math.max(0,1-2*i);this.omega*=r,this.theta+=this.omega*i,this.theta>Math.PI?this.theta-=2*Math.PI:this.theta<-Math.PI&&(this.theta+=2*Math.PI);const d=Math.min(1,18*i);this.squashAmount+=(0-this.squashAmount)*d,this.squash=1-this.squashAmount}walls(t,e,n,o=_){const i=o;if(0===Tt){if(this.y+this.r>e){this.y=e-this.r;const t=this.vy,o=this.vx-this.omega*this.r,a=Math.max(.25,this.m/1);this.omega+=o/this.r*F/a;const s=Math.max(0,1-1.5*n/a);this.vx*=s;const l=Math.abs(t)<70?0:i;this.vy=-this.vy*(l*Math.pow(1/this.m,ot));const r=Math.min(1,Math.abs(t)/(90*this.r));this.squashAmount=Math.min(T(),.8*r),this.squash=1-this.squashAmount,this.squashNormalAngle=-Math.PI/2;const d=this.vx/this.r;this.omega+=(d-this.omega)*Math.min(1,8*n)}const o=e/3;if(this.y-this.r<o){this.y=o+this.r;const t=this.vy;this.vy=-this.vy*i;const e=Math.min(1,Math.abs(t)/(90*this.r));this.squashAmount=Math.min(T(),.8*e),this.squash=1-this.squashAmount,this.squashNormalAngle=Math.PI/2}if(this.x+this.r>t){this.x=t-this.r;{const t=this.vy-this.omega*this.r,e=Math.max(.25,this.m/1);this.omega+=t/this.r*.125/e}this.vx=-this.vx*i;const e=Math.min(1,Math.abs(this.vx)/(90*this.r));this.squashAmount=Math.min(T(),.8*e),this.squash=1-this.squashAmount,this.squashNormalAngle=Math.PI}if(this.x-this.r<0){this.x=this.r;{const t=this.vy-this.omega*this.r,e=Math.max(.25,this.m/1);this.omega+=t/this.r*.125/e}this.vx=-this.vx*i;const t=Math.min(1,Math.abs(this.vx)/(90*this.r));this.squashAmount=Math.min(T(),.8*t),this.squash=1-this.squashAmount,this.squashNormalAngle=0}}else this.handleRoundedWallCollision(t,e);this.checkTextCollisions(n)}checkTextCollisions(t){for(let t=0;t<Pt.length;t++){const e=Pt[t],n=Math.max(e.x,Math.min(this.x,e.x+e.width)),o=Math.max(e.y,Math.min(this.y,e.y+e.height)),i=this.x-n,a=this.y-o,s=Math.sqrt(i*i+a*a);if(s<this.r)if(0===s){const t=this.x-e.x,n=e.x+e.width-this.x,o=this.y-e.y,i=e.y+e.height-this.y,a=Math.min(t,n,o,i);a===t?(this.x=e.x-this.r,this.vx=-Math.abs(this.vx)*_):a===n?(this.x=e.x+e.width+this.r,this.vx=Math.abs(this.vx)*_):a===o?(this.y=e.y-this.r,this.vy=-Math.abs(this.vy)*_):(this.y=e.y+e.height+this.r,this.vy=Math.abs(this.vy)*_)}else{const t=this.r-s,e=i/s,n=a/s;this.x+=e*t,this.y+=n*t;const o=this.vx*e+this.vy*n;if(o<0){this.vx-=2*o*e*_,this.vy-=2*o*n*_;const t=Math.min(1,Math.abs(o)/(70*this.r));this.squash=1-T()*t,this.squashDirX=Math.abs(e)>Math.abs(n)?1:0,this.squashDirY=Math.abs(n)>Math.abs(e)?1:0}}}}handleRoundedWallCollision(t,e){const n=Tt,o=[{x:n,y:n},{x:t-n,y:n},{x:t-n,y:e-n},{x:n,y:e-n}];for(let i=0;i<o.length;i++){const a=o[i],s=this.x-a.x,l=this.y-a.y,r=Math.sqrt(s*s+l*l);if(this.isInCornerRegion(a,t,e,n)&&r+this.r>n){const t=n-(r-this.r);if(t>0&&r>0){const e=s/r,n=l/r;this.x+=e*t,this.y+=n*t;const o=this.vx*e+this.vy*n;this.vx-=2*o*e*_,this.vy-=2*o*n*_;const i=Math.min(1,Math.abs(o)/(90*this.r));this.squashAmount=Math.min(T(),.8*i),this.squash=1-this.squashAmount,this.squashNormalAngle=Math.atan2(n,e)}}}if(this.y+this.r>e&&(this.x<n||this.x>t-n)&&(this.y=e-this.r,this.vy=-this.vy*(_*Math.pow(1/this.m,ot))),this.y-this.r<0&&(this.x<n||this.x>t-n)&&(this.y=this.r,this.vy=-this.vy*_),this.x+this.r>t&&(this.y<n||this.y>e-n)){this.x=t-this.r;{const t=this.vy-this.omega*this.r,e=Math.max(.25,this.m/1);this.omega+=t/this.r*.125/e}this.vx=-this.vx*(_*Math.pow(1/this.m,ot));const e=Math.min(1,Math.abs(this.vx)/(70*this.r));this.squashAmount=Math.min(T(),e),this.squash=1-this.squashAmount,this.squashNormalAngle=Math.PI}if(this.x-this.r<0&&(this.y<n||this.y>e-n)){this.x=this.r;{const t=this.vy-this.omega*this.r,e=Math.max(.25,this.m/1);this.omega+=t/this.r*.125/e}this.vx=-this.vx*(_*Math.pow(1/this.m,ot));const t=Math.min(1,Math.abs(this.vx)/(70*this.r));this.squashAmount=Math.min(T(),t),this.squash=1-this.squashAmount,this.squashNormalAngle=0}this.y+this.r>e&&this.x>=n&&this.x<=t-n&&(this.y=e-this.r,this.vy=-this.vy*(_*Math.pow(1/this.m,ot))),this.y-this.r<0&&this.x>=n&&this.x<=t-n&&(this.y=this.r,this.vy=-this.vy*(_*Math.pow(1/this.m,ot))),this.x+this.r>t&&this.y>=n&&this.y<=e-n&&(this.x=t-this.r,this.vx=-this.vx*(_*Math.pow(1/this.m,ot))),this.x-this.r<0&&this.y>=n&&this.y<=e-n&&(this.x=this.r,this.vx=-this.vx*(_*Math.pow(1/this.m,ot)))}isInCornerRegion(t,e,n,o){return t.x===o&&t.y===o?this.x<=o&&this.y<=o:t.x===e-o&&t.y===o?this.x>=e-o&&this.y<=o:t.x===e-o&&t.y===n-o?this.x>=e-o&&this.y>=n-o:t.x===o&&t.y===n-o&&this.x<=o&&this.y>=n-o}draw(t){t.save(),t.translate(this.x,this.y);const e=Math.min(T(),Math.max(0,this.squashAmount));if(e>.001){const n=1+e,o=1/n;t.rotate(this.squashNormalAngle),t.scale(n,o),t.rotate(-this.squashNormalAngle)}t.beginPath(),t.arc(0,0,this.r,0,2*Math.PI),t.fillStyle=this.color,t.fill(),t.restore()}}const _t=[];function Yt(t,e,n){return Math.max(e,Math.min(n,t))}function jt(t,e){return t+Math.random()*(e-t)}function Zt(t,e,n=Et()){const o=(st+lt)/2;let i;if(0===Q)i=o;else{const t=.1*o;i=jt(Math.max(1,o-t),o+t)}const a=new Ht(t,e,i,n),s=.5*q.width,l=ht?ut>=0?1:-1:t<s?1:-1,r=Yt(i/(.5*(st+lt)),.6,1.4),d=140*r,h=180*r;return a.vx=l*(d+Math.random()*h),a.vy=120*-Math.random(),a.driftAx=l*(360+420*Math.random())*r,a.driftTime=.22+.28*Math.random(),_t.push(a),a}let Xt=0,Jt=0,Kt=!1;function $t(){_t.length=0,Xt=0,Jt=0,Kt=!0}let Qt=0;function te(){const t=q.clientWidth,e=q.clientHeight,n=Yt(U/100*t,0,t);let o=Yt(z/100*t,0,t);if(ht){const e=.2*t,n=o;o=Yt(o+Math.sin(ct)*e,0,t),ut=o>=n?1:-1}const i=Math.min(40,.1*n),a=Yt(o-n/2-i,-i,t),s=Yt(o+n/2+i,-i,t),l=N/100*e,r=l+G/100*e,d=Math.random();return{x:(a+(s-a)*(ut>0?Math.pow(d,.7):1-Math.pow(1-d,.7)))*k,y:jt(l*k,r*k)-(lt+2+jt(0,10*k))}}const ee=[];let ne=0;function oe(){if(ne<ee.length)return ee[ne++];{const t=new Ht(0,0,0,"#ffffff");return t.isSparkle=!0,t.active=!1,ee.push(t),t}}function ie(){ne=0;for(let t=0;t<ee.length;t++)ee[t].active=!1}const ae=new Map;function se(t=6){const e=function(){const t=_t.length;if(t<2)return[];const e=Math.max(1,2*lt),n=Math.ceil(q.width/e)+1;ae.clear();for(let o=0;o<t;o++){const t=_t[o],i=t.x/e|0,a=(t.y/e|0)*n+i;let s=ae.get(a);s||(s=[],ae.set(a,s)),s.push(o)}const o=[];for(const[t,e]of ae){const i=t/n|0,a=t%n;for(let t=-1;t<=1;t++)for(let s=-1;s<=1;s++){const l=(i+t)*n+(a+s),r=ae.get(l);if(r)for(let t=0;t<e.length;t++){const n=e[t];for(let t=0;t<r.length;t++){const e=r[t];if(e<=n)continue;const i=_t[n],a=_t[e],s=a.x-i.x,l=a.y-i.y,d=i.r+a.r,h=s*s+l*l;if(h<d*d){const t=d-Math.sqrt(Math.max(h,1e-6));o.push({i:n,j:e,overlap:t})}}}}}return o.sort((t,e)=>e.overlap-t.overlap),o}();for(let n=0;n<t;n++)for(let t=0;t<e.length;t++){const{i:n,j:o}=e[t],i=_t[n],a=_t[o],s=a.x-i.x,l=a.y-i.y,r=i.r+a.r,d=s*s+l*l;if(0===d||d>r*r)continue;const h=Math.sqrt(d),c=s/h,u=l/h,m=r-h,f=1/Math.max(i.m,.001),g=1/Math.max(a.m,.001),p=.8*Math.max(m-X,0)/(f+g),y=p*c,x=p*u;i.x-=y*f,i.y-=x*f,a.x+=y*g,a.y+=x*g;const v=a.vx-i.vx,E=a.vy-i.vy,M=v*c+E*u;if(M<0){const t=-(1+(Math.abs(M)<30?0:_))*M/(f+g),e=t*c,n=t*u;i.vx-=e*f,i.vy-=n*f,a.vx+=e*g,a.vy+=n*g;const o=v-M*c,s=E-M*u,l=Math.hypot(o,s);if(l>.001){const t=o*-u+s*c>=0?1:-1,e=.18;i.omega-=t*e*l/Math.max(i.r,1),a.omega+=t*e*l/Math.max(a.r,1)}const r=Math.min(1,Math.abs(M)/(50*(i.r+a.r))),d=Math.min(T(),.8*r);i.squashAmount=Math.max(i.squashAmount,.8*d),i.squashNormalAngle=Math.atan2(-u,-c),a.squashAmount=Math.max(a.squashAmount,.8*d),a.squashNormalAngle=Math.atan2(u,c)}}}let le=performance.now()/1e3,re=0;const de=1/120;console.log("High refresh mode enabled - using requestAnimationFrame"),requestAnimationFrame(function t(a){const l=a/1e3;let r=Math.min(.008,l-le);le=l,re+=r,zt++,(Ot||Wt)&&l-Ut>=1&&(Ot&&zt!==Gt&&(Gt=zt,Ot.textContent=Gt.toString()),Wt&&Nt!==Dt&&(Dt=Nt,Wt.textContent=Dt.toString()),zt=0,Nt=0,Ut=l),function(t){if(s!==n)if(s!==i){if(s!==o)for(Qt+=t;Qt>=j;){const t=(Math.random()-.5)*j*.5;Qt-=j+t,ct+=2*Math.PI*.12*(j+t);const e=te(),n=Math.random()<.35?3:1;for(let t=0;t<n;t++)if(_t.length<Z){const n=8*t*(Math.random()<.5?1:-1);Zt(e.x+n,e.y-12*t)}}}else(function(){if(!Kt||Xt>=gt.length)return!1;const t=performance.now()/1e3,e=Math.max(B,.3);return t-Jt>=e})()&&function(){if(Xt>=gt.length||!Kt)return!1;const t=q.width/gt.length,e=Math.min(.2*q.height,.2*q.width),n=15*k;let o;if(0===w)o=e-Xt/(gt.length-1)*(e-n);else{const t=Xt/(gt.length-1)+(Math.random()-.5)*w*.3;o=e-Math.max(0,Math.min(1,t))*(e-n)}const i=t*Xt+.5*t;for(let t=0;t<_t.length;t++){const e=_t[t];if(Math.sqrt(Math.pow(e.x-i,2)+Math.pow(e.y- -100,2))<1.5*(e.r+o))return!1}const a=Math.min(.3*t,100),s=(Math.random()-.5)*a*2,l=Math.max(o+20,Math.min(q.width-o-20,i+s)),r=new Ht(l,-o-150,o,gt[rainbowDropIndex]);r.m=5*nt,r.vx=40*(Math.random()-.5),r.vy=0,r.driftAx=0,r.driftTime=0,_t.push(r),Xt++,Jt=performance.now()/1e3}();else!function(){if(wt===L||Bt===L)return;if(x.length<2)return;const t=performance.now()/1e3;if(ce>0&&t-ce>.1)return;const e=x[x.length-1],n=x[x.length-2],o=Math.max(.001,e.time-n.time),i=(e.x-n.x)/o,a=(e.y-n.y)/o;if(Math.sqrt(i*i+a*a)<50)return;const s=m;for(let t=0;t<s;t++){const t=oe();t.x=wt,t.y=Bt,t.isSparkle=!0,t.spawnTime=performance.now()/1e3,t.lifetime=f,t.active=!0,t.color=Et();const e=Math.random()*Math.PI*2,n=g*(.5+.5*Math.random());t.vx=Math.cos(e)*n,t.vy=Math.sin(e)*n,t.r=(st+lt)/2*y,t.rBase=t.r,_t.push(t)}}()}(r),zt%60==0&&dt();let d=0;for(;re>=de&&d<2;){for(let t=0;t<_t.length;t++)_t[t].step(de);if(s!==e&&s!==n&&se(3),s!==n){const t=s===o?E:s===i?C:_;for(let e=0;e<_t.length;e++)_t[e].walls(q.width,q.height,de,t)}re-=de,d++,Nt++}if(s===n)for(let t=_t.length-1;t>=0;t--){const e=_t[t];e.isSparkle&&e.r<=.5&&(e.active=!1,_t.splice(t,1))}if(re>3*de&&(re=0),At>0&&kt>0){const t=1.5,e=3,n=.35;let o=1+(n+(.0015-n)*Math.max(0,Math.min(1,At/t))-1)*Math.max(0,Math.min(1,kt/e));o=Math.max(.001,Math.min(1,o)),P.fillStyle=`rgba(0,0,0,${o})`,P.globalCompositeOperation="destination-out",P.fillRect(0,0,q.width,q.height),P.globalCompositeOperation="source-over"}else P.clearRect(0,0,q.width,q.height);Tt>0&&function(t,e,n){const o=Tt;t.strokeStyle="rgba(255, 255, 255, 0.1)",t.lineWidth=2,t.beginPath(),t.moveTo(o,0),t.lineTo(e-o,0),t.arcTo(e,0,e,o,o),t.lineTo(e,n-o),t.arcTo(e,n,e-o,n,o),t.lineTo(o,n),t.arcTo(0,n,0,n-o,o),t.lineTo(0,o),t.arcTo(0,0,o,0,o),t.closePath(),t.stroke()}(P,q.width,q.height);for(let t=0;t<_t.length;t++)_t[t].draw(P);if(function(t){if(Ct)return;if(wt===L||Bt===L)return;if(s===n)return;const e=wt,o=Bt,i=(st+lt)/2;t.beginPath(),t.arc(e,o,i,0,2*Math.PI),t.fillStyle="rgba(255, 255, 255, 0.9)",t.fill(),t.strokeStyle="rgba(255, 255, 255, 0.6)",t.lineWidth=2,t.stroke()}(P),!Ct){P.save(),P.font="14px system-ui, -apple-system, sans-serif",P.fillStyle="rgba(255, 255, 255, 0.3)",P.textAlign="left",P.textBaseline="bottom";const t=s.charAt(0).toUpperCase()+s.slice(1);P.fillText(t+" Mode",10,q.height-10),P.restore()}requestAnimationFrame(t)}),window.addEventListener("keydown",a=>{const l=a.key.toLowerCase();"r"===l&&(function(){if(s===i)$t();else if(s===o)Zn();else for(let t=0;t<_t.length;t++){const e=_t[t],n=te();e.x=n.x,e.y=n.y;const o=.5*q.width,i=ht?ut>=0?1:-1:e.x<o?1:-1,a=Yt(e.r/(.5*(st+lt)),.6,1.4),s=140*a,l=180*a,r=120;e.vx=i*(s+Math.random()*l),e.vy=-Math.random()*r,e.age=0,e.driftAx=i*(360+420*Math.random())*a,e.driftTime=.22+.28*Math.random()}}(),a.preventDefault()),"/"===l&&A&&(a.preventDefault(),A.classList.toggle("hidden")),"1"===l&&Xn(t),"2"===l&&Xn(e),"3"===l&&Xn(n),"4"===l&&Xn(o),"5"===l&&Xn(i)}),function(t=160){for(let e=0;e<t&&_t.length<Z;e++){const t=te();Zt(t.x,t.y)}}(200);let he={x:0,y:0},ce=0,ue=null,me={x:0,y:0};q.addEventListener("mousemove",e=>{const o=q.getBoundingClientRect();if(wt=(e.clientX-o.left)*k,Bt=(e.clientY-o.top)*k,s===t&&bt>0&&Mt>0&&(St=!0),s===i)if(ue){const t=V,e=wt-ue.x,n=Bt-ue.y;ue.vx=e*(1-t),ue.vy=n*(1-t),ue.x=wt-me.x,ue.y=Bt-me.y;for(let t=0;t<_t.length;t++){if(_t[t]===ue)continue;const e=_t[t],n=ue.x-e.x,o=ue.y-e.y,i=Math.sqrt(n*n+o*o),a=ue.r+e.r;if(i<a){const t=.5*(a-i),s=n/i,l=o/i;ue.x+=s*t,ue.y+=l*t,e.x-=s*t,e.y-=l*t;const r=(ue.vx-e.vx)*s+(ue.vy-e.vy)*l;if(r<0)continue;const d=2*r/(ue.m+e.m);ue.vx-=d*e.m*s,ue.vy-=d*e.m*l,e.vx+=d*ue.m*s,e.vy+=d*ue.m*l}}}else for(let t=0;t<_t.length;t++){const e=_t[t],n=wt-e.x,o=Bt-e.y;if(Math.sqrt(n*n+o*o)<=e.r)break}if(s===n){const t=performance.now()/1e3,e=wt-he.x,n=Bt-he.y;Math.sqrt(e*e+n*n)>2?(x.push({x:wt,y:Bt,time:t}),x.length>6&&x.shift(),he={x:wt,y:Bt},ce=0):ce=t}}),q.addEventListener("mouseleave",()=>{wt=L,Bt=L,s===n&&(x=[],ce=0,ie()),ue=null}),q.addEventListener("mousedown",t=>{if(s===i){const e=q.getBoundingClientRect(),n=(t.clientX-e.left)*k,o=(t.clientY-e.top)*k;for(let t=0;t<_t.length;t++){const e=_t[t],i=n-e.x,a=o-e.y;if(Math.sqrt(i*i+a*a)<=e.r){ue=e,me.x=n-e.x,me.y=o-e.y;break}}}}),q.addEventListener("mouseup",()=>{ue=null});const fe=document.getElementById("restitutionSlider"),ge=document.getElementById("frictionSlider"),pe=document.getElementById("emitterSlider"),ye=document.getElementById("sizeSliderGlobal"),xe=document.getElementById("sizeVariationSliderGlobal"),ve=(document.getElementById("weightSliderGlobal"),document.getElementById("ballSoftnessSliderGlobal")),Ee=document.getElementById("sizeValGlobal"),Me=document.getElementById("sizeVariationValGlobal"),be=(document.getElementById("weightValGlobal"),document.getElementById("ballSoftnessValGlobal")),Ie=(document.getElementById("sizeSliderPit"),document.getElementById("sizeVariationSliderPit"),document.getElementById("weightSliderPit"),document.getElementById("ballSoftnessSliderPit"),document.getElementById("sizeValPit"),document.getElementById("sizeVariationValPit"),document.getElementById("weightValPit"),document.getElementById("ballSoftnessValPit"),document.getElementById("sizeSliderFlies"),document.getElementById("sizeVariationSliderFlies"),document.getElementById("weightSliderFlies"),document.getElementById("ballSoftnessSliderFlies"),document.getElementById("sizeValFlies"),document.getElementById("sizeVariationValFlies"),document.getElementById("weightValFlies"),document.getElementById("ballSoftnessValFlies"),document.getElementById("sizeSliderZeroG"),document.getElementById("sizeVariationSliderZeroG"),document.getElementById("weightSliderZeroG"),document.getElementById("ballSoftnessSliderZeroG"),document.getElementById("sizeValZeroG"),document.getElementById("sizeVariationValZeroG"),document.getElementById("weightValZeroG"),document.getElementById("ballSoftnessValZeroG"),document.getElementById("maxBallsSlider")),we=document.getElementById("spawnYSlider"),Be=document.getElementById("spawnWidthSlider"),Se=document.getElementById("spawnCenterSlider"),Ce=document.getElementById("spawnHeightSlider"),Ve=document.getElementById("repelSizeSlider"),Le=document.getElementById("repelPowerSlider"),Re=document.getElementById("repelSoftSlider"),Fe=document.getElementById("colorSelect"),Te=document.getElementById("color1"),qe=document.getElementById("color2"),Pe=document.getElementById("color3"),Ae=document.getElementById("color4"),ke=document.getElementById("color5"),ze=document.getElementById("color6"),Ne=document.getElementById("color7"),Ue=document.getElementById("color8"),Ge=document.getElementById("cursorColorSelect"),De=document.getElementById("color1Val"),Oe=document.getElementById("color2Val"),We=document.getElementById("color3Val"),He=document.getElementById("color4Val"),_e=document.getElementById("color5Val"),Ye=document.getElementById("color6Val"),je=document.getElementById("color7Val"),Ze=document.getElementById("color8Val");[De,Oe,We,He,_e,Ye,je,Ze].forEach(t=>{t&&t.setAttribute("title","Click to copy")});const Xe=document.getElementById("cornerRadiusSlider"),Je=document.getElementById("cornerRadiusVal"),Ke=document.getElementById("trailFadeSlider"),$e=document.getElementById("trailFadeVal"),Qe=document.getElementById("trailSubtletySlider"),tn=document.getElementById("trailSubtletyVal"),en=document.getElementById("restitutionVal"),nn=document.getElementById("frictionVal"),on=document.getElementById("emitterVal"),an=document.getElementById("maxBallsVal"),sn=document.getElementById("spawnYVal"),ln=document.getElementById("spawnWidthVal"),rn=document.getElementById("spawnCenterVal"),dn=document.getElementById("spawnHeightVal"),hn=document.getElementById("repelSizeVal"),cn=document.getElementById("repelPowerVal"),un=document.getElementById("repelSoftVal");function mn(){return{gravityMultiplier:W,restitution:_,friction:Y,ballMass:nt,emitRate:j,maxBalls:Z,ballScale:$,ballVariation:Q,spawnX:z,spawnY:N,spawnWidth:U,spawnHeight:G,sweepEnabled:ht,repelRadius:Mt,repelPower:bt,repelSoftness:It,trailFade:At,trailSubtlety:kt,colors:gt.slice(),colorWeights:vt.slice(),currentTemplate:ft,cursorColorIndex:pt}}const fn=document.getElementById("saveConfigBtn"),gn=document.getElementById("buildBtn"),pn=document.getElementById("configOutput");function yn(t,e){t&&t.addEventListener("click",async()=>{const n="function"==typeof e?e():String(e||"").trim();try{await navigator.clipboard.writeText(n);const e=t.textContent;t.textContent="COPIED",t.style.color="#3ddc84",setTimeout(()=>{t.textContent=e,t.style.color="#888"},900)}catch(t){console.warn("Clipboard unavailable")}})}fn&&gn&&pn&&(fn.addEventListener("click",()=>{const t=(e=mn(),`// Generated configuration from frontend\nconst CONFIG = ${JSON.stringify(e,null,2)};`);var e;pn.style.display="block",pn.textContent=t,navigator.clipboard.writeText(t).then(()=>{const t=fn.textContent;fn.textContent="âœ… Copied!",setTimeout(()=>{fn.textContent=t},1200)}).catch(()=>{console.warn("Clipboard copy failed");const t=fn.textContent;fn.textContent="âš ï¸ Copy failed",setTimeout(()=>{fn.textContent=t},1200)})}),gn.addEventListener("click",()=>{const t=mn();pn.style.display="block",pn.innerHTML="\n<strong>ðŸš€ Build Instructions:</strong><br>\n1. Run: <code>npm run build</code><br>\n2. Your current config will be baked into <code>public/js/bouncy-balls-embed.js</code>";const e=new Blob([JSON.stringify(t,null,2)],{type:"application/json"}),n=URL.createObjectURL(e),o=document.createElement("a");o.href=n,o.download="current-config.json",o.click(),URL.revokeObjectURL(n)})),fe&&fe.addEventListener("input",()=>{_=parseFloat(fe.value),en&&(en.textContent=_.toFixed(2)),Rt()}),ge&&ge.addEventListener("input",()=>{Y=parseFloat(ge.value),nn&&(nn.textContent=Y.toFixed(4)),Rt()}),pe&&pe.addEventListener("input",()=>{j=parseFloat(pe.value),on&&(on.textContent=j.toFixed(3)),Rt()}),function(t){if(!t)return;const{size:e,sizeVal:n,sizeVar:o,sizeVarVal:a,soft:r,softVal:d}=t;e&&e.addEventListener("input",()=>{const t=parseFloat(e.value);n&&(n.textContent=t.toFixed(1)),$=t,rt();for(let t=0;t<_t.length;t++)_t[t].m=s===i?5*nt:nt;Rt()}),o&&o.addEventListener("input",()=>{const t=parseFloat(o.value);a&&(a.textContent=t.toFixed(1)),Q=t,Rt()}),r&&r.addEventListener("input",()=>{const t=parseInt(r.value,10);d&&(d.textContent=String(t)),l=t,Rt()})}({size:ye,sizeVal:Ee,sizeVar:xe,sizeVarVal:Me,soft:ve,softVal:be}),Ie&&Ie.addEventListener("input",()=>{Z=parseInt(Ie.value,10),an&&(an.textContent=Z.toString()),_t.length>Z&&(_t.length=Z)}),xe&&xe.addEventListener("input",()=>{Q=parseFloat(xe.value),Me&&(Me.textContent=Q.toFixed(1)),bn()});const xn=document.getElementById("weightPitSlider"),vn=document.getElementById("weightPitVal"),En=document.getElementById("weightWeightlessSlider"),Mn=document.getElementById("weightWeightlessVal");function bn(){const t=(st+lt)/2;for(let e=0;e<_t.length;e++){const n=_t[e];if(0===Q)n.r=t;else{const e=.1*t,o=Math.max(1,t-e),i=t+e;n.r=jt(o,i)}n.m=nt}}document.getElementById("weightRainbowSlider"),document.getElementById("weightRainbowVal"),we&&we.addEventListener("input",()=>{N=parseFloat(we.value),sn&&(sn.textContent=N.toFixed(0)),D()}),Be&&Be.addEventListener("input",()=>{U=parseFloat(Be.value),ln&&(ln.textContent=U.toFixed(0))}),Se&&Se.addEventListener("input",()=>{z=parseFloat(Se.value),rn&&(rn.textContent=z.toFixed(0))}),Ce&&Ce.addEventListener("input",()=>{G=parseFloat(Ce.value),dn&&(dn.textContent=G.toFixed(0))}),Ve&&Ve.addEventListener("input",()=>{Mt=parseFloat(Ve.value),hn&&(hn.textContent=Mt.toFixed(0)),St=St||bt>0&&Mt>0}),Le&&Le.addEventListener("input",()=>{bt=function(t){const e=Math.max(0,Math.min(Ft,Number(t)))/Ft;return 2*Math.pow(2,12*(e-.5))*12e3}(Le.value),cn&&(cn.textContent=Math.round(bt).toString()),wo&&"off"!==wo.value&&(St=bt>0&&Mt>0)}),Re&&Re.addEventListener("input",()=>{It=parseFloat(Re.value),un&&(un.textContent=It.toFixed(1))}),Fe&&Fe.addEventListener("change",()=>{const t=mt[Fe.value];t&&(ft=Fe.value,gt=t.colors.slice(),yt=gt[pt]||yt,Te&&De&&(Te.value=gt[0],De.textContent=gt[0].toUpperCase()),qe&&Oe&&(qe.value=gt[1],Oe.textContent=gt[1].toUpperCase()),Pe&&We&&(Pe.value=gt[2],We.textContent=gt[2].toUpperCase()),Ae&&He&&(Ae.value=gt[3],He.textContent=gt[3].toUpperCase()),ke&&_e&&(ke.value=gt[4],_e.textContent=gt[4].toUpperCase()),ze&&Ye&&(ze.value=gt[5],Ye.textContent=gt[5].toUpperCase()),Ne&&je&&(Ne.value=gt[6],je.textContent=gt[6].toUpperCase()),Ue&&Ze&&(Ue.value=gt[7],Ze.textContent=gt[7].toUpperCase()),yo(),xt())});const In=Array.from(document.querySelectorAll(".mode-button")),wn=document.getElementById("pitControls"),Bn=document.getElementById("fliesControls"),Sn=document.getElementById("trailControls"),Cn=document.getElementById("weightlessControls"),Vn=document.getElementById("boulderControls"),Ln=document.getElementById("gravityPitSlider"),Rn=document.getElementById("gravityPitVal"),Fn=document.getElementById("repellerEnabledPit"),Tn=document.getElementById("attractPowerSlider"),qn=document.getElementById("attractPowerVal"),Pn=document.getElementById("orbitRadiusSlider"),An=document.getElementById("orbitRadiusVal"),kn=document.getElementById("swarmSpeedSlider"),zn=document.getElementById("swarmSpeedVal"),Nn=document.getElementById("sparkleEmissionSlider"),Un=document.getElementById("sparkleEmissionVal"),Gn=document.getElementById("sparkleLifetimeSlider"),Dn=document.getElementById("sparkleLifetimeVal"),On=document.getElementById("sparkleSpreadSlider"),Wn=document.getElementById("sparkleSpreadVal"),Hn=document.getElementById("sparkleDriftSlider"),_n=document.getElementById("sparkleDriftVal"),Yn=document.getElementById("sparkleScaleSlider"),jn=document.getElementById("sparkleScaleVal");function Zn(){_t.length=0;const t=M,e=q.width,n=q.height,o=e/n,i=Math.ceil(Math.sqrt(t*o)),a=Math.ceil(t/i),s=(e-80)/(i-1),l=(n-80)/(a-1),r=[];for(let o=0;o<a;o++)for(let a=0;a<i&&!(r.length>=t);a++){const t=40+a*s,i=40+o*l,d=(Math.random()-.5)*s*.3,h=(Math.random()-.5)*l*.3;r.push({x:Math.max(20,Math.min(e-20,t+d)),y:Math.max(20,Math.min(n-20,i+h))})}for(let t=0;t<r.length;t++){const e=r[t],n=Zt(e.x,e.y),o=Math.random()*Math.PI*2,i=v*(.5+.5*Math.random());n.vx=Math.cos(o)*i,n.vy=Math.sin(o)*i,n.driftAx=0,n.driftTime=0}console.log(`Weightless scene initialized: ${_t.length} balls distributed evenly across viewport`)}function Xn(a){s=a,s===t?(W=r,H=O*W,St=d&&bt>0&&Mt>0,ht=!0):s===e?(W=0,H=O*W,St=!1,ht=!1):s===n?(W=0,H=O*W,St=!1,ht=!1,x=[],_t.length=0,ie()):s===o?(W=0,H=O*W,St=!1,ht=!1,Zn()):s===i&&(W=S,H=O*W,St=!1,ht=!1,$t()),wn&&wn.classList.toggle("active",s===t),Bn&&Bn.classList.toggle("active",s===e),Sn&&Sn.classList.toggle("active",s===n),Cn&&Cn.classList.toggle("active",s===o),Vn&&Vn.classList.toggle("active",s===i),In.forEach(t=>t.classList.toggle("active",t.getAttribute("data-mode")===s))}In.forEach(t=>t.addEventListener("click",()=>{Xn(t.getAttribute("data-mode")),function(){const t=parseFloat(ye.value);for(let e=0;e<_t.length;e++)s!==i&&(_t[e].r=t,_t[e].rBase=t)}(),Rt()})),Ln&&Ln.addEventListener("input",()=>{r=parseFloat(Ln.value),Rn&&(Rn.textContent=r.toFixed(1)),Rt(),s===t&&(W=r,H=O*W)}),xn&&xn.addEventListener("input",()=>{nt=parseFloat(xn.value),vn&&(vn.textContent=nt.toFixed(2));for(let t=0;t<_t.length;t++)_t[t].m=s===i?5*nt:nt;at(),Rt()}),Fn&&Fn.addEventListener("change",()=>{d=!!Fn.checked,s===t&&(St=d&&bt>0&&Mt>0)}),Tn&&Tn.addEventListener("input",()=>{h=parseFloat(Tn.value),qn&&(qn.textContent=Math.round(h).toString())}),Pn&&Pn.addEventListener("input",()=>{c=parseFloat(Pn.value),An&&(An.textContent=Math.round(c).toString())}),kn&&kn.addEventListener("input",()=>{u=parseFloat(kn.value),zn&&(zn.textContent=u.toFixed(1))}),Nn&&Nn.addEventListener("input",()=>{m=parseInt(Nn.value,10),Un&&(Un.textContent=m.toString()),Rt()}),Gn&&Gn.addEventListener("input",()=>{f=parseFloat(Gn.value),Dn&&(Dn.textContent=f.toFixed(1)),Rt()}),On&&On.addEventListener("input",()=>{g=parseInt(On.value,10),Wn&&(Wn.textContent=g.toString()),Rt()}),Hn&&Hn.addEventListener("input",()=>{p=parseInt(Hn.value,10),_n&&(_n.textContent=p.toString()),Rt()}),Yn&&Yn.addEventListener("input",()=>{y=parseFloat(Yn.value),jn&&(jn.textContent=y.toFixed(2)),Rt()});const Jn=document.getElementById("weightlessSpeedSlider"),Kn=document.getElementById("weightlessSpeedVal"),$n=document.getElementById("weightlessBounceSlider"),Qn=document.getElementById("weightlessBounceVal"),to=document.getElementById("weightlessMaxBallsSlider"),eo=document.getElementById("weightlessMaxBallsVal"),no=document.getElementById("weightlessRepelPowerSlider"),oo=document.getElementById("weightlessRepelPowerVal"),io=document.getElementById("weightlessRepelRadiusSlider"),ao=document.getElementById("weightlessRepelRadiusVal");Jn&&Jn.addEventListener("input",()=>{v=parseFloat(Jn.value),Kn&&(Kn.textContent=Math.round(v).toString())}),En&&En.addEventListener("input",()=>{nt=parseFloat(En.value),Mn&&(Mn.textContent=nt.toFixed(2));for(let t=0;t<_t.length;t++)_t[t].m=s===i?5*nt:nt;at(),Rt()}),$n&&$n.addEventListener("input",()=>{E=parseFloat($n.value),Qn&&(Qn.textContent=E.toFixed(2))}),to&&to.addEventListener("input",()=>{M=parseInt(to.value,10),eo&&(eo.textContent=M.toString()),s===o&&Zn()}),no&&no.addEventListener("input",()=>{b=parseFloat(no.value),oo&&(oo.textContent=Math.round(b).toString())}),io&&io.addEventListener("input",()=>{I=parseFloat(io.value),ao&&(ao.textContent=Math.round(I).toString())});const so=document.getElementById("boulderRandomnessSlider"),lo=document.getElementById("boulderRandomnessVal"),ro=document.getElementById("boulderDropDelaySlider"),ho=document.getElementById("boulderDropDelayVal"),co=document.getElementById("boulderGravitySlider"),uo=document.getElementById("boulderGravityVal"),mo=document.getElementById("boulderBounceSlider"),fo=document.getElementById("boulderBounceVal"),go=document.getElementById("boulderDragSlider"),po=document.getElementById("boulderDragVal");function yo(){for(let t=0;t<_t.length;t++)_t[t].color=Et()}so&&so.addEventListener("input",()=>{w=parseFloat(so.value),lo&&(lo.textContent=w.toFixed(1))}),weightBoulderSlider&&weightBoulderSlider.addEventListener("input",()=>{nt=parseFloat(weightBoulderSlider.value),weightBoulderVal&&(weightBoulderVal.textContent=nt.toFixed(2));for(let t=0;t<_t.length;t++)_t[t].m=5*nt;at(),Rt()}),ro&&ro.addEventListener("input",()=>{B=parseFloat(ro.value),ho&&(ho.textContent=B.toFixed(2))}),co&&co.addEventListener("input",()=>{S=parseFloat(co.value),uo&&(uo.textContent=S.toFixed(1)),s===i&&(W=S,H=O*W)}),mo&&mo.addEventListener("input",()=>{C=parseFloat(mo.value),fo&&(fo.textContent=C.toFixed(2))}),go&&go.addEventListener("input",()=>{V=parseFloat(go.value),po&&(po.textContent=V.toFixed(2))}),Te&&Te.addEventListener("input",()=>{gt[0]=Te.value,De&&(De.textContent=Te.value.toUpperCase()),yo(),xt()}),qe&&qe.addEventListener("input",()=>{gt[1]=qe.value,Oe&&(Oe.textContent=qe.value.toUpperCase()),yo(),xt()}),Pe&&Pe.addEventListener("input",()=>{gt[2]=Pe.value,We&&(We.textContent=Pe.value.toUpperCase()),yo(),xt()}),Ae&&Ae.addEventListener("input",()=>{gt[3]=Ae.value,He&&(He.textContent=Ae.value.toUpperCase()),yo(),xt()}),ke&&ke.addEventListener("input",()=>{gt[4]=ke.value,_e&&(_e.textContent=ke.value.toUpperCase()),yo(),xt()}),ze&&ze.addEventListener("input",()=>{gt[5]=ze.value,Ye&&(Ye.textContent=ze.value.toUpperCase()),yo(),xt()}),Ne&&Ne.addEventListener("input",()=>{gt[6]=Ne.value,je&&(je.textContent=Ne.value.toUpperCase()),yo(),xt()}),Ue&&Ue.addEventListener("input",()=>{gt[7]=Ue.value,Ze&&(Ze.textContent=Ue.value.toUpperCase()),yo(),xt()}),Ge&&Ge.addEventListener("change",()=>{const t=Math.max(1,Math.min(8,parseInt(Ge.value,10)))-1;pt=t,yt=gt[pt]||yt}),yn(De,()=>Te.value.toUpperCase()),yn(Oe,()=>qe.value.toUpperCase()),yn(We,()=>Pe.value.toUpperCase()),yn(He,()=>Ae.value.toUpperCase()),yn(_e,()=>ke.value.toUpperCase()),yn(Ye,()=>ze.value.toUpperCase()),yn(je,()=>Ne.value.toUpperCase()),yn(Ze,()=>Ue.value.toUpperCase()),Xe&&Xe.addEventListener("input",()=>{Tt=parseFloat(Xe.value),Je&&(Je.textContent=Tt.toFixed(0))}),Ke&&Ke.addEventListener("input",()=>{At=parseFloat(Ke.value),$e&&($e.textContent=At.toFixed(3))}),Qe&&Qe.addEventListener("input",()=>{kt=parseFloat(Qe.value),tn&&(tn.textContent=kt.toFixed(2)+"Ã—")});const xo={rubberPlayground:{label:"Rubber â€“ Playground",G:1960,REST:.9,FRICTION:.0025,sizeScale:1.8,maxBalls:450,sizeVariation:.2},rubberRacquet:{label:"Rubber â€“ Racquetball",G:3320,REST:.97,FRICTION:.0035,sizeScale:2.1,maxBalls:350,sizeVariation:.3},rubberSuperball:{label:"Rubber â€“ Superball",G:1960,REST:.95,FRICTION:.0015,sizeScale:1.2,maxBalls:450,sizeVariation:.05},rubberSoft:{label:"Rubber â€“ Soft",G:1960,REST:.86,FRICTION:.0035,sizeScale:2.2,maxBalls:350,sizeVariation:.25},rubberHeavy:{label:"Rubber â€“ Heavy",G:1960,REST:.88,FRICTION:.003,sizeScale:2,maxBalls:400,sizeVariation:.15}},vo={fullRain:{label:"Full Rain (top-half)",EMIT_INTERVAL:.03,xCenter:50,y:-50,w:100,h:50},narrowStrip:{label:"Narrow Strip Top",EMIT_INTERVAL:.05,xCenter:50,y:-40,w:20,h:10},leftGutter:{label:"Left Gutter",EMIT_INTERVAL:.045,xCenter:10,y:-60,w:18,h:20},rightGutter:{label:"Right Gutter",EMIT_INTERVAL:.045,xCenter:90,y:-60,w:18,h:20},centerFountain:{label:"Center Fountain",EMIT_INTERVAL:.02,xCenter:50,y:-30,w:30,h:20},stormBurst:{label:"Storm Burst",EMIT_INTERVAL:.005,xCenter:50,y:-80,w:100,h:30},slowSnow:{label:"Slow Snow",EMIT_INTERVAL:.2,xCenter:50,y:-30,w:100,h:20},edgeDrizzle:{label:"Edge Drizzle",EMIT_INTERVAL:.08,xCenter:15,y:-40,w:30,h:15},twinColumns:{label:"Twin Columns",EMIT_INTERVAL:.03,xCenter:30,y:-50,w:10,h:40},focusedBeam:{label:"Focused Beam",EMIT_INTERVAL:.015,xCenter:50,y:-70,w:6,h:12}},Eo={off:{label:"Off",r:710,p:274e3,s:4.4},gentle:{label:"Gentle Breeze",r:120,p:2500,s:2.5},pushField:{label:"Push Field",r:240,p:8e4,s:2},tractor:{label:"Tractor Push",r:320,p:14e4,s:1.6},magnet:{label:"Magnet Repel",r:200,p:18e4,s:3},pulse:{label:"Pulse Strong",r:280,p:22e4,s:1.2},wideSoft:{label:"Wide Soft",r:500,p:8e4,s:4.5},needle:{label:"Needle Point",r:80,p:26e4,s:.8},wall:{label:"Invisible Wall",r:700,p:16e4,s:5},singularity:{label:"Singularity",r:600,p:3e5,s:.5}};function Mo(t,e,n){t.innerHTML="";for(const[o,i]of Object.entries(e)){const e=document.createElement("option");e.value=o,e.textContent=i.label||o,o===n&&(e.selected=!0),t.appendChild(e)}}const bo=document.getElementById("physicsSelect"),Io=document.getElementById("spawnSelect"),wo=document.getElementById("repellerSelect");function Bo(t,e,n,o=0){t&&(t.value=String(n)),e&&(e.textContent=o>0?n.toFixed(o):n.toString())}function So(t){const e=xo[t];if(!e)return;_=e.REST,Y=e.FRICTION,Z=e.maxBalls,Q=e.sizeVariation;const n=e.sizeScale;$=n,rt();for(let t=0;t<_t.length;t++)_t[t].m=s===i?5*nt:nt;_t.length>Z&&(_t.length=Z),Bo(fe,en,_,2),Bo(ge,nn,Y,4),Bo(ye,Ee,$,1),Bo(Ie,an,Z,0),Bo(xe,Me,Q,1),bn()}function Co(t){const e=vo[t];e&&(j=e.EMIT_INTERVAL,z=e.xCenter,N=e.y,U=e.w,G=e.h,Bo(pe,on,j,3),Bo(Se,rn,z,0),Bo(we,sn,N,0),Bo(Be,ln,U,0),Bo(Ce,dn,G,0))}function Vo(t){const e=Eo[t];if(!e)return;Mt=e.r,bt=1*e.p,St="off"!==t,Bo(Ve,hn,Mt,0);const n=function(t){const e=Math.max(1,Number(t))/24e3,n=.5+Math.log2(e)/12;return Math.round(Math.max(0,Math.min(1,n))*Ft)}(bt);Le&&(Le.value=String(n)),cn&&(cn.textContent=Math.round(bt).toString()),Bo(Re,un,It,1)}bo&&Mo(bo,xo,"rubberRacquet"),Io&&Mo(Io,vo,"fullRain"),wo&&Mo(wo,Eo,"off"),Fe&&Mo(Fe,mt,"industrialTeal"),So("rubberRacquet"),Co("fullRain"),Vo("off");const Lo=mt[ft];Te&&De&&(Te.value=Lo.colors[0],De.textContent=Lo.colors[0].toUpperCase()),qe&&Oe&&(qe.value=Lo.colors[1],Oe.textContent=Lo.colors[1].toUpperCase()),Pe&&We&&(Pe.value=Lo.colors[2],We.textContent=Lo.colors[2].toUpperCase()),Ae&&He&&(Ae.value=Lo.colors[3],He.textContent=Lo.colors[3].toUpperCase()),ke&&_e&&(ke.value=Lo.colors[4],_e.textContent=Lo.colors[4].toUpperCase()),ze&&Ye&&(ze.value=Lo.colors[5],Ye.textContent=Lo.colors[5].toUpperCase()),Ne&&je&&(Ne.value=Lo.colors[6],je.textContent=Lo.colors[6].toUpperCase()),Ue&&Ze&&(Ue.value=Lo.colors[7],Ze.textContent=Lo.colors[7].toUpperCase()),xt(Lo.colors),bo&&bo.addEventListener("change",()=>So(bo.value)),Io&&Io.addEventListener("change",()=>Co(Io.value)),wo&&wo.addEventListener("change",()=>Vo(wo.value)),rt(),dt(),function(){try{const t=localStorage.getItem(Vt);if(t){const e=JSON.parse(t);return e.currentMode&&(s=e.currentMode),void 0!==e.gravityMultiplierPit&&(r=e.gravityMultiplierPit),void 0!==e.repellerEnabledPit&&(d=e.repellerEnabledPit),e.attractionPower&&(h=e.attractionPower),e.orbitRadius&&(c=e.orbitRadius),e.swarmSpeed&&(u=e.swarmSpeed),void 0!==e.sparkleEmissionRate&&(m=e.sparkleEmissionRate),void 0!==e.sparkleLifetime&&(f=e.sparkleLifetime),void 0!==e.sparkleVelocitySpread&&(g=e.sparkleVelocitySpread),void 0!==e.sparkleDriftStrength&&(p=e.sparkleDriftStrength),void 0!==e.sparkleParticleScale&&(y=e.sparkleParticleScale),e.weightlessInitialSpeed&&(v=e.weightlessInitialSpeed),e.weightlessBounce&&(E=e.weightlessBounce),e.weightlessMaxBalls&&(M=e.weightlessMaxBalls),void 0!==e.weightlessRepellerPower&&(b=e.weightlessRepellerPower),void 0!==e.weightlessRepellerRadius&&(I=e.weightlessRepellerRadius),e.restitution&&(_=e.restitution),void 0!==e.friction&&(Y=e.friction),e.sizeScale&&($=e.sizeScale),void 0!==e.sizeVariation&&(Q=e.sizeVariation),e.ballMassKg&&(nt=e.ballMassKg),e.repelPower&&(bt=e.repelPower),e.repelRadius&&(Mt=e.repelRadius),e.repelSoft&&(It=e.repelSoft),void 0!==e.cornerRadius&&(Tt=e.cornerRadius),void 0!==e.motionBlur&&(At=e.motionBlur),e.trailSubtlety&&(kt=e.trailSubtlety),e.currentTemplate&&(ft=e.currentTemplate),e.cursorBallColor&&(yt=e.cursorBallColor),console.log("âœ“ Settings loaded"),!0}}catch(t){console.warn("Could not load settings:",t)}}(),function(){const t=Ct?"mobile":"desktop",e=document.getElementById("trailModeButton");e&&!a[n][t]&&(e.style.display="none")}(),Xn(s),window.addEventListener("beforeunload",Lt)})();