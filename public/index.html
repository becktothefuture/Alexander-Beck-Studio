<!DOCTYPE html><!--  This site was created in Webflow. https://webflow.com  --><!--  Last Published: Wed Oct 01 2025 07:06:55 GMT+0000 (Coordinated Universal Time)  -->
<html data-wf-page="68cee53d847dda2fd5c39cf1" data-wf-site="68cee53c847dda2fd5c39ce4">
<head>
  <meta charset="utf-8">
  <title>Alexander Beck Studio :: Al Creative :: User Experience :: Product Design</title>
  <meta content="c366" name="description">
  <meta content="width=device-width, initial-scale=1" name="viewport">
  <meta content="Webflow" name="generator">
  <link href="css/normalize.css" rel="stylesheet" type="text/css">
  <link href="css/webflow.css" rel="stylesheet" type="text/css">
  <link href="css/alexander-beck-studio-staging.webflow.css" rel="stylesheet" type="text/css">
  <link href="https://fonts.googleapis.com" rel="preconnect">
  <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin="anonymous">
  <script src="https://ajax.googleapis.com/ajax/libs/webfont/1.6.26/webfont.js" type="text/javascript"></script>
  <script type="text/javascript">WebFont.load({  google: {    families: ["Geist Mono:100,regular,800","Geist:200,regular,600,800"]  }});</script>
  <script type="text/javascript">!function(o,c){var n=c.documentElement,t=" w-mod-";n.className+=t+"js",("ontouchstart"in o||o.DocumentTouch&&c instanceof DocumentTouch)&&(n.className+=t+"touch")}(window,document);</script>
  <link href="images/favicon.ico" rel="shortcut icon" type="image/x-icon">
  <link href="images/webclip.png" rel="apple-touch-icon">
  <style>

  /* Prevent page scrolling - simulation fills viewport */
  html, body {
    overflow: hidden;
    margin: 0;
    padding: 0;
    width: 100%;
    height: 100%;
  }
  
  /* Removed global html/body styles - simulation is self-contained within #bravia-balls */
  /* Scoped wrapper for embed friendliness and interaction hygiene */
  #bravia-balls {
    overflow: hidden; /* Critical: prevent scrollbars from canvas overflow */
    position: fixed;
    bottom: 0;
    left: 0;
    width: 100%;
    height: 100svh; /* Default height for most modes */
    background: #cecece; /* Light mode background */
    transition: background-color 0.3s ease;
    overscroll-behavior: contain;
    -webkit-tap-highlight-color: transparent;
    user-select: none; -webkit-user-select: none; -webkit-touch-callout: none;
    pointer-events: auto !important; /* Critical: override Webflow's pointer-events: none */
  }
  #bravia-balls canvas {
    pointer-events: auto !important; /* Ensure canvas receives mouse events */
  }
  #bravia-balls.dark-mode {
    background: #0a0a0a; /* Dark mode background */
  }
  /* Ball Pit mode needs extra height for spawning above viewport */
  /* Canvas is clipped to 100svh visible area, but rendering extends to 150vh */
  #bravia-balls.mode-pit {
    height: 100svh; /* Keep visible area at 100svh (no scrollbars) */
  }
  #bravia-balls.mode-pit canvas {
    height: 150vh; /* Canvas renders 150vh for ball spawning above */
  }
  #bravia-balls canvas { 
    display: block; 
    width: 100vw; /* Full viewport width */
    height: 100svh; /* Full small viewport height */
    position: absolute;
    bottom: 0;
    left: 0;
    -webkit-user-drag: none;
    user-select: none; 
    -webkit-user-select: none;
    touch-action: none;
    cursor: none;
    /* Shadow applied dynamically via JavaScript */
  }
  @media (prefers-reduced-motion: reduce) { 
    #bravia-balls canvas { filter: none; } 
  }
  #bravia-balls .panel {
    position: fixed;
    top: 5vh;
    right: 5vh;
    color: #fff;
    font: 10px/1.2 system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif;
    background: rgba(0,0,0,0.45);
    padding: 6px;
    border-radius: 6px;
    user-select: none;
    display: flex;
    flex-direction: column;
    gap: 4px;
    z-index: 10;
    max-height: 90vh;
    overflow: auto;
    backdrop-filter: blur(6px);
    cursor: move;
    min-width: 200px;
    transition: background-color 0.3s ease, border-color 0.3s ease;
  }
  #bravia-balls.dark-mode .panel {
    background: rgba(20,20,20,0.75);
    border: 1px solid rgba(255,255,255,0.15);
  }
  #bravia-balls .panel.hidden { display: none; }
  #bravia-balls .panel .panel-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 4px 6px;
    background: rgba(255,255,255,0.05);
    border-radius: 4px;
    margin-bottom: 4px;
    cursor: move;
    font-weight: 600;
    font-size: 11px;
  }
  #bravia-balls .panel .panel-header .drag-handle {
    opacity: 0.5;
    margin-right: 6px;
  }
  #bravia-balls .panel label {
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: 4px;
    width: 200px;
    font-size: 9px;
  }
  #bravia-balls .panel label span:first-child {
    flex-shrink: 0;
    max-width: 90px;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
  }
  #bravia-balls .panel input[type="range"] {
    flex: 1;
    min-width: 60px;
    height: 12px;
  }
  #bravia-balls .panel span.val {
    width: 42px;
    text-align: right;
    font-family: monospace;
    font-size: 9px;
  }
  #bravia-balls .panel span.hex-val {
    font-family: 'SF Mono', Monaco, 'Cascadia Code', 'Roboto Mono', Consolas, 'Courier New', monospace;
    font-size: 10px;
    color: #888;
    background: rgba(0,0,0,0.05);
    padding: 1px 4px;
    border-radius: 2px;
    margin-left: 4px;
    text-transform: uppercase;
    cursor: pointer;
  }
  #bravia-balls .panel code {
    font-family: monospace;
    background: rgba(255,255,255,0.1);
    padding: 1px 3px;
    border-radius: 3px;
    font-size: 9px;
  }
  #bravia-balls .panel details { background: rgba(255,255,255,0.04); border-radius: 4px; padding: 4px; }
  #bravia-balls .panel summary { cursor: pointer; list-style: none; outline: none; font-size: 10px; }
  #bravia-balls .panel summary::-webkit-details-marker { display: none; }
  #bravia-balls .panel summary { display:flex; align-items:center; justify-content:space-between; color:#b8c2c7; padding: 2px; }
  #bravia-balls .panel .group { display:flex; flex-direction:column; gap:4px; margin-top:4px; }
  #bravia-balls .panel button {
    font-size: 9px;
    padding: 4px 8px;
  }
  #bravia-balls .panel select {
    font-size: 9px;
    padding: 2px 4px;
  }
  #bravia-balls .panel input[type="color"] {
    width: 28px;
    height: 20px;
    border: none;
    border-radius: 3px;
    padding: 0;
  }
  
  /* Mode switcher - segmented control */
  #bravia-balls .mode-switcher {
    display: flex;
    background: rgba(0,0,0,0.3);
    border-radius: 4px;
    padding: 1px;
    gap: 1px;
    margin-bottom: 6px;
  }
  #bravia-balls .mode-button {
    flex: 1;
    padding: 4px 6px;
    background: transparent;
    border: none;
    border-radius: 3px;
    color: rgba(255,255,255,0.6);
    font-size: 9px;
    font-weight: 500;
    cursor: pointer;
    transition: all 0.2s ease;
    text-align: center;
  }
  #bravia-balls .mode-button:hover {
    background: rgba(255,255,255,0.05);
    color: rgba(255,255,255,0.8);
  }
  #bravia-balls .mode-button.active {
    background: rgba(255,255,255,0.15);
    color: #ffffff;
    font-weight: 600;
  }
  #bravia-balls .mode-controls { display: none; }
  #bravia-balls .mode-controls.active { display: block; }
  
  /* Palette variables (defaults match 'industrialTeal') */
  :root {
    --ball-1: #b7bcb7;
    --ball-2: #e4e9e4;
    --ball-3: #ffffff;
    --ball-4: #00695c;
    --ball-5: #000000;
    --ball-6: #ff4013;
    --ball-7: #0d5cb6;
    --ball-8: #ffa000;
  }
  /* Utility classes for using the palette elsewhere on the page */
  .text-ball-1 { color: var(--ball-1); }
  .text-ball-2 { color: var(--ball-2); }
  .text-ball-3 { color: var(--ball-3); }
  .text-ball-4 { color: var(--ball-4); }
  .text-ball-5 { color: var(--ball-5); }
  .text-ball-6 { color: var(--ball-6); }
  .text-ball-7 { color: var(--ball-7); }
  .text-ball-8 { color: var(--ball-8); }
  .bg-ball-1 { background-color: var(--ball-1); }
  .bg-ball-2 { background-color: var(--ball-2); }
  .bg-ball-3 { background-color: var(--ball-3); }
  .bg-ball-4 { background-color: var(--ball-4); }
  .bg-ball-5 { background-color: var(--ball-5); }
  .bg-ball-6 { background-color: var(--ball-6); }
  .bg-ball-7 { background-color: var(--ball-7); }
  .bg-ball-8 { background-color: var(--ball-8); }
  .border-ball-1 { border-color: var(--ball-1); }
  .border-ball-2 { border-color: var(--ball-2); }
  .border-ball-3 { border-color: var(--ball-3); }
  .border-ball-4 { border-color: var(--ball-4); }
  .border-ball-5 { border-color: var(--ball-5); }
  .border-ball-6 { border-color: var(--ball-6); }
  .border-ball-7 { border-color: var(--ball-7); }
  .border-ball-8 { border-color: var(--ball-8); }

  
  /* Production Build Overrides - Ensure mouse interaction works */
  #bravia-balls {
    pointer-events: auto !important;
    z-index: 200 !important; /* Higher than Webflow viewport (z-index: 1) */
  }
  #bravia-balls canvas {
    pointer-events: auto !important;
  }
  .ball-simulation {
    pointer-events: auto !important; /* Override Webflow's pointer-events: none */
  }
  
  /* Hide FPS counter styling in production */
  #fps-counter {
    display: none !important;
  }

  </style>
  <style>

  /* Prevent page scrolling - simulation fills viewport */
  html, body {
    overflow: hidden;
    margin: 0;
    padding: 0;
    width: 100%;
    height: 100%;
  }
  
  /* Removed global html/body styles - simulation is self-contained within #bravia-balls */
  /* Scoped wrapper for embed friendliness and interaction hygiene */
  #bravia-balls {
    overflow: hidden; /* Critical: prevent scrollbars from canvas overflow */
    position: fixed;
    bottom: 0;
    left: 0;
    width: 100%;
    height: 100svh; /* Default height for most modes */
    background: #cecece; /* Light mode background */
    transition: background-color 0.3s ease;
    overscroll-behavior: contain;
    -webkit-tap-highlight-color: transparent;
    user-select: none; -webkit-user-select: none; -webkit-touch-callout: none;
    pointer-events: auto !important; /* Critical: override Webflow's pointer-events: none */
  }
  #bravia-balls canvas {
    pointer-events: auto !important; /* Ensure canvas receives mouse events */
  }
  #bravia-balls.dark-mode {
    background: #0a0a0a; /* Dark mode background */
  }
  /* Ball Pit mode needs extra height for spawning above viewport */
  /* Canvas is clipped to 100svh visible area, but rendering extends to 150vh */
  #bravia-balls.mode-pit {
    height: 100svh; /* Keep visible area at 100svh (no scrollbars) */
  }
  #bravia-balls.mode-pit canvas {
    height: 150vh; /* Canvas renders 150vh for ball spawning above */
  }
  #bravia-balls canvas { 
    display: block; 
    width: 100vw; /* Full viewport width */
    height: 100svh; /* Full small viewport height */
    position: absolute;
    bottom: 0;
    left: 0;
    -webkit-user-drag: none;
    user-select: none; 
    -webkit-user-select: none;
    touch-action: none;
    cursor: none;
    /* Shadow applied dynamically via JavaScript */
  }
  @media (prefers-reduced-motion: reduce) { 
    #bravia-balls canvas { filter: none; } 
  }
  #bravia-balls .panel {
    position: fixed;
    top: 5vh;
    right: 5vh;
    color: #fff;
    font: 10px/1.2 system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif;
    background: rgba(0,0,0,0.45);
    padding: 6px;
    border-radius: 6px;
    user-select: none;
    display: flex;
    flex-direction: column;
    gap: 4px;
    z-index: 10;
    max-height: 90vh;
    overflow: auto;
    backdrop-filter: blur(6px);
    cursor: move;
    min-width: 200px;
    transition: background-color 0.3s ease, border-color 0.3s ease;
  }
  #bravia-balls.dark-mode .panel {
    background: rgba(20,20,20,0.75);
    border: 1px solid rgba(255,255,255,0.15);
  }
  #bravia-balls .panel.hidden { display: none; }
  #bravia-balls .panel .panel-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 4px 6px;
    background: rgba(255,255,255,0.05);
    border-radius: 4px;
    margin-bottom: 4px;
    cursor: move;
    font-weight: 600;
    font-size: 11px;
  }
  #bravia-balls .panel .panel-header .drag-handle {
    opacity: 0.5;
    margin-right: 6px;
  }
  #bravia-balls .panel label {
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: 4px;
    width: 200px;
    font-size: 9px;
  }
  #bravia-balls .panel label span:first-child {
    flex-shrink: 0;
    max-width: 90px;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
  }
  #bravia-balls .panel input[type="range"] {
    flex: 1;
    min-width: 60px;
    height: 12px;
  }
  #bravia-balls .panel span.val {
    width: 42px;
    text-align: right;
    font-family: monospace;
    font-size: 9px;
  }
  #bravia-balls .panel span.hex-val {
    font-family: 'SF Mono', Monaco, 'Cascadia Code', 'Roboto Mono', Consolas, 'Courier New', monospace;
    font-size: 10px;
    color: #888;
    background: rgba(0,0,0,0.05);
    padding: 1px 4px;
    border-radius: 2px;
    margin-left: 4px;
    text-transform: uppercase;
    cursor: pointer;
  }
  #bravia-balls .panel code {
    font-family: monospace;
    background: rgba(255,255,255,0.1);
    padding: 1px 3px;
    border-radius: 3px;
    font-size: 9px;
  }
  #bravia-balls .panel details { background: rgba(255,255,255,0.04); border-radius: 4px; padding: 4px; }
  #bravia-balls .panel summary { cursor: pointer; list-style: none; outline: none; font-size: 10px; }
  #bravia-balls .panel summary::-webkit-details-marker { display: none; }
  #bravia-balls .panel summary { display:flex; align-items:center; justify-content:space-between; color:#b8c2c7; padding: 2px; }
  #bravia-balls .panel .group { display:flex; flex-direction:column; gap:4px; margin-top:4px; }
  #bravia-balls .panel button {
    font-size: 9px;
    padding: 4px 8px;
  }
  #bravia-balls .panel select {
    font-size: 9px;
    padding: 2px 4px;
  }
  #bravia-balls .panel input[type="color"] {
    width: 28px;
    height: 20px;
    border: none;
    border-radius: 3px;
    padding: 0;
  }
  
  /* Mode switcher - segmented control */
  #bravia-balls .mode-switcher {
    display: flex;
    background: rgba(0,0,0,0.3);
    border-radius: 4px;
    padding: 1px;
    gap: 1px;
    margin-bottom: 6px;
  }
  #bravia-balls .mode-button {
    flex: 1;
    padding: 4px 6px;
    background: transparent;
    border: none;
    border-radius: 3px;
    color: rgba(255,255,255,0.6);
    font-size: 9px;
    font-weight: 500;
    cursor: pointer;
    transition: all 0.2s ease;
    text-align: center;
  }
  #bravia-balls .mode-button:hover {
    background: rgba(255,255,255,0.05);
    color: rgba(255,255,255,0.8);
  }
  #bravia-balls .mode-button.active {
    background: rgba(255,255,255,0.15);
    color: #ffffff;
    font-weight: 600;
  }
  #bravia-balls .mode-controls { display: none; }
  #bravia-balls .mode-controls.active { display: block; }
  
  /* Palette variables (defaults match 'industrialTeal') */
  :root {
    --ball-1: #b7bcb7;
    --ball-2: #e4e9e4;
    --ball-3: #ffffff;
    --ball-4: #00695c;
    --ball-5: #000000;
    --ball-6: #ff4013;
    --ball-7: #0d5cb6;
    --ball-8: #ffa000;
  }
  /* Utility classes for using the palette elsewhere on the page */
  .text-ball-1 { color: var(--ball-1); }
  .text-ball-2 { color: var(--ball-2); }
  .text-ball-3 { color: var(--ball-3); }
  .text-ball-4 { color: var(--ball-4); }
  .text-ball-5 { color: var(--ball-5); }
  .text-ball-6 { color: var(--ball-6); }
  .text-ball-7 { color: var(--ball-7); }
  .text-ball-8 { color: var(--ball-8); }
  .bg-ball-1 { background-color: var(--ball-1); }
  .bg-ball-2 { background-color: var(--ball-2); }
  .bg-ball-3 { background-color: var(--ball-3); }
  .bg-ball-4 { background-color: var(--ball-4); }
  .bg-ball-5 { background-color: var(--ball-5); }
  .bg-ball-6 { background-color: var(--ball-6); }
  .bg-ball-7 { background-color: var(--ball-7); }
  .bg-ball-8 { background-color: var(--ball-8); }
  .border-ball-1 { border-color: var(--ball-1); }
  .border-ball-2 { border-color: var(--ball-2); }
  .border-ball-3 { border-color: var(--ball-3); }
  .border-ball-4 { border-color: var(--ball-4); }
  .border-ball-5 { border-color: var(--ball-5); }
  .border-ball-6 { border-color: var(--ball-6); }
  .border-ball-7 { border-color: var(--ball-7); }
  .border-ball-8 { border-color: var(--ball-8); }

  
  /* Production Build Overrides V2.1 - Maximum Compatibility & Performance */
  
  /* INTERACTION LAYER - Highest Priority Z-Index Stack */
  html body #bravia-balls,
  html body #bravia-balls canvas,
  html body div.ball-simulation#bravia-balls {
    /* Ensure simulation is ALWAYS on top (max possible z-index) */
    z-index: 2147483647 !important;
    isolation: isolate !important; /* Create new stacking context */
    
    /* Enable all pointer/touch events */
    pointer-events: auto !important;
    touch-action: auto !important;
    
    /* Visual feedback */
    cursor: default !important;
    
    /* GPU acceleration for smooth rendering */
    will-change: transform !important;
    transform: translateZ(0) !important;
    
    /* Ensure positioning */
    position: fixed !important;
  }
  
  /* Ensure ALL nested elements can receive events */
  #bravia-balls *,
  #bravia-balls canvas,
  #bravia-balls #controlPanel,
  #bravia-balls #controlPanel * {
    pointer-events: auto !important;
  }
  
  /* Override Webflow utility classes with high specificity */
  .w-embed.ball-simulation,
  .ball-simulation.w-embed,
  div[id="bravia-balls"].ball-simulation {
    pointer-events: auto !important;
    touch-action: auto !important;
    z-index: 2147483647 !important;
  }
  
  /* Mobile viewport fixes */
  @media (max-width: 768px) {
    #bravia-balls {
      height: 100dvh !important; /* Dynamic viewport height for mobile address bars */
      min-height: -webkit-fill-available !important;
    }
  }
  
  /* Hide FPS counter completely in production */
  #fps-counter,
  #bravia-balls #fps-counter {
    display: none !important;
    visibility: hidden !important;
    pointer-events: none !important;
  }
  
  /* Prevent Webflow animations from affecting simulation */
  #bravia-balls,
  #bravia-balls * {
    animation: none !important;
    transition: none !important;
  }
  
  /* Restore only the dark mode transition */
  #bravia-balls {
    transition: background-color 0.3s ease !important;
  }

  </style>
</head>
<body class="body">
  <div class="noise"></div>
  <div id="bravia-balls">
  <canvas id="c" aria-label="Interactive bouncy balls physics simulation" role="application" draggable="false"></canvas>
  <div class="panel" id="controlPanel" role="region" aria-label="Simulation controls" tabindex="-1">
  
  <!-- Draggable header -->
  <div class="panel-header" id="panelHeader" role="banner">
    <span><span class="drag-handle" aria-hidden="true">⋮⋮</span>Controls</span>
    <button style="cursor: pointer; opacity: 0.7; background: none; border: none; color: inherit; font-size: 16px; padding: 0;" id="minimizePanel" title="Toggle panel" aria-label="Toggle control panel" aria-expanded="true">−</button>
  </div>
  
  <!-- Screen reader announcements -->
  <div role="status" aria-live="polite" aria-atomic="true" style="position: absolute; left: -10000px; width: 1px; height: 1px; overflow: hidden;" id="announcer"></div>
  
  <!-- 120 FPS Performance Mode Toggle (TOP PRIORITY) -->
  <div style="margin-bottom: 12px; padding: 8px; background: rgba(255,0,0,0.15); border-radius: 4px; border: 1px solid rgba(255,0,0,0.3);">
    <label style="display: flex; align-items: center; cursor: pointer; font-weight: 600; font-size: 11px;">
      <input type="checkbox" id="performanceModeToggle" style="margin-right: 8px; cursor: pointer;">
      <span>⚡ 120 FPS Performance Mode</span>
    </label>
    <div style="font-size: 9px; opacity: 0.7; margin-top: 6px; line-height: 1.3;">
      Aggressive optimizations: reduces balls, disables glass morphism, targets 120 FPS
    </div>
    <div id="performanceModeStatus" style="font-size: 9px; margin-top: 6px; padding: 4px; background: rgba(0,0,0,0.2); border-radius: 3px; font-family: monospace;">
      🎨 Normal Mode (350 balls)
    </div>
  </div>
  
  <!-- Dark Mode Toggle -->
  <div style="margin-bottom: 12px; padding: 8px; background: rgba(100,100,255,0.15); border-radius: 4px; border: 1px solid rgba(100,100,255,0.3);">
    <label style="display: flex; align-items: center; cursor: pointer; font-weight: 600; font-size: 11px;">
      <input type="checkbox" id="darkModeToggle" style="margin-right: 8px; cursor: pointer;">
      <span>🌙 Auto Dark Mode</span>
    </label>
    <div style="font-size: 9px; opacity: 0.7; margin-top: 6px; line-height: 1.3;">
      Automatically enables dark background from sunset (6 PM) to sunrise (6 AM)
    </div>
    <div id="darkModeStatus" style="font-size: 9px; margin-top: 6px; padding: 4px; background: rgba(0,0,0,0.2); border-radius: 3px; font-family: monospace;">
      ☀️ Day Mode
    </div>
  </div>
  
  <!-- ═══════════════════════════════════════════════════════════════════════ -->
  <!-- GLOBAL SETTINGS (apply to ALL modes) - ABOVE MODE SWITCHER             -->
  <!-- ═══════════════════════════════════════════════════════════════════════ -->
  
  <details open>
    <summary>🌐 Global Ball Properties</summary>
    <div class="group">
        <label title="Global ball size scale (0.1-6.0). Smaller = more balls fit, larger = more dramatic collisions">Size: <span class="val" id="sizeValGlobal">1.0</span><input type="range" id="sizeSliderGlobal" min="0.1" max="6.0" step="0.05" value="1.0"></label>
        <label title="Ball deformation on collision (0-100). 0 = rigid/hard, 100 = very soft/squishy">Softness: <span class="val" id="ballSoftnessValGlobal">20</span><input type="range" id="ballSoftnessSliderGlobal" min="0" max="100" step="1" value="20"></label>
        <div style="font-size: 9px; opacity: 0.7; margin-top: 4px;">Softness: 0 = rigid, 20 = subtle, 100 = very squishy</div>
    </div>
  </details>
  
  <!-- Build Controls -->
  <div style="margin-bottom: 12px; padding: 8px; background: rgba(0,255,0,0.1); border-radius: 4px; text-align: center;">
    <button id="saveConfigBtn" style="background: #4CAF50; color: white; border: none; padding: 8px 16px; border-radius: 4px; cursor: pointer; font-weight: bold; margin-right: 8px;">💾 Save Config</button>
    <button id="buildBtn" style="background: #2196F3; color: white; border: none; padding: 8px 16px; border-radius: 4px; cursor: pointer; font-weight: bold;">🚀 Build Embed</button>
    <div style="font-size: 9px; opacity: 0.7; margin-top: 6px; line-height: 1.3;">Save downloads current-config.json → replace in source/ folder</div>
    <div id="configOutput" style="margin-top: 8px; font-family: monospace; font-size: 10px; color: #333; max-height: 120px; overflow-y: auto; display: none; text-align: left; background: rgba(255,255,255,0.8); padding: 6px; border-radius: 3px;"></div>
    </div>
  
  <details open>
    <summary>🎨 Colors</summary>
    <div class="group">
        <label>Color template: <select id="colorSelect"></select></label>
        <label>Color 1 (50%): <input type="color" id="color1" value="#ffffff"> <span class="hex-val" id="color1Val">#ffffff</span></label>
        <label>Color 2 (25%): <input type="color" id="color2" value="#f8f9fa"> <span class="hex-val" id="color2Val">#f8f9fa</span></label>
        <label>Color 3 (12%): <input type="color" id="color3" value="#e9ecef"> <span class="hex-val" id="color3Val">#e9ecef</span></label>
        <label>Color 4 (6%): <input type="color" id="color4" value="#d90429"> <span class="hex-val" id="color4Val">#d90429</span></label>
        <label>Color 5 (3%): <input type="color" id="color5" value="#000000"> <span class="hex-val" id="color5Val">#000000</span></label>
        <label>Color 6 (2%): <input type="color" id="color6" value="#54d4ff"> <span class="hex-val" id="color6Val">#54d4ff</span></label>
        <label>Color 7 (1%): <input type="color" id="color7" value="#b589ff"> <span class="hex-val" id="color7Val">#b589ff</span></label>
        <label>Color 8 (1%): <input type="color" id="color8" value="#ffc27a"> <span class="hex-val" id="color8Val">#ffc27a</span></label>
        <label>Cursor color:
          <select id="cursorColorSelect">
            <option value="1">Color 1</option>
            <option value="2">Color 2</option>
            <option value="3">Color 3</option>
            <option value="4">Color 4</option>
            <option value="5" selected>Color 5 (highlight)</option>
            <option value="6">Color 6</option>
            <option value="7">Color 7</option>
            <option value="8">Color 8</option>
          </select>
        </label>
        <div style="font-size: 9px; opacity: 0.7; margin-top: 4px;">Colors appear by weight: 1 is most common, 8 is rarest</div>
    </div>
  </details>
  
  <details open>
    <summary>🌑 Canvas Shadow</summary>
    <div class="group">
      <label title="Enable/disable canvas drop-shadow filter">
        <span>Shadow enabled</span>
        <input type="checkbox" id="canvasShadowEnabled">
      </label>
      <label title="Shadow horizontal offset (-20 to 20px)">
        <span>Shadow X offset (px)</span>
        <input type="range" id="shadowOffsetX" min="-20" max="20" step="0.1" value="1">
        <span class="val" id="shadowOffsetXVal">1</span>
      </label>
      <label title="Shadow vertical offset (-20 to 20px)">
        <span>Shadow Y offset (px)</span>
        <input type="range" id="shadowOffsetY" min="-20" max="20" step="0.1" value="1">
        <span class="val" id="shadowOffsetYVal">1</span>
      </label>
      <label title="Shadow blur radius (0-30px)">
        <span>Shadow blur (px)</span>
        <input type="range" id="shadowBlur" min="0" max="30" step="0.1" value="0">
        <span class="val" id="shadowBlurVal">0</span>
          </label>
      <label title="Shadow opacity (0-1)">
        <span>Shadow opacity</span>
        <input type="range" id="shadowOpacity" min="0" max="1" step="0.01" value="0.29">
        <span class="val" id="shadowOpacityVal">0.29</span>
          </label>
      <label title="Shadow color">
        <span>Shadow color</span>
        <input type="color" id="shadowColor" value="#000000">
        <span class="hex-val" id="shadowColorVal">#000000</span>
          </label>
      <label title="Additional shadow layer for depth">
        <span>Second shadow enabled</span>
        <input type="checkbox" id="shadow2Enabled">
          </label>
      <label title="Second shadow blur (0-20px)">
        <span>Shadow 2 blur (px)</span>
        <input type="range" id="shadow2Blur" min="0" max="20" step="1" value="4">
        <span class="val" id="shadow2BlurVal">4</span>
          </label>
      <label title="Second shadow opacity (0-1)">
        <span>Shadow 2 opacity</span>
        <input type="range" id="shadow2Opacity" min="0" max="1" step="0.01" value="0.10">
        <span class="val" id="shadow2OpacityVal">0.10</span>
          </label>
    </div>
  </details>
  
  <!-- ═══════════════════════════════════════════════════════════════════════ -->
  <!--                        MODE SWITCHER & MODE SETTINGS                     -->
  <!-- ═══════════════════════════════════════════════════════════════════════ -->
  
  <div style="margin: 20px 0; padding: 12px 0; border-top: 1px solid rgba(255,255,255,0.15);">
    <div style="text-align: center; font-size: 10px; font-weight: 600; text-transform: uppercase; letter-spacing: 1px; opacity: 0.6; margin-bottom: 12px;">
      Mode Settings
    </div>
    
    <!-- Mode Switcher -->
    <div class="mode-switcher" style="margin-bottom: 16px;" role="group" aria-label="Simulation mode selector">
      <button class="mode-button active" data-mode="pit" aria-label="Ball Pit mode" aria-pressed="true">🎯 Pit</button>
      <button class="mode-button" data-mode="flies" aria-label="Flies to Light mode" aria-pressed="false">🕊️ Flies</button>
      <button class="mode-button" data-mode="weightless" aria-label="Zero Gravity mode" aria-pressed="false">🌌 Zero-G</button>
      <button class="mode-button" data-mode="pulse-grid" aria-label="Pulse Grid mode" aria-pressed="false">🎹 Pulse</button>
      <button class="mode-button" data-mode="vortex" aria-label="Vortex Spiral mode" aria-pressed="false">🌀 Vortex</button>
    </div>
  </div>
  
  <div id="pitControls" class="mode-controls active">
    <details open>
      <summary>🎯 Ball Pit Mode</summary>
      <div class="group">
        <label title="Choose physics preset (Rubber, Bouncy, etc.)">
          <span>Physics template</span>
          <select id="physicsSelect"></select>
        </label>
        <label title="Gravity strength (0.0-2.0× Earth gravity). Config: 0 = zero gravity (weightless)">
          <span>Gravity (×Earth)</span>
          <input type="range" id="gravityPitSlider" min="0.0" max="2.0" step="0.05" value="0.0">
          <span class="val" id="gravityPitVal">0.0</span>
        </label>
        <label title="Ball mass/weight (50-200 grams). Config: 19.8g for lighter feel">
          <span>Weight (grams)</span>
          <input type="range" id="weightPitSlider" min="10.0" max="200.0" step="1.0" value="19.8">
          <span class="val" id="weightPitVal">19.8</span>
        </label>
        <label title="Bounce restitution (0.0-1.0). Config: 0.97 for bouncier feel">
          <span>Bounciness</span>
          <input type="range" id="restitutionSlider" min="0.00" max="1.00" step="0.01" value="0.97">
          <span class="val" id="restitutionVal">0.97</span>
        </label>
        <label title="Air resistance/friction (0.000-0.010). Config: 0.0035 for light drag">
          <span>Air friction</span>
          <input type="range" id="frictionSlider" min="0.000" max="0.010" step="0.0005" value="0.0035">
          <span class="val" id="frictionVal">0.0035</span>
        </label>
      </div>
    </details>
    <details open>
      <summary>🖼️ Scene & Effects</summary>
      <div class="group">
        <label title="Maximum number of balls in simulation (50-800). Higher = more crowded. Config: 350 for zero-gravity">
          <span>Max balls</span>
          <input type="range" id="maxBallsSlider" min="50" max="800" step="25" value="350">
          <span class="val" id="maxBallsVal">350</span>
        </label>
        <label title="Rounded corner radius for viewport (0-50 pixels). 0 = sharp corners">
          <span>Corner radius (px)</span>
          <input type="range" id="cornerRadiusSlider" min="0" max="50" step="2" value="0">
          <span class="val" id="cornerRadiusVal">0</span>
        </label>
        <label title="Motion blur trail length (0.0-0.5). Config: 0.025 for subtle trails">
          <span>Motion blur</span>
          <input type="range" id="trailFadeSlider" min="0.000" max="0.500" step="0.005" value="0.025">
          <span class="val" id="trailFadeVal">0.025</span>
        </label>
        <label title="Motion blur intensity (0.5-2.0×). Config: 1.8× for pronounced trails">
          <span>Blur intensity</span>
          <input type="range" id="trailSubtletySlider" min="0.50" max="2.00" step="0.05" value="1.80">
          <span class="val" id="trailSubtletyVal">1.80×</span>
        </label>
        <div style="font-size: 9px; opacity: 0.7; margin-top: 4px;">Motion blur works in all modes</div>
      </div>
    </details>
    <details open>
      <summary>🎯 Spawn Settings</summary>
      <div class="group">
        <label title="Choose spawn behavior preset">
          <span>Spawn template</span>
          <select id="spawnSelect"></select>
        </label>
        <label title="Time between ball spawns (0.01-0.5 seconds). Lower = more frequent">
          <span>Emit interval (s)</span>
          <input type="range" id="emitterSlider" min="0.010" max="0.500" step="0.005" value="0.04">
          <span class="val" id="emitterVal">0.04</span>
        </label>
        <label title="Vertical spawn position (-100 to 100% viewport height). Negative = above viewport">
          <span>Spawn Y position (%)</span>
          <input type="range" id="spawnYSlider" min="-100" max="100" step="5" value="-50">
          <span class="val" id="spawnYVal">-50</span>
        </label>
        <label title="Horizontal spawn area width (10-100% viewport width). 100% = full width">
          <span>Spawn width (%)</span>
          <input type="range" id="spawnWidthSlider" min="10" max="100" step="5" value="100">
          <span class="val" id="spawnWidthVal">100</span>
        </label>
        <label title="Horizontal spawn center position (0-100% viewport width). 50% = center">
          <span>Spawn X center (%)</span>
          <input type="range" id="spawnCenterSlider" min="0" max="100" step="5" value="50">
          <span class="val" id="spawnCenterVal">50</span>
        </label>
        <label title="Vertical spawn area height (10-100% viewport height)">
          <span>Spawn height (%)</span>
          <input type="range" id="spawnHeightSlider" min="10" max="100" step="5" value="50">
          <span class="val" id="spawnHeightVal">50</span>
        </label>
      </div>
    </details>
    <details open>
      <summary>🧲 Mouse Repeller</summary>
      <div class="group">
        <label title="Choose repeller behavior preset">
          <span>Repeller template</span>
          <select id="repellerSelect"></select>
        </label>
        <label title="Enable/disable mouse repeller effect">
          <span>Repeller active</span>
          <input type="checkbox" id="repellerEnabledPit" checked>
        </label>
        <label title="Repeller influence radius (50-1000 pixels). Larger = affects more balls">
          <span>Repel size (px)</span>
          <input type="range" id="repelSizeSlider" min="50" max="1000" step="5" value="710">
          <span class="val" id="repelSizeVal">710</span>
        </label>
        <label title="Repulsion strength (0-10000). Higher = stronger push away from mouse">
          <span>Repel power</span>
          <input type="range" id="repelPowerSlider" min="0" max="10000" step="100" value="7920">
          <span class="val" id="repelPowerVal">274000</span>
        </label>
        <label title="Repeller field softness (0.5-5.0). Lower = sharper cutoff, higher = gradual fade">
          <span>Repel softness</span>
          <input type="range" id="repelSoftSlider" min="0.5" max="5.0" step="0.1" value="2.0">
          <span class="val" id="repelSoftVal">2.0</span>
        </label>
      </div>
    </details>
  </div>
  
  <div id="fliesControls" class="mode-controls">
    <details open>
      <summary>🕊️ Flies to Light Mode</summary>
      <div class="group">
        <label title="Attraction strength toward mouse (100-8000). Higher = stronger pull toward cursor">
          <span>Attraction power</span>
          <input type="range" id="attractPowerSlider" min="100" max="8000" step="50" value="5000">
          <span class="val" id="attractPowerVal">5000</span>
        </label>
        <label title="Orbit distance around mouse (50-400 pixels). Larger = wider swarm formation">
          <span>Orbit radius (px)</span>
          <input type="range" id="orbitRadiusSlider" min="50" max="400" step="10" value="180">
          <span class="val" id="orbitRadiusVal">180</span>
        </label>
        <label title="Swarm movement speed (0.2-5.0×). Higher = faster, more responsive">
          <span>Swarm speed (×)</span>
          <input type="range" id="swarmSpeedSlider" min="0.2" max="5.0" step="0.1" value="3.5">
          <span class="val" id="swarmSpeedVal">3.5</span>
        </label>
      </div>
    </details>
  </div>
  
  <!-- Weightless Mode Controls -->
  <div id="weightlessControls" class="mode-controls">
    <details open>
      <summary>🌌 Zero-G Mode</summary>
      <div class="group">
        <label title="Number of balls in scene (20-200). Fixed count, no spawning">
          <span>Ball count</span>
          <input type="range" id="weightlessCountSlider" min="20" max="200" step="10" value="80">
          <span class="val" id="weightlessCountVal">80</span>
        </label>
        <label title="Initial velocity magnitude (100-600 pixels/second). Realistic space: 200-300. Higher = faster motion">
          <span>Initial speed (px/s)</span>
          <input type="range" id="weightlessSpeedSlider" min="100" max="600" step="25" value="250">
          <span class="val" id="weightlessSpeedVal">250</span>
        </label>
        <label title="Wall bounce elasticity (0.8-1.0). Realistic space: 0.95-0.98. 1.0 = perfect energy conservation">
          <span>Bounce elasticity</span>
          <input type="range" id="weightlessBounceSlider" min="0.8" max="1.0" step="0.01" value="0.97">
          <span class="val" id="weightlessBounceVal">0.97</span>
        </label>
      </div>
    </details>
    <details open>
      <summary>🧲 Mouse Repeller</summary>
      <div class="group">
        <label title="Repeller strength (0-10000). 0 = disabled. Controls how strongly balls are pushed away from cursor">
          <span>Repeller power</span>
          <input type="range" id="weightlessRepelSlider" min="0" max="10000" step="100" value="300">
          <span class="val" id="weightlessRepelVal">300</span>
        </label>
        <label title="Repeller radius (50-300 pixels). Larger = wider push area around cursor">
          <span>Repeller radius (px)</span>
          <input type="range" id="weightlessRepelRadiusSlider" min="50" max="300" step="10" value="150">
          <span class="val" id="weightlessRepelRadiusVal">150</span>
        </label>
      </div>
    </details>
  </div>
  
  <!-- Pulse Grid Mode Controls -->
  <div id="pulseGridControls" class="mode-controls">
    <details open>
      <summary>🎹 Pulse Grid Mode</summary>
      <div class="group">
        <label title="Choose animation preset">
          <span>Animation preset</span>
          <select id="gridPresetSelect">
            <option value="synchronized">✨ Synchronized Pulse</option>
            <option value="organic" selected>🌿 Organic Flow</option>
            <option value="chaotic">⚡ Chaotic Dance</option>
          </select>
        </label>
        <label title="Number of balls in grid (40-200)">
          <span>Ball count</span>
          <input type="range" id="gridBallCountSlider" min="40" max="200" step="10" value="120">
          <span class="val" id="gridBallCountVal">120</span>
        </label>
        <label title="Number of columns in the grid (20-80). More columns = smaller cells">
          <span>Grid columns</span>
          <input type="range" id="gridColumnsSlider" min="20" max="80" step="5" value="40">
          <span class="val" id="gridColumnsVal">40</span>
        </label>
      </div>
    </details>
    <details open>
      <summary>⚡ Movement & Rhythm</summary>
      <div class="group">
        <label title="Time between movements in seconds (0.2-2.0). Lower = faster rhythm">
          <span>Beat interval (s)</span>
          <input type="range" id="pulseIntervalSlider" min="0.2" max="2.0" step="0.1" value="0.8">
          <span class="val" id="pulseIntervalVal">0.8</span>
        </label>
        <label title="Jump animation duration (0.1-1.0 seconds). Should be less than beat interval">
          <span>Jump speed (s)</span>
          <input type="range" id="pulseSpeedSlider" min="0.1" max="1.0" step="0.05" value="0.25">
          <span class="val" id="pulseSpeedVal">0.25</span>
        </label>
        <label title="Minimum grid cells to move (1-3)">
          <span>Min steps</span>
          <input type="range" id="pulseMinStepsSlider" min="1" max="3" step="1" value="1">
          <span class="val" id="pulseMinStepsVal">1</span>
        </label>
        <label title="Maximum grid cells to move (1-5)">
          <span>Max steps</span>
          <input type="range" id="pulseMaxStepsSlider" min="1" max="5" step="1" value="3">
          <span class="val" id="pulseMaxStepsVal">3</span>
        </label>
      </div>
    </details>
    <details open>
      <summary>🎭 Coordination & Chaos</summary>
      <div class="group">
        <label title="Movement synchronization (0-1). 0 = all balls move together, 1 = completely random timing">
          <span>Synchronicity</span>
          <input type="range" id="pulseSynchronicitySlider" min="0.0" max="1.0" step="0.05" value="0.3">
          <span class="val" id="pulseSynchronicityVal">0.30</span>
        </label>
        <label title="Movement variation (0-1). 0 = uniform, 1 = chaotic and unpredictable">
          <span>Randomness</span>
          <input type="range" id="pulseRandomnessSlider" min="0.0" max="1.0" step="0.05" value="0.4">
          <span class="val" id="pulseRandomnessVal">0.40</span>
        </label>
      </div>
    </details>
    <details open>
      <summary>🤖 Animation Style</summary>
      <div class="group">
        <label title="Animation easing style">
          <span>Easing style</span>
          <select id="pulseEasingSelect">
            <option value="linear">Linear (Constant speed)</option>
            <option value="snap" selected>Snap (Robotic)</option>
            <option value="bounce">Bounce (Elastic)</option>
            <option value="smooth">Smooth (Ease in-out)</option>
          </select>
        </label>
        <label title="Overshoot amount (1.0-1.3). 1.0 = no overshoot, 1.2 = 20% overshoot for robotic snap">
          <span>Overshoot</span>
          <input type="range" id="pulseOvershootSlider" min="1.0" max="1.3" step="0.01" value="1.08">
          <span class="val" id="pulseOvershootVal">1.08</span>
        </label>
        <label title="Bounce-back intensity (0-0.5). Higher = more pronounced settle-back effect">
          <span>Bounce intensity</span>
          <input type="range" id="pulseBounceSlider" min="0.0" max="0.5" step="0.01" value="0.15">
          <span class="val" id="pulseBounceVal">0.15</span>
        </label>
      </div>
    </details>
  </div>
  
  <!-- Vortex Mode Controls -->
  <div id="vortexControls" class="mode-controls">
    <details open>
      <summary>🌀 Vortex Spiral Mode</summary>
      <div class="group">
        <label title="Number of orbiting balls (50-300)">
          <span>Ball count</span>
          <input type="range" id="vortexBallCountSlider" min="50" max="300" step="10" value="200">
          <span class="val" id="vortexBallCountVal">200</span>
        </label>
        <label title="Central gravity well strength (1000-15000)">
          <span>Well strength</span>
          <input type="range" id="vortexWellStrengthSlider" min="1000" max="15000" step="500" value="5000">
          <span class="val" id="vortexWellStrengthVal">5000</span>
        </label>
        <label title="Mouse cursor gravity well strength (0-10000)">
          <span>Mouse strength</span>
          <input type="range" id="vortexMouseStrengthSlider" min="0" max="10000" step="500" value="3000">
          <span class="val" id="vortexMouseStrengthVal">3000</span>
        </label>
        <label title="Initial orbital velocity (50-400 px/s)">
          <span>Initial speed</span>
          <input type="range" id="vortexInitialSpeedSlider" min="50" max="400" step="10" value="180">
          <span class="val" id="vortexInitialSpeedVal">180</span>
        </label>
        <label title="Orbital decay rate (-0.001 to 0.001). Positive = spiral in, negative = spiral out">
          <span>Orbital decay</span>
          <input type="range" id="vortexDecaySlider" min="-0.001" max="0.001" step="0.0001" value="0.0002">
          <span class="val" id="vortexDecayVal">0.0002</span>
        </label>
        <label title="Color balls based on speed (blue=slow, red=fast)">
          <span>Speed coloring</span>
          <input type="checkbox" id="vortexSpeedColorCheckbox" checked>
        </label>
      </div>
    </details>
    
    <!-- Save & Reset Controls -->
    <div style="margin-top: 16px; padding-top: 16px; border-top: 2px solid rgba(255,255,255,0.15);">
      <button id="resetBtn" style="padding: 10px 16px; background: #ff6b47; color: white; border: none; border-radius: 4px; cursor: pointer; font-weight: 600; width: 100%; font-size: 14px;">🔄 Reset to Defaults</button>
      <div style="font-size: 9px; opacity: 0.7; margin-top: 8px; text-align: center;">Clears saved settings & reloads with defaults</div>
    </div>
  </div>
  
    <div style="font-size:10px; opacity:0.8;">Press <code>R</code> to reset • <code>/</code> toggle panel • <code>1-5</code> switch modes</div>
  </div>
  
  <!-- FPS Counter -->
  <!-- FPS counter removed in production -->
</div>
  <header class="viewport viewport--content">
    <div id="w-node-e6a615f7-c7b2-8768-3157-95ffa1ec0a09-d5c39cf1" class="legend">
      <div class="w-layout-hflex legend__item">
        <div class="circle bg-ball-1"></div>
        <div>Creative Strategy</div>
      </div>
      <div class="w-layout-hflex legend__item">
        <div class="circle bg-ball-3"></div>
        <div>Visual Design</div>
      </div>
      <div class="w-layout-hflex legend__item">
        <div class="circle bg-ball-5"></div>
        <div>Precision Typography</div>
      </div>
      <div class="w-layout-hflex legend__item">
        <div class="circle bg-ball-2"></div>
        <div>Design Strategy</div>
      </div>
      <div class="w-layout-hflex legend__item">
        <div class="circle bg-ball-4"></div>
        <div>Brand &amp; Experience</div>
      </div>
      <div class="w-layout-hflex legend__item">
        <div class="circle bg-ball-6"></div>
        <div>AI Technologist</div>
      </div>
    </div>
    <div id="w-node-_38b28c23-04bb-05c7-72ee-2ae65152e2c6-d5c39cf1" class="header is-align-center">
      <div class="hero__text w-embed"><svg viewbox="0 0 921 123" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M1.76 93L24.288 30.52H34.496L57.024 93H48.752L42.504 75.224H16.28L10.032 93H1.76ZM18.832 67.832H39.952L29.392 37.12L18.832 67.832ZM72.3333 93C69.6346 93 67.4346 92.296 65.7333 90.888C64.0319 89.48 63.1813 87.2507 63.1813 84.2V30.52H70.5733V83.584C70.5733 84.5227 70.8079 85.256 71.2773 85.784C71.8053 86.2533 72.5386 86.488 73.4773 86.488H77.5253V93H72.3333ZM102.218 94.056C97.8182 94.056 94.0049 93.0587 90.7782 91.064C87.6102 89.0693 85.1462 86.2533 83.3862 82.616C81.6849 78.92 80.8342 74.608 80.8342 69.68C80.8342 64.752 81.6849 60.4693 83.3862 56.832C85.1462 53.1947 87.5809 50.3787 90.6902 48.384C93.8582 46.3307 97.5835 45.304 101.866 45.304C105.914 45.304 109.493 46.272 112.602 48.208C115.712 50.0853 118.117 52.8427 119.818 56.48C121.578 60.1173 122.458 64.5467 122.458 69.768V71.968H88.5782C88.8715 76.9547 90.1915 80.7093 92.5382 83.232C94.9435 85.7547 98.1702 87.016 102.218 87.016C105.269 87.016 107.762 86.312 109.698 84.904C111.693 83.4373 113.072 81.5307 113.834 79.184L121.754 79.8C120.522 83.9653 118.176 87.3973 114.714 90.096C111.312 92.736 107.146 94.056 102.218 94.056ZM88.5782 65.456H114.362C114.01 60.9387 112.69 57.624 110.402 55.512C108.173 53.4 105.328 52.344 101.866 52.344C98.2875 52.344 95.3249 53.4587 92.9782 55.688C90.6902 57.8587 89.2235 61.1147 88.5782 65.456ZM126.906 93L144.066 69.064L127.786 46.36H136.41L148.642 63.96L160.522 46.36H169.322L153.218 69.24L170.114 93H161.49L148.642 74.168L135.706 93H126.906ZM192.551 94.056C188.092 94.056 184.396 92.9413 181.463 90.712C178.588 88.4827 176.418 85.52 174.951 81.824C173.543 78.128 172.839 74.08 172.839 69.68C172.839 65.3387 173.543 61.32 174.951 57.624C176.359 53.928 178.5 50.9653 181.375 48.736C184.308 46.448 188.004 45.304 192.463 45.304C195.924 45.304 198.858 45.9787 201.263 47.328C203.727 48.6773 205.604 50.5253 206.895 52.872V46.36H214.287V93H207.599L207.247 82.44L208.303 83.32C207.658 85.4907 206.602 87.3973 205.135 89.04C203.727 90.624 201.967 91.856 199.855 92.736C197.743 93.616 195.308 94.056 192.551 94.056ZM194.047 87.016C197.274 87.016 199.796 86.1947 201.615 84.552C203.492 82.8507 204.842 80.68 205.663 78.04C206.484 75.3413 206.895 72.5547 206.895 69.68C206.895 66.6293 206.484 63.8133 205.663 61.232C204.842 58.592 203.492 56.4507 201.615 54.808C199.796 53.1653 197.274 52.344 194.047 52.344C190.938 52.344 188.386 53.1653 186.391 54.808C184.396 56.392 182.93 58.504 181.991 61.144C181.052 63.7253 180.583 66.5707 180.583 69.68C180.583 72.6133 181.023 75.4293 181.903 78.128C182.842 80.768 184.308 82.9093 186.303 84.552C188.298 86.1947 190.879 87.016 194.047 87.016ZM225.703 93V46.36H232.479L232.743 58.24L231.863 57.448C232.449 54.6907 233.476 52.432 234.943 50.672C236.409 48.8533 238.169 47.504 240.223 46.624C242.335 45.744 244.593 45.304 246.999 45.304C250.577 45.304 253.511 46.096 255.799 47.68C258.145 49.264 259.876 51.4053 260.991 54.104C262.164 56.744 262.751 59.7067 262.751 62.992V93H255.359V65.104C255.359 62.2293 255.007 59.824 254.303 57.888C253.657 55.8933 252.601 54.3973 251.135 53.4C249.668 52.344 247.761 51.816 245.415 51.816C241.836 51.816 238.873 52.96 236.527 55.248C234.239 57.4773 233.095 60.7627 233.095 65.104V93H225.703ZM290.74 94.056C286.692 94.056 283.172 93.0587 280.18 91.064C277.246 89.0693 274.988 86.2533 273.404 82.616C271.82 78.9787 271.028 74.6667 271.028 69.68C271.028 64.6933 271.82 60.3813 273.404 56.744C274.988 53.1067 277.246 50.2907 280.18 48.296C283.172 46.3013 286.692 45.304 290.74 45.304C293.849 45.304 296.694 45.9787 299.276 47.328C301.857 48.6187 303.793 50.4667 305.084 52.872V30.52H312.476V93H305.788L305.524 85.96C304.233 88.4827 302.268 90.4773 299.628 91.944C296.988 93.352 294.025 94.056 290.74 94.056ZM292.236 87.016C294.993 87.016 297.31 86.312 299.188 84.904C301.124 83.496 302.59 81.5013 303.588 78.92C304.585 76.28 305.084 73.2 305.084 69.68C305.084 66.0427 304.585 62.9333 303.588 60.352C302.59 57.7707 301.124 55.8053 299.188 54.456C297.31 53.048 294.993 52.344 292.236 52.344C288.129 52.344 284.844 53.8987 282.38 57.008C279.974 60.0587 278.772 64.2827 278.772 69.68C278.772 75.0187 279.974 79.2427 282.38 82.352C284.844 85.4613 288.129 87.016 292.236 87.016ZM342.108 94.056C337.708 94.056 333.894 93.0587 330.668 91.064C327.5 89.0693 325.036 86.2533 323.276 82.616C321.574 78.92 320.724 74.608 320.724 69.68C320.724 64.752 321.574 60.4693 323.276 56.832C325.036 53.1947 327.47 50.3787 330.58 48.384C333.748 46.3307 337.473 45.304 341.756 45.304C345.804 45.304 349.382 46.272 352.492 48.208C355.601 50.0853 358.006 52.8427 359.708 56.48C361.468 60.1173 362.348 64.5467 362.348 69.768V71.968H328.468C328.761 76.9547 330.081 80.7093 332.428 83.232C334.833 85.7547 338.06 87.016 342.108 87.016C345.158 87.016 347.652 86.312 349.588 84.904C351.582 83.4373 352.961 81.5307 353.724 79.184L361.644 79.8C360.412 83.9653 358.065 87.3973 354.604 90.096C351.201 92.736 347.036 94.056 342.108 94.056ZM328.468 65.456H354.252C353.9 60.9387 352.58 57.624 350.292 55.512C348.062 53.4 345.217 52.344 341.756 52.344C338.177 52.344 335.214 53.4587 332.868 55.688C330.58 57.8587 329.113 61.1147 328.468 65.456ZM370.58 93V46.36H377.092L377.444 58.152L376.74 57.888C377.326 53.8987 378.588 50.9947 380.524 49.176C382.518 47.2987 385.158 46.36 388.444 46.36H393.02V53.4H388.532C386.185 53.4 384.22 53.84 382.636 54.72C381.11 55.5413 379.937 56.8027 379.116 58.504C378.353 60.1467 377.972 62.2587 377.972 64.84V93H370.58ZM419.059 93V30.52H440.531C447.923 30.52 453.467 31.8693 457.163 34.568C460.859 37.2667 462.707 41.52 462.707 47.328C462.707 50.0267 462.121 52.4027 460.947 54.456C459.774 56.5093 458.102 58.1227 455.931 59.296C453.761 60.4107 451.179 60.968 448.187 60.968L448.099 60.44C453.438 60.44 457.633 61.8773 460.683 64.752C463.793 67.568 465.347 71.264 465.347 75.84C465.347 81.5307 463.499 85.8133 459.803 88.688C456.107 91.5627 450.857 93 444.051 93H419.059ZM426.627 85.608H444.051C448.334 85.608 451.619 84.728 453.907 82.968C456.254 81.208 457.427 78.6853 457.427 75.4C457.427 72.1147 456.254 69.5627 453.907 67.744C451.619 65.8667 448.334 64.928 444.051 64.928H426.627V85.608ZM426.627 57.536H440.531C445.107 57.536 448.627 56.6853 451.091 54.984C453.555 53.224 454.787 50.7893 454.787 47.68C454.787 44.3947 453.585 41.96 451.179 40.376C448.833 38.7333 445.283 37.912 440.531 37.912H426.627V57.536ZM492.512 94.056C488.112 94.056 484.299 93.0587 481.072 91.064C477.904 89.0693 475.44 86.2533 473.68 82.616C471.979 78.92 471.128 74.608 471.128 69.68C471.128 64.752 471.979 60.4693 473.68 56.832C475.44 53.1947 477.875 50.3787 480.984 48.384C484.152 46.3307 487.877 45.304 492.16 45.304C496.208 45.304 499.787 46.272 502.896 48.208C506.005 50.0853 508.411 52.8427 510.112 56.48C511.872 60.1173 512.752 64.5467 512.752 69.768V71.968H478.872C479.165 76.9547 480.485 80.7093 482.832 83.232C485.237 85.7547 488.464 87.016 492.512 87.016C495.563 87.016 498.056 86.312 499.992 84.904C501.987 83.4373 503.365 81.5307 504.128 79.184L512.048 79.8C510.816 83.9653 508.469 87.3973 505.008 90.096C501.605 92.736 497.44 94.056 492.512 94.056ZM478.872 65.456H504.656C504.304 60.9387 502.984 57.624 500.696 55.512C498.467 53.4 495.621 52.344 492.16 52.344C488.581 52.344 485.619 53.4587 483.272 55.688C480.984 57.8587 479.517 61.1147 478.872 65.456ZM540.08 94.056C535.739 94.056 531.955 93.0587 528.728 91.064C525.56 89.0693 523.096 86.2533 521.336 82.616C519.576 78.92 518.696 74.608 518.696 69.68C518.696 64.752 519.576 60.4693 521.336 56.832C523.096 53.1947 525.56 50.3787 528.728 48.384C531.955 46.3307 535.739 45.304 540.08 45.304C543.659 45.304 546.827 45.9493 549.584 47.24C552.4 48.472 554.688 50.2907 556.448 52.696C558.208 55.1013 559.352 58.0347 559.88 61.496L552.136 62.024C551.608 58.9147 550.259 56.5387 548.088 54.896C545.917 53.1947 543.248 52.344 540.08 52.344C535.797 52.344 532.453 53.8987 530.048 57.008C527.643 60.0587 526.44 64.2827 526.44 69.68C526.44 75.0773 527.643 79.3307 530.048 82.44C532.453 85.4907 535.797 87.016 540.08 87.016C543.248 87.016 545.917 86.136 548.088 84.376C550.259 82.616 551.608 79.976 552.136 76.456L559.88 76.984C559.352 80.4453 558.208 83.4667 556.448 86.048C554.688 88.5707 552.4 90.536 549.584 91.944C546.827 93.352 543.659 94.056 540.08 94.056ZM567.263 93V30.52H574.655V71.44L597.359 46.36H607.215L588.823 66.16L608.007 93H599.031L583.807 71.176L574.655 80.856V93H567.263ZM655.777 94.408C650.967 94.408 646.772 93.4987 643.193 91.68C639.615 89.8613 636.769 87.368 634.657 84.2C632.604 80.9733 631.401 77.248 631.049 73.024L638.969 72.496C639.38 75.6053 640.289 78.2453 641.697 80.416C643.105 82.5867 644.983 84.2293 647.329 85.344C649.735 86.4587 652.609 87.016 655.953 87.016C658.887 87.016 661.38 86.6347 663.433 85.872C665.487 85.1093 667.041 83.9947 668.097 82.528C669.212 81.0613 669.769 79.272 669.769 77.16C669.769 75.224 669.3 73.5227 668.361 72.056C667.481 70.5307 665.751 69.152 663.169 67.92C660.647 66.6293 656.892 65.368 651.905 64.136C647.095 62.904 643.252 61.5547 640.377 60.088C637.561 58.6213 635.508 56.832 634.217 54.72C632.985 52.608 632.369 49.9973 632.369 46.888C632.369 43.368 633.191 40.288 634.833 37.648C636.535 34.9493 638.94 32.8667 642.049 31.4C645.159 29.8747 648.855 29.112 653.137 29.112C657.713 29.112 661.644 29.992 664.929 31.752C668.215 33.4533 670.825 35.8 672.761 38.792C674.697 41.784 675.9 45.1867 676.369 49L668.449 49.528C668.097 47.0053 667.276 44.776 665.985 42.84C664.753 40.8453 663.052 39.2907 660.881 38.176C658.711 37.0613 656.071 36.504 652.961 36.504C649.089 36.504 646.009 37.4427 643.721 39.32C641.433 41.1387 640.289 43.544 640.289 46.536C640.289 48.472 640.729 50.0853 641.609 51.376C642.548 52.608 644.191 53.7227 646.537 54.72C648.884 55.6587 652.257 56.6853 656.657 57.8C661.879 59.0907 666.015 60.6453 669.065 62.464C672.175 64.224 674.375 66.2773 675.665 68.624C677.015 70.9707 677.689 73.64 677.689 76.632C677.689 80.2693 676.751 83.4373 674.873 86.136C672.996 88.776 670.415 90.8293 667.129 92.296C663.844 93.704 660.06 94.408 655.777 94.408ZM702.21 93C697.986 93 694.848 92.032 692.794 90.096C690.8 88.16 689.802 85.1387 689.802 81.032V35.448H697.194V80.856C697.194 82.968 697.664 84.4347 698.602 85.256C699.541 86.0773 700.978 86.488 702.914 86.488H709.602V93H702.21ZM682.938 52.872V46.36H709.602V52.872H682.938ZM732.271 94.056C727.637 94.056 723.911 92.5013 721.095 89.392C718.338 86.224 716.959 81.8827 716.959 76.368V46.36H724.351V74.344C724.351 78.8613 725.143 82.2053 726.727 84.376C728.37 86.488 730.863 87.544 734.207 87.544C737.903 87.544 740.807 86.3707 742.919 84.024C745.031 81.6187 746.087 78.3333 746.087 74.168V46.36H753.479V93H746.439V81.472L747.583 82.088C746.645 85.9013 744.855 88.864 742.215 90.976C739.575 93.0293 736.261 94.056 732.271 94.056ZM781.481 94.056C777.433 94.056 773.913 93.0587 770.921 91.064C767.987 89.0693 765.729 86.2533 764.145 82.616C762.561 78.9787 761.769 74.6667 761.769 69.68C761.769 64.6933 762.561 60.3813 764.145 56.744C765.729 53.1067 767.987 50.2907 770.921 48.296C773.913 46.3013 777.433 45.304 781.481 45.304C784.59 45.304 787.435 45.9787 790.017 47.328C792.598 48.6187 794.534 50.4667 795.825 52.872V30.52H803.217V93H796.529L796.265 85.96C794.974 88.4827 793.009 90.4773 790.369 91.944C787.729 93.352 784.766 94.056 781.481 94.056ZM782.977 87.016C785.734 87.016 788.051 86.312 789.929 84.904C791.865 83.496 793.331 81.5013 794.329 78.92C795.326 76.28 795.825 73.2 795.825 69.68C795.825 66.0427 795.326 62.9333 794.329 60.352C793.331 57.7707 791.865 55.8053 789.929 54.456C788.051 53.048 785.734 52.344 782.977 52.344C778.87 52.344 775.585 53.8987 773.121 57.008C770.715 60.0587 769.513 64.2827 769.513 69.68C769.513 75.0187 770.715 79.2427 773.121 82.352C775.585 85.4613 778.87 87.016 782.977 87.016ZM814.632 93V46.36H822.024V93H814.632ZM818.416 39.32C817.184 39.32 816.158 38.9387 815.336 38.176C814.574 37.3547 814.192 36.2693 814.192 34.92C814.192 33.6293 814.574 32.5733 815.336 31.752C816.158 30.9307 817.184 30.52 818.416 30.52C819.648 30.52 820.646 30.9307 821.408 31.752C822.23 32.5733 822.64 33.6293 822.64 34.92C822.64 36.2693 822.23 37.3547 821.408 38.176C820.646 38.9387 819.648 39.32 818.416 39.32ZM851.693 94.056C847.41 94.056 843.656 93.0587 840.429 91.064C837.202 89.0693 834.709 86.2533 832.949 82.616C831.189 78.92 830.309 74.608 830.309 69.68C830.309 64.6933 831.189 60.3813 832.949 56.744C834.709 53.1067 837.202 50.2907 840.429 48.296C843.656 46.3013 847.41 45.304 851.693 45.304C855.976 45.304 859.701 46.3013 862.869 48.296C866.096 50.2907 868.589 53.1067 870.349 56.744C872.109 60.3813 872.989 64.6933 872.989 69.68C872.989 74.608 872.109 78.92 870.349 82.616C868.589 86.2533 866.096 89.0693 862.869 91.064C859.701 93.0587 855.976 94.056 851.693 94.056ZM851.693 87.016C855.976 87.016 859.29 85.4907 861.637 82.44C864.042 79.3307 865.245 75.0773 865.245 69.68C865.245 64.2827 864.042 60.0587 861.637 57.008C859.29 53.8987 855.976 52.344 851.693 52.344C847.41 52.344 844.066 53.8987 841.661 57.008C839.256 60.0587 838.053 64.2827 838.053 69.68C838.053 75.0773 839.256 79.3307 841.661 82.44C844.066 85.4907 847.41 87.016 851.693 87.016Z" fill="#161616"></path>
          <ellipse cx="904" cy="50.9883" rx="16" ry="16" stroke="black" style="stroke:black;stroke-opacity:1;" stroke-width="1.5"></ellipse>
          <path d="M909.046 44.9121C910.191 44.9121 911.157 45.2424 911.837 45.8262C912.518 46.4108 912.908 47.2457 912.908 48.2432C912.908 49.4861 912.309 50.4595 911.38 50.7969C912.714 51.1016 913.594 52.194 913.594 53.6748C913.594 55.6619 911.973 57.0575 909.731 57.0576H905.715V44.9121H909.046ZM907.116 55.6562H909.731C910.436 55.6562 911.031 55.4466 911.447 55.0898C911.863 54.7337 912.106 54.2277 912.106 53.624C912.106 53.0203 911.863 52.5144 911.447 52.1582C911.031 51.8013 910.436 51.5909 909.731 51.5908H907.116V55.6562ZM907.116 50.1904H909.046C909.76 50.1904 910.355 49.9887 910.77 49.6465C911.183 49.3052 911.421 48.8204 911.421 48.2432C911.421 47.6656 911.187 47.1854 910.776 46.8486C910.364 46.5108 909.77 46.3135 909.046 46.3135H907.116V50.1904Z" fill="black" stroke="black" style="fill:black;fill-opacity:1;stroke:black;stroke-opacity:1;" stroke-width="0.15"></path>
          <path d="M900.007 44.9121L900.024 44.9629L904.154 56.958L904.188 57.0576H902.677L902.659 57.0068L901.34 53.1846H896.632L895.312 57.0068L895.295 57.0576H893.782L893.816 56.958L897.946 44.9629L897.964 44.9121H900.007ZM897.111 51.7842H900.859L898.993 46.3486L897.111 51.7842Z" fill="black" stroke="black" style="fill:black;fill-opacity:1;stroke:black;stroke-opacity:1;" stroke-width="0.15"></path>
        </svg></div>
    </div>
    <ul role="list" aria-label="Social media links" id="w-node-a3bdcba3-22cc-d78c-cb19-91003b154f3e-d5c39cf1" class="footer_icon-group w-list-unstyled">
      <li class="margin-bottom_none">
        <a href="#" class="footer_icon-link w-inline-block"><svg width="100%" height="100%" viewbox="0 0 16 16">
            <path d="M16,8.048a8,8,0,1,0-9.25,7.9V10.36H4.719V8.048H6.75V6.285A2.822,2.822,0,0,1,9.771,3.173a12.2,12.2,0,0,1,1.791.156V5.3H10.554a1.155,1.155,0,0,0-1.3,1.25v1.5h2.219l-.355,2.312H9.25v5.591A8,8,0,0,0,16,8.048Z" fill="currentColor"></path>
          </svg>
          <div class="screen-reader">Facebook</div>
        </a>
      </li>
      <li class="margin-bottom_none">
        <a href="#" class="footer_icon-link w-inline-block"><svg width="100%" height="100%" viewbox="0 0 16 16">
            <path d="M8,1.441c2.136,0,2.389.009,3.233.047a4.419,4.419,0,0,1,1.485.276,2.472,2.472,0,0,1,.92.6,2.472,2.472,0,0,1,.6.92,4.419,4.419,0,0,1,.276,1.485c.038.844.047,1.1.047,3.233s-.009,2.389-.047,3.233a4.419,4.419,0,0,1-.276,1.485,2.644,2.644,0,0,1-1.518,1.518,4.419,4.419,0,0,1-1.485.276c-.844.038-1.1.047-3.233.047s-2.389-.009-3.233-.047a4.419,4.419,0,0,1-1.485-.276,2.472,2.472,0,0,1-.92-.6,2.472,2.472,0,0,1-.6-.92,4.419,4.419,0,0,1-.276-1.485c-.038-.844-.047-1.1-.047-3.233s.009-2.389.047-3.233a4.419,4.419,0,0,1,.276-1.485,2.472,2.472,0,0,1,.6-.92,2.472,2.472,0,0,1,.92-.6,4.419,4.419,0,0,1,1.485-.276c.844-.038,1.1-.047,3.233-.047M8,0C5.827,0,5.555.009,4.7.048A5.868,5.868,0,0,0,2.76.42a3.908,3.908,0,0,0-1.417.923A3.908,3.908,0,0,0,.42,2.76,5.868,5.868,0,0,0,.048,4.7C.009,5.555,0,5.827,0,8s.009,2.445.048,3.3A5.868,5.868,0,0,0,.42,13.24a3.908,3.908,0,0,0,.923,1.417,3.908,3.908,0,0,0,1.417.923,5.868,5.868,0,0,0,1.942.372C5.555,15.991,5.827,16,8,16s2.445-.009,3.3-.048a5.868,5.868,0,0,0,1.942-.372,4.094,4.094,0,0,0,2.34-2.34,5.868,5.868,0,0,0,.372-1.942c.039-.853.048-1.125.048-3.3s-.009-2.445-.048-3.3A5.868,5.868,0,0,0,15.58,2.76a3.908,3.908,0,0,0-.923-1.417A3.908,3.908,0,0,0,13.24.42,5.868,5.868,0,0,0,11.3.048C10.445.009,10.173,0,8,0Z" fill="currentColor"></path>
            <path d="M8,3.892A4.108,4.108,0,1,0,12.108,8,4.108,4.108,0,0,0,8,3.892Zm0,6.775A2.667,2.667,0,1,1,10.667,8,2.667,2.667,0,0,1,8,10.667Z" fill="currentColor"></path>
            <circle cx="12.27" cy="3.73" r="0.96" fill="currentColor"></circle>
          </svg>
          <div class="screen-reader">Instagram<br></div>
        </a>
      </li>
      <li class="margin-bottom_none">
        <a href="#" class="footer_icon-link w-inline-block"><svg width="100%" height="100%" viewbox="0 0 16 16">
            <path d="M15.3,0H0.7C0.3,0,0,0.3,0,0.7v14.7C0,15.7,0.3,16,0.7,16h14.7c0.4,0,0.7-0.3,0.7-0.7V0.7 C16,0.3,15.7,0,15.3,0z M4.7,13.6H2.4V6h2.4V13.6z M3.6,5C2.8,5,2.2,4.3,2.2,3.6c0-0.8,0.6-1.4,1.4-1.4c0.8,0,1.4,0.6,1.4,1.4 C4.9,4.3,4.3,5,3.6,5z M13.6,13.6h-2.4V9.9c0-0.9,0-2-1.2-2c-1.2,0-1.4,1-1.4,2v3.8H6.2V6h2.3v1h0c0.3-0.6,1.1-1.2,2.2-1.2 c2.4,0,2.8,1.6,2.8,3.6V13.6z" fill="currentColor"></path>
          </svg>
          <div class="screen-reader">LinkedIn</div>
        </a>
      </li>
    </ul>
    <a id="w-node-a3bdcba3-22cc-d78c-cb19-91003b154f55-d5c39cf1" href="mailto:alexander@beck.fyi?subject=Hello!" class="footer_link">Get in touch</a>
    <a id="w-node-a3bdcba3-22cc-d78c-cb19-91003b154f57-d5c39cf1" href="mailto:alexander@beck.fyi?subject=Hello!" class="footer_link">Portfolio [offline]</a>
    <div id="w-node-a3bdcba3-22cc-d78c-cb19-91003b154f59-d5c39cf1" class="w-layout-hflex caption">
      <div>Est. 2025</div>
    </div>
  </header>
  <header class="viewport viewport--corners">
    <div class="corner corner--tr w-embed"><svg viewbox="0 0 92 92" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M92 0C54.5089 0 35.7631 -3.62396e-05 22.4248 9.21864C17.2615 12.7872 12.7872 17.2615 9.21864 22.4248C-3.62396e-05 35.7631 0 54.5089 0 92V0H92Z" fill="currentColor"></path>
      </svg></div>
    <div class="corner corner--bl w-embed"><svg viewbox="0 0 92 92" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M92 0C54.5089 0 35.7631 -3.62396e-05 22.4248 9.21864C17.2615 12.7872 12.7872 17.2615 9.21864 22.4248C-3.62396e-05 35.7631 0 54.5089 0 92V0H92Z" fill="currentColor"></path>
      </svg></div>
    <div class="corner corner--br w-embed"><svg viewbox="0 0 92 92" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M92 0C54.5089 0 35.7631 -3.62396e-05 22.4248 9.21864C17.2615 12.7872 12.7872 17.2615 9.21864 22.4248C-3.62396e-05 35.7631 0 54.5089 0 92V0H92Z" fill="currentColor"></path>
      </svg></div>
    <div class="corner corner--tl w-embed"><svg viewbox="0 0 92 92" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M92 0C54.5089 0 35.7631 -3.62396e-05 22.4248 9.21864C17.2615 12.7872 12.7872 17.2615 9.21864 22.4248C-3.62396e-05 35.7631 0 54.5089 0 92V0H92Z" fill="currentColor"></path>
      </svg></div>
  </header>
  <script src="https://d3e54v103j8qbb.cloudfront.net/js/jquery-3.5.1.min.dc5e7f18c8.js?site=68cee53c847dda2fd5c39ce4" type="text/javascript" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
  <script src="js/webflow.js" type="text/javascript"></script>
  <script>
// Bouncy Balls Simulation - Minified
(()=>{function t(){return 0===G?0:wt*(G/40)}function e(){if(!ht)return void(Lt.style.filter="none");const t=(t,e)=>`rgba(${parseInt(t.slice(1,3),16)}, ${parseInt(t.slice(3,5),16)}, ${parseInt(t.slice(5,7),16)}, ${e})`,e=`drop-shadow(${ut}px ${mt}px ${gt}px ${t(pt,yt)})`,n=xt?` drop-shadow(${ut}px ${Math.round(.5*mt)}px ${ft}px ${t(pt,vt)})`:"";Lt.style.filter=e+n}function n(){const t=new Date,e=t.getHours(),n=e>=18||e<6;return console.log(`🌍 Time check: ${e}:${t.getMinutes().toString().padStart(2,"0")} → ${n?"Night":"Day"} (sunset: 18, sunrise: 6)`),n}function o(t){Gt=t,t?Tt.classList.add("dark-mode"):Tt.classList.remove("dark-mode"),d(me),function(){const t=document.getElementById("darkModeToggle"),e=document.getElementById("darkModeStatus");if(t&&(t.checked=kt),e){const t=new Date,n=`${t.getHours().toString().padStart(2,"0")}:${t.getMinutes().toString().padStart(2,"0")}`;Gt?(e.textContent=`🌙 Night Mode (${n})`,e.style.background="rgba(100,100,255,0.3)"):(e.textContent=`☀️ Day Mode (${n})`,e.style.background="rgba(255,200,0,0.3)")}}()}function a(){kt&&o(n())}function i(){const t=k===MODES.PIT?Et:It,e=window.innerHeight*t;if(Lt.width=Math.floor(window.innerWidth*Rt),Lt.height=Math.floor(e*Rt),k===MODES.PULSE_GRID){B();for(let t=0;t<Ne.length;t++){const e=Ne[t];e.gridX=Math.max(0,Math.min(sa-1,e.gridX)),e.gridY=Math.max(0,Math.min(ia-1,e.gridY));const n=b(e.gridX,e.gridY);e.x=n.x,e.y=n.y,e.targetX=n.x,e.targetY=n.y}}}function s(){se=Math.max(.5,Math.min(3,Math.pow(ae/1,.35)))}function l(){ne=(Lt.clientWidth||window.innerWidth)<=768?.4:1;const t=te*ne;if(null===oe)return oe=t,le=Qt*t,void(re=Kt*t);const e=t/oe;if(1!==e){for(let t=0;t<Ne.length;t++)Ne[t].r*=e;oe=t}le=Qt*t,re=Kt*t}function r(){Te=[];const t=document.querySelector(Le);if(!t)return;const e=t.getBoundingClientRect(),n=Lt.getBoundingClientRect(),o=function(t){const e=document.createElement("span");e.style.cssText=window.getComputedStyle(t).cssText,e.style.position="absolute",e.style.visibility="hidden",e.style.whiteSpace="nowrap",e.textContent="ABCDEFGHIJKLMNOPQRSTUVWXYZ",document.body.appendChild(e);const n=e.getBoundingClientRect().height;return document.body.removeChild(e),n}(t),a=.5*(e.height-o),i={x:(e.left-n.left)*Rt,y:(e.top-n.top+a)*Rt,width:e.width*Rt,height:o*Rt};i.width>0&&i.height>0&&i.x<Lt.width&&i.y<Lt.height&&i.x+i.width>0&&i.y+i.height>0&&Te.push(i)}function d(t){me=t,ge=function(t){const e=ue[t];return e?Gt?e.dark:e.light:ue.industrialTeal.light}(t),pe=ge[ye]||pe,V(),c(),function(){const t=document.getElementById("color1"),e=document.getElementById("color2"),n=document.getElementById("color3"),o=document.getElementById("color4"),a=document.getElementById("color5"),i=document.getElementById("color6"),s=document.getElementById("color7"),l=document.getElementById("color8"),r=document.getElementById("color1Val"),d=document.getElementById("color2Val"),c=document.getElementById("color3Val"),h=document.getElementById("color4Val"),u=document.getElementById("color5Val"),m=document.getElementById("color6Val"),g=document.getElementById("color7Val"),y=document.getElementById("color8Val");t&&r&&(t.value=ge[0],r.textContent=ge[0].toUpperCase()),e&&d&&(e.value=ge[1],d.textContent=ge[1].toUpperCase()),n&&c&&(n.value=ge[2],c.textContent=ge[2].toUpperCase()),o&&h&&(o.value=ge[3],h.textContent=ge[3].toUpperCase()),a&&u&&(a.value=ge[4],u.textContent=ge[4].toUpperCase()),i&&m&&(i.value=ge[5],m.textContent=ge[5].toUpperCase()),s&&g&&(s.value=ge[6],g.textContent=ge[6].toUpperCase()),l&&y&&(l.value=ge[7],y.textContent=ge[7].toUpperCase())}()}function c(t=ge){try{const e=document.documentElement,n=(t&&t.length?t:ge).slice(0,8);for(let t=0;t<8;t++){const o=n[t]||"#ffffff";e.style.setProperty(`--ball-${t+1}`,o)}}catch(t){}}function h(){try{if(!ge||0===ge.length)return console.warn("No colors available, using fallback"),"#ffffff";const t=Math.random();let e=0;for(let n=0;n<Math.min(ge.length,xe.length);n++)if(e+=xe[n],t<=e)return ge[n];return ge[Math.min(ge.length-1,7)]}catch(t){return console.error("Error picking random color:",t),"#ffffff"}}function u(){Re("⚠️ localStorage is disabled")}function m(){clearTimeout(window.settingsSaveTimeout),window.settingsSaveTimeout=setTimeout(u,500)}function g(t,e,n){return Math.max(e,Math.min(n,t))}function y(t,e){return t+Math.random()*(e-t)}function p(t,e,n=h()){const o=(le+re)/2;let a;if(0===ee)a=o;else{const t=.1*o;a=y(Math.max(1,o-t),o+t)}const i=new Ball(t,e,a,n),s=.5*Lt.width,l=de?he>=0?1:-1:t<s?1:-1,r=g(a/(.5*(le+re)),.6,1.4),d=140*r,c=180*r;return i.vx=l*(d+Math.random()*c),i.vy=120*-Math.random(),i.driftAx=l*(360+420*Math.random())*r,i.driftTime=.22+.28*Math.random(),Ne.push(i),i}function x(){const t=Lt.clientWidth,e=Lt.clientHeight,n=g(Nt/100*t,0,t);let o=g(Dt/100*t,0,t);if(de){const e=.2*t,n=o;o=g(o+Math.sin(ce)*e,0,t),he=o>=n?1:-1}const a=Math.min(40,.1*n),i=g(o-n/2-a,-a,t),s=g(o+n/2+a,-a,t),l=Ut/100*e,r=l+Xt/100*e,d=Math.random();return{x:(i+(s-i)*(he>0?Math.pow(d,.7):1-Math.pow(1-d,.7)))*Rt,y:y(l*Rt,r*Rt)-(re+bt+y(0,10*Rt))}}function f(e=6){const n=function(){const t=Ne.length;if(t<2)return[];const e=Math.max(1,2*re),n=Math.ceil(Lt.width/e)+1;He.clear();for(let o=0;o<t;o++){const t=Ne[o],a=t.x/e|0,i=(t.y/e|0)*n+a;let s=He.get(i);s||(s=[],He.set(i,s)),s.push(o)}const o=[];for(const[t,e]of He){const a=t/n|0,i=t%n;for(let t=-1;t<=1;t++)for(let s=-1;s<=1;s++){const l=(a+t)*n+(i+s),r=He.get(l);if(r)for(let t=0;t<e.length;t++){const n=e[t];for(let t=0;t<r.length;t++){const e=r[t];if(e<=n)continue;const a=Ne[n],i=Ne[e],s=i.x-a.x,l=i.y-a.y,d=a.r+i.r,c=s*s+l*l;if(c<d*d){const t=d-Math.sqrt(Math.max(c,St));o.push({i:n,j:e,overlap:t})}}}}}return o.sort((t,e)=>e.overlap-t.overlap),o}();for(let o=0;o<e;o++)for(let e=0;e<n.length;e++){const{i:o,j:a}=n[e],i=Ne[o],s=Ne[a],l=s.x-i.x,r=s.y-i.y,d=i.r+s.r,c=l*l+r*r;if(0===c||c>d*d)continue;const h=Math.sqrt(c),u=l/h,m=r/h,g=d-h,y=1/Math.max(i.m,.001),p=1/Math.max(s.m,.001),x=.8*Math.max(g-Jt,0)/(y+p),f=x*u,v=x*m;i.x-=f*y,i.y-=v*y,s.x+=f*p,s.y+=v*p;const E=s.vx-i.vx,I=s.vy-i.vy,M=E*u+I*m;if(M<0){const e=-(1+(Math.abs(M)<30?0:Wt))*M/(y+p),n=e*u,o=e*m;i.vx-=n*y,i.vy-=o*y,s.vx+=n*p,s.vy+=o*p;const a=E-M*u,l=I-M*m,r=Math.hypot(a,l);if(r>.001){const t=a*-m+l*u>=0?1:-1,e=Ct;i.omega-=t*e*r/Math.max(i.r,1),s.omega+=t*e*r/Math.max(s.r,1)}const d=Math.min(1,Math.abs(M)/(50*(i.r+s.r))),c=Math.min(t(),.8*d);i.squashAmount=Math.max(i.squashAmount,.8*c),i.squashNormalAngle=Math.atan2(-m,-u),s.squashAmount=Math.max(s.squashAmount,.8*c),s.squashNormalAngle=Math.atan2(m,u)}}}function v(){const t=parseFloat(pn.value);te=t,l();const e=(le+re)/2;for(let t=0;t<Ne.length;t++)if(0===ee)Ne[t].r=e,Ne[t].rBase=e;else{const n=.1*e,o=Math.max(1,e-n),a=e+n;Ne[t].r=y(o,a),Ne[t].rBase=Ne[t].r}}function E(){return{gravityMultiplier:$t,restitution:Wt,friction:jt,ballMass:ae,emitRate:_t,maxBalls:Zt,ballScale:te,ballVariation:ee,spawnX:Dt,spawnY:Ut,spawnWidth:Nt,spawnHeight:Xt,sweepEnabled:de,repelRadius:fe,repelPower:ve,repelSoftness:Ee,trailFade:Ve,trailSubtlety:Fe,colors:ge.slice(),colorWeights:xe.slice(),currentTemplate:me,cursorColorIndex:ye,performanceMode:Pt,targetFPS:At,enableLOD:!0}}function I(t,e){t&&t.addEventListener("click",async()=>{const n="function"==typeof e?e():String(e||"").trim();try{await navigator.clipboard.writeText(n);const e=t.textContent;t.textContent="COPIED",t.style.color="#3ddc84",setTimeout(()=>{t.textContent=e,t.style.color="#888"},900)}catch(t){console.warn("Clipboard unavailable")}})}function M(){const t=(le+re)/2;for(let e=0;e<Ne.length;e++){const n=Ne[e];if(0===ee)n.r=t;else{const e=.1*t,o=Math.max(1,t-e),a=t+e;n.r=y(o,a)}n.m=ae}}function S(){Ne.length=0;const t=X,e=Lt.width,n=Lt.height,o=40*Rt;for(let a=0;a<t;a++){const t=p(o+Math.random()*(e-2*o),o+Math.random()*(n-2*o)),a=Math.random()*Math.PI*2,i=Y*(.7+.3*Math.random());t.vx=Math.cos(a)*i,t.vy=Math.sin(a)*i,t.driftAx=0,t.driftTime=0}}function B(){const t=Lt.width,e=Lt.height;sa=j,aa=t/sa,ia=Math.floor(e/aa),la=(t-sa*aa)/2,ra=(e-ia*aa)/2}function b(t,e){return{x:la+(t+.5)*aa,y:ra+(e+.5)*aa}}function C(t,e){for(const n of Xe){const o=n.x-t.x,a=n.y-t.y,i=o*o+a*a,s=Math.sqrt(i);if(s<5)continue;const l=n.strength/i*e;t.vx+=o/s*l,t.vy+=a/s*l}0!==rt&&(t.vx*=1-rt,t.vy*=1-rt)}function w(){Ne.length=0,function(){Xe=[],Ye=[];const t={x:Lt.width/(2*Rt),y:Lt.height/(2*Rt),strength:it,isPermanent:!0};Xe.push(t),Ye.push(t)}();const t=Lt.width/Rt,e=Lt.height/Rt,n=t/2,o=e/2,a=.15*Math.min(t,e),i=.35*Math.min(t,e);for(let t=0;t<st;t++){const e=2*Math.PI*t/st+.5*(Math.random()-.5),s=a+Math.random()*(i-a),l=n+Math.cos(e)*s,r=o+Math.sin(e)*s,d=lt*(.7+.6*Math.random()),c=-Math.sin(e)*d,h=Math.cos(e)*d,u=(le+re)/2*(.9+.2*Math.random()),m=new Ball(l,r,u,c,h);Ne.push(m)}Re(`🌀 Vortex scene initialized: ${st} balls in orbital ring`)}function L(){Ne.length=0,B();const t=sa*ia,e=Math.min(et,t),n=[];for(let t=0;t<ia;t++)for(let e=0;e<sa;e++)n.push({gridX:e,gridY:t});for(let t=n.length-1;t>0;t--){const e=Math.floor(Math.random()*(t+1));[n[t],n[e]]=[n[e],n[t]]}for(let t=0;t<e;t++){const e=n[t],o=b(e.gridX,e.gridY),a=p(o.x,o.y);a.gridX=e.gridX,a.gridY=e.gridY,a.targetX=o.x,a.targetY=o.y,a.jumpProgress=1,a.vx=0,a.vy=0,a.driftAx=0,a.driftTime=0;const i=_,s=J*Math.random()*i;a.nextJumpTime=i+s}}function T(t){k=t,function(t){const e=document.getElementById("announcer");e&&(e.textContent="",setTimeout(()=>e.textContent=t,100))}(`Switched to ${{[MODES.PIT]:"Ball Pit",[MODES.FLIES]:"Flies to Light",[MODES.WEIGHTLESS]:"Zero Gravity",[MODES.PULSE_GRID]:"Pulse Grid",[MODES.VORTEX]:"Vortex Spiral"}[t]} mode`),Tt.className="",k===MODES.PIT&&Tt.classList.add("mode-pit"),i(),k===MODES.PIT?($t=z,Ht=Yt*$t,Be=O&&ve>0&&fe>0,de=!1,Ne.length=0,$e=0,function(){Ne.length=0;const t=Zt,e=(Lt.width,Lt.clientHeight),n=Ut/100*e*Rt,o=n+Xt/100*e*Rt,a=Nt/100*Lt.clientWidth,i=Dt/100*Lt.clientWidth-a/2;for(let e=0;e<t;e++){const t=p((i+Math.random()*a)*Rt,n+Math.random()*(o-n));t.vx=100*(Math.random()-.5),t.vy=50*Math.random(),t.driftAx=0,t.driftTime=0}}(),v()):k===MODES.FLIES?($t=0,Ht=Yt*$t,Be=!1,de=!1,function(){Ne.length=0;const t=.5*Lt.width,e=.5*Lt.height,n=150*Rt;for(let o=0;o<60;o++){const o=Math.random()*Math.PI*2,a=Math.random()*n,i=p(t+Math.cos(o)*a,e+Math.sin(o)*a),s=.5+.5*Math.random(),l=Math.random()*Math.PI*2,r=300*s;i.vx=Math.cos(l)*r,i.vy=Math.sin(l)*r,i.driftAx=0,i.driftTime=0}}(),v()):k===MODES.WEIGHTLESS?($t=0,Ht=Yt*$t,Be=!1,de=!1,S(),v()):k===MODES.PULSE_GRID?($t=0,Ht=Yt*$t,Be=!1,de=!1,L(),v()):k===MODES.VORTEX&&($t=0,Ht=Yt*$t,Be=!1,de=!1,w(),v()),function(){const t=document.getElementById("pulseGridControls"),e=document.getElementById("vortexControls");ko&&ko.classList.toggle("active",k===MODES.PIT),Go&&Go.classList.toggle("active",k===MODES.FLIES),zo&&zo.classList.toggle("active",k===MODES.WEIGHTLESS),t&&t.classList.toggle("active",k===MODES.PULSE_GRID),e&&e.classList.toggle("active",k===MODES.VORTEX),qo.forEach(t=>{const e=t.getAttribute("data-mode")===k;t.classList.toggle("active",e),t.setAttribute("aria-pressed",e?"true":"false")})}()}function V(){for(let t=0;t<Ne.length;t++)Ne[t].color=h()}function F(t,e,n){t.innerHTML="";for(const[o,a]of Object.entries(e)){const e=document.createElement("option");e.value=o,e.textContent=a.label||o,o===n&&(e.selected=!0),t.appendChild(e)}}function R(t,e,n,o=0){t&&(t.value=String(n)),e&&(e.textContent=o>0?n.toFixed(o):n.toString())}function P(t){const e=Pa[t];if(!e)return;Wt=e.REST,jt=e.FRICTION,Zt=e.maxBalls,ee=e.sizeVariation;const n=e.sizeScale;te=n,l();for(let t=0;t<Ne.length;t++)Ne[t].m=ae;Ne.length>Zt&&(Ne.length=Zt),R(mn,to,Wt,2),R(gn,eo,jt,4),R(pn,vn,te,1),R(Mn,oo,Zt,0),R(xn,En,ee,1),M()}function A(t){const e=Aa[t];e&&(_t=e.EMIT_INTERVAL,Dt=e.xCenter,Ut=e.y,Nt=e.w,Xt=e.h,R(yn,no,_t,3),R(bn,so,Dt,0),R(Sn,ao,Ut,0),R(Bn,io,Nt,0),R(Cn,lo,Xt,0))}function q(t){const e=qa[t];if(!e)return;fe=e.r,ve=1*e.p,Be="off"!==t,R(wn,ro,fe,0);const n=function(t){const e=Math.max(1,Number(t))/24e3,n=.5+Math.log2(e)/12;return Math.round(Math.max(0,Math.min(1,n))*Ce)}(ve);Ln&&(Ln.value=String(n)),co&&(co.textContent=Math.round(ve).toString()),R(Tn,ho,Ee,1)}const MODES={PIT:"pit",FLIES:"flies",WEIGHTLESS:"weightless",PULSE_GRID:"pulse-grid",VORTEX:"vortex"};let k=MODES.PIT,G=20,z=1.05,O=!0,D=5e3,U=180,N=3.5,X=80,Y=250,$=.97,H=300,W=150,j=40,_=.8,Z=.25,J=.3,Q=.4,K=1,tt=3,et=120,nt=.15,ot="snap",at=1.08,it=5e3,st=200,lt=180,rt=2e-4,dt=3e3,ct=!0,ht=!1,ut=1,mt=1,gt=0,yt=.29,pt="#000000",xt=!1,ft=4,vt=.1;const Et=1.5,It=1,Mt=-1e9,St=1e-6,Bt=1e-4,bt=2,Ct=.18,wt=.2,Lt=document.getElementById("c"),Tt=document.getElementById("bravia-balls");let Vt;try{if(Vt=Lt.getContext("2d",{alpha:!0}),!Vt)throw new Error("Canvas 2D context not available");console.log("✅ Canvas initialized with alpha transparency")}catch(Da){throw console.error("❌ Failed to initialize canvas:",Da),Tt.innerHTML='\n      <div style="display: flex; align-items: center; justify-content: center; height: 100%; background: #1a1a1a; color: white; font-family: system-ui, -apple-system, sans-serif;">\n        <div style="text-align: center; padding: 40px; background: rgba(255,50,50,0.1); border: 2px solid rgba(255,50,50,0.3); border-radius: 12px; max-width: 480px;">\n          <div style="font-size: 72px; margin-bottom: 20px; filter: drop-shadow(0 4px 8px rgba(0,0,0,0.3));">⚠️</div>\n          <h2 style="margin: 0 0 16px 0; font-size: 24px; font-weight: 600;">Canvas Not Supported</h2>\n          <p style="margin: 0 0 12px 0; opacity: 0.9; line-height: 1.6; font-size: 15px;">Your browser doesn\'t support the HTML5 Canvas 2D features required for this interactive simulation.</p>\n          <p style="margin: 0; opacity: 0.7; font-size: 13px;">Please try a modern browser like Chrome, Firefox, Safari, or Edge.</p>\n        </div>\n      </div>\n    ',Da}const Ft=document.getElementById("controlPanel"),Rt=Math.max(1,Math.min(2,window.devicePixelRatio||1));let Pt=!1,At=60,qt="initializing",kt=!0,Gt=!1;const zt={normal:{maxBalls:350,collisionIters:2,adaptiveQualityMin:.5},performance:{maxBalls:200,collisionIters:1,adaptiveQualityMin:.3}};let Ot,Dt=50,Ut=-50,Nt=100,Xt=50;i(),window.addEventListener("resize",function(){clearTimeout(Ot),Ot=setTimeout(()=>{i(),l(),r()},150)});const Yt=1960;let $t=0,Ht=Yt*$t,Wt=.97,jt=.0035,_t=.03,Zt=350;const Jt=.5*Rt,Qt=6,Kt=24;let te=1,ee=.3,ne=1,oe=null,ae=91;const ie=.15;let se=1;s();let le=Qt*te,re=Kt*te,de=!1,ce=0,he=1;const ue={industrialTeal:{label:"Industrial Teal",light:["#b7bcb7","#e4e9e4","#ffffff","#00695c","#000000","#ff4013","#0d5cb6","#ffa000"],dark:["#6b726b","#3d453d","#8a928a","#00e6c3","#d5d5d5","#ff6b47","#5b9aff","#ffb84d"]},sunsetCoral:{label:"Sunset Coral",light:["#bdbbb8","#e8e6e3","#ffffff","#ff3b3b","#000000","#00f5d4","#1e40af","#fb923c"],dark:["#716f6b","#3f3d3a","#8e8c88","#ff6b6b","#d8d8d8","#00ffe7","#6ba3ff","#ffb570"]},violetPunch:{label:"Violet Punch",light:["#b8b7c2","#e6e5ed","#ffffff","#9333ea","#000000","#dc2626","#0ea5e9","#facc15"],dark:["#6d6c7a","#3a3845","#8b8a98","#c266ff","#dad6e8","#ff5c5c","#42d4ff","#fff066"]},citrusBlast:{label:"Citrus Blast",light:["#bfbdb5","#eae8df","#ffffff","#ea580c","#000000","#e11d48","#2563eb","#059669"],dark:["#74726a","#403e38","#918f87","#ff8c4d","#dbd9d1","#ff5c7a","#6ba3ff","#00d699"]},cobaltSpark:{label:"Cobalt Spark",light:["#b5b8be","#e3e6eb","#ffffff","#1d4ed8","#000000","#ea580c","#db2777","#d97706"],dark:["#696d75","#3a3e45","#878b93","#6b9dff","#d6dae2","#ff8c5c","#ff66b3","#ffc266"]}};let me="industrialTeal",ge=ue.industrialTeal.light.slice(),ye=4,pe=ge[ye]||"#00695c";const xe=[.5,.25,.12,.06,.03,.02,.01,.01];let fe=710,ve=274e3,Ee=3.4,Ie=Mt,Me=Mt,Se=!1,Be=!1,be=!1;("ontouchstart"in window||navigator.maxTouchPoints>0)&&(be=!0);const Ce=1e4;let we=0;const Le="#hero-text";let Te=[],Ve=.025,Fe=1.8;const Re=console.log.bind(console);let Pe=0,Ae=0,qe=0,ke=0,Ge=0;const ze=document.getElementById("render-fps"),Oe=document.getElementById("physics-fps");let De=2,Ue=0;class Ball{constructor(t,e,n,o){this.x=t,this.y=e,this.vx=200*(2*Math.random()-1),this.vy=200*-Math.random(),this.r=n,this.rBase=n,this.m=ae,this.color=o,this.t=0,this.age=0,this.driftAx=0,this.driftTime=0,this.omega=0,this.squash=1,this.squashDirX=1,this.squashDirY=0,this.theta=0,this.squashAmount=0,this.squashNormalAngle=0,this.alpha=1}step(t){this.t+=t,this.age+=t,k!==MODES.WEIGHTLESS&&(this.vy+=Ht*se*t);const e=Math.max(.25,this.m/1),n=k===MODES.WEIGHTLESS?1e-4:jt,o=Math.max(0,1-n/e);this.vx*=o,this.vy*=o,0!==this.driftAx&&this.age<this.driftTime?this.vx+=this.driftAx*t/e:0!==this.driftAx&&(this.driftAx=0),function(t,e){k!==MODES.PIT?k!==MODES.FLIES?k!==MODES.WEIGHTLESS||function(t,e){if(Ie===Mt||Me===Mt)return;if(H<=0||W<=0)return;const n=W*Rt,o=t.x-Ie,a=t.y-Me,i=o*o+a*a;if(i>n*n)return;const s=Math.max(Math.sqrt(i),Bt),l=o/s,r=a/s,d=Math.max(0,1-s/n),c=H*d;t.vx+=l*c*e,t.vy+=r*c*e}(t,e):function(t,e){const n=Ie===Mt?.5*Lt.width:Ie,o=Me===Mt?.5*Lt.height:Me,a=n-t.x,i=o-t.y,s=a*a+i*i,l=Math.sqrt(s+1),r=a/l,d=i/l,c=D*N*2;t.vx+=r*c*e,t.vy+=d*c*e;const h=120*Rt;let u=0,m=0,g=0;for(let e=0;e<Ne.length;e++){const n=Ne[e];if(n===t)continue;const o=t.x-n.x,a=t.y-n.y,i=o*o+a*a;if(i<h*h&&i>0){const t=Math.sqrt(i),e=1-t/h;u+=o/t*e,m+=a/t*e,g++}}if(g>0){const n=15e3;t.vx+=u/g*n*e,t.vy+=m/g*n*e}const y=2500*N;if(Math.random()<.08){const e=Math.random()*Math.PI*2,n=1500*N;t.vx+=Math.cos(e)*n,t.vy+=Math.sin(e)*n}t.vx+=(Math.random()-.5)*y*e,t.vy+=(Math.random()-.5)*y*e;const p=.3+2*Math.random(),x=2e3*N*p*e;t.vx+=-d*x,t.vy+=r*x;const f=2200*N,v=Math.sqrt(t.vx*t.vx+t.vy*t.vy);v>f&&(t.vx=t.vx/v*f,t.vy=t.vy/v*f),t.vx*=.995,t.vy*=.995}(t,e):function(t,e){if(!Be)return;if(ve<=0||fe<=0)return;const n=fe*Rt,o=t.x-Ie,a=t.y-Me,i=o*o+a*a;if(i>n*n)return;const s=Math.max(Math.sqrt(i),Bt),l=o/s,r=a/s,d=Math.max(0,1-s/n),c=20*ve*Math.pow(d,Ee),h=Math.max(.25,t.m/1);t.vx+=l*c*e/h,t.vy+=r*c*e/h,t.vx+=10*(Math.random()-.5)*e,t.vy+=10*(Math.random()-.5)*e}(t,e)}(this,t),this.x+=this.vx*t,this.y+=this.vy*t;const a=Math.max(0,1-2*t);this.omega*=a,this.theta+=this.omega*t,this.theta>Math.PI?this.theta-=2*Math.PI:this.theta<-Math.PI&&(this.theta+=2*Math.PI);const i=Math.min(1,18*t);this.squashAmount+=(0-this.squashAmount)*i,this.squash=1-this.squashAmount}walls(e,n,o,a=Wt){const i=a;if(0===we){if(this.y+this.r>n){this.y=n-this.r;const e=this.vy,a=this.vx-this.omega*this.r,s=Math.max(.25,this.m/1);this.omega+=a/this.r*.25/s;const l=Math.max(0,1-1.5*o/s);this.vx*=l;const r=Math.abs(e)<70?0:i;this.vy=-this.vy*(r*Math.pow(1/this.m,ie));const d=Math.min(1,Math.abs(e)/(90*this.r));this.squashAmount=Math.min(t(),.8*d),this.squash=1-this.squashAmount,this.squashNormalAngle=-Math.PI/2;const c=this.vx/this.r;this.omega+=(c-this.omega)*Math.min(1,8*o)}const a=k===MODES.PIT?n/3:0;if(this.y-this.r<a){this.y=a+this.r;const e=this.vy;this.vy=-this.vy*i;const n=Math.min(1,Math.abs(e)/(90*this.r));this.squashAmount=Math.min(t(),.8*n),this.squash=1-this.squashAmount,this.squashNormalAngle=Math.PI/2}if(this.x+this.r>e){this.x=e-this.r;{const t=this.vy-this.omega*this.r,e=Math.max(.25,this.m/1);this.omega+=t/this.r*.125/e}this.vx=-this.vx*i;const n=Math.min(1,Math.abs(this.vx)/(90*this.r));this.squashAmount=Math.min(t(),.8*n),this.squash=1-this.squashAmount,this.squashNormalAngle=Math.PI}if(this.x-this.r<0){this.x=this.r;{const t=this.vy-this.omega*this.r,e=Math.max(.25,this.m/1);this.omega+=t/this.r*.125/e}this.vx=-this.vx*i;const e=Math.min(1,Math.abs(this.vx)/(90*this.r));this.squashAmount=Math.min(t(),.8*e),this.squash=1-this.squashAmount,this.squashNormalAngle=0}}else this.handleRoundedWallCollision(e,n);this.checkTextCollisions(o)}checkTextCollisions(e){for(let e=0;e<Te.length;e++){const n=Te[e],o=Math.max(n.x,Math.min(this.x,n.x+n.width)),a=Math.max(n.y,Math.min(this.y,n.y+n.height)),i=this.x-o,s=this.y-a,l=Math.sqrt(i*i+s*s);if(l<this.r)if(0===l){const t=this.x-n.x,e=n.x+n.width-this.x,o=this.y-n.y,a=n.y+n.height-this.y,i=Math.min(t,e,o,a);i===t?(this.x=n.x-this.r,this.vx=-Math.abs(this.vx)*Wt):i===e?(this.x=n.x+n.width+this.r,this.vx=Math.abs(this.vx)*Wt):i===o?(this.y=n.y-this.r,this.vy=-Math.abs(this.vy)*Wt):(this.y=n.y+n.height+this.r,this.vy=Math.abs(this.vy)*Wt)}else{const e=this.r-l,n=i/l,o=s/l;this.x+=n*e,this.y+=o*e;const a=this.vx*n+this.vy*o;if(a<0){this.vx-=2*a*n*Wt,this.vy-=2*a*o*Wt;const e=Math.min(1,Math.abs(a)/(70*this.r));this.squash=1-t()*e,this.squashDirX=Math.abs(n)>Math.abs(o)?1:0,this.squashDirY=Math.abs(o)>Math.abs(n)?1:0}}}}handleRoundedWallCollision(e,n){const o=we,a=[{x:o,y:o},{x:e-o,y:o},{x:e-o,y:n-o},{x:o,y:n-o}];for(let i=0;i<a.length;i++){const s=a[i],l=this.x-s.x,r=this.y-s.y,d=Math.sqrt(l*l+r*r);if(this.isInCornerRegion(s,e,n,o)&&d+this.r>o){const e=o-(d-this.r);if(e>0&&d>0){const n=l/d,o=r/d;this.x+=n*e,this.y+=o*e;const a=this.vx*n+this.vy*o;this.vx-=2*a*n*Wt,this.vy-=2*a*o*Wt;const i=Math.min(1,Math.abs(a)/(90*this.r));this.squashAmount=Math.min(t(),.8*i),this.squash=1-this.squashAmount,this.squashNormalAngle=Math.atan2(o,n)}}}if(this.y+this.r>n&&(this.x<o||this.x>e-o)&&(this.y=n-this.r,this.vy=-this.vy*(Wt*Math.pow(1/this.m,ie))),this.y-this.r<0&&(this.x<o||this.x>e-o)&&(this.y=this.r,this.vy=-this.vy*Wt),this.x+this.r>e&&(this.y<o||this.y>n-o)){this.x=e-this.r;{const t=this.vy-this.omega*this.r,e=Math.max(.25,this.m/1);this.omega+=t/this.r*.125/e}this.vx=-this.vx*(Wt*Math.pow(1/this.m,ie));const n=Math.min(1,Math.abs(this.vx)/(70*this.r));this.squashAmount=Math.min(t(),n),this.squash=1-this.squashAmount,this.squashNormalAngle=Math.PI}if(this.x-this.r<0&&(this.y<o||this.y>n-o)){this.x=this.r;{const t=this.vy-this.omega*this.r,e=Math.max(.25,this.m/1);this.omega+=t/this.r*.125/e}this.vx=-this.vx*(Wt*Math.pow(1/this.m,ie));const e=Math.min(1,Math.abs(this.vx)/(70*this.r));this.squashAmount=Math.min(t(),e),this.squash=1-this.squashAmount,this.squashNormalAngle=0}this.y+this.r>n&&this.x>=o&&this.x<=e-o&&(this.y=n-this.r,this.vy=-this.vy*(Wt*Math.pow(1/this.m,ie))),this.y-this.r<0&&this.x>=o&&this.x<=e-o&&(this.y=this.r,this.vy=-this.vy*(Wt*Math.pow(1/this.m,ie))),this.x+this.r>e&&this.y>=o&&this.y<=n-o&&(this.x=e-this.r,this.vx=-this.vx*(Wt*Math.pow(1/this.m,ie))),this.x-this.r<0&&this.y>=o&&this.y<=n-o&&(this.x=this.r,this.vx=-this.vx*(Wt*Math.pow(1/this.m,ie)))}isInCornerRegion(t,e,n,o){return t.x===o&&t.y===o?this.x<=o&&this.y<=o:t.x===e-o&&t.y===o?this.x>=e-o&&this.y<=o:t.x===e-o&&t.y===n-o?this.x>=e-o&&this.y>=n-o:t.x===o&&t.y===n-o&&this.x<=o&&this.y>=n-o}draw(e){e.save(),e.translate(this.x,this.y);const n=Math.min(t(),Math.max(0,this.squashAmount));if(this.r>15&&n>.001){const t=1+n,o=1/t;e.rotate(this.squashNormalAngle),e.scale(t,o),e.rotate(-this.squashNormalAngle)}e.beginPath(),e.arc(0,0,this.r,0,2*Math.PI);let o=this.color;if(k===MODES.VORTEX&&ct){const t=Math.sqrt(this.vx*this.vx+this.vy*this.vy),e=800;o=`hsl(${220-220*Math.min(t/e,1)}, 70%, 55%)`}e.fillStyle=o,e.fill(),e.restore()}}const Ne=[];let Xe=[],Ye=[],$e=0;const He=new Map;let We=performance.now()/1e3,je=0;const _e=1/120;console.log("High refresh mode enabled - using requestAnimationFrame"),requestAnimationFrame(function frame(t){const e=t/1e3;let n=Math.min(.033,e-We);We=e,je+=n,(ze||Oe)&&Pe++,(ze||Oe)&&e-qe>=1&&(ze&&Pe!==ke&&(ke=Pe,ze.textContent=ke.toString()),Oe&&Ae!==Ge&&(Ge=Ae,Oe.textContent=Ge.toString()),Pe=0,Ae=0,qe=e,function(t){t-Ue<2||(Ue=t,ke<50?(De=1,console.log("⚡ Adaptive Quality: LOW (1 collision iter) - FPS:",ke)):ke<70?(De=2,console.log("⚡ Adaptive Quality: MEDIUM (2 collision iters) - FPS:",ke)):(De=3,console.log("⚡ Adaptive Quality: HIGH (3 collision iters) - FPS:",ke)))}(e)),function(t){if(k!==MODES.PIT&&k!==MODES.WEIGHTLESS&&k!==MODES.PULSE_GRID)for($e+=t;$e>=_t;){const t=(Math.random()-.5)*_t*.5;$e-=_t+t,ce+=2*Math.PI*.12*(_t+t);const e=x(),n=Math.random()<.35?3:1;for(let t=0;t<n;t++)if(Ne.length<Zt){const n=8*t*(Math.random()<.5?1:-1);p(e.x+n,e.y-12*t)}}}(n),k===MODES.PULSE_GRID&&function(t){for(let e=0;e<Ne.length;e++){const n=Ne[e];if(n.nextJumpTime-=t,n.nextJumpTime<=0&&n.jumpProgress>=1){const t=[{dx:0,dy:-1},{dx:0,dy:1},{dx:-1,dy:0},{dx:1,dy:0}],e=t[Math.floor(Math.random()*t.length)],o=tt-K+1,a=K+Math.floor(Math.random()*o),i=Math.max(1,Math.round(a*(1-.5*Q+Q*Math.random())));let s=n.gridX+e.dx*i,l=n.gridY+e.dy*i;s=Math.max(0,Math.min(sa-1,s)),l=Math.max(0,Math.min(ia-1,l)),n.gridX=s,n.gridY=l;const r=b(s,l);n.targetX=r.x,n.targetY=r.y,n.jumpProgress=0,n.jumpStartX=n.x,n.jumpStartY=n.y;const d=Q*_*(Math.random()-.5),c=J*_*Math.random();n.nextJumpTime=_+d+c}if(n.jumpProgress<1)if(n.jumpProgress+=t/Z,n.jumpProgress>=1)n.jumpProgress=1,n.x=n.targetX,n.y=n.targetY,n.vx=0,n.vy=0;else{const t=n.jumpProgress;let e=t;if("linear"===ot)e=t;else if("snap"===ot)if(t<.6){const n=t/.6;e=n*n*at}else{const n=(t-.6)/.4;e=1+(at-1)*(1-n)-nt*Math.sin(n*Math.PI)}else if("bounce"===ot)if(t<.7)e=t/.7*(t/.7);else{const n=(t-.7)/.3;e=1-.5*nt*Math.sin(n*Math.PI*2)}else"smooth"===ot&&(e=t<.5?2*t*t:1-Math.pow(-2*t+2,2)/2);n.x=n.jumpStartX+(n.targetX-n.jumpStartX)*e,n.y=n.jumpStartY+(n.targetY-n.jumpStartY)*e,n.vx=0,n.vy=0}}}(n),Pe%60==0&&r(),k===MODES.VORTEX&&(Xe=[...Ye],Se&&dt>0&&Xe.push({x:Ie,y:Me,strength:dt,isPermanent:!1}));let o=0;for(;je>=_e&&o<2;){if(k!==MODES.PULSE_GRID){const t=Ne.length;for(let e=0;e<t;e++)Ne[e].step(_e),k===MODES.VORTEX&&C(Ne[e],_e)}if(k!==MODES.FLIES&&k!==MODES.PULSE_GRID&&k!==MODES.VORTEX&&f(De),k!==MODES.PULSE_GRID){const t=k===MODES.WEIGHTLESS?$:Wt,e=Ne.length;for(let n=0;n<e;n++)Ne[n].walls(Lt.width,Lt.height,_e,t)}je-=_e,o++,Ae++}je>3*_e&&(je=0),Vt.clearRect(0,0,Lt.width,Lt.height),we>0&&function(t,e,n){const o=we;t.strokeStyle="rgba(255, 255, 255, 0.1)",t.lineWidth=2,t.beginPath(),t.moveTo(o,0),t.lineTo(e-o,0),t.arcTo(e,0,e,o,o),t.lineTo(e,n-o),t.arcTo(e,n,e-o,n,o),t.lineTo(o,n),t.arcTo(0,n,0,n-o,o),t.lineTo(0,o),t.arcTo(0,0,o,0,o),t.closePath(),t.stroke()}(Vt,Lt.width,Lt.height);const a=Ne.length;for(let t=0;t<a;t++)Ne[t].draw(Vt);if(function(t){if(be)return;if(Ie===Mt||Me===Mt)return;const e=Ie,n=Me,o=(le+re)/2*1.33;t.beginPath(),t.arc(e,n,o,0,2*Math.PI),t.fillStyle="rgba(255, 255, 255, 0.9)",t.fill(),t.strokeStyle="rgba(255, 255, 255, 0.6)",t.lineWidth=2,t.stroke()}(Vt),!be){Vt.save(),Vt.font="14px system-ui, -apple-system, sans-serif",Vt.fillStyle="rgba(255, 255, 255, 0.3)",Vt.textAlign="left",Vt.textBaseline="bottom";const t=k.charAt(0).toUpperCase()+k.slice(1);Vt.fillText(t+" Mode",10,Lt.height-10),Vt.restore()}requestAnimationFrame(frame)});const Ze=document.getElementById("panelHeader"),Je=document.getElementById("minimizePanel");if(Ft&&Ft.classList.add("hidden"),Je&&Ft&&Je.addEventListener("click",t=>{t.stopPropagation(),Ft.classList.toggle("hidden")}),Ze&&Ft){let Ua,Na,Xa,Ya,$a=!1,Ha=0,Wa=0;function Qe(t){"touchstart"===t.type?(Xa=t.touches[0].clientX-Ha,Ya=t.touches[0].clientY-Wa):(Xa=t.clientX-Ha,Ya=t.clientY-Wa),(t.target===Ze||Ze.contains(t.target))&&($a=!0,Ft.style.cursor="grabbing")}function Ke(t){if($a){t.preventDefault(),"touchmove"===t.type?(Ua=t.touches[0].clientX-Xa,Na=t.touches[0].clientY-Ya):(Ua=t.clientX-Xa,Na=t.clientY-Ya),Ha=Ua,Wa=Na,Ft.getBoundingClientRect();const e=window.getComputedStyle(Ft),n=parseFloat(e.top)||0,o=parseFloat(e.right)||0;Ft.style.top=`${n+Wa}px`,Ft.style.right=o-Ha+"px",Ft.style.left="auto",Ft.style.bottom="auto",Ha=0,Wa=0,Xa="touchmove"===t.type?t.touches[0].clientX:t.clientX,Ya="touchmove"===t.type?t.touches[0].clientY:t.clientY}}function tn(t){$a&&($a=!1,Ft.style.cursor="move",Xa=Ua,Ya=Na)}Ze.addEventListener("mousedown",Qe),document.addEventListener("mousemove",Ke),document.addEventListener("mouseup",tn),Ze.addEventListener("touchstart",Qe),document.addEventListener("touchmove",Ke),document.addEventListener("touchend",tn)}const en=document.getElementById("vortexBallCountSlider"),nn=document.getElementById("vortexBallCountVal"),on=document.getElementById("vortexWellStrengthSlider"),an=document.getElementById("vortexWellStrengthVal"),sn=document.getElementById("vortexMouseStrengthSlider"),ln=document.getElementById("vortexMouseStrengthVal"),rn=document.getElementById("vortexInitialSpeedSlider"),dn=document.getElementById("vortexInitialSpeedVal"),cn=document.getElementById("vortexDecaySlider"),hn=document.getElementById("vortexDecayVal"),un=document.getElementById("vortexSpeedColorCheckbox");en&&en.addEventListener("input",()=>{st=parseInt(en.value,10),nn&&(nn.textContent=st.toString()),k===MODES.VORTEX&&w(),m()}),on&&on.addEventListener("input",()=>{it=parseInt(on.value,10),an&&(an.textContent=it.toString()),k===MODES.VORTEX&&Xe.length>0&&(Xe[0].strength=it,Ye[0].strength=it),m()}),sn&&sn.addEventListener("input",()=>{dt=parseInt(sn.value,10),ln&&(ln.textContent=dt.toString()),m()}),rn&&rn.addEventListener("input",()=>{lt=parseInt(rn.value,10),dn&&(dn.textContent=lt.toString()),m()}),cn&&cn.addEventListener("input",()=>{rt=parseFloat(cn.value),hn&&(hn.textContent=rt.toFixed(4)),m()}),un&&un.addEventListener("change",()=>{ct=un.checked,m()}),window.addEventListener("keydown",t=>{const e=t.key.toLowerCase();"r"===e&&(function(){if(k===MODES.WEIGHTLESS)S();else for(let t=0;t<Ne.length;t++){const e=Ne[t],n=x();e.x=n.x,e.y=n.y;const o=.5*Lt.width,a=de?he>=0?1:-1:e.x<o?1:-1,i=g(e.r/(.5*(le+re)),.6,1.4),s=140*i,l=180*i,r=120;e.vx=a*(s+Math.random()*l),e.vy=-Math.random()*r,e.age=0,e.driftAx=a*(360+420*Math.random())*i,e.driftTime=.22+.28*Math.random()}}(),t.preventDefault()),"/"===e&&Ft&&(t.preventDefault(),Ft.classList.toggle("hidden")),"1"===e&&T(MODES.PIT),"2"===e&&T(MODES.FLIES),"3"===e&&T(MODES.WEIGHTLESS),"4"===e&&T(MODES.PULSE_GRID),"5"===e&&T(MODES.VORTEX)}),Lt.addEventListener("mousemove",t=>{const e=Lt.getBoundingClientRect();Ie=(t.clientX-e.left)*Rt,Me=(t.clientY-e.top)*Rt,Se=!0,k===MODES.PIT&&ve>0&&fe>0&&(Be=!0)}),Lt.addEventListener("mouseleave",()=>{Ie=Mt,Me=Mt,Se=!1});const mn=document.getElementById("restitutionSlider"),gn=document.getElementById("frictionSlider"),yn=document.getElementById("emitterSlider"),pn=document.getElementById("sizeSliderGlobal"),xn=document.getElementById("sizeVariationSliderGlobal"),fn=(document.getElementById("weightSliderGlobal"),document.getElementById("ballSoftnessSliderGlobal")),vn=document.getElementById("sizeValGlobal"),En=document.getElementById("sizeVariationValGlobal"),In=(document.getElementById("weightValGlobal"),document.getElementById("ballSoftnessValGlobal")),Mn=(document.getElementById("sizeSliderPit"),document.getElementById("sizeVariationSliderPit"),document.getElementById("weightSliderPit"),document.getElementById("ballSoftnessSliderPit"),document.getElementById("sizeValPit"),document.getElementById("sizeVariationValPit"),document.getElementById("weightValPit"),document.getElementById("ballSoftnessValPit"),document.getElementById("sizeSliderFlies"),document.getElementById("sizeVariationSliderFlies"),document.getElementById("weightSliderFlies"),document.getElementById("ballSoftnessSliderFlies"),document.getElementById("sizeValFlies"),document.getElementById("sizeVariationValFlies"),document.getElementById("weightValFlies"),document.getElementById("ballSoftnessValFlies"),document.getElementById("sizeSliderZeroG"),document.getElementById("sizeVariationSliderZeroG"),document.getElementById("weightSliderZeroG"),document.getElementById("ballSoftnessSliderZeroG"),document.getElementById("sizeValZeroG"),document.getElementById("sizeVariationValZeroG"),document.getElementById("weightValZeroG"),document.getElementById("ballSoftnessValZeroG"),document.getElementById("maxBallsSlider")),Sn=document.getElementById("spawnYSlider"),Bn=document.getElementById("spawnWidthSlider"),bn=document.getElementById("spawnCenterSlider"),Cn=document.getElementById("spawnHeightSlider"),wn=document.getElementById("repelSizeSlider"),Ln=document.getElementById("repelPowerSlider"),Tn=document.getElementById("repelSoftSlider"),Vn=document.getElementById("colorSelect"),Fn=document.getElementById("color1"),Rn=document.getElementById("color2"),Pn=document.getElementById("color3"),An=document.getElementById("color4"),qn=document.getElementById("color5"),kn=document.getElementById("color6"),Gn=document.getElementById("color7"),zn=document.getElementById("color8"),On=document.getElementById("cursorColorSelect"),Dn=document.getElementById("color1Val"),Un=document.getElementById("color2Val"),Nn=document.getElementById("color3Val"),Xn=document.getElementById("color4Val"),Yn=document.getElementById("color5Val"),$n=document.getElementById("color6Val"),Hn=document.getElementById("color7Val"),Wn=document.getElementById("color8Val");[Dn,Un,Nn,Xn,Yn,$n,Hn,Wn].forEach(t=>{t&&t.setAttribute("title","Click to copy")});const jn=document.getElementById("cornerRadiusSlider"),_n=document.getElementById("cornerRadiusVal"),Zn=document.getElementById("trailFadeSlider"),Jn=document.getElementById("trailFadeVal"),Qn=document.getElementById("trailSubtletySlider"),Kn=document.getElementById("trailSubtletyVal"),to=document.getElementById("restitutionVal"),eo=document.getElementById("frictionVal"),no=document.getElementById("emitterVal"),oo=document.getElementById("maxBallsVal"),ao=document.getElementById("spawnYVal"),io=document.getElementById("spawnWidthVal"),so=document.getElementById("spawnCenterVal"),lo=document.getElementById("spawnHeightVal"),ro=document.getElementById("repelSizeVal"),co=document.getElementById("repelPowerVal"),ho=document.getElementById("repelSoftVal"),uo=document.getElementById("saveConfigBtn"),mo=document.getElementById("buildBtn"),go=document.getElementById("configOutput");uo&&mo&&go&&(uo.addEventListener("click",()=>{const t=E(),e=new Blob([JSON.stringify(t,null,2)],{type:"application/json"}),n=URL.createObjectURL(e),o=document.createElement("a");o.href=n,o.download="current-config.json",o.click(),URL.revokeObjectURL(n),go.style.display="block",go.innerHTML="\n<strong>💾 Config Saved!</strong><br>\nReplace <code>source/current-config.json</code> with the downloaded file.<br>\nThen rebuild: <code>npm run build-production</code>";const a=uo.textContent;uo.textContent="✅ Downloaded!",setTimeout(()=>{uo.textContent=a},2e3)}),mo.addEventListener("click",()=>{const t=E();go.style.display="block",go.innerHTML="\n<strong>🚀 Build Instructions:</strong><br>\n1. Run: <code>npm run build</code><br>\n2. Your current config will be baked into <code>public/js/bouncy-balls-embed.js</code>";const e=new Blob([JSON.stringify(t,null,2)],{type:"application/json"}),n=URL.createObjectURL(e),o=document.createElement("a");o.href=n,o.download="current-config.json",o.click(),URL.revokeObjectURL(n)})),mn&&mn.addEventListener("input",()=>{Wt=parseFloat(mn.value),to&&(to.textContent=Wt.toFixed(2)),m()}),gn&&gn.addEventListener("input",()=>{jt=parseFloat(gn.value),eo&&(eo.textContent=jt.toFixed(4)),m()}),yn&&yn.addEventListener("input",()=>{_t=parseFloat(yn.value),no&&(no.textContent=_t.toFixed(3)),m()}),function(t){if(!t)return;const{size:e,sizeVal:n,sizeVar:o,sizeVarVal:a,soft:i,softVal:s}=t;e&&e.addEventListener("input",()=>{const t=parseFloat(e.value);n&&(n.textContent=t.toFixed(1)),te=t,l();const o=(le+re)/2;for(let t=0;t<Ne.length;t++)Ne[t].r=o,Ne[t].rBase=o;for(let t=0;t<Ne.length;t++)Ne[t].m=ae;m()}),o&&o.addEventListener("input",()=>{const t=parseFloat(o.value);a&&(a.textContent=t.toFixed(1)),ee=t,m()}),i&&i.addEventListener("input",()=>{const t=parseInt(i.value,10);s&&(s.textContent=String(t)),G=t,m()})}({size:pn,sizeVal:vn,sizeVar:xn,sizeVarVal:En,soft:fn,softVal:In}),Mn&&Mn.addEventListener("input",()=>{Zt=parseInt(Mn.value,10),oo&&(oo.textContent=Zt.toString()),Ne.length>Zt&&(Ne.length=Zt)}),xn&&xn.addEventListener("input",()=>{ee=parseFloat(xn.value),En&&(En.textContent=ee.toFixed(1)),M()});const yo=document.getElementById("weightPitSlider"),po=document.getElementById("weightPitVal");document.getElementById("weightWeightlessSlider"),document.getElementById("weightWeightlessVal"),Sn&&Sn.addEventListener("input",()=>{Ut=parseFloat(Sn.value),ao&&(ao.textContent=Ut.toFixed(0)),i()}),Bn&&Bn.addEventListener("input",()=>{Nt=parseFloat(Bn.value),io&&(io.textContent=Nt.toFixed(0))}),bn&&bn.addEventListener("input",()=>{Dt=parseFloat(bn.value),so&&(so.textContent=Dt.toFixed(0))}),Cn&&Cn.addEventListener("input",()=>{Xt=parseFloat(Cn.value),lo&&(lo.textContent=Xt.toFixed(0))}),wn&&wn.addEventListener("input",()=>{fe=parseFloat(wn.value),ro&&(ro.textContent=fe.toFixed(0)),Be=Be||ve>0&&fe>0}),Ln&&Ln.addEventListener("input",()=>{ve=function(t){const e=Math.max(0,Math.min(Ce,Number(t)))/Ce;return 2*Math.pow(2,12*(e-.5))*12e3}(Ln.value),co&&(co.textContent=Math.round(ve).toString()),za&&"off"!==za.value&&(Be=ve>0&&fe>0)}),Tn&&Tn.addEventListener("input",()=>{Ee=parseFloat(Tn.value),ho&&(ho.textContent=Ee.toFixed(1))});const xo=document.getElementById("performanceModeToggle");document.getElementById("performanceModeStatus"),xo&&xo.addEventListener("change",()=>{!function(){Pt=!Pt,At=Pt?120:60;const t=Pt?zt.performance:zt.normal;Pt?(console.log("⚡ PERFORMANCE MODE: Optimizing for 120 FPS..."),Ne.length>t.maxBalls&&(Ne.length=t.maxBalls,console.log(`⚡ Reduced balls to ${t.maxBalls} for 120 FPS`)),Zt=t.maxBalls,De=t.collisionIters):(console.log("🎨 NORMAL MODE: Restoring visual quality..."),Zt=t.maxBalls,De=t.collisionIters),function(){const t=document.getElementById("performanceModeToggle"),e=document.getElementById("performanceModeStatus"),n=document.getElementById("maxBallsSlider"),o=document.getElementById("maxBallsVal");t&&(t.checked=Pt),e&&(Pt?(e.textContent=`⚡ 120 FPS Mode Active (${Ne.length} balls)`,e.style.background="rgba(255,165,0,0.3)"):(e.textContent=`🎨 Normal Mode (${Ne.length} balls)`,e.style.background="rgba(0,0,0,0.2)")),n&&o&&(n.value=Zt,o.textContent=Zt.toString())}(),console.log(`🎯 Target FPS: ${At}, Mode: ${Pt?"PERFORMANCE":"NORMAL"}`)}()});const fo=document.getElementById("darkModeToggle");document.getElementById("darkModeStatus"),fo&&fo.addEventListener("change",()=>{kt=!kt,kt?(a(),console.log("🌙 Auto Dark Mode: ENABLED")):(o(!1),console.log("☀️ Auto Dark Mode: DISABLED")),m()});const vo=document.getElementById("canvasShadowEnabled"),Eo=document.getElementById("shadowOffsetX"),Io=document.getElementById("shadowOffsetXVal"),Mo=document.getElementById("shadowOffsetY"),So=document.getElementById("shadowOffsetYVal"),Bo=document.getElementById("shadowBlur"),bo=document.getElementById("shadowBlurVal"),Co=document.getElementById("shadowOpacity"),wo=document.getElementById("shadowOpacityVal"),Lo=document.getElementById("shadowColor"),To=document.getElementById("shadowColorVal"),Vo=document.getElementById("shadow2Enabled"),Fo=document.getElementById("shadow2Blur"),Ro=document.getElementById("shadow2BlurVal"),Po=document.getElementById("shadow2Opacity"),Ao=document.getElementById("shadow2OpacityVal");vo&&vo.addEventListener("change",()=>{ht=vo.checked,e(),m()}),Eo&&Eo.addEventListener("input",()=>{ut=parseFloat(Eo.value),Io&&(Io.textContent=ut.toFixed(1)),e(),m()}),Mo&&Mo.addEventListener("input",()=>{mt=parseFloat(Mo.value),So&&(So.textContent=mt.toFixed(1)),e(),m()}),Bo&&Bo.addEventListener("input",()=>{gt=parseFloat(Bo.value),bo&&(bo.textContent=gt.toFixed(1)),e(),m()}),Co&&Co.addEventListener("input",()=>{yt=parseFloat(Co.value),wo&&(wo.textContent=yt.toFixed(2)),e(),m()}),Lo&&Lo.addEventListener("input",()=>{pt=Lo.value,To&&(To.textContent=pt.toUpperCase()),e(),m()}),Vo&&Vo.addEventListener("change",()=>{xt=Vo.checked,e(),m()}),Fo&&Fo.addEventListener("input",()=>{ft=parseInt(Fo.value,10),Ro&&(Ro.textContent=ft.toString()),e(),m()}),Po&&Po.addEventListener("input",()=>{vt=parseFloat(Po.value),Ao&&(Ao.textContent=vt.toFixed(2)),e(),m()}),Lt.addEventListener("mousemove",t=>{const e=Lt.getBoundingClientRect();Ie=(t.clientX-e.left)*Rt,Me=(t.clientY-e.top)*Rt}),Lt.addEventListener("mouseleave",()=>{Ie=Mt,Me=Mt,Se=!1}),Vn&&Vn.addEventListener("change",()=>{d(Vn.value)});const qo=Array.from(document.querySelectorAll(".mode-button")),ko=document.getElementById("pitControls"),Go=document.getElementById("fliesControls"),zo=document.getElementById("weightlessControls"),Oo=document.getElementById("gravityPitSlider"),Do=document.getElementById("gravityPitVal"),Uo=document.getElementById("repellerEnabledPit"),No=document.getElementById("attractPowerSlider"),Xo=document.getElementById("attractPowerVal"),Yo=document.getElementById("orbitRadiusSlider"),$o=document.getElementById("orbitRadiusVal"),Ho=document.getElementById("swarmSpeedSlider"),Wo=document.getElementById("swarmSpeedVal"),jo=document.getElementById("weightlessCountSlider"),_o=document.getElementById("weightlessCountVal"),Zo=document.getElementById("weightlessSpeedSlider"),Jo=document.getElementById("weightlessSpeedVal"),Qo=document.getElementById("weightlessBounceSlider"),Ko=document.getElementById("weightlessBounceVal"),ta=document.getElementById("weightlessRepelSlider"),ea=document.getElementById("weightlessRepelVal"),na=document.getElementById("weightlessRepelRadiusSlider"),oa=document.getElementById("weightlessRepelRadiusVal");let aa=0,ia=0,sa=0,la=0,ra=0;const da=document.getElementById("resetBtn");da&&da.addEventListener("click",()=>{confirm("Reset all settings to defaults? This will reload the page with default values.")&&(Re("🔄 Reloading with defaults..."),location.reload())}),qo.forEach(t=>t.addEventListener("click",()=>{T(t.getAttribute("data-mode")),m()})),Oo&&Oo.addEventListener("input",()=>{z=parseFloat(Oo.value),Do&&(Do.textContent=z.toFixed(1)),m(),k===MODES.PIT&&($t=z,Ht=Yt*$t)}),yo&&yo.addEventListener("input",()=>{ae=parseFloat(yo.value),po&&(po.textContent=ae.toFixed(2));for(let t=0;t<Ne.length;t++)Ne[t].m=ae;s(),m()}),Uo&&Uo.addEventListener("change",()=>{O=!!Uo.checked,k===MODES.PIT&&(Be=O&&ve>0&&fe>0)}),No&&No.addEventListener("input",()=>{D=parseFloat(No.value),Xo&&(Xo.textContent=Math.round(D).toString())}),Yo&&Yo.addEventListener("input",()=>{U=parseFloat(Yo.value),$o&&($o.textContent=Math.round(U).toString())}),Ho&&Ho.addEventListener("input",()=>{N=parseFloat(Ho.value),Wo&&(Wo.textContent=N.toFixed(1))}),jo&&jo.addEventListener("input",()=>{X=parseInt(jo.value,10),_o&&(_o.textContent=X.toString()),k===MODES.WEIGHTLESS&&S()}),Zo&&Zo.addEventListener("input",()=>{Y=parseFloat(Zo.value),Jo&&(Jo.textContent=Math.round(Y).toString())}),Qo&&Qo.addEventListener("input",()=>{$=parseFloat(Qo.value),Ko&&(Ko.textContent=$.toFixed(2))}),ta&&ta.addEventListener("input",()=>{H=parseFloat(ta.value),ea&&(ea.textContent=Math.round(H).toString()),m()}),na&&na.addEventListener("input",()=>{W=parseFloat(na.value),oa&&(oa.textContent=Math.round(W).toString()),m()});const ca=document.getElementById("gridPresetSelect"),ha=document.getElementById("gridBallCountSlider"),ua=document.getElementById("gridBallCountVal"),ma=document.getElementById("gridColumnsSlider"),ga=document.getElementById("gridColumnsVal"),ya=document.getElementById("pulseIntervalSlider"),pa=document.getElementById("pulseIntervalVal"),xa=document.getElementById("pulseSpeedSlider"),fa=document.getElementById("pulseSpeedVal"),va=document.getElementById("pulseMinStepsSlider"),Ea=document.getElementById("pulseMinStepsVal"),Ia=document.getElementById("pulseMaxStepsSlider"),Ma=document.getElementById("pulseMaxStepsVal"),Sa=document.getElementById("pulseSynchronicitySlider"),Ba=document.getElementById("pulseSynchronicityVal"),ba=document.getElementById("pulseRandomnessSlider"),Ca=document.getElementById("pulseRandomnessVal"),wa={synchronized:{interval:.6,speed:.2,minSteps:1,maxSteps:2,synchronicity:.1,randomness:.2,easingStyle:"snap",overshoot:1.12,bounce:.18},organic:{interval:.8,speed:.25,minSteps:1,maxSteps:3,synchronicity:.3,randomness:.4,easingStyle:"smooth",overshoot:1.05,bounce:.1},chaotic:{interval:.4,speed:.15,minSteps:2,maxSteps:4,synchronicity:.7,randomness:.8,easingStyle:"bounce",overshoot:1.15,bounce:.25}};ca&&ca.addEventListener("change",()=>{!function(t){const e=wa[t];if(!e)return;_=e.interval,Z=e.speed,K=e.minSteps,tt=e.maxSteps,J=e.synchronicity,Q=e.randomness,ot=e.easingStyle,at=e.overshoot,nt=e.bounce,ya&&(ya.value=e.interval),pa&&(pa.textContent=e.interval.toFixed(1)),xa&&(xa.value=e.speed),fa&&(fa.textContent=e.speed.toFixed(2)),va&&(va.value=e.minSteps),Ea&&(Ea.textContent=e.minSteps.toString()),Ia&&(Ia.value=e.maxSteps),Ma&&(Ma.textContent=e.maxSteps.toString()),Sa&&(Sa.value=e.synchronicity),Ba&&(Ba.textContent=e.synchronicity.toFixed(2)),ba&&(ba.value=e.randomness),Ca&&(Ca.textContent=e.randomness.toFixed(2));const n=document.getElementById("pulseEasingSelect"),o=document.getElementById("pulseOvershootSlider"),a=document.getElementById("pulseOvershootVal"),i=document.getElementById("pulseBounceSlider"),s=document.getElementById("pulseBounceVal");n&&(n.value=e.easingStyle),o&&(o.value=e.overshoot),a&&(a.textContent=e.overshoot.toFixed(2)),i&&(i.value=e.bounce),s&&(s.textContent=e.bounce.toFixed(2)),k===MODES.PULSE_GRID&&L()}(ca.value),m()}),ha&&ha.addEventListener("input",()=>{et=parseInt(ha.value,10),ua&&(ua.textContent=et.toString()),k===MODES.PULSE_GRID&&L(),m()}),ma&&ma.addEventListener("input",()=>{j=parseInt(ma.value,10),ga&&(ga.textContent=j.toString()),k===MODES.PULSE_GRID&&(B(),L()),m()}),ya&&ya.addEventListener("input",()=>{_=parseFloat(ya.value),pa&&(pa.textContent=_.toFixed(1)),m()}),xa&&xa.addEventListener("input",()=>{Z=parseFloat(xa.value),fa&&(fa.textContent=Z.toFixed(2)),m()}),va&&va.addEventListener("input",()=>{K=parseInt(va.value,10),Ea&&(Ea.textContent=K.toString()),K>tt&&(tt=K,Ia&&(Ia.value=K),Ma&&(Ma.textContent=K.toString())),m()}),Ia&&Ia.addEventListener("input",()=>{tt=parseInt(Ia.value,10),Ma&&(Ma.textContent=tt.toString()),tt<K&&(K=tt,va&&(va.value=tt),Ea&&(Ea.textContent=tt.toString())),m()}),Sa&&Sa.addEventListener("input",()=>{J=parseFloat(Sa.value),Ba&&(Ba.textContent=J.toFixed(2)),m()}),ba&&ba.addEventListener("input",()=>{Q=parseFloat(ba.value),Ca&&(Ca.textContent=Q.toFixed(2)),m()});const La=document.getElementById("pulseEasingSelect"),Ta=document.getElementById("pulseOvershootSlider"),Va=document.getElementById("pulseOvershootVal"),Fa=document.getElementById("pulseBounceSlider"),Ra=document.getElementById("pulseBounceVal");La&&La.addEventListener("change",()=>{ot=La.value,m()}),Ta&&Ta.addEventListener("input",()=>{at=parseFloat(Ta.value),Va&&(Va.textContent=at.toFixed(2)),m()}),Fa&&Fa.addEventListener("input",()=>{nt=parseFloat(Fa.value),Ra&&(Ra.textContent=nt.toFixed(2)),m()}),Fn&&Fn.addEventListener("input",()=>{ge[0]=Fn.value,Dn&&(Dn.textContent=Fn.value.toUpperCase()),V(),c()}),Rn&&Rn.addEventListener("input",()=>{ge[1]=Rn.value,Un&&(Un.textContent=Rn.value.toUpperCase()),V(),c()}),Pn&&Pn.addEventListener("input",()=>{ge[2]=Pn.value,Nn&&(Nn.textContent=Pn.value.toUpperCase()),V(),c()}),An&&An.addEventListener("input",()=>{ge[3]=An.value,Xn&&(Xn.textContent=An.value.toUpperCase()),V(),c()}),qn&&qn.addEventListener("input",()=>{ge[4]=qn.value,Yn&&(Yn.textContent=qn.value.toUpperCase()),V(),c()}),kn&&kn.addEventListener("input",()=>{ge[5]=kn.value,$n&&($n.textContent=kn.value.toUpperCase()),V(),c()}),Gn&&Gn.addEventListener("input",()=>{ge[6]=Gn.value,Hn&&(Hn.textContent=Gn.value.toUpperCase()),V(),c()}),zn&&zn.addEventListener("input",()=>{ge[7]=zn.value,Wn&&(Wn.textContent=zn.value.toUpperCase()),V(),c()}),On&&On.addEventListener("change",()=>{const t=Math.max(1,Math.min(8,parseInt(On.value,10)))-1;ye=t,pe=ge[ye]||pe,m()}),I(Dn,()=>Fn.value.toUpperCase()),I(Un,()=>Rn.value.toUpperCase()),I(Nn,()=>Pn.value.toUpperCase()),I(Xn,()=>An.value.toUpperCase()),I(Yn,()=>qn.value.toUpperCase()),I($n,()=>kn.value.toUpperCase()),I(Hn,()=>Gn.value.toUpperCase()),I(Wn,()=>zn.value.toUpperCase()),jn&&jn.addEventListener("input",()=>{we=parseFloat(jn.value),_n&&(_n.textContent=we.toFixed(0))}),Zn&&Zn.addEventListener("input",()=>{Ve=parseFloat(Zn.value),Jn&&(Jn.textContent=Ve.toFixed(3))}),Qn&&Qn.addEventListener("input",()=>{Fe=parseFloat(Qn.value),Kn&&(Kn.textContent=Fe.toFixed(2)+"×")});const Pa={rubberPlayground:{label:"Rubber – Playground",G:1960,REST:.9,FRICTION:.0025,sizeScale:1.8,maxBalls:450,sizeVariation:.2},rubberRacquet:{label:"Rubber – Racquetball",G:3320,REST:.97,FRICTION:.0035,sizeScale:.7,maxBalls:350,sizeVariation:.3},rubberSuperball:{label:"Rubber – Superball",G:1960,REST:.95,FRICTION:.0015,sizeScale:1.2,maxBalls:450,sizeVariation:.05},rubberSoft:{label:"Rubber – Soft",G:1960,REST:.86,FRICTION:.0035,sizeScale:2.2,maxBalls:350,sizeVariation:.25},rubberHeavy:{label:"Rubber – Heavy",G:1960,REST:.88,FRICTION:.003,sizeScale:2,maxBalls:400,sizeVariation:.15}},Aa={fullRain:{label:"Full Rain (top-half)",EMIT_INTERVAL:.03,xCenter:50,y:-50,w:100,h:50},narrowStrip:{label:"Narrow Strip Top",EMIT_INTERVAL:.05,xCenter:50,y:-40,w:20,h:10},leftGutter:{label:"Left Gutter",EMIT_INTERVAL:.045,xCenter:10,y:-60,w:18,h:20},rightGutter:{label:"Right Gutter",EMIT_INTERVAL:.045,xCenter:90,y:-60,w:18,h:20},centerFountain:{label:"Center Fountain",EMIT_INTERVAL:.02,xCenter:50,y:-30,w:30,h:20},stormBurst:{label:"Storm Burst",EMIT_INTERVAL:.005,xCenter:50,y:-80,w:100,h:30},slowSnow:{label:"Slow Snow",EMIT_INTERVAL:.2,xCenter:50,y:-30,w:100,h:20},edgeDrizzle:{label:"Edge Drizzle",EMIT_INTERVAL:.08,xCenter:15,y:-40,w:30,h:15},twinColumns:{label:"Twin Columns",EMIT_INTERVAL:.03,xCenter:30,y:-50,w:10,h:40},focusedBeam:{label:"Focused Beam",EMIT_INTERVAL:.015,xCenter:50,y:-70,w:6,h:12}},qa={off:{label:"Off",r:710,p:274e3,s:4.4},gentle:{label:"Gentle Breeze",r:120,p:2500,s:2.5},pushField:{label:"Push Field",r:240,p:8e4,s:2},tractor:{label:"Tractor Push",r:320,p:14e4,s:1.6},magnet:{label:"Magnet Repel",r:200,p:18e4,s:3},pulse:{label:"Pulse Strong",r:280,p:22e4,s:1.2},wideSoft:{label:"Wide Soft",r:500,p:8e4,s:4.5},needle:{label:"Needle Point",r:80,p:26e4,s:.8},wall:{label:"Invisible Wall",r:700,p:16e4,s:5},singularity:{label:"Singularity",r:600,p:3e5,s:.5}},ka=document.getElementById("physicsSelect"),Ga=document.getElementById("spawnSelect"),za=document.getElementById("repellerSelect");ka&&F(ka,Pa,"rubberRacquet"),Ga&&F(Ga,Aa,"fullRain"),za&&F(za,qa,"off"),Vn&&F(Vn,ue,"industrialTeal"),P("rubberRacquet"),A("fullRain"),q("off"),Re("⚠️ localStorage is disabled - using defaults"),console.log("🔍 Initializing dark mode system..."),Gt=function(){if(console.log("🔍 STATE: DETERMINING_MODE"),qt="determining_mode",!kt)return console.log("✓ Dark mode disabled by user → Light mode"),!1;const t=n();return console.log(`✓ Dark mode determination complete → ${t?"DARK":"LIGHT"} mode`),t}(),console.log(`✅ Dark mode determined: ${Gt?"DARK":"LIGHT"} mode`),Gt?Tt.classList.add("dark-mode"):Tt.classList.remove("dark-mode"),console.log(`   Container classes: ${Tt.classList.toString()}`),console.log("   Background should be: "+(Gt?"#0a0a0a (dark)":"#cecece (light)")),d(me),console.log(`   Color template applied: ${me} (${Gt?"dark":"light"} variant)`);const Oa=setInterval(a,6e4);window.addEventListener("unload",()=>{Oa&&clearInterval(Oa)}),ka&&ka.addEventListener("change",()=>P(ka.value)),Ga&&Ga.addEventListener("change",()=>A(Ga.value)),za&&za.addEventListener("change",()=>q(za.value)),l(),r(),e();{const ja=Object.values(MODES),_a=ja[Math.floor(Math.random()*ja.length)];k=_a,console.log(`🎲 Random mode selected: ${_a}`)}T(k),window.addEventListener("beforeunload",u)})();
  </script>
<div id="bravia-balls">
  <canvas id="c" aria-label="Interactive bouncy balls physics simulation" role="application" draggable="false"></canvas>
  <div class="panel" id="controlPanel" role="region" aria-label="Simulation controls" tabindex="-1">
  
  <!-- Draggable header -->
  <div class="panel-header" id="panelHeader" role="banner">
    <span><span class="drag-handle" aria-hidden="true">⋮⋮</span>Controls</span>
    <button style="cursor: pointer; opacity: 0.7; background: none; border: none; color: inherit; font-size: 16px; padding: 0;" id="minimizePanel" title="Toggle panel" aria-label="Toggle control panel" aria-expanded="true">−</button>
  </div>
  
  <!-- Screen reader announcements -->
  <div role="status" aria-live="polite" aria-atomic="true" style="position: absolute; left: -10000px; width: 1px; height: 1px; overflow: hidden;" id="announcer"></div>
  
  <!-- 120 FPS Performance Mode Toggle (TOP PRIORITY) -->
  <div style="margin-bottom: 12px; padding: 8px; background: rgba(255,0,0,0.15); border-radius: 4px; border: 1px solid rgba(255,0,0,0.3);">
    <label style="display: flex; align-items: center; cursor: pointer; font-weight: 600; font-size: 11px;">
      <input type="checkbox" id="performanceModeToggle" style="margin-right: 8px; cursor: pointer;">
      <span>⚡ 120 FPS Performance Mode</span>
    </label>
    <div style="font-size: 9px; opacity: 0.7; margin-top: 6px; line-height: 1.3;">
      Aggressive optimizations: reduces balls, disables glass morphism, targets 120 FPS
    </div>
    <div id="performanceModeStatus" style="font-size: 9px; margin-top: 6px; padding: 4px; background: rgba(0,0,0,0.2); border-radius: 3px; font-family: monospace;">
      🎨 Normal Mode (350 balls)
    </div>
  </div>
  
  <!-- Dark Mode Toggle -->
  <div style="margin-bottom: 12px; padding: 8px; background: rgba(100,100,255,0.15); border-radius: 4px; border: 1px solid rgba(100,100,255,0.3);">
    <label style="display: flex; align-items: center; cursor: pointer; font-weight: 600; font-size: 11px;">
      <input type="checkbox" id="darkModeToggle" style="margin-right: 8px; cursor: pointer;">
      <span>🌙 Auto Dark Mode</span>
    </label>
    <div style="font-size: 9px; opacity: 0.7; margin-top: 6px; line-height: 1.3;">
      Automatically enables dark background from sunset (6 PM) to sunrise (6 AM)
    </div>
    <div id="darkModeStatus" style="font-size: 9px; margin-top: 6px; padding: 4px; background: rgba(0,0,0,0.2); border-radius: 3px; font-family: monospace;">
      ☀️ Day Mode
    </div>
  </div>
  
  <!-- ═══════════════════════════════════════════════════════════════════════ -->
  <!-- GLOBAL SETTINGS (apply to ALL modes) - ABOVE MODE SWITCHER             -->
  <!-- ═══════════════════════════════════════════════════════════════════════ -->
  
  <details open>
    <summary>🌐 Global Ball Properties</summary>
    <div class="group">
        <label title="Global ball size scale (0.1-6.0). Smaller = more balls fit, larger = more dramatic collisions">Size: <span class="val" id="sizeValGlobal">1.0</span><input type="range" id="sizeSliderGlobal" min="0.1" max="6.0" step="0.05" value="1.0"></label>
        <label title="Ball deformation on collision (0-100). 0 = rigid/hard, 100 = very soft/squishy">Softness: <span class="val" id="ballSoftnessValGlobal">20</span><input type="range" id="ballSoftnessSliderGlobal" min="0" max="100" step="1" value="20"></label>
        <div style="font-size: 9px; opacity: 0.7; margin-top: 4px;">Softness: 0 = rigid, 20 = subtle, 100 = very squishy</div>
    </div>
  </details>
  
  <!-- Build Controls -->
  <div style="margin-bottom: 12px; padding: 8px; background: rgba(0,255,0,0.1); border-radius: 4px; text-align: center;">
    <button id="saveConfigBtn" style="background: #4CAF50; color: white; border: none; padding: 8px 16px; border-radius: 4px; cursor: pointer; font-weight: bold; margin-right: 8px;">💾 Save Config</button>
    <button id="buildBtn" style="background: #2196F3; color: white; border: none; padding: 8px 16px; border-radius: 4px; cursor: pointer; font-weight: bold;">🚀 Build Embed</button>
    <div style="font-size: 9px; opacity: 0.7; margin-top: 6px; line-height: 1.3;">Save downloads current-config.json → replace in source/ folder</div>
    <div id="configOutput" style="margin-top: 8px; font-family: monospace; font-size: 10px; color: #333; max-height: 120px; overflow-y: auto; display: none; text-align: left; background: rgba(255,255,255,0.8); padding: 6px; border-radius: 3px;"></div>
    </div>
  
  <details open>
    <summary>🎨 Colors</summary>
    <div class="group">
        <label>Color template: <select id="colorSelect"></select></label>
        <label>Color 1 (50%): <input type="color" id="color1" value="#ffffff"> <span class="hex-val" id="color1Val">#ffffff</span></label>
        <label>Color 2 (25%): <input type="color" id="color2" value="#f8f9fa"> <span class="hex-val" id="color2Val">#f8f9fa</span></label>
        <label>Color 3 (12%): <input type="color" id="color3" value="#e9ecef"> <span class="hex-val" id="color3Val">#e9ecef</span></label>
        <label>Color 4 (6%): <input type="color" id="color4" value="#d90429"> <span class="hex-val" id="color4Val">#d90429</span></label>
        <label>Color 5 (3%): <input type="color" id="color5" value="#000000"> <span class="hex-val" id="color5Val">#000000</span></label>
        <label>Color 6 (2%): <input type="color" id="color6" value="#54d4ff"> <span class="hex-val" id="color6Val">#54d4ff</span></label>
        <label>Color 7 (1%): <input type="color" id="color7" value="#b589ff"> <span class="hex-val" id="color7Val">#b589ff</span></label>
        <label>Color 8 (1%): <input type="color" id="color8" value="#ffc27a"> <span class="hex-val" id="color8Val">#ffc27a</span></label>
        <label>Cursor color:
          <select id="cursorColorSelect">
            <option value="1">Color 1</option>
            <option value="2">Color 2</option>
            <option value="3">Color 3</option>
            <option value="4">Color 4</option>
            <option value="5" selected>Color 5 (highlight)</option>
            <option value="6">Color 6</option>
            <option value="7">Color 7</option>
            <option value="8">Color 8</option>
          </select>
        </label>
        <div style="font-size: 9px; opacity: 0.7; margin-top: 4px;">Colors appear by weight: 1 is most common, 8 is rarest</div>
    </div>
  </details>
  
  <details open>
    <summary>🌑 Canvas Shadow</summary>
    <div class="group">
      <label title="Enable/disable canvas drop-shadow filter">
        <span>Shadow enabled</span>
        <input type="checkbox" id="canvasShadowEnabled">
      </label>
      <label title="Shadow horizontal offset (-20 to 20px)">
        <span>Shadow X offset (px)</span>
        <input type="range" id="shadowOffsetX" min="-20" max="20" step="0.1" value="1">
        <span class="val" id="shadowOffsetXVal">1</span>
      </label>
      <label title="Shadow vertical offset (-20 to 20px)">
        <span>Shadow Y offset (px)</span>
        <input type="range" id="shadowOffsetY" min="-20" max="20" step="0.1" value="1">
        <span class="val" id="shadowOffsetYVal">1</span>
      </label>
      <label title="Shadow blur radius (0-30px)">
        <span>Shadow blur (px)</span>
        <input type="range" id="shadowBlur" min="0" max="30" step="0.1" value="0">
        <span class="val" id="shadowBlurVal">0</span>
          </label>
      <label title="Shadow opacity (0-1)">
        <span>Shadow opacity</span>
        <input type="range" id="shadowOpacity" min="0" max="1" step="0.01" value="0.29">
        <span class="val" id="shadowOpacityVal">0.29</span>
          </label>
      <label title="Shadow color">
        <span>Shadow color</span>
        <input type="color" id="shadowColor" value="#000000">
        <span class="hex-val" id="shadowColorVal">#000000</span>
          </label>
      <label title="Additional shadow layer for depth">
        <span>Second shadow enabled</span>
        <input type="checkbox" id="shadow2Enabled">
          </label>
      <label title="Second shadow blur (0-20px)">
        <span>Shadow 2 blur (px)</span>
        <input type="range" id="shadow2Blur" min="0" max="20" step="1" value="4">
        <span class="val" id="shadow2BlurVal">4</span>
          </label>
      <label title="Second shadow opacity (0-1)">
        <span>Shadow 2 opacity</span>
        <input type="range" id="shadow2Opacity" min="0" max="1" step="0.01" value="0.10">
        <span class="val" id="shadow2OpacityVal">0.10</span>
          </label>
    </div>
  </details>
  
  <!-- ═══════════════════════════════════════════════════════════════════════ -->
  <!--                        MODE SWITCHER & MODE SETTINGS                     -->
  <!-- ═══════════════════════════════════════════════════════════════════════ -->
  
  <div style="margin: 20px 0; padding: 12px 0; border-top: 1px solid rgba(255,255,255,0.15);">
    <div style="text-align: center; font-size: 10px; font-weight: 600; text-transform: uppercase; letter-spacing: 1px; opacity: 0.6; margin-bottom: 12px;">
      Mode Settings
    </div>
    
    <!-- Mode Switcher -->
    <div class="mode-switcher" style="margin-bottom: 16px;" role="group" aria-label="Simulation mode selector">
      <button class="mode-button active" data-mode="pit" aria-label="Ball Pit mode" aria-pressed="true">🎯 Pit</button>
      <button class="mode-button" data-mode="flies" aria-label="Flies to Light mode" aria-pressed="false">🕊️ Flies</button>
      <button class="mode-button" data-mode="weightless" aria-label="Zero Gravity mode" aria-pressed="false">🌌 Zero-G</button>
      <button class="mode-button" data-mode="pulse-grid" aria-label="Pulse Grid mode" aria-pressed="false">🎹 Pulse</button>
      <button class="mode-button" data-mode="vortex" aria-label="Vortex Spiral mode" aria-pressed="false">🌀 Vortex</button>
    </div>
  </div>
  
  <div id="pitControls" class="mode-controls active">
    <details open>
      <summary>🎯 Ball Pit Mode</summary>
      <div class="group">
        <label title="Choose physics preset (Rubber, Bouncy, etc.)">
          <span>Physics template</span>
          <select id="physicsSelect"></select>
        </label>
        <label title="Gravity strength (0.0-2.0× Earth gravity). Config: 0 = zero gravity (weightless)">
          <span>Gravity (×Earth)</span>
          <input type="range" id="gravityPitSlider" min="0.0" max="2.0" step="0.05" value="0.0">
          <span class="val" id="gravityPitVal">0.0</span>
        </label>
        <label title="Ball mass/weight (50-200 grams). Config: 19.8g for lighter feel">
          <span>Weight (grams)</span>
          <input type="range" id="weightPitSlider" min="10.0" max="200.0" step="1.0" value="19.8">
          <span class="val" id="weightPitVal">19.8</span>
        </label>
        <label title="Bounce restitution (0.0-1.0). Config: 0.97 for bouncier feel">
          <span>Bounciness</span>
          <input type="range" id="restitutionSlider" min="0.00" max="1.00" step="0.01" value="0.97">
          <span class="val" id="restitutionVal">0.97</span>
        </label>
        <label title="Air resistance/friction (0.000-0.010). Config: 0.0035 for light drag">
          <span>Air friction</span>
          <input type="range" id="frictionSlider" min="0.000" max="0.010" step="0.0005" value="0.0035">
          <span class="val" id="frictionVal">0.0035</span>
        </label>
      </div>
    </details>
    <details open>
      <summary>🖼️ Scene & Effects</summary>
      <div class="group">
        <label title="Maximum number of balls in simulation (50-800). Higher = more crowded. Config: 350 for zero-gravity">
          <span>Max balls</span>
          <input type="range" id="maxBallsSlider" min="50" max="800" step="25" value="350">
          <span class="val" id="maxBallsVal">350</span>
        </label>
        <label title="Rounded corner radius for viewport (0-50 pixels). 0 = sharp corners">
          <span>Corner radius (px)</span>
          <input type="range" id="cornerRadiusSlider" min="0" max="50" step="2" value="0">
          <span class="val" id="cornerRadiusVal">0</span>
        </label>
        <label title="Motion blur trail length (0.0-0.5). Config: 0.025 for subtle trails">
          <span>Motion blur</span>
          <input type="range" id="trailFadeSlider" min="0.000" max="0.500" step="0.005" value="0.025">
          <span class="val" id="trailFadeVal">0.025</span>
        </label>
        <label title="Motion blur intensity (0.5-2.0×). Config: 1.8× for pronounced trails">
          <span>Blur intensity</span>
          <input type="range" id="trailSubtletySlider" min="0.50" max="2.00" step="0.05" value="1.80">
          <span class="val" id="trailSubtletyVal">1.80×</span>
        </label>
        <div style="font-size: 9px; opacity: 0.7; margin-top: 4px;">Motion blur works in all modes</div>
      </div>
    </details>
    <details open>
      <summary>🎯 Spawn Settings</summary>
      <div class="group">
        <label title="Choose spawn behavior preset">
          <span>Spawn template</span>
          <select id="spawnSelect"></select>
        </label>
        <label title="Time between ball spawns (0.01-0.5 seconds). Lower = more frequent">
          <span>Emit interval (s)</span>
          <input type="range" id="emitterSlider" min="0.010" max="0.500" step="0.005" value="0.04">
          <span class="val" id="emitterVal">0.04</span>
        </label>
        <label title="Vertical spawn position (-100 to 100% viewport height). Negative = above viewport">
          <span>Spawn Y position (%)</span>
          <input type="range" id="spawnYSlider" min="-100" max="100" step="5" value="-50">
          <span class="val" id="spawnYVal">-50</span>
        </label>
        <label title="Horizontal spawn area width (10-100% viewport width). 100% = full width">
          <span>Spawn width (%)</span>
          <input type="range" id="spawnWidthSlider" min="10" max="100" step="5" value="100">
          <span class="val" id="spawnWidthVal">100</span>
        </label>
        <label title="Horizontal spawn center position (0-100% viewport width). 50% = center">
          <span>Spawn X center (%)</span>
          <input type="range" id="spawnCenterSlider" min="0" max="100" step="5" value="50">
          <span class="val" id="spawnCenterVal">50</span>
        </label>
        <label title="Vertical spawn area height (10-100% viewport height)">
          <span>Spawn height (%)</span>
          <input type="range" id="spawnHeightSlider" min="10" max="100" step="5" value="50">
          <span class="val" id="spawnHeightVal">50</span>
        </label>
      </div>
    </details>
    <details open>
      <summary>🧲 Mouse Repeller</summary>
      <div class="group">
        <label title="Choose repeller behavior preset">
          <span>Repeller template</span>
          <select id="repellerSelect"></select>
        </label>
        <label title="Enable/disable mouse repeller effect">
          <span>Repeller active</span>
          <input type="checkbox" id="repellerEnabledPit" checked>
        </label>
        <label title="Repeller influence radius (50-1000 pixels). Larger = affects more balls">
          <span>Repel size (px)</span>
          <input type="range" id="repelSizeSlider" min="50" max="1000" step="5" value="710">
          <span class="val" id="repelSizeVal">710</span>
        </label>
        <label title="Repulsion strength (0-10000). Higher = stronger push away from mouse">
          <span>Repel power</span>
          <input type="range" id="repelPowerSlider" min="0" max="10000" step="100" value="7920">
          <span class="val" id="repelPowerVal">274000</span>
        </label>
        <label title="Repeller field softness (0.5-5.0). Lower = sharper cutoff, higher = gradual fade">
          <span>Repel softness</span>
          <input type="range" id="repelSoftSlider" min="0.5" max="5.0" step="0.1" value="2.0">
          <span class="val" id="repelSoftVal">2.0</span>
        </label>
      </div>
    </details>
  </div>
  
  <div id="fliesControls" class="mode-controls">
    <details open>
      <summary>🕊️ Flies to Light Mode</summary>
      <div class="group">
        <label title="Attraction strength toward mouse (100-8000). Higher = stronger pull toward cursor">
          <span>Attraction power</span>
          <input type="range" id="attractPowerSlider" min="100" max="8000" step="50" value="5000">
          <span class="val" id="attractPowerVal">5000</span>
        </label>
        <label title="Orbit distance around mouse (50-400 pixels). Larger = wider swarm formation">
          <span>Orbit radius (px)</span>
          <input type="range" id="orbitRadiusSlider" min="50" max="400" step="10" value="180">
          <span class="val" id="orbitRadiusVal">180</span>
        </label>
        <label title="Swarm movement speed (0.2-5.0×). Higher = faster, more responsive">
          <span>Swarm speed (×)</span>
          <input type="range" id="swarmSpeedSlider" min="0.2" max="5.0" step="0.1" value="3.5">
          <span class="val" id="swarmSpeedVal">3.5</span>
        </label>
      </div>
    </details>
  </div>
  
  <!-- Weightless Mode Controls -->
  <div id="weightlessControls" class="mode-controls">
    <details open>
      <summary>🌌 Zero-G Mode</summary>
      <div class="group">
        <label title="Number of balls in scene (20-200). Fixed count, no spawning">
          <span>Ball count</span>
          <input type="range" id="weightlessCountSlider" min="20" max="200" step="10" value="80">
          <span class="val" id="weightlessCountVal">80</span>
        </label>
        <label title="Initial velocity magnitude (100-600 pixels/second). Realistic space: 200-300. Higher = faster motion">
          <span>Initial speed (px/s)</span>
          <input type="range" id="weightlessSpeedSlider" min="100" max="600" step="25" value="250">
          <span class="val" id="weightlessSpeedVal">250</span>
        </label>
        <label title="Wall bounce elasticity (0.8-1.0). Realistic space: 0.95-0.98. 1.0 = perfect energy conservation">
          <span>Bounce elasticity</span>
          <input type="range" id="weightlessBounceSlider" min="0.8" max="1.0" step="0.01" value="0.97">
          <span class="val" id="weightlessBounceVal">0.97</span>
        </label>
      </div>
    </details>
    <details open>
      <summary>🧲 Mouse Repeller</summary>
      <div class="group">
        <label title="Repeller strength (0-10000). 0 = disabled. Controls how strongly balls are pushed away from cursor">
          <span>Repeller power</span>
          <input type="range" id="weightlessRepelSlider" min="0" max="10000" step="100" value="300">
          <span class="val" id="weightlessRepelVal">300</span>
        </label>
        <label title="Repeller radius (50-300 pixels). Larger = wider push area around cursor">
          <span>Repeller radius (px)</span>
          <input type="range" id="weightlessRepelRadiusSlider" min="50" max="300" step="10" value="150">
          <span class="val" id="weightlessRepelRadiusVal">150</span>
        </label>
      </div>
    </details>
  </div>
  
  <!-- Pulse Grid Mode Controls -->
  <div id="pulseGridControls" class="mode-controls">
    <details open>
      <summary>🎹 Pulse Grid Mode</summary>
      <div class="group">
        <label title="Choose animation preset">
          <span>Animation preset</span>
          <select id="gridPresetSelect">
            <option value="synchronized">✨ Synchronized Pulse</option>
            <option value="organic" selected>🌿 Organic Flow</option>
            <option value="chaotic">⚡ Chaotic Dance</option>
          </select>
        </label>
        <label title="Number of balls in grid (40-200)">
          <span>Ball count</span>
          <input type="range" id="gridBallCountSlider" min="40" max="200" step="10" value="120">
          <span class="val" id="gridBallCountVal">120</span>
        </label>
        <label title="Number of columns in the grid (20-80). More columns = smaller cells">
          <span>Grid columns</span>
          <input type="range" id="gridColumnsSlider" min="20" max="80" step="5" value="40">
          <span class="val" id="gridColumnsVal">40</span>
        </label>
      </div>
    </details>
    <details open>
      <summary>⚡ Movement & Rhythm</summary>
      <div class="group">
        <label title="Time between movements in seconds (0.2-2.0). Lower = faster rhythm">
          <span>Beat interval (s)</span>
          <input type="range" id="pulseIntervalSlider" min="0.2" max="2.0" step="0.1" value="0.8">
          <span class="val" id="pulseIntervalVal">0.8</span>
        </label>
        <label title="Jump animation duration (0.1-1.0 seconds). Should be less than beat interval">
          <span>Jump speed (s)</span>
          <input type="range" id="pulseSpeedSlider" min="0.1" max="1.0" step="0.05" value="0.25">
          <span class="val" id="pulseSpeedVal">0.25</span>
        </label>
        <label title="Minimum grid cells to move (1-3)">
          <span>Min steps</span>
          <input type="range" id="pulseMinStepsSlider" min="1" max="3" step="1" value="1">
          <span class="val" id="pulseMinStepsVal">1</span>
        </label>
        <label title="Maximum grid cells to move (1-5)">
          <span>Max steps</span>
          <input type="range" id="pulseMaxStepsSlider" min="1" max="5" step="1" value="3">
          <span class="val" id="pulseMaxStepsVal">3</span>
        </label>
      </div>
    </details>
    <details open>
      <summary>🎭 Coordination & Chaos</summary>
      <div class="group">
        <label title="Movement synchronization (0-1). 0 = all balls move together, 1 = completely random timing">
          <span>Synchronicity</span>
          <input type="range" id="pulseSynchronicitySlider" min="0.0" max="1.0" step="0.05" value="0.3">
          <span class="val" id="pulseSynchronicityVal">0.30</span>
        </label>
        <label title="Movement variation (0-1). 0 = uniform, 1 = chaotic and unpredictable">
          <span>Randomness</span>
          <input type="range" id="pulseRandomnessSlider" min="0.0" max="1.0" step="0.05" value="0.4">
          <span class="val" id="pulseRandomnessVal">0.40</span>
        </label>
      </div>
    </details>
    <details open>
      <summary>🤖 Animation Style</summary>
      <div class="group">
        <label title="Animation easing style">
          <span>Easing style</span>
          <select id="pulseEasingSelect">
            <option value="linear">Linear (Constant speed)</option>
            <option value="snap" selected>Snap (Robotic)</option>
            <option value="bounce">Bounce (Elastic)</option>
            <option value="smooth">Smooth (Ease in-out)</option>
          </select>
        </label>
        <label title="Overshoot amount (1.0-1.3). 1.0 = no overshoot, 1.2 = 20% overshoot for robotic snap">
          <span>Overshoot</span>
          <input type="range" id="pulseOvershootSlider" min="1.0" max="1.3" step="0.01" value="1.08">
          <span class="val" id="pulseOvershootVal">1.08</span>
        </label>
        <label title="Bounce-back intensity (0-0.5). Higher = more pronounced settle-back effect">
          <span>Bounce intensity</span>
          <input type="range" id="pulseBounceSlider" min="0.0" max="0.5" step="0.01" value="0.15">
          <span class="val" id="pulseBounceVal">0.15</span>
        </label>
      </div>
    </details>
  </div>
  
  <!-- Vortex Mode Controls -->
  <div id="vortexControls" class="mode-controls">
    <details open>
      <summary>🌀 Vortex Spiral Mode</summary>
      <div class="group">
        <label title="Number of orbiting balls (50-300)">
          <span>Ball count</span>
          <input type="range" id="vortexBallCountSlider" min="50" max="300" step="10" value="200">
          <span class="val" id="vortexBallCountVal">200</span>
        </label>
        <label title="Central gravity well strength (1000-15000)">
          <span>Well strength</span>
          <input type="range" id="vortexWellStrengthSlider" min="1000" max="15000" step="500" value="5000">
          <span class="val" id="vortexWellStrengthVal">5000</span>
        </label>
        <label title="Mouse cursor gravity well strength (0-10000)">
          <span>Mouse strength</span>
          <input type="range" id="vortexMouseStrengthSlider" min="0" max="10000" step="500" value="3000">
          <span class="val" id="vortexMouseStrengthVal">3000</span>
        </label>
        <label title="Initial orbital velocity (50-400 px/s)">
          <span>Initial speed</span>
          <input type="range" id="vortexInitialSpeedSlider" min="50" max="400" step="10" value="180">
          <span class="val" id="vortexInitialSpeedVal">180</span>
        </label>
        <label title="Orbital decay rate (-0.001 to 0.001). Positive = spiral in, negative = spiral out">
          <span>Orbital decay</span>
          <input type="range" id="vortexDecaySlider" min="-0.001" max="0.001" step="0.0001" value="0.0002">
          <span class="val" id="vortexDecayVal">0.0002</span>
        </label>
        <label title="Color balls based on speed (blue=slow, red=fast)">
          <span>Speed coloring</span>
          <input type="checkbox" id="vortexSpeedColorCheckbox" checked>
        </label>
      </div>
    </details>
    
    <!-- Save & Reset Controls -->
    <div style="margin-top: 16px; padding-top: 16px; border-top: 2px solid rgba(255,255,255,0.15);">
      <button id="resetBtn" style="padding: 10px 16px; background: #ff6b47; color: white; border: none; border-radius: 4px; cursor: pointer; font-weight: 600; width: 100%; font-size: 14px;">🔄 Reset to Defaults</button>
      <div style="font-size: 9px; opacity: 0.7; margin-top: 8px; text-align: center;">Clears saved settings & reloads with defaults</div>
    </div>
  </div>
  
    <div style="font-size:10px; opacity:0.8;">Press <code>R</code> to reset • <code>/</code> toggle panel • <code>1-5</code> switch modes</div>
  </div>
  
  <!-- FPS Counter -->
  <!-- FPS counter removed in production -->
</div>
  <script>
// Bouncy Balls Simulation - Minified
(()=>{function t(){return 0===G?0:wt*(G/40)}function e(){if(!ht)return void(Lt.style.filter="none");const t=(t,e)=>`rgba(${parseInt(t.slice(1,3),16)}, ${parseInt(t.slice(3,5),16)}, ${parseInt(t.slice(5,7),16)}, ${e})`,e=`drop-shadow(${ut}px ${mt}px ${gt}px ${t(pt,yt)})`,n=xt?` drop-shadow(${ut}px ${Math.round(.5*mt)}px ${ft}px ${t(pt,vt)})`:"";Lt.style.filter=e+n}function n(){const t=new Date,e=t.getHours(),n=e>=18||e<6;return console.log(`🌍 Time check: ${e}:${t.getMinutes().toString().padStart(2,"0")} → ${n?"Night":"Day"} (sunset: 18, sunrise: 6)`),n}function o(t){Gt=t,t?Tt.classList.add("dark-mode"):Tt.classList.remove("dark-mode"),d(me),function(){const t=document.getElementById("darkModeToggle"),e=document.getElementById("darkModeStatus");if(t&&(t.checked=kt),e){const t=new Date,n=`${t.getHours().toString().padStart(2,"0")}:${t.getMinutes().toString().padStart(2,"0")}`;Gt?(e.textContent=`🌙 Night Mode (${n})`,e.style.background="rgba(100,100,255,0.3)"):(e.textContent=`☀️ Day Mode (${n})`,e.style.background="rgba(255,200,0,0.3)")}}()}function a(){kt&&o(n())}function i(){const t=k===MODES.PIT?Et:It,e=window.innerHeight*t;if(Lt.width=Math.floor(window.innerWidth*Rt),Lt.height=Math.floor(e*Rt),k===MODES.PULSE_GRID){B();for(let t=0;t<Ne.length;t++){const e=Ne[t];e.gridX=Math.max(0,Math.min(sa-1,e.gridX)),e.gridY=Math.max(0,Math.min(ia-1,e.gridY));const n=b(e.gridX,e.gridY);e.x=n.x,e.y=n.y,e.targetX=n.x,e.targetY=n.y}}}function s(){se=Math.max(.5,Math.min(3,Math.pow(ae/1,.35)))}function l(){ne=(Lt.clientWidth||window.innerWidth)<=768?.4:1;const t=te*ne;if(null===oe)return oe=t,le=Qt*t,void(re=Kt*t);const e=t/oe;if(1!==e){for(let t=0;t<Ne.length;t++)Ne[t].r*=e;oe=t}le=Qt*t,re=Kt*t}function r(){Te=[];const t=document.querySelector(Le);if(!t)return;const e=t.getBoundingClientRect(),n=Lt.getBoundingClientRect(),o=function(t){const e=document.createElement("span");e.style.cssText=window.getComputedStyle(t).cssText,e.style.position="absolute",e.style.visibility="hidden",e.style.whiteSpace="nowrap",e.textContent="ABCDEFGHIJKLMNOPQRSTUVWXYZ",document.body.appendChild(e);const n=e.getBoundingClientRect().height;return document.body.removeChild(e),n}(t),a=.5*(e.height-o),i={x:(e.left-n.left)*Rt,y:(e.top-n.top+a)*Rt,width:e.width*Rt,height:o*Rt};i.width>0&&i.height>0&&i.x<Lt.width&&i.y<Lt.height&&i.x+i.width>0&&i.y+i.height>0&&Te.push(i)}function d(t){me=t,ge=function(t){const e=ue[t];return e?Gt?e.dark:e.light:ue.industrialTeal.light}(t),pe=ge[ye]||pe,V(),c(),function(){const t=document.getElementById("color1"),e=document.getElementById("color2"),n=document.getElementById("color3"),o=document.getElementById("color4"),a=document.getElementById("color5"),i=document.getElementById("color6"),s=document.getElementById("color7"),l=document.getElementById("color8"),r=document.getElementById("color1Val"),d=document.getElementById("color2Val"),c=document.getElementById("color3Val"),h=document.getElementById("color4Val"),u=document.getElementById("color5Val"),m=document.getElementById("color6Val"),g=document.getElementById("color7Val"),y=document.getElementById("color8Val");t&&r&&(t.value=ge[0],r.textContent=ge[0].toUpperCase()),e&&d&&(e.value=ge[1],d.textContent=ge[1].toUpperCase()),n&&c&&(n.value=ge[2],c.textContent=ge[2].toUpperCase()),o&&h&&(o.value=ge[3],h.textContent=ge[3].toUpperCase()),a&&u&&(a.value=ge[4],u.textContent=ge[4].toUpperCase()),i&&m&&(i.value=ge[5],m.textContent=ge[5].toUpperCase()),s&&g&&(s.value=ge[6],g.textContent=ge[6].toUpperCase()),l&&y&&(l.value=ge[7],y.textContent=ge[7].toUpperCase())}()}function c(t=ge){try{const e=document.documentElement,n=(t&&t.length?t:ge).slice(0,8);for(let t=0;t<8;t++){const o=n[t]||"#ffffff";e.style.setProperty(`--ball-${t+1}`,o)}}catch(t){}}function h(){try{if(!ge||0===ge.length)return console.warn("No colors available, using fallback"),"#ffffff";const t=Math.random();let e=0;for(let n=0;n<Math.min(ge.length,xe.length);n++)if(e+=xe[n],t<=e)return ge[n];return ge[Math.min(ge.length-1,7)]}catch(t){return console.error("Error picking random color:",t),"#ffffff"}}function u(){Re("⚠️ localStorage is disabled")}function m(){clearTimeout(window.settingsSaveTimeout),window.settingsSaveTimeout=setTimeout(u,500)}function g(t,e,n){return Math.max(e,Math.min(n,t))}function y(t,e){return t+Math.random()*(e-t)}function p(t,e,n=h()){const o=(le+re)/2;let a;if(0===ee)a=o;else{const t=.1*o;a=y(Math.max(1,o-t),o+t)}const i=new Ball(t,e,a,n),s=.5*Lt.width,l=de?he>=0?1:-1:t<s?1:-1,r=g(a/(.5*(le+re)),.6,1.4),d=140*r,c=180*r;return i.vx=l*(d+Math.random()*c),i.vy=120*-Math.random(),i.driftAx=l*(360+420*Math.random())*r,i.driftTime=.22+.28*Math.random(),Ne.push(i),i}function x(){const t=Lt.clientWidth,e=Lt.clientHeight,n=g(Nt/100*t,0,t);let o=g(Dt/100*t,0,t);if(de){const e=.2*t,n=o;o=g(o+Math.sin(ce)*e,0,t),he=o>=n?1:-1}const a=Math.min(40,.1*n),i=g(o-n/2-a,-a,t),s=g(o+n/2+a,-a,t),l=Ut/100*e,r=l+Xt/100*e,d=Math.random();return{x:(i+(s-i)*(he>0?Math.pow(d,.7):1-Math.pow(1-d,.7)))*Rt,y:y(l*Rt,r*Rt)-(re+bt+y(0,10*Rt))}}function f(e=6){const n=function(){const t=Ne.length;if(t<2)return[];const e=Math.max(1,2*re),n=Math.ceil(Lt.width/e)+1;We.clear();for(let o=0;o<t;o++){const t=Ne[o],a=t.x/e|0,i=(t.y/e|0)*n+a;let s=We.get(i);s||(s=[],We.set(i,s)),s.push(o)}const o=[];for(const[t,e]of We){const a=t/n|0,i=t%n;for(let t=-1;t<=1;t++)for(let s=-1;s<=1;s++){const l=(a+t)*n+(i+s),r=We.get(l);if(r)for(let t=0;t<e.length;t++){const n=e[t];for(let t=0;t<r.length;t++){const e=r[t];if(e<=n)continue;const a=Ne[n],i=Ne[e],s=i.x-a.x,l=i.y-a.y,d=a.r+i.r,c=s*s+l*l;if(c<d*d){const t=d-Math.sqrt(Math.max(c,St));o.push({i:n,j:e,overlap:t})}}}}}return o.sort((t,e)=>e.overlap-t.overlap),o}();for(let o=0;o<e;o++)for(let e=0;e<n.length;e++){const{i:o,j:a}=n[e],i=Ne[o],s=Ne[a],l=s.x-i.x,r=s.y-i.y,d=i.r+s.r,c=l*l+r*r;if(0===c||c>d*d)continue;const h=Math.sqrt(c),u=l/h,m=r/h,g=d-h,y=1/Math.max(i.m,.001),p=1/Math.max(s.m,.001),x=.8*Math.max(g-Jt,0)/(y+p),f=x*u,v=x*m;i.x-=f*y,i.y-=v*y,s.x+=f*p,s.y+=v*p;const E=s.vx-i.vx,I=s.vy-i.vy,M=E*u+I*m;if(M<0){const e=-(1+(Math.abs(M)<30?0:Yt))*M/(y+p),n=e*u,o=e*m;i.vx-=n*y,i.vy-=o*y,s.vx+=n*p,s.vy+=o*p;const a=E-M*u,l=I-M*m,r=Math.hypot(a,l);if(r>.001){const t=a*-m+l*u>=0?1:-1,e=Ct;i.omega-=t*e*r/Math.max(i.r,1),s.omega+=t*e*r/Math.max(s.r,1)}const d=Math.min(1,Math.abs(M)/(50*(i.r+s.r))),c=Math.min(t(),.8*d);i.squashAmount=Math.max(i.squashAmount,.8*c),i.squashNormalAngle=Math.atan2(-m,-u),s.squashAmount=Math.max(s.squashAmount,.8*c),s.squashNormalAngle=Math.atan2(m,u)}}}function v(){const t=parseFloat(pn.value);te=t,l();const e=(le+re)/2;for(let t=0;t<Ne.length;t++)if(0===ee)Ne[t].r=e,Ne[t].rBase=e;else{const n=.1*e,o=Math.max(1,e-n),a=e+n;Ne[t].r=y(o,a),Ne[t].rBase=Ne[t].r}}function E(){return{gravityMultiplier:Ht,restitution:Yt,friction:jt,ballMass:ae,emitRate:_t,maxBalls:Zt,ballScale:te,ballVariation:ee,spawnX:Dt,spawnY:Ut,spawnWidth:Nt,spawnHeight:Xt,sweepEnabled:de,repelRadius:fe,repelPower:ve,repelSoftness:Ee,trailFade:Ve,trailSubtlety:Fe,colors:ge.slice(),colorWeights:xe.slice(),currentTemplate:me,cursorColorIndex:ye,performanceMode:Pt,targetFPS:At,enableLOD:!0}}function I(t,e){t&&t.addEventListener("click",async()=>{const n="function"==typeof e?e():String(e||"").trim();try{await navigator.clipboard.writeText(n);const e=t.textContent;t.textContent="COPIED",t.style.color="#3ddc84",setTimeout(()=>{t.textContent=e,t.style.color="#888"},900)}catch(t){console.warn("Clipboard unavailable")}})}function M(){const t=(le+re)/2;for(let e=0;e<Ne.length;e++){const n=Ne[e];if(0===ee)n.r=t;else{const e=.1*t,o=Math.max(1,t-e),a=t+e;n.r=y(o,a)}n.m=ae}}function S(){Ne.length=0;const t=X,e=Lt.width,n=Lt.height,o=40*Rt;for(let a=0;a<t;a++){const t=p(o+Math.random()*(e-2*o),o+Math.random()*(n-2*o)),a=Math.random()*Math.PI*2,i=$*(.7+.3*Math.random());t.vx=Math.cos(a)*i,t.vy=Math.sin(a)*i,t.driftAx=0,t.driftTime=0}}function B(){const t=Lt.width,e=Lt.height;sa=j,aa=t/sa,ia=Math.floor(e/aa),la=(t-sa*aa)/2,ra=(e-ia*aa)/2}function b(t,e){return{x:la+(t+.5)*aa,y:ra+(e+.5)*aa}}function C(t,e){for(const n of Xe){const o=n.x-t.x,a=n.y-t.y,i=o*o+a*a,s=Math.sqrt(i);if(s<5)continue;const l=n.strength/i*e;t.vx+=o/s*l,t.vy+=a/s*l}0!==rt&&(t.vx*=1-rt,t.vy*=1-rt)}function w(){Ne.length=0,function(){Xe=[],$e=[];const t={x:Lt.width/(2*Rt),y:Lt.height/(2*Rt),strength:it,isPermanent:!0};Xe.push(t),$e.push(t)}();const t=Lt.width/Rt,e=Lt.height/Rt,n=t/2,o=e/2,a=.15*Math.min(t,e),i=.35*Math.min(t,e);for(let t=0;t<st;t++){const e=2*Math.PI*t/st+.5*(Math.random()-.5),s=a+Math.random()*(i-a),l=n+Math.cos(e)*s,r=o+Math.sin(e)*s,d=lt*(.7+.6*Math.random()),c=-Math.sin(e)*d,h=Math.cos(e)*d,u=(le+re)/2*(.9+.2*Math.random()),m=new Ball(l,r,u,c,h);Ne.push(m)}Re(`🌀 Vortex scene initialized: ${st} balls in orbital ring`)}function L(){Ne.length=0,B();const t=sa*ia,e=Math.min(et,t),n=[];for(let t=0;t<ia;t++)for(let e=0;e<sa;e++)n.push({gridX:e,gridY:t});for(let t=n.length-1;t>0;t--){const e=Math.floor(Math.random()*(t+1));[n[t],n[e]]=[n[e],n[t]]}for(let t=0;t<e;t++){const e=n[t],o=b(e.gridX,e.gridY),a=p(o.x,o.y);a.gridX=e.gridX,a.gridY=e.gridY,a.targetX=o.x,a.targetY=o.y,a.jumpProgress=1,a.vx=0,a.vy=0,a.driftAx=0,a.driftTime=0;const i=_,s=J*Math.random()*i;a.nextJumpTime=i+s}}function T(t){k=t,function(t){const e=document.getElementById("announcer");e&&(e.textContent="",setTimeout(()=>e.textContent=t,100))}(`Switched to ${{[MODES.PIT]:"Ball Pit",[MODES.FLIES]:"Flies to Light",[MODES.WEIGHTLESS]:"Zero Gravity",[MODES.PULSE_GRID]:"Pulse Grid",[MODES.VORTEX]:"Vortex Spiral"}[t]} mode`),Tt.className="",k===MODES.PIT&&Tt.classList.add("mode-pit"),i(),k===MODES.PIT?(Ht=z,Wt=$t*Ht,Be=O&&ve>0&&fe>0,de=!1,Ne.length=0,He=0,function(){Ne.length=0;const t=Zt,e=(Lt.width,Lt.clientHeight),n=Ut/100*e*Rt,o=n+Xt/100*e*Rt,a=Nt/100*Lt.clientWidth,i=Dt/100*Lt.clientWidth-a/2;for(let e=0;e<t;e++){const t=p((i+Math.random()*a)*Rt,n+Math.random()*(o-n));t.vx=100*(Math.random()-.5),t.vy=50*Math.random(),t.driftAx=0,t.driftTime=0}}(),v()):k===MODES.FLIES?(Ht=0,Wt=$t*Ht,Be=!1,de=!1,function(){Ne.length=0;const t=.5*Lt.width,e=.5*Lt.height,n=150*Rt;for(let o=0;o<60;o++){const o=Math.random()*Math.PI*2,a=Math.random()*n,i=p(t+Math.cos(o)*a,e+Math.sin(o)*a),s=.5+.5*Math.random(),l=Math.random()*Math.PI*2,r=300*s;i.vx=Math.cos(l)*r,i.vy=Math.sin(l)*r,i.driftAx=0,i.driftTime=0}}(),v()):k===MODES.WEIGHTLESS?(Ht=0,Wt=$t*Ht,Be=!1,de=!1,S(),v()):k===MODES.PULSE_GRID?(Ht=0,Wt=$t*Ht,Be=!1,de=!1,L(),v()):k===MODES.VORTEX&&(Ht=0,Wt=$t*Ht,Be=!1,de=!1,w(),v()),function(){const t=document.getElementById("pulseGridControls"),e=document.getElementById("vortexControls");ko&&ko.classList.toggle("active",k===MODES.PIT),Go&&Go.classList.toggle("active",k===MODES.FLIES),zo&&zo.classList.toggle("active",k===MODES.WEIGHTLESS),t&&t.classList.toggle("active",k===MODES.PULSE_GRID),e&&e.classList.toggle("active",k===MODES.VORTEX),qo.forEach(t=>{const e=t.getAttribute("data-mode")===k;t.classList.toggle("active",e),t.setAttribute("aria-pressed",e?"true":"false")})}()}function V(){for(let t=0;t<Ne.length;t++)Ne[t].color=h()}function F(t,e,n){t.innerHTML="";for(const[o,a]of Object.entries(e)){const e=document.createElement("option");e.value=o,e.textContent=a.label||o,o===n&&(e.selected=!0),t.appendChild(e)}}function R(t,e,n,o=0){t&&(t.value=String(n)),e&&(e.textContent=o>0?n.toFixed(o):n.toString())}function P(t){const e=Pa[t];if(!e)return;Yt=e.REST,jt=e.FRICTION,Zt=e.maxBalls,ee=e.sizeVariation;const n=e.sizeScale;te=n,l();for(let t=0;t<Ne.length;t++)Ne[t].m=ae;Ne.length>Zt&&(Ne.length=Zt),R(mn,to,Yt,2),R(gn,eo,jt,4),R(pn,vn,te,1),R(Mn,oo,Zt,0),R(xn,En,ee,1),M()}function A(t){const e=Aa[t];e&&(_t=e.EMIT_INTERVAL,Dt=e.xCenter,Ut=e.y,Nt=e.w,Xt=e.h,R(yn,no,_t,3),R(bn,so,Dt,0),R(Sn,ao,Ut,0),R(Bn,io,Nt,0),R(Cn,lo,Xt,0))}function q(t){const e=qa[t];if(!e)return;fe=e.r,ve=1*e.p,Be="off"!==t,R(wn,ro,fe,0);const n=function(t){const e=Math.max(1,Number(t))/24e3,n=.5+Math.log2(e)/12;return Math.round(Math.max(0,Math.min(1,n))*Ce)}(ve);Ln&&(Ln.value=String(n)),co&&(co.textContent=Math.round(ve).toString()),R(Tn,ho,Ee,1)}const MODES={PIT:"pit",FLIES:"flies",WEIGHTLESS:"weightless",PULSE_GRID:"pulse-grid",VORTEX:"vortex"};let k=MODES.PIT,G=20,z=1.05,O=!0,D=5e3,U=180,N=3.5,X=80,$=250,H=.97,W=300,Y=150,j=40,_=.8,Z=.25,J=.3,Q=.4,K=1,tt=3,et=120,nt=.15,ot="snap",at=1.08,it=5e3,st=200,lt=180,rt=2e-4,dt=3e3,ct=!1,ht=!1,ut=1,mt=1,gt=0,yt=.29,pt="#000000",xt=!1,ft=4,vt=.1;const Et=1.5,It=1,Mt=-1e9,St=1e-6,Bt=1e-4,bt=2,Ct=.18,wt=.2,Lt=document.getElementById("c"),Tt=document.getElementById("bravia-balls");let Vt;try{if(Vt=Lt.getContext("2d",{alpha:!0}),!Vt)throw new Error("Canvas 2D context not available");console.log("✅ Canvas initialized with alpha transparency")}catch(Da){throw console.error("❌ Failed to initialize canvas:",Da),Tt.innerHTML='\n      <div style="display: flex; align-items: center; justify-content: center; height: 100%; background: #1a1a1a; color: white; font-family: system-ui, -apple-system, sans-serif;">\n        <div style="text-align: center; padding: 40px; background: rgba(255,50,50,0.1); border: 2px solid rgba(255,50,50,0.3); border-radius: 12px; max-width: 480px;">\n          <div style="font-size: 72px; margin-bottom: 20px; filter: drop-shadow(0 4px 8px rgba(0,0,0,0.3));">⚠️</div>\n          <h2 style="margin: 0 0 16px 0; font-size: 24px; font-weight: 600;">Canvas Not Supported</h2>\n          <p style="margin: 0 0 12px 0; opacity: 0.9; line-height: 1.6; font-size: 15px;">Your browser doesn\'t support the HTML5 Canvas 2D features required for this interactive simulation.</p>\n          <p style="margin: 0; opacity: 0.7; font-size: 13px;">Please try a modern browser like Chrome, Firefox, Safari, or Edge.</p>\n        </div>\n      </div>\n    ',Da}const Ft=document.getElementById("controlPanel"),Rt=Math.max(1,Math.min(2,window.devicePixelRatio||1));let Pt=!1,At=60,qt="initializing",kt=!0,Gt=!1;const zt={normal:{maxBalls:350,collisionIters:2,adaptiveQualityMin:.5},performance:{maxBalls:200,collisionIters:1,adaptiveQualityMin:.3}};let Ot,Dt=50,Ut=-50,Nt=100,Xt=50;i(),window.addEventListener("resize",function(){clearTimeout(Ot),Ot=setTimeout(()=>{i(),l(),r()},150)});const $t=1960;let Ht=0,Wt=$t*Ht,Yt=.97,jt=.0035,_t=.03,Zt=350;const Jt=.5*Rt,Qt=6,Kt=24;let te=1,ee=0,ne=1,oe=null,ae=91;const ie=.15;let se=1;s();let le=Qt*te,re=Kt*te,de=!1,ce=0,he=1;const ue={industrialTeal:{label:"Industrial Teal",light:["#b7bcb7","#e4e9e4","#ffffff","#00695c","#000000","#ff4013","#0d5cb6","#ffa000"],dark:["#6b726b","#3d453d","#8a928a","#00e6c3","#d5d5d5","#ff6b47","#5b9aff","#ffb84d"]},sunsetCoral:{label:"Sunset Coral",light:["#bdbbb8","#e8e6e3","#ffffff","#ff3b3b","#000000","#00f5d4","#1e40af","#fb923c"],dark:["#716f6b","#3f3d3a","#8e8c88","#ff6b6b","#d8d8d8","#00ffe7","#6ba3ff","#ffb570"]},violetPunch:{label:"Violet Punch",light:["#b8b7c2","#e6e5ed","#ffffff","#9333ea","#000000","#dc2626","#0ea5e9","#facc15"],dark:["#6d6c7a","#3a3845","#8b8a98","#c266ff","#dad6e8","#ff5c5c","#42d4ff","#fff066"]},citrusBlast:{label:"Citrus Blast",light:["#bfbdb5","#eae8df","#ffffff","#ea580c","#000000","#e11d48","#2563eb","#059669"],dark:["#74726a","#403e38","#918f87","#ff8c4d","#dbd9d1","#ff5c7a","#6ba3ff","#00d699"]},cobaltSpark:{label:"Cobalt Spark",light:["#b5b8be","#e3e6eb","#ffffff","#1d4ed8","#000000","#ea580c","#db2777","#d97706"],dark:["#696d75","#3a3e45","#878b93","#6b9dff","#d6dae2","#ff8c5c","#ff66b3","#ffc266"]}};let me="industrialTeal",ge=ue.industrialTeal.light.slice(),ye=4,pe=ge[ye]||"#00695c";const xe=[.5,.25,.12,.06,.03,.02,.01,.01];let fe=710,ve=25e4,Ee=4,Ie=Mt,Me=Mt,Se=!1,Be=!1,be=!1;("ontouchstart"in window||navigator.maxTouchPoints>0)&&(be=!0);const Ce=1e4;let we=0;const Le="#hero-text";let Te=[],Ve=.025,Fe=1.8;const Re=console.log.bind(console);let Pe=0,Ae=0,qe=0,ke=0,Ge=0;const ze=document.getElementById("render-fps"),Oe=document.getElementById("physics-fps");let De=2,Ue=0;class Ball{constructor(t,e,n,o){this.x=t,this.y=e,this.vx=200*(2*Math.random()-1),this.vy=200*-Math.random(),this.r=n,this.rBase=n,this.m=ae,this.color=o,this.t=0,this.age=0,this.driftAx=0,this.driftTime=0,this.omega=0,this.squash=1,this.squashDirX=1,this.squashDirY=0,this.theta=0,this.squashAmount=0,this.squashNormalAngle=0,this.alpha=1}step(t){this.t+=t,this.age+=t,k!==MODES.WEIGHTLESS&&(this.vy+=Wt*se*t);const e=Math.max(.25,this.m/1),n=k===MODES.WEIGHTLESS?1e-4:jt,o=Math.max(0,1-n/e);this.vx*=o,this.vy*=o,0!==this.driftAx&&this.age<this.driftTime?this.vx+=this.driftAx*t/e:0!==this.driftAx&&(this.driftAx=0),function(t,e){k!==MODES.PIT?k!==MODES.FLIES?k!==MODES.WEIGHTLESS||function(t,e){if(Ie===Mt||Me===Mt)return;if(W<=0||Y<=0)return;const n=Y*Rt,o=t.x-Ie,a=t.y-Me,i=o*o+a*a;if(i>n*n)return;const s=Math.max(Math.sqrt(i),Bt),l=o/s,r=a/s,d=Math.max(0,1-s/n),c=W*d;t.vx+=l*c*e,t.vy+=r*c*e}(t,e):function(t,e){const n=Ie===Mt?.5*Lt.width:Ie,o=Me===Mt?.5*Lt.height:Me,a=n-t.x,i=o-t.y,s=a*a+i*i,l=Math.sqrt(s+1),r=a/l,d=i/l,c=D*N*2;t.vx+=r*c*e,t.vy+=d*c*e;const h=120*Rt;let u=0,m=0,g=0;for(let e=0;e<Ne.length;e++){const n=Ne[e];if(n===t)continue;const o=t.x-n.x,a=t.y-n.y,i=o*o+a*a;if(i<h*h&&i>0){const t=Math.sqrt(i),e=1-t/h;u+=o/t*e,m+=a/t*e,g++}}if(g>0){const n=15e3;t.vx+=u/g*n*e,t.vy+=m/g*n*e}const y=2500*N;if(Math.random()<.08){const e=Math.random()*Math.PI*2,n=1500*N;t.vx+=Math.cos(e)*n,t.vy+=Math.sin(e)*n}t.vx+=(Math.random()-.5)*y*e,t.vy+=(Math.random()-.5)*y*e;const p=.3+2*Math.random(),x=2e3*N*p*e;t.vx+=-d*x,t.vy+=r*x;const f=2200*N,v=Math.sqrt(t.vx*t.vx+t.vy*t.vy);v>f&&(t.vx=t.vx/v*f,t.vy=t.vy/v*f),t.vx*=.995,t.vy*=.995}(t,e):function(t,e){if(!Be)return;if(ve<=0||fe<=0)return;const n=fe*Rt,o=t.x-Ie,a=t.y-Me,i=o*o+a*a;if(i>n*n)return;const s=Math.max(Math.sqrt(i),Bt),l=o/s,r=a/s,d=Math.max(0,1-s/n),c=20*ve*Math.pow(d,Ee),h=Math.max(.25,t.m/1);t.vx+=l*c*e/h,t.vy+=r*c*e/h,t.vx+=10*(Math.random()-.5)*e,t.vy+=10*(Math.random()-.5)*e}(t,e)}(this,t),this.x+=this.vx*t,this.y+=this.vy*t;const a=Math.max(0,1-2*t);this.omega*=a,this.theta+=this.omega*t,this.theta>Math.PI?this.theta-=2*Math.PI:this.theta<-Math.PI&&(this.theta+=2*Math.PI);const i=Math.min(1,18*t);this.squashAmount+=(0-this.squashAmount)*i,this.squash=1-this.squashAmount}walls(e,n,o,a=Yt){const i=a;if(0===we){if(this.y+this.r>n){this.y=n-this.r;const e=this.vy,a=this.vx-this.omega*this.r,s=Math.max(.25,this.m/1);this.omega+=a/this.r*.25/s;const l=Math.max(0,1-1.5*o/s);this.vx*=l;const r=Math.abs(e)<70?0:i;this.vy=-this.vy*(r*Math.pow(1/this.m,ie));const d=Math.min(1,Math.abs(e)/(90*this.r));this.squashAmount=Math.min(t(),.8*d),this.squash=1-this.squashAmount,this.squashNormalAngle=-Math.PI/2;const c=this.vx/this.r;this.omega+=(c-this.omega)*Math.min(1,8*o)}const a=k===MODES.PIT?n/3:0;if(this.y-this.r<a){this.y=a+this.r;const e=this.vy;this.vy=-this.vy*i;const n=Math.min(1,Math.abs(e)/(90*this.r));this.squashAmount=Math.min(t(),.8*n),this.squash=1-this.squashAmount,this.squashNormalAngle=Math.PI/2}if(this.x+this.r>e){this.x=e-this.r;{const t=this.vy-this.omega*this.r,e=Math.max(.25,this.m/1);this.omega+=t/this.r*.125/e}this.vx=-this.vx*i;const n=Math.min(1,Math.abs(this.vx)/(90*this.r));this.squashAmount=Math.min(t(),.8*n),this.squash=1-this.squashAmount,this.squashNormalAngle=Math.PI}if(this.x-this.r<0){this.x=this.r;{const t=this.vy-this.omega*this.r,e=Math.max(.25,this.m/1);this.omega+=t/this.r*.125/e}this.vx=-this.vx*i;const e=Math.min(1,Math.abs(this.vx)/(90*this.r));this.squashAmount=Math.min(t(),.8*e),this.squash=1-this.squashAmount,this.squashNormalAngle=0}}else this.handleRoundedWallCollision(e,n);this.checkTextCollisions(o)}checkTextCollisions(e){for(let e=0;e<Te.length;e++){const n=Te[e],o=Math.max(n.x,Math.min(this.x,n.x+n.width)),a=Math.max(n.y,Math.min(this.y,n.y+n.height)),i=this.x-o,s=this.y-a,l=Math.sqrt(i*i+s*s);if(l<this.r)if(0===l){const t=this.x-n.x,e=n.x+n.width-this.x,o=this.y-n.y,a=n.y+n.height-this.y,i=Math.min(t,e,o,a);i===t?(this.x=n.x-this.r,this.vx=-Math.abs(this.vx)*Yt):i===e?(this.x=n.x+n.width+this.r,this.vx=Math.abs(this.vx)*Yt):i===o?(this.y=n.y-this.r,this.vy=-Math.abs(this.vy)*Yt):(this.y=n.y+n.height+this.r,this.vy=Math.abs(this.vy)*Yt)}else{const e=this.r-l,n=i/l,o=s/l;this.x+=n*e,this.y+=o*e;const a=this.vx*n+this.vy*o;if(a<0){this.vx-=2*a*n*Yt,this.vy-=2*a*o*Yt;const e=Math.min(1,Math.abs(a)/(70*this.r));this.squash=1-t()*e,this.squashDirX=Math.abs(n)>Math.abs(o)?1:0,this.squashDirY=Math.abs(o)>Math.abs(n)?1:0}}}}handleRoundedWallCollision(e,n){const o=we,a=[{x:o,y:o},{x:e-o,y:o},{x:e-o,y:n-o},{x:o,y:n-o}];for(let i=0;i<a.length;i++){const s=a[i],l=this.x-s.x,r=this.y-s.y,d=Math.sqrt(l*l+r*r);if(this.isInCornerRegion(s,e,n,o)&&d+this.r>o){const e=o-(d-this.r);if(e>0&&d>0){const n=l/d,o=r/d;this.x+=n*e,this.y+=o*e;const a=this.vx*n+this.vy*o;this.vx-=2*a*n*Yt,this.vy-=2*a*o*Yt;const i=Math.min(1,Math.abs(a)/(90*this.r));this.squashAmount=Math.min(t(),.8*i),this.squash=1-this.squashAmount,this.squashNormalAngle=Math.atan2(o,n)}}}if(this.y+this.r>n&&(this.x<o||this.x>e-o)&&(this.y=n-this.r,this.vy=-this.vy*(Yt*Math.pow(1/this.m,ie))),this.y-this.r<0&&(this.x<o||this.x>e-o)&&(this.y=this.r,this.vy=-this.vy*Yt),this.x+this.r>e&&(this.y<o||this.y>n-o)){this.x=e-this.r;{const t=this.vy-this.omega*this.r,e=Math.max(.25,this.m/1);this.omega+=t/this.r*.125/e}this.vx=-this.vx*(Yt*Math.pow(1/this.m,ie));const n=Math.min(1,Math.abs(this.vx)/(70*this.r));this.squashAmount=Math.min(t(),n),this.squash=1-this.squashAmount,this.squashNormalAngle=Math.PI}if(this.x-this.r<0&&(this.y<o||this.y>n-o)){this.x=this.r;{const t=this.vy-this.omega*this.r,e=Math.max(.25,this.m/1);this.omega+=t/this.r*.125/e}this.vx=-this.vx*(Yt*Math.pow(1/this.m,ie));const e=Math.min(1,Math.abs(this.vx)/(70*this.r));this.squashAmount=Math.min(t(),e),this.squash=1-this.squashAmount,this.squashNormalAngle=0}this.y+this.r>n&&this.x>=o&&this.x<=e-o&&(this.y=n-this.r,this.vy=-this.vy*(Yt*Math.pow(1/this.m,ie))),this.y-this.r<0&&this.x>=o&&this.x<=e-o&&(this.y=this.r,this.vy=-this.vy*(Yt*Math.pow(1/this.m,ie))),this.x+this.r>e&&this.y>=o&&this.y<=n-o&&(this.x=e-this.r,this.vx=-this.vx*(Yt*Math.pow(1/this.m,ie))),this.x-this.r<0&&this.y>=o&&this.y<=n-o&&(this.x=this.r,this.vx=-this.vx*(Yt*Math.pow(1/this.m,ie)))}isInCornerRegion(t,e,n,o){return t.x===o&&t.y===o?this.x<=o&&this.y<=o:t.x===e-o&&t.y===o?this.x>=e-o&&this.y<=o:t.x===e-o&&t.y===n-o?this.x>=e-o&&this.y>=n-o:t.x===o&&t.y===n-o&&this.x<=o&&this.y>=n-o}draw(e){e.save(),e.translate(this.x,this.y);const n=Math.min(t(),Math.max(0,this.squashAmount));if(this.r>15&&n>.001){const t=1+n,o=1/t;e.rotate(this.squashNormalAngle),e.scale(t,o),e.rotate(-this.squashNormalAngle)}e.beginPath(),e.arc(0,0,this.r,0,2*Math.PI);let o=this.color;if(k===MODES.VORTEX&&ct){const t=Math.sqrt(this.vx*this.vx+this.vy*this.vy),e=800;o=`hsl(${220-220*Math.min(t/e,1)}, 70%, 55%)`}e.fillStyle=o,e.fill(),e.restore()}}const Ne=[];let Xe=[],$e=[],He=0;const We=new Map;let Ye=performance.now()/1e3,je=0;const _e=1/120;console.log("High refresh mode enabled - using requestAnimationFrame"),requestAnimationFrame(function frame(t){const e=t/1e3;let n=Math.min(.033,e-Ye);Ye=e,je+=n,(ze||Oe)&&Pe++,(ze||Oe)&&e-qe>=1&&(ze&&Pe!==ke&&(ke=Pe,ze.textContent=ke.toString()),Oe&&Ae!==Ge&&(Ge=Ae,Oe.textContent=Ge.toString()),Pe=0,Ae=0,qe=e,function(t){t-Ue<2||(Ue=t,ke<50?(De=1,console.log("⚡ Adaptive Quality: LOW (1 collision iter) - FPS:",ke)):ke<70?(De=2,console.log("⚡ Adaptive Quality: MEDIUM (2 collision iters) - FPS:",ke)):(De=3,console.log("⚡ Adaptive Quality: HIGH (3 collision iters) - FPS:",ke)))}(e)),function(t){if(k!==MODES.PIT&&k!==MODES.WEIGHTLESS&&k!==MODES.PULSE_GRID)for(He+=t;He>=_t;){const t=(Math.random()-.5)*_t*.5;He-=_t+t,ce+=2*Math.PI*.12*(_t+t);const e=x(),n=Math.random()<.35?3:1;for(let t=0;t<n;t++)if(Ne.length<Zt){const n=8*t*(Math.random()<.5?1:-1);p(e.x+n,e.y-12*t)}}}(n),k===MODES.PULSE_GRID&&function(t){for(let e=0;e<Ne.length;e++){const n=Ne[e];if(n.nextJumpTime-=t,n.nextJumpTime<=0&&n.jumpProgress>=1){const t=[{dx:0,dy:-1},{dx:0,dy:1},{dx:-1,dy:0},{dx:1,dy:0}],e=t[Math.floor(Math.random()*t.length)],o=tt-K+1,a=K+Math.floor(Math.random()*o),i=Math.max(1,Math.round(a*(1-.5*Q+Q*Math.random())));let s=n.gridX+e.dx*i,l=n.gridY+e.dy*i;s=Math.max(0,Math.min(sa-1,s)),l=Math.max(0,Math.min(ia-1,l)),n.gridX=s,n.gridY=l;const r=b(s,l);n.targetX=r.x,n.targetY=r.y,n.jumpProgress=0,n.jumpStartX=n.x,n.jumpStartY=n.y;const d=Q*_*(Math.random()-.5),c=J*_*Math.random();n.nextJumpTime=_+d+c}if(n.jumpProgress<1)if(n.jumpProgress+=t/Z,n.jumpProgress>=1)n.jumpProgress=1,n.x=n.targetX,n.y=n.targetY,n.vx=0,n.vy=0;else{const t=n.jumpProgress;let e=t;if("linear"===ot)e=t;else if("snap"===ot)if(t<.6){const n=t/.6;e=n*n*at}else{const n=(t-.6)/.4;e=1+(at-1)*(1-n)-nt*Math.sin(n*Math.PI)}else if("bounce"===ot)if(t<.7)e=t/.7*(t/.7);else{const n=(t-.7)/.3;e=1-.5*nt*Math.sin(n*Math.PI*2)}else"smooth"===ot&&(e=t<.5?2*t*t:1-Math.pow(-2*t+2,2)/2);n.x=n.jumpStartX+(n.targetX-n.jumpStartX)*e,n.y=n.jumpStartY+(n.targetY-n.jumpStartY)*e,n.vx=0,n.vy=0}}}(n),Pe%60==0&&r(),k===MODES.VORTEX&&function(){const t=Lt.width/Rt,e=Lt.height/Rt,n=Se?Ie/Rt:t/2,o=Se?Me/Rt:e/2;Xe=[{x:n,y:o,strength:it,isPermanent:!1}],$e.length>0&&($e[0].x=n,$e[0].y=o)}();let o=0;for(;je>=_e&&o<2;){if(k!==MODES.PULSE_GRID){const t=Ne.length;for(let e=0;e<t;e++)Ne[e].step(_e),k===MODES.VORTEX&&C(Ne[e],_e)}if(k!==MODES.FLIES&&k!==MODES.PULSE_GRID&&k!==MODES.VORTEX&&f(De),k!==MODES.PULSE_GRID){const t=k===MODES.WEIGHTLESS?H:Yt,e=Ne.length;for(let n=0;n<e;n++)Ne[n].walls(Lt.width,Lt.height,_e,t)}je-=_e,o++,Ae++}je>3*_e&&(je=0),Vt.clearRect(0,0,Lt.width,Lt.height),we>0&&function(t,e,n){const o=we;t.strokeStyle="rgba(255, 255, 255, 0.1)",t.lineWidth=2,t.beginPath(),t.moveTo(o,0),t.lineTo(e-o,0),t.arcTo(e,0,e,o,o),t.lineTo(e,n-o),t.arcTo(e,n,e-o,n,o),t.lineTo(o,n),t.arcTo(0,n,0,n-o,o),t.lineTo(0,o),t.arcTo(0,0,o,0,o),t.closePath(),t.stroke()}(Vt,Lt.width,Lt.height);const a=Ne.length;for(let t=0;t<a;t++)Ne[t].draw(Vt);if(function(t){if(be)return;if(Ie===Mt||Me===Mt)return;const e=Ie,n=Me,o=(le+re)/2*1.33;t.beginPath(),t.arc(e,n,o,0,2*Math.PI),t.fillStyle="rgba(255, 255, 255, 0.9)",t.fill(),t.strokeStyle="rgba(255, 255, 255, 0.6)",t.lineWidth=2,t.stroke()}(Vt),!be){Vt.save(),Vt.font="14px system-ui, -apple-system, sans-serif",Vt.fillStyle="rgba(255, 255, 255, 0.3)",Vt.textAlign="left",Vt.textBaseline="bottom";const t=k.charAt(0).toUpperCase()+k.slice(1);Vt.fillText(t+" Mode",10,Lt.height-10),Vt.restore()}requestAnimationFrame(frame)});const Ze=document.getElementById("panelHeader"),Je=document.getElementById("minimizePanel");if(Ft&&Ft.classList.add("hidden"),Je&&Ft&&Je.addEventListener("click",t=>{t.stopPropagation(),Ft.classList.toggle("hidden")}),Ze&&Ft){let Ua,Na,Xa,$a,Ha=!1,Wa=0,Ya=0;function Qe(t){"touchstart"===t.type?(Xa=t.touches[0].clientX-Wa,$a=t.touches[0].clientY-Ya):(Xa=t.clientX-Wa,$a=t.clientY-Ya),(t.target===Ze||Ze.contains(t.target))&&(Ha=!0,Ft.style.cursor="grabbing")}function Ke(t){if(Ha){t.preventDefault(),"touchmove"===t.type?(Ua=t.touches[0].clientX-Xa,Na=t.touches[0].clientY-$a):(Ua=t.clientX-Xa,Na=t.clientY-$a),Wa=Ua,Ya=Na,Ft.getBoundingClientRect();const e=window.getComputedStyle(Ft),n=parseFloat(e.top)||0,o=parseFloat(e.right)||0;Ft.style.top=`${n+Ya}px`,Ft.style.right=o-Wa+"px",Ft.style.left="auto",Ft.style.bottom="auto",Wa=0,Ya=0,Xa="touchmove"===t.type?t.touches[0].clientX:t.clientX,$a="touchmove"===t.type?t.touches[0].clientY:t.clientY}}function tn(t){Ha&&(Ha=!1,Ft.style.cursor="move",Xa=Ua,$a=Na)}Ze.addEventListener("mousedown",Qe),document.addEventListener("mousemove",Ke),document.addEventListener("mouseup",tn),Ze.addEventListener("touchstart",Qe),document.addEventListener("touchmove",Ke),document.addEventListener("touchend",tn)}const en=document.getElementById("vortexBallCountSlider"),nn=document.getElementById("vortexBallCountVal"),on=document.getElementById("vortexWellStrengthSlider"),an=document.getElementById("vortexWellStrengthVal"),sn=document.getElementById("vortexMouseStrengthSlider"),ln=document.getElementById("vortexMouseStrengthVal"),rn=document.getElementById("vortexInitialSpeedSlider"),dn=document.getElementById("vortexInitialSpeedVal"),cn=document.getElementById("vortexDecaySlider"),hn=document.getElementById("vortexDecayVal"),un=document.getElementById("vortexSpeedColorCheckbox");en&&en.addEventListener("input",()=>{st=parseInt(en.value,10),nn&&(nn.textContent=st.toString()),k===MODES.VORTEX&&w(),m()}),on&&on.addEventListener("input",()=>{it=parseInt(on.value,10),an&&(an.textContent=it.toString()),k===MODES.VORTEX&&Xe.length>0&&(Xe[0].strength=it,$e[0].strength=it),m()}),sn&&sn.addEventListener("input",()=>{dt=parseInt(sn.value,10),ln&&(ln.textContent=dt.toString()),m()}),rn&&rn.addEventListener("input",()=>{lt=parseInt(rn.value,10),dn&&(dn.textContent=lt.toString()),m()}),cn&&cn.addEventListener("input",()=>{rt=parseFloat(cn.value),hn&&(hn.textContent=rt.toFixed(4)),m()}),un&&un.addEventListener("change",()=>{ct=un.checked,m()}),window.addEventListener("keydown",t=>{const e=t.key.toLowerCase();"r"===e&&(function(){if(k===MODES.WEIGHTLESS)S();else for(let t=0;t<Ne.length;t++){const e=Ne[t],n=x();e.x=n.x,e.y=n.y;const o=.5*Lt.width,a=de?he>=0?1:-1:e.x<o?1:-1,i=g(e.r/(.5*(le+re)),.6,1.4),s=140*i,l=180*i,r=120;e.vx=a*(s+Math.random()*l),e.vy=-Math.random()*r,e.age=0,e.driftAx=a*(360+420*Math.random())*i,e.driftTime=.22+.28*Math.random()}}(),t.preventDefault()),"/"===e&&Ft&&(t.preventDefault(),Ft.classList.toggle("hidden")),"1"===e&&T(MODES.PIT),"2"===e&&T(MODES.FLIES),"3"===e&&T(MODES.WEIGHTLESS),"4"===e&&T(MODES.PULSE_GRID),"5"===e&&T(MODES.VORTEX)}),Lt.addEventListener("mousemove",t=>{const e=Lt.getBoundingClientRect();Ie=(t.clientX-e.left)*Rt,Me=(t.clientY-e.top)*Rt,Se=!0,k===MODES.PIT&&ve>0&&fe>0&&(Be=!0)}),Lt.addEventListener("mouseleave",()=>{Ie=Mt,Me=Mt,Se=!1});const mn=document.getElementById("restitutionSlider"),gn=document.getElementById("frictionSlider"),yn=document.getElementById("emitterSlider"),pn=document.getElementById("sizeSliderGlobal"),xn=document.getElementById("sizeVariationSliderGlobal"),fn=(document.getElementById("weightSliderGlobal"),document.getElementById("ballSoftnessSliderGlobal")),vn=document.getElementById("sizeValGlobal"),En=document.getElementById("sizeVariationValGlobal"),In=(document.getElementById("weightValGlobal"),document.getElementById("ballSoftnessValGlobal")),Mn=(document.getElementById("sizeSliderPit"),document.getElementById("sizeVariationSliderPit"),document.getElementById("weightSliderPit"),document.getElementById("ballSoftnessSliderPit"),document.getElementById("sizeValPit"),document.getElementById("sizeVariationValPit"),document.getElementById("weightValPit"),document.getElementById("ballSoftnessValPit"),document.getElementById("sizeSliderFlies"),document.getElementById("sizeVariationSliderFlies"),document.getElementById("weightSliderFlies"),document.getElementById("ballSoftnessSliderFlies"),document.getElementById("sizeValFlies"),document.getElementById("sizeVariationValFlies"),document.getElementById("weightValFlies"),document.getElementById("ballSoftnessValFlies"),document.getElementById("sizeSliderZeroG"),document.getElementById("sizeVariationSliderZeroG"),document.getElementById("weightSliderZeroG"),document.getElementById("ballSoftnessSliderZeroG"),document.getElementById("sizeValZeroG"),document.getElementById("sizeVariationValZeroG"),document.getElementById("weightValZeroG"),document.getElementById("ballSoftnessValZeroG"),document.getElementById("maxBallsSlider")),Sn=document.getElementById("spawnYSlider"),Bn=document.getElementById("spawnWidthSlider"),bn=document.getElementById("spawnCenterSlider"),Cn=document.getElementById("spawnHeightSlider"),wn=document.getElementById("repelSizeSlider"),Ln=document.getElementById("repelPowerSlider"),Tn=document.getElementById("repelSoftSlider"),Vn=document.getElementById("colorSelect"),Fn=document.getElementById("color1"),Rn=document.getElementById("color2"),Pn=document.getElementById("color3"),An=document.getElementById("color4"),qn=document.getElementById("color5"),kn=document.getElementById("color6"),Gn=document.getElementById("color7"),zn=document.getElementById("color8"),On=document.getElementById("cursorColorSelect"),Dn=document.getElementById("color1Val"),Un=document.getElementById("color2Val"),Nn=document.getElementById("color3Val"),Xn=document.getElementById("color4Val"),$n=document.getElementById("color5Val"),Hn=document.getElementById("color6Val"),Wn=document.getElementById("color7Val"),Yn=document.getElementById("color8Val");[Dn,Un,Nn,Xn,$n,Hn,Wn,Yn].forEach(t=>{t&&t.setAttribute("title","Click to copy")});const jn=document.getElementById("cornerRadiusSlider"),_n=document.getElementById("cornerRadiusVal"),Zn=document.getElementById("trailFadeSlider"),Jn=document.getElementById("trailFadeVal"),Qn=document.getElementById("trailSubtletySlider"),Kn=document.getElementById("trailSubtletyVal"),to=document.getElementById("restitutionVal"),eo=document.getElementById("frictionVal"),no=document.getElementById("emitterVal"),oo=document.getElementById("maxBallsVal"),ao=document.getElementById("spawnYVal"),io=document.getElementById("spawnWidthVal"),so=document.getElementById("spawnCenterVal"),lo=document.getElementById("spawnHeightVal"),ro=document.getElementById("repelSizeVal"),co=document.getElementById("repelPowerVal"),ho=document.getElementById("repelSoftVal"),uo=document.getElementById("saveConfigBtn"),mo=document.getElementById("buildBtn"),go=document.getElementById("configOutput");uo&&mo&&go&&(uo.addEventListener("click",()=>{const t=E(),e=new Blob([JSON.stringify(t,null,2)],{type:"application/json"}),n=URL.createObjectURL(e),o=document.createElement("a");o.href=n,o.download="current-config.json",o.click(),URL.revokeObjectURL(n),go.style.display="block",go.innerHTML="\n<strong>💾 Config Saved!</strong><br>\nReplace <code>source/current-config.json</code> with the downloaded file.<br>\nThen rebuild: <code>npm run build-production</code>";const a=uo.textContent;uo.textContent="✅ Downloaded!",setTimeout(()=>{uo.textContent=a},2e3)}),mo.addEventListener("click",()=>{const t=E();go.style.display="block",go.innerHTML="\n<strong>🚀 Build Instructions:</strong><br>\n1. Run: <code>npm run build</code><br>\n2. Your current config will be baked into <code>public/js/bouncy-balls-embed.js</code>";const e=new Blob([JSON.stringify(t,null,2)],{type:"application/json"}),n=URL.createObjectURL(e),o=document.createElement("a");o.href=n,o.download="current-config.json",o.click(),URL.revokeObjectURL(n)})),mn&&mn.addEventListener("input",()=>{Yt=parseFloat(mn.value),to&&(to.textContent=Yt.toFixed(2)),m()}),gn&&gn.addEventListener("input",()=>{jt=parseFloat(gn.value),eo&&(eo.textContent=jt.toFixed(4)),m()}),yn&&yn.addEventListener("input",()=>{_t=parseFloat(yn.value),no&&(no.textContent=_t.toFixed(3)),m()}),function(t){if(!t)return;const{size:e,sizeVal:n,sizeVar:o,sizeVarVal:a,soft:i,softVal:s}=t;e&&e.addEventListener("input",()=>{const t=parseFloat(e.value);n&&(n.textContent=t.toFixed(1)),te=t,l();const o=(le+re)/2;for(let t=0;t<Ne.length;t++)Ne[t].r=o,Ne[t].rBase=o;for(let t=0;t<Ne.length;t++)Ne[t].m=ae;m()}),o&&o.addEventListener("input",()=>{const t=parseFloat(o.value);a&&(a.textContent=t.toFixed(1)),ee=t,m()}),i&&i.addEventListener("input",()=>{const t=parseInt(i.value,10);s&&(s.textContent=String(t)),G=t,m()})}({size:pn,sizeVal:vn,sizeVar:xn,sizeVarVal:En,soft:fn,softVal:In}),Mn&&Mn.addEventListener("input",()=>{Zt=parseInt(Mn.value,10),oo&&(oo.textContent=Zt.toString()),Ne.length>Zt&&(Ne.length=Zt)}),xn&&xn.addEventListener("input",()=>{ee=parseFloat(xn.value),En&&(En.textContent=ee.toFixed(1)),M()});const yo=document.getElementById("weightPitSlider"),po=document.getElementById("weightPitVal");document.getElementById("weightWeightlessSlider"),document.getElementById("weightWeightlessVal"),Sn&&Sn.addEventListener("input",()=>{Ut=parseFloat(Sn.value),ao&&(ao.textContent=Ut.toFixed(0)),i()}),Bn&&Bn.addEventListener("input",()=>{Nt=parseFloat(Bn.value),io&&(io.textContent=Nt.toFixed(0))}),bn&&bn.addEventListener("input",()=>{Dt=parseFloat(bn.value),so&&(so.textContent=Dt.toFixed(0))}),Cn&&Cn.addEventListener("input",()=>{Xt=parseFloat(Cn.value),lo&&(lo.textContent=Xt.toFixed(0))}),wn&&wn.addEventListener("input",()=>{fe=parseFloat(wn.value),ro&&(ro.textContent=fe.toFixed(0)),Be=Be||ve>0&&fe>0}),Ln&&Ln.addEventListener("input",()=>{ve=function(t){const e=Math.max(0,Math.min(Ce,Number(t)))/Ce;return 2*Math.pow(2,12*(e-.5))*12e3}(Ln.value),co&&(co.textContent=Math.round(ve).toString()),za&&"off"!==za.value&&(Be=ve>0&&fe>0)}),Tn&&Tn.addEventListener("input",()=>{Ee=parseFloat(Tn.value),ho&&(ho.textContent=Ee.toFixed(1))});const xo=document.getElementById("performanceModeToggle");document.getElementById("performanceModeStatus"),xo&&xo.addEventListener("change",()=>{!function(){Pt=!Pt,At=Pt?120:60;const t=Pt?zt.performance:zt.normal;Pt?(console.log("⚡ PERFORMANCE MODE: Optimizing for 120 FPS..."),Ne.length>t.maxBalls&&(Ne.length=t.maxBalls,console.log(`⚡ Reduced balls to ${t.maxBalls} for 120 FPS`)),Zt=t.maxBalls,De=t.collisionIters):(console.log("🎨 NORMAL MODE: Restoring visual quality..."),Zt=t.maxBalls,De=t.collisionIters),function(){const t=document.getElementById("performanceModeToggle"),e=document.getElementById("performanceModeStatus"),n=document.getElementById("maxBallsSlider"),o=document.getElementById("maxBallsVal");t&&(t.checked=Pt),e&&(Pt?(e.textContent=`⚡ 120 FPS Mode Active (${Ne.length} balls)`,e.style.background="rgba(255,165,0,0.3)"):(e.textContent=`🎨 Normal Mode (${Ne.length} balls)`,e.style.background="rgba(0,0,0,0.2)")),n&&o&&(n.value=Zt,o.textContent=Zt.toString())}(),console.log(`🎯 Target FPS: ${At}, Mode: ${Pt?"PERFORMANCE":"NORMAL"}`)}()});const fo=document.getElementById("darkModeToggle");document.getElementById("darkModeStatus"),fo&&fo.addEventListener("change",()=>{kt=!kt,kt?(a(),console.log("🌙 Auto Dark Mode: ENABLED")):(o(!1),console.log("☀️ Auto Dark Mode: DISABLED")),m()});const vo=document.getElementById("canvasShadowEnabled"),Eo=document.getElementById("shadowOffsetX"),Io=document.getElementById("shadowOffsetXVal"),Mo=document.getElementById("shadowOffsetY"),So=document.getElementById("shadowOffsetYVal"),Bo=document.getElementById("shadowBlur"),bo=document.getElementById("shadowBlurVal"),Co=document.getElementById("shadowOpacity"),wo=document.getElementById("shadowOpacityVal"),Lo=document.getElementById("shadowColor"),To=document.getElementById("shadowColorVal"),Vo=document.getElementById("shadow2Enabled"),Fo=document.getElementById("shadow2Blur"),Ro=document.getElementById("shadow2BlurVal"),Po=document.getElementById("shadow2Opacity"),Ao=document.getElementById("shadow2OpacityVal");vo&&vo.addEventListener("change",()=>{ht=vo.checked,e(),m()}),Eo&&Eo.addEventListener("input",()=>{ut=parseFloat(Eo.value),Io&&(Io.textContent=ut.toFixed(1)),e(),m()}),Mo&&Mo.addEventListener("input",()=>{mt=parseFloat(Mo.value),So&&(So.textContent=mt.toFixed(1)),e(),m()}),Bo&&Bo.addEventListener("input",()=>{gt=parseFloat(Bo.value),bo&&(bo.textContent=gt.toFixed(1)),e(),m()}),Co&&Co.addEventListener("input",()=>{yt=parseFloat(Co.value),wo&&(wo.textContent=yt.toFixed(2)),e(),m()}),Lo&&Lo.addEventListener("input",()=>{pt=Lo.value,To&&(To.textContent=pt.toUpperCase()),e(),m()}),Vo&&Vo.addEventListener("change",()=>{xt=Vo.checked,e(),m()}),Fo&&Fo.addEventListener("input",()=>{ft=parseInt(Fo.value,10),Ro&&(Ro.textContent=ft.toString()),e(),m()}),Po&&Po.addEventListener("input",()=>{vt=parseFloat(Po.value),Ao&&(Ao.textContent=vt.toFixed(2)),e(),m()}),Lt.addEventListener("mouseleave",()=>{Ie=Mt,Me=Mt,Se=!1}),Vn&&Vn.addEventListener("change",()=>{d(Vn.value)});const qo=Array.from(document.querySelectorAll(".mode-button")),ko=document.getElementById("pitControls"),Go=document.getElementById("fliesControls"),zo=document.getElementById("weightlessControls"),Oo=document.getElementById("gravityPitSlider"),Do=document.getElementById("gravityPitVal"),Uo=document.getElementById("repellerEnabledPit"),No=document.getElementById("attractPowerSlider"),Xo=document.getElementById("attractPowerVal"),$o=document.getElementById("orbitRadiusSlider"),Ho=document.getElementById("orbitRadiusVal"),Wo=document.getElementById("swarmSpeedSlider"),Yo=document.getElementById("swarmSpeedVal"),jo=document.getElementById("weightlessCountSlider"),_o=document.getElementById("weightlessCountVal"),Zo=document.getElementById("weightlessSpeedSlider"),Jo=document.getElementById("weightlessSpeedVal"),Qo=document.getElementById("weightlessBounceSlider"),Ko=document.getElementById("weightlessBounceVal"),ta=document.getElementById("weightlessRepelSlider"),ea=document.getElementById("weightlessRepelVal"),na=document.getElementById("weightlessRepelRadiusSlider"),oa=document.getElementById("weightlessRepelRadiusVal");let aa=0,ia=0,sa=0,la=0,ra=0;const da=document.getElementById("resetBtn");da&&da.addEventListener("click",()=>{confirm("Reset all settings to defaults? This will reload the page with default values.")&&(Re("🔄 Reloading with defaults..."),location.reload())}),qo.forEach(t=>t.addEventListener("click",()=>{T(t.getAttribute("data-mode")),m()})),Oo&&Oo.addEventListener("input",()=>{z=parseFloat(Oo.value),Do&&(Do.textContent=z.toFixed(1)),m(),k===MODES.PIT&&(Ht=z,Wt=$t*Ht)}),yo&&yo.addEventListener("input",()=>{ae=parseFloat(yo.value),po&&(po.textContent=ae.toFixed(2));for(let t=0;t<Ne.length;t++)Ne[t].m=ae;s(),m()}),Uo&&Uo.addEventListener("change",()=>{O=!!Uo.checked,k===MODES.PIT&&(Be=O&&ve>0&&fe>0)}),No&&No.addEventListener("input",()=>{D=parseFloat(No.value),Xo&&(Xo.textContent=Math.round(D).toString())}),$o&&$o.addEventListener("input",()=>{U=parseFloat($o.value),Ho&&(Ho.textContent=Math.round(U).toString())}),Wo&&Wo.addEventListener("input",()=>{N=parseFloat(Wo.value),Yo&&(Yo.textContent=N.toFixed(1))}),jo&&jo.addEventListener("input",()=>{X=parseInt(jo.value,10),_o&&(_o.textContent=X.toString()),k===MODES.WEIGHTLESS&&S()}),Zo&&Zo.addEventListener("input",()=>{$=parseFloat(Zo.value),Jo&&(Jo.textContent=Math.round($).toString())}),Qo&&Qo.addEventListener("input",()=>{H=parseFloat(Qo.value),Ko&&(Ko.textContent=H.toFixed(2))}),ta&&ta.addEventListener("input",()=>{W=parseFloat(ta.value),ea&&(ea.textContent=Math.round(W).toString()),m()}),na&&na.addEventListener("input",()=>{Y=parseFloat(na.value),oa&&(oa.textContent=Math.round(Y).toString()),m()});const ca=document.getElementById("gridPresetSelect"),ha=document.getElementById("gridBallCountSlider"),ua=document.getElementById("gridBallCountVal"),ma=document.getElementById("gridColumnsSlider"),ga=document.getElementById("gridColumnsVal"),ya=document.getElementById("pulseIntervalSlider"),pa=document.getElementById("pulseIntervalVal"),xa=document.getElementById("pulseSpeedSlider"),fa=document.getElementById("pulseSpeedVal"),va=document.getElementById("pulseMinStepsSlider"),Ea=document.getElementById("pulseMinStepsVal"),Ia=document.getElementById("pulseMaxStepsSlider"),Ma=document.getElementById("pulseMaxStepsVal"),Sa=document.getElementById("pulseSynchronicitySlider"),Ba=document.getElementById("pulseSynchronicityVal"),ba=document.getElementById("pulseRandomnessSlider"),Ca=document.getElementById("pulseRandomnessVal"),wa={synchronized:{interval:.6,speed:.2,minSteps:1,maxSteps:2,synchronicity:.1,randomness:.2,easingStyle:"snap",overshoot:1.12,bounce:.18},organic:{interval:.8,speed:.25,minSteps:1,maxSteps:3,synchronicity:.3,randomness:.4,easingStyle:"smooth",overshoot:1.05,bounce:.1},chaotic:{interval:.4,speed:.15,minSteps:2,maxSteps:4,synchronicity:.7,randomness:.8,easingStyle:"bounce",overshoot:1.15,bounce:.25}};ca&&ca.addEventListener("change",()=>{!function(t){const e=wa[t];if(!e)return;_=e.interval,Z=e.speed,K=e.minSteps,tt=e.maxSteps,J=e.synchronicity,Q=e.randomness,ot=e.easingStyle,at=e.overshoot,nt=e.bounce,ya&&(ya.value=e.interval),pa&&(pa.textContent=e.interval.toFixed(1)),xa&&(xa.value=e.speed),fa&&(fa.textContent=e.speed.toFixed(2)),va&&(va.value=e.minSteps),Ea&&(Ea.textContent=e.minSteps.toString()),Ia&&(Ia.value=e.maxSteps),Ma&&(Ma.textContent=e.maxSteps.toString()),Sa&&(Sa.value=e.synchronicity),Ba&&(Ba.textContent=e.synchronicity.toFixed(2)),ba&&(ba.value=e.randomness),Ca&&(Ca.textContent=e.randomness.toFixed(2));const n=document.getElementById("pulseEasingSelect"),o=document.getElementById("pulseOvershootSlider"),a=document.getElementById("pulseOvershootVal"),i=document.getElementById("pulseBounceSlider"),s=document.getElementById("pulseBounceVal");n&&(n.value=e.easingStyle),o&&(o.value=e.overshoot),a&&(a.textContent=e.overshoot.toFixed(2)),i&&(i.value=e.bounce),s&&(s.textContent=e.bounce.toFixed(2)),k===MODES.PULSE_GRID&&L()}(ca.value),m()}),ha&&ha.addEventListener("input",()=>{et=parseInt(ha.value,10),ua&&(ua.textContent=et.toString()),k===MODES.PULSE_GRID&&L(),m()}),ma&&ma.addEventListener("input",()=>{j=parseInt(ma.value,10),ga&&(ga.textContent=j.toString()),k===MODES.PULSE_GRID&&(B(),L()),m()}),ya&&ya.addEventListener("input",()=>{_=parseFloat(ya.value),pa&&(pa.textContent=_.toFixed(1)),m()}),xa&&xa.addEventListener("input",()=>{Z=parseFloat(xa.value),fa&&(fa.textContent=Z.toFixed(2)),m()}),va&&va.addEventListener("input",()=>{K=parseInt(va.value,10),Ea&&(Ea.textContent=K.toString()),K>tt&&(tt=K,Ia&&(Ia.value=K),Ma&&(Ma.textContent=K.toString())),m()}),Ia&&Ia.addEventListener("input",()=>{tt=parseInt(Ia.value,10),Ma&&(Ma.textContent=tt.toString()),tt<K&&(K=tt,va&&(va.value=tt),Ea&&(Ea.textContent=tt.toString())),m()}),Sa&&Sa.addEventListener("input",()=>{J=parseFloat(Sa.value),Ba&&(Ba.textContent=J.toFixed(2)),m()}),ba&&ba.addEventListener("input",()=>{Q=parseFloat(ba.value),Ca&&(Ca.textContent=Q.toFixed(2)),m()});const La=document.getElementById("pulseEasingSelect"),Ta=document.getElementById("pulseOvershootSlider"),Va=document.getElementById("pulseOvershootVal"),Fa=document.getElementById("pulseBounceSlider"),Ra=document.getElementById("pulseBounceVal");La&&La.addEventListener("change",()=>{ot=La.value,m()}),Ta&&Ta.addEventListener("input",()=>{at=parseFloat(Ta.value),Va&&(Va.textContent=at.toFixed(2)),m()}),Fa&&Fa.addEventListener("input",()=>{nt=parseFloat(Fa.value),Ra&&(Ra.textContent=nt.toFixed(2)),m()}),Fn&&Fn.addEventListener("input",()=>{ge[0]=Fn.value,Dn&&(Dn.textContent=Fn.value.toUpperCase()),V(),c()}),Rn&&Rn.addEventListener("input",()=>{ge[1]=Rn.value,Un&&(Un.textContent=Rn.value.toUpperCase()),V(),c()}),Pn&&Pn.addEventListener("input",()=>{ge[2]=Pn.value,Nn&&(Nn.textContent=Pn.value.toUpperCase()),V(),c()}),An&&An.addEventListener("input",()=>{ge[3]=An.value,Xn&&(Xn.textContent=An.value.toUpperCase()),V(),c()}),qn&&qn.addEventListener("input",()=>{ge[4]=qn.value,$n&&($n.textContent=qn.value.toUpperCase()),V(),c()}),kn&&kn.addEventListener("input",()=>{ge[5]=kn.value,Hn&&(Hn.textContent=kn.value.toUpperCase()),V(),c()}),Gn&&Gn.addEventListener("input",()=>{ge[6]=Gn.value,Wn&&(Wn.textContent=Gn.value.toUpperCase()),V(),c()}),zn&&zn.addEventListener("input",()=>{ge[7]=zn.value,Yn&&(Yn.textContent=zn.value.toUpperCase()),V(),c()}),On&&On.addEventListener("change",()=>{const t=Math.max(1,Math.min(8,parseInt(On.value,10)))-1;ye=t,pe=ge[ye]||pe,m()}),I(Dn,()=>Fn.value.toUpperCase()),I(Un,()=>Rn.value.toUpperCase()),I(Nn,()=>Pn.value.toUpperCase()),I(Xn,()=>An.value.toUpperCase()),I($n,()=>qn.value.toUpperCase()),I(Hn,()=>kn.value.toUpperCase()),I(Wn,()=>Gn.value.toUpperCase()),I(Yn,()=>zn.value.toUpperCase()),jn&&jn.addEventListener("input",()=>{we=parseFloat(jn.value),_n&&(_n.textContent=we.toFixed(0))}),Zn&&Zn.addEventListener("input",()=>{Ve=parseFloat(Zn.value),Jn&&(Jn.textContent=Ve.toFixed(3))}),Qn&&Qn.addEventListener("input",()=>{Fe=parseFloat(Qn.value),Kn&&(Kn.textContent=Fe.toFixed(2)+"×")});const Pa={rubberPlayground:{label:"Rubber – Playground",G:1960,REST:.9,FRICTION:.0025,sizeScale:1.8,maxBalls:450,sizeVariation:.2},rubberRacquet:{label:"Rubber – Racquetball",G:3320,REST:.97,FRICTION:.0035,sizeScale:.7,maxBalls:350,sizeVariation:.3},rubberSuperball:{label:"Rubber – Superball",G:1960,REST:.95,FRICTION:.0015,sizeScale:1.2,maxBalls:450,sizeVariation:.05},rubberSoft:{label:"Rubber – Soft",G:1960,REST:.86,FRICTION:.0035,sizeScale:2.2,maxBalls:350,sizeVariation:.25},rubberHeavy:{label:"Rubber – Heavy",G:1960,REST:.88,FRICTION:.003,sizeScale:2,maxBalls:400,sizeVariation:.15}},Aa={fullRain:{label:"Full Rain (top-half)",EMIT_INTERVAL:.03,xCenter:50,y:-50,w:100,h:50},narrowStrip:{label:"Narrow Strip Top",EMIT_INTERVAL:.05,xCenter:50,y:-40,w:20,h:10},leftGutter:{label:"Left Gutter",EMIT_INTERVAL:.045,xCenter:10,y:-60,w:18,h:20},rightGutter:{label:"Right Gutter",EMIT_INTERVAL:.045,xCenter:90,y:-60,w:18,h:20},centerFountain:{label:"Center Fountain",EMIT_INTERVAL:.02,xCenter:50,y:-30,w:30,h:20},stormBurst:{label:"Storm Burst",EMIT_INTERVAL:.005,xCenter:50,y:-80,w:100,h:30},slowSnow:{label:"Slow Snow",EMIT_INTERVAL:.2,xCenter:50,y:-30,w:100,h:20},edgeDrizzle:{label:"Edge Drizzle",EMIT_INTERVAL:.08,xCenter:15,y:-40,w:30,h:15},twinColumns:{label:"Twin Columns",EMIT_INTERVAL:.03,xCenter:30,y:-50,w:10,h:40},focusedBeam:{label:"Focused Beam",EMIT_INTERVAL:.015,xCenter:50,y:-70,w:6,h:12}},qa={off:{label:"Off",r:710,p:274e3,s:4.4},gentle:{label:"Gentle Breeze",r:120,p:2500,s:2.5},pushField:{label:"Push Field",r:240,p:8e4,s:2},tractor:{label:"Tractor Push",r:320,p:14e4,s:1.6},magnet:{label:"Magnet Repel",r:200,p:18e4,s:3},pulse:{label:"Pulse Strong",r:280,p:22e4,s:1.2},wideSoft:{label:"Wide Soft",r:500,p:8e4,s:4.5},needle:{label:"Needle Point",r:80,p:26e4,s:.8},wall:{label:"Invisible Wall",r:700,p:16e4,s:5},singularity:{label:"Singularity",r:600,p:3e5,s:.5}},ka=document.getElementById("physicsSelect"),Ga=document.getElementById("spawnSelect"),za=document.getElementById("repellerSelect");ka&&F(ka,Pa,"rubberRacquet"),Ga&&F(Ga,Aa,"fullRain"),za&&F(za,qa,"off"),Vn&&F(Vn,ue,"industrialTeal"),P("rubberRacquet"),A("fullRain"),q("off"),Re("⚠️ localStorage is disabled - using defaults"),console.log("🔍 Initializing dark mode system..."),Gt=function(){if(console.log("🔍 STATE: DETERMINING_MODE"),qt="determining_mode",!kt)return console.log("✓ Dark mode disabled by user → Light mode"),!1;const t=n();return console.log(`✓ Dark mode determination complete → ${t?"DARK":"LIGHT"} mode`),t}(),console.log(`✅ Dark mode determined: ${Gt?"DARK":"LIGHT"} mode`),Gt?Tt.classList.add("dark-mode"):Tt.classList.remove("dark-mode"),console.log(`   Container classes: ${Tt.classList.toString()}`),console.log("   Background should be: "+(Gt?"#0a0a0a (dark)":"#cecece (light)")),d(me),console.log(`   Color template applied: ${me} (${Gt?"dark":"light"} variant)`);const Oa=setInterval(a,6e4);window.addEventListener("unload",()=>{Oa&&clearInterval(Oa)}),ka&&ka.addEventListener("change",()=>P(ka.value)),Ga&&Ga.addEventListener("change",()=>A(Ga.value)),za&&za.addEventListener("change",()=>q(za.value)),l(),r(),e();{const ja=Object.values(MODES),_a=ja[Math.floor(Math.random()*ja.length)];k=_a,console.log(`🎲 Random mode selected: ${_a}`)}T(k),window.addEventListener("beforeunload",u)})();
  </script>
</body>
</html>